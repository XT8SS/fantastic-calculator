var ou=Object.defineProperty;var ru=(n,e,t)=>e in n?ou(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var Yt=(n,e,t)=>(ru(n,typeof e!="symbol"?e+"":e,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&i(r)}).observe(document,{childList:!0,subtree:!0});function t(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(s){if(s.ep)return;s.ep=!0;const o=t(s);fetch(s.href,o)}})();function re(){}const xi=n=>n;function lu(n,e){for(const t in e)n[t]=e[t];return n}function ea(n){return n()}function Go(){return Object.create(null)}function be(n){n.forEach(ea)}function Wn(n){return typeof n=="function"}function me(n,e){return n!=n?e==e:n!==e||n&&typeof n=="object"||typeof n=="function"}let Ei;function Ze(n,e){return n===e?!0:(Ei||(Ei=document.createElement("a")),Ei.href=e,n===Ei.href)}function au(n){return Object.keys(n).length===0}function cu(n,...e){if(n==null){for(const i of e)i(void 0);return re}const t=n.subscribe(...e);return t.unsubscribe?()=>t.unsubscribe():t}function J(n,e,t){n.$$.on_destroy.push(cu(e,t))}function uu(n,e,t,i){if(n){const s=ta(n,e,t,i);return n[0](s)}}function ta(n,e,t,i){return n[1]&&i?lu(t.ctx.slice(),n[1](i(e))):t.ctx}function du(n,e,t,i){if(n[2]&&i){const s=n[2](i(t));if(e.dirty===void 0)return s;if(typeof s=="object"){const o=[],r=Math.max(e.dirty.length,s.length);for(let l=0;l<r;l+=1)o[l]=e.dirty[l]|s[l];return o}return e.dirty|s}return e.dirty}function fu(n,e,t,i,s,o){if(s){const r=ta(e,t,i,o);n.p(r,s)}}function hu(n){if(n.ctx.length>32){const e=[],t=n.ctx.length/32;for(let i=0;i<t;i++)e[i]=-1;return e}return-1}function G(n,e,t){return n.set(t),e}function na(n){return n&&Wn(n.destroy)?n.destroy:re}const ia=typeof window<"u";let $s=ia?()=>window.performance.now():()=>Date.now(),eo=ia?n=>requestAnimationFrame(n):re;const Tn=new Set;function sa(n){Tn.forEach(e=>{e.c(n)||(Tn.delete(e),e.f())}),Tn.size!==0&&eo(sa)}function to(n){let e;return Tn.size===0&&eo(sa),{promise:new Promise(t=>{Tn.add(e={c:n,f:t})}),abort(){Tn.delete(e)}}}const _u=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function p(n,e){n.appendChild(e)}function oa(n){if(!n)return document;const e=n.getRootNode?n.getRootNode():n.ownerDocument;return e&&e.host?e:n.ownerDocument}function pu(n){const e=g("style");return e.textContent="/* empty */",mu(oa(n),e),e.sheet}function mu(n,e){return p(n.head||n,e),e.sheet}function F(n,e,t){n.insertBefore(e,t||null)}function L(n){n.parentNode&&n.parentNode.removeChild(n)}function at(n,e){for(let t=0;t<n.length;t+=1)n[t]&&n[t].d(e)}function g(n){return document.createElement(n)}function gu(n){return document.createElementNS("http://www.w3.org/2000/svg",n)}function ne(n){return document.createTextNode(n)}function E(){return ne(" ")}function ut(){return ne("")}function D(n,e,t,i){return n.addEventListener(e,t,i),()=>n.removeEventListener(e,t,i)}function m(n,e,t){t==null?n.removeAttribute(e):n.getAttribute(e)!==t&&n.setAttribute(e,t)}function De(n,e,t){e in n?n[e]=typeof n[e]=="boolean"&&t===""?!0:t:m(n,e,t)}function ra(n){return n===""?null:+n}function bu(n){return Array.from(n.childNodes)}function Se(n,e){e=""+e,n.data!==e&&(n.data=e)}function Bt(n,e){n.value=e??""}function et(n,e,t,i){t==null?n.style.removeProperty(e):n.style.setProperty(e,t,i?"important":"")}let Si;function vu(){if(Si===void 0){Si=!1;try{typeof window<"u"&&window.parent&&window.parent.document}catch{Si=!0}}return Si}function en(n,e){getComputedStyle(n).position==="static"&&(n.style.position="relative");const i=g("iframe");i.setAttribute("style","display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;"),i.setAttribute("aria-hidden","true"),i.tabIndex=-1;const s=vu();let o;return s?(i.src="data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}<\/script>",o=D(window,"message",r=>{r.source===i.contentWindow&&e()})):(i.src="about:blank",i.onload=()=>{o=D(i.contentWindow,"resize",e),e()}),p(n,i),()=>{(s||o&&i.contentWindow)&&o(),L(i)}}function te(n,e,t){n.classList.toggle(e,!!t)}function la(n,e,{bubbles:t=!1,cancelable:i=!1}={}){return new CustomEvent(n,{detail:e,bubbles:t,cancelable:i})}class yu{constructor(e=!1){Yt(this,"is_svg",!1);Yt(this,"e");Yt(this,"n");Yt(this,"t");Yt(this,"a");this.is_svg=e,this.e=this.n=null}c(e){this.h(e)}m(e,t,i=null){this.e||(this.is_svg?this.e=gu(t.nodeName):this.e=g(t.nodeType===11?"TEMPLATE":t.nodeName),this.t=t.tagName!=="TEMPLATE"?t:t.content,this.c(e)),this.i(i)}h(e){this.e.innerHTML=e,this.n=Array.from(this.e.nodeName==="TEMPLATE"?this.e.content.childNodes:this.e.childNodes)}i(e){for(let t=0;t<this.n.length;t+=1)F(this.t,this.n[t],e)}p(e){this.d(),this.h(e),this.i(this.a)}d(){this.n.forEach(L)}}const Di=new Map;let Ri=0;function wu(n){let e=5381,t=n.length;for(;t--;)e=(e<<5)-e^n.charCodeAt(t);return e>>>0}function ku(n,e){const t={stylesheet:pu(e),rules:{}};return Di.set(n,t),t}function Ai(n,e,t,i,s,o,r,l=0){const a=16.666/i;let c=`{
`;for(let v=0;v<=1;v+=a){const w=e+(t-e)*o(v);c+=v*100+`%{${r(w,1-w)}}
`}const u=c+`100% {${r(t,1-t)}}
}`,d=`__svelte_${wu(u)}_${l}`,f=oa(n),{stylesheet:_,rules:h}=Di.get(f)||ku(f,n);h[d]||(h[d]=!0,_.insertRule(`@keyframes ${d} ${u}`,_.cssRules.length));const b=n.style.animation||"";return n.style.animation=`${b?`${b}, `:""}${d} ${i}ms linear ${s}ms 1 both`,Ri+=1,d}function Pi(n,e){const t=(n.style.animation||"").split(", "),i=t.filter(e?o=>o.indexOf(e)<0:o=>o.indexOf("__svelte")===-1),s=t.length-i.length;s&&(n.style.animation=i.join(", "),Ri-=s,Ri||Cu())}function Cu(){eo(()=>{Ri||(Di.forEach(n=>{const{ownerNode:e}=n.stylesheet;e&&L(e)}),Di.clear())})}let si;function $n(n){si=n}function aa(){if(!si)throw new Error("Function called outside component initialization");return si}function Eu(n){aa().$$.on_mount.push(n)}function qt(){const n=aa();return(e,t,{cancelable:i=!1}={})=>{const s=n.$$.callbacks[e];if(s){const o=la(e,t,{cancelable:i});return s.slice().forEach(r=>{r.call(n,o)}),!o.defaultPrevented}return!0}}const Sn=[],ie=[];let Nn=[];const Ds=[],Su=Promise.resolve();let Rs=!1;function Iu(){Rs||(Rs=!0,Su.then(ca))}function we(n){Nn.push(n)}function Re(n){Ds.push(n)}const gs=new Set;let kn=0;function ca(){if(kn!==0)return;const n=si;do{try{for(;kn<Sn.length;){const e=Sn[kn];kn++,$n(e),Tu(e.$$)}}catch(e){throw Sn.length=0,kn=0,e}for($n(null),Sn.length=0,kn=0;ie.length;)ie.pop()();for(let e=0;e<Nn.length;e+=1){const t=Nn[e];gs.has(t)||(gs.add(t),t())}Nn.length=0}while(Sn.length);for(;Ds.length;)Ds.pop()();Rs=!1,gs.clear(),$n(n)}function Tu(n){if(n.fragment!==null){n.update(),be(n.before_update);const e=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,e),n.after_update.forEach(we)}}function Nu(n){const e=[],t=[];Nn.forEach(i=>n.indexOf(i)===-1?e.push(i):t.push(i)),t.forEach(i=>i()),Nn=e}let Yn;function no(){return Yn||(Yn=Promise.resolve(),Yn.then(()=>{Yn=null})),Yn}function fn(n,e,t){n.dispatchEvent(la(`${e?"intro":"outro"}${t}`))}const Ni=new Set;let Ft;function ze(){Ft={r:0,c:[],p:Ft}}function je(){Ft.r||be(Ft.c),Ft=Ft.p}function B(n,e){n&&n.i&&(Ni.delete(n),n.i(e))}function H(n,e,t,i){if(n&&n.o){if(Ni.has(n))return;Ni.add(n),Ft.c.push(()=>{Ni.delete(n),i&&(t&&n.d(1),i())}),n.o(e)}else i&&i()}const io={duration:0};function ua(n,e,t){const i={direction:"in"};let s=e(n,t,i),o=!1,r,l,a=0;function c(){r&&Pi(n,r)}function u(){const{delay:f=0,duration:_=300,easing:h=xi,tick:b=re,css:v}=s||io;v&&(r=Ai(n,0,1,_,f,h,v,a++)),b(0,1);const w=$s()+f,k=w+_;l&&l.abort(),o=!0,we(()=>fn(n,!0,"start")),l=to(y=>{if(o){if(y>=k)return b(1,0),fn(n,!0,"end"),c(),o=!1;if(y>=w){const T=h((y-w)/_);b(T,1-T)}}return o})}let d=!1;return{start(){d||(d=!0,Pi(n),Wn(s)?(s=s(i),no().then(u)):u())},invalidate(){d=!1},end(){o&&(c(),o=!1)}}}function da(n,e,t){const i={direction:"out"};let s=e(n,t,i),o=!0,r;const l=Ft;l.r+=1;let a;function c(){const{delay:u=0,duration:d=300,easing:f=xi,tick:_=re,css:h}=s||io;h&&(r=Ai(n,1,0,d,u,f,h));const b=$s()+u,v=b+d;we(()=>fn(n,!1,"start")),"inert"in n&&(a=n.inert,n.inert=!0),to(w=>{if(o){if(w>=v)return _(0,1),fn(n,!1,"end"),--l.r||be(l.c),!1;if(w>=b){const k=f((w-b)/d);_(1-k,k)}}return o})}return Wn(s)?no().then(()=>{s=s(i),c()}):c(),{end(u){u&&"inert"in n&&(n.inert=a),u&&s.tick&&s.tick(1,0),o&&(r&&Pi(n,r),o=!1)}}}function ge(n,e,t,i){let o=e(n,t,{direction:"both"}),r=i?0:1,l=null,a=null,c=null,u;function d(){c&&Pi(n,c)}function f(h,b){const v=h.b-r;return b*=Math.abs(v),{a:r,b:h.b,d:v,duration:b,start:h.start,end:h.start+b,group:h.group}}function _(h){const{delay:b=0,duration:v=300,easing:w=xi,tick:k=re,css:y}=o||io,T={start:$s()+b,b:h};h||(T.group=Ft,Ft.r+=1),"inert"in n&&(h?u!==void 0&&(n.inert=u):(u=n.inert,n.inert=!0)),l||a?a=T:(y&&(d(),c=Ai(n,r,h,v,b,w,y)),h&&k(0,1),l=f(T,v),we(()=>fn(n,h,"start")),to(R=>{if(a&&R>a.start&&(l=f(a,v),a=null,fn(n,l.b,"start"),y&&(d(),c=Ai(n,r,l.b,l.duration,0,w,o.css))),l){if(R>=l.end)k(r=l.b,1-r),fn(n,l.b,"end"),a||(l.b?d():--l.group.r||be(l.group.c)),l=null;else if(R>=l.start){const q=R-l.start;r=l.a+l.d*w(q/l.duration),k(r,1-r)}}return!!(l||a)}))}return{run(h){Wn(o)?no().then(()=>{o=o({direction:h?"in":"out"}),_(h)}):_(h)},end(){d(),l=a=null}}}function Ne(n){return(n==null?void 0:n.length)!==void 0?n:Array.from(n)}function Ae(n,e,t){const i=n.$$.props[e];i!==void 0&&(n.$$.bound[i]=t,t(n.$$.ctx[i]))}function le(n){n&&n.c()}function se(n,e,t){const{fragment:i,after_update:s}=n.$$;i&&i.m(e,t),we(()=>{const o=n.$$.on_mount.map(ea).filter(Wn);n.$$.on_destroy?n.$$.on_destroy.push(...o):be(o),n.$$.on_mount=[]}),s.forEach(we)}function oe(n,e){const t=n.$$;t.fragment!==null&&(Nu(t.after_update),be(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function Ou(n,e){n.$$.dirty[0]===-1&&(Sn.push(n),Iu(),n.$$.dirty.fill(0)),n.$$.dirty[e/31|0]|=1<<e%31}function Pe(n,e,t,i,s,o,r=null,l=[-1]){const a=si;$n(n);const c=n.$$={fragment:null,ctx:[],props:o,update:re,not_equal:s,bound:Go(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(a?a.$$.context:[])),callbacks:Go(),dirty:l,skip_bound:!1,root:e.target||a.$$.root};r&&r(c.root);let u=!1;if(c.ctx=t?t(n,e.props||{},(d,f,..._)=>{const h=_.length?_[0]:f;return c.ctx&&s(c.ctx[d],c.ctx[d]=h)&&(!c.skip_bound&&c.bound[d]&&c.bound[d](h),u&&Ou(n,d)),f}):[],c.update(),u=!0,be(c.before_update),c.fragment=i?i(c.ctx):!1,e.target){if(e.hydrate){const d=bu(e.target);c.fragment&&c.fragment.l(d),d.forEach(L)}else c.fragment&&c.fragment.c();e.intro&&B(n.$$.fragment),se(n,e.target,e.anchor),ca()}$n(a)}class Me{constructor(){Yt(this,"$$");Yt(this,"$$set")}$destroy(){oe(this,1),this.$destroy=re}$on(e,t){if(!Wn(t))return re;const i=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return i.push(t),()=>{const s=i.indexOf(t);s!==-1&&i.splice(s,1)}}$set(e){this.$$set&&!au(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Du="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Du);const Cn=[];function it(n,e=re){let t;const i=new Set;function s(l){if(me(n,l)&&(n=l,t)){const a=!Cn.length;for(const c of i)c[1](),Cn.push(c,n);if(a){for(let c=0;c<Cn.length;c+=2)Cn[c][0](Cn[c+1]);Cn.length=0}}}function o(l){s(l(n))}function r(l,a=re){const c=[l,a];return i.add(c),i.size===1&&(t=e(s,o)||re),l(n),()=>{i.delete(c),i.size===0&&t&&(t(),t=null)}}return{set:s,update:o,subscribe:r}}let Vo=localStorage.getItem("builds"),Ko=0,Yo=localStorage.getItem("changelogSeen"),At=it({}),Pt=it({}),pt=it({armor:0,magicDmg:0,meleeDmg:0,rangedDmg:0,hpRegen:0,endurance:0,sightRange:0,walkSpeed:0,jumpPower:0,ammoReturn:0,height:0}),zt=it({}),so=it([]),bs=it({}),bt=it(),oo=it(!1),Tt=it(Vo?JSON.parse(Vo):{}),Qt=it(!1),Oi=it(Yo?JSON.parse(Yo):!1),pn=it(!1),Pn=it({}),Mn=it({}),Ru=it({}),St=it({armor:{min:0,avg:0,max:0},gear:{min:0,avg:0,max:0},total:{min:0,avg:0,max:0}}),On=it({}),Qn=it({parasol:!0,armor:!0,gear:!0,basic:!0}),x=it({item:{ongoing:!1,data:null},export:{ongoing:!1,status:null},save:{ongoing:!1,status:null},load:{ongoing:!1,status:null},delete:{ongoing:!1,status:null},share:{ongoing:!1},costs:{ongoing:!1},bonus:{ongoing:!1},screenshot:{ongoing:!1},randomize:{ongoing:!1},resources:{ongoing:!1},changelog:{ongoing:!1},message:""});Tt.subscribe(n=>{Ko++,setTimeout(()=>{window.localStorage.setItem("builds",JSON.stringify(n)),Ko>1&&window.history.replaceState(null,null,location.origin+location.pathname)})});Oi.subscribe(n=>window.localStorage.setItem("changelogSeen",n));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fa={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $=function(n,e){if(!n)throw Hn(e)},Hn=function(n){return new Error("Firebase Database ("+fa.SDK_VERSION+") INTERNAL ASSERT FAILED: "+n)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ha=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let s=n.charCodeAt(i);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},Au=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const s=n[t++];if(s<128)e[i++]=String.fromCharCode(s);else if(s>191&&s<224){const o=n[t++];e[i++]=String.fromCharCode((s&31)<<6|o&63)}else if(s>239&&s<365){const o=n[t++],r=n[t++],l=n[t++],a=((s&7)<<18|(o&63)<<12|(r&63)<<6|l&63)-65536;e[i++]=String.fromCharCode(55296+(a>>10)),e[i++]=String.fromCharCode(56320+(a&1023))}else{const o=n[t++],r=n[t++];e[i++]=String.fromCharCode((s&15)<<12|(o&63)<<6|r&63)}}return e.join("")},ro={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let s=0;s<n.length;s+=3){const o=n[s],r=s+1<n.length,l=r?n[s+1]:0,a=s+2<n.length,c=a?n[s+2]:0,u=o>>2,d=(o&3)<<4|l>>4;let f=(l&15)<<2|c>>6,_=c&63;a||(_=64,r||(f=64)),i.push(t[u],t[d],t[f],t[_])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(ha(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):Au(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let s=0;s<n.length;){const o=t[n.charAt(s++)],l=s<n.length?t[n.charAt(s)]:0;++s;const c=s<n.length?t[n.charAt(s)]:64;++s;const d=s<n.length?t[n.charAt(s)]:64;if(++s,o==null||l==null||c==null||d==null)throw new Pu;const f=o<<2|l>>4;if(i.push(f),c!==64){const _=l<<4&240|c>>2;if(i.push(_),d!==64){const h=c<<6&192|d;i.push(h)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class Pu extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const _a=function(n){const e=ha(n);return ro.encodeByteArray(e,!0)},Mi=function(n){return _a(n).replace(/\./g,"")},As=function(n){try{return ro.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mu(n){return pa(void 0,n)}function pa(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!Lu(t)||(n[t]=pa(n[t],e[t]));return n}function Lu(n){return n!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bu(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fu=()=>Bu().__FIREBASE_DEFAULTS__,zu=()=>{if(typeof process>"u"||typeof process.env>"u")return;const n={}.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},ju=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&As(n[1]);return e&&JSON.parse(e)},ma=()=>{try{return Fu()||zu()||ju()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},qu=n=>{var e,t;return(t=(e=ma())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},Wu=n=>{const e=qu(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},ga=()=>{var n;return(n=ma())===null||n===void 0?void 0:n.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $i{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hu(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",s=n.iat||0,o=n.sub||n.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const r=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:s,exp:s+3600,auth_time:s,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},n),l="";return[Mi(JSON.stringify(t)),Mi(JSON.stringify(r)),l].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uu(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function ba(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Uu())}function Gu(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function va(){return fa.NODE_ADMIN===!0}function Vu(){try{return typeof indexedDB=="object"}catch{return!1}}function Ku(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(i);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{var o;e(((o=s.error)===null||o===void 0?void 0:o.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yu="FirebaseError";class gi extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=Yu,Object.setPrototypeOf(this,gi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ya.prototype.create)}}class ya{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},s=`${this.service}/${e}`,o=this.errors[e],r=o?Qu(o,i):"Error",l=`${this.serviceName}: ${r} (${s}).`;return new gi(s,l,i)}}function Qu(n,e){return n.replace(Xu,(t,i)=>{const s=e[i];return s!=null?String(s):`<${i}?>`})}const Xu=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oi(n){return JSON.parse(n)}function tt(n){return JSON.stringify(n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wa=function(n){let e={},t={},i={},s="";try{const o=n.split(".");e=oi(As(o[0])||""),t=oi(As(o[1])||""),s=o[2],i=t.d||{},delete t.d}catch{}return{header:e,claims:t,data:i,signature:s}},Ju=function(n){const e=wa(n),t=e.claims;return!!t&&typeof t=="object"&&t.hasOwnProperty("iat")},Zu=function(n){const e=wa(n).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wt(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function Ln(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]}function Qo(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Li(n,e,t){const i={};for(const s in n)Object.prototype.hasOwnProperty.call(n,s)&&(i[s]=e.call(t,n[s],s,n));return i}function Ps(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const s of t){if(!i.includes(s))return!1;const o=n[s],r=e[s];if(Xo(o)&&Xo(r)){if(!Ps(o,r))return!1}else if(o!==r)return!1}for(const s of i)if(!t.includes(s))return!1;return!0}function Xo(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xu(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $u{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const i=this.W_;if(typeof e=="string")for(let d=0;d<16;d++)i[d]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let d=0;d<16;d++)i[d]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let d=16;d<80;d++){const f=i[d-3]^i[d-8]^i[d-14]^i[d-16];i[d]=(f<<1|f>>>31)&4294967295}let s=this.chain_[0],o=this.chain_[1],r=this.chain_[2],l=this.chain_[3],a=this.chain_[4],c,u;for(let d=0;d<80;d++){d<40?d<20?(c=l^o&(r^l),u=1518500249):(c=o^r^l,u=1859775393):d<60?(c=o&r|l&(o|r),u=2400959708):(c=o^r^l,u=3395469782);const f=(s<<5|s>>>27)+c+a+u+i[d]&4294967295;a=l,l=r,r=(o<<30|o>>>2)&4294967295,o=s,s=f}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+o&4294967295,this.chain_[2]=this.chain_[2]+r&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+a&4294967295}update(e,t){if(e==null)return;t===void 0&&(t=e.length);const i=t-this.blockSize;let s=0;const o=this.buf_;let r=this.inbuf_;for(;s<t;){if(r===0)for(;s<=i;)this.compress_(e,s),s+=this.blockSize;if(typeof e=="string"){for(;s<t;)if(o[r]=e.charCodeAt(s),++r,++s,r===this.blockSize){this.compress_(o),r=0;break}}else for(;s<t;)if(o[r]=e[s],++r,++s,r===this.blockSize){this.compress_(o),r=0;break}}this.inbuf_=r,this.total_+=t}digest(){const e=[];let t=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let s=this.blockSize-1;s>=56;s--)this.buf_[s]=t&255,t/=256;this.compress_(this.buf_);let i=0;for(let s=0;s<5;s++)for(let o=24;o>=0;o-=8)e[i]=this.chain_[s]>>o&255,++i;return e}}function lo(n,e){return`${n} failed: ${e} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ed=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let s=n.charCodeAt(i);if(s>=55296&&s<=56319){const o=s-55296;i++,$(i<n.length,"Surrogate pair missing trail surrogate.");const r=n.charCodeAt(i)-56320;s=65536+(o<<10)+r}s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):s<65536?(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},es=function(n){let e=0;for(let t=0;t<n.length;t++){const i=n.charCodeAt(t);i<128?e++:i<2048?e+=2:i>=55296&&i<=56319?(e+=4,t++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rn(n){return n&&n._delegate?n._delegate:n}class ri{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ln="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class td{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new $i;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&i.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const i=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(o){if(s)return null;throw o}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(id(e))try{this.getOrInitializeService({instanceIdentifier:ln})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const o=this.getOrInitializeService({instanceIdentifier:s});i.resolve(o)}catch{}}}}clearInstance(e=ln){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ln){return this.instances.has(e)}getOptions(e=ln){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[o,r]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(o);i===l&&r.resolve(s)}return s}onInit(e,t){var i;const s=this.normalizeInstanceIdentifier(t),o=(i=this.onInitCallbacks.get(s))!==null&&i!==void 0?i:new Set;o.add(e),this.onInitCallbacks.set(s,o);const r=this.instances.get(s);return r&&e(r,s),()=>{o.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const s of i)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:nd(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=ln){return this.component?this.component.multipleInstances?e:ln:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function nd(n){return n===ln?void 0:n}function id(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sd{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new td(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var He;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(He||(He={}));const od={debug:He.DEBUG,verbose:He.VERBOSE,info:He.INFO,warn:He.WARN,error:He.ERROR,silent:He.SILENT},rd=He.INFO,ld={[He.DEBUG]:"log",[He.VERBOSE]:"log",[He.INFO]:"info",[He.WARN]:"warn",[He.ERROR]:"error"},ad=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),s=ld[e];if(s)console[s](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class ka{constructor(e){this.name=e,this._logLevel=rd,this._logHandler=ad,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in He))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?od[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,He.DEBUG,...e),this._logHandler(this,He.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,He.VERBOSE,...e),this._logHandler(this,He.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,He.INFO,...e),this._logHandler(this,He.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,He.WARN,...e),this._logHandler(this,He.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,He.ERROR,...e),this._logHandler(this,He.ERROR,...e)}}const cd=(n,e)=>e.some(t=>n instanceof t);let Jo,Zo;function ud(){return Jo||(Jo=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function dd(){return Zo||(Zo=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Ca=new WeakMap,Ms=new WeakMap,Ea=new WeakMap,vs=new WeakMap,ao=new WeakMap;function fd(n){const e=new Promise((t,i)=>{const s=()=>{n.removeEventListener("success",o),n.removeEventListener("error",r)},o=()=>{t(Xt(n.result)),s()},r=()=>{i(n.error),s()};n.addEventListener("success",o),n.addEventListener("error",r)});return e.then(t=>{t instanceof IDBCursor&&Ca.set(t,n)}).catch(()=>{}),ao.set(e,n),e}function hd(n){if(Ms.has(n))return;const e=new Promise((t,i)=>{const s=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",r),n.removeEventListener("abort",r)},o=()=>{t(),s()},r=()=>{i(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",o),n.addEventListener("error",r),n.addEventListener("abort",r)});Ms.set(n,e)}let Ls={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Ms.get(n);if(e==="objectStoreNames")return n.objectStoreNames||Ea.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Xt(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function _d(n){Ls=n(Ls)}function pd(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(ys(this),e,...t);return Ea.set(i,e.sort?e.sort():[e]),Xt(i)}:dd().includes(n)?function(...e){return n.apply(ys(this),e),Xt(Ca.get(this))}:function(...e){return Xt(n.apply(ys(this),e))}}function md(n){return typeof n=="function"?pd(n):(n instanceof IDBTransaction&&hd(n),cd(n,ud())?new Proxy(n,Ls):n)}function Xt(n){if(n instanceof IDBRequest)return fd(n);if(vs.has(n))return vs.get(n);const e=md(n);return e!==n&&(vs.set(n,e),ao.set(e,n)),e}const ys=n=>ao.get(n);function gd(n,e,{blocked:t,upgrade:i,blocking:s,terminated:o}={}){const r=indexedDB.open(n,e),l=Xt(r);return i&&r.addEventListener("upgradeneeded",a=>{i(Xt(r.result),a.oldVersion,a.newVersion,Xt(r.transaction),a)}),t&&r.addEventListener("blocked",a=>t(a.oldVersion,a.newVersion,a)),l.then(a=>{o&&a.addEventListener("close",()=>o()),s&&a.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),l}const bd=["get","getKey","getAll","getAllKeys","count"],vd=["put","add","delete","clear"],ws=new Map;function xo(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(ws.get(e))return ws.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,s=vd.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(s||bd.includes(t)))return;const o=async function(r,...l){const a=this.transaction(r,s?"readwrite":"readonly");let c=a.store;return i&&(c=c.index(l.shift())),(await Promise.all([c[t](...l),s&&a.done]))[0]};return ws.set(e,o),o}_d(n=>({...n,get:(e,t,i)=>xo(e,t)||n.get(e,t,i),has:(e,t)=>!!xo(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yd{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(wd(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function wd(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Bs="@firebase/app",$o="0.9.23";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mn=new ka("@firebase/app"),kd="@firebase/app-compat",Cd="@firebase/analytics-compat",Ed="@firebase/analytics",Sd="@firebase/app-check-compat",Id="@firebase/app-check",Td="@firebase/auth",Nd="@firebase/auth-compat",Od="@firebase/database",Dd="@firebase/database-compat",Rd="@firebase/functions",Ad="@firebase/functions-compat",Pd="@firebase/installations",Md="@firebase/installations-compat",Ld="@firebase/messaging",Bd="@firebase/messaging-compat",Fd="@firebase/performance",zd="@firebase/performance-compat",jd="@firebase/remote-config",qd="@firebase/remote-config-compat",Wd="@firebase/storage",Hd="@firebase/storage-compat",Ud="@firebase/firestore",Gd="@firebase/firestore-compat",Vd="firebase",Kd="10.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fs="[DEFAULT]",Yd={[Bs]:"fire-core",[kd]:"fire-core-compat",[Ed]:"fire-analytics",[Cd]:"fire-analytics-compat",[Id]:"fire-app-check",[Sd]:"fire-app-check-compat",[Td]:"fire-auth",[Nd]:"fire-auth-compat",[Od]:"fire-rtdb",[Dd]:"fire-rtdb-compat",[Rd]:"fire-fn",[Ad]:"fire-fn-compat",[Pd]:"fire-iid",[Md]:"fire-iid-compat",[Ld]:"fire-fcm",[Bd]:"fire-fcm-compat",[Fd]:"fire-perf",[zd]:"fire-perf-compat",[jd]:"fire-rc",[qd]:"fire-rc-compat",[Wd]:"fire-gcs",[Hd]:"fire-gcs-compat",[Ud]:"fire-fst",[Gd]:"fire-fst-compat","fire-js":"fire-js",[Vd]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bi=new Map,zs=new Map;function Qd(n,e){try{n.container.addComponent(e)}catch(t){mn.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Fi(n){const e=n.name;if(zs.has(e))return mn.debug(`There were multiple attempts to register component ${e}.`),!1;zs.set(e,n);for(const t of Bi.values())Qd(t,n);return!0}function Xd(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jd={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},Jt=new ya("app","Firebase",Jd);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zd{constructor(e,t,i){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new ri("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Jt.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xd=Kd;function Sa(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i=Object.assign({name:Fs,automaticDataCollectionEnabled:!1},e),s=i.name;if(typeof s!="string"||!s)throw Jt.create("bad-app-name",{appName:String(s)});if(t||(t=ga()),!t)throw Jt.create("no-options");const o=Bi.get(s);if(o){if(Ps(t,o.options)&&Ps(i,o.config))return o;throw Jt.create("duplicate-app",{appName:s})}const r=new sd(s);for(const a of zs.values())r.addComponent(a);const l=new Zd(t,i,r);return Bi.set(s,l),l}function $d(n=Fs){const e=Bi.get(n);if(!e&&n===Fs&&ga())return Sa();if(!e)throw Jt.create("no-app",{appName:n});return e}function Dn(n,e,t){var i;let s=(i=Yd[n])!==null&&i!==void 0?i:n;t&&(s+=`-${t}`);const o=s.match(/\s|\//),r=e.match(/\s|\//);if(o||r){const l=[`Unable to register library "${s}" with version "${e}":`];o&&l.push(`library name "${s}" contains illegal characters (whitespace or "/")`),o&&r&&l.push("and"),r&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),mn.warn(l.join(" "));return}Fi(new ri(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ef="firebase-heartbeat-database",tf=1,li="firebase-heartbeat-store";let ks=null;function Ia(){return ks||(ks=gd(ef,tf,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(li)}}}).catch(n=>{throw Jt.create("idb-open",{originalErrorMessage:n.message})})),ks}async function nf(n){try{return await(await Ia()).transaction(li).objectStore(li).get(Ta(n))}catch(e){if(e instanceof gi)mn.warn(e.message);else{const t=Jt.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});mn.warn(t.message)}}}async function er(n,e){try{const i=(await Ia()).transaction(li,"readwrite");await i.objectStore(li).put(e,Ta(n)),await i.done}catch(t){if(t instanceof gi)mn.warn(t.message);else{const i=Jt.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});mn.warn(i.message)}}}function Ta(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sf=1024,of=30*24*60*60*1e3;class rf{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new af(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var e;const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=tr();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)))return this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const r=new Date(o.date).valueOf();return Date.now()-r<=of}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var e;if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=tr(),{heartbeatsToSend:i,unsentEntries:s}=lf(this._heartbeatsCache.heartbeats),o=Mi(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=t,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}}function tr(){return new Date().toISOString().substring(0,10)}function lf(n,e=sf){const t=[];let i=n.slice();for(const s of n){const o=t.find(r=>r.agent===s.agent);if(o){if(o.dates.push(s.date),nr(t)>e){o.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),nr(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class af{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Vu()?Ku().then(()=>!0).catch(()=>!1):!1}async read(){return await this._canUseIndexedDBPromise?await nf(this.app)||{heartbeats:[]}:{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return er(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return er(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function nr(n){return Mi(JSON.stringify({version:2,heartbeats:n})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cf(n){Fi(new ri("platform-logger",e=>new yd(e),"PRIVATE")),Fi(new ri("heartbeat",e=>new rf(e),"PRIVATE")),Dn(Bs,$o,n),Dn(Bs,$o,"esm2017"),Dn("fire-js","")}cf("");var uf="firebase",df="10.6.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Dn(uf,df,"app");const ir="@firebase/database",sr="1.0.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Na="";function ff(n){Na=n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hf{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),tt(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:oi(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _f{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return Wt(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oa=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){const e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new hf(e)}}catch{}return new _f},un=Oa("localStorage"),js=Oa("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rn=new ka("@firebase/database"),pf=function(){let n=1;return function(){return n++}}(),Da=function(n){const e=ed(n),t=new $u;t.update(e);const i=t.digest();return ro.encodeByteArray(i)},bi=function(...n){let e="";for(let t=0;t<n.length;t++){const i=n[t];Array.isArray(i)||i&&typeof i=="object"&&typeof i.length=="number"?e+=bi.apply(null,i):typeof i=="object"?e+=tt(i):e+=i,e+=" "}return e};let hn=null,or=!0;const mf=function(n,e){$(!e||n===!0||n===!1,"Can't turn on custom loggers persistently."),n===!0?(Rn.logLevel=He.VERBOSE,hn=Rn.log.bind(Rn),e&&js.set("logging_enabled",!0)):typeof n=="function"?hn=n:(hn=null,js.remove("logging_enabled"))},dt=function(...n){if(or===!0&&(or=!1,hn===null&&js.get("logging_enabled")===!0&&mf(!0)),hn){const e=bi.apply(null,n);hn(e)}},vi=function(n){return function(...e){dt(n,...e)}},qs=function(...n){const e="FIREBASE INTERNAL ERROR: "+bi(...n);Rn.error(e)},Gt=function(...n){const e=`FIREBASE FATAL ERROR: ${bi(...n)}`;throw Rn.error(e),new Error(e)},yt=function(...n){const e="FIREBASE WARNING: "+bi(...n);Rn.warn(e)},gf=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&yt("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},co=function(n){return typeof n=="number"&&(n!==n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},bf=function(n){if(document.readyState==="complete")n();else{let e=!1;const t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,n())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},gn="[MIN_NAME]",tn="[MAX_NAME]",Un=function(n,e){if(n===e)return 0;if(n===gn||e===tn)return-1;if(e===gn||n===tn)return 1;{const t=rr(n),i=rr(e);return t!==null?i!==null?t-i===0?n.length-e.length:t-i:-1:i!==null?1:n<e?-1:1}},vf=function(n,e){return n===e?0:n<e?-1:1},Xn=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+tt(e))},uo=function(n){if(typeof n!="object"||n===null)return tt(n);const e=[];for(const i in n)e.push(i);e.sort();let t="{";for(let i=0;i<e.length;i++)i!==0&&(t+=","),t+=tt(e[i]),t+=":",t+=uo(n[e[i]]);return t+="}",t},Ra=function(n,e){const t=n.length;if(t<=e)return[n];const i=[];for(let s=0;s<t;s+=e)s+e>t?i.push(n.substring(s,t)):i.push(n.substring(s,s+e));return i};function wt(n,e){for(const t in n)n.hasOwnProperty(t)&&e(t,n[t])}const Aa=function(n){$(!co(n),"Invalid JSON number");const e=11,t=52,i=(1<<e-1)-1;let s,o,r,l,a;n===0?(o=0,r=0,s=1/n===-1/0?1:0):(s=n<0,n=Math.abs(n),n>=Math.pow(2,1-i)?(l=Math.min(Math.floor(Math.log(n)/Math.LN2),i),o=l+i,r=Math.round(n*Math.pow(2,t-l)-Math.pow(2,t))):(o=0,r=Math.round(n/Math.pow(2,1-i-t))));const c=[];for(a=t;a;a-=1)c.push(r%2?1:0),r=Math.floor(r/2);for(a=e;a;a-=1)c.push(o%2?1:0),o=Math.floor(o/2);c.push(s?1:0),c.reverse();const u=c.join("");let d="";for(a=0;a<64;a+=8){let f=parseInt(u.substr(a,8),2).toString(16);f.length===1&&(f="0"+f),d=d+f}return d.toLowerCase()},yf=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},wf=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function kf(n,e){let t="Unknown Error";n==="too_big"?t="The data requested exceeds the maximum size that can be accessed with a single request.":n==="permission_denied"?t="Client doesn't have permission to access the desired data.":n==="unavailable"&&(t="The service is unavailable");const i=new Error(n+" at "+e._path.toString()+": "+t);return i.code=n.toUpperCase(),i}const Cf=new RegExp("^-?(0*)\\d{1,10}$"),Ef=-2147483648,Sf=2147483647,rr=function(n){if(Cf.test(n)){const e=Number(n);if(e>=Ef&&e<=Sf)return e}return null},Gn=function(n){try{n()}catch(e){setTimeout(()=>{const t=e.stack||"";throw yt("Exception was thrown by user callback.",t),e},Math.floor(0))}},If=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},ei=function(n,e){const t=setTimeout(n,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tf{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=t==null?void 0:t.getImmediate({optional:!0}),this.appCheck||t==null||t.get().then(i=>this.appCheck=i)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,i)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,i):t(null)},0)})}addTokenChangeListener(e){var t;(t=this.appCheckProvider)===null||t===void 0||t.get().then(i=>i.addTokenListener(e))}notifyForInvalidToken(){yt(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nf{constructor(e,t,i){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=i,this.auth_=null,this.auth_=i.getImmediate({optional:!0}),this.auth_||i.onInit(s=>this.auth_=s)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(dt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,i)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,i):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',yt(e)}}class An{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}An.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fo="5",Pa="v",Ma="s",La="r",Ba="f",Fa=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,za="ls",ja="p",Ws="ac",qa="websocket",Wa="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ha{constructor(e,t,i,s,o=!1,r="",l=!1,a=!1){this.secure=t,this.namespace=i,this.webSocketOnly=s,this.nodeAdmin=o,this.persistenceKey=r,this.includeNamespaceInQueryParams=l,this.isUsingEmulator=a,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=un.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&un.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}}function Of(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams}function Ua(n,e,t){$(typeof e=="string","typeof type must == string"),$(typeof t=="object","typeof params must == object");let i;if(e===qa)i=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else if(e===Wa)i=(n.secure?"https://":"http://")+n.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);Of(n)&&(t.ns=n.namespace);const s=[];return wt(t,(o,r)=>{s.push(o+"="+r)}),i+s.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Df{constructor(){this.counters_={}}incrementCounter(e,t=1){Wt(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return Mu(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cs={},Es={};function ho(n){const e=n.toString();return Cs[e]||(Cs[e]=new Df),Cs[e]}function Rf(n,e){const t=n.toString();return Es[t]||(Es[t]=e()),Es[t]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Af{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const i=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let s=0;s<i.length;++s)i[s]&&Gn(()=>{this.onMessage_(i[s])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lr="start",Pf="close",Mf="pLPCommand",Lf="pRTLPCB",Ga="id",Va="pw",Ka="ser",Bf="cb",Ff="seg",zf="ts",jf="d",qf="dframe",Ya=1870,Qa=30,Wf=Ya-Qa,Hf=25e3,Uf=3e4;class In{constructor(e,t,i,s,o,r,l){this.connId=e,this.repoInfo=t,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.transportSessionId=r,this.lastSessionId=l,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=vi(e),this.stats_=ho(t),this.urlFn=a=>(this.appCheckToken&&(a[Ws]=this.appCheckToken),Ua(t,Wa,a))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new Af(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(Uf)),bf(()=>{if(this.isClosed_)return;this.scriptTagHolder=new _o((...o)=>{const[r,l,a,c,u]=o;if(this.incrementIncomingBytes_(o),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,r===lr)this.id=l,this.password=a;else if(r===Pf)l?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(l,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+r)},(...o)=>{const[r,l]=o;this.incrementIncomingBytes_(o),this.myPacketOrderer.handleResponse(r,l)},()=>{this.onClosed_()},this.urlFn);const i={};i[lr]="t",i[Ka]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(i[Bf]=this.scriptTagHolder.uniqueCallbackIdentifier),i[Pa]=fo,this.transportSessionId&&(i[Ma]=this.transportSessionId),this.lastSessionId&&(i[za]=this.lastSessionId),this.applicationId&&(i[ja]=this.applicationId),this.appCheckToken&&(i[Ws]=this.appCheckToken),typeof location<"u"&&location.hostname&&Fa.test(location.hostname)&&(i[La]=Ba);const s=this.urlFn(i);this.log_("Connecting via long-poll to "+s),this.scriptTagHolder.addTag(s,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){In.forceAllow_=!0}static forceDisallow(){In.forceDisallow_=!0}static isAvailable(){return In.forceAllow_?!0:!In.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!yf()&&!wf()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=tt(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const i=_a(t),s=Ra(i,Wf);for(let o=0;o<s.length;o++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,s.length,s[o]),this.curSegmentNum++}addDisconnectPingFrame(e,t){this.myDisconnFrame=document.createElement("iframe");const i={};i[qf]="t",i[Ga]=e,i[Va]=t,this.myDisconnFrame.src=this.urlFn(i),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=tt(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class _o{constructor(e,t,i,s){this.onDisconnect=i,this.urlFn=s,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=pf(),window[Mf+this.uniqueCallbackIdentifier]=e,window[Lf+this.uniqueCallbackIdentifier]=t,this.myIFrame=_o.createIFrame_();let o="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(o='<script>document.domain="'+document.domain+'";<\/script>');const r="<html><body>"+o+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(r),this.myIFrame.doc.close()}catch(l){dt("frame writing exception"),l.stack&&dt(l.stack),dt(l)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||dt("No IE domain setting required")}catch{const i=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+i+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[Ga]=this.myID,e[Va]=this.myPW,e[Ka]=this.currentSerial;let t=this.urlFn(e),i="",s=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+Qa+i.length<=Ya;){const r=this.pendingSegs.shift();i=i+"&"+Ff+s+"="+r.seg+"&"+zf+s+"="+r.ts+"&"+jf+s+"="+r.d,s++}return t=t+i,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,i){this.pendingSegs.push({seg:e,ts:t,d:i}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const i=()=>{this.outstandingRequests.delete(t),this.newRequest_()},s=setTimeout(i,Math.floor(Hf)),o=()=>{clearTimeout(s),i()};this.addTag(e,o)}addTag(e,t){setTimeout(()=>{try{if(!this.sendNewPolls)return;const i=this.myIFrame.doc.createElement("script");i.type="text/javascript",i.async=!0,i.src=e,i.onload=i.onreadystatechange=function(){const s=i.readyState;(!s||s==="loaded"||s==="complete")&&(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),t())},i.onerror=()=>{dt("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(i)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gf=16384,Vf=45e3;let zi=null;typeof MozWebSocket<"u"?zi=MozWebSocket:typeof WebSocket<"u"&&(zi=WebSocket);class Nt{constructor(e,t,i,s,o,r,l){this.connId=e,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=vi(this.connId),this.stats_=ho(t),this.connURL=Nt.connectionURL_(t,r,l,s,i),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,i,s,o){const r={};return r[Pa]=fo,typeof location<"u"&&location.hostname&&Fa.test(location.hostname)&&(r[La]=Ba),t&&(r[Ma]=t),i&&(r[za]=i),s&&(r[Ws]=s),o&&(r[ja]=o),Ua(e,qa,r)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,un.set("previous_websocket_failure",!0);try{let i;va(),this.mySock=new zi(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");const s=i.message||i.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");const s=i.message||i.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){Nt.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(t);i&&i.length>1&&parseFloat(i[1])<4.4&&(e=!0)}return!e&&zi!==null&&!Nt.forceDisallow_}static previouslyFailed(){return un.isInMemoryStorage||un.get("previous_websocket_failure")===!0}markConnectionHealthy(){un.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const t=this.frames.join("");this.frames=null;const i=oi(t);this.onMessage(i)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if($(this.frames===null,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(t);else{const i=this.extractFrameCount_(t);i!==null&&this.appendFrame_(i)}}send(e){this.resetKeepAlive();const t=tt(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const i=Ra(t,Gf);i.length>1&&this.sendString_(String(i.length));for(let s=0;s<i.length;s++)this.sendString_(i[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(Vf))}sendString_(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}Nt.responsesRequiredToBeHealthy=2;Nt.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ai{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[In,Nt]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const t=Nt&&Nt.isAvailable();let i=t&&!Nt.previouslyFailed();if(e.webSocketOnly&&(t||yt("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[Nt];else{const s=this.transports_=[];for(const o of ai.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);ai.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}ai.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kf=6e4,Yf=5e3,Qf=10*1024,Xf=100*1024,Ss="t",ar="d",Jf="s",cr="r",Zf="e",ur="o",dr="a",fr="n",hr="p",xf="h";class $f{constructor(e,t,i,s,o,r,l,a,c,u){this.id=e,this.repoInfo_=t,this.applicationId_=i,this.appCheckToken_=s,this.authToken_=o,this.onMessage_=r,this.onReady_=l,this.onDisconnect_=a,this.onKill_=c,this.lastSessionId=u,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=vi("c:"+this.id+":"),this.transportManager_=new ai(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),i=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,i)},Math.floor(0));const s=e.healthyTimeout||0;s>0&&(this.healthyTimeout_=ei(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>Xf?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>Qf?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(s)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(Ss in e){const t=e[Ss];t===dr?this.upgradeIfSecondaryHealthy_():t===cr?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===ur&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=Xn("t",e),i=Xn("d",e);if(t==="c")this.onSecondaryControl_(i);else if(t==="d")this.pendingDataMessages.push(i);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:hr,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:dr,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:fr,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=Xn("t",e),i=Xn("d",e);t==="c"?this.onControl_(i):t==="d"&&this.onDataMessage_(i)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=Xn(Ss,e);if(ar in e){const i=e[ar];if(t===xf){const s=Object.assign({},i);this.repoInfo_.isUsingEmulator&&(s.h=this.repoInfo_.host),this.onHandshake_(s)}else if(t===fr){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let s=0;s<this.pendingDataMessages.length;++s)this.onDataMessage_(this.pendingDataMessages[s]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===Jf?this.onConnectionShutdown_(i):t===cr?this.onReset_(i):t===Zf?qs("Server Error: "+i):t===ur?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):qs("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,i=e.v,s=e.h;this.sessionId=e.s,this.repoInfo_.host=s,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),fo!==i&&yt("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),i=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,i),ei(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(Kf))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):ei(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(Yf))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:hr,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(un.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xa{put(e,t,i,s){}merge(e,t,i,s){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,i){}onDisconnectMerge(e,t,i){}onDisconnectCancel(e,t){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ja{constructor(e){this.allowedEvents_=e,this.listeners_={},$(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const i=[...this.listeners_[e]];for(let s=0;s<i.length;s++)i[s].callback.apply(i[s].context,t)}}on(e,t,i){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:i});const s=this.getInitialEvent(e);s&&t.apply(i,s)}off(e,t,i){this.validateEventType_(e);const s=this.listeners_[e]||[];for(let o=0;o<s.length;o++)if(s[o].callback===t&&(!i||i===s[o].context)){s.splice(o,1);return}}validateEventType_(e){$(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ji extends Ja{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!ba()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new ji}getInitialEvent(e){return $(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _r=32,pr=768;class We{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let i=0;for(let s=0;s<this.pieces_.length;s++)this.pieces_[s].length>0&&(this.pieces_[i]=this.pieces_[s],i++);this.pieces_.length=i,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}}function Be(){return new We("")}function Ee(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function nn(n){return n.pieces_.length-n.pieceNum_}function Ue(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new We(n.pieces_,e)}function Za(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function eh(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)n.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}function xa(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function $a(n){if(n.pieceNum_>=n.pieces_.length)return null;const e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new We(e,0)}function nt(n,e){const t=[];for(let i=n.pieceNum_;i<n.pieces_.length;i++)t.push(n.pieces_[i]);if(e instanceof We)for(let i=e.pieceNum_;i<e.pieces_.length;i++)t.push(e.pieces_[i]);else{const i=e.split("/");for(let s=0;s<i.length;s++)i[s].length>0&&t.push(i[s])}return new We(t,0)}function Ce(n){return n.pieceNum_>=n.pieces_.length}function mt(n,e){const t=Ee(n),i=Ee(e);if(t===null)return e;if(t===i)return mt(Ue(n),Ue(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function ec(n,e){if(nn(n)!==nn(e))return!1;for(let t=n.pieceNum_,i=e.pieceNum_;t<=n.pieces_.length;t++,i++)if(n.pieces_[t]!==e.pieces_[i])return!1;return!0}function Ot(n,e){let t=n.pieceNum_,i=e.pieceNum_;if(nn(n)>nn(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[i])return!1;++t,++i}return!0}class th{constructor(e,t){this.errorPrefix_=t,this.parts_=xa(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let i=0;i<this.parts_.length;i++)this.byteLength_+=es(this.parts_[i]);tc(this)}}function nh(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=es(e),tc(n)}function ih(n){const e=n.parts_.pop();n.byteLength_-=es(e),n.parts_.length>0&&(n.byteLength_-=1)}function tc(n){if(n.byteLength_>pr)throw new Error(n.errorPrefix_+"has a key path longer than "+pr+" bytes ("+n.byteLength_+").");if(n.parts_.length>_r)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+_r+") or object contains a cycle "+an(n))}function an(n){return n.parts_.length===0?"":"in property '"+n.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class po extends Ja{constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const i=!document[e];i!==this.visible_&&(this.visible_=i,this.trigger("visible",i))},!1)}static getInstance(){return new po}getInitialEvent(e){return $(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jn=1e3,sh=60*5*1e3,mr=30*1e3,oh=1.3,rh=3e4,lh="server_kill",gr=3;class Ut extends Xa{constructor(e,t,i,s,o,r,l,a){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=i,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=r,this.appCheckTokenProvider_=l,this.authOverride_=a,this.id=Ut.nextPersistentConnectionId_++,this.log_=vi("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Jn,this.maxReconnectDelay_=sh,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,a&&!va())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");po.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&ji.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,i){const s=++this.requestNumber_,o={r:s,a:e,b:t};this.log_(tt(o)),$(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),i&&(this.requestCBHash_[s]=i)}get(e){this.initConnection_();const t=new $i,s={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:r=>{const l=r.d;r.s==="ok"?t.resolve(l):t.reject(l)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;const o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),t.promise}listen(e,t,i,s){this.initConnection_();const o=e._queryIdentifier,r=e._path.toString();this.log_("Listen called for "+r+" "+o),this.listens.has(r)||this.listens.set(r,new Map),$(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),$(!this.listens.get(r).has(o),"listen() called twice for same path/queryId.");const l={onComplete:s,hashFn:t,query:e,tag:i};this.listens.get(r).set(o,l),this.connected_&&this.sendListen_(l)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,i=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(i)})}sendListen_(e){const t=e.query,i=t._path.toString(),s=t._queryIdentifier;this.log_("Listen on "+i+" for "+s);const o={p:i},r="q";e.tag&&(o.q=t._queryObject,o.t=e.tag),o.h=e.hashFn(),this.sendRequest(r,o,l=>{const a=l.d,c=l.s;Ut.warnOnListenWarnings_(a,t),(this.listens.get(i)&&this.listens.get(i).get(s))===e&&(this.log_("listen response",l),c!=="ok"&&this.removeListen_(i,s),e.onComplete&&e.onComplete(c,a))})}static warnOnListenWarnings_(e,t){if(e&&typeof e=="object"&&Wt(e,"w")){const i=Ln(e,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){const s='".indexOn": "'+t._queryParams.getIndex().toString()+'"',o=t._path.toString();yt(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||Zu(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=mr)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=Ju(e)?"auth":"gauth",i={cred:e};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(t,i,s=>{const o=s.s,r=s.d||"error";this.authToken_===e&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,r))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const t=e.s,i=e.d||"error";t==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,i)})}unlisten(e,t){const i=e._path.toString(),s=e._queryIdentifier;this.log_("Unlisten called for "+i+" "+s),$(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,s)&&this.connected_&&this.sendUnlisten_(i,s,e._queryObject,t)}sendUnlisten_(e,t,i,s){this.log_("Unlisten on "+e+" for "+t);const o={p:e},r="n";s&&(o.q=i,o.t=s),this.sendRequest(r,o)}onDisconnectPut(e,t,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,i):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:i})}onDisconnectMerge(e,t,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,i):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:i})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,i,s){const o={p:t,d:i};this.log_("onDisconnect "+e,o),this.sendRequest(e,o,r=>{s&&setTimeout(()=>{s(r.s,r.d)},Math.floor(0))})}put(e,t,i,s){this.putInternal("p",e,t,i,s)}merge(e,t,i,s){this.putInternal("m",e,t,i,s)}putInternal(e,t,i,s,o){this.initConnection_();const r={p:t,d:i};o!==void 0&&(r.h=o),this.outstandingPuts_.push({action:e,request:r,onComplete:s}),this.outstandingPutCount_++;const l=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(l):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,i=this.outstandingPuts_[e].request,s=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,i,o=>{this.log_(t+" response",o),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,i=>{if(i.s!=="ok"){const o=i.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+tt(e));const t=e.r,i=this.requestCBHash_[t];i&&(delete this.requestCBHash_[t],i(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),e==="d"?this.onDataUpdate_(t.p,t.d,!1,t.t):e==="m"?this.onDataUpdate_(t.p,t.d,!0,t.t):e==="c"?this.onListenRevoked_(t.p,t.q):e==="ac"?this.onAuthRevoked_(t.s,t.d):e==="apc"?this.onAppCheckRevoked_(t.s,t.d):e==="sd"?this.onSecurityDebugPacket_(t):qs("Unrecognized action received from server: "+tt(e)+`
Are you using the latest client?`)}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){$(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Jn,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=Jn,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>rh&&(this.reconnectDelay_=Jn),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=new Date().getTime()-this.lastConnectionAttemptTime_;let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*oh)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+Ut.nextConnectionId_++,o=this.lastSessionId;let r=!1,l=null;const a=function(){l?l.close():(r=!0,i())},c=function(d){$(l,"sendRequest call when we're not connected not allowed."),l.sendRequest(d)};this.realtime_={close:a,sendRequest:c};const u=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[d,f]=await Promise.all([this.authTokenProvider_.getToken(u),this.appCheckTokenProvider_.getToken(u)]);r?dt("getToken() completed but was canceled"):(dt("getToken() completed. Creating connection."),this.authToken_=d&&d.accessToken,this.appCheckToken_=f&&f.token,l=new $f(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,i,_=>{yt(_+" ("+this.repoInfo_.toString()+")"),this.interrupt(lh)},o))}catch(d){this.log_("Failed to get token: "+d),r||(this.repoInfo_.nodeAdmin&&yt(d),a())}}}interrupt(e){dt("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){dt("Resuming connection for reason: "+e),delete this.interruptReasons_[e],Qo(this.interruptReasons_)&&(this.reconnectDelay_=Jn,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let i;t?i=t.map(o=>uo(o)).join("$"):i="default";const s=this.removeListen_(e,i);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(e,t){const i=new We(e).toString();let s;if(this.listens.has(i)){const o=this.listens.get(i);s=o.get(t),o.delete(t),o.size===0&&this.listens.delete(i)}else s=void 0;return s}onAuthRevoked_(e,t){dt("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=gr&&(this.reconnectDelay_=mr,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){dt("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=gr&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let t="js";e["sdk."+t+"."+Na.replace(/\./g,"-")]=1,ba()?e["framework.cordova"]=1:Gu()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=ji.getInstance().currentlyOnline();return Qo(this.interruptReasons_)&&e}}Ut.nextPersistentConnectionId_=0;Ut.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ye{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new ye(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ts{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const i=new ye(gn,e),s=new ye(gn,t);return this.compare(i,s)!==0}minPost(){return ye.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ii;class nc extends ts{static get __EMPTY_NODE(){return Ii}static set __EMPTY_NODE(e){Ii=e}compare(e,t){return Un(e.name,t.name)}isDefinedOn(e){throw Hn("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return ye.MIN}maxPost(){return new ye(tn,Ii)}makePost(e,t){return $(typeof e=="string","KeyIndex indexValue must always be a string."),new ye(e,Ii)}toString(){return".key"}}const Zt=new nc;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ti{constructor(e,t,i,s,o=null){this.isReverse_=s,this.resultGenerator_=o,this.nodeStack_=[];let r=1;for(;!e.isEmpty();)if(e=e,r=t?i(e.key,t):1,s&&(r*=-1),r<0)this.isReverse_?e=e.left:e=e.right;else if(r===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class rt{constructor(e,t,i,s,o){this.key=e,this.value=t,this.color=i??rt.RED,this.left=s??vt.EMPTY_NODE,this.right=o??vt.EMPTY_NODE}copy(e,t,i,s,o){return new rt(e??this.key,t??this.value,i??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let s=this;const o=i(e,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(e,t,i),null):o===0?s=s.copy(null,t,null,null,null):s=s.copy(null,null,null,null,s.right.insert(e,t,i)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return vt.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let i,s;if(i=this,t(e,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),t(e,i.key)===0){if(i.right.isEmpty())return vt.EMPTY_NODE;s=i.right.min_(),i=i.copy(s.key,s.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,rt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,rt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}rt.RED=!0;rt.BLACK=!1;class ah{copy(e,t,i,s,o){return this}insert(e,t,i){return new rt(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class vt{constructor(e,t=vt.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new vt(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,rt.BLACK,null,null))}remove(e){return new vt(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,rt.BLACK,null,null))}get(e){let t,i=this.root_;for(;!i.isEmpty();){if(t=this.comparator_(e,i.key),t===0)return i.value;t<0?i=i.left:t>0&&(i=i.right)}return null}getPredecessorKey(e){let t,i=this.root_,s=null;for(;!i.isEmpty();)if(t=this.comparator_(e,i.key),t===0){if(i.left.isEmpty())return s?s.key:null;for(i=i.left;!i.right.isEmpty();)i=i.right;return i.key}else t<0?i=i.left:t>0&&(s=i,i=i.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Ti(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Ti(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Ti(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Ti(this.root_,null,this.comparator_,!0,e)}}vt.EMPTY_NODE=new ah;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ch(n,e){return Un(n.name,e.name)}function mo(n,e){return Un(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Hs;function uh(n){Hs=n}const ic=function(n){return typeof n=="number"?"number:"+Aa(n):"string:"+n},sc=function(n){if(n.isLeafNode()){const e=n.val();$(typeof e=="string"||typeof e=="number"||typeof e=="object"&&Wt(e,".sv"),"Priority must be a string or number.")}else $(n===Hs||n.isEmpty(),"priority of unexpected type.");$(n===Hs||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let br;class ot{constructor(e,t=ot.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,$(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),sc(this.priorityNode_)}static set __childrenNodeConstructor(e){br=e}static get __childrenNodeConstructor(){return br}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new ot(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:ot.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return Ce(e)?this:Ee(e)===".priority"?this.priorityNode_:ot.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return e===".priority"?this.updatePriority(t):t.isEmpty()&&e!==".priority"?this:ot.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const i=Ee(e);return i===null?t:t.isEmpty()&&i!==".priority"?this:($(i!==".priority"||nn(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,ot.__childrenNodeConstructor.EMPTY_NODE.updateChild(Ue(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+ic(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",t==="number"?e+=Aa(this.value_):e+=this.value_,this.lazyHash_=Da(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===ot.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof ot.__childrenNodeConstructor?-1:($(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,i=typeof this.value_,s=ot.VALUE_TYPE_ORDER.indexOf(t),o=ot.VALUE_TYPE_ORDER.indexOf(i);return $(s>=0,"Unknown leaf type: "+t),$(o>=0,"Unknown leaf type: "+i),s===o?i==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}else return!1}}ot.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let oc,rc;function dh(n){oc=n}function fh(n){rc=n}class hh extends ts{compare(e,t){const i=e.node.getPriority(),s=t.node.getPriority(),o=i.compareTo(s);return o===0?Un(e.name,t.name):o}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return ye.MIN}maxPost(){return new ye(tn,new ot("[PRIORITY-POST]",rc))}makePost(e,t){const i=oc(e);return new ye(t,new ot("[PRIORITY-POST]",i))}toString(){return".priority"}}const Je=new hh;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _h=Math.log(2);class ph{constructor(e){const t=o=>parseInt(Math.log(o)/_h,10),i=o=>parseInt(Array(o+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;const s=i(this.count);this.bits_=e+1&s}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const qi=function(n,e,t,i){n.sort(e);const s=function(a,c){const u=c-a;let d,f;if(u===0)return null;if(u===1)return d=n[a],f=t?t(d):d,new rt(f,d.node,rt.BLACK,null,null);{const _=parseInt(u/2,10)+a,h=s(a,_),b=s(_+1,c);return d=n[_],f=t?t(d):d,new rt(f,d.node,rt.BLACK,h,b)}},o=function(a){let c=null,u=null,d=n.length;const f=function(h,b){const v=d-h,w=d;d-=h;const k=s(v+1,w),y=n[v],T=t?t(y):y;_(new rt(T,y.node,b,null,k))},_=function(h){c?(c.left=h,c=h):(u=h,c=h)};for(let h=0;h<a.count;++h){const b=a.nextBitIsOne(),v=Math.pow(2,a.count-(h+1));b?f(v,rt.BLACK):(f(v,rt.BLACK),f(v,rt.RED))}return u},r=new ph(n.length),l=o(r);return new vt(i||e,l)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Is;const En={};class Ht{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return $(En&&Je,"ChildrenNode.ts has not been loaded"),Is=Is||new Ht({".priority":En},{".priority":Je}),Is}get(e){const t=Ln(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof vt?t:null}hasIndex(e){return Wt(this.indexSet_,e.toString())}addIndex(e,t){$(e!==Zt,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const i=[];let s=!1;const o=t.getIterator(ye.Wrap);let r=o.getNext();for(;r;)s=s||e.isDefinedOn(r.node),i.push(r),r=o.getNext();let l;s?l=qi(i,e.getCompare()):l=En;const a=e.toString(),c=Object.assign({},this.indexSet_);c[a]=e;const u=Object.assign({},this.indexes_);return u[a]=l,new Ht(u,c)}addToIndexes(e,t){const i=Li(this.indexes_,(s,o)=>{const r=Ln(this.indexSet_,o);if($(r,"Missing index implementation for "+o),s===En)if(r.isDefinedOn(e.node)){const l=[],a=t.getIterator(ye.Wrap);let c=a.getNext();for(;c;)c.name!==e.name&&l.push(c),c=a.getNext();return l.push(e),qi(l,r.getCompare())}else return En;else{const l=t.get(e.name);let a=s;return l&&(a=a.remove(new ye(e.name,l))),a.insert(e,e.node)}});return new Ht(i,this.indexSet_)}removeFromIndexes(e,t){const i=Li(this.indexes_,s=>{if(s===En)return s;{const o=t.get(e.name);return o?s.remove(new ye(e.name,o)):s}});return new Ht(i,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Zn;class he{constructor(e,t,i){this.children_=e,this.priorityNode_=t,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&sc(this.priorityNode_),this.children_.isEmpty()&&$(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Zn||(Zn=new he(new vt(mo),null,Ht.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Zn}updatePriority(e){return this.children_.isEmpty()?this:new he(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const t=this.children_.get(e);return t===null?Zn:t}}getChild(e){const t=Ee(e);return t===null?this:this.getImmediateChild(t).getChild(Ue(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,t){if($(t,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(t);{const i=new ye(e,t);let s,o;t.isEmpty()?(s=this.children_.remove(e),o=this.indexMap_.removeFromIndexes(i,this.children_)):(s=this.children_.insert(e,t),o=this.indexMap_.addToIndexes(i,this.children_));const r=s.isEmpty()?Zn:this.priorityNode_;return new he(s,r,o)}}updateChild(e,t){const i=Ee(e);if(i===null)return t;{$(Ee(e)!==".priority"||nn(e)===1,".priority must be the last token in a path");const s=this.getImmediateChild(i).updateChild(Ue(e),t);return this.updateImmediateChild(i,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let i=0,s=0,o=!0;if(this.forEachChild(Je,(r,l)=>{t[r]=l.val(e),i++,o&&he.INTEGER_REGEXP_.test(r)?s=Math.max(s,Number(r)):o=!1}),!e&&o&&s<2*i){const r=[];for(const l in t)r[l]=t[l];return r}else return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+ic(this.getPriority().val())+":"),this.forEachChild(Je,(t,i)=>{const s=i.hash();s!==""&&(e+=":"+t+":"+s)}),this.lazyHash_=e===""?"":Da(e)}return this.lazyHash_}getPredecessorChildName(e,t,i){const s=this.resolveIndex_(i);if(s){const o=s.getPredecessorKey(new ye(e,t));return o?o.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const i=t.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new ye(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const i=t.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new ye(t,this.children_.get(t)):null}forEachChild(e,t){const i=this.resolveIndex_(e);return i?i.inorderTraversal(s=>t(s.name,s.node)):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const i=this.resolveIndex_(t);if(i)return i.getIteratorFrom(e,s=>s);{const s=this.children_.getIteratorFrom(e.name,ye.Wrap);let o=s.peek();for(;o!=null&&t.compare(o,e)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const i=this.resolveIndex_(t);if(i)return i.getReverseIteratorFrom(e,s=>s);{const s=this.children_.getReverseIteratorFrom(e.name,ye.Wrap);let o=s.peek();for(;o!=null&&t.compare(o,e)>0;)s.getNext(),o=s.peek();return s}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===yi?-1:0}withIndex(e){if(e===Zt||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new he(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===Zt||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority()))if(this.children_.count()===t.children_.count()){const i=this.getIterator(Je),s=t.getIterator(Je);let o=i.getNext(),r=s.getNext();for(;o&&r;){if(o.name!==r.name||!o.node.equals(r.node))return!1;o=i.getNext(),r=s.getNext()}return o===null&&r===null}else return!1;else return!1}}resolveIndex_(e){return e===Zt?null:this.indexMap_.get(e.toString())}}he.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class mh extends he{constructor(){super(new vt(mo),he.EMPTY_NODE,Ht.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return he.EMPTY_NODE}isEmpty(){return!1}}const yi=new mh;Object.defineProperties(ye,{MIN:{value:new ye(gn,he.EMPTY_NODE)},MAX:{value:new ye(tn,yi)}});nc.__EMPTY_NODE=he.EMPTY_NODE;ot.__childrenNodeConstructor=he;uh(yi);fh(yi);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gh=!0;function lt(n,e=null){if(n===null)return he.EMPTY_NODE;if(typeof n=="object"&&".priority"in n&&(e=n[".priority"]),$(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof n=="object"&&".value"in n&&n[".value"]!==null&&(n=n[".value"]),typeof n!="object"||".sv"in n){const t=n;return new ot(t,lt(e))}if(!(n instanceof Array)&&gh){const t=[];let i=!1;if(wt(n,(r,l)=>{if(r.substring(0,1)!=="."){const a=lt(l);a.isEmpty()||(i=i||!a.getPriority().isEmpty(),t.push(new ye(r,a)))}}),t.length===0)return he.EMPTY_NODE;const o=qi(t,ch,r=>r.name,mo);if(i){const r=qi(t,Je.getCompare());return new he(o,lt(e),new Ht({".priority":r},{".priority":Je}))}else return new he(o,lt(e),Ht.Default)}else{let t=he.EMPTY_NODE;return wt(n,(i,s)=>{if(Wt(n,i)&&i.substring(0,1)!=="."){const o=lt(s);(o.isLeafNode()||!o.isEmpty())&&(t=t.updateImmediateChild(i,o))}}),t.updatePriority(lt(e))}}dh(lt);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lc extends ts{constructor(e){super(),this.indexPath_=e,$(!Ce(e)&&Ee(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const i=this.extractChild(e.node),s=this.extractChild(t.node),o=i.compareTo(s);return o===0?Un(e.name,t.name):o}makePost(e,t){const i=lt(e),s=he.EMPTY_NODE.updateChild(this.indexPath_,i);return new ye(t,s)}maxPost(){const e=he.EMPTY_NODE.updateChild(this.indexPath_,yi);return new ye(tn,e)}toString(){return xa(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bh extends ts{compare(e,t){const i=e.node.compareTo(t.node);return i===0?Un(e.name,t.name):i}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return ye.MIN}maxPost(){return ye.MAX}makePost(e,t){const i=lt(e);return new ye(t,i)}toString(){return".value"}}const ac=new bh;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cc(n){return{type:"value",snapshotNode:n}}function Bn(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function ci(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function ui(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}function vh(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class go{constructor(e){this.index_=e}updateChild(e,t,i,s,o,r){$(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const l=e.getImmediateChild(t);return l.getChild(s).equals(i.getChild(s))&&l.isEmpty()===i.isEmpty()||(r!=null&&(i.isEmpty()?e.hasChild(t)?r.trackChildChange(ci(t,l)):$(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):l.isEmpty()?r.trackChildChange(Bn(t,i)):r.trackChildChange(ui(t,i,l))),e.isLeafNode()&&i.isEmpty())?e:e.updateImmediateChild(t,i).withIndex(this.index_)}updateFullNode(e,t,i){return i!=null&&(e.isLeafNode()||e.forEachChild(Je,(s,o)=>{t.hasChild(s)||i.trackChildChange(ci(s,o))}),t.isLeafNode()||t.forEachChild(Je,(s,o)=>{if(e.hasChild(s)){const r=e.getImmediateChild(s);r.equals(o)||i.trackChildChange(ui(s,o,r))}else i.trackChildChange(Bn(s,o))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?he.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class di{constructor(e){this.indexedFilter_=new go(e.getIndex()),this.index_=e.getIndex(),this.startPost_=di.getStartPost_(e),this.endPost_=di.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,i=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&i}updateChild(e,t,i,s,o,r){return this.matches(new ye(t,i))||(i=he.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,i,s,o,r)}updateFullNode(e,t,i){t.isLeafNode()&&(t=he.EMPTY_NODE);let s=t.withIndex(this.index_);s=s.updatePriority(he.EMPTY_NODE);const o=this;return t.forEachChild(Je,(r,l)=>{o.matches(new ye(r,l))||(s=s.updateImmediateChild(r,he.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,s,i)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yh{constructor(e){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{const i=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?i<=0:i<0},this.withinEndPost=t=>{const i=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?i<=0:i<0},this.rangedFilter_=new di(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,i,s,o,r){return this.rangedFilter_.matches(new ye(t,i))||(i=he.EMPTY_NODE),e.getImmediateChild(t).equals(i)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,i,s,o,r):this.fullLimitUpdateChild_(e,t,i,o,r)}updateFullNode(e,t,i){let s;if(t.isLeafNode()||t.isEmpty())s=he.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<t.numChildren()&&t.isIndexed(this.index_)){s=he.EMPTY_NODE.withIndex(this.index_);let o;this.reverse_?o=t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):o=t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let r=0;for(;o.hasNext()&&r<this.limit_;){const l=o.getNext();if(this.withinDirectionalStart(l))if(this.withinDirectionalEnd(l))s=s.updateImmediateChild(l.name,l.node),r++;else break;else continue}}else{s=t.withIndex(this.index_),s=s.updatePriority(he.EMPTY_NODE);let o;this.reverse_?o=s.getReverseIterator(this.index_):o=s.getIterator(this.index_);let r=0;for(;o.hasNext();){const l=o.getNext();r<this.limit_&&this.withinDirectionalStart(l)&&this.withinDirectionalEnd(l)?r++:s=s.updateImmediateChild(l.name,he.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,s,i)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,i,s,o){let r;if(this.reverse_){const d=this.index_.getCompare();r=(f,_)=>d(_,f)}else r=this.index_.getCompare();const l=e;$(l.numChildren()===this.limit_,"");const a=new ye(t,i),c=this.reverse_?l.getFirstChild(this.index_):l.getLastChild(this.index_),u=this.rangedFilter_.matches(a);if(l.hasChild(t)){const d=l.getImmediateChild(t);let f=s.getChildAfterChild(this.index_,c,this.reverse_);for(;f!=null&&(f.name===t||l.hasChild(f.name));)f=s.getChildAfterChild(this.index_,f,this.reverse_);const _=f==null?1:r(f,a);if(u&&!i.isEmpty()&&_>=0)return o!=null&&o.trackChildChange(ui(t,i,d)),l.updateImmediateChild(t,i);{o!=null&&o.trackChildChange(ci(t,d));const b=l.updateImmediateChild(t,he.EMPTY_NODE);return f!=null&&this.rangedFilter_.matches(f)?(o!=null&&o.trackChildChange(Bn(f.name,f.node)),b.updateImmediateChild(f.name,f.node)):b}}else return i.isEmpty()?e:u&&r(c,a)>=0?(o!=null&&(o.trackChildChange(ci(c.name,c.node)),o.trackChildChange(Bn(t,i))),l.updateImmediateChild(t,i).updateImmediateChild(c.name,he.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bo{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Je}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return $(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return $(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:gn}hasEnd(){return this.endSet_}getIndexEndValue(){return $(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return $(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:tn}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return $(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Je}copy(){const e=new bo;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function wh(n){return n.loadsAllData()?new go(n.getIndex()):n.hasLimit()?new yh(n):new di(n)}function kh(n,e){const t=n.copy();return t.index_=e,t}function vr(n){const e={};if(n.isDefault())return e;let t;if(n.index_===Je?t="$priority":n.index_===ac?t="$value":n.index_===Zt?t="$key":($(n.index_ instanceof lc,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=tt(t),n.startSet_){const i=n.startAfterSet_?"startAfter":"startAt";e[i]=tt(n.indexStartValue_),n.startNameSet_&&(e[i]+=","+tt(n.indexStartName_))}if(n.endSet_){const i=n.endBeforeSet_?"endBefore":"endAt";e[i]=tt(n.indexEndValue_),n.endNameSet_&&(e[i]+=","+tt(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function yr(n){const e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;t===""&&(n.isViewFromLeft()?t="l":t="r"),e.vf=t}return n.index_!==Je&&(e.i=n.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wi extends Xa{constructor(e,t,i,s){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=i,this.appCheckTokenProvider_=s,this.log_=vi("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:($(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,i,s){const o=e._path.toString();this.log_("Listen called for "+o+" "+e._queryIdentifier);const r=Wi.getListenId_(e,i),l={};this.listens_[r]=l;const a=vr(e._queryParams);this.restRequest_(o+".json",a,(c,u)=>{let d=u;if(c===404&&(d=null,c=null),c===null&&this.onDataUpdate_(o,d,!1,i),Ln(this.listens_,r)===l){let f;c?c===401?f="permission_denied":f="rest_error:"+c:f="ok",s(f,null)}})}unlisten(e,t){const i=Wi.getListenId_(e,t);delete this.listens_[i]}get(e){const t=vr(e._queryParams),i=e._path.toString(),s=new $i;return this.restRequest_(i+".json",t,(o,r)=>{let l=r;o===404&&(l=null,o=null),o===null?(this.onDataUpdate_(i,l,!1,null),s.resolve(l)):s.reject(new Error(l))}),s.promise}refreshAuthToken(e){}restRequest_(e,t={},i){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([s,o])=>{s&&s.accessToken&&(t.auth=s.accessToken),o&&o.token&&(t.ac=o.token);const r=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+xu(t);this.log_("Sending REST request for "+r);const l=new XMLHttpRequest;l.onreadystatechange=()=>{if(i&&l.readyState===4){this.log_("REST Response for "+r+" received. status:",l.status,"response:",l.responseText);let a=null;if(l.status>=200&&l.status<300){try{a=oi(l.responseText)}catch{yt("Failed to parse JSON response for "+r+": "+l.responseText)}i(null,a)}else l.status!==401&&l.status!==404&&yt("Got unsuccessful REST response for "+r+" Status: "+l.status),i(l.status);i=null}},l.open("GET",r,!0),l.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ch{constructor(){this.rootNode_=he.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hi(){return{value:null,children:new Map}}function uc(n,e,t){if(Ce(e))n.value=t,n.children.clear();else if(n.value!==null)n.value=n.value.updateChild(e,t);else{const i=Ee(e);n.children.has(i)||n.children.set(i,Hi());const s=n.children.get(i);e=Ue(e),uc(s,e,t)}}function Us(n,e,t){n.value!==null?t(e,n.value):Eh(n,(i,s)=>{const o=new We(e.toString()+"/"+i);Us(s,o,t)})}function Eh(n,e){n.children.forEach((t,i)=>{e(i,t)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sh{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&wt(this.last_,(i,s)=>{t[i]=t[i]-s}),this.last_=e,t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wr=10*1e3,Ih=30*1e3,Th=5*60*1e3;class Nh{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new Sh(e);const i=wr+(Ih-wr)*Math.random();ei(this.reportStats_.bind(this),Math.floor(i))}reportStats_(){const e=this.statsListener_.get(),t={};let i=!1;wt(e,(s,o)=>{o>0&&Wt(this.statsToReport_,s)&&(t[s]=o,i=!0)}),i&&this.server_.reportStats(t),ei(this.reportStats_.bind(this),Math.floor(Math.random()*2*Th))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Dt;(function(n){n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(Dt||(Dt={}));function dc(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function vo(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function yo(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ui{constructor(e,t,i){this.path=e,this.affectedTree=t,this.revert=i,this.type=Dt.ACK_USER_WRITE,this.source=dc()}operationForChild(e){if(Ce(this.path)){if(this.affectedTree.value!=null)return $(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new We(e));return new Ui(Be(),t,this.revert)}}else return $(Ee(this.path)===e,"operationForChild called for unrelated child."),new Ui(Ue(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fi{constructor(e,t){this.source=e,this.path=t,this.type=Dt.LISTEN_COMPLETE}operationForChild(e){return Ce(this.path)?new fi(this.source,Be()):new fi(this.source,Ue(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bn{constructor(e,t,i){this.source=e,this.path=t,this.snap=i,this.type=Dt.OVERWRITE}operationForChild(e){return Ce(this.path)?new bn(this.source,Be(),this.snap.getImmediateChild(e)):new bn(this.source,Ue(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hi{constructor(e,t,i){this.source=e,this.path=t,this.children=i,this.type=Dt.MERGE}operationForChild(e){if(Ce(this.path)){const t=this.children.subtree(new We(e));return t.isEmpty()?null:t.value?new bn(this.source,Be(),t.value):new hi(this.source,Be(),t)}else return $(Ee(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new hi(this.source,Ue(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sn{constructor(e,t,i){this.node_=e,this.fullyInitialized_=t,this.filtered_=i}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(Ce(e))return this.isFullyInitialized()&&!this.filtered_;const t=Ee(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oh{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function Dh(n,e,t,i){const s=[],o=[];return e.forEach(r=>{r.type==="child_changed"&&n.index_.indexedValueChanged(r.oldSnap,r.snapshotNode)&&o.push(vh(r.childName,r.snapshotNode))}),xn(n,s,"child_removed",e,i,t),xn(n,s,"child_added",e,i,t),xn(n,s,"child_moved",o,i,t),xn(n,s,"child_changed",e,i,t),xn(n,s,"value",e,i,t),s}function xn(n,e,t,i,s,o){const r=i.filter(l=>l.type===t);r.sort((l,a)=>Ah(n,l,a)),r.forEach(l=>{const a=Rh(n,l,o);s.forEach(c=>{c.respondsTo(l.type)&&e.push(c.createEvent(a,n.query_))})})}function Rh(n,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}function Ah(n,e,t){if(e.childName==null||t.childName==null)throw Hn("Should only compare child_ events.");const i=new ye(e.childName,e.snapshotNode),s=new ye(t.childName,t.snapshotNode);return n.index_.compare(i,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ns(n,e){return{eventCache:n,serverCache:e}}function ti(n,e,t,i){return ns(new sn(e,t,i),n.serverCache)}function fc(n,e,t,i){return ns(n.eventCache,new sn(e,t,i))}function Gi(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function vn(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ts;const Ph=()=>(Ts||(Ts=new vt(vf)),Ts);class Ke{constructor(e,t=Ph()){this.value=e,this.children=t}static fromObject(e){let t=new Ke(null);return wt(e,(i,s)=>{t=t.set(new We(i),s)}),t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:Be(),value:this.value};if(Ce(e))return null;{const i=Ee(e),s=this.children.get(i);if(s!==null){const o=s.findRootMostMatchingPathAndValue(Ue(e),t);return o!=null?{path:nt(new We(i),o.path),value:o.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(Ce(e))return this;{const t=Ee(e),i=this.children.get(t);return i!==null?i.subtree(Ue(e)):new Ke(null)}}set(e,t){if(Ce(e))return new Ke(t,this.children);{const i=Ee(e),o=(this.children.get(i)||new Ke(null)).set(Ue(e),t),r=this.children.insert(i,o);return new Ke(this.value,r)}}remove(e){if(Ce(e))return this.children.isEmpty()?new Ke(null):new Ke(null,this.children);{const t=Ee(e),i=this.children.get(t);if(i){const s=i.remove(Ue(e));let o;return s.isEmpty()?o=this.children.remove(t):o=this.children.insert(t,s),this.value===null&&o.isEmpty()?new Ke(null):new Ke(this.value,o)}else return this}}get(e){if(Ce(e))return this.value;{const t=Ee(e),i=this.children.get(t);return i?i.get(Ue(e)):null}}setTree(e,t){if(Ce(e))return t;{const i=Ee(e),o=(this.children.get(i)||new Ke(null)).setTree(Ue(e),t);let r;return o.isEmpty()?r=this.children.remove(i):r=this.children.insert(i,o),new Ke(this.value,r)}}fold(e){return this.fold_(Be(),e)}fold_(e,t){const i={};return this.children.inorderTraversal((s,o)=>{i[s]=o.fold_(nt(e,s),t)}),t(e,this.value,i)}findOnPath(e,t){return this.findOnPath_(e,Be(),t)}findOnPath_(e,t,i){const s=this.value?i(t,this.value):!1;if(s)return s;if(Ce(e))return null;{const o=Ee(e),r=this.children.get(o);return r?r.findOnPath_(Ue(e),nt(t,o),i):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,Be(),t)}foreachOnPath_(e,t,i){if(Ce(e))return this;{this.value&&i(t,this.value);const s=Ee(e),o=this.children.get(s);return o?o.foreachOnPath_(Ue(e),nt(t,s),i):new Ke(null)}}foreach(e){this.foreach_(Be(),e)}foreach_(e,t){this.children.inorderTraversal((i,s)=>{s.foreach_(nt(e,i),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,i)=>{i.value&&e(t,i.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rt{constructor(e){this.writeTree_=e}static empty(){return new Rt(new Ke(null))}}function ni(n,e,t){if(Ce(e))return new Rt(new Ke(t));{const i=n.writeTree_.findRootMostValueAndPath(e);if(i!=null){const s=i.path;let o=i.value;const r=mt(s,e);return o=o.updateChild(r,t),new Rt(n.writeTree_.set(s,o))}else{const s=new Ke(t),o=n.writeTree_.setTree(e,s);return new Rt(o)}}}function kr(n,e,t){let i=n;return wt(t,(s,o)=>{i=ni(i,nt(e,s),o)}),i}function Cr(n,e){if(Ce(e))return Rt.empty();{const t=n.writeTree_.setTree(e,new Ke(null));return new Rt(t)}}function Gs(n,e){return wn(n,e)!=null}function wn(n,e){const t=n.writeTree_.findRootMostValueAndPath(e);return t!=null?n.writeTree_.get(t.path).getChild(mt(t.path,e)):null}function Er(n){const e=[],t=n.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(Je,(i,s)=>{e.push(new ye(i,s))}):n.writeTree_.children.inorderTraversal((i,s)=>{s.value!=null&&e.push(new ye(i,s.value))}),e}function xt(n,e){if(Ce(e))return n;{const t=wn(n,e);return t!=null?new Rt(new Ke(t)):new Rt(n.writeTree_.subtree(e))}}function Vs(n){return n.writeTree_.isEmpty()}function Fn(n,e){return hc(Be(),n.writeTree_,e)}function hc(n,e,t){if(e.value!=null)return t.updateChild(n,e.value);{let i=null;return e.children.inorderTraversal((s,o)=>{s===".priority"?($(o.value!==null,"Priority writes must always be leaf nodes"),i=o.value):t=hc(nt(n,s),o,t)}),!t.getChild(n).isEmpty()&&i!==null&&(t=t.updateChild(nt(n,".priority"),i)),t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function is(n,e){return gc(e,n)}function Mh(n,e,t,i,s){$(i>n.lastWriteId,"Stacking an older write on top of newer ones"),s===void 0&&(s=!0),n.allWrites.push({path:e,snap:t,writeId:i,visible:s}),s&&(n.visibleWrites=ni(n.visibleWrites,e,t)),n.lastWriteId=i}function Lh(n,e){for(let t=0;t<n.allWrites.length;t++){const i=n.allWrites[t];if(i.writeId===e)return i}return null}function Bh(n,e){const t=n.allWrites.findIndex(l=>l.writeId===e);$(t>=0,"removeWrite called with nonexistent writeId.");const i=n.allWrites[t];n.allWrites.splice(t,1);let s=i.visible,o=!1,r=n.allWrites.length-1;for(;s&&r>=0;){const l=n.allWrites[r];l.visible&&(r>=t&&Fh(l,i.path)?s=!1:Ot(i.path,l.path)&&(o=!0)),r--}if(s){if(o)return zh(n),!0;if(i.snap)n.visibleWrites=Cr(n.visibleWrites,i.path);else{const l=i.children;wt(l,a=>{n.visibleWrites=Cr(n.visibleWrites,nt(i.path,a))})}return!0}else return!1}function Fh(n,e){if(n.snap)return Ot(n.path,e);for(const t in n.children)if(n.children.hasOwnProperty(t)&&Ot(nt(n.path,t),e))return!0;return!1}function zh(n){n.visibleWrites=_c(n.allWrites,jh,Be()),n.allWrites.length>0?n.lastWriteId=n.allWrites[n.allWrites.length-1].writeId:n.lastWriteId=-1}function jh(n){return n.visible}function _c(n,e,t){let i=Rt.empty();for(let s=0;s<n.length;++s){const o=n[s];if(e(o)){const r=o.path;let l;if(o.snap)Ot(t,r)?(l=mt(t,r),i=ni(i,l,o.snap)):Ot(r,t)&&(l=mt(r,t),i=ni(i,Be(),o.snap.getChild(l)));else if(o.children){if(Ot(t,r))l=mt(t,r),i=kr(i,l,o.children);else if(Ot(r,t))if(l=mt(r,t),Ce(l))i=kr(i,Be(),o.children);else{const a=Ln(o.children,Ee(l));if(a){const c=a.getChild(Ue(l));i=ni(i,Be(),c)}}}else throw Hn("WriteRecord should have .snap or .children")}}return i}function pc(n,e,t,i,s){if(!i&&!s){const o=wn(n.visibleWrites,e);if(o!=null)return o;{const r=xt(n.visibleWrites,e);if(Vs(r))return t;if(t==null&&!Gs(r,Be()))return null;{const l=t||he.EMPTY_NODE;return Fn(r,l)}}}else{const o=xt(n.visibleWrites,e);if(!s&&Vs(o))return t;if(!s&&t==null&&!Gs(o,Be()))return null;{const r=function(c){return(c.visible||s)&&(!i||!~i.indexOf(c.writeId))&&(Ot(c.path,e)||Ot(e,c.path))},l=_c(n.allWrites,r,e),a=t||he.EMPTY_NODE;return Fn(l,a)}}}function qh(n,e,t){let i=he.EMPTY_NODE;const s=wn(n.visibleWrites,e);if(s)return s.isLeafNode()||s.forEachChild(Je,(o,r)=>{i=i.updateImmediateChild(o,r)}),i;if(t){const o=xt(n.visibleWrites,e);return t.forEachChild(Je,(r,l)=>{const a=Fn(xt(o,new We(r)),l);i=i.updateImmediateChild(r,a)}),Er(o).forEach(r=>{i=i.updateImmediateChild(r.name,r.node)}),i}else{const o=xt(n.visibleWrites,e);return Er(o).forEach(r=>{i=i.updateImmediateChild(r.name,r.node)}),i}}function Wh(n,e,t,i,s){$(i||s,"Either existingEventSnap or existingServerSnap must exist");const o=nt(e,t);if(Gs(n.visibleWrites,o))return null;{const r=xt(n.visibleWrites,o);return Vs(r)?s.getChild(t):Fn(r,s.getChild(t))}}function Hh(n,e,t,i){const s=nt(e,t),o=wn(n.visibleWrites,s);if(o!=null)return o;if(i.isCompleteForChild(t)){const r=xt(n.visibleWrites,s);return Fn(r,i.getNode().getImmediateChild(t))}else return null}function Uh(n,e){return wn(n.visibleWrites,e)}function Gh(n,e,t,i,s,o,r){let l;const a=xt(n.visibleWrites,e),c=wn(a,Be());if(c!=null)l=c;else if(t!=null)l=Fn(a,t);else return[];if(l=l.withIndex(r),!l.isEmpty()&&!l.isLeafNode()){const u=[],d=r.getCompare(),f=o?l.getReverseIteratorFrom(i,r):l.getIteratorFrom(i,r);let _=f.getNext();for(;_&&u.length<s;)d(_,i)!==0&&u.push(_),_=f.getNext();return u}else return[]}function Vh(){return{visibleWrites:Rt.empty(),allWrites:[],lastWriteId:-1}}function Vi(n,e,t,i){return pc(n.writeTree,n.treePath,e,t,i)}function wo(n,e){return qh(n.writeTree,n.treePath,e)}function Sr(n,e,t,i){return Wh(n.writeTree,n.treePath,e,t,i)}function Ki(n,e){return Uh(n.writeTree,nt(n.treePath,e))}function Kh(n,e,t,i,s,o){return Gh(n.writeTree,n.treePath,e,t,i,s,o)}function ko(n,e,t){return Hh(n.writeTree,n.treePath,e,t)}function mc(n,e){return gc(nt(n.treePath,e),n.writeTree)}function gc(n,e){return{treePath:n,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yh{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,i=e.childName;$(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),$(i!==".priority","Only non-priority child changes can be tracked.");const s=this.changeMap.get(i);if(s){const o=s.type;if(t==="child_added"&&o==="child_removed")this.changeMap.set(i,ui(i,e.snapshotNode,s.snapshotNode));else if(t==="child_removed"&&o==="child_added")this.changeMap.delete(i);else if(t==="child_removed"&&o==="child_changed")this.changeMap.set(i,ci(i,s.oldSnap));else if(t==="child_changed"&&o==="child_added")this.changeMap.set(i,Bn(i,e.snapshotNode));else if(t==="child_changed"&&o==="child_changed")this.changeMap.set(i,ui(i,e.snapshotNode,s.oldSnap));else throw Hn("Illegal combination of changes: "+e+" occurred after "+s)}else this.changeMap.set(i,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qh{getCompleteChild(e){return null}getChildAfterChild(e,t,i){return null}}const bc=new Qh;class Co{constructor(e,t,i=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=i}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const i=this.optCompleteServerCache_!=null?new sn(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return ko(this.writes_,e,i)}}getChildAfterChild(e,t,i){const s=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:vn(this.viewCache_),o=Kh(this.writes_,s,t,1,i,e);return o.length===0?null:o[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xh(n){return{filter:n}}function Jh(n,e){$(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),$(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}function Zh(n,e,t,i,s){const o=new Yh;let r,l;if(t.type===Dt.OVERWRITE){const c=t;c.source.fromUser?r=Ks(n,e,c.path,c.snap,i,s,o):($(c.source.fromServer,"Unknown source."),l=c.source.tagged||e.serverCache.isFiltered()&&!Ce(c.path),r=Yi(n,e,c.path,c.snap,i,s,l,o))}else if(t.type===Dt.MERGE){const c=t;c.source.fromUser?r=$h(n,e,c.path,c.children,i,s,o):($(c.source.fromServer,"Unknown source."),l=c.source.tagged||e.serverCache.isFiltered(),r=Ys(n,e,c.path,c.children,i,s,l,o))}else if(t.type===Dt.ACK_USER_WRITE){const c=t;c.revert?r=n_(n,e,c.path,i,s,o):r=e_(n,e,c.path,c.affectedTree,i,s,o)}else if(t.type===Dt.LISTEN_COMPLETE)r=t_(n,e,t.path,i,o);else throw Hn("Unknown operation type: "+t.type);const a=o.getChanges();return xh(e,r,a),{viewCache:r,changes:a}}function xh(n,e,t){const i=e.eventCache;if(i.isFullyInitialized()){const s=i.getNode().isLeafNode()||i.getNode().isEmpty(),o=Gi(n);(t.length>0||!n.eventCache.isFullyInitialized()||s&&!i.getNode().equals(o)||!i.getNode().getPriority().equals(o.getPriority()))&&t.push(cc(Gi(e)))}}function vc(n,e,t,i,s,o){const r=e.eventCache;if(Ki(i,t)!=null)return e;{let l,a;if(Ce(t))if($(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const c=vn(e),u=c instanceof he?c:he.EMPTY_NODE,d=wo(i,u);l=n.filter.updateFullNode(e.eventCache.getNode(),d,o)}else{const c=Vi(i,vn(e));l=n.filter.updateFullNode(e.eventCache.getNode(),c,o)}else{const c=Ee(t);if(c===".priority"){$(nn(t)===1,"Can't have a priority with additional path components");const u=r.getNode();a=e.serverCache.getNode();const d=Sr(i,t,u,a);d!=null?l=n.filter.updatePriority(u,d):l=r.getNode()}else{const u=Ue(t);let d;if(r.isCompleteForChild(c)){a=e.serverCache.getNode();const f=Sr(i,t,r.getNode(),a);f!=null?d=r.getNode().getImmediateChild(c).updateChild(u,f):d=r.getNode().getImmediateChild(c)}else d=ko(i,c,e.serverCache);d!=null?l=n.filter.updateChild(r.getNode(),c,d,u,s,o):l=r.getNode()}}return ti(e,l,r.isFullyInitialized()||Ce(t),n.filter.filtersNodes())}}function Yi(n,e,t,i,s,o,r,l){const a=e.serverCache;let c;const u=r?n.filter:n.filter.getIndexedFilter();if(Ce(t))c=u.updateFullNode(a.getNode(),i,null);else if(u.filtersNodes()&&!a.isFiltered()){const _=a.getNode().updateChild(t,i);c=u.updateFullNode(a.getNode(),_,null)}else{const _=Ee(t);if(!a.isCompleteForPath(t)&&nn(t)>1)return e;const h=Ue(t),v=a.getNode().getImmediateChild(_).updateChild(h,i);_===".priority"?c=u.updatePriority(a.getNode(),v):c=u.updateChild(a.getNode(),_,v,h,bc,null)}const d=fc(e,c,a.isFullyInitialized()||Ce(t),u.filtersNodes()),f=new Co(s,d,o);return vc(n,d,t,s,f,l)}function Ks(n,e,t,i,s,o,r){const l=e.eventCache;let a,c;const u=new Co(s,e,o);if(Ce(t))c=n.filter.updateFullNode(e.eventCache.getNode(),i,r),a=ti(e,c,!0,n.filter.filtersNodes());else{const d=Ee(t);if(d===".priority")c=n.filter.updatePriority(e.eventCache.getNode(),i),a=ti(e,c,l.isFullyInitialized(),l.isFiltered());else{const f=Ue(t),_=l.getNode().getImmediateChild(d);let h;if(Ce(f))h=i;else{const b=u.getCompleteChild(d);b!=null?Za(f)===".priority"&&b.getChild($a(f)).isEmpty()?h=b:h=b.updateChild(f,i):h=he.EMPTY_NODE}if(_.equals(h))a=e;else{const b=n.filter.updateChild(l.getNode(),d,h,f,u,r);a=ti(e,b,l.isFullyInitialized(),n.filter.filtersNodes())}}}return a}function Ir(n,e){return n.eventCache.isCompleteForChild(e)}function $h(n,e,t,i,s,o,r){let l=e;return i.foreach((a,c)=>{const u=nt(t,a);Ir(e,Ee(u))&&(l=Ks(n,l,u,c,s,o,r))}),i.foreach((a,c)=>{const u=nt(t,a);Ir(e,Ee(u))||(l=Ks(n,l,u,c,s,o,r))}),l}function Tr(n,e,t){return t.foreach((i,s)=>{e=e.updateChild(i,s)}),e}function Ys(n,e,t,i,s,o,r,l){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let a=e,c;Ce(t)?c=i:c=new Ke(null).setTree(t,i);const u=e.serverCache.getNode();return c.children.inorderTraversal((d,f)=>{if(u.hasChild(d)){const _=e.serverCache.getNode().getImmediateChild(d),h=Tr(n,_,f);a=Yi(n,a,new We(d),h,s,o,r,l)}}),c.children.inorderTraversal((d,f)=>{const _=!e.serverCache.isCompleteForChild(d)&&f.value===null;if(!u.hasChild(d)&&!_){const h=e.serverCache.getNode().getImmediateChild(d),b=Tr(n,h,f);a=Yi(n,a,new We(d),b,s,o,r,l)}}),a}function e_(n,e,t,i,s,o,r){if(Ki(s,t)!=null)return e;const l=e.serverCache.isFiltered(),a=e.serverCache;if(i.value!=null){if(Ce(t)&&a.isFullyInitialized()||a.isCompleteForPath(t))return Yi(n,e,t,a.getNode().getChild(t),s,o,l,r);if(Ce(t)){let c=new Ke(null);return a.getNode().forEachChild(Zt,(u,d)=>{c=c.set(new We(u),d)}),Ys(n,e,t,c,s,o,l,r)}else return e}else{let c=new Ke(null);return i.foreach((u,d)=>{const f=nt(t,u);a.isCompleteForPath(f)&&(c=c.set(u,a.getNode().getChild(f)))}),Ys(n,e,t,c,s,o,l,r)}}function t_(n,e,t,i,s){const o=e.serverCache,r=fc(e,o.getNode(),o.isFullyInitialized()||Ce(t),o.isFiltered());return vc(n,r,t,i,bc,s)}function n_(n,e,t,i,s,o){let r;if(Ki(i,t)!=null)return e;{const l=new Co(i,e,s),a=e.eventCache.getNode();let c;if(Ce(t)||Ee(t)===".priority"){let u;if(e.serverCache.isFullyInitialized())u=Vi(i,vn(e));else{const d=e.serverCache.getNode();$(d instanceof he,"serverChildren would be complete if leaf node"),u=wo(i,d)}u=u,c=n.filter.updateFullNode(a,u,o)}else{const u=Ee(t);let d=ko(i,u,e.serverCache);d==null&&e.serverCache.isCompleteForChild(u)&&(d=a.getImmediateChild(u)),d!=null?c=n.filter.updateChild(a,u,d,Ue(t),l,o):e.eventCache.getNode().hasChild(u)?c=n.filter.updateChild(a,u,he.EMPTY_NODE,Ue(t),l,o):c=a,c.isEmpty()&&e.serverCache.isFullyInitialized()&&(r=Vi(i,vn(e)),r.isLeafNode()&&(c=n.filter.updateFullNode(c,r,o)))}return r=e.serverCache.isFullyInitialized()||Ki(i,Be())!=null,ti(e,c,r,n.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i_{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const i=this.query_._queryParams,s=new go(i.getIndex()),o=wh(i);this.processor_=Xh(o);const r=t.serverCache,l=t.eventCache,a=s.updateFullNode(he.EMPTY_NODE,r.getNode(),null),c=o.updateFullNode(he.EMPTY_NODE,l.getNode(),null),u=new sn(a,r.isFullyInitialized(),s.filtersNodes()),d=new sn(c,l.isFullyInitialized(),o.filtersNodes());this.viewCache_=ns(d,u),this.eventGenerator_=new Oh(this.query_)}get query(){return this.query_}}function s_(n){return n.viewCache_.serverCache.getNode()}function o_(n){return Gi(n.viewCache_)}function r_(n,e){const t=vn(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!Ce(e)&&!t.getImmediateChild(Ee(e)).isEmpty())?t.getChild(e):null}function Nr(n){return n.eventRegistrations_.length===0}function l_(n,e){n.eventRegistrations_.push(e)}function Or(n,e,t){const i=[];if(t){$(e==null,"A cancel should cancel all event registrations.");const s=n.query._path;n.eventRegistrations_.forEach(o=>{const r=o.createCancelEvent(t,s);r&&i.push(r)})}if(e){let s=[];for(let o=0;o<n.eventRegistrations_.length;++o){const r=n.eventRegistrations_[o];if(!r.matches(e))s.push(r);else if(e.hasAnyCallback()){s=s.concat(n.eventRegistrations_.slice(o+1));break}}n.eventRegistrations_=s}else n.eventRegistrations_=[];return i}function Dr(n,e,t,i){e.type===Dt.MERGE&&e.source.queryId!==null&&($(vn(n.viewCache_),"We should always have a full cache before handling merges"),$(Gi(n.viewCache_),"Missing event cache, even though we have a server cache"));const s=n.viewCache_,o=Zh(n.processor_,s,e,t,i);return Jh(n.processor_,o.viewCache),$(o.viewCache.serverCache.isFullyInitialized()||!s.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=o.viewCache,yc(n,o.changes,o.viewCache.eventCache.getNode(),null)}function a_(n,e){const t=n.viewCache_.eventCache,i=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(Je,(o,r)=>{i.push(Bn(o,r))}),t.isFullyInitialized()&&i.push(cc(t.getNode())),yc(n,i,t.getNode(),e)}function yc(n,e,t,i){const s=i?[i]:n.eventRegistrations_;return Dh(n.eventGenerator_,e,t,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Qi;class wc{constructor(){this.views=new Map}}function c_(n){$(!Qi,"__referenceConstructor has already been defined"),Qi=n}function u_(){return $(Qi,"Reference.ts has not been loaded"),Qi}function d_(n){return n.views.size===0}function Eo(n,e,t,i){const s=e.source.queryId;if(s!==null){const o=n.views.get(s);return $(o!=null,"SyncTree gave us an op for an invalid query."),Dr(o,e,t,i)}else{let o=[];for(const r of n.views.values())o=o.concat(Dr(r,e,t,i));return o}}function kc(n,e,t,i,s){const o=e._queryIdentifier,r=n.views.get(o);if(!r){let l=Vi(t,s?i:null),a=!1;l?a=!0:i instanceof he?(l=wo(t,i),a=!1):(l=he.EMPTY_NODE,a=!1);const c=ns(new sn(l,a,!1),new sn(i,s,!1));return new i_(e,c)}return r}function f_(n,e,t,i,s,o){const r=kc(n,e,i,s,o);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,r),l_(r,t),a_(r,t)}function h_(n,e,t,i){const s=e._queryIdentifier,o=[];let r=[];const l=on(n);if(s==="default")for(const[a,c]of n.views.entries())r=r.concat(Or(c,t,i)),Nr(c)&&(n.views.delete(a),c.query._queryParams.loadsAllData()||o.push(c.query));else{const a=n.views.get(s);a&&(r=r.concat(Or(a,t,i)),Nr(a)&&(n.views.delete(s),a.query._queryParams.loadsAllData()||o.push(a.query)))}return l&&!on(n)&&o.push(new(u_())(e._repo,e._path)),{removed:o,events:r}}function Cc(n){const e=[];for(const t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function $t(n,e){let t=null;for(const i of n.views.values())t=t||r_(i,e);return t}function Ec(n,e){if(e._queryParams.loadsAllData())return ss(n);{const i=e._queryIdentifier;return n.views.get(i)}}function Sc(n,e){return Ec(n,e)!=null}function on(n){return ss(n)!=null}function ss(n){for(const e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Xi;function __(n){$(!Xi,"__referenceConstructor has already been defined"),Xi=n}function p_(){return $(Xi,"Reference.ts has not been loaded"),Xi}let m_=1;class Rr{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Ke(null),this.pendingWriteTree_=Vh(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function Ic(n,e,t,i,s){return Mh(n.pendingWriteTree_,e,t,i,s),s?ki(n,new bn(dc(),e,t)):[]}function dn(n,e,t=!1){const i=Lh(n.pendingWriteTree_,e);if(Bh(n.pendingWriteTree_,e)){let o=new Ke(null);return i.snap!=null?o=o.set(Be(),!0):wt(i.children,r=>{o=o.set(new We(r),!0)}),ki(n,new Ui(i.path,o,t))}else return[]}function wi(n,e,t){return ki(n,new bn(vo(),e,t))}function g_(n,e,t){const i=Ke.fromObject(t);return ki(n,new hi(vo(),e,i))}function b_(n,e){return ki(n,new fi(vo(),e))}function v_(n,e,t){const i=Io(n,t);if(i){const s=To(i),o=s.path,r=s.queryId,l=mt(o,e),a=new fi(yo(r),l);return No(n,o,a)}else return[]}function Tc(n,e,t,i,s=!1){const o=e._path,r=n.syncPointTree_.get(o);let l=[];if(r&&(e._queryIdentifier==="default"||Sc(r,e))){const a=h_(r,e,t,i);d_(r)&&(n.syncPointTree_=n.syncPointTree_.remove(o));const c=a.removed;if(l=a.events,!s){const u=c.findIndex(f=>f._queryParams.loadsAllData())!==-1,d=n.syncPointTree_.findOnPath(o,(f,_)=>on(_));if(u&&!d){const f=n.syncPointTree_.subtree(o);if(!f.isEmpty()){const _=C_(f);for(let h=0;h<_.length;++h){const b=_[h],v=b.query,w=Rc(n,b);n.listenProvider_.startListening(ii(v),_i(n,v),w.hashFn,w.onComplete)}}}!d&&c.length>0&&!i&&(u?n.listenProvider_.stopListening(ii(e),null):c.forEach(f=>{const _=n.queryToTagMap.get(os(f));n.listenProvider_.stopListening(ii(f),_)}))}E_(n,c)}return l}function Nc(n,e,t,i){const s=Io(n,i);if(s!=null){const o=To(s),r=o.path,l=o.queryId,a=mt(r,e),c=new bn(yo(l),a,t);return No(n,r,c)}else return[]}function y_(n,e,t,i){const s=Io(n,i);if(s){const o=To(s),r=o.path,l=o.queryId,a=mt(r,e),c=Ke.fromObject(t),u=new hi(yo(l),a,c);return No(n,r,u)}else return[]}function w_(n,e,t,i=!1){const s=e._path;let o=null,r=!1;n.syncPointTree_.foreachOnPath(s,(f,_)=>{const h=mt(f,s);o=o||$t(_,h),r=r||on(_)});let l=n.syncPointTree_.get(s);l?(r=r||on(l),o=o||$t(l,Be())):(l=new wc,n.syncPointTree_=n.syncPointTree_.set(s,l));let a;o!=null?a=!0:(a=!1,o=he.EMPTY_NODE,n.syncPointTree_.subtree(s).foreachChild((_,h)=>{const b=$t(h,Be());b&&(o=o.updateImmediateChild(_,b))}));const c=Sc(l,e);if(!c&&!e._queryParams.loadsAllData()){const f=os(e);$(!n.queryToTagMap.has(f),"View does not exist, but we have a tag");const _=S_();n.queryToTagMap.set(f,_),n.tagToQueryMap.set(_,f)}const u=is(n.pendingWriteTree_,s);let d=f_(l,e,t,u,o,a);if(!c&&!r&&!i){const f=Ec(l,e);d=d.concat(I_(n,e,f))}return d}function So(n,e,t){const s=n.pendingWriteTree_,o=n.syncPointTree_.findOnPath(e,(r,l)=>{const a=mt(r,e),c=$t(l,a);if(c)return c});return pc(s,e,o,t,!0)}function k_(n,e){const t=e._path;let i=null;n.syncPointTree_.foreachOnPath(t,(c,u)=>{const d=mt(c,t);i=i||$t(u,d)});let s=n.syncPointTree_.get(t);s?i=i||$t(s,Be()):(s=new wc,n.syncPointTree_=n.syncPointTree_.set(t,s));const o=i!=null,r=o?new sn(i,!0,!1):null,l=is(n.pendingWriteTree_,e._path),a=kc(s,e,l,o?r.getNode():he.EMPTY_NODE,o);return o_(a)}function ki(n,e){return Oc(e,n.syncPointTree_,null,is(n.pendingWriteTree_,Be()))}function Oc(n,e,t,i){if(Ce(n.path))return Dc(n,e,t,i);{const s=e.get(Be());t==null&&s!=null&&(t=$t(s,Be()));let o=[];const r=Ee(n.path),l=n.operationForChild(r),a=e.children.get(r);if(a&&l){const c=t?t.getImmediateChild(r):null,u=mc(i,r);o=o.concat(Oc(l,a,c,u))}return s&&(o=o.concat(Eo(s,n,i,t))),o}}function Dc(n,e,t,i){const s=e.get(Be());t==null&&s!=null&&(t=$t(s,Be()));let o=[];return e.children.inorderTraversal((r,l)=>{const a=t?t.getImmediateChild(r):null,c=mc(i,r),u=n.operationForChild(r);u&&(o=o.concat(Dc(u,l,a,c)))}),s&&(o=o.concat(Eo(s,n,i,t))),o}function Rc(n,e){const t=e.query,i=_i(n,t);return{hashFn:()=>(s_(e)||he.EMPTY_NODE).hash(),onComplete:s=>{if(s==="ok")return i?v_(n,t._path,i):b_(n,t._path);{const o=kf(s,t);return Tc(n,t,null,o)}}}}function _i(n,e){const t=os(e);return n.queryToTagMap.get(t)}function os(n){return n._path.toString()+"$"+n._queryIdentifier}function Io(n,e){return n.tagToQueryMap.get(e)}function To(n){const e=n.indexOf("$");return $(e!==-1&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new We(n.substr(0,e))}}function No(n,e,t){const i=n.syncPointTree_.get(e);$(i,"Missing sync point for query tag that we're tracking");const s=is(n.pendingWriteTree_,e);return Eo(i,t,s,null)}function C_(n){return n.fold((e,t,i)=>{if(t&&on(t))return[ss(t)];{let s=[];return t&&(s=Cc(t)),wt(i,(o,r)=>{s=s.concat(r)}),s}})}function ii(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(p_())(n._repo,n._path):n}function E_(n,e){for(let t=0;t<e.length;++t){const i=e[t];if(!i._queryParams.loadsAllData()){const s=os(i),o=n.queryToTagMap.get(s);n.queryToTagMap.delete(s),n.tagToQueryMap.delete(o)}}}function S_(){return m_++}function I_(n,e,t){const i=e._path,s=_i(n,e),o=Rc(n,t),r=n.listenProvider_.startListening(ii(e),s,o.hashFn,o.onComplete),l=n.syncPointTree_.subtree(i);if(s)$(!on(l.value),"If we're adding a query, it shouldn't be shadowed");else{const a=l.fold((c,u,d)=>{if(!Ce(c)&&u&&on(u))return[ss(u).query];{let f=[];return u&&(f=f.concat(Cc(u).map(_=>_.query))),wt(d,(_,h)=>{f=f.concat(h)}),f}});for(let c=0;c<a.length;++c){const u=a[c];n.listenProvider_.stopListening(ii(u),_i(n,u))}}return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oo{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new Oo(t)}node(){return this.node_}}class Do{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=nt(this.path_,e);return new Do(this.syncTree_,t)}node(){return So(this.syncTree_,this.path_)}}const T_=function(n){return n=n||{},n.timestamp=n.timestamp||new Date().getTime(),n},Ar=function(n,e,t){if(!n||typeof n!="object")return n;if($(".sv"in n,"Unexpected leaf node or priority contents"),typeof n[".sv"]=="string")return N_(n[".sv"],e,t);if(typeof n[".sv"]=="object")return O_(n[".sv"],e);$(!1,"Unexpected server value: "+JSON.stringify(n,null,2))},N_=function(n,e,t){switch(n){case"timestamp":return t.timestamp;default:$(!1,"Unexpected server value: "+n)}},O_=function(n,e,t){n.hasOwnProperty("increment")||$(!1,"Unexpected server value: "+JSON.stringify(n,null,2));const i=n.increment;typeof i!="number"&&$(!1,"Unexpected increment value: "+i);const s=e.node();if($(s!==null&&typeof s<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!s.isLeafNode())return i;const r=s.getValue();return typeof r!="number"?i:r+i},D_=function(n,e,t,i){return Ro(e,new Do(t,n),i)},Ac=function(n,e,t){return Ro(n,new Oo(e),t)};function Ro(n,e,t){const i=n.getPriority().val(),s=Ar(i,e.getImmediateChild(".priority"),t);let o;if(n.isLeafNode()){const r=n,l=Ar(r.getValue(),e,t);return l!==r.getValue()||s!==r.getPriority().val()?new ot(l,lt(s)):n}else{const r=n;return o=r,s!==r.getPriority().val()&&(o=o.updatePriority(new ot(s))),r.forEachChild(Je,(l,a)=>{const c=Ro(a,e.getImmediateChild(l),t);c!==a&&(o=o.updateImmediateChild(l,c))}),o}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ao{constructor(e="",t=null,i={children:{},childCount:0}){this.name=e,this.parent=t,this.node=i}}function Po(n,e){let t=e instanceof We?e:new We(e),i=n,s=Ee(t);for(;s!==null;){const o=Ln(i.node.children,s)||{children:{},childCount:0};i=new Ao(s,i,o),t=Ue(t),s=Ee(t)}return i}function Vn(n){return n.node.value}function Pc(n,e){n.node.value=e,Qs(n)}function Mc(n){return n.node.childCount>0}function R_(n){return Vn(n)===void 0&&!Mc(n)}function rs(n,e){wt(n.node.children,(t,i)=>{e(new Ao(t,n,i))})}function Lc(n,e,t,i){t&&!i&&e(n),rs(n,s=>{Lc(s,e,!0,i)}),t&&i&&e(n)}function A_(n,e,t){let i=t?n:n.parent;for(;i!==null;){if(e(i))return!0;i=i.parent}return!1}function Ci(n){return new We(n.parent===null?n.name:Ci(n.parent)+"/"+n.name)}function Qs(n){n.parent!==null&&P_(n.parent,n.name,n)}function P_(n,e,t){const i=R_(t),s=Wt(n.node.children,e);i&&s?(delete n.node.children[e],n.node.childCount--,Qs(n)):!i&&!s&&(n.node.children[e]=t.node,n.node.childCount++,Qs(n))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M_=/[\[\].#$\/\u0000-\u001F\u007F]/,L_=/[\[\].#$\u0000-\u001F\u007F]/,Ns=10*1024*1024,Bc=function(n){return typeof n=="string"&&n.length!==0&&!M_.test(n)},Fc=function(n){return typeof n=="string"&&n.length!==0&&!L_.test(n)},B_=function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Fc(n)},Pr=function(n){return n===null||typeof n=="string"||typeof n=="number"&&!co(n)||n&&typeof n=="object"&&Wt(n,".sv")},zc=function(n,e,t,i){i&&e===void 0||Mo(lo(n,"value"),e,t)},Mo=function(n,e,t){const i=t instanceof We?new th(t,n):t;if(e===void 0)throw new Error(n+"contains undefined "+an(i));if(typeof e=="function")throw new Error(n+"contains a function "+an(i)+" with contents = "+e.toString());if(co(e))throw new Error(n+"contains "+e.toString()+" "+an(i));if(typeof e=="string"&&e.length>Ns/3&&es(e)>Ns)throw new Error(n+"contains a string greater than "+Ns+" utf8 bytes "+an(i)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let s=!1,o=!1;if(wt(e,(r,l)=>{if(r===".value")s=!0;else if(r!==".priority"&&r!==".sv"&&(o=!0,!Bc(r)))throw new Error(n+" contains an invalid key ("+r+") "+an(i)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);nh(i,r),Mo(n,l,i),ih(i)}),s&&o)throw new Error(n+' contains ".value" child '+an(i)+" in addition to actual children.")}},jc=function(n,e,t,i){if(!(i&&t===void 0)&&!Fc(t))throw new Error(lo(n,e)+'was an invalid path = "'+t+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},F_=function(n,e,t,i){t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),jc(n,e,t,i)},Lo=function(n,e){if(Ee(e)===".info")throw new Error(n+" failed = Can't modify data under /.info/")},z_=function(n,e){const t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!Bc(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!B_(t))throw new Error(lo(n,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j_{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function qc(n,e){let t=null;for(let i=0;i<e.length;i++){const s=e[i],o=s.getPath();t!==null&&!ec(o,t.path)&&(n.eventLists_.push(t),t=null),t===null&&(t={events:[],path:o}),t.events.push(s)}t&&n.eventLists_.push(t)}function jt(n,e,t){qc(n,t),q_(n,i=>Ot(i,e)||Ot(e,i))}function q_(n,e){n.recursionDepth_++;let t=!0;for(let i=0;i<n.eventLists_.length;i++){const s=n.eventLists_[i];if(s){const o=s.path;e(o)?(W_(n.eventLists_[i]),n.eventLists_[i]=null):t=!1}}t&&(n.eventLists_=[]),n.recursionDepth_--}function W_(n){for(let e=0;e<n.events.length;e++){const t=n.events[e];if(t!==null){n.events[e]=null;const i=t.getEventRunner();hn&&dt("event: "+t.toString()),Gn(i)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H_="repo_interrupt",U_=25;class G_{constructor(e,t,i,s){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=i,this.appCheckProvider_=s,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new j_,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Hi(),this.transactionQueueTree_=new Ao,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function V_(n,e,t){if(n.stats_=ho(n.repoInfo_),n.forceRestClient_||If())n.server_=new Wi(n.repoInfo_,(i,s,o,r)=>{Mr(n,i,s,o,r)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>Lr(n,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{tt(t)}catch(i){throw new Error("Invalid authOverride provided: "+i)}}n.persistentConnection_=new Ut(n.repoInfo_,e,(i,s,o,r)=>{Mr(n,i,s,o,r)},i=>{Lr(n,i)},i=>{K_(n,i)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(i=>{n.server_.refreshAuthToken(i)}),n.appCheckProvider_.addTokenChangeListener(i=>{n.server_.refreshAppCheckToken(i.token)}),n.statsReporter_=Rf(n.repoInfo_,()=>new Nh(n.stats_,n.server_)),n.infoData_=new Ch,n.infoSyncTree_=new Rr({startListening:(i,s,o,r)=>{let l=[];const a=n.infoData_.getNode(i._path);return a.isEmpty()||(l=wi(n.infoSyncTree_,i._path,a),setTimeout(()=>{r("ok")},0)),l},stopListening:()=>{}}),Fo(n,"connected",!1),n.serverSyncTree_=new Rr({startListening:(i,s,o,r)=>(n.server_.listen(i,o,s,(l,a)=>{const c=r(l,a);jt(n.eventQueue_,i._path,c)}),[]),stopListening:(i,s)=>{n.server_.unlisten(i,s)}})}function Wc(n){const t=n.infoData_.getNode(new We(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function Bo(n){return T_({timestamp:Wc(n)})}function Mr(n,e,t,i,s){n.dataUpdateCount++;const o=new We(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let r=[];if(s)if(i){const a=Li(t,c=>lt(c));r=y_(n.serverSyncTree_,o,a,s)}else{const a=lt(t);r=Nc(n.serverSyncTree_,o,a,s)}else if(i){const a=Li(t,c=>lt(c));r=g_(n.serverSyncTree_,o,a)}else{const a=lt(t);r=wi(n.serverSyncTree_,o,a)}let l=o;r.length>0&&(l=as(n,o)),jt(n.eventQueue_,l,r)}function Lr(n,e){Fo(n,"connected",e),e===!1&&X_(n)}function K_(n,e){wt(e,(t,i)=>{Fo(n,t,i)})}function Fo(n,e,t){const i=new We("/.info/"+e),s=lt(t);n.infoData_.updateSnapshot(i,s);const o=wi(n.infoSyncTree_,i,s);jt(n.eventQueue_,i,o)}function Hc(n){return n.nextWriteId_++}function Y_(n,e,t){const i=k_(n.serverSyncTree_,e);return i!=null?Promise.resolve(i):n.server_.get(e).then(s=>{const o=lt(s).withIndex(e._queryParams.getIndex());w_(n.serverSyncTree_,e,t,!0);let r;if(e._queryParams.loadsAllData())r=wi(n.serverSyncTree_,e._path,o);else{const l=_i(n.serverSyncTree_,e);r=Nc(n.serverSyncTree_,e._path,o,l)}return jt(n.eventQueue_,e._path,r),Tc(n.serverSyncTree_,e,t,null,!0),o},s=>(ls(n,"get for query "+tt(e)+" failed: "+s),Promise.reject(new Error(s))))}function Q_(n,e,t,i,s){ls(n,"set",{path:e.toString(),value:t,priority:i});const o=Bo(n),r=lt(t,i),l=So(n.serverSyncTree_,e),a=Ac(r,l,o),c=Hc(n),u=Ic(n.serverSyncTree_,e,a,c,!0);qc(n.eventQueue_,u),n.server_.put(e.toString(),r.val(!0),(f,_)=>{const h=f==="ok";h||yt("set at "+e+" failed: "+f);const b=dn(n.serverSyncTree_,c,!h);jt(n.eventQueue_,e,b),Z_(n,s,f,_)});const d=Yc(n,e);as(n,d),jt(n.eventQueue_,d,[])}function X_(n){ls(n,"onDisconnectEvents");const e=Bo(n),t=Hi();Us(n.onDisconnect_,Be(),(s,o)=>{const r=D_(s,o,n.serverSyncTree_,e);uc(t,s,r)});let i=[];Us(t,Be(),(s,o)=>{i=i.concat(wi(n.serverSyncTree_,s,o));const r=Yc(n,s);as(n,r)}),n.onDisconnect_=Hi(),jt(n.eventQueue_,Be(),i)}function J_(n){n.persistentConnection_&&n.persistentConnection_.interrupt(H_)}function ls(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),dt(t,...e)}function Z_(n,e,t,i){e&&Gn(()=>{if(t==="ok")e(null);else{const s=(t||"error").toUpperCase();let o=s;i&&(o+=": "+i);const r=new Error(o);r.code=s,e(r)}})}function Uc(n,e,t){return So(n.serverSyncTree_,e,t)||he.EMPTY_NODE}function zo(n,e=n.transactionQueueTree_){if(e||cs(n,e),Vn(e)){const t=Vc(n,e);$(t.length>0,"Sending zero length transaction queue"),t.every(s=>s.status===0)&&x_(n,Ci(e),t)}else Mc(e)&&rs(e,t=>{zo(n,t)})}function x_(n,e,t){const i=t.map(c=>c.currentWriteId),s=Uc(n,e,i);let o=s;const r=s.hash();for(let c=0;c<t.length;c++){const u=t[c];$(u.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=1,u.retryCount++;const d=mt(e,u.path);o=o.updateChild(d,u.currentOutputSnapshotRaw)}const l=o.val(!0),a=e;n.server_.put(a.toString(),l,c=>{ls(n,"transaction put response",{path:a.toString(),status:c});let u=[];if(c==="ok"){const d=[];for(let f=0;f<t.length;f++)t[f].status=2,u=u.concat(dn(n.serverSyncTree_,t[f].currentWriteId)),t[f].onComplete&&d.push(()=>t[f].onComplete(null,!0,t[f].currentOutputSnapshotResolved)),t[f].unwatcher();cs(n,Po(n.transactionQueueTree_,e)),zo(n,n.transactionQueueTree_),jt(n.eventQueue_,e,u);for(let f=0;f<d.length;f++)Gn(d[f])}else{if(c==="datastale")for(let d=0;d<t.length;d++)t[d].status===3?t[d].status=4:t[d].status=0;else{yt("transaction at "+a.toString()+" failed: "+c);for(let d=0;d<t.length;d++)t[d].status=4,t[d].abortReason=c}as(n,e)}},r)}function as(n,e){const t=Gc(n,e),i=Ci(t),s=Vc(n,t);return $_(n,s,i),i}function $_(n,e,t){if(e.length===0)return;const i=[];let s=[];const r=e.filter(l=>l.status===0).map(l=>l.currentWriteId);for(let l=0;l<e.length;l++){const a=e[l],c=mt(t,a.path);let u=!1,d;if($(c!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),a.status===4)u=!0,d=a.abortReason,s=s.concat(dn(n.serverSyncTree_,a.currentWriteId,!0));else if(a.status===0)if(a.retryCount>=U_)u=!0,d="maxretry",s=s.concat(dn(n.serverSyncTree_,a.currentWriteId,!0));else{const f=Uc(n,a.path,r);a.currentInputSnapshot=f;const _=e[l].update(f.val());if(_!==void 0){Mo("transaction failed: Data returned ",_,a.path);let h=lt(_);typeof _=="object"&&_!=null&&Wt(_,".priority")||(h=h.updatePriority(f.getPriority()));const v=a.currentWriteId,w=Bo(n),k=Ac(h,f,w);a.currentOutputSnapshotRaw=h,a.currentOutputSnapshotResolved=k,a.currentWriteId=Hc(n),r.splice(r.indexOf(v),1),s=s.concat(Ic(n.serverSyncTree_,a.path,k,a.currentWriteId,a.applyLocally)),s=s.concat(dn(n.serverSyncTree_,v,!0))}else u=!0,d="nodata",s=s.concat(dn(n.serverSyncTree_,a.currentWriteId,!0))}jt(n.eventQueue_,t,s),s=[],u&&(e[l].status=2,function(f){setTimeout(f,Math.floor(0))}(e[l].unwatcher),e[l].onComplete&&(d==="nodata"?i.push(()=>e[l].onComplete(null,!1,e[l].currentInputSnapshot)):i.push(()=>e[l].onComplete(new Error(d),!1,null))))}cs(n,n.transactionQueueTree_);for(let l=0;l<i.length;l++)Gn(i[l]);zo(n,n.transactionQueueTree_)}function Gc(n,e){let t,i=n.transactionQueueTree_;for(t=Ee(e);t!==null&&Vn(i)===void 0;)i=Po(i,t),e=Ue(e),t=Ee(e);return i}function Vc(n,e){const t=[];return Kc(n,e,t),t.sort((i,s)=>i.order-s.order),t}function Kc(n,e,t){const i=Vn(e);if(i)for(let s=0;s<i.length;s++)t.push(i[s]);rs(e,s=>{Kc(n,s,t)})}function cs(n,e){const t=Vn(e);if(t){let i=0;for(let s=0;s<t.length;s++)t[s].status!==2&&(t[i]=t[s],i++);t.length=i,Pc(e,t.length>0?t:void 0)}rs(e,i=>{cs(n,i)})}function Yc(n,e){const t=Ci(Gc(n,e)),i=Po(n.transactionQueueTree_,e);return A_(i,s=>{Os(n,s)}),Os(n,i),Lc(i,s=>{Os(n,s)}),t}function Os(n,e){const t=Vn(e);if(t){const i=[];let s=[],o=-1;for(let r=0;r<t.length;r++)t[r].status===3||(t[r].status===1?($(o===r-1,"All SENT items should be at beginning of queue."),o=r,t[r].status=3,t[r].abortReason="set"):($(t[r].status===0,"Unexpected transaction status in abort"),t[r].unwatcher(),s=s.concat(dn(n.serverSyncTree_,t[r].currentWriteId,!0)),t[r].onComplete&&i.push(t[r].onComplete.bind(null,new Error("set"),!1,null))));o===-1?Pc(e,void 0):t.length=o+1,jt(n.eventQueue_,Ci(e),s);for(let r=0;r<i.length;r++)Gn(i[r])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ep(n){let e="";const t=n.split("/");for(let i=0;i<t.length;i++)if(t[i].length>0){let s=t[i];try{s=decodeURIComponent(s.replace(/\+/g," "))}catch{}e+="/"+s}return e}function tp(n){const e={};n.charAt(0)==="?"&&(n=n.substring(1));for(const t of n.split("&")){if(t.length===0)continue;const i=t.split("=");i.length===2?e[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):yt(`Invalid query segment '${t}' in query '${n}'`)}return e}const Br=function(n,e){const t=np(n),i=t.namespace;t.domain==="firebase.com"&&Gt(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!i||i==="undefined")&&t.domain!=="localhost"&&Gt("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||gf();const s=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new Ha(t.host,t.secure,i,s,e,"",i!==t.subdomain),path:new We(t.pathString)}},np=function(n){let e="",t="",i="",s="",o="",r=!0,l="https",a=443;if(typeof n=="string"){let c=n.indexOf("//");c>=0&&(l=n.substring(0,c-1),n=n.substring(c+2));let u=n.indexOf("/");u===-1&&(u=n.length);let d=n.indexOf("?");d===-1&&(d=n.length),e=n.substring(0,Math.min(u,d)),u<d&&(s=ep(n.substring(u,d)));const f=tp(n.substring(Math.min(n.length,d)));c=e.indexOf(":"),c>=0?(r=l==="https"||l==="wss",a=parseInt(e.substring(c+1),10)):c=e.length;const _=e.slice(0,c);if(_.toLowerCase()==="localhost")t="localhost";else if(_.split(".").length<=2)t=_;else{const h=e.indexOf(".");i=e.substring(0,h).toLowerCase(),t=e.substring(h+1),o=i}"ns"in f&&(o=f.ns)}return{host:e,port:a,domain:t,subdomain:i,secure:r,scheme:l,pathString:s,namespace:o}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fr="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",ip=function(){let n=0;const e=[];return function(t){const i=t===n;n=t;let s;const o=new Array(8);for(s=7;s>=0;s--)o[s]=Fr.charAt(t%64),t=Math.floor(t/64);$(t===0,"Cannot push at time == 0");let r=o.join("");if(i){for(s=11;s>=0&&e[s]===63;s--)e[s]=0;e[s]++}else for(s=0;s<12;s++)e[s]=Math.floor(Math.random()*64);for(s=0;s<12;s++)r+=Fr.charAt(e[s]);return $(r.length===20,"nextPushId: Length should be 20."),r}}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sp{constructor(e,t,i,s){this.eventType=e,this.eventRegistration=t,this.snapshot=i,this.prevName=s}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+tt(this.snapshot.exportVal())}}class op{constructor(e,t,i){this.eventRegistration=e,this.error=t,this.path=i}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rp{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return $(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class us{constructor(e,t,i,s){this._repo=e,this._path=t,this._queryParams=i,this._orderByCalled=s}get key(){return Ce(this._path)?null:Za(this._path)}get ref(){return new Kt(this._repo,this._path)}get _queryIdentifier(){const e=yr(this._queryParams),t=uo(e);return t==="{}"?"default":t}get _queryObject(){return yr(this._queryParams)}isEqual(e){if(e=rn(e),!(e instanceof us))return!1;const t=this._repo===e._repo,i=ec(this._path,e._path),s=this._queryIdentifier===e._queryIdentifier;return t&&i&&s}toJSON(){return this.toString()}toString(){return this._repo.toString()+eh(this._path)}}function lp(n,e){if(n._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function ap(n){let e=null,t=null;if(n.hasStart()&&(e=n.getIndexStartValue()),n.hasEnd()&&(t=n.getIndexEndValue()),n.getIndex()===Zt){const i="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",s="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(n.hasStart()){if(n.getIndexStartName()!==gn)throw new Error(i);if(typeof e!="string")throw new Error(s)}if(n.hasEnd()){if(n.getIndexEndName()!==tn)throw new Error(i);if(typeof t!="string")throw new Error(s)}}else if(n.getIndex()===Je){if(e!=null&&!Pr(e)||t!=null&&!Pr(t))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if($(n.getIndex()instanceof lc||n.getIndex()===ac,"unknown index type."),e!=null&&typeof e=="object"||t!=null&&typeof t=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}class Kt extends us{constructor(e,t){super(e,t,new bo,!1)}get parent(){const e=$a(this._path);return e===null?null:new Kt(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}class pi{constructor(e,t,i){this._node=e,this.ref=t,this._index=i}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new We(e),i=Vt(this.ref,e);return new pi(this._node.getChild(t),i,Je)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(i,s)=>e(new pi(s,Vt(this.ref,i),Je)))}hasChild(e){const t=new We(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function zn(n,e){return n=rn(n),n._checkNotDeleted("ref"),e!==void 0?Vt(n._root,e):n._root}function Vt(n,e){return n=rn(n),Ee(n._path)===null?F_("child","path",e,!1):jc("child","path",e,!1),new Kt(n._repo,nt(n._path,e))}function cp(n,e){n=rn(n),Lo("push",n._path),zc("push",e,n._path,!0);const t=Wc(n._repo),i=ip(t),s=Vt(n,i),o=Vt(n,i);let r;return e!=null?r=ds(o,e).then(()=>o):r=Promise.resolve(o),s.then=r.then.bind(r),s.catch=r.then.bind(r,void 0),s}function up(n){return Lo("remove",n._path),ds(n,null)}function ds(n,e){n=rn(n),Lo("set",n._path),zc("set",e,n._path,!1);const t=new $i;return Q_(n._repo,n._path,e,null,t.wrapCallback(()=>{})),t.promise}function Qc(n){n=rn(n);const e=new rp(()=>{}),t=new jo(e);return Y_(n._repo,n,t).then(i=>new pi(i,new Kt(n._repo,n._path),n._queryParams.getIndex()))}class jo{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,t){const i=t._queryParams.getIndex();return new sp("value",this,new pi(e.snapshotNode,new Kt(t._repo,t._path),i))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new op(this,e,t):null}matches(e){return e instanceof jo?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}class dp{}class fp extends dp{_apply(e){lp(e,"orderByKey");const t=kh(e._queryParams,Zt);return ap(t),new us(e._repo,e._path,t,!0)}}function Xc(){return new fp}function Jc(n,...e){let t=rn(n);for(const i of e)t=i._apply(t);return t}c_(Kt);__(Kt);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hp="FIREBASE_DATABASE_EMULATOR_HOST",Xs={};let _p=!1;function pp(n,e,t,i){n.repoInfo_=new Ha(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0),i&&(n.authTokenProvider_=i)}function mp(n,e,t,i,s){let o=i||n.options.databaseURL;o===void 0&&(n.options.projectId||Gt("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),dt("Using default host for project ",n.options.projectId),o=`${n.options.projectId}-default-rtdb.firebaseio.com`);let r=Br(o,s),l=r.repoInfo,a,c;typeof process<"u"&&process.env&&(c=process.env[hp]),c?(a=!0,o=`http://${c}?ns=${l.namespace}`,r=Br(o,s),l=r.repoInfo):a=!r.repoInfo.secure;const u=s&&a?new An(An.OWNER):new Nf(n.name,n.options,e);z_("Invalid Firebase Database URL",r),Ce(r.path)||Gt("Database URL must point to the root of a Firebase Database (not including a child path).");const d=bp(l,n,u,new Tf(n.name,t));return new vp(d,n)}function gp(n,e){const t=Xs[e];(!t||t[n.key]!==n)&&Gt(`Database ${e}(${n.repoInfo_}) has already been deleted.`),J_(n),delete t[n.key]}function bp(n,e,t,i){let s=Xs[e.name];s||(s={},Xs[e.name]=s);let o=s[n.toURLString()];return o&&Gt("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),o=new G_(n,_p,t,i),s[n.toURLString()]=o,o}class vp{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(V_(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Kt(this._repo,Be())),this._rootInternal}_delete(){return this._rootInternal!==null&&(gp(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Gt("Cannot call "+e+" on a deleted database.")}}function yp(n=$d(),e){const t=Xd(n,"database").getImmediate({identifier:e});if(!t._instanceStarted){const i=Wu("database");i&&wp(t,...i)}return t}function wp(n,e,t,i={}){n=rn(n),n._checkNotDeleted("useEmulator"),n._instanceStarted&&Gt("Cannot call useEmulator() after instance has already been initialized.");const s=n._repoInternal;let o;if(s.repoInfo_.nodeAdmin)i.mockUserToken&&Gt('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),o=new An(An.OWNER);else if(i.mockUserToken){const r=typeof i.mockUserToken=="string"?i.mockUserToken:Hu(i.mockUserToken,n.app.options.projectId);o=new An(r)}pp(s,e,t,o)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kp(n){ff(xd),Fi(new ri("database",(e,{instanceIdentifier:t})=>{const i=e.getProvider("app").getImmediate(),s=e.getProvider("auth-internal"),o=e.getProvider("app-check-internal");return mp(i,s,o,t)},"PUBLIC").setMultipleInstances(!0)),Dn(ir,sr,n),Dn(ir,sr,"esm2017")}Ut.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)};Ut.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)};kp();var Js={},Zc={},fs={};Object.defineProperty(fs,"__esModule",{value:!0});fs.rotx=void 0;function Cp(n,e){return n.replace(/[a-zA-Z]/g,function(t){return String.fromCharCode((t<="Z"?90:122)>=(t=t.charCodeAt(0)+e)?t:t-26)})}fs.rotx=Cp;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.rotx=void 0;var e=fs;Object.defineProperty(n,"rotx",{enumerable:!0,get:function(){return e.rotx}})})(Zc);var xc={},hs={};Object.defineProperty(hs,"__esModule",{value:!0});hs.base64=void 0;class Ep{encode(e){return typeof btoa>"u"?Buffer.from(e,"binary").toString("base64"):btoa(e)}decode(e){return typeof atob>"u"?Buffer.from(e,"base64").toString("binary"):atob(e)}}const Sp=new Ep;hs.base64=Sp;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.base64=void 0;var e=hs;Object.defineProperty(n,"base64",{enumerable:!0,get:function(){return e.base64}})})(xc);var $c={},_s={};Object.defineProperty(_s,"__esModule",{value:!0});_s.hex=void 0;class Ip{encode(e){let t="",i="";for(let s=0;s<e.length;s++)t=e.charCodeAt(s).toString(16),i+=("000"+t).slice(-4);return i}decode(e){let t=e.match(/.{1,4}/g)||[],i="";for(let s=0;s<t.length;s++)i+=String.fromCharCode(parseInt(t[s],16));return i}}const Tp=new Ip;_s.hex=Tp;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.hex=void 0;var e=_s;Object.defineProperty(n,"hex",{enumerable:!0,get:function(){return e.hex}})})($c);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.hex=n.base64=n.rotx=void 0;var e=Zc;Object.defineProperty(n,"rotx",{enumerable:!0,get:function(){return e.rotx}});var t=xc;Object.defineProperty(n,"base64",{enumerable:!0,get:function(){return t.base64}});var i=$c;Object.defineProperty(n,"hex",{enumerable:!0,get:function(){return i.hex}})})(Js);let Np={ixqSmg:"IQhiAgIPDNBgKzMmPcWG9XWqEsxI2uQ70F5X1rY",icbpLwuiqv:"nk-d3-8j3n9.nqzmjiamixx.kwu",libijiamCZT:"pbbxa://nk-d3-8j3n9-lmnictb-zblj.mczwxm-emab1.nqzmjiamlibijiam.ixx",xzwrmkbQl:"nk-d3-8j3n9",abwziomJcksmb:"nk-d3-8j3n9.ixxaxwb.kwu",umaaioqvoAmvlmzQl:"31377888705",ixxQl:"1:31377888705:emj:3018l8nk0i07m867mk0j40"},eu={};for(let[n,e]of Object.entries(Np))eu[Js.rotx(n,18)]=Js.rotx(e,18);let Mt={armor:"Armor",magicDmg:"Magic",meleeDmg:"Melee",rangedDmg:"Ranged",hpRegen:"HP Regen",endurance:"Endurance",sightRange:"Sight Range",walkSpeed:"Walk Speed",jumpPower:"Jump Power",ammoReturn:"Ammo Return",height:"Height"},jn=["head","body","legs","feet","neck","back","ring","misc"],ps={name:"",stats:{armor:0,magicDmg:0,meleeDmg:0,rangedDmg:0,hpRegen:0,endurance:0,sightRange:0,walkSpeed:0,jumpPower:0,ammoReturn:0,height:0},cost:{min:0,max:0},image:"",link:""},ms={name:"",info:{type:"",special:""},moves:[],cost:{min:0,max:0},image:"",link:""},Op={armor:{min:0,avg:0,max:0},gear:{min:0,avg:0,max:0},total:{min:0,avg:0,max:0}},yn=[...Array(5).keys()].map(n=>++n),qn=yp(Sa(eu)),Dp=["head","body","legs","feet","neck","back","ring","misc","gear","sets","bonuses"],tu={0:"th",1:"st",2:"nd",3:"rd",4:"th",5:"th",6:"th",7:"th",8:"th",9:"th"};function nu(n,e){let t=!1;for(let i of[n,e])for(let s in i)if(i[s].name){t=!0;break}oo.set(t),bt.set(null),window.history.replaceState(null,null,location.origin+location.pathname)}function qo(n,e){let t=2.8,i=e.split(" ").length,s=n.querySelector("span");if(s.style.removeProperty("font-size"),i>2&&e.length/i>=5){for(;s.offsetHeight>n.offsetHeight*.75;)t-=.05,s.style.fontSize=`calc(var(--u) * ${t})`;return t<2.8}return null}function Rp(n,e){let t=2.8,i=n.querySelector("span");for(i.style.removeProperty("font-size");i.offsetWidth>n.offsetWidth;)t-=.05,i.style.fontSize=`calc(var(--u) * ${t})`;for(;i.offsetHeight>n.offsetHeight*.75&&e;)t-=.05,i.style.fontSize=`calc(var(--u) * ${t})`;return t<2.8?t:null}function Ap(n){let e=2.35,t=n.querySelector(".tooltip");for(t.style.removeProperty("font-size");t.offsetHeight>n.offsetHeight*1.125;)e-=.02,t.style.fontSize=`calc(var(--u) * ${e})`}function Pp(n){document.activeElement==document.body&&n.key=="Tab"&&(n.preventDefault(),document.querySelector(`.promptCont [id*='${n.shiftKey?"last":"first"}Focusable']`).focus())}function iu(n,e){let t=n.toLowerCase();for(let i in e)i.toLowerCase().includes(t)&&!e[i].classList.contains("filtered")?e[i].classList.remove("hidden"):e[i].classList.add("hidden")}function Ji(n,e){e&&setTimeout(()=>{n.focus(),n.click(),n.select()})}function kt(n){n.shiftKey&&n.key=="Tab"&&n.preventDefault()}function Ct(n){n.key=="Tab"&&!n.shiftKey&&n.preventDefault()}function Zi(n,e){let t=/[^a-zA-Z0-9~!#$%^&*()\-_+[\]{}\\|;:'",.<>/? ]/g;return n.replace(t,"").replaceAll(`
`,"").replace(/^ /,"").slice(0,e)}function Zs(n,e,t){(!n.maxLength||n.maxLength!=t)&&e.length>=t&&(n.maxLength=t)}function su(n,e){n={...n},e={...e};for(let t of jn)n[t]?n[t]=n[t].name:n[t]="";for(let t of yn)e[t]?e[t]=e[t].name:e[t]="";return{eq:n,gear:e}}function Wo(){window.history.replaceState(null,null,location.origin+location.pathname+"?ls=true")}function _n(n){n.target.closest("button").blur()}function Mp(n){let e,t,i,s,o,r,l,a,c,u,d,f;return{c(){e=g("li"),t=g("button"),i=g("img"),o=E(),r=g("span"),r.textContent=`${n[5]}`,l=E(),a=g("iconify-icon"),c=E(),u=g("iconify-icon"),Ze(i.src,s=n[0].image)||m(i,"src",s),m(i,"alt",""),De(a,"icon","maki:cross"),De(a,"id","cross"),De(u,"icon","eva:info-outline"),De(u,"id","info"),te(e,"selectedItem",n[2])},m(_,h){F(_,e,h),p(e,t),p(t,i),p(t,o),p(t,r),p(t,l),p(t,a),p(t,c),p(t,u),n[20](e),d||(f=[na(n[6].call(null,r)),D(t,"touchstart",n[9],{passive:!0}),D(t,"touchend",n[10],{passive:!0}),D(t,"mousedown",n[9]),D(t,"mouseup",n[10]),D(t,"click",n[15]),D(t,"mouseenter",n[16]),D(t,"focusin",n[17]),D(t,"mouseleave",n[18]),D(t,"focusout",n[19]),D(e,"contextmenu",Lp)],d=!0)},p(_,[h]){h&1&&!Ze(i.src,s=_[0].image)&&m(i,"src",s),h&4&&te(e,"selectedItem",_[2])},i:re,o:re,d(_){_&&L(e),n[20](null),d=!1,be(f)}}}const Lp=n=>n.preventDefault();function Bp(n,e,t){let i,s,o,r,l,a,c;J(n,x,P=>t(4,i=P)),J(n,pt,P=>t(22,s=P)),J(n,On,P=>t(23,o=P)),J(n,At,P=>t(24,r=P)),J(n,Pt,P=>t(25,l=P)),J(n,zt,P=>t(26,a=P)),J(n,so,P=>t(27,c=P));let{itemData:u,slotOpen:d,eqSlotName:f,scrolling:_}=e;const h=qt();let b,v=!1,w=u.name,k,y=0,T;function R(P){setTimeout(()=>{qo(b,w)&&c.push({node:b,itemName:w})})}function q(P){if(d||!d&&P.isTrusted==!1){h("itemSelect",{element:b,trusted:P.isTrusted}),b.classList.contains("selectedItem")||t(2,v=!1),t(2,v=!v),t(11,d=!1),G(Pt,l[f]=v?u:ps,l),nu(l,a);for(let M of Object.keys(Mt)){G(pt,s[M]=0,s);for(let U in l)l[U].noStats||(G(pt,s[M]+=l[U].stats[M],s),G(pt,s[M]=Math.round(s[M]*10)/10,s))}for(let M of r.bonuses)if(o[M.name])for(let U in s)G(pt,s[U]+=M.stats[U],s),G(pt,s[U]=Math.round(s[U]*10)/10,s)}}function I(){_||(G(x,i.item.ongoing=!0,i),G(x,i.item.data={...u,slot:f,type:"eq",element:b},i))}function W(){T=setInterval(()=>t(14,y+=50),50)}function j(){clearInterval(T),y>=750&&I(),t(14,y=0)}const Q=P=>{P.shiftKey?I():i.item.ongoing||q(P)},O=()=>t(3,k=!0),C=()=>t(3,k=!0),N=()=>t(3,k=!1),Z=()=>t(3,k=!1);function A(P){ie[P?"unshift":"push"](()=>{b=P,t(1,b)})}return n.$$set=P=>{"itemData"in P&&t(0,u=P.itemData),"slotOpen"in P&&t(11,d=P.slotOpen),"eqSlotName"in P&&t(12,f=P.eqSlotName),"scrolling"in P&&t(13,_=P.scrolling)},n.$$.update=()=>{n.$$.dirty&16384&&y==750&&h("displayInfo")},[u,b,v,k,i,w,R,q,I,W,j,d,f,_,y,Q,O,C,N,Z,A]}class Fp extends Me{constructor(e){super(),Pe(this,e,Bp,Mp,me,{itemData:0,slotOpen:11,eqSlotName:12,scrolling:13})}}function zp(n){let e,t,i,s,o,r,l,a,c,u,d,f,_,h,b;return{c(){e=g("li"),t=g("button"),i=g("img"),o=E(),r=g("span"),r.textContent=`${n[6]}`,l=E(),a=g("iconify-icon"),d=E(),f=g("iconify-icon"),Ze(i.src,s=n[0].image)||m(i,"src",s),m(i,"alt",""),De(a,"icon",c=n[5]?"heroicons-solid:switch-vertical":"maki:cross"),De(a,"id",u=n[5]?"switchable":"cross"),De(f,"icon","eva:info-outline"),De(f,"id","info"),t.disabled=_=!n[4]&&!n[5],te(e,"selectedItem",n[1]),te(e,"non-eligible",!n[4]&&!n[5]),te(e,"switchable",n[5])},m(v,w){F(v,e,w),p(e,t),p(t,i),p(t,o),p(t,r),p(t,l),p(t,a),p(t,d),p(t,f),n[19](e),h||(b=[na(n[7].call(null,r)),D(t,"touchstart",n[10],{passive:!0}),D(t,"touchend",n[11],{passive:!0}),D(t,"mousedown",n[10]),D(t,"mouseup",n[11]),D(t,"click",n[18]),D(e,"contextmenu",jp)],h=!0)},p(v,[w]){w&1&&!Ze(i.src,s=v[0].image)&&m(i,"src",s),w&32&&c!==(c=v[5]?"heroicons-solid:switch-vertical":"maki:cross")&&De(a,"icon",c),w&32&&u!==(u=v[5]?"switchable":"cross")&&De(a,"id",u),w&48&&_!==(_=!v[4]&&!v[5])&&(t.disabled=_),w&2&&te(e,"selectedItem",v[1]),w&48&&te(e,"non-eligible",!v[4]&&!v[5]),w&32&&te(e,"switchable",v[5])},i:re,o:re,d(v){v&&L(e),n[19](null),h=!1,be(b)}}}const jp=n=>n.preventDefault();function qp(n,e,t){let i,s,o,r,l;J(n,zt,N=>t(17,i=N)),J(n,x,N=>t(2,s=N)),J(n,Pt,N=>t(21,o=N)),J(n,Mn,N=>t(22,r=N)),J(n,so,N=>t(23,l=N));let{itemData:a,slotOpen:c,index:u,weaponExpand:d,scrolling:f}=e;const _=qt();let h,b=!1,v=!0,w=!1,k=a.name,y=0,T,R={"Orange Salamander":["Green Salamander","Purple Salamander"],"Green Salamander":["Orange Salamander","Purple Salamander"],"Purple Salamander":["Orange Salamander","Green Salamander"],"White Salamander":["Black Salamander","Gold Salamander"],"Black Salamander":["White Salamander","Gold Salamander"],"Gold Salamander":["White Salamander","Black Salamander"]};function q(N){setTimeout(()=>{qo(h,k)&&l.push({node:h,itemName:k})})}function I(N){v&&(c||!c&&N.isTrusted==!1)&&(a.tool&&d&&_("toolSelect"),_("itemSelect",{element:h,trusted:N.isTrusted}),h.classList.contains("selectedItem")||t(1,b=!1),t(12,c=!1),w?setTimeout(()=>{r[u][k].querySelector("button").click(),r[Object.keys(i).find(Z=>i[Z].name==k)][i[u]&&i[u].name?i[u].name:k].querySelector("button").click(),t(4,v=!0),t(5,w=!1)},5):(t(1,b=!b),G(zt,i[u]=b?a:ms,i)),nu(o,i))}function W(){f||(G(x,s.item.ongoing=!0,s),G(x,s.item.data={...a,type:"gear",element:h},s))}function j(){T=setInterval(()=>t(16,y+=50),50)}function Q(){clearInterval(T),y>=750&&W(),t(16,y=0)}const O=N=>{N.shiftKey?W():s.item.ongoing||I(N)};function C(N){ie[N?"unshift":"push"](()=>{h=N,t(3,h)})}return n.$$set=N=>{"itemData"in N&&t(0,a=N.itemData),"slotOpen"in N&&t(12,c=N.slotOpen),"index"in N&&t(13,u=N.index),"weaponExpand"in N&&t(14,d=N.weaponExpand),"scrolling"in N&&t(15,f=N.scrolling)},n.$$.update=()=>{if(n.$$.dirty&155650&&i)for(let N in i){if(!d&&N!=u&&i[N].name==k){t(5,w=!0);break}if(N!=u&&R[i[N].name]&&R[i[N].name].includes(k)){t(4,v=!1);break}else b||t(4,v=!0)}if(n.$$.dirty&139268)if(s.randomize.ongoing)t(5,w=!1);else for(let N in i)if(N!=u&&i[N].name==k){t(5,w=!0);break}else t(5,w=!1);n.$$.dirty&65536&&y==750&&_("displayInfo")},[a,b,s,h,v,w,k,q,I,W,j,Q,c,u,d,f,y,i,O,C]}class Wp extends Me{constructor(e){super(),Pe(this,e,qp,zp,me,{itemData:0,slotOpen:12,index:13,weaponExpand:14,scrolling:15})}}function Hp(n){const e=n-1;return e*e*e+1}function Xe(n,{delay:e=0,duration:t=400,easing:i=xi}={}){const s=+getComputedStyle(n).opacity;return{delay:e,duration:t,easing:i,css:o=>`opacity: ${o*s}`}}function $e(n,{delay:e=0,duration:t=400,easing:i=Hp,start:s=0,opacity:o=0}={}){const r=getComputedStyle(n),l=+r.opacity,a=r.transform==="none"?"":r.transform,c=1-s,u=l*(1-o);return{delay:e,duration:t,easing:i,css:(d,f)=>`
			transform: ${a} scale(${1-c*f});
			opacity: ${l-u*f}
		`}}function zr(n){let e,t,i,s;return{c(){e=g("img"),Ze(e.src,t=n[5][n[3]])||m(e,"src",t),m(e,"alt","")},m(o,r){F(o,e,r),s=!0},p(o,r){(!s||r&8&&!Ze(e.src,t=o[5][o[3]]))&&m(e,"src",t)},i(o){s||(o&&we(()=>{s&&(i||(i=ge(e,Xe,{duration:150},!0)),i.run(1))}),s=!0)},o(o){o&&(i||(i=ge(e,Xe,{duration:150},!1)),i.run(0)),s=!1},d(o){o&&L(e),o&&i&&i.end()}}}function Up(n){let e,t,i=n[5][n[3]],s,o,r=n[0].name+"",l,a,c,u=zr(n);return{c(){e=g("li"),t=g("button"),u.c(),s=E(),o=g("span"),l=ne(r),te(e,"selectedItem",n[4])},m(d,f){F(d,e,f),p(e,t),u.m(t,null),p(t,s),p(t,o),p(o,l),n[8](e),a||(c=[D(t,"click",n[6]),D(e,"mouseenter",n[9]),D(e,"focusin",n[10]),D(e,"mouseleave",n[11]),D(e,"focusout",n[12])],a=!0)},p(d,[f]){f&8&&me(i,i=d[5][d[3]])?(ze(),H(u,1,1,re),je(),u=zr(d),u.c(),B(u,1),u.m(t,s)):u.p(d,f),f&1&&r!==(r=d[0].name+"")&&Se(l,r)},i(d){B(u)},o(d){H(u)},d(d){d&&L(e),u.d(d),n[8](null),a=!1,be(c)}}}function Gp(n,e,t){let i,s,o;J(n,Pn,W=>t(14,i=W)),J(n,Pt,W=>t(15,s=W)),J(n,At,W=>t(16,o=W));let{itemData:r,ddOpen:l=!1}=e;const a=qt();let c,u=!1,d=!1,f,_=0,h=r.pieces.length,b=[];for(let W of r.pieces)e:for(let j of jn)for(let Q of o[j])if(Q.name==W){b.push(j);break e}let v=[];for(let W=0;W<h;W++)v.push(o[b[W]].find(j=>j.name==r.pieces[W]).image);function w(){d?f=setInterval(()=>{t(3,_++,_),_==h&&t(3,_=0)},750):(clearInterval(f),t(3,_=0))}function k(){a("setSelect");let W=0;for(let j=0;j<h;j++)!s[b[j]]||s[b[j]].name!=r.pieces[j]?i[b[j]][r.pieces[j]].querySelector("button").click():W++;W!=h&&t(7,l=!1)}function y(W){ie[W?"unshift":"push"](()=>{c=W,t(2,c)})}const T=()=>t(1,d=!0),R=()=>t(1,d=!0),q=()=>t(1,d=!1),I=()=>t(1,d=!1);return n.$$set=W=>{"itemData"in W&&t(0,r=W.itemData),"ddOpen"in W&&t(7,l=W.ddOpen)},n.$$.update=()=>{n.$$.dirty&2&&(d||!d)&&w()},[r,d,c,_,u,v,k,l,y,T,R,q,I]}class Vp extends Me{constructor(e){super(),Pe(this,e,Gp,Up,me,{itemData:0,ddOpen:7})}}const Kp=n=>({}),jr=n=>({});function Yp(n){let e,t,i,s,o,r,l,a,c;const u=n[8].tooltip,d=uu(u,n,n[7],jr);return{c(){e=g("div"),t=g("span"),i=E(),s=g("input"),r=E(),d&&d.c(),m(s,"id",o=n[2]?"firstFocusable":n[3]?"lastFocusable":""),s.disabled=n[4],m(s,"type","checkbox"),s.checked=n[1],m(s,"class","svelte-1oscat4"),m(e,"class","toggleCont svelte-1oscat4"),te(e,"unavailable",n[4])},m(f,_){F(f,e,_),p(e,t),t.innerHTML=n[0],p(e,i),p(e,s),p(e,r),d&&d.m(e,null),l=!0,a||(c=[D(s,"change",n[9]),D(s,"keydown",n[10])],a=!0)},p(f,[_]){(!l||_&1)&&(t.innerHTML=f[0]),(!l||_&12&&o!==(o=f[2]?"firstFocusable":f[3]?"lastFocusable":""))&&m(s,"id",o),(!l||_&16)&&(s.disabled=f[4]),(!l||_&2)&&(s.checked=f[1]),d&&d.p&&(!l||_&128)&&fu(d,u,f,f[7],l?du(u,f[7],_,Kp):hu(f[7]),jr),(!l||_&16)&&te(e,"unavailable",f[4])},i(f){l||(B(d,f),l=!0)},o(f){H(d,f),l=!1},d(f){f&&L(e),d&&d.d(f),a=!1,be(c)}}}function Qp(n,e,t){let{$$slots:i={},$$scope:s}=e,{text:o,checked:r=!1,first:l=!1,last:a=!1,disabled:c=!1,forced:u=!1}=e;const d=qt(),f=h=>{h.target.blur(),u?h.target.checked=!0:d("toggle",h.target.checked)},_=h=>{l&&kt(h),a&&Ct(h),h.key=="Enter"&&!u?(h.target.checked=!h.target.checked,d("toggle",h.target.checked)):u&&(h.target.checked=!0)};return n.$$set=h=>{"text"in h&&t(0,o=h.text),"checked"in h&&t(1,r=h.checked),"first"in h&&t(2,l=h.first),"last"in h&&t(3,a=h.last),"disabled"in h&&t(4,c=h.disabled),"forced"in h&&t(5,u=h.forced),"$$scope"in h&&t(7,s=h.$$scope)},[o,r,l,a,c,u,d,s,i,f,_]}class ft extends Me{constructor(e){super(),Pe(this,e,Qp,Yp,me,{text:0,checked:1,first:2,last:3,disabled:4,forced:5})}}function qr(n,e,t){const i=n.slice();return i[28]=e[t][0],i[29]=e[t][1],i}function Wr(n,e,t){const i=n.slice();return i[28]=e[t][0],i[29]=e[t][1],i}function Hr(n){let e,t;function i(...s){return n[19](n[28],...s)}return e=new ft({props:{text:n[29],checked:n[6][n[28]]}}),e.$on("toggle",i),{c(){le(e.$$.fragment)},m(s,o){se(e,s,o),t=!0},p(s,o){n=s;const r={};o[0]&64&&(r.checked=n[6][n[28]]),e.$set(r)},i(s){t||(B(e.$$.fragment,s),t=!0)},o(s){H(e.$$.fragment,s),t=!1},d(s){oe(e,s)}}}function Xp(n){let e,t,i,s,o,r,l,a,c;s=new ft({props:{text:"Descension",checked:n[4],forced:n[4]}}),s.$on("toggle",n[20]),r=new ft({props:{text:"Ascension",checked:n[5],forced:n[5]}}),r.$on("toggle",n[21]);let u=Ne(Object.entries(n[9])),d=[];for(let _=0;_<u.length;_+=1)d[_]=Ur(qr(n,u,_));const f=_=>H(d[_],1,1,()=>{d[_]=null});return{c(){e=g("p"),e.textContent="Sort",t=E(),i=g("div"),le(s.$$.fragment),o=E(),le(r.$$.fragment),l=E(),a=g("div");for(let _=0;_<d.length;_+=1)d[_].c();m(e,"id","title"),m(e,"class","svelte-1jaojxl"),m(i,"class","radio ttFocus svelte-1jaojxl"),m(i,"id","sort"),m(a,"class","options svelte-1jaojxl")},m(_,h){F(_,e,h),F(_,t,h),F(_,i,h),se(s,i,null),p(i,o),se(r,i,null),F(_,l,h),F(_,a,h);for(let b=0;b<d.length;b+=1)d[b]&&d[b].m(a,null);c=!0},p(_,h){const b={};h[0]&16&&(b.checked=_[4]),h[0]&16&&(b.forced=_[4]),s.$set(b);const v={};if(h[0]&32&&(v.checked=_[5]),h[0]&32&&(v.forced=_[5]),r.$set(v),h[0]&1664){u=Ne(Object.entries(_[9]));let w;for(w=0;w<u.length;w+=1){const k=qr(_,u,w);d[w]?(d[w].p(k,h),B(d[w],1)):(d[w]=Ur(k),d[w].c(),B(d[w],1),d[w].m(a,null))}for(ze(),w=u.length;w<d.length;w+=1)f(w);je()}},i(_){if(!c){B(s.$$.fragment,_),B(r.$$.fragment,_);for(let h=0;h<u.length;h+=1)B(d[h]);c=!0}},o(_){H(s.$$.fragment,_),H(r.$$.fragment,_),d=d.filter(Boolean);for(let h=0;h<d.length;h+=1)H(d[h]);c=!1},d(_){_&&(L(e),L(t),L(i),L(l),L(a)),oe(s),oe(r),at(d,_)}}}function Ur(n){let e,t;function i(...s){return n[22](n[28],...s)}return e=new ft({props:{text:n[29],checked:n[7][n[28]],last:n[28]=="none"||n[28]=="tool"}}),e.$on("toggle",i),{c(){le(e.$$.fragment)},m(s,o){se(e,s,o),t=!0},p(s,o){n=s;const r={};o[0]&128&&(r.checked=n[7][n[28]]),e.$set(r)},i(s){t||(B(e.$$.fragment,s),t=!0)},o(s){H(e.$$.fragment,s),t=!1},d(s){oe(e,s)}}}function Jp(n){let e,t,i,s,o,r,l,a,c,u,d,f,_,h,b,v,w,k,y,T,R,q,I;r=new ft({props:{text:"Inclusive",checked:n[1],forced:n[1]}}),r.$on("toggle",n[14]),a=new ft({props:{text:"Exclusive",checked:n[2],forced:n[2]}}),a.$on("toggle",n[15]),u=new ft({props:{text:"Strict",checked:n[3],forced:n[3]}}),u.$on("toggle",n[16]);let W=Ne(Object.entries(n[9])),j=[];for(let C=0;C<W.length;C+=1)j[C]=Hr(Wr(n,W,C));const Q=C=>H(j[C],1,1,()=>{j[C]=null});let O=!n[8]&&Xp(n);return{c(){e=g("div"),t=g("div"),i=g("p"),i.innerHTML=`Filter
            <span class="tooltip svelte-1jaojxl" id="bottom">Inclusive: Equipment that includes the selected search types
                <br/> <br/>
                Exclusive: Equipment that does not include the selected search types
                <br/> <br/>
                Strict: Equipment that includes the selected search types and no
                others</span> <iconify-icon icon="eva:info-outline"></iconify-icon>`,s=E(),o=g("div"),le(r.$$.fragment),l=E(),le(a.$$.fragment),c=E(),le(u.$$.fragment),d=E(),f=g("div"),_=g("div"),h=g("button"),h.textContent="Select all",b=E(),v=g("div"),w=g("button"),w.textContent="Clear all",k=E(),y=g("div");for(let C=0;C<j.length;C+=1)j[C].c();T=E(),O&&O.c(),m(i,"id","title"),m(i,"class","svelte-1jaojxl"),m(o,"class","radio ttFocus svelte-1jaojxl"),m(o,"id","filter"),m(h,"class","svelte-1jaojxl"),m(_,"class","svelte-1jaojxl"),m(w,"class","svelte-1jaojxl"),m(v,"class","svelte-1jaojxl"),m(f,"class","optionsAll svelte-1jaojxl"),m(y,"class","options svelte-1jaojxl"),m(t,"class","searchOptions svelte-1jaojxl"),m(e,"class","searchOptionsCont svelte-1jaojxl"),te(e,"optionsOpen",n[0])},m(C,N){F(C,e,N),p(e,t),p(t,i),p(t,s),p(t,o),se(r,o,null),p(o,l),se(a,o,null),p(o,c),se(u,o,null),p(t,d),p(t,f),p(f,_),p(_,h),p(f,b),p(f,v),p(v,w),p(t,k),p(t,y);for(let Z=0;Z<j.length;Z+=1)j[Z]&&j[Z].m(y,null);p(t,T),O&&O.m(t,null),R=!0,q||(I=[D(h,"click",n[17]),D(w,"click",n[18])],q=!0)},p(C,N){const Z={};N[0]&2&&(Z.checked=C[1]),N[0]&2&&(Z.forced=C[1]),r.$set(Z);const A={};N[0]&4&&(A.checked=C[2]),N[0]&4&&(A.forced=C[2]),a.$set(A);const P={};if(N[0]&8&&(P.checked=C[3]),N[0]&8&&(P.forced=C[3]),u.$set(P),N[0]&1600){W=Ne(Object.entries(C[9]));let M;for(M=0;M<W.length;M+=1){const U=Wr(C,W,M);j[M]?(j[M].p(U,N),B(j[M],1)):(j[M]=Hr(U),j[M].c(),B(j[M],1),j[M].m(y,null))}for(ze(),M=W.length;M<j.length;M+=1)Q(M);je()}C[8]||O.p(C,N),(!R||N[0]&1)&&te(e,"optionsOpen",C[0])},i(C){if(!R){B(r.$$.fragment,C),B(a.$$.fragment,C),B(u.$$.fragment,C);for(let N=0;N<W.length;N+=1)B(j[N]);B(O),R=!0}},o(C){H(r.$$.fragment,C),H(a.$$.fragment,C),H(u.$$.fragment,C),j=j.filter(Boolean);for(let N=0;N<j.length;N+=1)H(j[N]);H(O),R=!1},d(C){C&&L(e),oe(r),oe(a),oe(u),at(j,C),O&&O.d(),q=!1,be(I)}}}function Zp(n,e,t){let i;J(n,At,A=>t(24,i=A));let{optionsOpen:s,slotName:o,elementData:r,list:l}=e;const a=qt();let c=o=="gear",u=!0,d=!1,f=!1,_=!0,h=!1,b={},v={},w=c?{armor:"Armor",magicDmg:"Magic",meleeDmg:"Melee",rangedDmg:"Ranged",unique:"Unique",tool:"Tool"}:{...Mt,none:"No Stats"};for(let A of Object.keys(w))b[A]=!0;for(let A of Object.keys(w))v[A]=!1;let k=["Void Spike Ultradagger","Pureblood Dagger","Gnome Rocket Launcher"],y=[];function T(A){setTimeout(()=>{for(let P in r){let M=i[o].find(ee=>ee.name==P),U={...Mt},X={armor:!1,magicDmg:!1,meleeDmg:!1,rangedDmg:!1,unique:!1,tool:!1},fe=c?X:U,ce=!1;if(c)if(!M.tool&&!k.includes(M.name)){for(let ee in b)for(let z of M.moves)if(X[ee]=z.type.includes(ee),X[ee])break}else X.tool=!!M.tool,X.tool||(X.unique=M.info.type=="Unique",M.name=="Void Spike Ultradagger"&&(X.armor=!0,X.meleeDmg=!0));else{for(let ee in b)U[ee]=M.stats[ee]!=0;U.none=!!M.noStats}if(u)for(let ee in fe)if(b[ee]&&fe[ee]){ce=!1;break}else ce=!0;else if(d)for(let ee in fe)if(b[ee]&&fe[ee]){ce=!0;break}else ce=!1;else if(f)for(let ee in fe)if(b[ee]&&fe[ee]||!b[ee]&&!fe[ee])ce=!1;else{ce=!0;break}ce?r[P].classList.add("hidden","filtered"):r[P].classList.remove("hidden","filtered")}if(A=="sort"){let P=Object.keys(v).find(U=>v[U]),M=0;for(P&&!(P=="none"||P=="tool")?(y.sort((U,X)=>{let fe=R(U,X,!0).stats[P]-R(U,X,!1).stats[P];return M||(M=fe),fe}),M||(y=Object.values(r))):!P&&h&&(y=Object.values(r).toReversed()),P=="none"&&(y=[...Object.entries(r).filter(U=>i[o].find(X=>X.name==U[0]).noStats),...Object.entries(r).filter(U=>!i[o].find(X=>X.name==U[0]).noStats)],y=y.map(U=>U[1]),h&&y.reverse());l.lastElementChild;)l.removeChild(l.lastElementChild);if(P||!P&&h)for(let U of y)l.appendChild(U);else for(let U in r)l.appendChild(r[U])}a("listUpdate")})}function R(A,P,M){return i[o].find(U=>U.name==Object.keys(r).find(X=>r[X]===(_?M?P:A:M?A:P)))}const q=A=>{t(1,u=A.detail),A.detail&&(t(2,d=!1),t(3,f=!1)),T("filter")},I=A=>{t(2,d=A.detail),A.detail&&(t(1,u=!1),t(3,f=!1)),T("filter")},W=A=>{t(3,f=A.detail),A.detail&&(t(1,u=!1),t(2,d=!1)),T("filter")},j=A=>{A.target.blur();for(let P in b)t(6,b[P]=!0,b);T("filter")},Q=A=>{A.target.blur();for(let P in b)t(6,b[P]=!1,b);T("filter")},O=(A,P)=>{t(6,b[A]=P.detail,b),T("filter")},C=A=>{t(4,_=A.detail),A.detail&&t(5,h=!1),T("sort")},N=A=>{t(5,h=A.detail),A.detail&&t(4,_=!1),T("sort")},Z=(A,P)=>{if(t(7,v[A]=P.detail,v),P.detail)for(let M in v)M!=A&&t(7,v[M]=!1,v);T("sort")};return n.$$set=A=>{"optionsOpen"in A&&t(0,s=A.optionsOpen),"slotName"in A&&t(11,o=A.slotName),"elementData"in A&&t(12,r=A.elementData),"list"in A&&t(13,l=A.list)},n.$$.update=()=>{n.$$.dirty[0]&8192&&l&&(y=[...l.children])},[s,u,d,f,_,h,b,v,c,w,T,o,r,l,q,I,W,j,Q,O,C,N,Z]}class xp extends Me{constructor(e){super(),Pe(this,e,Zp,Jp,me,{optionsOpen:0,slotName:11,elementData:12,list:13},null,[-1,-1])}}function Gr(n,e,t){const i=n.slice();return i[61]=e[t],i}function $p(n){let e;return{c(){e=g("span"),e.textContent="Loading items...",m(e,"class","svelte-suojz2")},m(t,i){F(t,e,i)},p:re,i:re,o:re,d(t){t&&L(e)}}}function em(n){let e,t,i,s,o,r,l,a=n[3]!="sets"&&Vr(n),c=Ne(n[6]),u=[];for(let f=0;f<c.length;f+=1)u[f]=Kr(Gr(n,c,f));const d=f=>H(u[f],1,1,()=>{u[f]=null});return{c(){e=g("input"),t=E(),a&&a.c(),i=E(),s=g("ul");for(let f=0;f<u.length;f+=1)u[f].c();m(e,"type","text"),m(e,"class","searchBarInput"),m(e,"placeholder","Search..."),m(s,"class","svelte-suojz2"),te(s,"no-scrollbar",n[15].length<=4)},m(f,_){F(f,e,_),n[29](e),F(f,t,_),a&&a.m(f,_),F(f,i,_),F(f,s,_);for(let h=0;h<u.length;h+=1)u[h]&&u[h].m(s,null);n[42](s),o=!0,r||(l=[D(e,"keydown",n[18]),D(e,"input",n[19]),D(s,"mouseup",n[43]),D(s,"touchend",n[44],{passive:!0}),D(s,"scroll",n[45]),D(s,"scrollend",n[46])],r=!0)},p(f,_){if(f[3]!="sets"?a?a.p(f,_):(a=Vr(f),a.c(),a.m(i.parentNode,i)):a&&(a.d(1),a=null),_[0]&1197019){c=Ne(f[6]);let h;for(h=0;h<c.length;h+=1){const b=Gr(f,c,h);u[h]?(u[h].p(b,_),B(u[h],1)):(u[h]=Kr(b),u[h].c(),B(u[h],1),u[h].m(s,null))}for(ze(),h=c.length;h<u.length;h+=1)d(h);je()}(!o||_[0]&32768)&&te(s,"no-scrollbar",f[15].length<=4)},i(f){if(!o){for(let _=0;_<c.length;_+=1)B(u[_]);o=!0}},o(f){u=u.filter(Boolean);for(let _=0;_<u.length;_+=1)H(u[_]);o=!1},d(f){f&&(L(e),L(t),L(i),L(s)),n[29](null),a&&a.d(f),at(u,f),n[42](null),r=!1,be(l)}}}function Vr(n){let e,t,i;return{c(){e=g("button"),e.innerHTML='<iconify-icon icon="mi:filter"></iconify-icon>',m(e,"class","optionsButton svelte-suojz2")},m(s,o){F(s,e,o),n[30](e),t||(i=D(e,"click",n[31]),t=!0)},p:re,d(s){s&&L(e),n[30](null),t=!1,i()}}}function tm(n){let e,t,i,s;function o(a){n[39](a)}function r(a){n[40](a)}let l={itemData:n[61],eqSlotName:n[3]};return n[0]!==void 0&&(l.slotOpen=n[0]),n[9]!==void 0&&(l.scrolling=n[9]),e=new Fp({props:l}),ie.push(()=>Ae(e,"slotOpen",o)),ie.push(()=>Ae(e,"scrolling",r)),e.$on("itemSelect",n[20]),e.$on("displayInfo",n[41]),{c(){le(e.$$.fragment)},m(a,c){se(e,a,c),s=!0},p(a,c){const u={};c[0]&64&&(u.itemData=a[61]),c[0]&8&&(u.eqSlotName=a[3]),!t&&c[0]&1&&(t=!0,u.slotOpen=a[0],Re(()=>t=!1)),!i&&c[0]&512&&(i=!0,u.scrolling=a[9],Re(()=>i=!1)),e.$set(u)},i(a){s||(B(e.$$.fragment,a),s=!0)},o(a){H(e.$$.fragment,a),s=!1},d(a){oe(e,a)}}}function nm(n){let e,t,i;function s(r){n[37](r)}let o={itemData:n[61]};return n[0]!==void 0&&(o.ddOpen=n[0]),e=new Vp({props:o}),ie.push(()=>Ae(e,"ddOpen",s)),e.$on("setSelect",n[38]),{c(){le(e.$$.fragment)},m(r,l){se(e,r,l),i=!0},p(r,l){const a={};l[0]&64&&(a.itemData=r[61]),!t&&l[0]&1&&(t=!0,a.ddOpen=r[0],Re(()=>t=!1)),e.$set(a)},i(r){i||(B(e.$$.fragment,r),i=!0)},o(r){H(e.$$.fragment,r),i=!1},d(r){oe(e,r)}}}function im(n){let e,t,i,s,o;function r(u){n[32](u)}function l(u){n[33](u)}function a(u){n[34](u)}let c={itemData:n[61],index:n[4]};return n[0]!==void 0&&(c.slotOpen=n[0]),n[1]!==void 0&&(c.weaponExpand=n[1]),n[9]!==void 0&&(c.scrolling=n[9]),e=new Wp({props:c}),ie.push(()=>Ae(e,"slotOpen",r)),ie.push(()=>Ae(e,"weaponExpand",l)),ie.push(()=>Ae(e,"scrolling",a)),e.$on("itemSelect",n[20]),e.$on("toolSelect",n[35]),e.$on("displayInfo",n[36]),{c(){le(e.$$.fragment)},m(u,d){se(e,u,d),o=!0},p(u,d){const f={};d[0]&64&&(f.itemData=u[61]),d[0]&16&&(f.index=u[4]),!t&&d[0]&1&&(t=!0,f.slotOpen=u[0],Re(()=>t=!1)),!i&&d[0]&2&&(i=!0,f.weaponExpand=u[1],Re(()=>i=!1)),!s&&d[0]&512&&(s=!0,f.scrolling=u[9],Re(()=>s=!1)),e.$set(f)},i(u){o||(B(e.$$.fragment,u),o=!0)},o(u){H(e.$$.fragment,u),o=!1},d(u){oe(e,u)}}}function Kr(n){let e,t,i,s;const o=[im,nm,tm],r=[];function l(a,c){return a[4]?0:a[3]=="sets"?1:2}return e=l(n),t=r[e]=o[e](n),{c(){t.c(),i=ut()},m(a,c){r[e].m(a,c),F(a,i,c),s=!0},p(a,c){let u=e;e=l(a),e===u?r[e].p(a,c):(ze(),H(r[u],1,1,()=>{r[u]=null}),je(),t=r[e],t?t.p(a,c):(t=r[e]=o[e](a),t.c()),B(t,1),t.m(i.parentNode,i))},i(a){s||(B(t),s=!0)},o(a){H(t),s=!1},d(a){a&&L(i),r[e].d(a)}}}function Yr(n){let e,t,i,s;function o(a){n[47](a)}function r(a){n[48](a)}let l={slotName:n[3],elementData:n[16]};return n[2]!==void 0&&(l.optionsOpen=n[2]),n[5]!==void 0&&(l.list=n[5]),e=new xp({props:l}),ie.push(()=>Ae(e,"optionsOpen",o)),ie.push(()=>Ae(e,"list",r)),e.$on("listUpdate",n[19]),{c(){le(e.$$.fragment)},m(a,c){se(e,a,c),s=!0},p(a,c){const u={};c[0]&8&&(u.slotName=a[3]),c[0]&65536&&(u.elementData=a[16]),!t&&c[0]&4&&(t=!0,u.optionsOpen=a[2],Re(()=>t=!1)),!i&&c[0]&32&&(i=!0,u.list=a[5],Re(()=>i=!1)),e.$set(u)},i(a){s||(B(e.$$.fragment,a),s=!0)},o(a){H(e.$$.fragment,a),s=!1},d(a){oe(e,a)}}}function sm(n){let e,t,i,s,o,r,l;const a=[em,$p],c=[];function u(f,_){return f[6]?0:1}t=u(n),i=c[t]=a[t](n);let d=n[3]!="sets"&&Yr(n);return{c(){e=g("div"),i.c(),s=E(),d&&d.c(),m(e,"class","dropdown svelte-suojz2"),te(e,"infoDisplay",n[7])},m(f,_){F(f,e,_),c[t].m(e,null),p(e,s),d&&d.m(e,null),n[49](e),o=!0,r||(l=[D(window,"keydown",n[26]),D(window,"keyup",n[27]),D(window,"mousedown",n[28]),D(e,"transitionend",n[50]),D(e,"transitioncancel",n[51])],r=!0)},p(f,_){let h=t;t=u(f),t===h?c[t].p(f,_):(ze(),H(c[h],1,1,()=>{c[h]=null}),je(),i=c[t],i?i.p(f,_):(i=c[t]=a[t](f),i.c()),B(i,1),i.m(e,s)),f[3]!="sets"?d?(d.p(f,_),_[0]&8&&B(d,1)):(d=Yr(f),d.c(),B(d,1),d.m(e,null)):d&&(ze(),H(d,1,1,()=>{d=null}),je()),(!o||_[0]&128)&&te(e,"infoDisplay",f[7])},i(f){o||(B(i),B(d),o=!0)},o(f){H(i),H(d),o=!1},d(f){f&&L(e),c[t].d(),d&&d.d(),n[49](null),r=!1,be(l)}}}function om(n,e,t){let i,s,o,r,l,a,c,u,d;J(n,At,S=>t(22,o=S)),J(n,Pn,S=>t(23,r=S)),J(n,Ru,S=>t(24,l=S)),J(n,Mn,S=>t(25,a=S)),J(n,St,S=>t(54,c=S)),J(n,zt,S=>t(55,u=S)),J(n,Pt,S=>t(56,d=S));let{slotName:f,index:_=0,slotOpen:h,weaponExpand:b=null,optionsOpen:v=!1}=e;const w=qt();_?G(Mn,a[_]={},a):G(Pn,r[f]={},r);let k=!1,y=!1,T=!1,R,q,I,W,j,Q=null,O=!1,C=!1,N=[];function Z(){j&&j.classList.remove("lastElement"),t(15,N=I.querySelectorAll("li:not(.hidden)")),j=N[N.length-1],j&&j.classList.add("lastElement"),(!j||j.classList.contains("non-eligible"))&&(j=W)}function A(S){!S.shiftKey&&S.key=="Tab"&&!v&&(S.preventDefault(),setTimeout(()=>q.focus()))}function P(){j&&j.removeEventListener("keydown",A),Z(),j&&j.addEventListener("keydown",A)}function M(S){S.shiftKey&&S.key=="Tab"&&(S.preventDefault(),setTimeout(()=>(j.querySelector("button")||j).focus()))}function U(){iu(q.value,i),P()}function X(S){w("itemSelect",S.detail.element),t(13,Q=S.detail.element),O=S.detail.trusted;let ve=I.querySelector(".selectedItem");ve&&ve!=S.detail.element&&ve.classList.remove("selectedItem"),t(14,C=!0),O||(ce(),I.scrollTo(0,Q.offsetTop)),setTimeout(fe)}function fe(){G(St,c=structuredClone(Op),c);for(let S in d)d[S].cost.min!=null&&(G(St,c.armor.min+=d[S].cost.min,c),G(St,c.armor.max+=d[S].cost.max,c));G(St,c.armor.avg=Math.ceil((c.armor.min+c.armor.max)/2),c);for(let S in u)u[S].cost.min!=null&&(G(St,c.gear.min+=u[S].cost.min,c),G(St,c.gear.max+=u[S].cost.max,c));G(St,c.gear.avg=Math.ceil((c.gear.min+c.gear.max)/2),c),G(St,c.total.min=c.armor.min+c.gear.min,c),G(St,c.total.max=c.armor.max+c.gear.max,c),G(St,c.total.avg=Math.ceil((c.total.min+c.total.max)/2),c)}function ce(){t(14,C=!1),t(11,q.value="",q),U()}const ee=S=>{f!="sets"&&!k&&S.shiftKey&&t(7,k=!0)},z=S=>{f!="sets"&&S.key=="Shift"&&!y&&t(7,k=!1)},Y=()=>(t(7,k=!1),t(8,y=!1));function ue(S){ie[S?"unshift":"push"](()=>{q=S,t(11,q)})}function Fe(S){ie[S?"unshift":"push"](()=>{W=S,t(12,W)})}const Le=()=>t(2,v=!v);function ae(S){h=S,t(0,h)}function gt(S){b=S,t(1,b)}function ht(S){T=S,t(9,T)}const ke=()=>w("toolSelect"),Ye=()=>(t(7,k=!0),t(8,y=!0));function de(S){h=S,t(0,h)}const Ie=()=>t(14,C=!0);function Qe(S){h=S,t(0,h)}function K(S){T=S,t(9,T)}const qe=()=>(t(7,k=!0),t(8,y=!0));function _e(S){ie[S?"unshift":"push"](()=>{I=S,t(5,I)})}const Oe=()=>t(7,k=!1),V=()=>t(7,k=!1),pe=()=>t(9,T=!0),Te=()=>t(9,T=!1);function _t(S){v=S,t(2,v)}function xe(S){I=S,t(5,I)}function It(S){ie[S?"unshift":"push"](()=>{R=S,t(10,R)})}const Ge=S=>{S.propertyName=="visibility"&&S.target==R&&(C&&ce(),!h&&Q&&setTimeout(()=>I.scrollTo(0,Q.offsetTop)),Ji(q,h))},st=S=>{S.propertyName=="visibility"&&S.target==R&&(t(14,C=!1),Ji(q,h))};return n.$$set=S=>{"slotName"in S&&t(3,f=S.slotName),"index"in S&&t(4,_=S.index),"slotOpen"in S&&t(0,h=S.slotOpen),"weaponExpand"in S&&t(1,b=S.weaponExpand),"optionsOpen"in S&&t(2,v=S.optionsOpen)},n.$$.update=()=>{if(n.$$.dirty[0]&58720280&&t(16,i=_?a[_]:f=="sets"?l:r[f]),n.$$.dirty[0]&4194312&&t(6,s=o[f]),n.$$.dirty[0]&96&&I){t(15,N=I.querySelectorAll("li:not(.hidden)"));for(let S=0;S<I.childElementCount;S++)t(16,i[s[S].name]=I.children[S],i);Z(),P()}},[h,b,v,f,_,I,s,k,y,T,R,q,W,Q,C,N,i,w,M,U,X,ce,o,r,l,a,ee,z,Y,ue,Fe,Le,ae,gt,ht,ke,Ye,de,Ie,Qe,K,qe,_e,Oe,V,pe,Te,_t,xe,It,Ge,st]}class Ho extends Me{constructor(e){super(),Pe(this,e,om,sm,me,{slotName:3,index:4,slotOpen:0,weaponExpand:1,optionsOpen:2},null,[-1,-1,-1])}}function Qr(n){let e,t,i,s,o,r,l=n[1].name+"",a,c,u,d,f;return{c(){e=g("button"),t=g("img"),o=E(),r=g("span"),a=ne(l),Ze(t.src,i=n[1].image)||m(t,"src",i),m(t,"alt",s=n[1].name),m(t,"draggable","false"),m(t,"class","svelte-nknpqm"),m(r,"class","tooltip"),m(r,"id","left"),m(e,"class","svelte-nknpqm"),et(e,"display",n[1].link?"":"none")},m(_,h){F(_,e,h),p(e,t),p(e,o),p(e,r),p(r,a),u=!0,d||(f=[D(e,"click",n[13]),D(e,"focusin",n[14]),D(e,"outroend",n[15])],d=!0)},p(_,h){(!u||h&2&&!Ze(t.src,i=_[1].image))&&m(t,"src",i),(!u||h&2&&s!==(s=_[1].name))&&m(t,"alt",s),(!u||h&2)&&l!==(l=_[1].name+"")&&Se(a,l),h&2&&et(e,"display",_[1].link?"":"none")},i(_){u||(_&&we(()=>{u&&(c||(c=ge(e,Xe,{duration:150},!0)),c.run(1))}),u=!0)},o(_){_&&(c||(c=ge(e,Xe,{duration:150},!1)),c.run(0)),u=!1},d(_){_&&L(e),_&&c&&c.end(),d=!1,be(f)}}}function rm(n){let e,t,i=n[1],s,o,r=n[0].charAt(0).toUpperCase()+n[0].slice(1)+"",l,a,c,u,d,f,_,h,b,v,w,k,y=Qr(n);function T(I){n[19](I)}function R(I){n[20](I)}let q={slotName:n[0]};return n[4]!==void 0&&(q.slotOpen=n[4]),n[6]!==void 0&&(q.optionsOpen=n[6]),_=new Ho({props:q}),ie.push(()=>Ae(_,"slotOpen",T)),ie.push(()=>Ae(_,"optionsOpen",R)),_.$on("itemSelect",n[21]),{c(){e=g("div"),t=g("div"),y.c(),s=E(),o=g("button"),l=ne(r),a=E(),c=g("iconify-icon"),u=E(),d=g("button"),d.innerHTML='<iconify-icon icon="maki:cross" class="svelte-nknpqm"></iconify-icon> <span class="tooltip" id="top">Clear selection</span>',f=E(),le(_.$$.fragment),m(t,"class","eqSlotIcon ff-border svelte-nknpqm"),De(c,"icon","iconamoon:arrow-down-2-fill"),De(c,"class","svelte-nknpqm"),m(o,"class","ddButton svelte-nknpqm"),m(d,"class","clearButton svelte-nknpqm"),m(e,"class","eqSlotCont svelte-nknpqm"),te(e,"slotOpen",n[4]),te(e,"clearAllowed",n[5]&&n[7])},m(I,W){F(I,e,W),p(e,t),y.m(t,null),n[16](t),p(e,s),p(e,o),p(o,l),p(o,a),p(o,c),p(e,u),p(e,d),p(e,f),se(_,e,null),n[22](e),v=!0,w||(k=[D(window,"mousedown",n[11]),D(window,"keydown",n[12]),D(o,"click",n[17]),D(d,"click",n[18]),D(e,"mouseenter",n[23]),D(e,"mouseleave",n[24])],w=!0)},p(I,[W]){W&2&&me(i,i=I[1])?(ze(),H(y,1,1,re),je(),y=Qr(I),y.c(),B(y,1),y.m(t,null)):y.p(I,W),(!v||W&1)&&r!==(r=I[0].charAt(0).toUpperCase()+I[0].slice(1)+"")&&Se(l,r);const j={};W&1&&(j.slotName=I[0]),!h&&W&16&&(h=!0,j.slotOpen=I[4],Re(()=>h=!1)),!b&&W&64&&(b=!0,j.optionsOpen=I[6],Re(()=>b=!1)),_.$set(j),(!v||W&16)&&te(e,"slotOpen",I[4]),(!v||W&160)&&te(e,"clearAllowed",I[5]&&I[7])},i(I){v||(B(y),B(_.$$.fragment,I),v=!0)},o(I){H(y),H(_.$$.fragment,I),v=!1},d(I){I&&L(e),y.d(I),n[16](null),oe(_),n[22](null),w=!1,be(k)}}}function lm(n,e,t){let i,s,o;J(n,Pt,C=>t(10,i=C)),J(n,pn,C=>t(8,s=C)),J(n,x,C=>t(9,o=C));let{eqSlotName:r}=e,l,a,c=ps,u,d,f,_;const h=C=>{(!l.contains(C.target)&&!s||C.target==l||C.target==a)&&(t(4,u=!1),t(6,f=!1),C.target!=l&&C.target!=a&&t(5,d=!1))},b=C=>{C.key=="Tab"?setTimeout(()=>{t(5,d=l.contains(document.activeElement))}):C.key=="Escape"&&(t(4,u=!1),t(6,f=!1))},v=()=>{s||(t(4,u=!1),G(x,o.item.ongoing=!0,o),G(x,o.item.data={...c,slot:r,type:"eq"},o))},w=C=>{C.relatedTarget==null&&t(5,d=!0)},k=()=>{setTimeout(()=>Ap(a))};function y(C){ie[C?"unshift":"push"](()=>{a=C,t(3,a)})}const T=()=>{o.screenshot.ongoing||t(4,u=!u)},R=()=>{t(5,d=!1),l.classList.contains("clearAllowed")&&_.querySelector("button").click()};function q(C){u=C,t(4,u)}function I(C){f=C,t(6,f)}const W=C=>{setTimeout(()=>{t(7,_=C.detail.classList.contains("selectedItem")?C.detail:null),t(6,f=!1)})};function j(C){ie[C?"unshift":"push"](()=>{l=C,t(2,l)})}const Q=()=>t(5,d=!0),O=()=>{l.contains(document.activeElement)||t(5,d=!1)};return n.$$set=C=>{"eqSlotName"in C&&t(0,r=C.eqSlotName)},n.$$.update=()=>{n.$$.dirty&1027&&i[r]&&i[r].name!=c.name&&t(1,c=i[r])},[r,c,l,a,u,d,f,_,s,o,i,h,b,v,w,k,y,T,R,q,I,W,j,Q,O]}class am extends Me{constructor(e){super(),Pe(this,e,lm,rm,me,{eqSlotName:0})}}function Xr(n,e,t){const i=n.slice();return i[1]=e[t],i[2]=e,i[3]=t,i}function Jr(n){let e,t,i;function s(r){n[0](r,n[1],n[2],n[3])}let o={};return n[1]!==void 0&&(o.eqSlotName=n[1]),e=new am({props:o}),ie.push(()=>Ae(e,"eqSlotName",s)),{c(){le(e.$$.fragment)},m(r,l){se(e,r,l),i=!0},p(r,l){n=r;const a={};!t&&l&0&&(t=!0,a.eqSlotName=n[1],Re(()=>t=!1)),e.$set(a)},i(r){i||(B(e.$$.fragment,r),i=!0)},o(r){H(e.$$.fragment,r),i=!1},d(r){oe(e,r)}}}function cm(n){let e,t,i=Ne(Array(...jn)),s=[];for(let r=0;r<i.length;r+=1)s[r]=Jr(Xr(n,i,r));const o=r=>H(s[r],1,1,()=>{s[r]=null});return{c(){e=g("div");for(let r=0;r<s.length;r+=1)s[r].c();m(e,"class","armorBox svelte-35g1a3")},m(r,l){F(r,e,l);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null);t=!0},p(r,[l]){if(l&0){i=Ne(Array(...jn));let a;for(a=0;a<i.length;a+=1){const c=Xr(r,i,a);s[a]?(s[a].p(c,l),B(s[a],1)):(s[a]=Jr(c),s[a].c(),B(s[a],1),s[a].m(e,null))}for(ze(),a=i.length;a<s.length;a+=1)o(a);je()}},i(r){if(!t){for(let l=0;l<i.length;l+=1)B(s[l]);t=!0}},o(r){s=s.filter(Boolean);for(let l=0;l<s.length;l+=1)H(s[l]);t=!1},d(r){r&&L(e),at(s,r)}}}function um(n,e,t){function i(s,o,r,l){r[l]=s}return[i]}class dm extends Me{constructor(e){super(),Pe(this,e,um,cm,me,{})}}function fm(n){let e,t=(n[3]?`${Math.floor(n[5]*.675+19.8)}% Reduction`:n[5])+"",i,s,o;return{c(){e=g("span"),i=ne(t),m(e,"class","statValue svelte-gx367h"),m(e,"tabindex","0"),te(e,"hidden",n[2]),te(e,"negative",n[5]<0),te(e,"zero",n[5]==0),te(e,"reduction",n[3])},m(r,l){F(r,e,l),p(e,i),s||(o=[D(e,"mouseenter",n[11]),D(e,"mouseleave",n[12]),D(e,"focusin",n[13]),D(e,"focusout",n[14])],s=!0)},p(r,l){l&40&&t!==(t=(r[3]?`${Math.floor(r[5]*.675+19.8)}% Reduction`:r[5])+"")&&Se(i,t),l&4&&te(e,"hidden",r[2]),l&32&&te(e,"negative",r[5]<0),l&32&&te(e,"zero",r[5]==0),l&8&&te(e,"reduction",r[3])},d(r){r&&L(e),s=!1,be(o)}}}function hm(n){let e,t=(n[0]!="endurance"?n[5]:n[5].toFixed(2))+"",i;return{c(){e=g("span"),i=ne(t),m(e,"class","statValue svelte-gx367h"),te(e,"hidden",n[2]),te(e,"negative",n[5]<0),te(e,"zero",n[5]==0)},m(s,o){F(s,e,o),p(e,i)},p(s,o){o&33&&t!==(t=(s[0]!="endurance"?s[5]:s[5].toFixed(2))+"")&&Se(i,t),o&4&&te(e,"hidden",s[2]),o&32&&te(e,"negative",s[5]<0),o&32&&te(e,"zero",s[5]==0)},d(s){s&&L(e)}}}function _m(n){let e;return{c(){e=g("iconify-icon"),De(e,"icon","codicon:sparkle-filled"),De(e,"class","svelte-gx367h")},m(t,i){F(t,e,i)},p:re,d(t){t&&L(e)}}}function pm(n){let e,t=`${n[1]} Bonus`,i;return{c(){e=g("span"),i=ne(t),m(e,"class","statName svelte-gx367h")},m(s,o){F(s,e,o),p(e,i)},p(s,o){o&2&&t!==(t=`${s[1]} Bonus`)&&Se(i,t)},d(s){s&&L(e)}}}function mm(n){let e,t,i,s,o,r,l;function a(h,b){return h[0]!="armor"?hm:fm}let c=a(n),u=c(n);function d(h,b){if(h[2])return pm;if(h[4])return _m}let f=d(n),_=f&&f(n);return{c(){e=g("div"),t=g("img"),s=E(),u.c(),o=E(),_&&_.c(),Ze(t.src,i="stats/"+n[0]+".svg")||m(t,"src",i),m(t,"alt",n[1]),m(t,"class","svelte-gx367h"),m(e,"id",n[0]),m(e,"class","svelte-gx367h"),te(e,"hidden",n[5]==0)},m(h,b){F(h,e,b),p(e,t),p(e,s),u.m(e,null),p(e,o),_&&_.m(e,null),r||(l=[D(t,"mouseenter",n[9]),D(t,"mouseleave",n[10])],r=!0)},p(h,[b]){b&1&&!Ze(t.src,i="stats/"+h[0]+".svg")&&m(t,"src",i),b&2&&m(t,"alt",h[1]),c===(c=a(h))&&u?u.p(h,b):(u.d(1),u=c(h),u&&(u.c(),u.m(e,o))),f===(f=d(h))&&_?_.p(h,b):(_&&_.d(1),_=f&&f(h),_&&(_.c(),_.m(e,null))),b&1&&m(e,"id",h[0]),b&32&&te(e,"hidden",h[5]==0)},i:re,o:re,d(h){h&&L(e),u.d(),_&&_.d(),r=!1,be(l)}}}function gm(n,e,t){let i,s,o,r;J(n,At,k=>t(6,s=k)),J(n,On,k=>t(7,o=k)),J(n,pt,k=>t(8,r=k));let{codeName:l,formalName:a}=e,c,u,d=!1;const f=()=>t(2,c=!0),_=()=>t(2,c=!1),h=()=>t(3,u=!0),b=()=>t(3,u=!1),v=()=>t(3,u=!0),w=()=>t(3,u=!1);return n.$$set=k=>{"codeName"in k&&t(0,l=k.codeName),"formalName"in k&&t(1,a=k.formalName)},n.$$.update=()=>{if(n.$$.dirty&257&&t(5,i=r[l]),n.$$.dirty&193)for(let k in o)if(o[k]&&s.bonuses.find(y=>y.name==k).stats[l]!=0){t(4,d=!0);break}else t(4,d=!1)},[l,a,c,u,d,i,s,o,r,f,_,h,b,v,w]}class bm extends Me{constructor(e){super(),Pe(this,e,gm,mm,me,{codeName:0,formalName:1})}}function Zr(n,e,t){const i=n.slice();return i[8]=e[t][0],i[9]=e[t][1],i[10]=e,i[11]=t,i}function xr(n){let e,t,i,s;function o(a){n[4](a,n[8],n[10],n[11])}function r(a){n[5](a,n[9],n[10],n[11])}let l={};return n[8]!==void 0&&(l.codeName=n[8]),n[9]!==void 0&&(l.formalName=n[9]),e=new bm({props:l}),ie.push(()=>Ae(e,"codeName",o)),ie.push(()=>Ae(e,"formalName",r)),{c(){le(e.$$.fragment)},m(a,c){se(e,a,c),s=!0},p(a,c){n=a;const u={};!t&&c&0&&(t=!0,u.codeName=n[8],Re(()=>t=!1)),!i&&c&0&&(i=!0,u.formalName=n[9],Re(()=>i=!1)),e.$set(u)},i(a){s||(B(e.$$.fragment,a),s=!0)},o(a){H(e.$$.fragment,a),s=!1},d(a){oe(e,a)}}}function $r(n){let e,t,i,s,o=n[2]?"Copied!":`Copy ${n[1]?"all":""} as text`,r,l,a,c,u;return{c(){e=g("button"),t=g("iconify-icon"),i=E(),s=g("span"),r=ne(o),De(t,"icon","ic:round-content-copy"),De(t,"class","svelte-1vdju8g"),m(s,"class","tooltip"),m(s,"id","top"),m(e,"class","copyStatsButton svelte-1vdju8g")},m(d,f){F(d,e,f),p(e,t),p(e,i),p(e,s),p(s,r),a=!0,c||(u=D(e,"click",n[6]),c=!0)},p(d,f){(!a||f&6)&&o!==(o=d[2]?"Copied!":`Copy ${d[1]?"all":""} as text`)&&Se(r,o)},i(d){a||(d&&we(()=>{a&&(l||(l=ge(e,Xe,{duration:100},!0)),l.run(1))}),a=!0)},o(d){d&&(l||(l=ge(e,Xe,{duration:100},!1)),l.run(0)),a=!1},d(d){d&&L(e),d&&l&&l.end(),c=!1,u()}}}function vm(n){let e,t,i,s,o,r=Ne(Object.entries(Mt)),l=[];for(let u=0;u<r.length;u+=1)l[u]=xr(Zr(n,r,u));const a=u=>H(l[u],1,1,()=>{l[u]=null});let c=n[3]&&$r(n);return s=new ft({props:{text:"Show all stats"}}),s.$on("toggle",n[7]),{c(){e=g("div");for(let u=0;u<l.length;u+=1)l[u].c();t=E(),c&&c.c(),i=E(),le(s.$$.fragment),m(e,"class","statBox svelte-1vdju8g"),te(e,"showAll",n[1])},m(u,d){F(u,e,d);for(let f=0;f<l.length;f+=1)l[f]&&l[f].m(e,null);p(e,t),c&&c.m(e,null),p(e,i),se(s,e,null),o=!0},p(u,[d]){if(d&0){r=Ne(Object.entries(Mt));let f;for(f=0;f<r.length;f+=1){const _=Zr(u,r,f);l[f]?(l[f].p(_,d),B(l[f],1)):(l[f]=xr(_),l[f].c(),B(l[f],1),l[f].m(e,t))}for(ze(),f=r.length;f<l.length;f+=1)a(f);je()}u[3]?c?(c.p(u,d),d&8&&B(c,1)):(c=$r(u),c.c(),B(c,1),c.m(e,i)):c&&(ze(),H(c,1,1,()=>{c=null}),je()),(!o||d&2)&&te(e,"showAll",u[1])},i(u){if(!o){for(let d=0;d<r.length;d+=1)B(l[d]);B(c),B(s.$$.fragment,u),o=!0}},o(u){l=l.filter(Boolean);for(let d=0;d<l.length;d+=1)H(l[d]);H(c),H(s.$$.fragment,u),o=!1},d(u){u&&L(e),at(l,u),c&&c.d(),oe(s)}}}function ym(n,e,t){let i;J(n,pt,d=>t(0,i=d));let s=!1,o=!1,r=!1;function l(d,f,_,h){_[h][0]=d}function a(d,f,_,h){_[h][1]=d}const c=d=>{if(_n(d),o)return;let f="";for(let[_,h]of Object.entries(Mt)){let b=_=="armor"?"":`
`,v=i[_];_=="armor"?v+=` (${Math.floor(v*.675+19.8)}% Reduction)`:_=="endurance"?v=v.toFixed(2)+"%":_=="ammoReturn"&&(v+="%"),(s||!s&&v)&&(f+=`${b}${h}: ${v}`)}navigator.clipboard.writeText(f),t(2,o=!0),setTimeout(()=>t(2,o=!1),1e3)},u=d=>t(1,s=d.detail);return n.$$.update=()=>{if(n.$$.dirty&1&&i){t(3,r=!1);for(let d in i)if(i[d]){t(3,r=!0);break}}},[i,s,o,r,l,a,c,u]}class wm extends Me{constructor(e){super(),Pe(this,e,ym,vm,me,{})}}function km(n){let e,t,i,s,o,r,l,a,c,u;return{c(){e=g("div"),t=g("button"),t.textContent="-",i=E(),s=g("input"),o=E(),r=g("b"),r.textContent="%",l=E(),a=g("button"),a.textContent="+",m(t,"id","decrease"),m(t,"class","svelte-1m4n74o"),m(s,"type","number"),m(s,"placeholder","0"),m(s,"class","svelte-1m4n74o"),m(r,"class","svelte-1m4n74o"),m(a,"id","increase"),m(a,"class","svelte-1m4n74o"),m(e,"class","svelte-1m4n74o"),te(e,"non-percent",!n[1])},m(d,f){F(d,e,f),p(e,t),p(e,i),p(e,s),Bt(s,n[0]),p(e,o),p(e,r),p(e,l),p(e,a),c||(u=[D(t,"click",n[4]),D(s,"input",n[5]),D(s,"input",n[2]),D(a,"click",n[6])],c=!0)},p(d,[f]){f&1&&ra(s.value)!==d[0]&&Bt(s,d[0])},i:re,o:re,d(d){d&&L(e),c=!1,be(u)}}}function Cm(n,e,t){let{weaponName:i,value:s}=e,o=i!="Nature's Wrath Spellbook",r;o?(s=100,r=100):(s=4,r=4);function l(){s<0?t(0,s=0):s>r&&t(0,s=r),s%1!=0&&t(0,s=Math.floor(s))}const a=()=>{t(0,s--,s),l()};function c(){s=ra(this.value),t(0,s)}const u=()=>{t(0,s++,s),l()};return n.$$set=d=>{"weaponName"in d&&t(3,i=d.weaponName),"value"in d&&t(0,s=d.value)},[s,o,l,i,a,c,u]}class Em extends Me{constructor(e){super(),Pe(this,e,Cm,km,me,{weaponName:3,value:0})}}function el(n,e,t){const i=n.slice();i[53]=e[t];const s=i[53].name.includes("Fantastic Beamstorm")?"~":"";i[23]=s;const o=i[24].includes(i[53].name);return i[54]=o,i}function Sm(n){let e,t,i=n[2].description+"",s,o;return{c(){e=g("span"),t=ne('"'),s=ne(i),o=ne('"'),m(e,"id","toolDesc"),m(e,"class","svelte-1tlszo6")},m(r,l){F(r,e,l),p(e,t),p(e,s),p(e,o)},p(r,l){l[0]&4&&i!==(i=r[2].description+"")&&Se(s,i)},d(r){r&&L(e)}}}function Im(n){let e,t,i,s=`${n[5]?"Type":n[3].name}:`,o,r,l=n[20],a,c,u,d,f,_=n[5]?"Return":"Expand",h,b,v,w,k=nl(n),y=n[4]&&il(n);return{c(){e=g("button"),t=g("div"),i=g("span"),o=ne(s),r=E(),k.c(),c=E(),y&&y.c(),u=E(),d=g("span"),f=ne("("),h=ne(_),b=ne(")"),m(i,"class","svelte-1tlszo6"),et(i,"font-size",Object.keys(n[21]).includes(n[3].name)?`calc(var(--u) * ${n[21][n[3].name]})`:""),m(t,"id",a=n[5]?"":"basic"),m(t,"class","svelte-1tlszo6"),m(d,"class","tooltip svelte-1tlszo6"),m(d,"id","top"),m(e,"class","gearPreview svelte-1tlszo6"),et(e,"line-height",`${n[10]/6.5}px`)},m(T,R){F(T,e,R),p(e,t),p(t,i),p(i,o),p(t,r),k.m(t,null),p(e,c),y&&y.m(e,null),p(e,u),p(e,d),p(d,f),p(d,h),p(d,b),n[36](e),v||(w=D(e,"click",n[37]),v=!0)},p(T,R){R[0]&40&&s!==(s=`${T[5]?"Type":T[3].name}:`)&&Se(o,s),R[0]&2097160&&et(i,"font-size",Object.keys(T[21]).includes(T[3].name)?`calc(var(--u) * ${T[21][T[3].name]})`:""),R[0]&1048576&&me(l,l=T[20])?(k.d(1),k=nl(T),k.c(),k.m(t,null)):k.p(T,R),R[0]&32&&a!==(a=T[5]?"":"basic")&&m(t,"id",a),T[4]?y?y.p(T,R):(y=il(T),y.c(),y.m(e,u)):y&&(y.d(1),y=null),R[0]&32&&_!==(_=T[5]?"Return":"Expand")&&Se(h,_),R[0]&1024&&et(e,"line-height",`${T[10]/6.5}px`)},d(T){T&&L(e),k.d(T),y&&y.d(),n[36](null),v=!1,w()}}}function tl(n){let e;return{c(){e=g("iconify-icon"),De(e,"icon","codicon:sparkle-filled"),De(e,"class","svelte-1tlszo6")},m(t,i){F(t,e,i)},d(t){t&&L(e)}}}function nl(n){let e,t,i=(n[5]?n[2].info.type.replace("/","<b>,</b><br/>"):n[26](n[3]))+"",s,o=!n[5]&&n[6].basic&&tl();return{c(){e=g("span"),t=new yu(!1),s=E(),o&&o.c(),t.a=s,m(e,"class","svelte-1tlszo6")},m(r,l){F(r,e,l),t.m(i,e),p(e,s),o&&o.m(e,null)},p(r,l){l[0]&44&&i!==(i=(r[5]?r[2].info.type.replace("/","<b>,</b><br/>"):r[26](r[3]))+"")&&t.p(i),!r[5]&&r[6].basic?o||(o=tl(),o.c(),o.m(e,null)):o&&(o.d(1),o=null)},d(r){r&&L(e),o&&o.d()}}}function il(n){let e,t,i=`${n[5]?"Special":n[4].name.split(" (")[0]}:`,s,o,r=n[20],l,a=rl(n);return{c(){e=g("div"),t=g("span"),s=ne(i),o=E(),a.c(),m(t,"class","svelte-1tlszo6"),et(t,"font-size",Object.keys(n[21]).includes(n[4].name)?`calc(var(--u) * ${n[21][n[4].name]})`:""),m(e,"id",l=n[5]?"":"special"),m(e,"class","svelte-1tlszo6")},m(c,u){F(c,e,u),p(e,t),p(t,s),p(e,o),a.m(e,null)},p(c,u){u[0]&48&&i!==(i=`${c[5]?"Special":c[4].name.split(" (")[0]}:`)&&Se(s,i),u[0]&2097168&&et(t,"font-size",Object.keys(c[21]).includes(c[4].name)?`calc(var(--u) * ${c[21][c[4].name]})`:""),u[0]&1048576&&me(r,r=c[20])?(a.d(1),a=rl(c),a.c(),a.m(e,null)):a.p(c,u),u[0]&32&&l!==(l=c[5]?"":"special")&&m(e,"id",l)},d(c){c&&L(e),a.d(c)}}}function sl(n){let e,t;return{c(){e=g("span"),t=ne(n[23]),m(e,"id","prefix"),m(e,"class","svelte-1tlszo6")},m(i,s){F(i,e,s),p(e,t)},p(i,s){s[0]&8388608&&Se(t,i[23])},d(i){i&&L(e)}}}function ol(n){let e;return{c(){e=g("iconify-icon"),De(e,"icon","codicon:sparkle-filled"),De(e,"class","svelte-1tlszo6")},m(t,i){F(t,e,i)},d(t){t&&L(e)}}}function rl(n){let e,t,i=(n[5]?n[2].info.special:n[26](n[4]))+"",s,o,r=n[23]&&!n[5]&&sl(n),l=!n[5]&&n[6].special&&ol();return{c(){e=g("span"),r&&r.c(),t=E(),s=ne(i),o=E(),l&&l.c(),m(e,"class","svelte-1tlszo6")},m(a,c){F(a,e,c),r&&r.m(e,null),p(e,t),p(e,s),p(e,o),l&&l.m(e,null)},p(a,c){a[23]&&!a[5]?r?r.p(a,c):(r=sl(a),r.c(),r.m(e,t)):r&&(r.d(1),r=null),c[0]&52&&i!==(i=(a[5]?a[2].info.special:a[26](a[4]))+"")&&Se(s,i),!a[5]&&a[6].special?l||(l=ol(),l.c(),l.m(e,null)):l&&(l.d(1),l=null)},d(a){a&&L(e),r&&r.d(),l&&l.d()}}}function ll(n){let e,t,i,s,o,r,l=n[2].name+"",a,c,u,d,f,_;return{c(){e=g("button"),t=g("img"),o=E(),r=g("span"),a=ne(l),Ze(t.src,i=n[2].image)||m(t,"src",i),m(t,"alt",s=n[2].name),m(t,"draggable","false"),m(t,"class","svelte-1tlszo6"),m(r,"class","tooltip svelte-1tlszo6"),m(r,"id",c=n[19].screenshot.ongoing?"right":"top"),m(e,"class","svelte-1tlszo6"),et(e,"display",n[2].link?"":"none"),et(e,"border-radius",n[2].tool?"calc(var(--u))":"")},m(h,b){F(h,e,b),p(e,t),p(e,o),p(e,r),p(r,a),d=!0,f||(_=D(e,"click",n[38]),f=!0)},p(h,b){(!d||b[0]&4&&!Ze(t.src,i=h[2].image))&&m(t,"src",i),(!d||b[0]&4&&s!==(s=h[2].name))&&m(t,"alt",s),(!d||b[0]&4)&&l!==(l=h[2].name+"")&&Se(a,l),(!d||b[0]&524288&&c!==(c=h[19].screenshot.ongoing?"right":"top"))&&m(r,"id",c),b[0]&4&&et(e,"display",h[2].link?"":"none"),b[0]&4&&et(e,"border-radius",h[2].tool?"calc(var(--u))":"")},i(h){d||(h&&we(()=>{d&&(u||(u=ge(e,Xe,{duration:150},!0)),u.run(1))}),d=!0)},o(h){h&&(u||(u=ge(e,Xe,{duration:150},!1)),u.run(0)),d=!1},d(h){h&&L(e),h&&u&&u.end(),f=!1,_()}}}function al(n){let e,t,i,s,o,r,l,a,c,u;i=new ft({props:{text:"Toggle base values",checked:n[16]}}),i.$on("toggle",n[47]),o=new ft({props:{text:"Eyeball of Reckoning buff",checked:n[17]}}),o.$on("toggle",n[48]);let d=Ne(n[2].moves),f=[];for(let h=0;h<d.length;h+=1)f[h]=fl(el(n,d,h));const _=h=>H(f[h],1,1,()=>{f[h]=null});return{c(){e=g("div"),t=g("div"),le(i.$$.fragment),s=E(),le(o.$$.fragment),r=E(),l=g("div");for(let h=0;h<f.length;h+=1)f[h].c();m(t,"class","weaponToggles svelte-1tlszo6"),m(l,"class","weaponMoves svelte-1tlszo6"),m(e,"class","fullWeaponView svelte-1tlszo6")},m(h,b){F(h,e,b),p(e,t),se(i,t,null),p(t,s),se(o,t,null),p(e,r),p(e,l);for(let v=0;v<f.length;v+=1)f[v]&&f[v].m(l,null);u=!0},p(h,b){const v={};b[0]&65536&&(v.checked=h[16]),i.$set(v);const w={};if(b[0]&131072&&(w.checked=h[17]),o.$set(w),b[0]&219611268){d=Ne(h[2].moves);let k;for(k=0;k<d.length;k+=1){const y=el(h,d,k);f[k]?(f[k].p(y,b),B(f[k],1)):(f[k]=fl(y),f[k].c(),B(f[k],1),f[k].m(l,null))}for(ze(),k=d.length;k<f.length;k+=1)_(k);je()}},i(h){if(!u){B(i.$$.fragment,h),B(o.$$.fragment,h);for(let b=0;b<d.length;b+=1)B(f[b]);h&&we(()=>{u&&(c&&c.end(1),a=ua(e,Xe,{duration:150,delay:300}),a.start())}),u=!0}},o(h){H(i.$$.fragment,h),H(o.$$.fragment,h),f=f.filter(Boolean);for(let b=0;b<f.length;b+=1)H(f[b]);a&&a.invalidate(),h&&(c=da(e,Xe,{duration:150})),u=!1},d(h){h&&L(e),oe(i),oe(o),at(f,h),h&&c&&c.end()}}}function cl(n){let e,t,i,s;function o(a){n[49](a)}function r(a){n[50](a)}let l={};return n[7]!==void 0&&(l.value=n[7]),n[2].name!==void 0&&(l.weaponName=n[2].name),e=new Em({props:l}),ie.push(()=>Ae(e,"value",o)),ie.push(()=>Ae(e,"weaponName",r)),{c(){le(e.$$.fragment)},m(a,c){se(e,a,c),s=!0},p(a,c){const u={};!t&&c[0]&128&&(t=!0,u.value=a[7],Re(()=>t=!1)),!i&&c[0]&4&&(i=!0,u.weaponName=a[2].name,Re(()=>i=!1)),e.$set(u)},i(a){s||(B(e.$$.fragment,a),s=!0)},o(a){H(e.$$.fragment,a),s=!1},d(a){oe(e,a)}}}function ul(n){let e;return{c(){e=g("iconify-icon"),De(e,"icon","codicon:sparkle-filled"),De(e,"class","svelte-1tlszo6")},m(t,i){F(t,e,i)},d(t){t&&L(e)}}}function dl(n){let e,t=n[23]+(n[16]&&!n[54]?n[53].base:n[54]?n[27](n[53]):n[26](n[53]))+"",i,s,o=n[18][n[53].name]&&!n[16]&&ul();return{c(){e=g("span"),i=ne(t),s=E(),o&&o.c(),m(e,"class","svelte-1tlszo6")},m(r,l){F(r,e,l),p(e,i),p(e,s),o&&o.m(e,null)},p(r,l){l[0]&65540&&t!==(t=r[23]+(r[16]&&!r[54]?r[53].base:r[54]?r[27](r[53]):r[26](r[53]))+"")&&Se(i,t),r[18][r[53].name]&&!r[16]?o||(o=ul(),o.c(),o.m(e,null)):o&&(o.d(1),o=null)},d(r){r&&L(e),o&&o.d()}}}function fl(n){let e,t,i,s,o=(n[54]&&n[2].name=="Nature's Wrath Spellbook"?n[53].name.replace("Charged","Charge(s)"):n[53].name)+":",r,l,a=n[54]?[n[20],n[7],n[17]]:[n[20],n[17]],c,u,d=n[54]&&cl(n),f=dl(n);return{c(){e=g("div"),t=g("div"),i=g("span"),d&&d.c(),s=E(),r=ne(o),l=E(),f.c(),c=E(),m(i,"class","svelte-1tlszo6"),m(t,"class","ff-border svelte-1tlszo6"),m(e,"class","svelte-1tlszo6")},m(_,h){F(_,e,h),p(e,t),p(t,i),d&&d.m(i,null),p(i,s),p(i,r),p(t,l),f.m(t,null),p(e,c),u=!0},p(_,h){_[54]?d?(d.p(_,h),h[0]&4&&B(d,1)):(d=cl(_),d.c(),B(d,1),d.m(i,s)):d&&(ze(),H(d,1,1,()=>{d=null}),je()),(!u||h[0]&4)&&o!==(o=(_[54]&&_[2].name=="Nature's Wrath Spellbook"?_[53].name.replace("Charged","Charge(s)"):_[53].name)+":")&&Se(r,o),h[0]&1179780&&me(a,a=_[54]?[_[20],_[7],_[17]]:[_[20],_[17]])?(f.d(1),f=dl(_),f.c(),f.m(t,null)):f.p(_,h)},i(_){u||(B(d),u=!0)},o(_){H(d),u=!1},d(_){_&&L(e),d&&d.d(),f.d(_)}}}function Tm(n){let e,t,i,s,o="Gear"+(n[19].screenshot.ongoing?":":""),r,l,a,c,u,d=n[2],f,_,h,b,v,w,k,y,T,R,q,I;function W(M,U){if(M[2].name&&!M[2].tool)return Im;if(M[2].tool)return Sm}let j=W(n),Q=j&&j(n),O=ll(n);function C(M){n[42](M)}function N(M){n[43](M)}function Z(M){n[44](M)}let A={slotName:n[0],index:n[1]};n[14]!==void 0&&(A.slotOpen=n[14]),n[5]!==void 0&&(A.weaponExpand=n[5]),n[15]!==void 0&&(A.optionsOpen=n[15]),b=new Ho({props:A}),ie.push(()=>Ae(b,"slotOpen",C)),ie.push(()=>Ae(b,"weaponExpand",N)),ie.push(()=>Ae(b,"optionsOpen",Z)),b.$on("itemSelect",n[45]),b.$on("toolSelect",n[28]);let P=n[5]&&al(n);return{c(){e=g("div"),t=g("button"),i=g("iconify-icon"),s=E(),r=ne(o),l=E(),a=g("div"),Q&&Q.c(),c=E(),u=g("div"),O.c(),h=E(),le(b.$$.fragment),y=E(),P&&P.c(),T=ut(),De(i,"icon","iconamoon:arrow-down-2-fill"),De(i,"class","svelte-1tlszo6"),m(t,"class","ddButton svelte-1tlszo6"),m(u,"class","gearSlotIcon svelte-1tlszo6"),we(()=>n[39].call(u)),et(u,"min-width",`${n[11]}px`),m(a,"class","gearInfoCont ff-border svelte-1tlszo6"),we(()=>n[41].call(a)),et(a,"justify-content",n[2].name?"":"flex-end"),m(e,"class","gearSlot svelte-1tlszo6"),te(e,"slotOpen",n[14]),te(e,"weapon-expand",n[5])},m(M,U){F(M,e,U),p(e,t),p(t,i),p(t,s),p(t,r),n[34](t),p(e,l),p(e,a),Q&&Q.m(a,null),p(a,c),p(a,u),O.m(u,null),f=en(u,n[39].bind(u)),n[40](a),_=en(a,n[41].bind(a)),p(e,h),se(b,e,null),n[46](e),F(M,y,U),P&&P.m(M,U),F(M,T,U),R=!0,q||(I=[D(window,"mousedown",n[32]),D(window,"keydown",n[33]),D(t,"click",n[35])],q=!0)},p(M,U){(!R||U[0]&524288)&&o!==(o="Gear"+(M[19].screenshot.ongoing?":":""))&&Se(r,o),j===(j=W(M))&&Q?Q.p(M,U):(Q&&Q.d(1),Q=j&&j(M),Q&&(Q.c(),Q.m(a,c))),U[0]&4&&me(d,d=M[2])?(ze(),H(O,1,1,re),je(),O=ll(M),O.c(),B(O,1),O.m(u,null)):O.p(M,U),U[0]&2048&&et(u,"min-width",`${M[11]}px`),U[0]&4&&et(a,"justify-content",M[2].name?"":"flex-end");const X={};U[0]&1&&(X.slotName=M[0]),U[0]&2&&(X.index=M[1]),!v&&U[0]&16384&&(v=!0,X.slotOpen=M[14],Re(()=>v=!1)),!w&&U[0]&32&&(w=!0,X.weaponExpand=M[5],Re(()=>w=!1)),!k&&U[0]&32768&&(k=!0,X.optionsOpen=M[15],Re(()=>k=!1)),b.$set(X),(!R||U[0]&16384)&&te(e,"slotOpen",M[14]),(!R||U[0]&32)&&te(e,"weapon-expand",M[5]),M[5]?P?(P.p(M,U),U[0]&32&&B(P,1)):(P=al(M),P.c(),B(P,1),P.m(T.parentNode,T)):P&&(ze(),H(P,1,1,()=>{P=null}),je())},i(M){R||(B(O),B(b.$$.fragment,M),B(P),R=!0)},o(M){H(O),H(b.$$.fragment,M),H(P),R=!1},d(M){M&&(L(e),L(y),L(T)),n[34](null),Q&&Q.d(),O.d(M),f(),n[40](null),_(),oe(b),n[46](null),P&&P.d(M),q=!1,be(I)}}}function Nm(n,e,t){let i,s,o,r,l,a,c;J(n,On,V=>t(30,i=V)),J(n,zt,V=>t(31,s=V)),J(n,At,V=>t(51,o=V)),J(n,x,V=>t(19,r=V)),J(n,pt,V=>t(20,l=V)),J(n,bs,V=>t(21,a=V)),J(n,pn,V=>t(22,c=V));let{gearBox:u,slotName:d,index:f}=e,_,h,b,v,w,k,y,T=ms,R,q,I,W,j,Q=!1,O=!1,C="",N=["Charged Basic Attack","Charged Solar Beam"],Z={basic:!1,special:!1},A={};function P(){if(y)for(let V of y.querySelectorAll(".gearPreview > div")){if(Object.keys(a).includes(V.id=="basic"?R.name:q?q.name:null))return;let pe=Rp(V,c);pe&&(V.id=="basic"?G(bs,a[R.name]=pe,a):G(bs,a[q.name]=pe,a))}}function M(V){let pe;if(V.name=="Void Needle")pe=V.base+l[V.type]-l.armor*5.625;else if(T.name=="Pureblood Dagger"){let Te,_t={magicDmg:l.magicDmg,meleeDmg:l.meleeDmg,rangedDmg:l.rangedDmg},xe=Object.keys(_t).reduce((Ge,st)=>_t[Ge]>_t[st]?Ge:st),It=0;for(let Ge in _t)Ge!=xe&&(It+=_t[Ge]);Te=l[xe]*2-It,pe=V.base+(V.name.includes("HP")?Te/2:Te)}else if(V.type.includes("/")){let Te=V.type.split("/"),_t=0;for(let xe of Te)_t+=l[xe]*V[`${xe}Mult`];pe=V.base+_t}else pe=V.base+l[V.type]*V.mult;return O&&(!V.name.includes("HP")||V.name.includes("HP")&&T.name=="Pureblood Dagger")&&(pe+=pe*.08775),j?Math.floor(pe*10)/10:Math.floor(pe)}function U(V){let pe,Te=Q?0:l[V.type];return T.name=="Celestial Powers Spellbook"?pe=(80+Te*1.1)*(.8+2.2*_/100):T.name=="Staff of Dreams"?pe=160+160*_/100+Te*(.4+1.3*_/100):T.name=="Nature's Wrath Spellbook"&&(pe=260+400*_/4+Te*(1+1.5*_/4)),O&&(pe+=pe*.08775),Math.floor(pe*10)/10}function X(){r.screenshot.ongoing||(t(16,Q=!1),t(17,O=!1),j?(t(5,j=!1),u.classList.remove("weapon-expand"),setTimeout(P)):(u.classList.add("weapon-expand"),t(5,j=!0)))}function fe(V,pe){e:for(let Te in i){let _t=o.bonuses.find(It=>It.name==Te).stats,xe=V?V.type:null;for(let It in Mt){if(xe===null)break e;if(T.name=="Void Spike Ultradagger"&&pe=="special"||V.name=="Void Needle"?xe="armor/meleeDmg":T.name=="Pureblood Dagger"?xe=Te=="Fish of Rage"?"":"magicDmg/meleeDmg/rangedDmg":T.name=="Gnome Rocket Launcher"&&(xe=""),i[Te]&&_t[It]!=0&&xe.includes(It)){t(18,A[V.name]=!0,A),pe&&t(6,Z[pe]=!0,Z);break e}else t(18,A[V.name]=!1,A),pe&&t(6,Z[pe]=!1,Z)}}}const ce=V=>{(!h.contains(V.target)&&!c||h.contains(V.target)&&b.contains(V.target))&&(t(14,I=!1),t(15,W=!1))},ee=V=>{V.key=="Escape"&&(t(14,I=!1),t(15,W=!1))};function z(V){ie[V?"unshift":"push"](()=>{k=V,t(12,k)})}const Y=()=>{r.screenshot.ongoing||t(14,I=!I)};function ue(V){ie[V?"unshift":"push"](()=>{y=V,t(13,y)})}const Fe=V=>{_n(V),X()},Le=()=>{c||(G(x,r.item.ongoing=!0,r),G(x,r.item.data={...T,type:"gear"},r))};function ae(){w=this.offsetHeight,t(11,w)}function gt(V){ie[V?"unshift":"push"](()=>{b=V,t(9,b)})}function ht(){v=this.offsetHeight,t(10,v)}function ke(V){I=V,t(14,I)}function Ye(V){j=V,t(5,j)}function de(V){W=V,t(15,W)}const Ie=()=>{setTimeout(()=>{P(),(!T.name||T.tool)&&j&&X(),t(15,W=!1)})};function Qe(V){ie[V?"unshift":"push"](()=>{h=V,t(8,h)})}const K=V=>{t(16,Q=V.detail),V.detail&&t(17,O=!1)},qe=V=>{t(17,O=V.detail),V.detail&&t(16,Q=!1)};function _e(V){_=V,t(7,_)}function Oe(V){n.$$.not_equal(T.name,V)&&(T.name=V,t(2,T),t(31,s),t(1,f),t(4,q))}return n.$$set=V=>{"gearBox"in V&&t(29,u=V.gearBox),"slotName"in V&&t(0,d=V.slotName),"index"in V&&t(1,f=V.index)},n.$$.update=()=>{if(n.$$.dirty[0]&22|n.$$.dirty[1]&1&&s[f]&&s[f].name!=T.name&&(t(2,T=s[f]),!T.tool&&T.name)){t(3,R=T.moves.filter(V=>V.basic)[0]),t(4,q=T.moves.filter(V=>V.special)[0]),t(18,A={});for(let V of T.moves)t(18,A[V.name]=!1,A),fe(V);q&&q.name.includes("Fantastic Beamstorm")?t(23,C="~"):t(23,C="")}if(n.$$.dirty[0]&1073741948&&(i||j)&&!T.tool&&T.name){for(let V in Z)fe(V=="basic"?R:q||null,V);for(let V of T.moves)fe(V)}},[d,f,T,R,q,j,Z,_,h,b,v,w,k,y,I,W,Q,O,A,r,l,a,c,C,N,P,M,U,X,u,i,s,ce,ee,z,Y,ue,Fe,Le,ae,gt,ht,ke,Ye,de,Ie,Qe,K,qe,_e,Oe]}class Om extends Me{constructor(e){super(),Pe(this,e,Nm,Tm,me,{gearBox:29,slotName:0,index:1},null,[-1,-1])}}function hl(n,e,t){const i=n.slice();return i[3]=e[t],i}function _l(n){let e,t,i;function s(r){n[1](r)}let o={slotName:"gear",index:n[3]};return n[0]!==void 0&&(o.gearBox=n[0]),e=new Om({props:o}),ie.push(()=>Ae(e,"gearBox",s)),{c(){le(e.$$.fragment)},m(r,l){se(e,r,l),i=!0},p(r,l){const a={};!t&&l&1&&(t=!0,a.gearBox=r[0],Re(()=>t=!1)),e.$set(a)},i(r){i||(B(e.$$.fragment,r),i=!0)},o(r){H(e.$$.fragment,r),i=!1},d(r){oe(e,r)}}}function Dm(n){let e,t,i=Ne(yn),s=[];for(let r=0;r<i.length;r+=1)s[r]=_l(hl(n,i,r));const o=r=>H(s[r],1,1,()=>{s[r]=null});return{c(){e=g("div");for(let r=0;r<s.length;r+=1)s[r].c();m(e,"class","gearBox svelte-1lv6xba")},m(r,l){F(r,e,l);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null);n[2](e),t=!0},p(r,[l]){if(l&1){i=Ne(yn);let a;for(a=0;a<i.length;a+=1){const c=hl(r,i,a);s[a]?(s[a].p(c,l),B(s[a],1)):(s[a]=_l(c),s[a].c(),B(s[a],1),s[a].m(e,null))}for(ze(),a=i.length;a<s.length;a+=1)o(a);je()}},i(r){if(!t){for(let l=0;l<i.length;l+=1)B(s[l]);t=!0}},o(r){s=s.filter(Boolean);for(let l=0;l<s.length;l+=1)H(s[l]);t=!1},d(r){r&&L(e),at(s,r),n[2](null)}}}function Rm(n,e,t){let i;function s(r){i=r,t(0,i)}function o(r){ie[r?"unshift":"push"](()=>{i=r,t(0,i)})}return[i,s,o]}class Am extends Me{constructor(e){super(),Pe(this,e,Rm,Dm,me,{})}}function Pm(n){let e,t,i,s,o,r,l,a;return{c(){e=g("div"),t=g("div"),i=g("button"),i.textContent="Clear armor",s=E(),o=g("div"),r=g("button"),r.textContent="Clear gear",m(i,"class","svelte-e94uvj"),m(t,"class","buttonCont svelte-e94uvj"),m(r,"class","svelte-e94uvj"),m(o,"class","buttonCont svelte-e94uvj"),m(e,"class","mainFeatures svelte-e94uvj"),m(e,"id","box")},m(c,u){F(c,e,u),p(e,t),p(t,i),p(e,s),p(e,o),p(o,r),l||(a=[D(i,"click",n[3]),D(r,"click",n[4])],l=!0)},p:re,i:re,o:re,d(c){c&&L(e),l=!1,be(a)}}}function Mm(n,e,t){let i,s,o,r,l;J(n,zt,f=>t(5,i=f)),J(n,Mn,f=>t(6,s=f)),J(n,Pt,f=>t(7,o=f)),J(n,Pn,f=>t(8,r=f)),J(n,pn,f=>t(0,l=f));function a(){for(let f in o)o[f].name&&r[f][o[f].name].querySelector("button").click()}function c(){for(let f in i)i[f].name&&s[f][i[f].name].querySelector("button").click()}return[l,a,c,f=>{f.target.blur(),l||a()},f=>{f.target.blur(),l||c()}]}class Lm extends Me{constructor(e){super(),Pe(this,e,Mm,Pm,me,{})}}function pl(n){let e,t,i;function s(r){n[3](r)}let o={slotName:"sets"};return n[0]!==void 0&&(o.slotOpen=n[0]),e=new Ho({props:o}),ie.push(()=>Ae(e,"slotOpen",s)),{c(){le(e.$$.fragment)},m(r,l){se(e,r,l),i=!0},p(r,l){const a={};!t&&l&1&&(t=!0,a.slotOpen=r[0],Re(()=>t=!1)),e.$set(a)},i(r){i||(B(e.$$.fragment,r),i=!0)},o(r){H(e.$$.fragment,r),i=!1},d(r){oe(e,r)}}}function Bm(n){let e,t,i,s,o,r,l=n[1].head&&n[1].body&&n[1].legs&&n[1].feet&&pl(n);return{c(){e=g("button"),e.innerHTML=`Load armor set
    <iconify-icon icon="iconamoon:arrow-down-2-fill" rotate="180deg" class="svelte-l9dczq"></iconify-icon>`,t=E(),l&&l.c(),i=ut(),m(e,"class","svelte-l9dczq"),te(e,"ddOpen",n[0])},m(a,c){F(a,e,c),F(a,t,c),l&&l.m(a,c),F(a,i,c),s=!0,o||(r=D(e,"click",n[2]),o=!0)},p(a,[c]){(!s||c&1)&&te(e,"ddOpen",a[0]),a[1].head&&a[1].body&&a[1].legs&&a[1].feet?l?(l.p(a,c),c&2&&B(l,1)):(l=pl(a),l.c(),B(l,1),l.m(i.parentNode,i)):l&&(ze(),H(l,1,1,()=>{l=null}),je())},i(a){s||(B(l),s=!0)},o(a){H(l),s=!1},d(a){a&&(L(e),L(t),L(i)),l&&l.d(a),o=!1,r()}}}function Fm(n,e,t){let i;J(n,At,l=>t(1,i=l));let{ddOpen:s=!1}=e;const o=()=>t(0,s=!s);function r(l){s=l,t(0,s)}return n.$$set=l=>{"ddOpen"in l&&t(0,s=l.ddOpen)},[s,i,o,r]}class zm extends Me{constructor(e){super(),Pe(this,e,Fm,Bm,me,{ddOpen:0})}}function jm(n){let e;return{c(){e=g("span"),e.textContent="Create some builds to get started!",m(e,"class","tooltip svelte-lhwdnk"),m(e,"id","top"),et(e,"left","70.5%")},m(t,i){F(t,e,i)},p:re,d(t){t&&L(e)}}}function qm(n){let e;return{c(){e=g("span"),e.textContent="Select some gear or armor to get started!",m(e,"class","tooltip svelte-lhwdnk"),m(e,"id","top"),et(e,"left",n[3]?"38%":"")},m(t,i){F(t,e,i)},p(t,i){i&8&&et(e,"left",t[3]?"38%":"")},d(t){t&&L(e)}}}function Wm(n){let e,t,i,s,o,r,l,a,c,u,d,f,_,h,b,v,w,k,y,T,R,q,I,W,j,Q,O,C;function N(U,X){if(!U[4])return qm;if(!U[3])return jm}let Z=N(n),A=Z&&Z(n);function P(U){n[18](U)}let M={};return n[1]!==void 0&&(M.ddOpen=n[1]),W=new zm({props:M}),ie.push(()=>Ae(W,"ddOpen",P)),{c(){e=g("div"),t=g("div"),i=g("div"),s=g("button"),o=ne("Export new build"),l=E(),a=g("div"),c=g("button"),u=ne("Save to build"),f=E(),_=g("div"),h=g("button"),b=ne("Delete build"),w=E(),A&&A.c(),k=E(),y=g("div"),T=g("div"),R=g("button"),R.textContent="Load build",q=E(),I=g("div"),le(W.$$.fragment),s.disabled=r=!n[4],m(s,"class","svelte-lhwdnk"),m(i,"class","buttonCont svelte-lhwdnk"),c.disabled=d=!n[4]||!n[3],m(c,"class","svelte-lhwdnk"),m(a,"class","buttonCont svelte-lhwdnk"),m(a,"id","middle"),h.disabled=v=!n[3],m(h,"class","svelte-lhwdnk"),m(_,"class","buttonCont svelte-lhwdnk"),m(t,"id","modify"),m(t,"class","svelte-lhwdnk"),te(t,"no-tooltip",n[2]),m(R,"class","svelte-lhwdnk"),m(T,"class","buttonCont svelte-lhwdnk"),m(I,"class","buttonCont svelte-lhwdnk"),m(y,"id","load"),m(y,"class","svelte-lhwdnk"),m(e,"class","mainFeatures svelte-lhwdnk"),m(e,"id","build")},m(U,X){F(U,e,X),p(e,t),p(t,i),p(i,s),p(s,o),p(t,l),p(t,a),p(a,c),p(c,u),p(t,f),p(t,_),p(_,h),p(h,b),p(t,w),A&&A.m(t,null),p(e,k),p(e,y),p(y,T),p(T,R),p(y,q),p(y,I),se(W,I,null),n[19](I),Q=!0,O||(C=[D(window,"mousedown",n[8]),D(window,"keydown",n[9]),D(s,"click",n[10]),D(s,"mouseenter",n[11]),D(s,"mouseleave",n[12]),D(c,"click",n[13]),D(h,"click",n[14]),D(h,"mouseenter",n[15]),D(h,"mouseleave",n[16]),D(R,"click",n[17])],O=!0)},p(U,[X]){(!Q||X&16&&r!==(r=!U[4]))&&(s.disabled=r),(!Q||X&24&&d!==(d=!U[4]||!U[3]))&&(c.disabled=d),(!Q||X&8&&v!==(v=!U[3]))&&(h.disabled=v),Z===(Z=N(U))&&A?A.p(U,X):(A&&A.d(1),A=Z&&Z(U),A&&(A.c(),A.m(t,null))),(!Q||X&4)&&te(t,"no-tooltip",U[2]);const fe={};!j&&X&2&&(j=!0,fe.ddOpen=U[1],Re(()=>j=!1)),W.$set(fe)},i(U){Q||(B(W.$$.fragment,U),Q=!0)},o(U){H(W.$$.fragment,U),Q=!1},d(U){U&&L(e),A&&A.d(),oe(W),n[19](null),O=!1,be(C)}}}function Hm(n,e,t){let i,s,o,r,l;J(n,Tt,I=>t(7,i=I)),J(n,Qt,I=>t(3,s=I)),J(n,oo,I=>t(4,o=I)),J(n,pn,I=>t(5,r=I)),J(n,x,I=>t(6,l=I));let a,c=!1,u=!1;const d=I=>{a.contains(I.target)||t(1,c=!1)},f=I=>{I.key=="Escape"&&t(1,c=!1)},_=()=>{o&&!r&&G(x,l.export.ongoing=!0,l)},h=()=>t(2,u=!0),b=()=>t(2,u=!1),v=()=>{o&&s&&!r&&G(x,l.save.ongoing=!0,l)},w=()=>{s&&!r&&G(x,l.delete.ongoing=!0,l)},k=()=>t(2,u=!0),y=()=>t(2,u=!1),T=()=>{r||G(x,l.load.ongoing=!0,l)};function R(I){c=I,t(1,c)}function q(I){ie[I?"unshift":"push"](()=>{a=I,t(0,a)})}return n.$$.update=()=>{n.$$.dirty&128&&G(Qt,s=Object.keys(i).length>0,s)},[a,c,u,s,o,r,l,i,d,f,_,h,b,v,w,k,y,T,R,q]}class Um extends Me{constructor(e){super(),Pe(this,e,Hm,Wm,me,{})}}function ml(n){let e;return{c(){e=g("span"),e.textContent="New changes! Exiting will erase them.",m(e,"id","alert")},m(t,i){F(t,e,i)},d(t){t&&L(e)}}}function Gm(n){let e,t,i,s,o,r,l,a=25-n[3].length+"",c,u,d,f,_,h,b,v,w,k,y,T=275-n[4].length+"",R,q,I,W,j,Q,O,C,N,Z,A,P,M,U,X,fe,ce=(n[3]||n[4])&&ml();return{c(){e=g("div"),t=g("div"),i=ne(`Name:\r
        `),s=g("input"),r=E(),l=g("span"),c=ne(a),u=E(),d=g("div"),f=g("div"),_=g("span"),_.textContent="Description / Notes:",h=E(),ce&&ce.c(),b=E(),v=g("textarea"),k=E(),y=g("span"),R=ne(T),q=E(),I=g("div"),W=g("div"),j=g("button"),Q=ne("CANCEL"),C=E(),N=g("div"),Z=g("button"),A=ne("EXPORT"),m(s,"class","buildNameInput"),m(s,"id","firstFocusable"),s.disabled=o=n[5].export.status==0,m(s,"type","text"),m(s,"placeholder",n[6]),m(s,"maxlength","25"),m(l,"class","charCounter svelte-1vypdkl"),m(l,"id","buildName"),m(t,"class","buildNameCont svelte-1vypdkl"),m(v,"class","buildDescInput"),v.disabled=w=n[5].export.status==0,m(v,"placeholder","[Empty]"),m(v,"maxlength","275"),m(v,"autocomplete","off"),m(y,"class","charCounter"),m(y,"id","buildDesc"),m(d,"class","buildDescCont"),j.disabled=O=n[5].export.status==0,m(Z,"id","lastFocusable"),Z.disabled=P=n[5].export.status==0,m(I,"class","promptOptions"),m(e,"class","buildExporter svelte-1vypdkl")},m(ee,z){F(ee,e,z),p(e,t),p(t,i),p(t,s),n[8](s),Bt(s,n[3]),p(t,r),p(t,l),p(l,c),p(e,u),p(e,d),p(d,f),p(f,_),p(f,h),ce&&ce.m(f,null),p(d,b),p(d,v),Bt(v,n[4]),n[13](v),p(d,k),p(d,y),p(y,R),p(e,q),p(e,I),p(I,W),p(W,j),p(j,Q),n[16](j),p(I,C),p(I,N),p(N,Z),p(Z,A),U=!0,X||(fe=[D(s,"input",n[9]),D(s,"input",n[10]),D(s,"keydown",n[11]),D(v,"input",n[12]),D(v,"input",n[14]),D(v,"keydown",n[15]),D(j,"click",n[17]),D(Z,"click",n[18]),D(Z,"keydown",Ct),D(e,"introstart",n[19])],X=!0)},p(ee,[z]){(!U||z&32&&o!==(o=ee[5].export.status==0))&&(s.disabled=o),z&8&&s.value!==ee[3]&&Bt(s,ee[3]),(!U||z&8)&&a!==(a=25-ee[3].length+"")&&Se(c,a),ee[3]||ee[4]?ce||(ce=ml(),ce.c(),ce.m(f,null)):ce&&(ce.d(1),ce=null),(!U||z&32&&w!==(w=ee[5].export.status==0))&&(v.disabled=w),z&16&&Bt(v,ee[4]),(!U||z&16)&&T!==(T=275-ee[4].length+"")&&Se(R,T),(!U||z&32&&O!==(O=ee[5].export.status==0))&&(j.disabled=O),(!U||z&32&&P!==(P=ee[5].export.status==0))&&(Z.disabled=P)},i(ee){U||(ee&&we(()=>{U&&(M||(M=ge(e,$e,{duration:250},!0)),M.run(1))}),U=!0)},o(ee){ee&&(M||(M=ge(e,$e,{duration:250},!1)),M.run(0)),U=!1},d(ee){ee&&L(e),n[8](null),ce&&ce.d(),n[13](null),n[16](null),ee&&M&&M.end(),X=!1,be(fe)}}}function Vm(n,e,t){let i,s,o,r,l,a;J(n,x,N=>t(5,i=N)),J(n,bt,N=>t(20,s=N)),J(n,Qt,N=>t(21,o=N)),J(n,zt,N=>t(22,r=N)),J(n,Pt,N=>t(23,l=N)),J(n,Tt,N=>t(24,a=N));let c=Object.keys(a).length,u,d,f,_="",h="",b=`My ${c+1+tu[(c+1)%10]} build`;function v(){if(G(x,i.export.status=0,i),_.endsWith(" ")&&t(3,_=_.replace(/  +/g," ").replace(/ $/,"")),h.endsWith(" ")&&t(4,h=h.replace(/  +/g," ").replace(/ $/,"")),Object.keys(a).includes(_)){G(x,i.export.status=-1,i),G(x,i.message="duplicate_name",i);return}let N=cp(Vt(zn(qn),"builds")).key,Z=su(l,r);Z.name=_||b,Z.desc=h||"[Empty]",ds(Vt(zn(qn),`builds/${N}`),Z).then(()=>{G(x,i.export.status=1,i),G(Qt,o=!0,o),Wo(),Tt.update(A=>({...A,[Z.name]:{id:N,desc:Z.desc}})),G(bt,s=Z,s),G(bt,s.id=N,s),navigator.clipboard.writeText(`${location.origin+location.pathname}?id=${N}`)}).catch(()=>{G(x,i.export.status=-1,i),G(x,i.message="firebase_fail",i)})}function w(N){ie[N?"unshift":"push"](()=>{u=N,t(0,u)})}function k(){_=this.value,t(3,_)}const y=N=>{t(3,_=Zi(N.target.value,25))},T=N=>{i.export.status==0&&N.preventDefault(),kt(N),Zs(u,N.target.value,25)};function R(){h=this.value,t(4,h)}function q(N){ie[N?"unshift":"push"](()=>{d=N,t(1,d)})}const I=N=>{t(4,h=Zi(N.target.value,275))},W=N=>{i.export.status==0&&N.preventDefault(),Zs(d,N.target.value,275)};function j(N){ie[N?"unshift":"push"](()=>{f=N,t(2,f)})}return[u,d,f,_,h,i,b,v,w,k,y,T,R,q,I,W,j,()=>{i.export.status!=0&&G(x,i.export.ongoing=!1,i)},()=>{i.export.status!=0&&v()},()=>f.focus()]}class Km extends Me{constructor(e){super(),Pe(this,e,Vm,Gm,me,{})}}function Ym(n){let e,t,i,s,o=n[2]?"Copied!":"Copy link",r,l,a;return{c(){e=g("button"),t=g("b"),t.textContent="Build link",i=E(),s=g("span"),r=ne(o),m(s,"class","tooltip"),m(s,"id","top"),m(e,"class","copyButton svelte-1e8zrsj"),m(e,"id","firstFocusable")},m(c,u){F(c,e,u),p(e,t),p(e,i),p(e,s),p(s,r),l||(a=[D(e,"click",n[7]),D(e,"keydown",kt)],l=!0)},p(c,u){u&4&&o!==(o=c[2]?"Copied!":"Copy link")&&Se(r,o)},d(c){c&&L(e),l=!1,be(a)}}}function Qm(n){let e,t,i,s,o,r,l=n[2]?"Copied!":"Copy ID",a,c,u,d;return{c(){e=g("button"),t=g("b"),t.textContent="ID:",i=E(),s=ne(n[4]),o=E(),r=g("span"),a=ne(l),m(r,"class","tooltip"),m(r,"id","top"),m(e,"class","copyButton svelte-1e8zrsj"),m(e,"id",c=n[1]!="save"?"firstFocusable":"")},m(f,_){F(f,e,_),p(e,t),p(e,i),p(e,s),p(e,o),p(e,r),p(r,a),u||(d=[D(e,"click",n[5]),D(e,"keydown",n[6])],u=!0)},p(f,_){_&4&&l!==(l=f[2]?"Copied!":"Copy ID")&&Se(a,l),_&2&&c!==(c=f[1]!="save"?"firstFocusable":"")&&m(e,"id",c)},d(f){f&&L(e),u=!1,be(d)}}}function Xm(n){let e;function t(o,r){if(o[0]=="id")return Qm;if(o[0]=="link")return Ym}let i=t(n),s=i&&i(n);return{c(){s&&s.c(),e=ut()},m(o,r){s&&s.m(o,r),F(o,e,r)},p(o,[r]){i===(i=t(o))&&s?s.p(o,r):(s&&s.d(1),s=i&&i(o),s&&(s.c(),s.m(e.parentNode,e)))},i:re,o:re,d(o){o&&L(e),s&&s.d(o)}}}function Jm(n,e,t){let i;J(n,bt,f=>t(8,i=f));let{type:s,source:o}=e,r=!1;function l(f){r||(navigator.clipboard.writeText(f),t(2,r=!0),setTimeout(()=>t(2,r=!1),1e3))}let a=i?i.id:null;const c=()=>l(a),u=()=>{o!="save"&&kt()},d=()=>l(`${location.origin+location.pathname}?id=${a}`);return n.$$set=f=>{"type"in f&&t(0,s=f.type),"source"in f&&t(1,o=f.source)},[s,o,r,l,a,c,u,d]}class mi extends Me{constructor(e){super(),Pe(this,e,Jm,Xm,me,{type:0,source:1})}}function Zm(n){let e,t,i,s;return e=new mi({props:{type:"link",source:"share"}}),i=new mi({props:{type:"id",source:"share"}}),{c(){le(e.$$.fragment),t=E(),le(i.$$.fragment)},m(o,r){se(e,o,r),F(o,t,r),se(i,o,r),s=!0},p:re,i(o){s||(B(e.$$.fragment,o),B(i.$$.fragment,o),s=!0)},o(o){H(e.$$.fragment,o),H(i.$$.fragment,o),s=!1},d(o){o&&L(t),oe(e,o),oe(i,o)}}}function xm(n){let e;return{c(){e=g("span"),e.textContent="Your build has been erased from your local saves and the database."},m(t,i){F(t,e,i)},p:re,i:re,o:re,d(t){t&&L(e)}}}function $m(n){let e;function t(o,r){if(o[2].message=="not_found")return sg;if(o[2].message=="invalid_id")return ig}let i=t(n),s=i&&i(n);return{c(){s&&s.c(),e=ut()},m(o,r){s&&s.m(o,r),F(o,e,r)},p(o,r){i!==(i=t(o))&&(s&&s.d(1),s=i&&i(o),s&&(s.c(),s.m(e.parentNode,e)))},i:re,o:re,d(o){o&&L(e),s&&s.d(o)}}}function eg(n){let e,t,i,s,o,r;return i=new mi({props:{type:"link",source:"save"}}),o=new mi({props:{type:"id",source:"save"}}),{c(){e=g("span"),e.textContent="Your build has been overwritten.",t=E(),le(i.$$.fragment),s=E(),le(o.$$.fragment)},m(l,a){F(l,e,a),F(l,t,a),se(i,l,a),F(l,s,a),se(o,l,a),r=!0},p:re,i(l){r||(B(i.$$.fragment,l),B(o.$$.fragment,l),r=!0)},o(l){H(i.$$.fragment,l),H(o.$$.fragment,l),r=!1},d(l){l&&(L(e),L(t),L(s)),oe(i,l),oe(o,l)}}}function tg(n){let e,t,i,s;const o=[rg,og],r=[];function l(a,c){return a[2].export.status==1?0:a[2].export.status==-1&&a[2].message=="duplicate_name"?1:-1}return~(e=l(n))&&(t=r[e]=o[e](n)),{c(){t&&t.c(),i=ut()},m(a,c){~e&&r[e].m(a,c),F(a,i,c),s=!0},p(a,c){let u=e;e=l(a),e!==u&&(t&&(ze(),H(r[u],1,1,()=>{r[u]=null}),je()),~e?(t=r[e],t||(t=r[e]=o[e](a),t.c()),B(t,1),t.m(i.parentNode,i)):t=null)},i(a){s||(B(t),s=!0)},o(a){H(t),s=!1},d(a){a&&L(i),~e&&r[e].d(a)}}}function ng(n){let e,t,i=n[2].export.status?"exporting":n[2].save.status?"saving":n[2].load.status?"loading":"deleting",s,o,r,l,a,c,u,d;return{c(){e=g("span"),t=ne("A problem occurred while "),s=ne(i),o=ne(` your build.\r
            `),r=g("br"),l=ne(`\r
            If needed`),a=g("b"),a.textContent=",",c=ne(" you may contact "),u=g("hl"),u.textContent="xt.ss",d=ne(` on Discord for more\r
            details.`)},m(f,_){F(f,e,_),p(e,t),p(e,s),p(e,o),p(e,r),p(e,l),p(e,a),p(e,c),p(e,u),p(e,d)},p(f,_){_&4&&i!==(i=f[2].export.status?"exporting":f[2].save.status?"saving":f[2].load.status?"loading":"deleting")&&Se(s,i)},i:re,o:re,d(f){f&&L(e)}}}function ig(n){let e;return{c(){e=g("span"),e.textContent="The ID you have entered is invalid. Please check it again."},m(t,i){F(t,e,i)},d(t){t&&L(e)}}}function sg(n){let e;return{c(){e=g("span"),e.innerHTML=`Your build could not be found within the database.
                <br/>
                If needed<b>,</b> you may contact <hl>xt.ss</hl> on Discord for more
                details.`},m(t,i){F(t,e,i)},d(t){t&&L(e)}}}function og(n){let e;return{c(){e=g("span"),e.innerHTML=`Another build of yours with the same name already exists.
                <br/>
                Please use a different one.`},m(t,i){F(t,e,i)},i:re,o:re,d(t){t&&L(e)}}}function rg(n){let e,t,i,s;return i=new mi({props:{type:"id",source:"export"}}),{c(){e=g("span"),e.textContent="Your build's link has been copied to your clipboard.",t=E(),le(i.$$.fragment)},m(o,r){F(o,e,r),F(o,t,r),se(i,o,r),s=!0},i(o){s||(B(i.$$.fragment,o),s=!0)},o(o){H(i.$$.fragment,o),s=!1},d(o){o&&(L(e),L(t)),oe(i,o)}}}function lg(n){let e,t,i,s,o,r,l,a,c,u,d,f,_,h,b,v,w;const k=[ng,tg,eg,$m,xm,Zm],y=[];function T(R,q){return R[1]==-1&&R[2].message=="firebase_fail"?0:R[2].export.status?1:R[2].save.status==1?2:R[2].load.status==-1?3:R[2].delete.status==1?4:R[2].share.ongoing?5:-1}return~(o=T(n))&&(r=y[o]=k[o](n)),{c(){e=g("div"),t=g("span"),i=ne(n[4]),s=E(),r&&r.c(),l=E(),a=g("div"),c=g("div"),u=g("button"),d=ne("OK"),m(t,"id","messageTitle"),m(t,"class","svelte-nfbx2w"),m(u,"id",f=(n[1]==-1?"firstFocusable ":"")+"lastFocusable"),m(a,"class","promptOptions svelte-nfbx2w"),m(e,"class","promptMessage svelte-nfbx2w")},m(R,q){F(R,e,q),p(e,t),p(t,i),p(e,s),~o&&y[o].m(e,null),p(e,l),p(e,a),p(a,c),p(c,u),p(u,d),n[6](u),b=!0,v||(w=[D(u,"click",n[7]),D(u,"keydown",n[8]),D(e,"introstart",n[9])],v=!0)},p(R,[q]){(!b||q&16)&&Se(i,R[4]);let I=o;o=T(R),o===I?~o&&y[o].p(R,q):(r&&(ze(),H(y[I],1,1,()=>{y[I]=null}),je()),~o?(r=y[o],r?r.p(R,q):(r=y[o]=k[o](R),r.c()),B(r,1),r.m(e,l)):r=null),(!b||q&2&&f!==(f=(R[1]==-1?"firstFocusable ":"")+"lastFocusable"))&&m(u,"id",f)},i(R){b||(B(r),R&&we(()=>{b&&(h&&h.end(1),_=ua(e,$e,{duration:200,delay:75}),_.start())}),b=!0)},o(R){H(r),_&&_.invalidate(),R&&(h=da(e,$e,{duration:200})),b=!1},d(R){R&&L(e),~o&&y[o].d(),n[6](null),R&&h&&h.end(),v=!1,be(w)}}}function ag(n,e,t){let i,s,o;J(n,x,_=>t(2,o=_));let{loadID:r}=e;const l=qt();let a;function c(_){ie[_?"unshift":"push"](()=>{a=_,t(3,a)})}const u=()=>{t(0,r=null),l("resetActions")},d=_=>{s==-1&&kt(_),Ct(_)},f=()=>a.focus();return n.$$set=_=>{"loadID"in _&&t(0,r=_.loadID)},n.$$.update=()=>{n.$$.dirty&4&&t(1,s=o.export.status||o.save.status||o.load.status||o.delete.status),n.$$.dirty&6&&t(4,i=o.share.ongoing?"Share this build":`${o.export.status?"Export":o.save.status?"Save":o.load.status?"Load":"Delete"} ${s==1?"Success":"Failure"}!`)},[r,s,o,a,i,l,c,u,d,f]}class cg extends Me{constructor(e){super(),Pe(this,e,ag,lg,me,{loadID:0})}}function ug(n){let e,t,i,s,o,r;return{c(){e=g("li"),t=g("button"),i=g("span"),s=ne(n[0]),m(i,"class","svelte-1opo0ke"),m(e,"class","svelte-1opo0ke"),te(e,"selectedItem",n[2])},m(l,a){F(l,e,a),p(e,t),p(t,i),p(i,s),n[7](e),o||(r=D(t,"click",n[3]),o=!0)},p(l,[a]){a&1&&Se(s,l[0]),a&4&&te(e,"selectedItem",l[2])},i:re,o:re,d(l){l&&L(e),n[7](null),o=!1,r()}}}function dg(n,e,t){let{chosenBuild:i,buildData:s,buildName:o,ddOpen:r}=e;const l=qt();let a,c=i[0]==o;function u(){if(r){if(a.classList.contains("selectedItem")||t(2,c=!1),c)return;l("buildSelect",a),t(2,c=!0),t(5,r=!1),t(4,i=[o,s])}}function d(f){ie[f?"unshift":"push"](()=>{a=f,t(1,a)})}return n.$$set=f=>{"chosenBuild"in f&&t(4,i=f.chosenBuild),"buildData"in f&&t(6,s=f.buildData),"buildName"in f&&t(0,o=f.buildName),"ddOpen"in f&&t(5,r=f.ddOpen)},[o,a,c,u,i,r,s,d]}class fg extends Me{constructor(e){super(),Pe(this,e,dg,ug,me,{chosenBuild:4,buildData:6,buildName:0,ddOpen:5})}}function gl(n,e,t){const i=n.slice();return i[25]=e[t][0],i[26]=e[t][1],i}function bl(n){let e,t,i,s;function o(a){n[13](a)}function r(a){n[14](a)}let l={buildData:n[26],buildName:n[25]};return n[0]!==void 0&&(l.chosenBuild=n[0]),n[1]!==void 0&&(l.ddOpen=n[1]),e=new fg({props:l}),ie.push(()=>Ae(e,"chosenBuild",o)),ie.push(()=>Ae(e,"ddOpen",r)),e.$on("buildSelect",n[11]),{c(){le(e.$$.fragment)},m(a,c){se(e,a,c),s=!0},p(a,c){const u={};c&16&&(u.buildData=a[26]),c&16&&(u.buildName=a[25]),!t&&c&1&&(t=!0,u.chosenBuild=a[0],Re(()=>t=!1)),!i&&c&2&&(i=!0,u.ddOpen=a[1],Re(()=>i=!1)),e.$set(u)},i(a){s||(B(e.$$.fragment,a),s=!0)},o(a){H(e.$$.fragment,a),s=!1},d(a){oe(e,a)}}}function hg(n){let e,t,i,s,o,r,l,a=Ne(Object.entries(n[4])),c=[];for(let d=0;d<a.length;d+=1)c[d]=bl(gl(n,a,d));const u=d=>H(c[d],1,1,()=>{c[d]=null});return{c(){e=g("div"),t=g("input"),i=E(),s=g("ul");for(let d=0;d<c.length;d+=1)c[d].c();m(t,"type","text"),m(t,"class","searchBarInput svelte-p20blu"),m(t,"placeholder","Search..."),m(s,"class","svelte-p20blu"),te(s,"no-scrollbar",n[8].length<=4),m(e,"class","dropdown svelte-p20blu"),te(e,"ddOpen",n[1])},m(d,f){F(d,e,f),p(e,t),n[12](t),p(e,i),p(e,s);for(let _=0;_<c.length;_+=1)c[_]&&c[_].m(s,null);n[15](s),n[16](e),o=!0,r||(l=[D(t,"input",n[10]),D(t,"keydown",n[9]),D(e,"transitionend",n[17]),D(e,"transitioncancel",n[18])],r=!0)},p(d,[f]){if(f&2067){a=Ne(Object.entries(d[4]));let _;for(_=0;_<a.length;_+=1){const h=gl(d,a,_);c[_]?(c[_].p(h,f),B(c[_],1)):(c[_]=bl(h),c[_].c(),B(c[_],1),c[_].m(s,null))}for(ze(),_=a.length;_<c.length;_+=1)u(_);je()}(!o||f&256)&&te(s,"no-scrollbar",d[8].length<=4),(!o||f&2)&&te(e,"ddOpen",d[1])},i(d){if(!o){for(let f=0;f<a.length;f+=1)B(c[f]);o=!0}},o(d){c=c.filter(Boolean);for(let f=0;f<c.length;f+=1)H(c[f]);o=!1},d(d){d&&L(e),n[12](null),at(c,d),n[15](null),n[16](null),r=!1,be(l)}}}function _g(n,e,t){let i;J(n,Tt,C=>t(4,i=C));let{chosenBuild:s,ddOpen:o=!1,dropdown:r}=e;const l=qt();let a,c,u,d,f={},_=!1,h=[];function b(C){!C.shiftKey&&C.key=="Tab"&&(C.preventDefault(),setTimeout(()=>a.focus()))}function v(){c&&c.removeEventListener("keydown",b),y(),c&&c.addEventListener("keydown",b)}function w(C){C.shiftKey&&C.key=="Tab"&&(C.preventDefault(),setTimeout(()=>(c.querySelector("button")||c).focus()))}function k(){iu(a.value,f),v()}function y(){c&&c.classList.remove("lastElement"),t(8,h=u.querySelectorAll("li:not(.hidden)")),c=h[h.length-1],c?c.classList.add("lastElement"):c=a}function T(C){l("buildSelect"),t(6,d=C.detail);let N=u.querySelector(".selectedItem");N&&N!=C.detail&&N.classList.remove("selectedItem"),t(7,_=!0)}function R(C){ie[C?"unshift":"push"](()=>{a=C,t(5,a)})}function q(C){s=C,t(0,s)}function I(C){o=C,t(1,o)}function W(C){ie[C?"unshift":"push"](()=>{u=C,t(3,u)})}function j(C){ie[C?"unshift":"push"](()=>{r=C,t(2,r)})}const Q=C=>{C.propertyName=="visibility"&&(_&&(t(7,_=!1),t(5,a.value="",a),k()),!o&&d&&u.scrollTo(0,d.offsetTop),Ji(a,o))},O=C=>{C.propertyName=="visibility"&&(t(7,_=!1),Ji(a,o))};return n.$$set=C=>{"chosenBuild"in C&&t(0,s=C.chosenBuild),"ddOpen"in C&&t(1,o=C.ddOpen),"dropdown"in C&&t(2,r=C.dropdown)},n.$$.update=()=>{if(n.$$.dirty&24&&u){t(8,h=u.querySelectorAll("li:not(.hidden)"));for(let C=0;C<u.childElementCount;C++)f[Object.keys(i)[C]]=u.children[C];y(),v()}},[s,o,r,u,i,a,d,_,h,w,k,T,R,q,I,W,j,Q,O]}class Uo extends Me{constructor(e){super(),Pe(this,e,_g,hg,me,{chosenBuild:0,ddOpen:1,dropdown:2})}}function vl(n){let e,t=(n[6]>n[5]*.8?n[11].slice(0,20)+"<b>...</b>":n[11])+"",i;return{c(){e=g("span"),we(()=>n[15].call(e))},m(s,o){F(s,e,o),e.innerHTML=t,i=en(e,n[15].bind(e))},p(s,o){o[0]&2144&&t!==(t=(s[6]>s[5]*.8?s[11].slice(0,20)+"<b>...</b>":s[11])+"")&&(e.innerHTML=t)},d(s){s&&L(e),i()}}}function yl(n){let e;return{c(){e=g("span"),e.textContent="New changes! Exiting will erase them.",m(e,"id","alert")},m(t,i){F(t,e,i)},d(t){t&&L(e)}}}function pg(n){let e,t,i,s,o,r=n[11],l,a,c,u,d,f,_,h,b,v,w,k,y,T,R=275-n[2].length+"",q,I,W,j,Q,O,C,N,Z,A,P,M,U,X,fe,ce,ee,z,Y,ue,Fe,Le=vl(n),ae=n[1]!=null&&n[1]!=n[2]&&yl();function gt(de){n[26](de)}function ht(de){n[27](de)}function ke(de){n[28](de)}let Ye={};return n[0]!==void 0&&(Ye.chosenBuild=n[0]),n[3]!==void 0&&(Ye.ddOpen=n[3]),n[9]!==void 0&&(Ye.dropdown=n[9]),X=new Uo({props:Ye}),ie.push(()=>Ae(X,"chosenBuild",gt)),ie.push(()=>Ae(X,"ddOpen",ht)),ie.push(()=>Ae(X,"dropdown",ke)),X.$on("buildSelect",n[29]),{c(){e=g("div"),t=g("div"),i=g("span"),i.textContent="Save to:",s=E(),o=g("button"),Le.c(),l=E(),a=g("iconify-icon"),d=E(),f=g("div"),_=g("div"),h=g("span"),h.textContent="Description / Notes:",b=E(),ae&&ae.c(),v=E(),w=g("textarea"),y=E(),T=g("span"),q=ne(R),I=E(),W=g("div"),j=g("div"),Q=g("button"),O=ne("CANCEL"),N=E(),Z=g("div"),A=g("button"),P=ne("SAVE"),U=E(),le(X.$$.fragment),De(a,"icon","iconamoon:arrow-down-2-fill"),m(o,"id","firstFocusable"),o.disabled=c=n[12].save.status==0,m(o,"class","promptDDButton svelte-106wt5q"),we(()=>n[17].call(o)),te(o,"ddOpen",n[3]),m(t,"class","chosenBuildCont"),m(w,"class","buildDescInput"),w.disabled=k=n[12].save.status==0,m(w,"placeholder","[Empty]"),m(w,"maxlength","275"),m(w,"autocomplete","off"),m(T,"class","charCounter"),m(T,"id","buildDesc"),m(f,"class","buildDescCont"),Q.disabled=C=n[12].save.status==0,m(A,"id","lastFocusable"),A.disabled=M=n[12].save.status==0,m(W,"class","promptOptions"),m(e,"class","buildSaver")},m(de,Ie){F(de,e,Ie),p(e,t),p(t,i),p(t,s),p(t,o),Le.m(o,null),p(o,l),p(o,a),n[16](o),u=en(o,n[17].bind(o)),p(e,d),p(e,f),p(f,_),p(_,h),p(_,b),ae&&ae.m(_,null),p(f,v),p(f,w),n[19](w),Bt(w,n[10]),p(f,y),p(f,T),p(T,q),p(e,I),p(e,W),p(W,j),p(j,Q),p(Q,O),n[23](Q),p(W,N),p(W,Z),p(Z,A),p(A,P),p(e,U),se(X,e,null),Y=!0,ue||(Fe=[D(window,"mousedown",n[14]),D(o,"click",n[18]),D(o,"keydown",kt),D(w,"input",n[20]),D(w,"input",n[21]),D(w,"keydown",n[22]),D(Q,"click",n[24]),D(A,"click",n[25]),D(A,"keydown",Ct),D(e,"introstart",n[30]),D(e,"keydown",n[31])],ue=!0)},p(de,Ie){Ie[0]&2048&&me(r,r=de[11])?(Le.d(1),Le=vl(de),Le.c(),Le.m(o,l)):Le.p(de,Ie),(!Y||Ie[0]&4096&&c!==(c=de[12].save.status==0))&&(o.disabled=c),(!Y||Ie[0]&8)&&te(o,"ddOpen",de[3]),de[1]!=null&&de[1]!=de[2]?ae||(ae=yl(),ae.c(),ae.m(_,null)):ae&&(ae.d(1),ae=null),(!Y||Ie[0]&4096&&k!==(k=de[12].save.status==0))&&(w.disabled=k),Ie[0]&1024&&Bt(w,de[10]),(!Y||Ie[0]&4)&&R!==(R=275-de[2].length+"")&&Se(q,R),(!Y||Ie[0]&4096&&C!==(C=de[12].save.status==0))&&(Q.disabled=C),(!Y||Ie[0]&4096&&M!==(M=de[12].save.status==0))&&(A.disabled=M);const Qe={};!fe&&Ie[0]&1&&(fe=!0,Qe.chosenBuild=de[0],Re(()=>fe=!1)),!ce&&Ie[0]&8&&(ce=!0,Qe.ddOpen=de[3],Re(()=>ce=!1)),!ee&&Ie[0]&512&&(ee=!0,Qe.dropdown=de[9],Re(()=>ee=!1)),X.$set(Qe)},i(de){Y||(B(X.$$.fragment,de),de&&we(()=>{Y&&(z||(z=ge(e,$e,{duration:250},!0)),z.run(1))}),Y=!0)},o(de){H(X.$$.fragment,de),de&&(z||(z=ge(e,$e,{duration:250},!1)),z.run(0)),Y=!1},d(de){de&&L(e),Le.d(de),n[16](null),u(),ae&&ae.d(),n[19](null),n[23](null),oe(X),de&&z&&z.end(),ue=!1,be(Fe)}}}function mg(n,e,t){let i,s,o,r,l,a,c,u;J(n,x,z=>t(12,r=z)),J(n,bt,z=>t(32,l=z)),J(n,Tt,z=>t(33,a=z)),J(n,zt,z=>t(34,c=z)),J(n,Pt,z=>t(35,u=z));let d=!1,f,_,h,b,v,w,k=Object.entries(a)[0],y=null;function T(){G(x,r.save.status=0,r);let z=su(u,c),Y=y==null?s:y==""?"[Empty]":y,ue=k[1].id;z.name=i,z.desc=Y,ds(Vt(zn(qn),`builds/${ue}`),z).then(()=>{G(x,r.save.status=1,r);let Fe={...a};Fe[i].desc=Y,Wo(),Tt.update(()=>Fe),G(bt,l=z,l),G(bt,l.id=ue,l)}).catch(()=>{G(x,r.save.status=-1,r),G(x,r.message="firebase_fail",r)})}const R=z=>{!f.contains(z.target)&&!w.contains(z.target)&&t(3,d=!1)};function q(){h=this.offsetWidth,t(6,h)}function I(z){ie[z?"unshift":"push"](()=>{f=z,t(4,f)})}function W(){_=this.offsetWidth,t(5,_)}const j=()=>{r.save.status!=0&&t(3,d=!d)};function Q(z){ie[z?"unshift":"push"](()=>{b=z,t(7,b)})}function O(){o=this.value,t(10,o),t(1,y),t(2,s),t(0,k)}const C=z=>{t(1,y=Zi(z.target.value,275))},N=z=>{r.save.status==0&&z.preventDefault(),Zs(b,z.target.value,275)};function Z(z){ie[z?"unshift":"push"](()=>{v=z,t(8,v)})}const A=()=>{r.save.status!=0&&G(x,r.save.ongoing=!1,r)},P=()=>{r.save.status!=0&&T()};function M(z){k=z,t(0,k)}function U(z){d=z,t(3,d)}function X(z){w=z,t(9,w)}const fe=()=>t(1,y=null),ce=()=>v.focus(),ee=z=>{z.key=="Escape"&&(t(3,d=!1),f.focus())};return n.$$.update=()=>{n.$$.dirty[0]&1&&t(11,i=k[0]),n.$$.dirty[0]&1&&t(2,s=k[1].desc),n.$$.dirty[0]&6&&t(10,o=y??s)},[k,y,s,d,f,_,h,b,v,w,o,i,r,T,R,q,I,W,j,Q,O,C,N,Z,A,P,M,U,X,fe,ce,ee]}class gg extends Me{constructor(e){super(),Pe(this,e,mg,pg,me,{},null,[-1,-1])}}function bg(n){let e,t,i,s,o,r,l,a,c;return{c(){e=g("div"),t=g("span"),t.textContent="ID:",i=E(),s=g("input"),m(s,"class","buildIDInput svelte-w8elgk"),s.disabled=o=n[11].load.status==0,m(s,"type","text"),m(s,"placeholder","Example ID: -NDqeA1Scn0EAJcYWN3b"),m(s,"maxlength","25"),m(e,"class","buildIDCont svelte-w8elgk")},m(u,d){F(u,e,d),p(e,t),p(e,i),p(e,s),n[23](s),Bt(s,n[10]),l=!0,a||(c=[D(s,"input",n[24]),D(s,"input",n[25]),D(s,"keydown",n[26])],a=!0)},p(u,d){(!l||d[0]&2048&&o!==(o=u[11].load.status==0))&&(s.disabled=o),d[0]&1024&&s.value!==u[10]&&Bt(s,u[10])},i(u){l||(u&&we(()=>{l&&(r||(r=ge(e,Xe,{duration:150},!0)),r.run(1))}),l=!0)},o(u){u&&(r||(r=ge(e,Xe,{duration:150},!1)),r.run(0)),l=!1},d(u){u&&L(e),n[23](null),u&&r&&r.end(),a=!1,be(c)}}}function vg(n){let e,t,i,s,o=n[9],r,l,a,c,u,d,f,_,h=wl(n);return{c(){e=g("div"),t=g("span"),t.textContent="Load:",i=E(),s=g("button"),h.c(),r=E(),l=g("iconify-icon"),De(l,"icon","iconamoon:arrow-down-2-fill"),s.disabled=a=n[11].load.status==0,m(s,"class","promptDDButton svelte-w8elgk"),we(()=>n[21].call(s)),te(s,"ddOpen",n[8]),m(e,"class","chosenBuildCont svelte-w8elgk")},m(b,v){F(b,e,v),p(e,t),p(e,i),p(e,s),h.m(s,null),p(s,r),p(s,l),n[20](s),c=en(s,n[21].bind(s)),d=!0,f||(_=D(s,"click",n[22]),f=!0)},p(b,v){v[0]&512&&me(o,o=b[9])?(h.d(1),h=wl(b),h.c(),h.m(s,r)):h.p(b,v),(!d||v[0]&2048&&a!==(a=b[11].load.status==0))&&(s.disabled=a),(!d||v[0]&256)&&te(s,"ddOpen",b[8])},i(b){d||(b&&we(()=>{d&&(u||(u=ge(e,Xe,{duration:150},!0)),u.run(1))}),d=!0)},o(b){b&&(u||(u=ge(e,Xe,{duration:150},!1)),u.run(0)),d=!1},d(b){b&&L(e),h.d(b),n[20](null),c(),b&&u&&u.end(),f=!1,_()}}}function wl(n){let e,t=(n[6]>n[5]*.7?n[9].slice(0,20)+"<b>...</b>":n[9])+"",i;return{c(){e=g("span"),we(()=>n[19].call(e))},m(s,o){F(s,e,o),e.innerHTML=t,i=en(e,n[19].bind(e))},p(s,o){o[0]&608&&t!==(t=(s[6]>s[5]*.7?s[9].slice(0,20)+"<b>...</b>":s[9])+"")&&(e.innerHTML=t)},d(s){s&&L(e),i()}}}function kl(n){let e,t,i,s,o;function r(u){n[29](u)}function l(u){n[30](u)}function a(u){n[31](u)}let c={};return n[3]!==void 0&&(c.chosenBuild=n[3]),n[8]!==void 0&&(c.ddOpen=n[8]),n[7]!==void 0&&(c.dropdown=n[7]),e=new Uo({props:c}),ie.push(()=>Ae(e,"chosenBuild",r)),ie.push(()=>Ae(e,"ddOpen",l)),ie.push(()=>Ae(e,"dropdown",a)),{c(){le(e.$$.fragment)},m(u,d){se(e,u,d),o=!0},p(u,d){const f={};!t&&d[0]&8&&(t=!0,f.chosenBuild=u[3],Re(()=>t=!1)),!i&&d[0]&256&&(i=!0,f.ddOpen=u[8],Re(()=>i=!1)),!s&&d[0]&128&&(s=!0,f.dropdown=u[7],Re(()=>s=!1)),e.$set(f)},i(u){o||(B(e.$$.fragment,u),o=!0)},o(u){H(e.$$.fragment,u),o=!1},d(u){oe(e,u)}}}function yg(n){let e,t,i,s,o,r,l,a,c,u,d,f,_,h,b,v,w,k,y,T,R,q,I,W,j,Q,O,C,N,Z,A,P,M,U,X;const fe=[vg,bg],ce=[];function ee(Y,ue){return Y[2]?0:1}k=ee(n),y=ce[k]=fe[k](n);let z=n[2]&&kl(n);return{c(){e=g("div"),t=g("span"),t.textContent="Load build via:",i=E(),s=g("div"),o=g("div"),r=g("button"),l=ne("Local saves"),u=E(),d=g("div"),f=g("button"),_=ne("Exported ID"),v=E(),w=g("div"),y.c(),T=E(),R=g("div"),q=g("div"),I=g("button"),W=ne("CANCEL"),Q=E(),O=g("div"),C=g("button"),N=ne("LOAD"),A=E(),z&&z.c(),m(t,"class","svelte-w8elgk"),m(r,"id",a=n[2]?"firstFocusable":""),r.disabled=c=n[11].load.status==0||!n[12],m(r,"class","svelte-w8elgk"),te(r,"chosen",n[2]),te(r,"unavailable",!n[12]),m(o,"class","svelte-w8elgk"),m(f,"id",h=n[2]?"":"firstFocusable"),f.disabled=b=n[11].load.status==0,m(f,"class","svelte-w8elgk"),te(f,"chosen",!n[2]),m(d,"class","svelte-w8elgk"),m(s,"class","loadMethodRadio svelte-w8elgk"),m(w,"class","loadMethodCont svelte-w8elgk"),I.disabled=j=n[11].load.status==0,m(C,"id","lastFocusable"),C.disabled=Z=n[11].load.status==0,m(R,"class","promptOptions svelte-w8elgk"),m(e,"class","buildLoader svelte-w8elgk")},m(Y,ue){F(Y,e,ue),p(e,t),p(e,i),p(e,s),p(s,o),p(o,r),p(r,l),p(s,u),p(s,d),p(d,f),p(f,_),p(e,v),p(e,w),ce[k].m(w,null),p(e,T),p(e,R),p(R,q),p(q,I),p(I,W),n[27](I),p(R,Q),p(R,O),p(O,C),p(C,N),p(e,A),z&&z.m(e,null),M=!0,U||(X=[D(window,"mousedown",n[14]),D(r,"click",n[15]),D(r,"keydown",n[16]),D(f,"click",n[17]),D(f,"keydown",n[18]),D(I,"click",n[28]),D(C,"keydown",Ct),D(C,"click",n[13]),D(e,"introstart",n[32]),D(e,"keydown",n[33])],U=!0)},p(Y,ue){(!M||ue[0]&4&&a!==(a=Y[2]?"firstFocusable":""))&&m(r,"id",a),(!M||ue[0]&6144&&c!==(c=Y[11].load.status==0||!Y[12]))&&(r.disabled=c),(!M||ue[0]&4)&&te(r,"chosen",Y[2]),(!M||ue[0]&4096)&&te(r,"unavailable",!Y[12]),(!M||ue[0]&4&&h!==(h=Y[2]?"":"firstFocusable"))&&m(f,"id",h),(!M||ue[0]&2048&&b!==(b=Y[11].load.status==0))&&(f.disabled=b),(!M||ue[0]&4)&&te(f,"chosen",!Y[2]);let Fe=k;k=ee(Y),k===Fe?ce[k].p(Y,ue):(ze(),H(ce[Fe],1,1,()=>{ce[Fe]=null}),je(),y=ce[k],y?y.p(Y,ue):(y=ce[k]=fe[k](Y),y.c()),B(y,1),y.m(w,null)),(!M||ue[0]&2048&&j!==(j=Y[11].load.status==0))&&(I.disabled=j),(!M||ue[0]&2048&&Z!==(Z=Y[11].load.status==0))&&(C.disabled=Z),Y[2]?z?(z.p(Y,ue),ue[0]&4&&B(z,1)):(z=kl(Y),z.c(),B(z,1),z.m(e,null)):z&&(ze(),H(z,1,1,()=>{z=null}),je())},i(Y){M||(B(y),B(z),Y&&we(()=>{M&&(P||(P=ge(e,$e,{duration:250},!0)),P.run(1))}),M=!0)},o(Y){H(y),H(z),Y&&(P||(P=ge(e,$e,{duration:250},!1)),P.run(0)),M=!1},d(Y){Y&&L(e),ce[k].d(),n[27](null),z&&z.d(),Y&&P&&P.end(),U=!1,be(X)}}}function wg(n,e,t){let i,s,o;J(n,x,z=>t(11,i=z)),J(n,Tt,z=>t(34,s=z)),J(n,Qt,z=>t(12,o=z));const r=qt();let l,a,c,u,d,f,_=o,h=!1,b=o?Object.entries(s)[0]:null,v,w="";function k(){if(!_&&!w.startsWith("-N")){G(x,i.load.status=-1,i),G(x,i.message="invalid_id",i);return}let z=Jc(zn(qn,"builds"),Xc()),Y=0;G(x,i.load.status=0,i),Qc(z).then(ue=>{let Fe=_?b[1].id:w;for(let Le in ue.val()){if(Le==Fe){r("buildLoad",{build:ue.val()[Le],id:Le});break}else Y==Object.keys(ue.val()).length-1&&(G(x,i.load.status=-1,i),G(x,i.message=_?"not_found":"invalid_id",i));Y++}}).catch(()=>{G(x,i.load.status=-1,i),G(x,i.message="firebase_fail",i)})}const y=z=>{l&&!l.contains(z.target)&&!f.contains(z.target)&&t(8,h=!1)},T=()=>{i.load.status!=0&&o&&t(2,_=!0)},R=z=>{_&&kt(z)},q=()=>{i.load.status!=0&&t(2,_=!1)},I=z=>{_||kt(z)};function W(){d=this.offsetWidth,t(6,d)}function j(z){ie[z?"unshift":"push"](()=>{l=z,t(0,l)})}function Q(){u=this.offsetWidth,t(5,u)}const O=()=>{i.load.status!=0&&t(8,h=!h)};function C(z){ie[z?"unshift":"push"](()=>{c=z,t(1,c)})}function N(){w=this.value,t(10,w)}const Z=z=>{t(10,w=Zi(z.target.value,25))},A=z=>{i.load.status==0&&z.preventDefault()};function P(z){ie[z?"unshift":"push"](()=>{a=z,t(4,a)})}const M=()=>{i.load.status!=0&&G(x,i.load.ongoing=!1,i)};function U(z){b=z,t(3,b)}function X(z){h=z,t(8,h)}function fe(z){f=z,t(7,f)}const ce=()=>a.focus(),ee=z=>{z.key=="Escape"&&(t(8,h=!1),l.focus())};return n.$$.update=()=>{n.$$.dirty[0]&8&&t(9,v=b!=null?b[0]:null),n.$$.dirty[0]&7&&setTimeout(_?()=>l.focus():()=>c.focus())},[l,c,_,b,a,u,d,f,h,v,w,i,o,k,y,T,R,q,I,W,j,Q,O,C,N,Z,A,P,M,U,X,fe,ce,ee]}class kg extends Me{constructor(e){super(),Pe(this,e,wg,yg,me,{},null,[-1,-1])}}function Cl(n){let e,t=(n[3]>n[4]*.8?n[8].slice(0,20)+"<b>...</b>":n[8])+"",i;return{c(){e=g("span"),we(()=>n[12].call(e))},m(s,o){F(s,e,o),e.innerHTML=t,i=en(e,n[12].bind(e))},p(s,o){o&280&&t!==(t=(s[3]>s[4]*.8?s[8].slice(0,20)+"<b>...</b>":s[8])+"")&&(e.innerHTML=t)},d(s){s&&L(e),i()}}}function Cg(n){let e,t,i,s,o,r=n[8],l,a,c,u,d,f,_,h,b,v,w,k,y,T,R,q,I,W,j,Q,O,C,N,Z,A,P,M,U,X=Cl(n);f=new ft({props:{text:"I'm aware that this action is irreversible and want to erase this build from the database."}}),f.$on("toggle",n[16]);function fe(Y){n[21](Y)}function ce(Y){n[22](Y)}function ee(Y){n[23](Y)}let z={};return n[0]!==void 0&&(z.chosenBuild=n[0]),n[6]!==void 0&&(z.ddOpen=n[6]),n[5]!==void 0&&(z.dropdown=n[5]),O=new Uo({props:z}),ie.push(()=>Ae(O,"chosenBuild",fe)),ie.push(()=>Ae(O,"ddOpen",ce)),ie.push(()=>Ae(O,"dropdown",ee)),{c(){e=g("div"),t=g("div"),i=g("span"),i.textContent="Delete:",s=E(),o=g("button"),X.c(),l=E(),a=g("iconify-icon"),d=E(),le(f.$$.fragment),_=E(),h=g("div"),b=g("div"),v=g("button"),w=ne("CANCEL"),T=E(),R=g("div"),q=g("button"),I=ne("DELETE"),Q=E(),le(O.$$.fragment),De(a,"icon","iconamoon:arrow-down-2-fill"),m(o,"class","promptDDButton svelte-1t9ajmz"),m(o,"id","firstFocusable"),o.disabled=c=n[9].delete.status==0,we(()=>n[14].call(o)),te(o,"ddOpen",n[6]),m(t,"class","chosenBuildCont"),m(v,"id",k=n[7]?"":"lastFocusable"),v.disabled=y=n[9].delete.status==0,q.disabled=W=!n[7]||n[9].delete.status==0,m(q,"id",j=n[7]?"lastFocusable":""),te(q,"unavailable",!n[7]),m(h,"class","promptOptions svelte-1t9ajmz"),m(e,"class","buildDeleter svelte-1t9ajmz")},m(Y,ue){F(Y,e,ue),p(e,t),p(t,i),p(t,s),p(t,o),X.m(o,null),p(o,l),p(o,a),n[13](o),u=en(o,n[14].bind(o)),p(e,d),se(f,e,null),p(e,_),p(e,h),p(h,b),p(b,v),p(v,w),n[17](v),p(h,T),p(h,R),p(R,q),p(q,I),p(e,Q),se(O,e,null),P=!0,M||(U=[D(window,"mousedown",n[11]),D(o,"click",n[15]),D(o,"keydown",kt),D(v,"click",n[18]),D(v,"keydown",n[19]),D(q,"click",n[20]),D(q,"keydown",Ct),D(e,"introstart",n[24]),D(e,"keydown",n[25])],M=!0)},p(Y,[ue]){ue&256&&me(r,r=Y[8])?(X.d(1),X=Cl(Y),X.c(),X.m(o,l)):X.p(Y,ue),(!P||ue&512&&c!==(c=Y[9].delete.status==0))&&(o.disabled=c),(!P||ue&64)&&te(o,"ddOpen",Y[6]),(!P||ue&128&&k!==(k=Y[7]?"":"lastFocusable"))&&m(v,"id",k),(!P||ue&512&&y!==(y=Y[9].delete.status==0))&&(v.disabled=y),(!P||ue&640&&W!==(W=!Y[7]||Y[9].delete.status==0))&&(q.disabled=W),(!P||ue&128&&j!==(j=Y[7]?"lastFocusable":""))&&m(q,"id",j),(!P||ue&128)&&te(q,"unavailable",!Y[7]);const Fe={};!C&&ue&1&&(C=!0,Fe.chosenBuild=Y[0],Re(()=>C=!1)),!N&&ue&64&&(N=!0,Fe.ddOpen=Y[6],Re(()=>N=!1)),!Z&&ue&32&&(Z=!0,Fe.dropdown=Y[5],Re(()=>Z=!1)),O.$set(Fe)},i(Y){P||(B(f.$$.fragment,Y),B(O.$$.fragment,Y),Y&&we(()=>{P&&(A||(A=ge(e,$e,{duration:250},!0)),A.run(1))}),P=!0)},o(Y){H(f.$$.fragment,Y),H(O.$$.fragment,Y),Y&&(A||(A=ge(e,$e,{duration:250},!1)),A.run(0)),P=!1},d(Y){Y&&L(e),X.d(Y),n[13](null),u(),oe(f),n[17](null),oe(O),Y&&A&&A.end(),M=!1,be(U)}}}function Eg(n,e,t){let i,s,o,r;J(n,x,A=>t(9,s=A)),J(n,Tt,A=>t(26,o=A)),J(n,bt,A=>t(27,r=A));let l,a,c,u,d,f=!1,_=Object.entries(o)[0],h=!1;function b(){G(x,s.delete.status=0,s);let A=_[1].id;up(Vt(zn(qn),`builds/${A}`)).then(()=>{G(x,s.delete.status=1,s),r&&A==r.id&&G(bt,r=null,r);let P={...o};delete P[i],Wo(),Tt.update(()=>P)}).catch(P=>{G(x,s.delete.status=-1,s),G(x,s.message="firebase_fail",s)})}const v=A=>{!a.contains(A.target)&&!d.contains(A.target)&&t(6,f=!1)};function w(){c=this.offsetWidth,t(3,c)}function k(A){ie[A?"unshift":"push"](()=>{a=A,t(2,a)})}function y(){u=this.offsetWidth,t(4,u)}const T=()=>{s.delete.status!=0&&t(6,f=!f)},R=A=>t(7,h=A.detail);function q(A){ie[A?"unshift":"push"](()=>{l=A,t(1,l)})}const I=()=>{s.delete.status!=0&&G(x,s.delete.ongoing=!1,s)},W=A=>{h||Ct(A)},j=()=>{h&&s.delete.status!=0&&b()};function Q(A){_=A,t(0,_)}function O(A){f=A,t(6,f)}function C(A){d=A,t(5,d)}const N=()=>l.focus(),Z=A=>{A.key=="Escape"&&(t(6,f=!1),a.focus())};return n.$$.update=()=>{n.$$.dirty&1&&t(8,i=_[0])},[_,l,a,c,u,d,f,h,i,s,b,v,w,k,y,T,R,q,I,W,j,Q,O,C,N,Z]}class Sg extends Me{constructor(e){super(),Pe(this,e,Eg,Cg,me,{})}}function Ig(n){let e,t,i,s,o,r,l,a,c,u,d,f,_,h;return{c(){e=g("div"),t=g("div"),i=g("button"),i.innerHTML='<iconify-icon icon="tabler:coins" class="svelte-czj12i"></iconify-icon> <span class="tooltip" id="right">Build costs</span>',s=E(),o=g("div"),r=g("button"),r.innerHTML='<iconify-icon icon="codicon:sparkle-filled" class="svelte-czj12i"></iconify-icon> <span class="tooltip" id="right">Add bonuses</span>',l=E(),a=g("div"),c=g("button"),c.innerHTML='<iconify-icon icon="fa-solid:random" class="svelte-czj12i"></iconify-icon> <span class="tooltip" id="right">Randomize build</span>',u=E(),d=g("div"),f=g("button"),f.innerHTML='<iconify-icon icon="fe:picture" class="svelte-czj12i"></iconify-icon> <span class="tooltip" id="right">Screenshot mode</span>',m(i,"class","svelte-czj12i"),m(t,"class","svelte-czj12i"),m(r,"class","svelte-czj12i"),m(o,"class","svelte-czj12i"),m(c,"class","svelte-czj12i"),m(a,"id","randomize"),m(a,"class","svelte-czj12i"),m(f,"class","svelte-czj12i"),m(d,"id","screenshot"),m(d,"class","svelte-czj12i"),m(e,"class","sideFeatures svelte-czj12i")},m(b,v){F(b,e,v),p(e,t),p(t,i),p(e,s),p(e,o),p(o,r),p(e,l),p(e,a),p(a,c),p(e,u),p(e,d),p(d,f),_||(h=[D(i,"click",n[2]),D(r,"click",n[3]),D(c,"click",n[4]),D(f,"click",n[5])],_=!0)},p:re,i:re,o:re,d(b){b&&L(e),_=!1,be(h)}}}function Tg(n,e,t){let i,s;return J(n,pn,c=>t(0,i=c)),J(n,x,c=>t(1,s=c)),[i,s,c=>{_n(c),i||G(x,s.costs.ongoing=!0,s)},c=>{_n(c),i||G(x,s.bonus.ongoing=!0,s)},c=>{_n(c),i||G(x,s.randomize.ongoing=!0,s)},()=>{i||(G(x,s.screenshot.ongoing=!0,s),setTimeout(()=>G(x,s.screenshot.ongoing=!1,s),3500))}]}class Ng extends Me{constructor(e){super(),Pe(this,e,Tg,Ig,me,{})}}function El(n,e,t){const i=n.slice();i[11]=e[t];const s=i[1].bonuses[0].name==i[11].name;return i[12]=s,i}function Sl(n){let e,t,i,s,o,r,l,a,c,u,d,f;function _(...b){return n[5](n[12],...b)}function h(...b){return n[6](n[11],...b)}return a=new ft({props:{text:n[11].name,checked:n[2][n[11].name]}}),a.$on("toggle",h),{c(){e=g("div"),t=g("a"),i=g("img"),l=E(),le(a.$$.fragment),c=E(),Ze(i.src,s=n[11].image)||m(i,"src",s),m(i,"alt",""),m(i,"class","svelte-1xnyxhr"),m(t,"id",o=n[12]?"firstFocusable":""),m(t,"href",r=n[11].link),m(t,"target","_blank"),m(t,"class","svelte-1xnyxhr"),m(e,"class","svelte-1xnyxhr")},m(b,v){F(b,e,v),p(e,t),p(t,i),p(e,l),se(a,e,null),p(e,c),u=!0,d||(f=D(t,"keydown",_),d=!0)},p(b,v){n=b,(!u||v&2&&!Ze(i.src,s=n[11].image))&&m(i,"src",s),(!u||v&2&&o!==(o=n[12]?"firstFocusable":""))&&m(t,"id",o),(!u||v&2&&r!==(r=n[11].link))&&m(t,"href",r);const w={};v&2&&(w.text=n[11].name),v&6&&(w.checked=n[2][n[11].name]),a.$set(w)},i(b){u||(B(a.$$.fragment,b),u=!0)},o(b){H(a.$$.fragment,b),u=!1},d(b){b&&L(e),oe(a),d=!1,f()}}}function Og(n){let e,t,i,s,o,r,l,a,c,u,d,f,_,h=Ne(n[1].bonuses),b=[];for(let w=0;w<h.length;w+=1)b[w]=Sl(El(n,h,w));const v=w=>H(b[w],1,1,()=>{b[w]=null});return{c(){e=g("div"),t=g("div");for(let w=0;w<b.length;w+=1)b[w].c();i=E(),s=g("div"),o=g("div"),r=g("button"),r.textContent="CLEAR",l=E(),a=g("div"),c=g("button"),c.textContent="OK",m(t,"class","bonusesCont svelte-1xnyxhr"),m(c,"id","lastFocusable"),m(s,"class","promptOptions svelte-1xnyxhr"),m(e,"class","bonusChooser svelte-1xnyxhr")},m(w,k){F(w,e,k),p(e,t);for(let y=0;y<b.length;y+=1)b[y]&&b[y].m(t,null);p(e,i),p(e,s),p(s,o),p(o,r),p(s,l),p(s,a),p(a,c),n[8](c),d=!0,f||(_=[D(r,"click",n[7]),D(c,"click",n[9]),D(c,"keydown",Ct),D(e,"introstart",n[10])],f=!0)},p(w,[k]){if(k&14){h=Ne(w[1].bonuses);let y;for(y=0;y<h.length;y+=1){const T=El(w,h,y);b[y]?(b[y].p(T,k),B(b[y],1)):(b[y]=Sl(T),b[y].c(),B(b[y],1),b[y].m(t,null))}for(ze(),y=h.length;y<b.length;y+=1)v(y);je()}},i(w){if(!d){for(let k=0;k<h.length;k+=1)B(b[k]);w&&we(()=>{d&&(u||(u=ge(e,$e,{duration:250},!0)),u.run(1))}),d=!0}},o(w){b=b.filter(Boolean);for(let k=0;k<b.length;k+=1)H(b[k]);w&&(u||(u=ge(e,$e,{duration:250},!1)),u.run(0)),d=!1},d(w){w&&L(e),at(b,w),n[8](null),w&&u&&u.end(),f=!1,be(_)}}}function Dg(n,e,t){let i,s,o,r;J(n,At,h=>t(1,i=h)),J(n,On,h=>t(2,s=h)),J(n,pt,h=>t(3,o=h)),J(n,x,h=>t(4,r=h));let l;const a=(h,b)=>{h&&kt(b)},c=(h,b)=>{G(On,s[h.name]=b.detail,s);for(let v in o)b.detail?G(pt,o[v]+=h.stats[v],o):G(pt,o[v]-=h.stats[v],o),G(pt,o[v]=Math.round(o[v]*10)/10,o)},u=()=>{for(let h in s){if(!s[h])continue;let b=i.bonuses.find(v=>v.name==h);G(On,s[h]=!1,s);for(let v in o)G(pt,o[v]-=b.stats[v],o),G(pt,o[v]=Math.round(o[v]*10)/10,o)}};function d(h){ie[h?"unshift":"push"](()=>{l=h,t(0,l)})}return[l,i,s,o,r,a,c,u,d,()=>G(x,r.bonus.ongoing=!1,r),()=>l.focus()]}class Rg extends Me{constructor(e){super(),Pe(this,e,Dg,Og,me,{})}}function Ag(n){let e;return{c(){e=g("span"),e.textContent=`Includes equipment such as ore-based armor and their variants,\r
            ore-based weapons, and shoes with no special stats`,m(e,"slot","tooltip"),m(e,"class","tooltip svelte-19uqsbs"),m(e,"id","right")},m(t,i){F(t,e,i)},p:re,d(t){t&&L(e)}}}function Pg(n){let e,t,i,s,o,r,l,a,c,u,d,f,_,h,b,v,w,k,y,T,R,q,I,W,j,Q;return s=new ft({props:{text:"Force Mushroom Parasol",checked:n[0].parasol,first:!0}}),s.$on("toggle",n[5]),r=new ft({props:{text:"Randomize armor",checked:n[0].armor}}),r.$on("toggle",n[6]),a=new ft({props:{text:"Randomize gear",checked:n[0].gear}}),a.$on("toggle",n[7]),u=new ft({props:{text:"Allow 'basic' equipment",checked:n[0].basic,$$slots:{tooltip:[Ag]},$$scope:{ctx:n}}}),u.$on("toggle",n[8]),{c(){e=g("div"),t=g("span"),t.textContent="Randomize your build",i=E(),le(s.$$.fragment),o=E(),le(r.$$.fragment),l=E(),le(a.$$.fragment),c=E(),le(u.$$.fragment),d=E(),f=g("div"),_=g("div"),h=g("button"),b=ne("CANCEL"),w=E(),k=g("div"),y=g("button"),T=ne("ROLL THE DICE"),m(t,"class","svelte-19uqsbs"),m(h,"id",v=n[2]?"":"lastFocusable"),m(y,"id",R=n[2]?"lastFocusable":""),y.disabled=q=!n[2],m(f,"class","promptOptions"),m(e,"class","buildRandomizer svelte-19uqsbs")},m(O,C){F(O,e,C),p(e,t),p(e,i),se(s,e,null),p(e,o),se(r,e,null),p(e,l),se(a,e,null),p(e,c),se(u,e,null),p(e,d),p(e,f),p(f,_),p(_,h),p(h,b),n[9](h),p(f,w),p(f,k),p(k,y),p(y,T),W=!0,j||(Q=[D(h,"click",n[10]),D(h,"keydown",n[11]),D(y,"click",n[12]),D(y,"keydown",n[13]),D(e,"introstart",n[14])],j=!0)},p(O,[C]){const N={};C&1&&(N.checked=O[0].parasol),s.$set(N);const Z={};C&1&&(Z.checked=O[0].armor),r.$set(Z);const A={};C&1&&(A.checked=O[0].gear),a.$set(A);const P={};C&1&&(P.checked=O[0].basic),C&16777216&&(P.$$scope={dirty:C,ctx:O}),u.$set(P),(!W||C&4&&v!==(v=O[2]?"":"lastFocusable"))&&m(h,"id",v),(!W||C&4&&R!==(R=O[2]?"lastFocusable":""))&&m(y,"id",R),(!W||C&4&&q!==(q=!O[2]))&&(y.disabled=q)},i(O){W||(B(s.$$.fragment,O),B(r.$$.fragment,O),B(a.$$.fragment,O),B(u.$$.fragment,O),O&&we(()=>{W&&(I||(I=ge(e,$e,{duration:250},!0)),I.run(1))}),W=!0)},o(O){H(s.$$.fragment,O),H(r.$$.fragment,O),H(a.$$.fragment,O),H(u.$$.fragment,O),O&&(I||(I=ge(e,$e,{duration:250},!1)),I.run(0)),W=!1},d(O){O&&L(e),oe(s),oe(r),oe(a),oe(u),n[9](null),O&&I&&I.end(),j=!1,be(Q)}}}function Mg(n,e,t){let i,s,o,r,l,a,c,u;J(n,Qn,O=>t(0,s=O)),J(n,x,O=>t(3,o=O)),J(n,At,O=>t(15,r=O)),J(n,Mn,O=>t(16,l=O)),J(n,zt,O=>t(17,a=O)),J(n,Pn,O=>t(18,c=O)),J(n,Pt,O=>t(19,u=O));let d,f=["Bronze","Iron","Cobalt","Titanium","Gold","Onyx"],_=["Hardened","Royal"],h=["Black","Brown","Green","Red","White","Dark","Golden","Grey","Phantom"];function b(){if(s.armor){for(let O of jn){let C=u[O]||ps;C.name&&c[O][C.name].querySelector("button").click()}setTimeout(()=>{for(let O of jn)(function C(){let N=Math.floor(Math.random()*r[O].length);!c[O][r[O][N].name].classList.contains("selectedItem")&&(s.basic||!s.basic&&!v(r[O][N].name))?c[O][r[O][N].name].querySelector("button").click():C()})()})}if(s.gear){for(let O in a){let C=a[O]||ms;C.name&&l[O][C.name].querySelector("button").click()}setTimeout(()=>{let O=!1,C=yn.length,N=yn.length,Z=[];for(let A in a)Z.push(a[A].name);(function A(){setTimeout(()=>{let P=Math.floor(Math.random()*C);(function M(){let U=Math.floor(Math.random()*r.gear.length);!Z.includes(r.gear[U].name)&&!l[N][r.gear[U].name].classList.contains("switchable")&&(!O||O&&U!=0)&&(s.basic||!s.basic&&!v(r.gear[U].name))?(l[N][r.gear[!O&&s.parasol&&!P?0:U].name].querySelector("button").click(),!O&&!P?O=!0:O||C--):M()})(),--N&&A()},25)})()},50)}G(x,o.randomize.ongoing=!1,o)}function v(O){let C=!1,N=O.split(" ");return C=f.includes(N[0])||_.includes(N[0])||O=="Mining Helmet"||h.includes(N[0]),C}const w=O=>G(Qn,s.parasol=O.detail,s),k=O=>G(Qn,s.armor=O.detail,s),y=O=>G(Qn,s.gear=O.detail,s),T=O=>G(Qn,s.basic=O.detail,s);function R(O){ie[O?"unshift":"push"](()=>{d=O,t(1,d)})}const q=()=>G(x,o.randomize.ongoing=!1,o),I=O=>{i||Ct(O)},W=()=>{i&&b()},j=O=>{i&&Ct(O)},Q=()=>d.focus();return n.$$.update=()=>{n.$$.dirty&1&&t(2,i=s.armor||s.gear)},[s,d,i,o,b,w,k,y,T,R,q,I,W,j,Q]}class Lg extends Me{constructor(e){super(),Pe(this,e,Mg,Pg,me,{})}}function Il(n,e,t){const i=n.slice();return i[5]=e[t],i}function Bg(n){let e,t=Ne(n[1]),i=[];for(let s=0;s<t.length;s+=1)i[s]=Tl(Il(n,t,s));return{c(){for(let s=0;s<i.length;s+=1)i[s].c();e=ut()},m(s,o){for(let r=0;r<i.length;r+=1)i[r]&&i[r].m(s,o);F(s,e,o)},p(s,o){if(o&2){t=Ne(s[1]);let r;for(r=0;r<t.length;r+=1){const l=Il(s,t,r);i[r]?i[r].p(l,o):(i[r]=Tl(l),i[r].c(),i[r].m(e.parentNode,e))}for(;r<i.length;r+=1)i[r].d(1);i.length=t.length}},d(s){s&&L(e),at(i,s)}}}function Fg(n){let e,t,i;return{c(){e=g("span"),t=ne("— "),i=ne(n[1]),m(e,"id","info"),m(e,"class","svelte-ipufpe")},m(s,o){F(s,e,o),p(e,t),p(e,i)},p(s,o){o&2&&Se(i,s[1])},d(s){s&&L(e)}}}function Tl(n){let e,t,i=n[5]+"",s;return{c(){e=g("span"),t=ne("— "),s=ne(i),m(e,"id","info"),m(e,"class","svelte-ipufpe")},m(o,r){F(o,e,r),p(e,t),p(e,s)},p(o,r){r&2&&i!==(i=o[5]+"")&&Se(s,i)},d(o){o&&L(e)}}}function zg(n){let e,t,i,s,o,r,l;function a(d,f){return typeof d[1]=="string"?Fg:Bg}let c=a(n),u=c(n);return{c(){e=g("li"),t=g("span"),i=ne("v"),s=ne(n[0]),o=E(),r=g("i"),r.textContent=`${n[3][n[2][1]-1]+" "+n[2][0]+(Math.floor(n[2][0]/10)===1?"th":tu[n[2][0]%10])+", 20"+n[2][2]}`,l=E(),u.c(),m(t,"id","version"),m(t,"class","svelte-ipufpe"),m(r,"id","date"),m(r,"class","svelte-ipufpe"),m(e,"class","svelte-ipufpe")},m(d,f){F(d,e,f),p(e,t),p(t,i),p(t,s),p(e,o),p(e,r),p(e,l),u.m(e,null)},p(d,[f]){f&1&&Se(s,d[0]),c===(c=a(d))&&u?u.p(d,f):(u.d(1),u=c(d),u&&(u.c(),u.m(e,null)))},i:re,o:re,d(d){d&&L(e),u.d()}}}function jg(n,e,t){let{version:i,date:s,text:o}=e,r=s.split("/"),l=["January","February","March","April","May","June","July","August","Semptember","October","November","December"];return n.$$set=a=>{"version"in a&&t(0,i=a.version),"date"in a&&t(4,s=a.date),"text"in a&&t(1,o=a.text)},[i,o,r,l,s]}class ct extends Me{constructor(e){super(),Pe(this,e,jg,zg,me,{version:0,date:4,text:1})}}function qg(n){let e,t,i,s,o,r,l,a,c,u,d,f,_,h,b,v,w,k,y,T,R,q,I,W,j,Q,O,C,N,Z,A,P,M,U,X,fe,ce,ee,z,Y,ue,Fe,Le;return o=new ct({props:{version:"3.26.4",date:"21/3/24",text:["Added feature to copy stats as text","Fixed detailed view prompt activating while scrolling"]}}),l=new ct({props:{version:"3.26.3",date:"24/2/24",text:"Reimplemented 'Strict' filter type in search options"}}),c=new ct({props:{version:"3.26.2",date:"22/2/24",text:"Fixed build randomizer not working properly"}}),d=new ct({props:{version:"3.26.1",date:"22/2/24",text:"Holding Shift and interacting with a dropdown item or simply holding down on it activates detailed view prompt"}}),_=new ct({props:{version:"3.26.0",date:"21/2/24",text:"Added detailed view prompt to armor and gear whenever the selected item's icon is clicked"}}),b=new ct({props:{version:"3.25.9",date:"14/1/24",text:"Added build costs visibility while 'screenshot mode' is active"}}),w=new ct({props:{version:"3.25.8",date:"11/1/24",text:"Fixed mutually exclusive gear staying disabled when deselecting the selected item"}}),y=new ct({props:{version:"3.25.7",date:"9/1/24",text:["Enabled 'unsaved changes' prompt to appear before leaving site when certain conditions are met","Fixed dropdowns blocking interactions behind them for a short period after being closed","Fixed dropdown sort incorrectly defaulting to the last sorted list in some cases"]}}),R=new ct({props:{version:"3.25.6",date:"7/1/24",text:"Fixed armor filter not working properly when 'Exclusive' filter type and 'No Stats' option were selected"}}),I=new ct({props:{version:"3.25.5",date:"6/1/24",text:["Fixed issue with switching gear slots while full weapon view was on","Tools are now selectable even if full weapon view is on"]}}),j=new ct({props:{version:"3.25.4",date:"5/1/24",text:'Fixed crash caused by using the build randomizer while "Force Mushroom Parasol" option was on'}}),O=new ct({props:{version:"3.25.3",date:"5/1/24",text:["Added feature to swap gear slots when clicking on an already selected gear item","Added visual cues to both deselecting and swapping options for dropdown items"]}}),N=new ct({props:{version:"3.25.2",date:"3/1/24",text:["Replaced 'Strict' filter type with 'Exclusive' filter type in search options of dropdowns","Added icons to resource links and credits"]}}),A=new ct({props:{version:"3.25.1",date:"2/1/24",text:`"Allow 'basic' equipment" option is no longer restricted when "Randomize gear" option isn't selected in the build randomizer`}}),M=new ct({props:{version:"3.25.0",date:"2/1/24",text:["Added 'Build Costs' feature","Removed spectacles from 'basic' equipment pool in the build randomizer"]}}),X=new ct({props:{version:"3.24.5",date:"31/12/23",text:"v3 Release"}}),{c(){e=g("div"),t=g("span"),t.textContent="Changelog",i=E(),s=g("ul"),le(o.$$.fragment),r=E(),le(l.$$.fragment),a=E(),le(c.$$.fragment),u=E(),le(d.$$.fragment),f=E(),le(_.$$.fragment),h=E(),le(b.$$.fragment),v=E(),le(w.$$.fragment),k=E(),le(y.$$.fragment),T=E(),le(R.$$.fragment),q=E(),le(I.$$.fragment),W=E(),le(j.$$.fragment),Q=E(),le(O.$$.fragment),C=E(),le(N.$$.fragment),Z=E(),le(A.$$.fragment),P=E(),le(M.$$.fragment),U=E(),le(X.$$.fragment),fe=E(),ce=g("div"),ee=g("div"),z=g("button"),z.textContent="OK",m(t,"id","title"),m(s,"id","contents"),m(s,"class","svelte-1k91i9r"),m(z,"id","firstFocusable lastFocusable"),m(ce,"class","promptOptions svelte-1k91i9r"),m(e,"class","infoPrompt svelte-1k91i9r")},m(ae,gt){F(ae,e,gt),p(e,t),p(e,i),p(e,s),se(o,s,null),p(s,r),se(l,s,null),p(s,a),se(c,s,null),p(s,u),se(d,s,null),p(s,f),se(_,s,null),p(s,h),se(b,s,null),p(s,v),se(w,s,null),p(s,k),se(y,s,null),p(s,T),se(R,s,null),p(s,q),se(I,s,null),p(s,W),se(j,s,null),p(s,Q),se(O,s,null),p(s,C),se(N,s,null),p(s,Z),se(A,s,null),p(s,P),se(M,s,null),p(s,U),se(X,s,null),p(e,fe),p(e,ce),p(ce,ee),p(ee,z),n[2](z),ue=!0,Fe||(Le=[D(z,"click",n[3]),D(z,"keydown",n[4]),D(e,"introstart",n[5])],Fe=!0)},p:re,i(ae){ue||(B(o.$$.fragment,ae),B(l.$$.fragment,ae),B(c.$$.fragment,ae),B(d.$$.fragment,ae),B(_.$$.fragment,ae),B(b.$$.fragment,ae),B(w.$$.fragment,ae),B(y.$$.fragment,ae),B(R.$$.fragment,ae),B(I.$$.fragment,ae),B(j.$$.fragment,ae),B(O.$$.fragment,ae),B(N.$$.fragment,ae),B(A.$$.fragment,ae),B(M.$$.fragment,ae),B(X.$$.fragment,ae),ae&&we(()=>{ue&&(Y||(Y=ge(e,$e,{duration:250},!0)),Y.run(1))}),ue=!0)},o(ae){H(o.$$.fragment,ae),H(l.$$.fragment,ae),H(c.$$.fragment,ae),H(d.$$.fragment,ae),H(_.$$.fragment,ae),H(b.$$.fragment,ae),H(w.$$.fragment,ae),H(y.$$.fragment,ae),H(R.$$.fragment,ae),H(I.$$.fragment,ae),H(j.$$.fragment,ae),H(O.$$.fragment,ae),H(N.$$.fragment,ae),H(A.$$.fragment,ae),H(M.$$.fragment,ae),H(X.$$.fragment,ae),ae&&(Y||(Y=ge(e,$e,{duration:250},!1)),Y.run(0)),ue=!1},d(ae){ae&&L(e),oe(o),oe(l),oe(c),oe(d),oe(_),oe(b),oe(w),oe(y),oe(R),oe(I),oe(j),oe(O),oe(N),oe(A),oe(M),oe(X),n[2](null),ae&&Y&&Y.end(),Fe=!1,be(Le)}}}function Wg(n,e,t){let i;J(n,x,c=>t(1,i=c));let s;function o(c){ie[c?"unshift":"push"](()=>{s=c,t(0,s)})}return[s,i,o,()=>G(x,i.changelog.ongoing=!1,i),c=>{kt(c),Ct(c)},()=>s.focus()]}class Hg extends Me{constructor(e){super(),Pe(this,e,Wg,qg,me,{})}}function Ug(n){let e,t,i,s,o,r,l,a,c,u,d,f,_,h,b,v,w,k,y,T,R,q;return{c(){e=g("div"),t=g("span"),t.textContent="Resources",i=E(),s=g("ul"),o=g("li"),r=g("iconify-icon"),l=E(),a=g("a"),a.textContent="Fantastic Frontier Wiki",c=E(),u=g("li"),u.innerHTML='<iconify-icon icon="ic:baseline-discord" class="svelte-18cf37p"></iconify-icon> <a href="https://discord.gg/ff" target="_blank" class="svelte-18cf37p">Fantastic Frontier Discord Server</a>',d=E(),f=g("li"),f.innerHTML='<iconify-icon icon="simple-icons:googledocs" class="svelte-18cf37p"></iconify-icon> <a href="https://docs.google.com/document/d/1H9HXoExCDVfXx15LQ4Te-2tTjrLFB-XCbMmx44Ynld4/edit" target="_blank" class="svelte-18cf37p">Fantastic Frontier Build List</a>',_=E(),h=g("li"),h.innerHTML='<iconify-icon icon="simple-icons:googledocs" class="svelte-18cf37p"></iconify-icon> <a href="https://docs.google.com/document/d/15vwSRojTqZ8LI09Wq4dvGF1kSTPmH2_gECQvwlSFki8/edit" target="_blank" class="svelte-18cf37p">Fantastic Frontier Max Stat List</a>',b=E(),v=g("div"),w=g("div"),k=g("button"),k.textContent="OK",m(t,"id","title"),De(r,"icon","simple-icons:fandom"),De(r,"class","svelte-18cf37p"),m(a,"id","firstFocusable"),m(a,"href","https://fantastic-frontier-roblox.fandom.com/wiki/Fantastic_Frontier_-_Roblox_Wiki"),m(a,"target","_blank"),m(a,"class","svelte-18cf37p"),m(o,"class","svelte-18cf37p"),m(u,"class","svelte-18cf37p"),m(f,"class","svelte-18cf37p"),m(h,"class","svelte-18cf37p"),m(s,"class","svelte-18cf37p"),m(k,"id","lastFocusable"),m(v,"class","promptOptions"),m(e,"class","infoPrompt")},m(I,W){F(I,e,W),p(e,t),p(e,i),p(e,s),p(s,o),p(o,r),p(o,l),p(o,a),p(s,c),p(s,u),p(s,d),p(s,f),p(s,_),p(s,h),p(e,b),p(e,v),p(v,w),p(w,k),n[2](k),T=!0,R||(q=[D(a,"keydown",kt),D(k,"click",n[3]),D(k,"keydown",Ct),D(e,"introstart",n[4])],R=!0)},p:re,i(I){T||(I&&we(()=>{T&&(y||(y=ge(e,$e,{duration:250},!0)),y.run(1))}),T=!0)},o(I){I&&(y||(y=ge(e,$e,{duration:250},!1)),y.run(0)),T=!1},d(I){I&&L(e),n[2](null),I&&y&&y.end(),R=!1,be(q)}}}function Gg(n,e,t){let i;J(n,x,a=>t(1,i=a));let s;function o(a){ie[a?"unshift":"push"](()=>{s=a,t(0,s)})}return[s,i,o,()=>G(x,i.resources.ongoing=!1,i),()=>s.focus()]}class Vg extends Me{constructor(e){super(),Pe(this,e,Gg,Ug,me,{})}}function Nl(n,e,t){const i=n.slice();return i[7]=e[t],i}function Ol(n,e,t){const i=n.slice();return i[10]=e[t],i}function Dl(n){let e,t,i,s,o,r,l,a=n[1][n[7]][n[10]].toLocaleString()+" Gold",c,u;return{c(){e=g("div"),t=g("span"),t.textContent=`${n[10].charAt(0).toUpperCase()+n[10].slice(1)+":"}`,i=E(),s=g("img"),r=E(),l=g("span"),c=ne(a),u=E(),m(t,"id","costTypeName"),m(t,"class","svelte-sk567b"),Ze(s.src,o="https://static.wikia.nocookie.net/fantastic-frontier-roblox/images/b/ba/GoldCoins.png")||m(s,"src",o),m(s,"alt",""),m(s,"class","svelte-sk567b"),m(e,"class","svelte-sk567b")},m(d,f){F(d,e,f),p(e,t),p(e,i),p(e,s),p(e,r),p(e,l),p(l,c),p(e,u)},p(d,f){f&2&&a!==(a=d[1][d[7]][d[10]].toLocaleString()+" Gold")&&Se(c,a)},d(d){d&&L(e)}}}function Rl(n){let e,t,i,s,o,r=Ne(["min","avg","max"]),l=[];for(let a=0;a<3;a+=1)l[a]=Dl(Ol(n,r,a));return{c(){e=g("div"),t=g("span"),t.textContent=`${n[7].charAt(0).toUpperCase()+n[7].slice(1)+" Costs"}`,i=E(),s=g("div");for(let a=0;a<3;a+=1)l[a].c();o=E(),m(t,"id","subtitle"),m(t,"class","svelte-sk567b"),m(s,"class","costTypes svelte-sk567b"),m(e,"class","costs svelte-sk567b"),m(e,"id",n[7])},m(a,c){F(a,e,c),p(e,t),p(e,i),p(e,s);for(let u=0;u<3;u+=1)l[u]&&l[u].m(s,null);p(e,o)},p(a,c){if(c&2){r=Ne(["min","avg","max"]);let u;for(u=0;u<3;u+=1){const d=Ol(a,r,u);l[u]?l[u].p(d,c):(l[u]=Dl(d),l[u].c(),l[u].m(s,null))}for(;u<3;u+=1)l[u].d(1)}},d(a){a&&L(e),at(l,a)}}}function Kg(n){let e,t,i,s,o,r,l,a,c,u,d=Ne(["armor","gear","total"]),f=[];for(let _=0;_<3;_+=1)f[_]=Rl(Nl(n,d,_));return{c(){e=g("div"),t=g("div");for(let _=0;_<3;_+=1)f[_].c();i=E(),s=g("div"),o=g("div"),r=g("button"),r.textContent="OK",m(t,"class","costsInfo svelte-sk567b"),m(r,"id","firstFocusable lastFocusable"),m(s,"class","promptOptions svelte-sk567b"),m(e,"class","buildCosts svelte-sk567b")},m(_,h){F(_,e,h),p(e,t);for(let b=0;b<3;b+=1)f[b]&&f[b].m(t,null);p(e,i),p(e,s),p(s,o),p(o,r),n[3](r),a=!0,c||(u=[D(r,"click",n[4]),D(r,"keydown",n[5]),D(e,"introstart",n[6])],c=!0)},p(_,[h]){if(h&2){d=Ne(["armor","gear","total"]);let b;for(b=0;b<3;b+=1){const v=Nl(_,d,b);f[b]?f[b].p(v,h):(f[b]=Rl(v),f[b].c(),f[b].m(t,null))}for(;b<3;b+=1)f[b].d(1)}},i(_){a||(_&&we(()=>{a&&(l||(l=ge(e,$e,{duration:250},!0)),l.run(1))}),a=!0)},o(_){_&&(l||(l=ge(e,$e,{duration:250},!1)),l.run(0)),a=!1},d(_){_&&L(e),at(f,_),n[3](null),_&&l&&l.end(),c=!1,be(u)}}}function Yg(n,e,t){let i,s;J(n,St,u=>t(1,i=u)),J(n,x,u=>t(2,s=u));let o;function r(u){ie[u?"unshift":"push"](()=>{o=u,t(0,o)})}return[o,i,s,r,()=>G(x,s.costs.ongoing=!1,s),u=>{kt(u),Ct(u)},()=>o.focus()]}class Qg extends Me{constructor(e){super(),Pe(this,e,Yg,Kg,me,{})}}function Al(n,e,t){const i=n.slice();return i[19]=e[t][0],i[20]=e[t][1],i}function Pl(n,e,t){const i=n.slice();return i[11]=e[t],i}function Ml(n,e,t){const i=n.slice();return i[16]=e[t],i}function Xg(n){const e=n.slice(),t=e[14]?e[5][e[2].name][e[11].name]:`${Math.round(e[11].mult*100*10)/10}<b>%</b> ${Mt[e[11].type]}`;return e[15]=t,e}function Ll(n){const e=n.slice(),t=e[5][e[2].name]!=null&&e[5][e[2].name][e[11].name]!=null;return e[14]=t,e}function Jg(n){let e;return{c(){e=g("span"),e.textContent=`Slot: ${n[2].slot.charAt(0).toUpperCase()+n[2].slot.slice(1)}`},m(t,i){F(t,e,i)},p:re,d(t){t&&L(e)}}}function Zg(n){let e;return{c(){e=g("span"),e.textContent=`Type: ${n[2].tool?"Tool":n[2].info.type}`},m(t,i){F(t,e,i)},p:re,d(t){t&&L(e)}}}function xg(n){let e,t,i,s,o=Ne(Object.entries(Mt)),r=[];for(let l=0;l<o.length;l+=1)r[l]=Bl(Al(n,o,l));return{c(){e=g("div"),t=g("span"),t.textContent=`${n[2].noStats?"No stats available":"Stats:"}`,i=E(),s=g("div");for(let l=0;l<r.length;l+=1)r[l].c();m(t,"id","subtitle"),m(t,"class","svelte-1d71l7d"),m(s,"class","svelte-1d71l7d"),m(e,"id","itemStats"),m(e,"class","svelte-1d71l7d")},m(l,a){F(l,e,a),p(e,t),p(e,i),p(e,s);for(let c=0;c<r.length;c+=1)r[c]&&r[c].m(s,null)},p(l,a){if(a&4){o=Ne(Object.entries(Mt));let c;for(c=0;c<o.length;c+=1){const u=Al(l,o,c);r[c]?r[c].p(u,a):(r[c]=Bl(u),r[c].c(),r[c].m(s,null))}for(;c<r.length;c+=1)r[c].d(1);r.length=o.length}},d(l){l&&L(e),at(r,l)}}}function $g(n){let e;function t(o,r){return o[2].tool?n1:t1}let s=t(n)(n);return{c(){s.c(),e=ut()},m(o,r){s.m(o,r),F(o,e,r)},p(o,r){s.p(o,r)},d(o){o&&L(e),s.d(o)}}}function e1(n){let e,t,i,s,o,r=(n[19]=="endurance"?n[2].stats[n[19]].toFixed(2):n[2].stats[n[19]])+"",l,a;return{c(){e=g("div"),t=g("img"),s=E(),o=g("span"),l=ne(r),a=E(),Ze(t.src,i="stats/"+n[19]+".svg")||m(t,"src",i),m(t,"alt",n[20]),m(t,"class","svelte-1d71l7d"),m(o,"class","statValue svelte-1d71l7d"),m(o,"id",n[19]),te(o,"negative",n[2].stats[n[19]]<0),m(e,"class","svelte-1d71l7d")},m(c,u){F(c,e,u),p(e,t),p(e,s),p(e,o),p(o,l),p(e,a)},p(c,u){u&4&&te(o,"negative",c[2].stats[c[19]]<0)},d(c){c&&L(e)}}}function Bl(n){let e,t=n[2].stats[n[19]]!=0&&e1(n);return{c(){t&&t.c(),e=ut()},m(i,s){t&&t.m(i,s),F(i,e,s)},p(i,s){i[2].stats[i[19]]!=0&&t.p(i,s)},d(i){i&&L(e),t&&t.d(i)}}}function t1(n){let e,t,i,s,o,r=Ne(n[2].moves),l=[];for(let a=0;a<r.length;a+=1)l[a]=jl(Pl(n,r,a));return{c(){e=g("div"),t=g("div"),i=g("div"),s=g("div"),s.innerHTML='<span class="svelte-1d71l7d">Move</span> <span class="svelte-1d71l7d">Base Value</span> <span class="svelte-1d71l7d">Scaling(s)</span>',o=E();for(let a=0;a<l.length;a+=1)l[a].c();m(s,"id","subtitle"),m(s,"class","svelte-1d71l7d"),m(i,"class","svelte-1d71l7d"),m(t,"id","itemMoves"),m(t,"class","svelte-1d71l7d"),m(e,"id","itemMovesCont"),m(e,"class","svelte-1d71l7d")},m(a,c){F(a,e,c),p(e,t),p(t,i),p(i,s),p(i,o);for(let u=0;u<l.length;u+=1)l[u]&&l[u].m(i,null)},p(a,c){if(c&52){r=Ne(a[2].moves);let u;for(u=0;u<r.length;u+=1){const d=Pl(a,r,u);l[u]?l[u].p(d,c):(l[u]=jl(d),l[u].c(),l[u].m(i,null))}for(;u<l.length;u+=1)l[u].d(1);l.length=r.length}},d(a){a&&L(e),at(l,a)}}}function n1(n){let e;return{c(){e=g("div"),e.innerHTML='<span id="subtitle" class="svelte-1d71l7d">No moves available</span>',m(e,"id","itemMovesCont"),m(e,"class","svelte-1d71l7d"),et(e,"text-align","center")},m(t,i){F(t,e,i)},p:re,d(t){t&&L(e)}}}function i1(n){let e,t,i,s,o,r;function l(d,f){return!d[11].type||!d[11].type.includes("/")?Fl:s1}function a(d,f){return f===Fl?Xg(d):d}let c=l(n),u=c(a(n,c));return{c(){e=g("div"),t=g("span"),t.textContent=`${n[11].name}`,i=E(),s=g("span"),s.textContent=`${(n[11].name.includes("Fantastic Beamstorm")?"~":"")+n[11].base}`,o=E(),u.c(),r=E(),m(t,"class","svelte-1d71l7d"),m(s,"class","svelte-1d71l7d"),m(e,"class","svelte-1d71l7d")},m(d,f){F(d,e,f),p(e,t),p(e,i),p(e,s),p(e,o),u.m(e,null),p(e,r)},p(d,f){u.p(a(d,c),f)},d(d){d&&L(e),u.d()}}}function s1(n){let e,t=Ne(n[11].type.split("/")),i=[];for(let s=0;s<t.length;s+=1)i[s]=zl(Ml(n,t,s));return{c(){e=g("span");for(let s=0;s<i.length;s+=1)i[s].c();m(e,"id","hybrid"),m(e,"class","svelte-1d71l7d")},m(s,o){F(s,e,o);for(let r=0;r<i.length;r+=1)i[r]&&i[r].m(e,null)},p(s,o){if(o&4){t=Ne(s[11].type.split("/"));let r;for(r=0;r<t.length;r+=1){const l=Ml(s,t,r);i[r]?i[r].p(l,o):(i[r]=zl(l),i[r].c(),i[r].m(e,null))}for(;r<i.length;r+=1)i[r].d(1);i.length=t.length}},d(s){s&&L(e),at(i,s)}}}function Fl(n){let e,t=n[15]+"";return{c(){e=g("span"),m(e,"class","svelte-1d71l7d"),et(e,"font-size",n[15].length>30?"calc(var(--u) * 2.5)":"")},m(i,s){F(i,e,s),e.innerHTML=t},p:re,d(i){i&&L(e)}}}function zl(n){let e,t=Math.round(n[11][`${n[16]}Mult`]*100*10)/10+"",i,s,o,r=Mt[n[16]]+"",l,a;return{c(){e=g("span"),i=ne(t),s=g("b"),s.textContent="%",o=E(),l=ne(r),a=E()},m(c,u){F(c,e,u),p(e,i),p(e,s),p(e,o),p(e,l),p(e,a)},p:re,d(c){c&&L(e)}}}function jl(n){let e=!n[4].includes(n[11].name),t,i=e&&i1(Ll(n));return{c(){i&&i.c(),t=ut()},m(s,o){i&&i.m(s,o),F(s,t,o)},p(s,o){e&&i.p(Ll(s),o)},d(s){s&&L(t),i&&i.d(s)}}}function o1(n){let e,t,i,s,o,r,l,a,c,u,d,f,_,h,b,v,w,k,y,T,R,q,I,W,j,Q,O,C,N,Z,A,P,M,U,X,fe,ce,ee,z,Y;function ue(ke,Ye){return ke[3]?Zg:Jg}let Le=ue(n)(n);function ae(ke,Ye){return ke[3]?$g:xg}let ht=ae(n)(n);return{c(){e=g("div"),t=g("div"),i=g("a"),s=g("img"),r=E(),l=g("div"),a=g("span"),a.textContent="Click the image in order to visit the wiki page",c=E(),u=g("span"),u.textContent=`Name: ${n[2].name}`,d=E(),Le.c(),f=E(),ht.c(),_=E(),h=g("div"),b=g("span"),b.textContent="Costs:",v=E(),w=g("div"),k=g("div"),y=g("span"),y.textContent="Minimum:",T=E(),R=g("img"),I=E(),W=g("span"),W.textContent=`${n[2].cost.min==null?"Unpurchasable":n[2].cost.min.toLocaleString()+" Gold"}`,j=E(),Q=g("div"),O=g("span"),O.textContent="Maximum:",C=E(),N=g("img"),A=E(),P=g("span"),P.textContent=`${n[2].cost.max==null?"Unpurchasable":n[2].cost.max.toLocaleString()+" Gold"}`,M=E(),U=g("div"),X=g("div"),fe=g("button"),fe.textContent="OK",Ze(s.src,o=n[2].image)||m(s,"src",o),m(s,"alt",""),m(s,"class","svelte-1d71l7d"),m(i,"href",n[2].link),m(i,"target","_blank"),m(i,"class","svelte-1d71l7d"),m(a,"id","tip"),m(a,"class","svelte-1d71l7d"),m(l,"class","svelte-1d71l7d"),m(t,"id","basicInfo"),m(t,"class","svelte-1d71l7d"),m(b,"id","subtitle"),m(b,"class","svelte-1d71l7d"),m(y,"class","svelte-1d71l7d"),Ze(R.src,q="https://static.wikia.nocookie.net/fantastic-frontier-roblox/images/b/ba/GoldCoins.png")||m(R,"src",q),m(R,"alt",""),m(R,"class","svelte-1d71l7d"),m(W,"class","svelte-1d71l7d"),m(k,"class","svelte-1d71l7d"),m(O,"class","svelte-1d71l7d"),Ze(N.src,Z="https://static.wikia.nocookie.net/fantastic-frontier-roblox/images/b/ba/GoldCoins.png")||m(N,"src",Z),m(N,"alt",""),m(N,"class","svelte-1d71l7d"),m(P,"class","svelte-1d71l7d"),m(Q,"class","svelte-1d71l7d"),m(w,"class","svelte-1d71l7d"),m(h,"id","itemCosts"),m(h,"class","svelte-1d71l7d"),m(fe,"id","firstFocusable lastFocusable"),m(U,"class","promptOptions svelte-1d71l7d"),m(e,"class","itemInfo svelte-1d71l7d")},m(ke,Ye){F(ke,e,Ye),p(e,t),p(t,i),p(i,s),p(t,r),p(t,l),p(l,a),p(l,c),p(l,u),p(l,d),Le.m(l,null),p(e,f),ht.m(e,null),p(e,_),p(e,h),p(h,b),p(h,v),p(h,w),p(w,k),p(k,y),p(k,T),p(k,R),p(k,I),p(k,W),p(w,j),p(w,Q),p(Q,O),p(Q,C),p(Q,N),p(Q,A),p(Q,P),p(e,M),p(e,U),p(U,X),p(X,fe),n[6](fe),ee=!0,z||(Y=[D(fe,"click",n[7]),D(fe,"keydown",n[8]),D(e,"introstart",n[9]),D(e,"outroend",n[10])],z=!0)},p(ke,[Ye]){Le.p(ke,Ye),ht.p(ke,Ye)},i(ke){ee||(ke&&we(()=>{ee&&(ce||(ce=ge(e,$e,{duration:250},!0)),ce.run(1))}),ee=!0)},o(ke){ke&&(ce||(ce=ge(e,$e,{duration:250},!1)),ce.run(0)),ee=!1},d(ke){ke&&L(e),Le.d(),ht.d(),n[6](null),ke&&ce&&ce.end(),z=!1,be(Y)}}}function r1(n,e,t){let i;J(n,x,h=>t(1,i=h));let s,o=i.item.data,r=o.type=="gear",l=["Charged Basic Attack","Charged Solar Beam"],a={"Void Spike Ultradagger":{"Void Needle":"100<b>%</b> Melee - 562.5<b>%</b> Armor"},"Pureblood Dagger":{"Basic Attack":"200<b>%</b> HighestBonus - 100<b>%</b> LowerBonuses","Blood Sap":"200<b>%</b> HighestBonus - 100<b>%</b> LowerBonuses","+ HP per Blood Sap":"(200<b>%</b> HighestBonus - 100<b>%</b> LowerBonuses) / 2"},"Gnome Rocket Launcher":{"Basic Attack":"None"}};function c(h){ie[h?"unshift":"push"](()=>{s=h,t(0,s)})}return[s,i,o,r,l,a,c,()=>G(x,i.item.ongoing=!1,i),h=>{kt(h),Ct(h)},()=>s.focus(),()=>{o.element&&o.element.querySelector("button").focus()}]}class l1 extends Me{constructor(e){super(),Pe(this,e,r1,o1,me,{})}}const{document:Lt,window:cn}=_u;function ql(n,e,t){const i=n.slice();return i[49]=e[t],i}function Wl(n,e,t){const i=n.slice();return i[49]=e[t],i}function Hl(n){let e;return{c(){e=g("style"),e.textContent=`* {\r
                pointer-events: none;\r
            }\r
        `},m(t,i){F(t,e,i)},d(t){t&&L(e)}}}function Ul(n){let e;return{c(){e=g("link"),m(e,"rel","preload"),m(e,"as","image"),m(e,"href",n[49])},m(t,i){F(t,e,i)},p:re,d(t){t&&L(e)}}}function Gl(n){let e;return{c(){e=g("style"),e.textContent=`body > div:not(.backgrounds),\r
            main > :not(.promptCont),\r
            .backgrounds > img,\r
            .info#resources,\r
            .info#changelog {\r
                filter: blur(calc(var(--u) * 0.5));\r
                pointer-events: none;\r
            }\r
            .sideFeatures {\r
                z-index: 3;\r
            }\r
            .sideFeatures button:hover,\r
            .sideFeatures button:focus,\r
            .info:hover,\r
            .info:focus {\r
                background-color: var(--transparent);\r
            }\r
            .sideFeatures button > .tooltip,\r
            .info:not(#credits) > .tooltip {\r
                opacity: 0 !important;\r
                visibility: hidden !important;\r
            }\r
        `},m(t,i){F(t,e,i)},d(t){t&&L(e)}}}function Vl(n){let e;return{c(){e=g("style"),e.textContent=`body {\r
                overflow: hidden;\r
            }\r
        `},m(t,i){F(t,e,i)},d(t){t&&L(e)}}}function Kl(n){let e;return{c(){e=g("style"),e.textContent=`body {\r
                pointer-events: none;\r
            }\r
            #resources,\r
            #changelog,\r
            .mainFeatures,\r
            .sideFeatures,\r
            .statBox > .toggleCont,\r
            .ddButton > iconify-icon,\r
            .copyStatsButton {\r
                opacity: 0;\r
                visibility: hidden;\r
            }\r
            .gearBox .ddButton > iconify-icon {\r
                width: 15% !important;\r
            }\r
            .eqSlotIcon button > .tooltip,\r
            .gearSlotIcon button > .tooltip {\r
                opacity: 1;\r
                visibility: visible;\r
            }\r
            .calcBox {\r
                translate: -3%;\r
            }\r
            .currentBuild {\r
                left: 50% !important;\r
                padding: calc(var(--u) * 2) !important;\r
            }\r
            .currentBuild > button {\r
                min-width: 0 !important;\r
                width: 0;\r
                opacity: 0;\r
                visibility: hidden;\r
            }`},m(t,i){F(t,e,i)},d(t){t&&L(e)}}}function Yl(n){let e,t;return{c(){e=g("img"),m(e,"class","background svelte-13g7xz7"),Ze(e.src,t=n[49])||m(e,"src",t),m(e,"alt",""),te(e,"active",n[21].indexOf(n[49])==n[9])},m(i,s){F(i,e,s)},p(i,s){s[0]&2097664&&te(e,"active",i[21].indexOf(i[49])==i[9])},d(i){i&&L(e)}}}function Ql(n){let e,t,i=Math.floor(n[18][n[3]]*100)+"",s,o,r,l;return{c(){e=g("span"),t=ne("Zoom: "),s=ne(i),o=g("b"),o.textContent="%",m(e,"class","info svelte-13g7xz7"),m(e,"id","zoomLevel")},m(a,c){F(a,e,c),p(e,t),p(e,s),p(e,o),l=!0},p(a,c){(!l||c[0]&8)&&i!==(i=Math.floor(a[18][a[3]]*100)+"")&&Se(s,i)},i(a){l||(a&&we(()=>{l&&(r||(r=ge(e,Xe,{duration:150},!0)),r.run(1))}),l=!0)},o(a){a&&(r||(r=ge(e,Xe,{duration:150},!1)),r.run(0)),l=!1},d(a){a&&L(e),a&&r&&r.end()}}}function Xl(n){let e,t,i,s,o,r,l,a,c=n[17].armor.avg.toLocaleString()+" Gold",u,d,f,_,h,b,v,w,k,y=n[17].gear.avg.toLocaleString()+" Gold",T,R,q;return{c(){e=g("div"),t=g("div"),i=g("span"),i.textContent="Avg. armor cost:",s=E(),o=g("img"),l=E(),a=g("span"),u=ne(c),d=E(),f=g("div"),_=g("span"),_.textContent="Avg. gear cost:",h=E(),b=g("img"),w=E(),k=g("span"),T=ne(y),Ze(o.src,r="https://static.wikia.nocookie.net/fantastic-frontier-roblox/images/b/ba/GoldCoins.png")||m(o,"src",r),m(o,"alt",""),m(o,"class","svelte-13g7xz7"),m(t,"class","svelte-13g7xz7"),Ze(b.src,v="https://static.wikia.nocookie.net/fantastic-frontier-roblox/images/b/ba/GoldCoins.png")||m(b,"src",v),m(b,"alt",""),m(b,"class","svelte-13g7xz7"),m(f,"class","svelte-13g7xz7"),m(e,"class","costPreview svelte-13g7xz7"),m(e,"id","specific")},m(I,W){F(I,e,W),p(e,t),p(t,i),p(t,s),p(t,o),p(t,l),p(t,a),p(a,u),p(e,d),p(e,f),p(f,_),p(f,h),p(f,b),p(f,w),p(f,k),p(k,T),q=!0},p(I,W){(!q||W[0]&131072)&&c!==(c=I[17].armor.avg.toLocaleString()+" Gold")&&Se(u,c),(!q||W[0]&131072)&&y!==(y=I[17].gear.avg.toLocaleString()+" Gold")&&Se(T,y)},i(I){q||(I&&we(()=>{q&&(R||(R=ge(e,Xe,{duration:150},!0)),R.run(1))}),q=!0)},o(I){I&&(R||(R=ge(e,Xe,{duration:150},!1)),R.run(0)),q=!1},d(I){I&&L(e),I&&R&&R.end()}}}function Jl(n){let e,t,i=n[4].name+"",s,o,r,l,a,c,u,d,f,_,h=n[4].desc+"",b,v,w,k,y;return{c(){e=g("div"),t=g("span"),s=ne(i),o=E(),r=g("button"),r.innerHTML='<iconify-icon icon="ri:share-fill"></iconify-icon> <span class="tooltip" id="right">Share build</span>',l=E(),a=g("span"),c=ne(`Description / Notes:\r
                `),u=g("br"),d=E(),f=g("br"),_=E(),b=ne(h),m(t,"id","buildName"),m(t,"class","svelte-13g7xz7"),m(r,"class","svelte-13g7xz7"),m(a,"class","tooltip"),m(a,"id","bottom"),m(e,"class","currentBuild svelte-13g7xz7"),te(e,"no-tooltip",n[10])},m(T,R){F(T,e,R),p(e,t),p(t,s),p(e,o),p(e,r),p(e,l),p(e,a),p(a,c),p(a,u),p(a,d),p(a,f),p(a,_),p(a,b),w=!0,k||(y=[D(r,"click",n[31]),D(r,"mouseenter",n[32]),D(r,"mouseleave",n[33])],k=!0)},p(T,R){(!w||R[0]&16)&&i!==(i=T[4].name+"")&&Se(s,i),(!w||R[0]&16)&&h!==(h=T[4].desc+"")&&Se(b,h),(!w||R[0]&1024)&&te(e,"no-tooltip",T[10])},i(T){w||(T&&we(()=>{w&&(v||(v=ge(e,Xe,{duration:100},!0)),v.run(1))}),w=!0)},o(T){T&&(v||(v=ge(e,Xe,{duration:100},!1)),v.run(0)),w=!1},d(T){T&&L(e),T&&v&&v.end(),k=!1,be(y)}}}function Zl(n){let e,t,i,s,o,r,l,a,c=n[17].total.avg.toLocaleString()+" Gold",u,d,f;return{c(){e=g("div"),t=g("div"),i=g("span"),i.textContent="Avg. total cost:",s=E(),o=g("img"),l=E(),a=g("span"),u=ne(c),Ze(o.src,r="https://static.wikia.nocookie.net/fantastic-frontier-roblox/images/b/ba/GoldCoins.png")||m(o,"src",r),m(o,"alt",""),m(o,"class","svelte-13g7xz7"),m(t,"class","svelte-13g7xz7"),m(e,"class","costPreview svelte-13g7xz7"),m(e,"id","total")},m(_,h){F(_,e,h),p(e,t),p(t,i),p(t,s),p(t,o),p(t,l),p(t,a),p(a,u),f=!0},p(_,h){(!f||h[0]&131072)&&c!==(c=_[17].total.avg.toLocaleString()+" Gold")&&Se(u,c)},i(_){f||(_&&we(()=>{f&&(d||(d=ge(e,Xe,{duration:150},!0)),d.run(1))}),f=!0)},o(_){_&&(d||(d=ge(e,Xe,{duration:150},!1)),d.run(0)),f=!1},d(_){_&&L(e),_&&d&&d.end()}}}function a1(n){let e,t,i;return t=new Hg({}),{c(){e=g("div"),le(t.$$.fragment),m(e,"class","promptCont svelte-13g7xz7")},m(s,o){F(s,e,o),se(t,e,null),i=!0},p:re,i(s){i||(B(t.$$.fragment,s),i=!0)},o(s){H(t.$$.fragment,s),i=!1},d(s){s&&L(e),oe(t)}}}function c1(n){let e,t,i;return t=new Vg({}),t.$on("loadPending",n[19]),{c(){e=g("div"),le(t.$$.fragment),m(e,"class","promptCont svelte-13g7xz7")},m(s,o){F(s,e,o),se(t,e,null),i=!0},p:re,i(s){i||(B(t.$$.fragment,s),i=!0)},o(s){H(t.$$.fragment,s),i=!1},d(s){s&&L(e),oe(t)}}}function u1(n){let e,t,i;return t=new Lg({}),{c(){e=g("div"),le(t.$$.fragment),m(e,"class","promptCont svelte-13g7xz7")},m(s,o){F(s,e,o),se(t,e,null),i=!0},p:re,i(s){i||(B(t.$$.fragment,s),i=!0)},o(s){H(t.$$.fragment,s),i=!1},d(s){s&&L(e),oe(t)}}}function d1(n){let e,t,i;return t=new Rg({}),{c(){e=g("div"),le(t.$$.fragment),m(e,"class","promptCont svelte-13g7xz7")},m(s,o){F(s,e,o),se(t,e,null),i=!0},p:re,i(s){i||(B(t.$$.fragment,s),i=!0)},o(s){H(t.$$.fragment,s),i=!1},d(s){s&&L(e),oe(t)}}}function f1(n){let e,t,i;return t=new Qg({}),{c(){e=g("div"),le(t.$$.fragment),m(e,"class","promptCont svelte-13g7xz7")},m(s,o){F(s,e,o),se(t,e,null),i=!0},p:re,i(s){i||(B(t.$$.fragment,s),i=!0)},o(s){H(t.$$.fragment,s),i=!1},d(s){s&&L(e),oe(t)}}}function h1(n){let e,t,i;return t=new Sg({}),{c(){e=g("div"),le(t.$$.fragment),m(e,"class","promptCont svelte-13g7xz7")},m(s,o){F(s,e,o),se(t,e,null),i=!0},p:re,i(s){i||(B(t.$$.fragment,s),i=!0)},o(s){H(t.$$.fragment,s),i=!1},d(s){s&&L(e),oe(t)}}}function _1(n){let e,t,i;return t=new kg({}),t.$on("buildLoad",n[35]),{c(){e=g("div"),le(t.$$.fragment),m(e,"class","promptCont svelte-13g7xz7")},m(s,o){F(s,e,o),se(t,e,null),i=!0},p:re,i(s){i||(B(t.$$.fragment,s),i=!0)},o(s){H(t.$$.fragment,s),i=!1},d(s){s&&L(e),oe(t)}}}function p1(n){let e,t,i;return t=new gg({}),{c(){e=g("div"),le(t.$$.fragment),m(e,"class","promptCont svelte-13g7xz7")},m(s,o){F(s,e,o),se(t,e,null),i=!0},p:re,i(s){i||(B(t.$$.fragment,s),i=!0)},o(s){H(t.$$.fragment,s),i=!1},d(s){s&&L(e),oe(t)}}}function m1(n){let e,t,i;return t=new Km({}),{c(){e=g("div"),le(t.$$.fragment),m(e,"class","promptCont svelte-13g7xz7")},m(s,o){F(s,e,o),se(t,e,null),i=!0},p:re,i(s){i||(B(t.$$.fragment,s),i=!0)},o(s){H(t.$$.fragment,s),i=!1},d(s){s&&L(e),oe(t)}}}function g1(n){let e,t,i,s;function o(l){n[34](l)}let r={};return n[8]!==void 0&&(r.loadID=n[8]),t=new cg({props:r}),ie.push(()=>Ae(t,"loadID",o)),t.$on("resetActions",n[23]),{c(){e=g("div"),le(t.$$.fragment),m(e,"class","promptCont svelte-13g7xz7")},m(l,a){F(l,e,a),se(t,e,null),s=!0},p(l,a){const c={};!i&&a[0]&256&&(i=!0,c.loadID=l[8],Re(()=>i=!1)),t.$set(c)},i(l){s||(B(t.$$.fragment,l),s=!0)},o(l){H(t.$$.fragment,l),s=!1},d(l){l&&L(e),oe(t)}}}function b1(n){let e,t,i;return t=new l1({}),{c(){e=g("div"),le(t.$$.fragment),m(e,"class","promptCont svelte-13g7xz7")},m(s,o){F(s,e,o),se(t,e,null),i=!0},p:re,i(s){i||(B(t.$$.fragment,s),i=!0)},o(s){H(t.$$.fragment,s),i=!1},d(s){s&&L(e),oe(t)}}}function xl(n){let e,t,i;return{c(){e=g("iconify-icon"),De(e,"icon","uil:exclamation"),De(e,"id","unseen"),De(e,"class","svelte-13g7xz7")},m(s,o){F(s,e,o),i=!0},i(s){i||(s&&we(()=>{i&&(t||(t=ge(e,Xe,{duration:150},!0)),t.run(1))}),i=!0)},o(s){s&&(t||(t=ge(e,Xe,{duration:150},!1)),t.run(0)),i=!1},d(s){s&&L(e),s&&t&&t.end()}}}function $l(n){let e;return{c(){e=g("div"),e.innerHTML='<iconify-icon icon="eos-icons:three-dots-loading" class="svelte-13g7xz7"></iconify-icon>',m(e,"class","promptCont svelte-13g7xz7")},m(t,i){F(t,e,i)},d(t){t&&L(e)}}}function v1(n){let e,t,i,s,o,r,l,a,c,u,d,f,_,h,b,v,w,k,y,T,R,q,I,W,j,Q,O,C,N,Z,A,P,M,U,X,fe,ce,ee,z,Y,ue,Fe,Le,ae,gt,ht;we(n[29]);let ke=!n[6]&&Hl(),Ye=Ne(n[21]),de=[];for(let S=0;S<Ye.length;S+=1)de[S]=Ul(Wl(n,Ye,S));let Ie=(n[12]||!n[6])&&Gl(),Qe=n[5].screenshot.ongoing&&n[18][n[3]]<=1&&Vl(),K=n[5].screenshot.ongoing&&Kl(),qe=Ne(n[21]),_e=[];for(let S=0;S<qe.length;S+=1)_e[S]=Yl(ql(n,qe,S));let Oe=n[7]&&Ql(n),V=n[5].screenshot.ongoing&&Xl(n),pe=n[4]&&Jl(n);w=new Lm({}),y=new Ng({}),I=new dm({}),j=new wm({}),O=new Am({}),N=new Um({});let Te=n[5].screenshot.ongoing&&Zl(n);const _t=[b1,g1,m1,p1,_1,h1,f1,d1,u1,c1,a1],xe=[];function It(S,ve){return S[5].item.ongoing?0:S[11]||S[5].share.ongoing?1:S[5].export.ongoing?2:S[5].save.ongoing?3:S[5].load.ongoing&&!S[8]?4:S[5].delete.ongoing?5:S[5].costs.ongoing?6:S[5].bonus.ongoing?7:S[5].randomize.ongoing?8:S[5].resources.ongoing?9:S[5].changelog.ongoing?10:-1}~(P=It(n))&&(M=xe[P]=_t[P](n));let Ge=!n[13]&&xl(),st=!n[6]&&$l();return{c(){ke&&ke.c(),e=ut();for(let S=0;S<de.length;S+=1)de[S].c();t=ut(),Ie&&Ie.c(),i=ut(),Qe&&Qe.c(),s=ut(),K&&K.c(),o=ut(),r=E(),l=g("div");for(let S=0;S<_e.length;S+=1)_e[S].c();a=E(),Oe&&Oe.c(),c=E(),u=g("span"),u.innerHTML=`<iconify-icon icon="ic:baseline-discord" class="svelte-13g7xz7"></iconify-icon>
    xt.ss
    <span class="tooltip svelte-13g7xz7" id="right">Contact me on Discord!</span>`,d=E(),f=g("button"),f.innerHTML='<iconify-icon icon="charm:stack"></iconify-icon> <span class="tooltip" id="left">Resources</span>',_=E(),h=g("main"),V&&V.c(),b=E(),pe&&pe.c(),v=E(),le(w.$$.fragment),k=E(),le(y.$$.fragment),T=E(),R=g("div"),q=g("div"),le(I.$$.fragment),W=E(),le(j.$$.fragment),Q=E(),le(O.$$.fragment),C=E(),le(N.$$.fragment),Z=E(),Te&&Te.c(),A=E(),M&&M.c(),U=E(),X=g("button"),fe=g("iconify-icon"),ce=E(),ee=g("span"),ee.textContent="Changelog",z=E(),Ge&&Ge.c(),Y=E(),ue=g("span"),ue.textContent=`${xs}`,Fe=E(),st&&st.c(),Le=ut(),m(l,"class","backgrounds"),m(u,"class","info svelte-13g7xz7"),m(u,"id","credits"),m(f,"class","info svelte-13g7xz7"),m(f,"id","resources"),m(q,"class","eqCont svelte-13g7xz7"),m(R,"class","calcBox svelte-13g7xz7"),m(R,"id","calc"),m(h,"class","svelte-13g7xz7"),te(h,"portrait",!n[2]),De(fe,"icon","octicon:log-16"),m(ee,"class","tooltip"),m(ee,"id","right"),m(X,"class","info svelte-13g7xz7"),m(X,"id","changelog"),m(ue,"class","info svelte-13g7xz7"),m(ue,"id","version")},m(S,ve){ke&&ke.m(Lt.head,null),p(Lt.head,e);for(let Et=0;Et<de.length;Et+=1)de[Et]&&de[Et].m(Lt.head,null);p(Lt.head,t),Ie&&Ie.m(Lt.head,null),p(Lt.head,i),Qe&&Qe.m(Lt.head,null),p(Lt.head,s),K&&K.m(Lt.head,null),p(Lt.head,o),F(S,r,ve),F(S,l,ve);for(let Et=0;Et<_e.length;Et+=1)_e[Et]&&_e[Et].m(l,null);F(S,a,ve),Oe&&Oe.m(S,ve),F(S,c,ve),F(S,u,ve),F(S,d,ve),F(S,f,ve),F(S,_,ve),F(S,h,ve),V&&V.m(h,null),p(h,b),pe&&pe.m(h,null),p(h,v),se(w,h,null),p(h,k),se(y,h,null),p(h,T),p(h,R),p(R,q),se(I,q,null),p(q,W),se(j,q,null),p(R,Q),se(O,R,null),p(h,C),se(N,h,null),p(h,Z),Te&&Te.m(h,null),p(h,A),~P&&xe[P].m(h,null),F(S,U,ve),F(S,X,ve),p(X,fe),p(X,ce),p(X,ee),p(X,z),Ge&&Ge.m(X,null),F(S,Y,ve),F(S,ue,ve),F(S,Fe,ve),st&&st.m(S,ve),F(S,Le,ve),ae=!0,gt||(ht=[D(cn,"beforeunload",n[25]),D(cn,"storage",n[26]),D(cn,"wheel",n[27],{passive:!1}),D(cn,"keydown",n[28]),D(cn,"resize",n[29]),D(f,"click",n[30]),D(X,"click",n[36])],gt=!0)},p(S,ve){if(S[6]?ke&&(ke.d(1),ke=null):ke||(ke=Hl(),ke.c(),ke.m(e.parentNode,e)),ve[0]&2097152){Ye=Ne(S[21]);let Ve;for(Ve=0;Ve<Ye.length;Ve+=1){const Kn=Wl(S,Ye,Ve);de[Ve]?de[Ve].p(Kn,ve):(de[Ve]=Ul(Kn),de[Ve].c(),de[Ve].m(t.parentNode,t))}for(;Ve<de.length;Ve+=1)de[Ve].d(1);de.length=Ye.length}if(S[12]||!S[6]?Ie||(Ie=Gl(),Ie.c(),Ie.m(i.parentNode,i)):Ie&&(Ie.d(1),Ie=null),S[5].screenshot.ongoing&&S[18][S[3]]<=1?Qe||(Qe=Vl(),Qe.c(),Qe.m(s.parentNode,s)):Qe&&(Qe.d(1),Qe=null),S[5].screenshot.ongoing?K||(K=Kl(),K.c(),K.m(o.parentNode,o)):K&&(K.d(1),K=null),ve[0]&2097664){qe=Ne(S[21]);let Ve;for(Ve=0;Ve<qe.length;Ve+=1){const Kn=ql(S,qe,Ve);_e[Ve]?_e[Ve].p(Kn,ve):(_e[Ve]=Yl(Kn),_e[Ve].c(),_e[Ve].m(l,null))}for(;Ve<_e.length;Ve+=1)_e[Ve].d(1);_e.length=qe.length}S[7]?Oe?(Oe.p(S,ve),ve[0]&128&&B(Oe,1)):(Oe=Ql(S),Oe.c(),B(Oe,1),Oe.m(c.parentNode,c)):Oe&&(ze(),H(Oe,1,1,()=>{Oe=null}),je()),S[5].screenshot.ongoing?V?(V.p(S,ve),ve[0]&32&&B(V,1)):(V=Xl(S),V.c(),B(V,1),V.m(h,b)):V&&(ze(),H(V,1,1,()=>{V=null}),je()),S[4]?pe?(pe.p(S,ve),ve[0]&16&&B(pe,1)):(pe=Jl(S),pe.c(),B(pe,1),pe.m(h,v)):pe&&(ze(),H(pe,1,1,()=>{pe=null}),je()),S[5].screenshot.ongoing?Te?(Te.p(S,ve),ve[0]&32&&B(Te,1)):(Te=Zl(S),Te.c(),B(Te,1),Te.m(h,A)):Te&&(ze(),H(Te,1,1,()=>{Te=null}),je());let Et=P;P=It(S),P===Et?~P&&xe[P].p(S,ve):(M&&(ze(),H(xe[Et],1,1,()=>{xe[Et]=null}),je()),~P?(M=xe[P],M?M.p(S,ve):(M=xe[P]=_t[P](S),M.c()),B(M,1),M.m(h,null)):M=null),(!ae||ve[0]&4)&&te(h,"portrait",!S[2]),S[13]?Ge&&(ze(),H(Ge,1,1,()=>{Ge=null}),je()):Ge?ve[0]&8192&&B(Ge,1):(Ge=xl(),Ge.c(),B(Ge,1),Ge.m(X,null)),S[6]?st&&(st.d(1),st=null):st||(st=$l(),st.c(),st.m(Le.parentNode,Le))},i(S){ae||(B(Oe),B(V),B(pe),B(w.$$.fragment,S),B(y.$$.fragment,S),B(I.$$.fragment,S),B(j.$$.fragment,S),B(O.$$.fragment,S),B(N.$$.fragment,S),B(Te),B(M),B(Ge),ae=!0)},o(S){H(Oe),H(V),H(pe),H(w.$$.fragment,S),H(y.$$.fragment,S),H(I.$$.fragment,S),H(j.$$.fragment,S),H(O.$$.fragment,S),H(N.$$.fragment,S),H(Te),H(M),H(Ge),ae=!1},d(S){S&&(L(r),L(l),L(a),L(c),L(u),L(d),L(f),L(_),L(h),L(U),L(X),L(Y),L(ue),L(Fe),L(Le)),ke&&ke.d(S),L(e),at(de,S),L(t),Ie&&Ie.d(S),L(i),Qe&&Qe.d(S),L(s),K&&K.d(S),L(o),at(_e,S),Oe&&Oe.d(S),V&&V.d(),pe&&pe.d(),oe(w),oe(y),oe(I),oe(j),oe(O),oe(N),Te&&Te.d(),~P&&xe[P].d(),Ge&&Ge.d(),st&&st.d(S),gt=!1,be(ht)}}}let xs="v3.26.4";function y1(n,e,t){let i,s,o,r,l,a,c,u,d,f,_,h,b,v,w;J(n,bt,K=>t(4,s=K)),J(n,x,K=>t(5,o=K)),J(n,pn,K=>t(12,r=K)),J(n,so,K=>t(24,l=K)),J(n,Mn,K=>t(40,a=K)),J(n,zt,K=>t(41,c=K)),J(n,Pn,K=>t(42,u=K)),J(n,Pt,K=>t(43,d=K)),J(n,Oi,K=>t(13,f=K)),J(n,Qt,K=>t(14,_=K)),J(n,Tt,K=>t(15,h=K)),J(n,At,K=>t(44,b=K)),J(n,oo,K=>t(16,v=K)),J(n,St,K=>t(17,w=K));let k=!1,y,T,R,q=7,I=[.2,.3,.45,.6,.75,.85,.95,1,1.1,1.25,1.5,1.75,2,2.5,3,4,5],W=!1,j,Q=new URLSearchParams(location.search).get("id");for(let K of Dp){let qe=`https://raw.githubusercontent.com/XT8SS/fantastic-calculator/gh-pages/ff-data/${K}.json`;fetch(qe).then(async _e=>{if(_e.status!=200){console.error(`Failed to fetch "${K}" data!
Status: ${_e.status}`);return}G(At,b[K]=await _e.json(),b)}).catch(_e=>console.error(`Failed to initiate "${K}" data fetch!
${_e}`))}Eu(()=>{t(6,k=!0),Q&&O(),t(2,R=T>y),h[Object.keys(h)[0]]&&G(Qt,_=!0,_),localStorage.getItem("version")!=xs&&(G(Oi,f=!1,f),localStorage.setItem("version",xs)),localStorage.getItem("changelogSeen")||localStorage.setItem("changelogSeen",!1)});function O(){if(G(x,o.load.ongoing=!0,o),!Q.startsWith("-N"))G(x,o.load.status=-1,o),G(x,o.message="invalid_id",o);else{G(x,o.load.status=0,o);let K=Jc(zn(qn,"builds"),Xc()),qe=0;Qc(K).then(_e=>{for(let Oe in _e.val()){if(Oe==Q){C(_e.val()[Oe],Oe);break}else qe==Object.keys(_e.val()).length-1&&(G(x,o.load.status=-1,o),G(x,o.message="invalid_id",o));qe++}}).catch(()=>{G(x,o.load.status=-1,o),G(x,o.message="firebase_fail",o)})}}function C(K,qe){for(let _e in K.eq){let Oe=d[_e]||ps;K.eq[_e]&&K.eq[_e]!=Oe.name?u[_e][K.eq[_e]].querySelector("button").click():!K.eq[_e]&&Oe.name&&u[_e][Oe.name].querySelector("button").click()}for(let _e of yn){let Oe=c[_e]||ms;Oe.name&&a[_e][Oe.name].querySelector("button").click()}setTimeout(()=>{for(let _e of yn)K.gear[_e]&&a[_e][K.gear[_e]].querySelector("button").click();G(x,o.load.ongoing=!1,o),G(x,o.load.status=null,o),qe&&(G(bt,s=K,s),G(bt,s.id=qe,s),t(8,Q=null))})}let N=[],Z=[],A,P,M=9;for(let K=0;K<M;K++)N.push(`backgrounds/BG${K}.jpg`);function U(K){P=Math.floor(Math.random()*K.length)}U(N);function X(){t(9,A=P),Z.push(P)}X(),function K(){setTimeout(()=>{if(U(N),!Z.length)X();else if(Z.length>3&&(Z=Z.slice(1)),!Z.includes(P))X();else{let qe=[...Array(M).keys()].filter(_e=>!Z.includes(_e));U(qe),X()}document.hasFocus&&K()},45e3)}();function fe(){j=setTimeout(()=>{t(7,W=!1)},750)}function ce(){clearTimeout(j),t(7,W=!0),fe()}function ee(){G(x,o.export.status=null,o),G(x,o.export.ongoing=!1,o),G(x,o.save.status=null,o),G(x,o.save.ongoing=!1,o),G(x,o.load.status=null,o),G(x,o.load.ongoing=!1,o),G(x,o.delete.status=null,o),G(x,o.delete.ongoing=!1,o),G(x,o.share.ongoing=!1,o),G(x,o.message="",o)}let z=!1;const Y=K=>{(v||r)&&K.preventDefault()},ue=K=>{if(K.key=="builds")if(K.url.includes("ls=true")){G(Tt,h=JSON.parse(K.newValue),h),G(Qt,_=Object.keys(JSON.parse(K.newValue)).length>0,_),ee();let qe=Object.keys(JSON.parse(K.oldValue)).filter(_e=>!Object.keys(JSON.parse(K.newValue)).includes(_e))[0];qe&&s&&qe==s.name&&G(bt,s=null,s)}else window.localStorage.setItem("builds",JSON.stringify(h))},Fe=K=>{let qe=K.wheelDeltaY;if(K.ctrlKey){if(K.preventDefault(),I[q]==.2&&qe<0||I[q]==5&&qe>0)return;qe>0?t(3,q++,q):t(3,q--,q),ce()}},Le=K=>{K.ctrlKey&&(K.key=="-"||K.key=="+"||K.code=="Equal"||K.key=="0")&&(K.preventDefault(),(K.key=="+"||K.code=="Equal")&&I[q]!=5?t(3,q++,q):K.key=="-"&&I[q]!=.2?t(3,q--,q):K.key=="0"&&I[q]!=1&&t(3,q=7),ce()),r&&Pp(K)};function ae(){t(0,y=cn.outerHeight),t(1,T=cn.outerWidth)}const gt=K=>{_n(K),r||G(x,o.resources.ongoing=!0,o)},ht=()=>{r||G(x,o.share.ongoing=!0,o)},ke=()=>t(10,z=!0),Ye=()=>t(10,z=!1);function de(K){Q=K,t(8,Q)}const Ie=K=>C(K.detail.build,K.detail.id),Qe=K=>{_n(K),!r&&(G(x,o.changelog.ongoing=!0,o),G(Oi,f=!0,f))};return n.$$.update=()=>{if(n.$$.dirty[0]&16777231&&(T||y)&&(t(2,R=T>y),document.documentElement.style.setProperty("--u",`${(R?.75:window.outerWidth/window.outerHeight/2)*I[q]}${CSS.supports("height: 1lvh")?"l":""}vh`),l))for(let K of l)qo(K.node,K.itemName);n.$$.dirty[0]&32&&t(11,i=o.export.status||o.save.status||o.load.status||o.delete.status),n.$$.dirty[0]&32&&G(pn,r=o.item.ongoing||o.export.ongoing||o.save.ongoing||o.load.ongoing||o.delete.ongoing||o.share.ongoing||o.costs.ongoing||o.bonus.ongoing||o.randomize.ongoing||o.resources.ongoing||o.changelog.ongoing,r),n.$$.dirty[0]&16&&(document.title=(s?s.name+" - ":"")+"Fantastic Calculator")},[y,T,R,q,s,o,k,W,Q,A,z,i,r,f,_,h,v,w,I,O,C,N,ce,ee,l,Y,ue,Fe,Le,ae,gt,ht,ke,Ye,de,Ie,Qe]}class w1 extends Me{constructor(e){super(),Pe(this,e,y1,v1,me,{},null,[-1,-1])}}new w1({target:document.body});
