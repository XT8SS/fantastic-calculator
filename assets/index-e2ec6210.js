var Fc=Object.defineProperty;var Bc=(t,e,n)=>e in t?Fc(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Bt=(t,e,n)=>(Bc(t,typeof e!="symbol"?e+"":e,n),n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&s(r)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();function se(){}const js=t=>t;function zc(t,e){for(const n in e)t[n]=e[n];return t}function Rl(t){return t()}function Mo(){return Object.create(null)}function ge(t){t.forEach(Rl)}function Rn(t){return typeof t=="function"}function pe(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}let ps;function nt(t,e){return t===e?!0:(ps||(ps=document.createElement("a")),ps.href=e,t===ps.href)}function Wc(t){return Object.keys(t).length===0}function qc(t,...e){if(t==null){for(const s of e)s(void 0);return se}const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function K(t,e,n){t.$$.on_destroy.push(qc(e,n))}function Hc(t,e,n,s){if(t){const i=Al(t,e,n,s);return t[0](i)}}function Al(t,e,n,s){return t[1]&&s?zc(n.ctx.slice(),t[1](s(e))):n.ctx}function jc(t,e,n,s){if(t[2]&&s){const i=t[2](s(n));if(e.dirty===void 0)return i;if(typeof i=="object"){const o=[],r=Math.max(e.dirty.length,i.length);for(let l=0;l<r;l+=1)o[l]=e.dirty[l]|i[l];return o}return e.dirty|i}return e.dirty}function Uc(t,e,n,s,i,o){if(i){const r=Al(e,n,s,o);t.p(r,i)}}function Vc(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let s=0;s<n;s++)e[s]=-1;return e}return-1}function G(t,e,n){return t.set(n),e}function Pl(t){return t&&Rn(t.destroy)?t.destroy:se}const Ml=typeof window<"u";let ji=Ml?()=>window.performance.now():()=>Date.now(),Ui=Ml?t=>requestAnimationFrame(t):se;const pn=new Set;function Ll(t){pn.forEach(e=>{e.c(t)||(pn.delete(e),e.f())}),pn.size!==0&&Ui(Ll)}function Vi(t){let e;return pn.size===0&&Ui(Ll),{promise:new Promise(n=>{pn.add(e={c:t,f:n})}),abort(){pn.delete(e)}}}const Gc=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function p(t,e){t.appendChild(e)}function Fl(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;return e&&e.host?e:t.ownerDocument}function Yc(t){const e=b("style");return e.textContent="/* empty */",Kc(Fl(t),e),e.sheet}function Kc(t,e){return p(t.head||t,e),e.sheet}function F(t,e,n){t.insertBefore(e,n||null)}function L(t){t.parentNode&&t.parentNode.removeChild(t)}function dt(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function b(t){return document.createElement(t)}function Qc(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function ie(t){return document.createTextNode(t)}function N(){return ie(" ")}function _t(){return ie("")}function M(t,e,n,s){return t.addEventListener(e,n,s),()=>t.removeEventListener(e,n,s)}function m(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function Ze(t,e,n){e in t?t[e]=typeof t[e]=="boolean"&&n===""?!0:n:m(t,e,n)}function Bl(t){return t===""?null:+t}function xc(t){return Array.from(t.childNodes)}function Re(t,e){e=""+e,t.data!==e&&(t.data=e)}function It(t,e){t.value=e??""}function Ge(t,e,n,s){n==null?t.style.removeProperty(e):t.style.setProperty(e,n,s?"important":"")}let ms;function Xc(){if(ms===void 0){ms=!1;try{typeof window<"u"&&window.parent&&window.parent.document}catch{ms=!0}}return ms}function Gt(t,e){getComputedStyle(t).position==="static"&&(t.style.position="relative");const s=b("iframe");s.setAttribute("style","display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;"),s.setAttribute("aria-hidden","true"),s.tabIndex=-1;const i=Xc();let o;return i?(s.src="data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}<\/script>",o=M(window,"message",r=>{r.source===s.contentWindow&&e()})):(s.src="about:blank",s.onload=()=>{o=M(s.contentWindow,"resize",e),e()}),p(t,s),()=>{(i||o&&s.contentWindow)&&o(),L(s)}}function ee(t,e,n){t.classList.toggle(e,!!n)}function zl(t,e,{bubbles:n=!1,cancelable:s=!1}={}){return new CustomEvent(t,{detail:e,bubbles:n,cancelable:s})}class Jc{constructor(e=!1){Bt(this,"is_svg",!1);Bt(this,"e");Bt(this,"n");Bt(this,"t");Bt(this,"a");this.is_svg=e,this.e=this.n=null}c(e){this.h(e)}m(e,n,s=null){this.e||(this.is_svg?this.e=Qc(n.nodeName):this.e=b(n.nodeType===11?"TEMPLATE":n.nodeName),this.t=n.tagName!=="TEMPLATE"?n:n.content,this.c(e)),this.i(s)}h(e){this.e.innerHTML=e,this.n=Array.from(this.e.nodeName==="TEMPLATE"?this.e.content.childNodes:this.e.childNodes)}i(e){for(let n=0;n<this.n.length;n+=1)F(this.t,this.n[n],e)}p(e){this.d(),this.h(e),this.i(this.a)}d(){this.n.forEach(L)}}const ys=new Map;let ws=0;function Zc(t){let e=5381,n=t.length;for(;n--;)e=(e<<5)-e^t.charCodeAt(n);return e>>>0}function $c(t,e){const n={stylesheet:Yc(e),rules:{}};return ys.set(t,n),n}function Cs(t,e,n,s,i,o,r,l=0){const a=16.666/s;let c=`{
`;for(let v=0;v<=1;v+=a){const w=e+(n-e)*o(v);c+=v*100+`%{${r(w,1-w)}}
`}const u=c+`100% {${r(n,1-n)}}
}`,f=`__svelte_${Zc(u)}_${l}`,d=Fl(t),{stylesheet:_,rules:h}=ys.get(d)||$c(d,t);h[f]||(h[f]=!0,_.insertRule(`@keyframes ${f} ${u}`,_.cssRules.length));const g=t.style.animation||"";return t.style.animation=`${g?`${g}, `:""}${f} ${s}ms linear ${i}ms 1 both`,ws+=1,f}function ks(t,e){const n=(t.style.animation||"").split(", "),s=n.filter(e?o=>o.indexOf(e)<0:o=>o.indexOf("__svelte")===-1),i=n.length-s.length;i&&(t.style.animation=s.join(", "),ws-=i,ws||eu())}function eu(){Ui(()=>{ws||(ys.forEach(t=>{const{ownerNode:e}=t.stylesheet;e&&L(e)}),ys.clear())})}let Qn;function Un(t){Qn=t}function Wl(){if(!Qn)throw new Error("Function called outside component initialization");return Qn}function tu(t){Wl().$$.on_mount.push(t)}function Dt(){const t=Wl();return(e,n,{cancelable:s=!1}={})=>{const i=t.$$.callbacks[e];if(i){const o=zl(e,n,{cancelable:s});return i.slice().forEach(r=>{r.call(t,o)}),!o.defaultPrevented}return!0}}const hn=[],te=[];let mn=[];const yi=[],nu=Promise.resolve();let wi=!1;function su(){wi||(wi=!0,nu.then(ql))}function Ee(t){mn.push(t)}function Oe(t){yi.push(t)}const li=new Set;let un=0;function ql(){if(un!==0)return;const t=Qn;do{try{for(;un<hn.length;){const e=hn[un];un++,Un(e),iu(e.$$)}}catch(e){throw hn.length=0,un=0,e}for(Un(null),hn.length=0,un=0;te.length;)te.pop()();for(let e=0;e<mn.length;e+=1){const n=mn[e];li.has(n)||(li.add(n),n())}mn.length=0}while(hn.length);for(;yi.length;)yi.pop()();wi=!1,li.clear(),Un(t)}function iu(t){if(t.fragment!==null){t.update(),ge(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Ee)}}function ou(t){const e=[],n=[];mn.forEach(s=>t.indexOf(s)===-1?e.push(s):n.push(s)),n.forEach(s=>s()),mn=e}let Bn;function Gi(){return Bn||(Bn=Promise.resolve(),Bn.then(()=>{Bn=null})),Bn}function nn(t,e,n){t.dispatchEvent(zl(`${e?"intro":"outro"}${n}`))}const vs=new Set;let Tt;function We(){Tt={r:0,c:[],p:Tt}}function qe(){Tt.r||ge(Tt.c),Tt=Tt.p}function B(t,e){t&&t.i&&(vs.delete(t),t.i(e))}function U(t,e,n,s){if(t&&t.o){if(vs.has(t))return;vs.add(t),Tt.c.push(()=>{vs.delete(t),s&&(n&&t.d(1),s())}),t.o(e)}else s&&s()}const Yi={duration:0};function Hl(t,e,n){const s={direction:"in"};let i=e(t,n,s),o=!1,r,l,a=0;function c(){r&&ks(t,r)}function u(){const{delay:d=0,duration:_=300,easing:h=js,tick:g=se,css:v}=i||Yi;v&&(r=Cs(t,0,1,_,d,h,v,a++)),g(0,1);const w=ji()+d,C=w+_;l&&l.abort(),o=!0,Ee(()=>nn(t,!0,"start")),l=Vi(y=>{if(o){if(y>=C)return g(1,0),nn(t,!0,"end"),c(),o=!1;if(y>=w){const E=h((y-w)/_);g(E,1-E)}}return o})}let f=!1;return{start(){f||(f=!0,ks(t),Rn(i)?(i=i(s),Gi().then(u)):u())},invalidate(){f=!1},end(){o&&(c(),o=!1)}}}function jl(t,e,n){const s={direction:"out"};let i=e(t,n,s),o=!0,r;const l=Tt;l.r+=1;let a;function c(){const{delay:u=0,duration:f=300,easing:d=js,tick:_=se,css:h}=i||Yi;h&&(r=Cs(t,1,0,f,u,d,h));const g=ji()+u,v=g+f;Ee(()=>nn(t,!1,"start")),"inert"in t&&(a=t.inert,t.inert=!0),Vi(w=>{if(o){if(w>=v)return _(0,1),nn(t,!1,"end"),--l.r||ge(l.c),!1;if(w>=g){const C=d((w-g)/f);_(1-C,C)}}return o})}return Rn(i)?Gi().then(()=>{i=i(s),c()}):c(),{end(u){u&&"inert"in t&&(t.inert=a),u&&i.tick&&i.tick(1,0),o&&(r&&ks(t,r),o=!1)}}}function Ie(t,e,n,s){let o=e(t,n,{direction:"both"}),r=s?0:1,l=null,a=null,c=null,u;function f(){c&&ks(t,c)}function d(h,g){const v=h.b-r;return g*=Math.abs(v),{a:r,b:h.b,d:v,duration:g,start:h.start,end:h.start+g,group:h.group}}function _(h){const{delay:g=0,duration:v=300,easing:w=js,tick:C=se,css:y}=o||Yi,E={start:ji()+g,b:h};h||(E.group=Tt,Tt.r+=1),"inert"in t&&(h?u!==void 0&&(t.inert=u):(u=t.inert,t.inert=!0)),l||a?a=E:(y&&(f(),c=Cs(t,r,h,v,g,w,y)),h&&C(0,1),l=d(E,v),Ee(()=>nn(t,h,"start")),Vi(A=>{if(a&&A>a.start&&(l=d(a,v),a=null,nn(t,l.b,"start"),y&&(f(),c=Cs(t,r,l.b,l.duration,0,w,o.css))),l){if(A>=l.end)C(r=l.b,1-r),nn(t,l.b,"end"),a||(l.b?f():--l.group.r||ge(l.group.c)),l=null;else if(A>=l.start){const O=A-l.start;r=l.a+l.d*w(O/l.duration),C(r,1-r)}}return!!(l||a)}))}return{run(h){Rn(o)?Gi().then(()=>{o=o({direction:h?"in":"out"}),_(h)}):_(h)},end(){f(),l=a=null}}}function Pe(t){return(t==null?void 0:t.length)!==void 0?t:Array.from(t)}function De(t,e,n){const s=t.$$.props[e];s!==void 0&&(t.$$.bound[s]=n,n(t.$$.ctx[s]))}function ae(t){t&&t.c()}function oe(t,e,n){const{fragment:s,after_update:i}=t.$$;s&&s.m(e,n),Ee(()=>{const o=t.$$.on_mount.map(Rl).filter(Rn);t.$$.on_destroy?t.$$.on_destroy.push(...o):ge(o),t.$$.on_mount=[]}),i.forEach(Ee)}function re(t,e){const n=t.$$;n.fragment!==null&&(ou(n.after_update),ge(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function ru(t,e){t.$$.dirty[0]===-1&&(hn.push(t),su(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function Te(t,e,n,s,i,o,r=null,l=[-1]){const a=Qn;Un(t);const c=t.$$={fragment:null,ctx:[],props:o,update:se,not_equal:i,bound:Mo(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(a?a.$$.context:[])),callbacks:Mo(),dirty:l,skip_bound:!1,root:e.target||a.$$.root};r&&r(c.root);let u=!1;if(c.ctx=n?n(t,e.props||{},(f,d,..._)=>{const h=_.length?_[0]:d;return c.ctx&&i(c.ctx[f],c.ctx[f]=h)&&(!c.skip_bound&&c.bound[f]&&c.bound[f](h),u&&ru(t,f)),d}):[],c.update(),u=!0,ge(c.before_update),c.fragment=s?s(c.ctx):!1,e.target){if(e.hydrate){const f=xc(e.target);c.fragment&&c.fragment.l(f),f.forEach(L)}else c.fragment&&c.fragment.c();e.intro&&B(t.$$.fragment),oe(t,e.target,e.anchor),ql()}Un(a)}class Ne{constructor(){Bt(this,"$$");Bt(this,"$$set")}$destroy(){re(this,1),this.$destroy=se}$on(e,n){if(!Rn(n))return se;const s=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return s.push(n),()=>{const i=s.indexOf(n);i!==-1&&s.splice(i,1)}}$set(e){this.$$set&&!Wc(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const lu="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(lu);const dn=[];function $e(t,e=se){let n;const s=new Set;function i(l){if(pe(t,l)&&(t=l,n)){const a=!dn.length;for(const c of s)c[1](),dn.push(c,t);if(a){for(let c=0;c<dn.length;c+=2)dn[c][0](dn[c+1]);dn.length=0}}}function o(l){i(l(t))}function r(l,a=se){const c=[l,a];return s.add(c),s.size===1&&(n=e(i,o)||se),l(t),()=>{s.delete(c),s.size===0&&n&&(n(),n=null)}}return{set:i,update:o,subscribe:r}}let Lo=localStorage.getItem("builds"),Fo=0,Ct=$e({}),kt=$e({}),lt=$e({armor:0,magicDmg:0,meleeDmg:0,rangedDmg:0,hpRegen:0,endurance:0,sightRange:0,walkSpeed:0,jumpPower:0,ammoReturn:0,height:0}),Nt=$e({}),Ki=$e([]),ai=$e({}),at=$e(),Qi=$e(!1),gt=$e(Lo?JSON.parse(Lo):{}),zt=$e(!1),Cn=$e(!1),kn=$e({}),En=$e({}),au=$e({}),gn=$e({}),zn=$e({parasol:!0,armor:!0,gear:!0,basic:!0}),$=$e({export:{ongoing:!1,status:null},save:{ongoing:!1,status:null},load:{ongoing:!1,status:null},delete:{ongoing:!1,status:null},share:{ongoing:!1},costs:{ongoing:!1},bonus:{ongoing:!1},screenshot:{ongoing:!1},randomize:{ongoing:!1},resources:{ongoing:!1},changelog:{ongoing:!1},message:""});gt.subscribe(t=>{Fo++,setTimeout(()=>{window.localStorage.setItem("builds",JSON.stringify(t)),Fo>1&&window.history.replaceState(null,null,location.origin+location.pathname)})});/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ul={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x=function(t,e){if(!t)throw An(e)},An=function(t){return new Error("Firebase Database ("+Ul.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vl=function(t){const e=[];let n=0;for(let s=0;s<t.length;s++){let i=t.charCodeAt(s);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&s+1<t.length&&(t.charCodeAt(s+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++s)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},cu=function(t){const e=[];let n=0,s=0;for(;n<t.length;){const i=t[n++];if(i<128)e[s++]=String.fromCharCode(i);else if(i>191&&i<224){const o=t[n++];e[s++]=String.fromCharCode((i&31)<<6|o&63)}else if(i>239&&i<365){const o=t[n++],r=t[n++],l=t[n++],a=((i&7)<<18|(o&63)<<12|(r&63)<<6|l&63)-65536;e[s++]=String.fromCharCode(55296+(a>>10)),e[s++]=String.fromCharCode(56320+(a&1023))}else{const o=t[n++],r=t[n++];e[s++]=String.fromCharCode((i&15)<<12|(o&63)<<6|r&63)}}return e.join("")},xi={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let i=0;i<t.length;i+=3){const o=t[i],r=i+1<t.length,l=r?t[i+1]:0,a=i+2<t.length,c=a?t[i+2]:0,u=o>>2,f=(o&3)<<4|l>>4;let d=(l&15)<<2|c>>6,_=c&63;a||(_=64,r||(d=64)),s.push(n[u],n[f],n[d],n[_])}return s.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Vl(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):cu(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let i=0;i<t.length;){const o=n[t.charAt(i++)],l=i<t.length?n[t.charAt(i)]:0;++i;const c=i<t.length?n[t.charAt(i)]:64;++i;const f=i<t.length?n[t.charAt(i)]:64;if(++i,o==null||l==null||c==null||f==null)throw new uu;const d=o<<2|l>>4;if(s.push(d),c!==64){const _=l<<4&240|c>>2;if(s.push(_),f!==64){const h=c<<6&192|f;s.push(h)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class uu extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Gl=function(t){const e=Vl(t);return xi.encodeByteArray(e,!0)},Es=function(t){return Gl(t).replace(/\./g,"")},Ci=function(t){try{return xi.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function du(t){return Yl(void 0,t)}function Yl(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(const n in e)!e.hasOwnProperty(n)||!fu(n)||(t[n]=Yl(t[n],e[n]));return t}function fu(t){return t!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hu(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _u=()=>hu().__FIREBASE_DEFAULTS__,pu=()=>{if(typeof process>"u"||typeof process.env>"u")return;const t={}.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},mu=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&Ci(t[1]);return e&&JSON.parse(e)},Kl=()=>{try{return _u()||pu()||mu()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},gu=t=>{var e,n;return(n=(e=Kl())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},bu=t=>{const e=gu(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const s=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),s]:[e.substring(0,n),s]},Ql=()=>{var t;return(t=Kl())===null||t===void 0?void 0:t.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Us{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,s)=>{n?this.reject(n):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,s))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vu(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},s=e||"demo-project",i=t.iat||0,o=t.sub||t.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const r=Object.assign({iss:`https://securetoken.google.com/${s}`,aud:s,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},t),l="";return[Es(JSON.stringify(n)),Es(JSON.stringify(r)),l].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yu(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function xl(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(yu())}function wu(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Xl(){return Ul.NODE_ADMIN===!0}function Cu(){try{return typeof indexedDB=="object"}catch{return!1}}function ku(){return new Promise((t,e)=>{try{let n=!0;const s="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(s);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(s),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var o;e(((o=i.error)===null||o===void 0?void 0:o.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Eu="FirebaseError";class as extends Error{constructor(e,n,s){super(n),this.code=e,this.customData=s,this.name=Eu,Object.setPrototypeOf(this,as.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Jl.prototype.create)}}class Jl{constructor(e,n,s){this.service=e,this.serviceName=n,this.errors=s}create(e,...n){const s=n[0]||{},i=`${this.service}/${e}`,o=this.errors[e],r=o?Su(o,s):"Error",l=`${this.serviceName}: ${r} (${i}).`;return new as(i,l,s)}}function Su(t,e){return t.replace(Iu,(n,s)=>{const i=e[s];return i!=null?String(i):`<${s}?>`})}const Iu=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xn(t){return JSON.parse(t)}function Ke(t){return JSON.stringify(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zl=function(t){let e={},n={},s={},i="";try{const o=t.split(".");e=xn(Ci(o[0])||""),n=xn(Ci(o[1])||""),i=o[2],s=n.d||{},delete n.d}catch{}return{header:e,claims:n,data:s,signature:i}},Tu=function(t){const e=Zl(t),n=e.claims;return!!n&&typeof n=="object"&&n.hasOwnProperty("iat")},Nu=function(t){const e=Zl(t).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Sn(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}function Bo(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Ss(t,e,n){const s={};for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&(s[i]=e.call(n,t[i],i,t));return s}function ki(t,e){if(t===e)return!0;const n=Object.keys(t),s=Object.keys(e);for(const i of n){if(!s.includes(i))return!1;const o=t[i],r=e[i];if(zo(o)&&zo(r)){if(!ki(o,r))return!1}else if(o!==r)return!1}for(const i of s)if(!n.includes(i))return!1;return!0}function zo(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ou(t){const e=[];for(const[n,s]of Object.entries(t))Array.isArray(s)?s.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(s));return e.length?"&"+e.join("&"):""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Du{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,n){n||(n=0);const s=this.W_;if(typeof e=="string")for(let f=0;f<16;f++)s[f]=e.charCodeAt(n)<<24|e.charCodeAt(n+1)<<16|e.charCodeAt(n+2)<<8|e.charCodeAt(n+3),n+=4;else for(let f=0;f<16;f++)s[f]=e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3],n+=4;for(let f=16;f<80;f++){const d=s[f-3]^s[f-8]^s[f-14]^s[f-16];s[f]=(d<<1|d>>>31)&4294967295}let i=this.chain_[0],o=this.chain_[1],r=this.chain_[2],l=this.chain_[3],a=this.chain_[4],c,u;for(let f=0;f<80;f++){f<40?f<20?(c=l^o&(r^l),u=1518500249):(c=o^r^l,u=1859775393):f<60?(c=o&r|l&(o|r),u=2400959708):(c=o^r^l,u=3395469782);const d=(i<<5|i>>>27)+c+a+u+s[f]&4294967295;a=l,l=r,r=(o<<30|o>>>2)&4294967295,o=i,i=d}this.chain_[0]=this.chain_[0]+i&4294967295,this.chain_[1]=this.chain_[1]+o&4294967295,this.chain_[2]=this.chain_[2]+r&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+a&4294967295}update(e,n){if(e==null)return;n===void 0&&(n=e.length);const s=n-this.blockSize;let i=0;const o=this.buf_;let r=this.inbuf_;for(;i<n;){if(r===0)for(;i<=s;)this.compress_(e,i),i+=this.blockSize;if(typeof e=="string"){for(;i<n;)if(o[r]=e.charCodeAt(i),++r,++i,r===this.blockSize){this.compress_(o),r=0;break}}else for(;i<n;)if(o[r]=e[i],++r,++i,r===this.blockSize){this.compress_(o),r=0;break}}this.inbuf_=r,this.total_+=n}digest(){const e=[];let n=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let i=this.blockSize-1;i>=56;i--)this.buf_[i]=n&255,n/=256;this.compress_(this.buf_);let s=0;for(let i=0;i<5;i++)for(let o=24;o>=0;o-=8)e[s]=this.chain_[i]>>o&255,++s;return e}}function Xi(t,e){return`${t} failed: ${e} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ru=function(t){const e=[];let n=0;for(let s=0;s<t.length;s++){let i=t.charCodeAt(s);if(i>=55296&&i<=56319){const o=i-55296;s++,x(s<t.length,"Surrogate pair missing trail surrogate.");const r=t.charCodeAt(s)-56320;i=65536+(o<<10)+r}i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):i<65536?(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},Vs=function(t){let e=0;for(let n=0;n<t.length;n++){const s=t.charCodeAt(n);s<128?e++:s<2048?e+=2:s>=55296&&s<=56319?(e+=4,n++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xt(t){return t&&t._delegate?t._delegate:t}class Xn{constructor(e,n,s){this.name=e,this.instanceFactory=n,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jt="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Au{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const s=new Us;if(this.instancesDeferred.set(n,s),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&s.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const s=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(s)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:s})}catch(o){if(i)return null;throw o}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Mu(e))try{this.getOrInitializeService({instanceIdentifier:Jt})}catch{}for(const[n,s]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const o=this.getOrInitializeService({instanceIdentifier:i});s.resolve(o)}catch{}}}}clearInstance(e=Jt){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Jt){return this.instances.has(e)}getOptions(e=Jt){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:s,options:n});for(const[o,r]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(o);s===l&&r.resolve(i)}return i}onInit(e,n){var s;const i=this.normalizeInstanceIdentifier(n),o=(s=this.onInitCallbacks.get(i))!==null&&s!==void 0?s:new Set;o.add(e),this.onInitCallbacks.set(i,o);const r=this.instances.get(i);return r&&e(r,i),()=>{o.delete(e)}}invokeOnInitCallbacks(e,n){const s=this.onInitCallbacks.get(n);if(s)for(const i of s)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:Pu(e),options:n}),this.instances.set(e,s),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=Jt){return this.component?this.component.multipleInstances?e:Jt:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Pu(t){return t===Jt?void 0:t}function Mu(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lu{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new Au(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Fe;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Fe||(Fe={}));const Fu={debug:Fe.DEBUG,verbose:Fe.VERBOSE,info:Fe.INFO,warn:Fe.WARN,error:Fe.ERROR,silent:Fe.SILENT},Bu=Fe.INFO,zu={[Fe.DEBUG]:"log",[Fe.VERBOSE]:"log",[Fe.INFO]:"info",[Fe.WARN]:"warn",[Fe.ERROR]:"error"},Wu=(t,e,...n)=>{if(e<t.logLevel)return;const s=new Date().toISOString(),i=zu[e];if(i)console[i](`[${s}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class $l{constructor(e){this.name=e,this._logLevel=Bu,this._logHandler=Wu,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Fe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Fu[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Fe.DEBUG,...e),this._logHandler(this,Fe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Fe.VERBOSE,...e),this._logHandler(this,Fe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Fe.INFO,...e),this._logHandler(this,Fe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Fe.WARN,...e),this._logHandler(this,Fe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Fe.ERROR,...e),this._logHandler(this,Fe.ERROR,...e)}}const qu=(t,e)=>e.some(n=>t instanceof n);let Wo,qo;function Hu(){return Wo||(Wo=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function ju(){return qo||(qo=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const ea=new WeakMap,Ei=new WeakMap,ta=new WeakMap,ci=new WeakMap,Ji=new WeakMap;function Uu(t){const e=new Promise((n,s)=>{const i=()=>{t.removeEventListener("success",o),t.removeEventListener("error",r)},o=()=>{n(Wt(t.result)),i()},r=()=>{s(t.error),i()};t.addEventListener("success",o),t.addEventListener("error",r)});return e.then(n=>{n instanceof IDBCursor&&ea.set(n,t)}).catch(()=>{}),Ji.set(e,t),e}function Vu(t){if(Ei.has(t))return;const e=new Promise((n,s)=>{const i=()=>{t.removeEventListener("complete",o),t.removeEventListener("error",r),t.removeEventListener("abort",r)},o=()=>{n(),i()},r=()=>{s(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",o),t.addEventListener("error",r),t.addEventListener("abort",r)});Ei.set(t,e)}let Si={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Ei.get(t);if(e==="objectStoreNames")return t.objectStoreNames||ta.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Wt(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function Gu(t){Si=t(Si)}function Yu(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const s=t.call(ui(this),e,...n);return ta.set(s,e.sort?e.sort():[e]),Wt(s)}:ju().includes(t)?function(...e){return t.apply(ui(this),e),Wt(ea.get(this))}:function(...e){return Wt(t.apply(ui(this),e))}}function Ku(t){return typeof t=="function"?Yu(t):(t instanceof IDBTransaction&&Vu(t),qu(t,Hu())?new Proxy(t,Si):t)}function Wt(t){if(t instanceof IDBRequest)return Uu(t);if(ci.has(t))return ci.get(t);const e=Ku(t);return e!==t&&(ci.set(t,e),Ji.set(e,t)),e}const ui=t=>Ji.get(t);function Qu(t,e,{blocked:n,upgrade:s,blocking:i,terminated:o}={}){const r=indexedDB.open(t,e),l=Wt(r);return s&&r.addEventListener("upgradeneeded",a=>{s(Wt(r.result),a.oldVersion,a.newVersion,Wt(r.transaction),a)}),n&&r.addEventListener("blocked",a=>n(a.oldVersion,a.newVersion,a)),l.then(a=>{o&&a.addEventListener("close",()=>o()),i&&a.addEventListener("versionchange",c=>i(c.oldVersion,c.newVersion,c))}).catch(()=>{}),l}const xu=["get","getKey","getAll","getAllKeys","count"],Xu=["put","add","delete","clear"],di=new Map;function Ho(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(di.get(e))return di.get(e);const n=e.replace(/FromIndex$/,""),s=e!==n,i=Xu.includes(n);if(!(n in(s?IDBIndex:IDBObjectStore).prototype)||!(i||xu.includes(n)))return;const o=async function(r,...l){const a=this.transaction(r,i?"readwrite":"readonly");let c=a.store;return s&&(c=c.index(l.shift())),(await Promise.all([c[n](...l),i&&a.done]))[0]};return di.set(e,o),o}Gu(t=>({...t,get:(e,n,s)=>Ho(e,n)||t.get(e,n,s),has:(e,n)=>!!Ho(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ju{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(Zu(n)){const s=n.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(n=>n).join(" ")}}function Zu(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Ii="@firebase/app",jo="0.9.23";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const on=new $l("@firebase/app"),$u="@firebase/app-compat",ed="@firebase/analytics-compat",td="@firebase/analytics",nd="@firebase/app-check-compat",sd="@firebase/app-check",id="@firebase/auth",od="@firebase/auth-compat",rd="@firebase/database",ld="@firebase/database-compat",ad="@firebase/functions",cd="@firebase/functions-compat",ud="@firebase/installations",dd="@firebase/installations-compat",fd="@firebase/messaging",hd="@firebase/messaging-compat",_d="@firebase/performance",pd="@firebase/performance-compat",md="@firebase/remote-config",gd="@firebase/remote-config-compat",bd="@firebase/storage",vd="@firebase/storage-compat",yd="@firebase/firestore",wd="@firebase/firestore-compat",Cd="firebase",kd="10.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ti="[DEFAULT]",Ed={[Ii]:"fire-core",[$u]:"fire-core-compat",[td]:"fire-analytics",[ed]:"fire-analytics-compat",[sd]:"fire-app-check",[nd]:"fire-app-check-compat",[id]:"fire-auth",[od]:"fire-auth-compat",[rd]:"fire-rtdb",[ld]:"fire-rtdb-compat",[ad]:"fire-fn",[cd]:"fire-fn-compat",[ud]:"fire-iid",[dd]:"fire-iid-compat",[fd]:"fire-fcm",[hd]:"fire-fcm-compat",[_d]:"fire-perf",[pd]:"fire-perf-compat",[md]:"fire-rc",[gd]:"fire-rc-compat",[bd]:"fire-gcs",[vd]:"fire-gcs-compat",[yd]:"fire-fst",[wd]:"fire-fst-compat","fire-js":"fire-js",[Cd]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Is=new Map,Ni=new Map;function Sd(t,e){try{t.container.addComponent(e)}catch(n){on.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Ts(t){const e=t.name;if(Ni.has(e))return on.debug(`There were multiple attempts to register component ${e}.`),!1;Ni.set(e,t);for(const n of Is.values())Sd(n,t);return!0}function Id(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Td={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},qt=new Jl("app","Firebase",Td);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nd{constructor(e,n,s){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new Xn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw qt.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Od=kd;function na(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const s=Object.assign({name:Ti,automaticDataCollectionEnabled:!1},e),i=s.name;if(typeof i!="string"||!i)throw qt.create("bad-app-name",{appName:String(i)});if(n||(n=Ql()),!n)throw qt.create("no-options");const o=Is.get(i);if(o){if(ki(n,o.options)&&ki(s,o.config))return o;throw qt.create("duplicate-app",{appName:i})}const r=new Lu(i);for(const a of Ni.values())r.addComponent(a);const l=new Nd(n,s,r);return Is.set(i,l),l}function Dd(t=Ti){const e=Is.get(t);if(!e&&t===Ti&&Ql())return na();if(!e)throw qt.create("no-app",{appName:t});return e}function bn(t,e,n){var s;let i=(s=Ed[t])!==null&&s!==void 0?s:t;n&&(i+=`-${n}`);const o=i.match(/\s|\//),r=e.match(/\s|\//);if(o||r){const l=[`Unable to register library "${i}" with version "${e}":`];o&&l.push(`library name "${i}" contains illegal characters (whitespace or "/")`),o&&r&&l.push("and"),r&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),on.warn(l.join(" "));return}Ts(new Xn(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rd="firebase-heartbeat-database",Ad=1,Jn="firebase-heartbeat-store";let fi=null;function sa(){return fi||(fi=Qu(Rd,Ad,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Jn)}}}).catch(t=>{throw qt.create("idb-open",{originalErrorMessage:t.message})})),fi}async function Pd(t){try{return await(await sa()).transaction(Jn).objectStore(Jn).get(ia(t))}catch(e){if(e instanceof as)on.warn(e.message);else{const n=qt.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});on.warn(n.message)}}}async function Uo(t,e){try{const s=(await sa()).transaction(Jn,"readwrite");await s.objectStore(Jn).put(e,ia(t)),await s.done}catch(n){if(n instanceof as)on.warn(n.message);else{const s=qt.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});on.warn(s.message)}}}function ia(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Md=1024,Ld=30*24*60*60*1e3;class Fd{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new zd(n),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){var e;const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Vo();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i)))return this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const r=new Date(o.date).valueOf();return Date.now()-r<=Ld}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var e;if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Vo(),{heartbeatsToSend:s,unsentEntries:i}=Bd(this._heartbeatsCache.heartbeats),o=Es(JSON.stringify({version:2,heartbeats:s}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}}function Vo(){return new Date().toISOString().substring(0,10)}function Bd(t,e=Md){const n=[];let s=t.slice();for(const i of t){const o=n.find(r=>r.agent===i.agent);if(o){if(o.dates.push(i.date),Go(n)>e){o.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),Go(n)>e){n.pop();break}s=s.slice(1)}return{heartbeatsToSend:n,unsentEntries:s}}class zd{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Cu()?ku().then(()=>!0).catch(()=>!1):!1}async read(){return await this._canUseIndexedDBPromise?await Pd(this.app)||{heartbeats:[]}:{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return Uo(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return Uo(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function Go(t){return Es(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wd(t){Ts(new Xn("platform-logger",e=>new Ju(e),"PRIVATE")),Ts(new Xn("heartbeat",e=>new Fd(e),"PRIVATE")),bn(Ii,jo,t),bn(Ii,jo,"esm2017"),bn("fire-js","")}Wd("");var qd="firebase",Hd="10.6.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */bn(qd,Hd,"app");const Yo="@firebase/database",Ko="1.0.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let oa="";function jd(t){oa=t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ud{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Ke(n))}get(e){const n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:xn(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vd{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return Rt(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ra=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){const e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new Ud(e)}}catch{}return new Vd},en=ra("localStorage"),Oi=ra("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vn=new $l("@firebase/database"),Gd=function(){let t=1;return function(){return t++}}(),la=function(t){const e=Ru(t),n=new Du;n.update(e);const s=n.digest();return xi.encodeByteArray(s)},cs=function(...t){let e="";for(let n=0;n<t.length;n++){const s=t[n];Array.isArray(s)||s&&typeof s=="object"&&typeof s.length=="number"?e+=cs.apply(null,s):typeof s=="object"?e+=Ke(s):e+=s,e+=" "}return e};let sn=null,Qo=!0;const Yd=function(t,e){x(!e||t===!0||t===!1,"Can't turn on custom loggers persistently."),t===!0?(vn.logLevel=Fe.VERBOSE,sn=vn.log.bind(vn),e&&Oi.set("logging_enabled",!0)):typeof t=="function"?sn=t:(sn=null,Oi.remove("logging_enabled"))},tt=function(...t){if(Qo===!0&&(Qo=!1,sn===null&&Oi.get("logging_enabled")===!0&&Yd(!0)),sn){const e=cs.apply(null,t);sn(e)}},us=function(t){return function(...e){tt(t,...e)}},Di=function(...t){const e="FIREBASE INTERNAL ERROR: "+cs(...t);vn.error(e)},Mt=function(...t){const e=`FIREBASE FATAL ERROR: ${cs(...t)}`;throw vn.error(e),new Error(e)},ut=function(...t){const e="FIREBASE WARNING: "+cs(...t);vn.warn(e)},Kd=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&ut("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},Zi=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},Qd=function(t){if(document.readyState==="complete")t();else{let e=!1;const n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},rn="[MIN_NAME]",Yt="[MAX_NAME]",Pn=function(t,e){if(t===e)return 0;if(t===rn||e===Yt)return-1;if(e===rn||t===Yt)return 1;{const n=xo(t),s=xo(e);return n!==null?s!==null?n-s===0?t.length-e.length:n-s:-1:s!==null?1:t<e?-1:1}},xd=function(t,e){return t===e?0:t<e?-1:1},Wn=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+Ke(e))},$i=function(t){if(typeof t!="object"||t===null)return Ke(t);const e=[];for(const s in t)e.push(s);e.sort();let n="{";for(let s=0;s<e.length;s++)s!==0&&(n+=","),n+=Ke(e[s]),n+=":",n+=$i(t[e[s]]);return n+="}",n},aa=function(t,e){const n=t.length;if(n<=e)return[t];const s=[];for(let i=0;i<n;i+=e)i+e>n?s.push(t.substring(i,n)):s.push(t.substring(i,i+e));return s};function ft(t,e){for(const n in t)t.hasOwnProperty(n)&&e(n,t[n])}const ca=function(t){x(!Zi(t),"Invalid JSON number");const e=11,n=52,s=(1<<e-1)-1;let i,o,r,l,a;t===0?(o=0,r=0,i=1/t===-1/0?1:0):(i=t<0,t=Math.abs(t),t>=Math.pow(2,1-s)?(l=Math.min(Math.floor(Math.log(t)/Math.LN2),s),o=l+s,r=Math.round(t*Math.pow(2,n-l)-Math.pow(2,n))):(o=0,r=Math.round(t/Math.pow(2,1-s-n))));const c=[];for(a=n;a;a-=1)c.push(r%2?1:0),r=Math.floor(r/2);for(a=e;a;a-=1)c.push(o%2?1:0),o=Math.floor(o/2);c.push(i?1:0),c.reverse();const u=c.join("");let f="";for(a=0;a<64;a+=8){let d=parseInt(u.substr(a,8),2).toString(16);d.length===1&&(d="0"+d),f=f+d}return f.toLowerCase()},Xd=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},Jd=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function Zd(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");const s=new Error(t+" at "+e._path.toString()+": "+n);return s.code=t.toUpperCase(),s}const $d=new RegExp("^-?(0*)\\d{1,10}$"),ef=-2147483648,tf=2147483647,xo=function(t){if($d.test(t)){const e=Number(t);if(e>=ef&&e<=tf)return e}return null},Mn=function(t){try{t()}catch(e){setTimeout(()=>{const n=e.stack||"";throw ut("Exception was thrown by user callback.",n),e},Math.floor(0))}},nf=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Vn=function(t,e){const n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sf{constructor(e,n){this.appName_=e,this.appCheckProvider=n,this.appCheck=n==null?void 0:n.getImmediate({optional:!0}),this.appCheck||n==null||n.get().then(s=>this.appCheck=s)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((n,s)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,s):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)===null||n===void 0||n.get().then(s=>s.addTokenListener(e))}notifyForInvalidToken(){ut(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class of{constructor(e,n,s){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=s,this.auth_=null,this.auth_=s.getImmediate({optional:!0}),this.auth_||s.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(tt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,s)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,s):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',ut(e)}}class yn{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}yn.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eo="5",ua="v",da="s",fa="r",ha="f",_a=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,pa="ls",ma="p",Ri="ac",ga="websocket",ba="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class va{constructor(e,n,s,i,o=!1,r="",l=!1,a=!1){this.secure=n,this.namespace=s,this.webSocketOnly=i,this.nodeAdmin=o,this.persistenceKey=r,this.includeNamespaceInQueryParams=l,this.isUsingEmulator=a,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=en.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&en.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}}function rf(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function ya(t,e,n){x(typeof e=="string","typeof type must == string"),x(typeof n=="object","typeof params must == object");let s;if(e===ga)s=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===ba)s=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);rf(t)&&(n.ns=t.namespace);const i=[];return ft(n,(o,r)=>{i.push(o+"="+r)}),s+i.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lf{constructor(){this.counters_={}}incrementCounter(e,n=1){Rt(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return du(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hi={},_i={};function to(t){const e=t.toString();return hi[e]||(hi[e]=new lf),hi[e]}function af(t,e){const n=t.toString();return _i[n]||(_i[n]=e()),_i[n]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cf{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){const s=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<s.length;++i)s[i]&&Mn(()=>{this.onMessage_(s[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xo="start",uf="close",df="pLPCommand",ff="pRTLPCB",wa="id",Ca="pw",ka="ser",hf="cb",_f="seg",pf="ts",mf="d",gf="dframe",Ea=1870,Sa=30,bf=Ea-Sa,vf=25e3,yf=3e4;class _n{constructor(e,n,s,i,o,r,l){this.connId=e,this.repoInfo=n,this.applicationId=s,this.appCheckToken=i,this.authToken=o,this.transportSessionId=r,this.lastSessionId=l,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=us(e),this.stats_=to(n),this.urlFn=a=>(this.appCheckToken&&(a[Ri]=this.appCheckToken),ya(n,ba,a))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new cf(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(yf)),Qd(()=>{if(this.isClosed_)return;this.scriptTagHolder=new no((...o)=>{const[r,l,a,c,u]=o;if(this.incrementIncomingBytes_(o),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,r===Xo)this.id=l,this.password=a;else if(r===uf)l?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(l,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+r)},(...o)=>{const[r,l]=o;this.incrementIncomingBytes_(o),this.myPacketOrderer.handleResponse(r,l)},()=>{this.onClosed_()},this.urlFn);const s={};s[Xo]="t",s[ka]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(s[hf]=this.scriptTagHolder.uniqueCallbackIdentifier),s[ua]=eo,this.transportSessionId&&(s[da]=this.transportSessionId),this.lastSessionId&&(s[pa]=this.lastSessionId),this.applicationId&&(s[ma]=this.applicationId),this.appCheckToken&&(s[Ri]=this.appCheckToken),typeof location<"u"&&location.hostname&&_a.test(location.hostname)&&(s[fa]=ha);const i=this.urlFn(s);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){_n.forceAllow_=!0}static forceDisallow(){_n.forceDisallow_=!0}static isAvailable(){return _n.forceAllow_?!0:!_n.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!Xd()&&!Jd()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const n=Ke(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const s=Gl(n),i=aa(s,bf);for(let o=0;o<i.length;o++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[o]),this.curSegmentNum++}addDisconnectPingFrame(e,n){this.myDisconnFrame=document.createElement("iframe");const s={};s[gf]="t",s[wa]=e,s[Ca]=n,this.myDisconnFrame.src=this.urlFn(s),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const n=Ke(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}}class no{constructor(e,n,s,i){this.onDisconnect=s,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=Gd(),window[df+this.uniqueCallbackIdentifier]=e,window[ff+this.uniqueCallbackIdentifier]=n,this.myIFrame=no.createIFrame_();let o="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(o='<script>document.domain="'+document.domain+'";<\/script>');const r="<html><body>"+o+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(r),this.myIFrame.doc.close()}catch(l){tt("frame writing exception"),l.stack&&tt(l.stack),tt(l)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||tt("No IE domain setting required")}catch{const s=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+s+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[wa]=this.myID,e[Ca]=this.myPW,e[ka]=this.currentSerial;let n=this.urlFn(e),s="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+Sa+s.length<=Ea;){const r=this.pendingSegs.shift();s=s+"&"+_f+i+"="+r.seg+"&"+pf+i+"="+r.ts+"&"+mf+i+"="+r.d,i++}return n=n+s,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,s){this.pendingSegs.push({seg:e,ts:n,d:s}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);const s=()=>{this.outstandingRequests.delete(n),this.newRequest_()},i=setTimeout(s,Math.floor(vf)),o=()=>{clearTimeout(i),s()};this.addTag(e,o)}addTag(e,n){setTimeout(()=>{try{if(!this.sendNewPolls)return;const s=this.myIFrame.doc.createElement("script");s.type="text/javascript",s.async=!0,s.src=e,s.onload=s.onreadystatechange=function(){const i=s.readyState;(!i||i==="loaded"||i==="complete")&&(s.onload=s.onreadystatechange=null,s.parentNode&&s.parentNode.removeChild(s),n())},s.onerror=()=>{tt("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(s)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wf=16384,Cf=45e3;let Ns=null;typeof MozWebSocket<"u"?Ns=MozWebSocket:typeof WebSocket<"u"&&(Ns=WebSocket);class bt{constructor(e,n,s,i,o,r,l){this.connId=e,this.applicationId=s,this.appCheckToken=i,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=us(this.connId),this.stats_=to(n),this.connURL=bt.connectionURL_(n,r,l,i,s),this.nodeAdmin=n.nodeAdmin}static connectionURL_(e,n,s,i,o){const r={};return r[ua]=eo,typeof location<"u"&&location.hostname&&_a.test(location.hostname)&&(r[fa]=ha),n&&(r[da]=n),s&&(r[pa]=s),i&&(r[Ri]=i),o&&(r[ma]=o),ya(e,ga,r)}open(e,n){this.onDisconnect=n,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,en.set("previous_websocket_failure",!0);try{let s;Xl(),this.mySock=new Ns(this.connURL,[],s)}catch(s){this.log_("Error instantiating WebSocket.");const i=s.message||s.data;i&&this.log_(i),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=s=>{this.handleIncomingFrame(s)},this.mySock.onerror=s=>{this.log_("WebSocket error.  Closing connection.");const i=s.message||s.data;i&&this.log_(i),this.onClosed_()}}start(){}static forceDisallow(){bt.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const n=/Android ([0-9]{0,}\.[0-9]{0,})/,s=navigator.userAgent.match(n);s&&s.length>1&&parseFloat(s[1])<4.4&&(e=!0)}return!e&&Ns!==null&&!bt.forceDisallow_}static previouslyFailed(){return en.isInMemoryStorage||en.get("previous_websocket_failure")===!0}markConnectionHealthy(){en.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const n=this.frames.join("");this.frames=null;const s=xn(n);this.onMessage(s)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(x(this.frames===null,"We already have a frame buffer"),e.length<=6){const n=Number(e);if(!isNaN(n))return this.handleNewFrameCount_(n),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const n=e.data;if(this.bytesReceived+=n.length,this.stats_.incrementCounter("bytes_received",n.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(n);else{const s=this.extractFrameCount_(n);s!==null&&this.appendFrame_(s)}}send(e){this.resetKeepAlive();const n=Ke(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const s=aa(n,wf);s.length>1&&this.sendString_(String(s.length));for(let i=0;i<s.length;i++)this.sendString_(s[i])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(Cf))}sendString_(e){try{this.mySock.send(e)}catch(n){this.log_("Exception thrown from WebSocket.send():",n.message||n.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}bt.responsesRequiredToBeHealthy=2;bt.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zn{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[_n,bt]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const n=bt&&bt.isAvailable();let s=n&&!bt.previouslyFailed();if(e.webSocketOnly&&(n||ut("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),s=!0),s)this.transports_=[bt];else{const i=this.transports_=[];for(const o of Zn.ALL_TRANSPORTS)o&&o.isAvailable()&&i.push(o);Zn.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}Zn.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kf=6e4,Ef=5e3,Sf=10*1024,If=100*1024,pi="t",Jo="d",Tf="s",Zo="r",Nf="e",$o="o",er="a",tr="n",nr="p",Of="h";class Df{constructor(e,n,s,i,o,r,l,a,c,u){this.id=e,this.repoInfo_=n,this.applicationId_=s,this.appCheckToken_=i,this.authToken_=o,this.onMessage_=r,this.onReady_=l,this.onDisconnect_=a,this.onKill_=c,this.lastSessionId=u,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=us("c:"+this.id+":"),this.transportManager_=new Zn(n),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.conn_),s=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,s)},Math.floor(0));const i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=Vn(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>If?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>Sf?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){const n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(pi in e){const n=e[pi];n===er?this.upgradeIfSecondaryHealthy_():n===Zo?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===$o&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const n=Wn("t",e),s=Wn("d",e);if(n==="c")this.onSecondaryControl_(s);else if(n==="d")this.pendingDataMessages.push(s);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:nr,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:er,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:tr,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const n=Wn("t",e),s=Wn("d",e);n==="c"?this.onControl_(s):n==="d"&&this.onDataMessage_(s)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const n=Wn(pi,e);if(Jo in e){const s=e[Jo];if(n===Of){const i=Object.assign({},s);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(n===tr){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===Tf?this.onConnectionShutdown_(s):n===Zo?this.onReset_(s):n===Nf?Di("Server Error: "+s):n===$o?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Di("Unknown control packet command: "+n)}}onHandshake_(e){const n=e.ts,s=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),eo!==s&&ut("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.secondaryConn_),s=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,s),Vn(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(kf))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Vn(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(Ef))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:nr,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(en.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ia{put(e,n,s,i){}merge(e,n,s,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,s){}onDisconnectMerge(e,n,s){}onDisconnectCancel(e,n){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ta{constructor(e){this.allowedEvents_=e,this.listeners_={},x(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){const s=[...this.listeners_[e]];for(let i=0;i<s.length;i++)s[i].callback.apply(s[i].context,n)}}on(e,n,s){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:s});const i=this.getInitialEvent(e);i&&n.apply(s,i)}off(e,n,s){this.validateEventType_(e);const i=this.listeners_[e]||[];for(let o=0;o<i.length;o++)if(i[o].callback===n&&(!s||s===i[o].context)){i.splice(o,1);return}}validateEventType_(e){x(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Os extends Ta{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!xl()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new Os}getInitialEvent(e){return x(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sr=32,ir=768;class Me{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let s=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[s]=this.pieces_[i],s++);this.pieces_.length=s,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}}function Se(){return new Me("")}function we(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function Kt(t){return t.pieces_.length-t.pieceNum_}function Be(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new Me(t.pieces_,e)}function Na(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function Rf(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function Oa(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function Da(t){if(t.pieceNum_>=t.pieces_.length)return null;const e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new Me(e,0)}function Qe(t,e){const n=[];for(let s=t.pieceNum_;s<t.pieces_.length;s++)n.push(t.pieces_[s]);if(e instanceof Me)for(let s=e.pieceNum_;s<e.pieces_.length;s++)n.push(e.pieces_[s]);else{const s=e.split("/");for(let i=0;i<s.length;i++)s[i].length>0&&n.push(s[i])}return new Me(n,0)}function ye(t){return t.pieceNum_>=t.pieces_.length}function ot(t,e){const n=we(t),s=we(e);if(n===null)return e;if(n===s)return ot(Be(t),Be(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function Ra(t,e){if(Kt(t)!==Kt(e))return!1;for(let n=t.pieceNum_,s=e.pieceNum_;n<=t.pieces_.length;n++,s++)if(t.pieces_[n]!==e.pieces_[s])return!1;return!0}function vt(t,e){let n=t.pieceNum_,s=e.pieceNum_;if(Kt(t)>Kt(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[s])return!1;++n,++s}return!0}class Af{constructor(e,n){this.errorPrefix_=n,this.parts_=Oa(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let s=0;s<this.parts_.length;s++)this.byteLength_+=Vs(this.parts_[s]);Aa(this)}}function Pf(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=Vs(e),Aa(t)}function Mf(t){const e=t.parts_.pop();t.byteLength_-=Vs(e),t.parts_.length>0&&(t.byteLength_-=1)}function Aa(t){if(t.byteLength_>ir)throw new Error(t.errorPrefix_+"has a key path longer than "+ir+" bytes ("+t.byteLength_+").");if(t.parts_.length>sr)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+sr+") or object contains a cycle "+Zt(t))}function Zt(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class so extends Ta{constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{const s=!document[e];s!==this.visible_&&(this.visible_=s,this.trigger("visible",s))},!1)}static getInstance(){return new so}getInitialEvent(e){return x(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qn=1e3,Lf=60*5*1e3,or=30*1e3,Ff=1.3,Bf=3e4,zf="server_kill",rr=3;class Pt extends Ia{constructor(e,n,s,i,o,r,l,a){if(super(),this.repoInfo_=e,this.applicationId_=n,this.onDataUpdate_=s,this.onConnectStatus_=i,this.onServerInfoUpdate_=o,this.authTokenProvider_=r,this.appCheckTokenProvider_=l,this.authOverride_=a,this.id=Pt.nextPersistentConnectionId_++,this.log_=us("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=qn,this.maxReconnectDelay_=Lf,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,a&&!Xl())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");so.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&Os.getInstance().on("online",this.onOnline_,this)}sendRequest(e,n,s){const i=++this.requestNumber_,o={r:i,a:e,b:n};this.log_(Ke(o)),x(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),s&&(this.requestCBHash_[i]=s)}get(e){this.initConnection_();const n=new Us,i={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:r=>{const l=r.d;r.s==="ok"?n.resolve(l):n.reject(l)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;const o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),n.promise}listen(e,n,s,i){this.initConnection_();const o=e._queryIdentifier,r=e._path.toString();this.log_("Listen called for "+r+" "+o),this.listens.has(r)||this.listens.set(r,new Map),x(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),x(!this.listens.get(r).has(o),"listen() called twice for same path/queryId.");const l={onComplete:i,hashFn:n,query:e,tag:s};this.listens.get(r).set(o,l),this.connected_&&this.sendListen_(l)}sendGet_(e){const n=this.outstandingGets_[e];this.sendRequest("g",n.request,s=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),n.onComplete&&n.onComplete(s)})}sendListen_(e){const n=e.query,s=n._path.toString(),i=n._queryIdentifier;this.log_("Listen on "+s+" for "+i);const o={p:s},r="q";e.tag&&(o.q=n._queryObject,o.t=e.tag),o.h=e.hashFn(),this.sendRequest(r,o,l=>{const a=l.d,c=l.s;Pt.warnOnListenWarnings_(a,n),(this.listens.get(s)&&this.listens.get(s).get(i))===e&&(this.log_("listen response",l),c!=="ok"&&this.removeListen_(s,i),e.onComplete&&e.onComplete(c,a))})}static warnOnListenWarnings_(e,n){if(e&&typeof e=="object"&&Rt(e,"w")){const s=Sn(e,"w");if(Array.isArray(s)&&~s.indexOf("no_index")){const i='".indexOn": "'+n._queryParams.getIndex().toString()+'"',o=n._path.toString();ut(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${i} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||Nu(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=or)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,n=Tu(e)?"auth":"gauth",s={cred:e};this.authOverride_===null?s.noauth=!0:typeof this.authOverride_=="object"&&(s.authvar=this.authOverride_),this.sendRequest(n,s,i=>{const o=i.s,r=i.d||"error";this.authToken_===e&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,r))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const n=e.s,s=e.d||"error";n==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(n,s)})}unlisten(e,n){const s=e._path.toString(),i=e._queryIdentifier;this.log_("Unlisten called for "+s+" "+i),x(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(s,i)&&this.connected_&&this.sendUnlisten_(s,i,e._queryObject,n)}sendUnlisten_(e,n,s,i){this.log_("Unlisten on "+e+" for "+n);const o={p:e},r="n";i&&(o.q=s,o.t=i),this.sendRequest(r,o)}onDisconnectPut(e,n,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,n,s):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:n,onComplete:s})}onDisconnectMerge(e,n,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,n,s):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:n,onComplete:s})}onDisconnectCancel(e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:n})}sendOnDisconnect_(e,n,s,i){const o={p:n,d:s};this.log_("onDisconnect "+e,o),this.sendRequest(e,o,r=>{i&&setTimeout(()=>{i(r.s,r.d)},Math.floor(0))})}put(e,n,s,i){this.putInternal("p",e,n,s,i)}merge(e,n,s,i){this.putInternal("m",e,n,s,i)}putInternal(e,n,s,i,o){this.initConnection_();const r={p:n,d:s};o!==void 0&&(r.h=o),this.outstandingPuts_.push({action:e,request:r,onComplete:i}),this.outstandingPutCount_++;const l=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(l):this.log_("Buffering put: "+n)}sendPut_(e){const n=this.outstandingPuts_[e].action,s=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,s,o=>{this.log_(n+" response",o),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),i&&i(o.s,o.d)})}reportStats(e){if(this.connected_){const n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,s=>{if(s.s!=="ok"){const o=s.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+Ke(e));const n=e.r,s=this.requestCBHash_[n];s&&(delete this.requestCBHash_[n],s(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,n){this.log_("handleServerMessage",e,n),e==="d"?this.onDataUpdate_(n.p,n.d,!1,n.t):e==="m"?this.onDataUpdate_(n.p,n.d,!0,n.t):e==="c"?this.onListenRevoked_(n.p,n.q):e==="ac"?this.onAuthRevoked_(n.s,n.d):e==="apc"?this.onAppCheckRevoked_(n.s,n.d):e==="sd"?this.onSecurityDebugPacket_(n):Di("Unrecognized action received from server: "+Ke(e)+`
Are you using the latest client?`)}onReady_(e,n){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=n,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){x(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=qn,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=qn,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>Bf&&(this.reconnectDelay_=qn),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=new Date().getTime()-this.lastConnectionAttemptTime_;let n=Math.max(0,this.reconnectDelay_-e);n=Math.random()*n,this.log_("Trying to reconnect in "+n+"ms"),this.scheduleConnect_(n),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*Ff)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),s=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+Pt.nextConnectionId_++,o=this.lastSessionId;let r=!1,l=null;const a=function(){l?l.close():(r=!0,s())},c=function(f){x(l,"sendRequest call when we're not connected not allowed."),l.sendRequest(f)};this.realtime_={close:a,sendRequest:c};const u=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[f,d]=await Promise.all([this.authTokenProvider_.getToken(u),this.appCheckTokenProvider_.getToken(u)]);r?tt("getToken() completed but was canceled"):(tt("getToken() completed. Creating connection."),this.authToken_=f&&f.accessToken,this.appCheckToken_=d&&d.token,l=new Df(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,n,s,_=>{ut(_+" ("+this.repoInfo_.toString()+")"),this.interrupt(zf)},o))}catch(f){this.log_("Failed to get token: "+f),r||(this.repoInfo_.nodeAdmin&&ut(f),a())}}}interrupt(e){tt("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){tt("Resuming connection for reason: "+e),delete this.interruptReasons_[e],Bo(this.interruptReasons_)&&(this.reconnectDelay_=qn,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const n=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:n})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const n=this.outstandingPuts_[e];n&&"h"in n.request&&n.queued&&(n.onComplete&&n.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,n){let s;n?s=n.map(o=>$i(o)).join("$"):s="default";const i=this.removeListen_(e,s);i&&i.onComplete&&i.onComplete("permission_denied")}removeListen_(e,n){const s=new Me(e).toString();let i;if(this.listens.has(s)){const o=this.listens.get(s);i=o.get(n),o.delete(n),o.size===0&&this.listens.delete(s)}else i=void 0;return i}onAuthRevoked_(e,n){tt("Auth token revoked: "+e+"/"+n),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=rr&&(this.reconnectDelay_=or,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,n){tt("App check token revoked: "+e+"/"+n),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=rr&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const n of e.values())this.sendListen_(n);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let n="js";e["sdk."+n+"."+oa.replace(/\./g,"-")]=1,xl()?e["framework.cordova"]=1:wu()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=Os.getInstance().currentlyOnline();return Bo(this.interruptReasons_)&&e}}Pt.nextPersistentConnectionId_=0;Pt.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class be{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new be(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gs{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){const s=new be(rn,e),i=new be(rn,n);return this.compare(s,i)!==0}minPost(){return be.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gs;class Pa extends Gs{static get __EMPTY_NODE(){return gs}static set __EMPTY_NODE(e){gs=e}compare(e,n){return Pn(e.name,n.name)}isDefinedOn(e){throw An("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return be.MIN}maxPost(){return new be(Yt,gs)}makePost(e,n){return x(typeof e=="string","KeyIndex indexValue must always be a string."),new be(e,gs)}toString(){return".key"}}const Ht=new Pa;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bs{constructor(e,n,s,i,o=null){this.isReverse_=i,this.resultGenerator_=o,this.nodeStack_=[];let r=1;for(;!e.isEmpty();)if(e=e,r=n?s(e.key,n):1,i&&(r*=-1),r<0)this.isReverse_?e=e.left:e=e.right;else if(r===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class Xe{constructor(e,n,s,i,o){this.key=e,this.value=n,this.color=s??Xe.RED,this.left=i??ct.EMPTY_NODE,this.right=o??ct.EMPTY_NODE}copy(e,n,s,i,o){return new Xe(e??this.key,n??this.value,s??this.color,i??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,s){let i=this;const o=s(e,i.key);return o<0?i=i.copy(null,null,null,i.left.insert(e,n,s),null):o===0?i=i.copy(null,n,null,null,null):i=i.copy(null,null,null,null,i.right.insert(e,n,s)),i.fixUp_()}removeMin_(){if(this.left.isEmpty())return ct.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,n){let s,i;if(s=this,n(e,s.key)<0)!s.left.isEmpty()&&!s.left.isRed_()&&!s.left.left.isRed_()&&(s=s.moveRedLeft_()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed_()&&(s=s.rotateRight_()),!s.right.isEmpty()&&!s.right.isRed_()&&!s.right.left.isRed_()&&(s=s.moveRedRight_()),n(e,s.key)===0){if(s.right.isEmpty())return ct.EMPTY_NODE;i=s.right.min_(),s=s.copy(i.key,i.value,null,null,s.right.removeMin_())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,Xe.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,Xe.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}Xe.RED=!0;Xe.BLACK=!1;class Wf{copy(e,n,s,i,o){return this}insert(e,n,s){return new Xe(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class ct{constructor(e,n=ct.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new ct(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,Xe.BLACK,null,null))}remove(e){return new ct(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Xe.BLACK,null,null))}get(e){let n,s=this.root_;for(;!s.isEmpty();){if(n=this.comparator_(e,s.key),n===0)return s.value;n<0?s=s.left:n>0&&(s=s.right)}return null}getPredecessorKey(e){let n,s=this.root_,i=null;for(;!s.isEmpty();)if(n=this.comparator_(e,s.key),n===0){if(s.left.isEmpty())return i?i.key:null;for(s=s.left;!s.right.isEmpty();)s=s.right;return s.key}else n<0?s=s.left:n>0&&(i=s,s=s.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new bs(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new bs(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new bs(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new bs(this.root_,null,this.comparator_,!0,e)}}ct.EMPTY_NODE=new Wf;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qf(t,e){return Pn(t.name,e.name)}function io(t,e){return Pn(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ai;function Hf(t){Ai=t}const Ma=function(t){return typeof t=="number"?"number:"+ca(t):"string:"+t},La=function(t){if(t.isLeafNode()){const e=t.val();x(typeof e=="string"||typeof e=="number"||typeof e=="object"&&Rt(e,".sv"),"Priority must be a string or number.")}else x(t===Ai||t.isEmpty(),"priority of unexpected type.");x(t===Ai||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let lr;class xe{constructor(e,n=xe.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=n,this.lazyHash_=null,x(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),La(this.priorityNode_)}static set __childrenNodeConstructor(e){lr=e}static get __childrenNodeConstructor(){return lr}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new xe(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:xe.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return ye(e)?this:we(e)===".priority"?this.priorityNode_:xe.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,n){return null}updateImmediateChild(e,n){return e===".priority"?this.updatePriority(n):n.isEmpty()&&e!==".priority"?this:xe.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)}updateChild(e,n){const s=we(e);return s===null?n:n.isEmpty()&&s!==".priority"?this:(x(s!==".priority"||Kt(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(s,xe.__childrenNodeConstructor.EMPTY_NODE.updateChild(Be(e),n)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,n){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+Ma(this.priorityNode_.val())+":");const n=typeof this.value_;e+=n+":",n==="number"?e+=ca(this.value_):e+=this.value_,this.lazyHash_=la(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===xe.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof xe.__childrenNodeConstructor?-1:(x(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const n=typeof e.value_,s=typeof this.value_,i=xe.VALUE_TYPE_ORDER.indexOf(n),o=xe.VALUE_TYPE_ORDER.indexOf(s);return x(i>=0,"Unknown leaf type: "+n),x(o>=0,"Unknown leaf type: "+s),i===o?s==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:o-i}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const n=e;return this.value_===n.value_&&this.priorityNode_.equals(n.priorityNode_)}else return!1}}xe.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Fa,Ba;function jf(t){Fa=t}function Uf(t){Ba=t}class Vf extends Gs{compare(e,n){const s=e.node.getPriority(),i=n.node.getPriority(),o=s.compareTo(i);return o===0?Pn(e.name,n.name):o}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return be.MIN}maxPost(){return new be(Yt,new xe("[PRIORITY-POST]",Ba))}makePost(e,n){const s=Fa(e);return new be(n,new xe("[PRIORITY-POST]",s))}toString(){return".priority"}}const Ue=new Vf;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gf=Math.log(2);class Yf{constructor(e){const n=o=>parseInt(Math.log(o)/Gf,10),s=o=>parseInt(Array(o+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;const i=s(this.count);this.bits_=e+1&i}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const Ds=function(t,e,n,s){t.sort(e);const i=function(a,c){const u=c-a;let f,d;if(u===0)return null;if(u===1)return f=t[a],d=n?n(f):f,new Xe(d,f.node,Xe.BLACK,null,null);{const _=parseInt(u/2,10)+a,h=i(a,_),g=i(_+1,c);return f=t[_],d=n?n(f):f,new Xe(d,f.node,Xe.BLACK,h,g)}},o=function(a){let c=null,u=null,f=t.length;const d=function(h,g){const v=f-h,w=f;f-=h;const C=i(v+1,w),y=t[v],E=n?n(y):y;_(new Xe(E,y.node,g,null,C))},_=function(h){c?(c.left=h,c=h):(u=h,c=h)};for(let h=0;h<a.count;++h){const g=a.nextBitIsOne(),v=Math.pow(2,a.count-(h+1));g?d(v,Xe.BLACK):(d(v,Xe.BLACK),d(v,Xe.RED))}return u},r=new Yf(t.length),l=o(r);return new ct(s||e,l)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let mi;const fn={};class At{constructor(e,n){this.indexes_=e,this.indexSet_=n}static get Default(){return x(fn&&Ue,"ChildrenNode.ts has not been loaded"),mi=mi||new At({".priority":fn},{".priority":Ue}),mi}get(e){const n=Sn(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof ct?n:null}hasIndex(e){return Rt(this.indexSet_,e.toString())}addIndex(e,n){x(e!==Ht,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const s=[];let i=!1;const o=n.getIterator(be.Wrap);let r=o.getNext();for(;r;)i=i||e.isDefinedOn(r.node),s.push(r),r=o.getNext();let l;i?l=Ds(s,e.getCompare()):l=fn;const a=e.toString(),c=Object.assign({},this.indexSet_);c[a]=e;const u=Object.assign({},this.indexes_);return u[a]=l,new At(u,c)}addToIndexes(e,n){const s=Ss(this.indexes_,(i,o)=>{const r=Sn(this.indexSet_,o);if(x(r,"Missing index implementation for "+o),i===fn)if(r.isDefinedOn(e.node)){const l=[],a=n.getIterator(be.Wrap);let c=a.getNext();for(;c;)c.name!==e.name&&l.push(c),c=a.getNext();return l.push(e),Ds(l,r.getCompare())}else return fn;else{const l=n.get(e.name);let a=i;return l&&(a=a.remove(new be(e.name,l))),a.insert(e,e.node)}});return new At(s,this.indexSet_)}removeFromIndexes(e,n){const s=Ss(this.indexes_,i=>{if(i===fn)return i;{const o=n.get(e.name);return o?i.remove(new be(e.name,o)):i}});return new At(s,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Hn;class ue{constructor(e,n,s){this.children_=e,this.priorityNode_=n,this.indexMap_=s,this.lazyHash_=null,this.priorityNode_&&La(this.priorityNode_),this.children_.isEmpty()&&x(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Hn||(Hn=new ue(new ct(io),null,At.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Hn}updatePriority(e){return this.children_.isEmpty()?this:new ue(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const n=this.children_.get(e);return n===null?Hn:n}}getChild(e){const n=we(e);return n===null?this:this.getImmediateChild(n).getChild(Be(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,n){if(x(n,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(n);{const s=new be(e,n);let i,o;n.isEmpty()?(i=this.children_.remove(e),o=this.indexMap_.removeFromIndexes(s,this.children_)):(i=this.children_.insert(e,n),o=this.indexMap_.addToIndexes(s,this.children_));const r=i.isEmpty()?Hn:this.priorityNode_;return new ue(i,r,o)}}updateChild(e,n){const s=we(e);if(s===null)return n;{x(we(e)!==".priority"||Kt(e)===1,".priority must be the last token in a path");const i=this.getImmediateChild(s).updateChild(Be(e),n);return this.updateImmediateChild(s,i)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const n={};let s=0,i=0,o=!0;if(this.forEachChild(Ue,(r,l)=>{n[r]=l.val(e),s++,o&&ue.INTEGER_REGEXP_.test(r)?i=Math.max(i,Number(r)):o=!1}),!e&&o&&i<2*s){const r=[];for(const l in n)r[l]=n[l];return r}else return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+Ma(this.getPriority().val())+":"),this.forEachChild(Ue,(n,s)=>{const i=s.hash();i!==""&&(e+=":"+n+":"+i)}),this.lazyHash_=e===""?"":la(e)}return this.lazyHash_}getPredecessorChildName(e,n,s){const i=this.resolveIndex_(s);if(i){const o=i.getPredecessorKey(new be(e,n));return o?o.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const n=this.resolveIndex_(e);if(n){const s=n.minKey();return s&&s.name}else return this.children_.minKey()}getFirstChild(e){const n=this.getFirstChildName(e);return n?new be(n,this.children_.get(n)):null}getLastChildName(e){const n=this.resolveIndex_(e);if(n){const s=n.maxKey();return s&&s.name}else return this.children_.maxKey()}getLastChild(e){const n=this.getLastChildName(e);return n?new be(n,this.children_.get(n)):null}forEachChild(e,n){const s=this.resolveIndex_(e);return s?s.inorderTraversal(i=>n(i.name,i.node)):this.children_.inorderTraversal(n)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,n){const s=this.resolveIndex_(n);if(s)return s.getIteratorFrom(e,i=>i);{const i=this.children_.getIteratorFrom(e.name,be.Wrap);let o=i.peek();for(;o!=null&&n.compare(o,e)<0;)i.getNext(),o=i.peek();return i}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,n){const s=this.resolveIndex_(n);if(s)return s.getReverseIteratorFrom(e,i=>i);{const i=this.children_.getReverseIteratorFrom(e.name,be.Wrap);let o=i.peek();for(;o!=null&&n.compare(o,e)>0;)i.getNext(),o=i.peek();return i}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===ds?-1:0}withIndex(e){if(e===Ht||this.indexMap_.hasIndex(e))return this;{const n=this.indexMap_.addIndex(e,this.children_);return new ue(this.children_,this.priorityNode_,n)}}isIndexed(e){return e===Ht||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const n=e;if(this.getPriority().equals(n.getPriority()))if(this.children_.count()===n.children_.count()){const s=this.getIterator(Ue),i=n.getIterator(Ue);let o=s.getNext(),r=i.getNext();for(;o&&r;){if(o.name!==r.name||!o.node.equals(r.node))return!1;o=s.getNext(),r=i.getNext()}return o===null&&r===null}else return!1;else return!1}}resolveIndex_(e){return e===Ht?null:this.indexMap_.get(e.toString())}}ue.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class Kf extends ue{constructor(){super(new ct(io),ue.EMPTY_NODE,At.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return ue.EMPTY_NODE}isEmpty(){return!1}}const ds=new Kf;Object.defineProperties(be,{MIN:{value:new be(rn,ue.EMPTY_NODE)},MAX:{value:new be(Yt,ds)}});Pa.__EMPTY_NODE=ue.EMPTY_NODE;xe.__childrenNodeConstructor=ue;Hf(ds);Uf(ds);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qf=!0;function Je(t,e=null){if(t===null)return ue.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),x(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){const n=t;return new xe(n,Je(e))}if(!(t instanceof Array)&&Qf){const n=[];let s=!1;if(ft(t,(r,l)=>{if(r.substring(0,1)!=="."){const a=Je(l);a.isEmpty()||(s=s||!a.getPriority().isEmpty(),n.push(new be(r,a)))}}),n.length===0)return ue.EMPTY_NODE;const o=Ds(n,qf,r=>r.name,io);if(s){const r=Ds(n,Ue.getCompare());return new ue(o,Je(e),new At({".priority":r},{".priority":Ue}))}else return new ue(o,Je(e),At.Default)}else{let n=ue.EMPTY_NODE;return ft(t,(s,i)=>{if(Rt(t,s)&&s.substring(0,1)!=="."){const o=Je(i);(o.isLeafNode()||!o.isEmpty())&&(n=n.updateImmediateChild(s,o))}}),n.updatePriority(Je(e))}}jf(Je);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class za extends Gs{constructor(e){super(),this.indexPath_=e,x(!ye(e)&&we(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){const s=this.extractChild(e.node),i=this.extractChild(n.node),o=s.compareTo(i);return o===0?Pn(e.name,n.name):o}makePost(e,n){const s=Je(e),i=ue.EMPTY_NODE.updateChild(this.indexPath_,s);return new be(n,i)}maxPost(){const e=ue.EMPTY_NODE.updateChild(this.indexPath_,ds);return new be(Yt,e)}toString(){return Oa(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xf extends Gs{compare(e,n){const s=e.node.compareTo(n.node);return s===0?Pn(e.name,n.name):s}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return be.MIN}maxPost(){return be.MAX}makePost(e,n){const s=Je(e);return new be(n,s)}toString(){return".value"}}const Wa=new xf;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qa(t){return{type:"value",snapshotNode:t}}function In(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function $n(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function es(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function Xf(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oo{constructor(e){this.index_=e}updateChild(e,n,s,i,o,r){x(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const l=e.getImmediateChild(n);return l.getChild(i).equals(s.getChild(i))&&l.isEmpty()===s.isEmpty()||(r!=null&&(s.isEmpty()?e.hasChild(n)?r.trackChildChange($n(n,l)):x(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):l.isEmpty()?r.trackChildChange(In(n,s)):r.trackChildChange(es(n,s,l))),e.isLeafNode()&&s.isEmpty())?e:e.updateImmediateChild(n,s).withIndex(this.index_)}updateFullNode(e,n,s){return s!=null&&(e.isLeafNode()||e.forEachChild(Ue,(i,o)=>{n.hasChild(i)||s.trackChildChange($n(i,o))}),n.isLeafNode()||n.forEachChild(Ue,(i,o)=>{if(e.hasChild(i)){const r=e.getImmediateChild(i);r.equals(o)||s.trackChildChange(es(i,o,r))}else s.trackChildChange(In(i,o))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?ue.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ts{constructor(e){this.indexedFilter_=new oo(e.getIndex()),this.index_=e.getIndex(),this.startPost_=ts.getStartPost_(e),this.endPost_=ts.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,s=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&s}updateChild(e,n,s,i,o,r){return this.matches(new be(n,s))||(s=ue.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,s,i,o,r)}updateFullNode(e,n,s){n.isLeafNode()&&(n=ue.EMPTY_NODE);let i=n.withIndex(this.index_);i=i.updatePriority(ue.EMPTY_NODE);const o=this;return n.forEachChild(Ue,(r,l)=>{o.matches(new be(r,l))||(i=i.updateImmediateChild(r,ue.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,s)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jf{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{const s=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?s<=0:s<0},this.withinEndPost=n=>{const s=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?s<=0:s<0},this.rangedFilter_=new ts(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,s,i,o,r){return this.rangedFilter_.matches(new be(n,s))||(s=ue.EMPTY_NODE),e.getImmediateChild(n).equals(s)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,s,i,o,r):this.fullLimitUpdateChild_(e,n,s,o,r)}updateFullNode(e,n,s){let i;if(n.isLeafNode()||n.isEmpty())i=ue.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){i=ue.EMPTY_NODE.withIndex(this.index_);let o;this.reverse_?o=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):o=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let r=0;for(;o.hasNext()&&r<this.limit_;){const l=o.getNext();if(this.withinDirectionalStart(l))if(this.withinDirectionalEnd(l))i=i.updateImmediateChild(l.name,l.node),r++;else break;else continue}}else{i=n.withIndex(this.index_),i=i.updatePriority(ue.EMPTY_NODE);let o;this.reverse_?o=i.getReverseIterator(this.index_):o=i.getIterator(this.index_);let r=0;for(;o.hasNext();){const l=o.getNext();r<this.limit_&&this.withinDirectionalStart(l)&&this.withinDirectionalEnd(l)?r++:i=i.updateImmediateChild(l.name,ue.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,s)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,s,i,o){let r;if(this.reverse_){const f=this.index_.getCompare();r=(d,_)=>f(_,d)}else r=this.index_.getCompare();const l=e;x(l.numChildren()===this.limit_,"");const a=new be(n,s),c=this.reverse_?l.getFirstChild(this.index_):l.getLastChild(this.index_),u=this.rangedFilter_.matches(a);if(l.hasChild(n)){const f=l.getImmediateChild(n);let d=i.getChildAfterChild(this.index_,c,this.reverse_);for(;d!=null&&(d.name===n||l.hasChild(d.name));)d=i.getChildAfterChild(this.index_,d,this.reverse_);const _=d==null?1:r(d,a);if(u&&!s.isEmpty()&&_>=0)return o!=null&&o.trackChildChange(es(n,s,f)),l.updateImmediateChild(n,s);{o!=null&&o.trackChildChange($n(n,f));const g=l.updateImmediateChild(n,ue.EMPTY_NODE);return d!=null&&this.rangedFilter_.matches(d)?(o!=null&&o.trackChildChange(In(d.name,d.node)),g.updateImmediateChild(d.name,d.node)):g}}else return s.isEmpty()?e:u&&r(c,a)>=0?(o!=null&&(o.trackChildChange($n(c.name,c.node)),o.trackChildChange(In(n,s))),l.updateImmediateChild(n,s).updateImmediateChild(c.name,ue.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ro{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Ue}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return x(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return x(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:rn}hasEnd(){return this.endSet_}getIndexEndValue(){return x(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return x(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Yt}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return x(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Ue}copy(){const e=new ro;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function Zf(t){return t.loadsAllData()?new oo(t.getIndex()):t.hasLimit()?new Jf(t):new ts(t)}function $f(t,e){const n=t.copy();return n.index_=e,n}function ar(t){const e={};if(t.isDefault())return e;let n;if(t.index_===Ue?n="$priority":t.index_===Wa?n="$value":t.index_===Ht?n="$key":(x(t.index_ instanceof za,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=Ke(n),t.startSet_){const s=t.startAfterSet_?"startAfter":"startAt";e[s]=Ke(t.indexStartValue_),t.startNameSet_&&(e[s]+=","+Ke(t.indexStartName_))}if(t.endSet_){const s=t.endBeforeSet_?"endBefore":"endAt";e[s]=Ke(t.indexEndValue_),t.endNameSet_&&(e[s]+=","+Ke(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function cr(t){const e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==Ue&&(e.i=t.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rs extends Ia{constructor(e,n,s,i){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=s,this.appCheckTokenProvider_=i,this.log_=us("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(x(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,n,s,i){const o=e._path.toString();this.log_("Listen called for "+o+" "+e._queryIdentifier);const r=Rs.getListenId_(e,s),l={};this.listens_[r]=l;const a=ar(e._queryParams);this.restRequest_(o+".json",a,(c,u)=>{let f=u;if(c===404&&(f=null,c=null),c===null&&this.onDataUpdate_(o,f,!1,s),Sn(this.listens_,r)===l){let d;c?c===401?d="permission_denied":d="rest_error:"+c:d="ok",i(d,null)}})}unlisten(e,n){const s=Rs.getListenId_(e,n);delete this.listens_[s]}get(e){const n=ar(e._queryParams),s=e._path.toString(),i=new Us;return this.restRequest_(s+".json",n,(o,r)=>{let l=r;o===404&&(l=null,o=null),o===null?(this.onDataUpdate_(s,l,!1,null),i.resolve(l)):i.reject(new Error(l))}),i.promise}refreshAuthToken(e){}restRequest_(e,n={},s){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,o])=>{i&&i.accessToken&&(n.auth=i.accessToken),o&&o.token&&(n.ac=o.token);const r=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+Ou(n);this.log_("Sending REST request for "+r);const l=new XMLHttpRequest;l.onreadystatechange=()=>{if(s&&l.readyState===4){this.log_("REST Response for "+r+" received. status:",l.status,"response:",l.responseText);let a=null;if(l.status>=200&&l.status<300){try{a=xn(l.responseText)}catch{ut("Failed to parse JSON response for "+r+": "+l.responseText)}s(null,a)}else l.status!==401&&l.status!==404&&ut("Got unsuccessful REST response for "+r+" Status: "+l.status),s(l.status);s=null}},l.open("GET",r,!0),l.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eh{constructor(){this.rootNode_=ue.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function As(){return{value:null,children:new Map}}function Ha(t,e,n){if(ye(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{const s=we(e);t.children.has(s)||t.children.set(s,As());const i=t.children.get(s);e=Be(e),Ha(i,e,n)}}function Pi(t,e,n){t.value!==null?n(e,t.value):th(t,(s,i)=>{const o=new Me(e.toString()+"/"+s);Pi(i,o,n)})}function th(t,e){t.children.forEach((n,s)=>{e(s,n)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nh{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),n=Object.assign({},e);return this.last_&&ft(this.last_,(s,i)=>{n[s]=n[s]-i}),this.last_=e,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ur=10*1e3,sh=30*1e3,ih=5*60*1e3;class oh{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new nh(e);const s=ur+(sh-ur)*Math.random();Vn(this.reportStats_.bind(this),Math.floor(s))}reportStats_(){const e=this.statsListener_.get(),n={};let s=!1;ft(e,(i,o)=>{o>0&&Rt(this.statsToReport_,i)&&(n[i]=o,s=!0)}),s&&this.server_.reportStats(n),Vn(this.reportStats_.bind(this),Math.floor(Math.random()*2*ih))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var yt;(function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(yt||(yt={}));function ja(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function lo(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function ao(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ps{constructor(e,n,s){this.path=e,this.affectedTree=n,this.revert=s,this.type=yt.ACK_USER_WRITE,this.source=ja()}operationForChild(e){if(ye(this.path)){if(this.affectedTree.value!=null)return x(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const n=this.affectedTree.subtree(new Me(e));return new Ps(Se(),n,this.revert)}}else return x(we(this.path)===e,"operationForChild called for unrelated child."),new Ps(Be(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ns{constructor(e,n){this.source=e,this.path=n,this.type=yt.LISTEN_COMPLETE}operationForChild(e){return ye(this.path)?new ns(this.source,Se()):new ns(this.source,Be(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ln{constructor(e,n,s){this.source=e,this.path=n,this.snap=s,this.type=yt.OVERWRITE}operationForChild(e){return ye(this.path)?new ln(this.source,Se(),this.snap.getImmediateChild(e)):new ln(this.source,Be(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ss{constructor(e,n,s){this.source=e,this.path=n,this.children=s,this.type=yt.MERGE}operationForChild(e){if(ye(this.path)){const n=this.children.subtree(new Me(e));return n.isEmpty()?null:n.value?new ln(this.source,Se(),n.value):new ss(this.source,Se(),n)}else return x(we(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new ss(this.source,Be(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qt{constructor(e,n,s){this.node_=e,this.fullyInitialized_=n,this.filtered_=s}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(ye(e))return this.isFullyInitialized()&&!this.filtered_;const n=we(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rh{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function lh(t,e,n,s){const i=[],o=[];return e.forEach(r=>{r.type==="child_changed"&&t.index_.indexedValueChanged(r.oldSnap,r.snapshotNode)&&o.push(Xf(r.childName,r.snapshotNode))}),jn(t,i,"child_removed",e,s,n),jn(t,i,"child_added",e,s,n),jn(t,i,"child_moved",o,s,n),jn(t,i,"child_changed",e,s,n),jn(t,i,"value",e,s,n),i}function jn(t,e,n,s,i,o){const r=s.filter(l=>l.type===n);r.sort((l,a)=>ch(t,l,a)),r.forEach(l=>{const a=ah(t,l,o);i.forEach(c=>{c.respondsTo(l.type)&&e.push(c.createEvent(a,t.query_))})})}function ah(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function ch(t,e,n){if(e.childName==null||n.childName==null)throw An("Should only compare child_ events.");const s=new be(e.childName,e.snapshotNode),i=new be(n.childName,n.snapshotNode);return t.index_.compare(s,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ys(t,e){return{eventCache:t,serverCache:e}}function Gn(t,e,n,s){return Ys(new Qt(e,n,s),t.serverCache)}function Ua(t,e,n,s){return Ys(t.eventCache,new Qt(e,n,s))}function Ms(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function an(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gi;const uh=()=>(gi||(gi=new ct(xd)),gi);class ze{constructor(e,n=uh()){this.value=e,this.children=n}static fromObject(e){let n=new ze(null);return ft(e,(s,i)=>{n=n.set(new Me(s),i)}),n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:Se(),value:this.value};if(ye(e))return null;{const s=we(e),i=this.children.get(s);if(i!==null){const o=i.findRootMostMatchingPathAndValue(Be(e),n);return o!=null?{path:Qe(new Me(s),o.path),value:o.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(ye(e))return this;{const n=we(e),s=this.children.get(n);return s!==null?s.subtree(Be(e)):new ze(null)}}set(e,n){if(ye(e))return new ze(n,this.children);{const s=we(e),o=(this.children.get(s)||new ze(null)).set(Be(e),n),r=this.children.insert(s,o);return new ze(this.value,r)}}remove(e){if(ye(e))return this.children.isEmpty()?new ze(null):new ze(null,this.children);{const n=we(e),s=this.children.get(n);if(s){const i=s.remove(Be(e));let o;return i.isEmpty()?o=this.children.remove(n):o=this.children.insert(n,i),this.value===null&&o.isEmpty()?new ze(null):new ze(this.value,o)}else return this}}get(e){if(ye(e))return this.value;{const n=we(e),s=this.children.get(n);return s?s.get(Be(e)):null}}setTree(e,n){if(ye(e))return n;{const s=we(e),o=(this.children.get(s)||new ze(null)).setTree(Be(e),n);let r;return o.isEmpty()?r=this.children.remove(s):r=this.children.insert(s,o),new ze(this.value,r)}}fold(e){return this.fold_(Se(),e)}fold_(e,n){const s={};return this.children.inorderTraversal((i,o)=>{s[i]=o.fold_(Qe(e,i),n)}),n(e,this.value,s)}findOnPath(e,n){return this.findOnPath_(e,Se(),n)}findOnPath_(e,n,s){const i=this.value?s(n,this.value):!1;if(i)return i;if(ye(e))return null;{const o=we(e),r=this.children.get(o);return r?r.findOnPath_(Be(e),Qe(n,o),s):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,Se(),n)}foreachOnPath_(e,n,s){if(ye(e))return this;{this.value&&s(n,this.value);const i=we(e),o=this.children.get(i);return o?o.foreachOnPath_(Be(e),Qe(n,i),s):new ze(null)}}foreach(e){this.foreach_(Se(),e)}foreach_(e,n){this.children.inorderTraversal((s,i)=>{i.foreach_(Qe(e,s),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,s)=>{s.value&&e(n,s.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wt{constructor(e){this.writeTree_=e}static empty(){return new wt(new ze(null))}}function Yn(t,e,n){if(ye(e))return new wt(new ze(n));{const s=t.writeTree_.findRootMostValueAndPath(e);if(s!=null){const i=s.path;let o=s.value;const r=ot(i,e);return o=o.updateChild(r,n),new wt(t.writeTree_.set(i,o))}else{const i=new ze(n),o=t.writeTree_.setTree(e,i);return new wt(o)}}}function dr(t,e,n){let s=t;return ft(n,(i,o)=>{s=Yn(s,Qe(e,i),o)}),s}function fr(t,e){if(ye(e))return wt.empty();{const n=t.writeTree_.setTree(e,new ze(null));return new wt(n)}}function Mi(t,e){return cn(t,e)!=null}function cn(t,e){const n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(ot(n.path,e)):null}function hr(t){const e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(Ue,(s,i)=>{e.push(new be(s,i))}):t.writeTree_.children.inorderTraversal((s,i)=>{i.value!=null&&e.push(new be(s,i.value))}),e}function jt(t,e){if(ye(e))return t;{const n=cn(t,e);return n!=null?new wt(new ze(n)):new wt(t.writeTree_.subtree(e))}}function Li(t){return t.writeTree_.isEmpty()}function Tn(t,e){return Va(Se(),t.writeTree_,e)}function Va(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let s=null;return e.children.inorderTraversal((i,o)=>{i===".priority"?(x(o.value!==null,"Priority writes must always be leaf nodes"),s=o.value):n=Va(Qe(t,i),o,n)}),!n.getChild(t).isEmpty()&&s!==null&&(n=n.updateChild(Qe(t,".priority"),s)),n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ks(t,e){return Qa(e,t)}function dh(t,e,n,s,i){x(s>t.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),t.allWrites.push({path:e,snap:n,writeId:s,visible:i}),i&&(t.visibleWrites=Yn(t.visibleWrites,e,n)),t.lastWriteId=s}function fh(t,e){for(let n=0;n<t.allWrites.length;n++){const s=t.allWrites[n];if(s.writeId===e)return s}return null}function hh(t,e){const n=t.allWrites.findIndex(l=>l.writeId===e);x(n>=0,"removeWrite called with nonexistent writeId.");const s=t.allWrites[n];t.allWrites.splice(n,1);let i=s.visible,o=!1,r=t.allWrites.length-1;for(;i&&r>=0;){const l=t.allWrites[r];l.visible&&(r>=n&&_h(l,s.path)?i=!1:vt(s.path,l.path)&&(o=!0)),r--}if(i){if(o)return ph(t),!0;if(s.snap)t.visibleWrites=fr(t.visibleWrites,s.path);else{const l=s.children;ft(l,a=>{t.visibleWrites=fr(t.visibleWrites,Qe(s.path,a))})}return!0}else return!1}function _h(t,e){if(t.snap)return vt(t.path,e);for(const n in t.children)if(t.children.hasOwnProperty(n)&&vt(Qe(t.path,n),e))return!0;return!1}function ph(t){t.visibleWrites=Ga(t.allWrites,mh,Se()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function mh(t){return t.visible}function Ga(t,e,n){let s=wt.empty();for(let i=0;i<t.length;++i){const o=t[i];if(e(o)){const r=o.path;let l;if(o.snap)vt(n,r)?(l=ot(n,r),s=Yn(s,l,o.snap)):vt(r,n)&&(l=ot(r,n),s=Yn(s,Se(),o.snap.getChild(l)));else if(o.children){if(vt(n,r))l=ot(n,r),s=dr(s,l,o.children);else if(vt(r,n))if(l=ot(r,n),ye(l))s=dr(s,Se(),o.children);else{const a=Sn(o.children,we(l));if(a){const c=a.getChild(Be(l));s=Yn(s,Se(),c)}}}else throw An("WriteRecord should have .snap or .children")}}return s}function Ya(t,e,n,s,i){if(!s&&!i){const o=cn(t.visibleWrites,e);if(o!=null)return o;{const r=jt(t.visibleWrites,e);if(Li(r))return n;if(n==null&&!Mi(r,Se()))return null;{const l=n||ue.EMPTY_NODE;return Tn(r,l)}}}else{const o=jt(t.visibleWrites,e);if(!i&&Li(o))return n;if(!i&&n==null&&!Mi(o,Se()))return null;{const r=function(c){return(c.visible||i)&&(!s||!~s.indexOf(c.writeId))&&(vt(c.path,e)||vt(e,c.path))},l=Ga(t.allWrites,r,e),a=n||ue.EMPTY_NODE;return Tn(l,a)}}}function gh(t,e,n){let s=ue.EMPTY_NODE;const i=cn(t.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(Ue,(o,r)=>{s=s.updateImmediateChild(o,r)}),s;if(n){const o=jt(t.visibleWrites,e);return n.forEachChild(Ue,(r,l)=>{const a=Tn(jt(o,new Me(r)),l);s=s.updateImmediateChild(r,a)}),hr(o).forEach(r=>{s=s.updateImmediateChild(r.name,r.node)}),s}else{const o=jt(t.visibleWrites,e);return hr(o).forEach(r=>{s=s.updateImmediateChild(r.name,r.node)}),s}}function bh(t,e,n,s,i){x(s||i,"Either existingEventSnap or existingServerSnap must exist");const o=Qe(e,n);if(Mi(t.visibleWrites,o))return null;{const r=jt(t.visibleWrites,o);return Li(r)?i.getChild(n):Tn(r,i.getChild(n))}}function vh(t,e,n,s){const i=Qe(e,n),o=cn(t.visibleWrites,i);if(o!=null)return o;if(s.isCompleteForChild(n)){const r=jt(t.visibleWrites,i);return Tn(r,s.getNode().getImmediateChild(n))}else return null}function yh(t,e){return cn(t.visibleWrites,e)}function wh(t,e,n,s,i,o,r){let l;const a=jt(t.visibleWrites,e),c=cn(a,Se());if(c!=null)l=c;else if(n!=null)l=Tn(a,n);else return[];if(l=l.withIndex(r),!l.isEmpty()&&!l.isLeafNode()){const u=[],f=r.getCompare(),d=o?l.getReverseIteratorFrom(s,r):l.getIteratorFrom(s,r);let _=d.getNext();for(;_&&u.length<i;)f(_,s)!==0&&u.push(_),_=d.getNext();return u}else return[]}function Ch(){return{visibleWrites:wt.empty(),allWrites:[],lastWriteId:-1}}function Ls(t,e,n,s){return Ya(t.writeTree,t.treePath,e,n,s)}function co(t,e){return gh(t.writeTree,t.treePath,e)}function _r(t,e,n,s){return bh(t.writeTree,t.treePath,e,n,s)}function Fs(t,e){return yh(t.writeTree,Qe(t.treePath,e))}function kh(t,e,n,s,i,o){return wh(t.writeTree,t.treePath,e,n,s,i,o)}function uo(t,e,n){return vh(t.writeTree,t.treePath,e,n)}function Ka(t,e){return Qa(Qe(t.treePath,e),t.writeTree)}function Qa(t,e){return{treePath:t,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eh{constructor(){this.changeMap=new Map}trackChildChange(e){const n=e.type,s=e.childName;x(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),x(s!==".priority","Only non-priority child changes can be tracked.");const i=this.changeMap.get(s);if(i){const o=i.type;if(n==="child_added"&&o==="child_removed")this.changeMap.set(s,es(s,e.snapshotNode,i.snapshotNode));else if(n==="child_removed"&&o==="child_added")this.changeMap.delete(s);else if(n==="child_removed"&&o==="child_changed")this.changeMap.set(s,$n(s,i.oldSnap));else if(n==="child_changed"&&o==="child_added")this.changeMap.set(s,In(s,e.snapshotNode));else if(n==="child_changed"&&o==="child_changed")this.changeMap.set(s,es(s,e.snapshotNode,i.oldSnap));else throw An("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(s,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sh{getCompleteChild(e){return null}getChildAfterChild(e,n,s){return null}}const xa=new Sh;class fo{constructor(e,n,s=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=s}getCompleteChild(e){const n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{const s=this.optCompleteServerCache_!=null?new Qt(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return uo(this.writes_,e,s)}}getChildAfterChild(e,n,s){const i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:an(this.viewCache_),o=kh(this.writes_,i,n,1,s,e);return o.length===0?null:o[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ih(t){return{filter:t}}function Th(t,e){x(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),x(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function Nh(t,e,n,s,i){const o=new Eh;let r,l;if(n.type===yt.OVERWRITE){const c=n;c.source.fromUser?r=Fi(t,e,c.path,c.snap,s,i,o):(x(c.source.fromServer,"Unknown source."),l=c.source.tagged||e.serverCache.isFiltered()&&!ye(c.path),r=Bs(t,e,c.path,c.snap,s,i,l,o))}else if(n.type===yt.MERGE){const c=n;c.source.fromUser?r=Dh(t,e,c.path,c.children,s,i,o):(x(c.source.fromServer,"Unknown source."),l=c.source.tagged||e.serverCache.isFiltered(),r=Bi(t,e,c.path,c.children,s,i,l,o))}else if(n.type===yt.ACK_USER_WRITE){const c=n;c.revert?r=Ph(t,e,c.path,s,i,o):r=Rh(t,e,c.path,c.affectedTree,s,i,o)}else if(n.type===yt.LISTEN_COMPLETE)r=Ah(t,e,n.path,s,o);else throw An("Unknown operation type: "+n.type);const a=o.getChanges();return Oh(e,r,a),{viewCache:r,changes:a}}function Oh(t,e,n){const s=e.eventCache;if(s.isFullyInitialized()){const i=s.getNode().isLeafNode()||s.getNode().isEmpty(),o=Ms(t);(n.length>0||!t.eventCache.isFullyInitialized()||i&&!s.getNode().equals(o)||!s.getNode().getPriority().equals(o.getPriority()))&&n.push(qa(Ms(e)))}}function Xa(t,e,n,s,i,o){const r=e.eventCache;if(Fs(s,n)!=null)return e;{let l,a;if(ye(n))if(x(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const c=an(e),u=c instanceof ue?c:ue.EMPTY_NODE,f=co(s,u);l=t.filter.updateFullNode(e.eventCache.getNode(),f,o)}else{const c=Ls(s,an(e));l=t.filter.updateFullNode(e.eventCache.getNode(),c,o)}else{const c=we(n);if(c===".priority"){x(Kt(n)===1,"Can't have a priority with additional path components");const u=r.getNode();a=e.serverCache.getNode();const f=_r(s,n,u,a);f!=null?l=t.filter.updatePriority(u,f):l=r.getNode()}else{const u=Be(n);let f;if(r.isCompleteForChild(c)){a=e.serverCache.getNode();const d=_r(s,n,r.getNode(),a);d!=null?f=r.getNode().getImmediateChild(c).updateChild(u,d):f=r.getNode().getImmediateChild(c)}else f=uo(s,c,e.serverCache);f!=null?l=t.filter.updateChild(r.getNode(),c,f,u,i,o):l=r.getNode()}}return Gn(e,l,r.isFullyInitialized()||ye(n),t.filter.filtersNodes())}}function Bs(t,e,n,s,i,o,r,l){const a=e.serverCache;let c;const u=r?t.filter:t.filter.getIndexedFilter();if(ye(n))c=u.updateFullNode(a.getNode(),s,null);else if(u.filtersNodes()&&!a.isFiltered()){const _=a.getNode().updateChild(n,s);c=u.updateFullNode(a.getNode(),_,null)}else{const _=we(n);if(!a.isCompleteForPath(n)&&Kt(n)>1)return e;const h=Be(n),v=a.getNode().getImmediateChild(_).updateChild(h,s);_===".priority"?c=u.updatePriority(a.getNode(),v):c=u.updateChild(a.getNode(),_,v,h,xa,null)}const f=Ua(e,c,a.isFullyInitialized()||ye(n),u.filtersNodes()),d=new fo(i,f,o);return Xa(t,f,n,i,d,l)}function Fi(t,e,n,s,i,o,r){const l=e.eventCache;let a,c;const u=new fo(i,e,o);if(ye(n))c=t.filter.updateFullNode(e.eventCache.getNode(),s,r),a=Gn(e,c,!0,t.filter.filtersNodes());else{const f=we(n);if(f===".priority")c=t.filter.updatePriority(e.eventCache.getNode(),s),a=Gn(e,c,l.isFullyInitialized(),l.isFiltered());else{const d=Be(n),_=l.getNode().getImmediateChild(f);let h;if(ye(d))h=s;else{const g=u.getCompleteChild(f);g!=null?Na(d)===".priority"&&g.getChild(Da(d)).isEmpty()?h=g:h=g.updateChild(d,s):h=ue.EMPTY_NODE}if(_.equals(h))a=e;else{const g=t.filter.updateChild(l.getNode(),f,h,d,u,r);a=Gn(e,g,l.isFullyInitialized(),t.filter.filtersNodes())}}}return a}function pr(t,e){return t.eventCache.isCompleteForChild(e)}function Dh(t,e,n,s,i,o,r){let l=e;return s.foreach((a,c)=>{const u=Qe(n,a);pr(e,we(u))&&(l=Fi(t,l,u,c,i,o,r))}),s.foreach((a,c)=>{const u=Qe(n,a);pr(e,we(u))||(l=Fi(t,l,u,c,i,o,r))}),l}function mr(t,e,n){return n.foreach((s,i)=>{e=e.updateChild(s,i)}),e}function Bi(t,e,n,s,i,o,r,l){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let a=e,c;ye(n)?c=s:c=new ze(null).setTree(n,s);const u=e.serverCache.getNode();return c.children.inorderTraversal((f,d)=>{if(u.hasChild(f)){const _=e.serverCache.getNode().getImmediateChild(f),h=mr(t,_,d);a=Bs(t,a,new Me(f),h,i,o,r,l)}}),c.children.inorderTraversal((f,d)=>{const _=!e.serverCache.isCompleteForChild(f)&&d.value===null;if(!u.hasChild(f)&&!_){const h=e.serverCache.getNode().getImmediateChild(f),g=mr(t,h,d);a=Bs(t,a,new Me(f),g,i,o,r,l)}}),a}function Rh(t,e,n,s,i,o,r){if(Fs(i,n)!=null)return e;const l=e.serverCache.isFiltered(),a=e.serverCache;if(s.value!=null){if(ye(n)&&a.isFullyInitialized()||a.isCompleteForPath(n))return Bs(t,e,n,a.getNode().getChild(n),i,o,l,r);if(ye(n)){let c=new ze(null);return a.getNode().forEachChild(Ht,(u,f)=>{c=c.set(new Me(u),f)}),Bi(t,e,n,c,i,o,l,r)}else return e}else{let c=new ze(null);return s.foreach((u,f)=>{const d=Qe(n,u);a.isCompleteForPath(d)&&(c=c.set(u,a.getNode().getChild(d)))}),Bi(t,e,n,c,i,o,l,r)}}function Ah(t,e,n,s,i){const o=e.serverCache,r=Ua(e,o.getNode(),o.isFullyInitialized()||ye(n),o.isFiltered());return Xa(t,r,n,s,xa,i)}function Ph(t,e,n,s,i,o){let r;if(Fs(s,n)!=null)return e;{const l=new fo(s,e,i),a=e.eventCache.getNode();let c;if(ye(n)||we(n)===".priority"){let u;if(e.serverCache.isFullyInitialized())u=Ls(s,an(e));else{const f=e.serverCache.getNode();x(f instanceof ue,"serverChildren would be complete if leaf node"),u=co(s,f)}u=u,c=t.filter.updateFullNode(a,u,o)}else{const u=we(n);let f=uo(s,u,e.serverCache);f==null&&e.serverCache.isCompleteForChild(u)&&(f=a.getImmediateChild(u)),f!=null?c=t.filter.updateChild(a,u,f,Be(n),l,o):e.eventCache.getNode().hasChild(u)?c=t.filter.updateChild(a,u,ue.EMPTY_NODE,Be(n),l,o):c=a,c.isEmpty()&&e.serverCache.isFullyInitialized()&&(r=Ls(s,an(e)),r.isLeafNode()&&(c=t.filter.updateFullNode(c,r,o)))}return r=e.serverCache.isFullyInitialized()||Fs(s,Se())!=null,Gn(e,c,r,t.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mh{constructor(e,n){this.query_=e,this.eventRegistrations_=[];const s=this.query_._queryParams,i=new oo(s.getIndex()),o=Zf(s);this.processor_=Ih(o);const r=n.serverCache,l=n.eventCache,a=i.updateFullNode(ue.EMPTY_NODE,r.getNode(),null),c=o.updateFullNode(ue.EMPTY_NODE,l.getNode(),null),u=new Qt(a,r.isFullyInitialized(),i.filtersNodes()),f=new Qt(c,l.isFullyInitialized(),o.filtersNodes());this.viewCache_=Ys(f,u),this.eventGenerator_=new rh(this.query_)}get query(){return this.query_}}function Lh(t){return t.viewCache_.serverCache.getNode()}function Fh(t){return Ms(t.viewCache_)}function Bh(t,e){const n=an(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!ye(e)&&!n.getImmediateChild(we(e)).isEmpty())?n.getChild(e):null}function gr(t){return t.eventRegistrations_.length===0}function zh(t,e){t.eventRegistrations_.push(e)}function br(t,e,n){const s=[];if(n){x(e==null,"A cancel should cancel all event registrations.");const i=t.query._path;t.eventRegistrations_.forEach(o=>{const r=o.createCancelEvent(n,i);r&&s.push(r)})}if(e){let i=[];for(let o=0;o<t.eventRegistrations_.length;++o){const r=t.eventRegistrations_[o];if(!r.matches(e))i.push(r);else if(e.hasAnyCallback()){i=i.concat(t.eventRegistrations_.slice(o+1));break}}t.eventRegistrations_=i}else t.eventRegistrations_=[];return s}function vr(t,e,n,s){e.type===yt.MERGE&&e.source.queryId!==null&&(x(an(t.viewCache_),"We should always have a full cache before handling merges"),x(Ms(t.viewCache_),"Missing event cache, even though we have a server cache"));const i=t.viewCache_,o=Nh(t.processor_,i,e,n,s);return Th(t.processor_,o.viewCache),x(o.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=o.viewCache,Ja(t,o.changes,o.viewCache.eventCache.getNode(),null)}function Wh(t,e){const n=t.viewCache_.eventCache,s=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(Ue,(o,r)=>{s.push(In(o,r))}),n.isFullyInitialized()&&s.push(qa(n.getNode())),Ja(t,s,n.getNode(),e)}function Ja(t,e,n,s){const i=s?[s]:t.eventRegistrations_;return lh(t.eventGenerator_,e,n,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let zs;class Za{constructor(){this.views=new Map}}function qh(t){x(!zs,"__referenceConstructor has already been defined"),zs=t}function Hh(){return x(zs,"Reference.ts has not been loaded"),zs}function jh(t){return t.views.size===0}function ho(t,e,n,s){const i=e.source.queryId;if(i!==null){const o=t.views.get(i);return x(o!=null,"SyncTree gave us an op for an invalid query."),vr(o,e,n,s)}else{let o=[];for(const r of t.views.values())o=o.concat(vr(r,e,n,s));return o}}function $a(t,e,n,s,i){const o=e._queryIdentifier,r=t.views.get(o);if(!r){let l=Ls(n,i?s:null),a=!1;l?a=!0:s instanceof ue?(l=co(n,s),a=!1):(l=ue.EMPTY_NODE,a=!1);const c=Ys(new Qt(l,a,!1),new Qt(s,i,!1));return new Mh(e,c)}return r}function Uh(t,e,n,s,i,o){const r=$a(t,e,s,i,o);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,r),zh(r,n),Wh(r,n)}function Vh(t,e,n,s){const i=e._queryIdentifier,o=[];let r=[];const l=xt(t);if(i==="default")for(const[a,c]of t.views.entries())r=r.concat(br(c,n,s)),gr(c)&&(t.views.delete(a),c.query._queryParams.loadsAllData()||o.push(c.query));else{const a=t.views.get(i);a&&(r=r.concat(br(a,n,s)),gr(a)&&(t.views.delete(i),a.query._queryParams.loadsAllData()||o.push(a.query)))}return l&&!xt(t)&&o.push(new(Hh())(e._repo,e._path)),{removed:o,events:r}}function ec(t){const e=[];for(const n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function Ut(t,e){let n=null;for(const s of t.views.values())n=n||Bh(s,e);return n}function tc(t,e){if(e._queryParams.loadsAllData())return Qs(t);{const s=e._queryIdentifier;return t.views.get(s)}}function nc(t,e){return tc(t,e)!=null}function xt(t){return Qs(t)!=null}function Qs(t){for(const e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ws;function Gh(t){x(!Ws,"__referenceConstructor has already been defined"),Ws=t}function Yh(){return x(Ws,"Reference.ts has not been loaded"),Ws}let Kh=1;class yr{constructor(e){this.listenProvider_=e,this.syncPointTree_=new ze(null),this.pendingWriteTree_=Ch(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function sc(t,e,n,s,i){return dh(t.pendingWriteTree_,e,n,s,i),i?hs(t,new ln(ja(),e,n)):[]}function tn(t,e,n=!1){const s=fh(t.pendingWriteTree_,e);if(hh(t.pendingWriteTree_,e)){let o=new ze(null);return s.snap!=null?o=o.set(Se(),!0):ft(s.children,r=>{o=o.set(new Me(r),!0)}),hs(t,new Ps(s.path,o,n))}else return[]}function fs(t,e,n){return hs(t,new ln(lo(),e,n))}function Qh(t,e,n){const s=ze.fromObject(n);return hs(t,new ss(lo(),e,s))}function xh(t,e){return hs(t,new ns(lo(),e))}function Xh(t,e,n){const s=po(t,n);if(s){const i=mo(s),o=i.path,r=i.queryId,l=ot(o,e),a=new ns(ao(r),l);return go(t,o,a)}else return[]}function ic(t,e,n,s,i=!1){const o=e._path,r=t.syncPointTree_.get(o);let l=[];if(r&&(e._queryIdentifier==="default"||nc(r,e))){const a=Vh(r,e,n,s);jh(r)&&(t.syncPointTree_=t.syncPointTree_.remove(o));const c=a.removed;if(l=a.events,!i){const u=c.findIndex(d=>d._queryParams.loadsAllData())!==-1,f=t.syncPointTree_.findOnPath(o,(d,_)=>xt(_));if(u&&!f){const d=t.syncPointTree_.subtree(o);if(!d.isEmpty()){const _=e_(d);for(let h=0;h<_.length;++h){const g=_[h],v=g.query,w=ac(t,g);t.listenProvider_.startListening(Kn(v),is(t,v),w.hashFn,w.onComplete)}}}!f&&c.length>0&&!s&&(u?t.listenProvider_.stopListening(Kn(e),null):c.forEach(d=>{const _=t.queryToTagMap.get(xs(d));t.listenProvider_.stopListening(Kn(d),_)}))}t_(t,c)}return l}function oc(t,e,n,s){const i=po(t,s);if(i!=null){const o=mo(i),r=o.path,l=o.queryId,a=ot(r,e),c=new ln(ao(l),a,n);return go(t,r,c)}else return[]}function Jh(t,e,n,s){const i=po(t,s);if(i){const o=mo(i),r=o.path,l=o.queryId,a=ot(r,e),c=ze.fromObject(n),u=new ss(ao(l),a,c);return go(t,r,u)}else return[]}function Zh(t,e,n,s=!1){const i=e._path;let o=null,r=!1;t.syncPointTree_.foreachOnPath(i,(d,_)=>{const h=ot(d,i);o=o||Ut(_,h),r=r||xt(_)});let l=t.syncPointTree_.get(i);l?(r=r||xt(l),o=o||Ut(l,Se())):(l=new Za,t.syncPointTree_=t.syncPointTree_.set(i,l));let a;o!=null?a=!0:(a=!1,o=ue.EMPTY_NODE,t.syncPointTree_.subtree(i).foreachChild((_,h)=>{const g=Ut(h,Se());g&&(o=o.updateImmediateChild(_,g))}));const c=nc(l,e);if(!c&&!e._queryParams.loadsAllData()){const d=xs(e);x(!t.queryToTagMap.has(d),"View does not exist, but we have a tag");const _=n_();t.queryToTagMap.set(d,_),t.tagToQueryMap.set(_,d)}const u=Ks(t.pendingWriteTree_,i);let f=Uh(l,e,n,u,o,a);if(!c&&!r&&!s){const d=tc(l,e);f=f.concat(s_(t,e,d))}return f}function _o(t,e,n){const i=t.pendingWriteTree_,o=t.syncPointTree_.findOnPath(e,(r,l)=>{const a=ot(r,e),c=Ut(l,a);if(c)return c});return Ya(i,e,o,n,!0)}function $h(t,e){const n=e._path;let s=null;t.syncPointTree_.foreachOnPath(n,(c,u)=>{const f=ot(c,n);s=s||Ut(u,f)});let i=t.syncPointTree_.get(n);i?s=s||Ut(i,Se()):(i=new Za,t.syncPointTree_=t.syncPointTree_.set(n,i));const o=s!=null,r=o?new Qt(s,!0,!1):null,l=Ks(t.pendingWriteTree_,e._path),a=$a(i,e,l,o?r.getNode():ue.EMPTY_NODE,o);return Fh(a)}function hs(t,e){return rc(e,t.syncPointTree_,null,Ks(t.pendingWriteTree_,Se()))}function rc(t,e,n,s){if(ye(t.path))return lc(t,e,n,s);{const i=e.get(Se());n==null&&i!=null&&(n=Ut(i,Se()));let o=[];const r=we(t.path),l=t.operationForChild(r),a=e.children.get(r);if(a&&l){const c=n?n.getImmediateChild(r):null,u=Ka(s,r);o=o.concat(rc(l,a,c,u))}return i&&(o=o.concat(ho(i,t,s,n))),o}}function lc(t,e,n,s){const i=e.get(Se());n==null&&i!=null&&(n=Ut(i,Se()));let o=[];return e.children.inorderTraversal((r,l)=>{const a=n?n.getImmediateChild(r):null,c=Ka(s,r),u=t.operationForChild(r);u&&(o=o.concat(lc(u,l,a,c)))}),i&&(o=o.concat(ho(i,t,s,n))),o}function ac(t,e){const n=e.query,s=is(t,n);return{hashFn:()=>(Lh(e)||ue.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return s?Xh(t,n._path,s):xh(t,n._path);{const o=Zd(i,n);return ic(t,n,null,o)}}}}function is(t,e){const n=xs(e);return t.queryToTagMap.get(n)}function xs(t){return t._path.toString()+"$"+t._queryIdentifier}function po(t,e){return t.tagToQueryMap.get(e)}function mo(t){const e=t.indexOf("$");return x(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new Me(t.substr(0,e))}}function go(t,e,n){const s=t.syncPointTree_.get(e);x(s,"Missing sync point for query tag that we're tracking");const i=Ks(t.pendingWriteTree_,e);return ho(s,n,i,null)}function e_(t){return t.fold((e,n,s)=>{if(n&&xt(n))return[Qs(n)];{let i=[];return n&&(i=ec(n)),ft(s,(o,r)=>{i=i.concat(r)}),i}})}function Kn(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(Yh())(t._repo,t._path):t}function t_(t,e){for(let n=0;n<e.length;++n){const s=e[n];if(!s._queryParams.loadsAllData()){const i=xs(s),o=t.queryToTagMap.get(i);t.queryToTagMap.delete(i),t.tagToQueryMap.delete(o)}}}function n_(){return Kh++}function s_(t,e,n){const s=e._path,i=is(t,e),o=ac(t,n),r=t.listenProvider_.startListening(Kn(e),i,o.hashFn,o.onComplete),l=t.syncPointTree_.subtree(s);if(i)x(!xt(l.value),"If we're adding a query, it shouldn't be shadowed");else{const a=l.fold((c,u,f)=>{if(!ye(c)&&u&&xt(u))return[Qs(u).query];{let d=[];return u&&(d=d.concat(ec(u).map(_=>_.query))),ft(f,(_,h)=>{d=d.concat(h)}),d}});for(let c=0;c<a.length;++c){const u=a[c];t.listenProvider_.stopListening(Kn(u),is(t,u))}}return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bo{constructor(e){this.node_=e}getImmediateChild(e){const n=this.node_.getImmediateChild(e);return new bo(n)}node(){return this.node_}}class vo{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){const n=Qe(this.path_,e);return new vo(this.syncTree_,n)}node(){return _o(this.syncTree_,this.path_)}}const i_=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},wr=function(t,e,n){if(!t||typeof t!="object")return t;if(x(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return o_(t[".sv"],e,n);if(typeof t[".sv"]=="object")return r_(t[".sv"],e);x(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},o_=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:x(!1,"Unexpected server value: "+t)}},r_=function(t,e,n){t.hasOwnProperty("increment")||x(!1,"Unexpected server value: "+JSON.stringify(t,null,2));const s=t.increment;typeof s!="number"&&x(!1,"Unexpected increment value: "+s);const i=e.node();if(x(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return s;const r=i.getValue();return typeof r!="number"?s:r+s},l_=function(t,e,n,s){return yo(e,new vo(n,t),s)},cc=function(t,e,n){return yo(t,new bo(e),n)};function yo(t,e,n){const s=t.getPriority().val(),i=wr(s,e.getImmediateChild(".priority"),n);let o;if(t.isLeafNode()){const r=t,l=wr(r.getValue(),e,n);return l!==r.getValue()||i!==r.getPriority().val()?new xe(l,Je(i)):t}else{const r=t;return o=r,i!==r.getPriority().val()&&(o=o.updatePriority(new xe(i))),r.forEachChild(Ue,(l,a)=>{const c=yo(a,e.getImmediateChild(l),n);c!==a&&(o=o.updateImmediateChild(l,c))}),o}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wo{constructor(e="",n=null,s={children:{},childCount:0}){this.name=e,this.parent=n,this.node=s}}function Co(t,e){let n=e instanceof Me?e:new Me(e),s=t,i=we(n);for(;i!==null;){const o=Sn(s.node.children,i)||{children:{},childCount:0};s=new wo(i,s,o),n=Be(n),i=we(n)}return s}function Ln(t){return t.node.value}function uc(t,e){t.node.value=e,zi(t)}function dc(t){return t.node.childCount>0}function a_(t){return Ln(t)===void 0&&!dc(t)}function Xs(t,e){ft(t.node.children,(n,s)=>{e(new wo(n,t,s))})}function fc(t,e,n,s){n&&!s&&e(t),Xs(t,i=>{fc(i,e,!0,s)}),n&&s&&e(t)}function c_(t,e,n){let s=n?t:t.parent;for(;s!==null;){if(e(s))return!0;s=s.parent}return!1}function _s(t){return new Me(t.parent===null?t.name:_s(t.parent)+"/"+t.name)}function zi(t){t.parent!==null&&u_(t.parent,t.name,t)}function u_(t,e,n){const s=a_(n),i=Rt(t.node.children,e);s&&i?(delete t.node.children[e],t.node.childCount--,zi(t)):!s&&!i&&(t.node.children[e]=n.node,t.node.childCount++,zi(t))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d_=/[\[\].#$\/\u0000-\u001F\u007F]/,f_=/[\[\].#$\u0000-\u001F\u007F]/,bi=10*1024*1024,hc=function(t){return typeof t=="string"&&t.length!==0&&!d_.test(t)},_c=function(t){return typeof t=="string"&&t.length!==0&&!f_.test(t)},h_=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),_c(t)},Cr=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!Zi(t)||t&&typeof t=="object"&&Rt(t,".sv")},pc=function(t,e,n,s){s&&e===void 0||ko(Xi(t,"value"),e,n)},ko=function(t,e,n){const s=n instanceof Me?new Af(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+Zt(s));if(typeof e=="function")throw new Error(t+"contains a function "+Zt(s)+" with contents = "+e.toString());if(Zi(e))throw new Error(t+"contains "+e.toString()+" "+Zt(s));if(typeof e=="string"&&e.length>bi/3&&Vs(e)>bi)throw new Error(t+"contains a string greater than "+bi+" utf8 bytes "+Zt(s)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,o=!1;if(ft(e,(r,l)=>{if(r===".value")i=!0;else if(r!==".priority"&&r!==".sv"&&(o=!0,!hc(r)))throw new Error(t+" contains an invalid key ("+r+") "+Zt(s)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);Pf(s,r),ko(t,l,s),Mf(s)}),i&&o)throw new Error(t+' contains ".value" child '+Zt(s)+" in addition to actual children.")}},mc=function(t,e,n,s){if(!(s&&n===void 0)&&!_c(n))throw new Error(Xi(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},__=function(t,e,n,s){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),mc(t,e,n,s)},Eo=function(t,e){if(we(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},p_=function(t,e){const n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!hc(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!h_(n))throw new Error(Xi(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m_{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function gc(t,e){let n=null;for(let s=0;s<e.length;s++){const i=e[s],o=i.getPath();n!==null&&!Ra(o,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:o}),n.events.push(i)}n&&t.eventLists_.push(n)}function Ot(t,e,n){gc(t,n),g_(t,s=>vt(s,e)||vt(e,s))}function g_(t,e){t.recursionDepth_++;let n=!0;for(let s=0;s<t.eventLists_.length;s++){const i=t.eventLists_[s];if(i){const o=i.path;e(o)?(b_(t.eventLists_[s]),t.eventLists_[s]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function b_(t){for(let e=0;e<t.events.length;e++){const n=t.events[e];if(n!==null){t.events[e]=null;const s=n.getEventRunner();sn&&tt("event: "+n.toString()),Mn(s)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v_="repo_interrupt",y_=25;class w_{constructor(e,n,s,i){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=s,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new m_,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=As(),this.transactionQueueTree_=new wo,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function C_(t,e,n){if(t.stats_=to(t.repoInfo_),t.forceRestClient_||nf())t.server_=new Rs(t.repoInfo_,(s,i,o,r)=>{kr(t,s,i,o,r)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>Er(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Ke(n)}catch(s){throw new Error("Invalid authOverride provided: "+s)}}t.persistentConnection_=new Pt(t.repoInfo_,e,(s,i,o,r)=>{kr(t,s,i,o,r)},s=>{Er(t,s)},s=>{k_(t,s)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(s=>{t.server_.refreshAuthToken(s)}),t.appCheckProvider_.addTokenChangeListener(s=>{t.server_.refreshAppCheckToken(s.token)}),t.statsReporter_=af(t.repoInfo_,()=>new oh(t.stats_,t.server_)),t.infoData_=new eh,t.infoSyncTree_=new yr({startListening:(s,i,o,r)=>{let l=[];const a=t.infoData_.getNode(s._path);return a.isEmpty()||(l=fs(t.infoSyncTree_,s._path,a),setTimeout(()=>{r("ok")},0)),l},stopListening:()=>{}}),Io(t,"connected",!1),t.serverSyncTree_=new yr({startListening:(s,i,o,r)=>(t.server_.listen(s,o,i,(l,a)=>{const c=r(l,a);Ot(t.eventQueue_,s._path,c)}),[]),stopListening:(s,i)=>{t.server_.unlisten(s,i)}})}function bc(t){const n=t.infoData_.getNode(new Me(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function So(t){return i_({timestamp:bc(t)})}function kr(t,e,n,s,i){t.dataUpdateCount++;const o=new Me(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let r=[];if(i)if(s){const a=Ss(n,c=>Je(c));r=Jh(t.serverSyncTree_,o,a,i)}else{const a=Je(n);r=oc(t.serverSyncTree_,o,a,i)}else if(s){const a=Ss(n,c=>Je(c));r=Qh(t.serverSyncTree_,o,a)}else{const a=Je(n);r=fs(t.serverSyncTree_,o,a)}let l=o;r.length>0&&(l=Zs(t,o)),Ot(t.eventQueue_,l,r)}function Er(t,e){Io(t,"connected",e),e===!1&&I_(t)}function k_(t,e){ft(e,(n,s)=>{Io(t,n,s)})}function Io(t,e,n){const s=new Me("/.info/"+e),i=Je(n);t.infoData_.updateSnapshot(s,i);const o=fs(t.infoSyncTree_,s,i);Ot(t.eventQueue_,s,o)}function vc(t){return t.nextWriteId_++}function E_(t,e,n){const s=$h(t.serverSyncTree_,e);return s!=null?Promise.resolve(s):t.server_.get(e).then(i=>{const o=Je(i).withIndex(e._queryParams.getIndex());Zh(t.serverSyncTree_,e,n,!0);let r;if(e._queryParams.loadsAllData())r=fs(t.serverSyncTree_,e._path,o);else{const l=is(t.serverSyncTree_,e);r=oc(t.serverSyncTree_,e._path,o,l)}return Ot(t.eventQueue_,e._path,r),ic(t.serverSyncTree_,e,n,null,!0),o},i=>(Js(t,"get for query "+Ke(e)+" failed: "+i),Promise.reject(new Error(i))))}function S_(t,e,n,s,i){Js(t,"set",{path:e.toString(),value:n,priority:s});const o=So(t),r=Je(n,s),l=_o(t.serverSyncTree_,e),a=cc(r,l,o),c=vc(t),u=sc(t.serverSyncTree_,e,a,c,!0);gc(t.eventQueue_,u),t.server_.put(e.toString(),r.val(!0),(d,_)=>{const h=d==="ok";h||ut("set at "+e+" failed: "+d);const g=tn(t.serverSyncTree_,c,!h);Ot(t.eventQueue_,e,g),N_(t,i,d,_)});const f=Ec(t,e);Zs(t,f),Ot(t.eventQueue_,f,[])}function I_(t){Js(t,"onDisconnectEvents");const e=So(t),n=As();Pi(t.onDisconnect_,Se(),(i,o)=>{const r=l_(i,o,t.serverSyncTree_,e);Ha(n,i,r)});let s=[];Pi(n,Se(),(i,o)=>{s=s.concat(fs(t.serverSyncTree_,i,o));const r=Ec(t,i);Zs(t,r)}),t.onDisconnect_=As(),Ot(t.eventQueue_,Se(),s)}function T_(t){t.persistentConnection_&&t.persistentConnection_.interrupt(v_)}function Js(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),tt(n,...e)}function N_(t,e,n,s){e&&Mn(()=>{if(n==="ok")e(null);else{const i=(n||"error").toUpperCase();let o=i;s&&(o+=": "+s);const r=new Error(o);r.code=i,e(r)}})}function yc(t,e,n){return _o(t.serverSyncTree_,e,n)||ue.EMPTY_NODE}function To(t,e=t.transactionQueueTree_){if(e||$s(t,e),Ln(e)){const n=Cc(t,e);x(n.length>0,"Sending zero length transaction queue"),n.every(i=>i.status===0)&&O_(t,_s(e),n)}else dc(e)&&Xs(e,n=>{To(t,n)})}function O_(t,e,n){const s=n.map(c=>c.currentWriteId),i=yc(t,e,s);let o=i;const r=i.hash();for(let c=0;c<n.length;c++){const u=n[c];x(u.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=1,u.retryCount++;const f=ot(e,u.path);o=o.updateChild(f,u.currentOutputSnapshotRaw)}const l=o.val(!0),a=e;t.server_.put(a.toString(),l,c=>{Js(t,"transaction put response",{path:a.toString(),status:c});let u=[];if(c==="ok"){const f=[];for(let d=0;d<n.length;d++)n[d].status=2,u=u.concat(tn(t.serverSyncTree_,n[d].currentWriteId)),n[d].onComplete&&f.push(()=>n[d].onComplete(null,!0,n[d].currentOutputSnapshotResolved)),n[d].unwatcher();$s(t,Co(t.transactionQueueTree_,e)),To(t,t.transactionQueueTree_),Ot(t.eventQueue_,e,u);for(let d=0;d<f.length;d++)Mn(f[d])}else{if(c==="datastale")for(let f=0;f<n.length;f++)n[f].status===3?n[f].status=4:n[f].status=0;else{ut("transaction at "+a.toString()+" failed: "+c);for(let f=0;f<n.length;f++)n[f].status=4,n[f].abortReason=c}Zs(t,e)}},r)}function Zs(t,e){const n=wc(t,e),s=_s(n),i=Cc(t,n);return D_(t,i,s),s}function D_(t,e,n){if(e.length===0)return;const s=[];let i=[];const r=e.filter(l=>l.status===0).map(l=>l.currentWriteId);for(let l=0;l<e.length;l++){const a=e[l],c=ot(n,a.path);let u=!1,f;if(x(c!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),a.status===4)u=!0,f=a.abortReason,i=i.concat(tn(t.serverSyncTree_,a.currentWriteId,!0));else if(a.status===0)if(a.retryCount>=y_)u=!0,f="maxretry",i=i.concat(tn(t.serverSyncTree_,a.currentWriteId,!0));else{const d=yc(t,a.path,r);a.currentInputSnapshot=d;const _=e[l].update(d.val());if(_!==void 0){ko("transaction failed: Data returned ",_,a.path);let h=Je(_);typeof _=="object"&&_!=null&&Rt(_,".priority")||(h=h.updatePriority(d.getPriority()));const v=a.currentWriteId,w=So(t),C=cc(h,d,w);a.currentOutputSnapshotRaw=h,a.currentOutputSnapshotResolved=C,a.currentWriteId=vc(t),r.splice(r.indexOf(v),1),i=i.concat(sc(t.serverSyncTree_,a.path,C,a.currentWriteId,a.applyLocally)),i=i.concat(tn(t.serverSyncTree_,v,!0))}else u=!0,f="nodata",i=i.concat(tn(t.serverSyncTree_,a.currentWriteId,!0))}Ot(t.eventQueue_,n,i),i=[],u&&(e[l].status=2,function(d){setTimeout(d,Math.floor(0))}(e[l].unwatcher),e[l].onComplete&&(f==="nodata"?s.push(()=>e[l].onComplete(null,!1,e[l].currentInputSnapshot)):s.push(()=>e[l].onComplete(new Error(f),!1,null))))}$s(t,t.transactionQueueTree_);for(let l=0;l<s.length;l++)Mn(s[l]);To(t,t.transactionQueueTree_)}function wc(t,e){let n,s=t.transactionQueueTree_;for(n=we(e);n!==null&&Ln(s)===void 0;)s=Co(s,n),e=Be(e),n=we(e);return s}function Cc(t,e){const n=[];return kc(t,e,n),n.sort((s,i)=>s.order-i.order),n}function kc(t,e,n){const s=Ln(e);if(s)for(let i=0;i<s.length;i++)n.push(s[i]);Xs(e,i=>{kc(t,i,n)})}function $s(t,e){const n=Ln(e);if(n){let s=0;for(let i=0;i<n.length;i++)n[i].status!==2&&(n[s]=n[i],s++);n.length=s,uc(e,n.length>0?n:void 0)}Xs(e,s=>{$s(t,s)})}function Ec(t,e){const n=_s(wc(t,e)),s=Co(t.transactionQueueTree_,e);return c_(s,i=>{vi(t,i)}),vi(t,s),fc(s,i=>{vi(t,i)}),n}function vi(t,e){const n=Ln(e);if(n){const s=[];let i=[],o=-1;for(let r=0;r<n.length;r++)n[r].status===3||(n[r].status===1?(x(o===r-1,"All SENT items should be at beginning of queue."),o=r,n[r].status=3,n[r].abortReason="set"):(x(n[r].status===0,"Unexpected transaction status in abort"),n[r].unwatcher(),i=i.concat(tn(t.serverSyncTree_,n[r].currentWriteId,!0)),n[r].onComplete&&s.push(n[r].onComplete.bind(null,new Error("set"),!1,null))));o===-1?uc(e,void 0):n.length=o+1,Ot(t.eventQueue_,_s(e),i);for(let r=0;r<s.length;r++)Mn(s[r])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R_(t){let e="";const n=t.split("/");for(let s=0;s<n.length;s++)if(n[s].length>0){let i=n[s];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function A_(t){const e={};t.charAt(0)==="?"&&(t=t.substring(1));for(const n of t.split("&")){if(n.length===0)continue;const s=n.split("=");s.length===2?e[decodeURIComponent(s[0])]=decodeURIComponent(s[1]):ut(`Invalid query segment '${n}' in query '${t}'`)}return e}const Sr=function(t,e){const n=P_(t),s=n.namespace;n.domain==="firebase.com"&&Mt(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!s||s==="undefined")&&n.domain!=="localhost"&&Mt("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||Kd();const i=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new va(n.host,n.secure,s,i,e,"",s!==n.subdomain),path:new Me(n.pathString)}},P_=function(t){let e="",n="",s="",i="",o="",r=!0,l="https",a=443;if(typeof t=="string"){let c=t.indexOf("//");c>=0&&(l=t.substring(0,c-1),t=t.substring(c+2));let u=t.indexOf("/");u===-1&&(u=t.length);let f=t.indexOf("?");f===-1&&(f=t.length),e=t.substring(0,Math.min(u,f)),u<f&&(i=R_(t.substring(u,f)));const d=A_(t.substring(Math.min(t.length,f)));c=e.indexOf(":"),c>=0?(r=l==="https"||l==="wss",a=parseInt(e.substring(c+1),10)):c=e.length;const _=e.slice(0,c);if(_.toLowerCase()==="localhost")n="localhost";else if(_.split(".").length<=2)n=_;else{const h=e.indexOf(".");s=e.substring(0,h).toLowerCase(),n=e.substring(h+1),o=s}"ns"in d&&(o=d.ns)}return{host:e,port:a,domain:n,subdomain:s,secure:r,scheme:l,pathString:i,namespace:o}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ir="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",M_=function(){let t=0;const e=[];return function(n){const s=n===t;t=n;let i;const o=new Array(8);for(i=7;i>=0;i--)o[i]=Ir.charAt(n%64),n=Math.floor(n/64);x(n===0,"Cannot push at time == 0");let r=o.join("");if(s){for(i=11;i>=0&&e[i]===63;i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(Math.random()*64);for(i=0;i<12;i++)r+=Ir.charAt(e[i]);return x(r.length===20,"nextPushId: Length should be 20."),r}}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L_{constructor(e,n,s,i){this.eventType=e,this.eventRegistration=n,this.snapshot=s,this.prevName=i}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+Ke(this.snapshot.exportVal())}}class F_{constructor(e,n,s){this.eventRegistration=e,this.error=n,this.path=s}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B_{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return x(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ei{constructor(e,n,s,i){this._repo=e,this._path=n,this._queryParams=s,this._orderByCalled=i}get key(){return ye(this._path)?null:Na(this._path)}get ref(){return new Ft(this._repo,this._path)}get _queryIdentifier(){const e=cr(this._queryParams),n=$i(e);return n==="{}"?"default":n}get _queryObject(){return cr(this._queryParams)}isEqual(e){if(e=Xt(e),!(e instanceof ei))return!1;const n=this._repo===e._repo,s=Ra(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return n&&s&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+Rf(this._path)}}function z_(t,e){if(t._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function W_(t){let e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===Ht){const s="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==rn)throw new Error(s);if(typeof e!="string")throw new Error(i)}if(t.hasEnd()){if(t.getIndexEndName()!==Yt)throw new Error(s);if(typeof n!="string")throw new Error(i)}}else if(t.getIndex()===Ue){if(e!=null&&!Cr(e)||n!=null&&!Cr(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(x(t.getIndex()instanceof za||t.getIndex()===Wa,"unknown index type."),e!=null&&typeof e=="object"||n!=null&&typeof n=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}class Ft extends ei{constructor(e,n){super(e,n,new ro,!1)}get parent(){const e=Da(this._path);return e===null?null:new Ft(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}class os{constructor(e,n,s){this._node=e,this.ref=n,this._index=s}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const n=new Me(e),s=Lt(this.ref,e);return new os(this._node.getChild(n),s,Ue)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(s,i)=>e(new os(i,Lt(this.ref,s),Ue)))}hasChild(e){const n=new Me(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function Nn(t,e){return t=Xt(t),t._checkNotDeleted("ref"),e!==void 0?Lt(t._root,e):t._root}function Lt(t,e){return t=Xt(t),we(t._path)===null?__("child","path",e,!1):mc("child","path",e,!1),new Ft(t._repo,Qe(t._path,e))}function q_(t,e){t=Xt(t),Eo("push",t._path),pc("push",e,t._path,!0);const n=bc(t._repo),s=M_(n),i=Lt(t,s),o=Lt(t,s);let r;return e!=null?r=ti(o,e).then(()=>o):r=Promise.resolve(o),i.then=r.then.bind(r),i.catch=r.then.bind(r,void 0),i}function H_(t){return Eo("remove",t._path),ti(t,null)}function ti(t,e){t=Xt(t),Eo("set",t._path),pc("set",e,t._path,!1);const n=new Us;return S_(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function Sc(t){t=Xt(t);const e=new B_(()=>{}),n=new No(e);return E_(t._repo,t,n).then(s=>new os(s,new Ft(t._repo,t._path),t._queryParams.getIndex()))}class No{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){const s=n._queryParams.getIndex();return new L_("value",this,new os(e.snapshotNode,new Ft(n._repo,n._path),s))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new F_(this,e,n):null}matches(e){return e instanceof No?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}class j_{}class U_ extends j_{_apply(e){z_(e,"orderByKey");const n=$f(e._queryParams,Ht);return W_(n),new ei(e._repo,e._path,n,!0)}}function Ic(){return new U_}function Tc(t,...e){let n=Xt(t);for(const s of e)n=s._apply(n);return n}qh(Ft);Gh(Ft);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V_="FIREBASE_DATABASE_EMULATOR_HOST",Wi={};let G_=!1;function Y_(t,e,n,s){t.repoInfo_=new va(`${e}:${n}`,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0),s&&(t.authTokenProvider_=s)}function K_(t,e,n,s,i){let o=s||t.options.databaseURL;o===void 0&&(t.options.projectId||Mt("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),tt("Using default host for project ",t.options.projectId),o=`${t.options.projectId}-default-rtdb.firebaseio.com`);let r=Sr(o,i),l=r.repoInfo,a,c;typeof process<"u"&&process.env&&(c=process.env[V_]),c?(a=!0,o=`http://${c}?ns=${l.namespace}`,r=Sr(o,i),l=r.repoInfo):a=!r.repoInfo.secure;const u=i&&a?new yn(yn.OWNER):new of(t.name,t.options,e);p_("Invalid Firebase Database URL",r),ye(r.path)||Mt("Database URL must point to the root of a Firebase Database (not including a child path).");const f=x_(l,t,u,new sf(t.name,n));return new X_(f,t)}function Q_(t,e){const n=Wi[e];(!n||n[t.key]!==t)&&Mt(`Database ${e}(${t.repoInfo_}) has already been deleted.`),T_(t),delete n[t.key]}function x_(t,e,n,s){let i=Wi[e.name];i||(i={},Wi[e.name]=i);let o=i[t.toURLString()];return o&&Mt("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),o=new w_(t,G_,n,s),i[t.toURLString()]=o,o}class X_{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(C_(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Ft(this._repo,Se())),this._rootInternal}_delete(){return this._rootInternal!==null&&(Q_(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Mt("Cannot call "+e+" on a deleted database.")}}function J_(t=Dd(),e){const n=Id(t,"database").getImmediate({identifier:e});if(!n._instanceStarted){const s=bu("database");s&&Z_(n,...s)}return n}function Z_(t,e,n,s={}){t=Xt(t),t._checkNotDeleted("useEmulator"),t._instanceStarted&&Mt("Cannot call useEmulator() after instance has already been initialized.");const i=t._repoInternal;let o;if(i.repoInfo_.nodeAdmin)s.mockUserToken&&Mt('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),o=new yn(yn.OWNER);else if(s.mockUserToken){const r=typeof s.mockUserToken=="string"?s.mockUserToken:vu(s.mockUserToken,t.app.options.projectId);o=new yn(r)}Y_(i,e,n,o)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $_(t){jd(Od),Ts(new Xn("database",(e,{instanceIdentifier:n})=>{const s=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),o=e.getProvider("app-check-internal");return K_(s,i,o,n)},"PUBLIC").setMultipleInstances(!0)),bn(Yo,Ko,t),bn(Yo,Ko,"esm2017")}Pt.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};Pt.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};$_();var qi={},Nc={},ni={};Object.defineProperty(ni,"__esModule",{value:!0});ni.rotx=void 0;function ep(t,e){return t.replace(/[a-zA-Z]/g,function(n){return String.fromCharCode((n<="Z"?90:122)>=(n=n.charCodeAt(0)+e)?n:n-26)})}ni.rotx=ep;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.rotx=void 0;var e=ni;Object.defineProperty(t,"rotx",{enumerable:!0,get:function(){return e.rotx}})})(Nc);var Oc={},si={};Object.defineProperty(si,"__esModule",{value:!0});si.base64=void 0;class tp{encode(e){return typeof btoa>"u"?Buffer.from(e,"binary").toString("base64"):btoa(e)}decode(e){return typeof atob>"u"?Buffer.from(e,"base64").toString("binary"):atob(e)}}const np=new tp;si.base64=np;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.base64=void 0;var e=si;Object.defineProperty(t,"base64",{enumerable:!0,get:function(){return e.base64}})})(Oc);var Dc={},ii={};Object.defineProperty(ii,"__esModule",{value:!0});ii.hex=void 0;class sp{encode(e){let n="",s="";for(let i=0;i<e.length;i++)n=e.charCodeAt(i).toString(16),s+=("000"+n).slice(-4);return s}decode(e){let n=e.match(/.{1,4}/g)||[],s="";for(let i=0;i<n.length;i++)s+=String.fromCharCode(parseInt(n[i],16));return s}}const ip=new sp;ii.hex=ip;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.hex=void 0;var e=ii;Object.defineProperty(t,"hex",{enumerable:!0,get:function(){return e.hex}})})(Dc);(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.hex=t.base64=t.rotx=void 0;var e=Nc;Object.defineProperty(t,"rotx",{enumerable:!0,get:function(){return e.rotx}});var n=Oc;Object.defineProperty(t,"base64",{enumerable:!0,get:function(){return n.base64}});var s=Dc;Object.defineProperty(t,"hex",{enumerable:!0,get:function(){return s.hex}})})(qi);let op={ixqSmg:"IQhiAgIPDNBgKzMmPcWG9XWqEsxI2uQ70F5X1rY",icbpLwuiqv:"nk-d3-8j3n9.nqzmjiamixx.kwu",libijiamCZT:"pbbxa://nk-d3-8j3n9-lmnictb-zblj.mczwxm-emab1.nqzmjiamlibijiam.ixx",xzwrmkbQl:"nk-d3-8j3n9",abwziomJcksmb:"nk-d3-8j3n9.ixxaxwb.kwu",umaaioqvoAmvlmzQl:"31377888705",ixxQl:"1:31377888705:emj:3018l8nk0i07m867mk0j40"},Rc={};for(let[t,e]of Object.entries(op))Rc[qi.rotx(t,18)]=qi.rotx(e,18);let On={armor:"Armor",magicDmg:"Magic",meleeDmg:"Melee",rangedDmg:"Ranged",hpRegen:"HP Regen",endurance:"Endurance",sightRange:"Sight Range",walkSpeed:"Walk Speed",jumpPower:"Jump Power",ammoReturn:"Ammo Return",height:"Height"},rs=["head","body","legs","feet","neck","back","ring","misc"],oi={name:"",stats:{armor:0,magicDmg:0,meleeDmg:0,rangedDmg:0,hpRegen:0,endurance:0,sightRange:0,walkSpeed:0,jumpPower:0,ammoReturn:0,height:0},cost:{min:0,max:0},image:"",link:""},ri={name:"",info:{type:"",special:""},moves:[],cost:{min:0,max:0},image:"",link:""},Vt=[...Array(5).keys()].map(t=>++t),Dn=J_(na(Rc)),rp=["head","body","legs","feet","neck","back","ring","misc","gear","sets","bonuses"],Ac={0:"th",1:"st",2:"nd",3:"rd",4:"th",5:"th",6:"th",7:"th",8:"th",9:"th"};function Pc(t,e){let n=!1;for(let s of[t,e])for(let i in s)if(s[i].name){n=!0;break}Qi.set(n),at.set(null),window.history.replaceState(null,null,location.origin+location.pathname)}function Oo(t,e){let n=2.8,s=e.split(" ").length,i=t.querySelector("span");if(i.style.removeProperty("font-size"),s>2&&e.length/s>=5){for(;i.offsetHeight>t.offsetHeight*.75;)n-=.05,i.style.fontSize=`calc(var(--u) * ${n})`;return n<2.8}return null}function lp(t,e){let n=2.8,s=t.querySelector("span");for(s.style.removeProperty("font-size");s.offsetWidth>t.offsetWidth;)n-=.05,s.style.fontSize=`calc(var(--u) * ${n})`;for(;s.offsetHeight>t.offsetHeight*.75&&e;)console.log("C"),n-=.05,s.style.fontSize=`calc(var(--u) * ${n})`;return n<2.8?n:null}function ap(t){let e=2.35,n=t.querySelector(".tooltip");for(n.style.removeProperty("font-size");n.offsetHeight>t.offsetHeight*1.125;)e-=.02,n.style.fontSize=`calc(var(--u) * ${e})`}function cp(t){document.activeElement==document.body&&t.key=="Tab"&&(t.preventDefault(),document.querySelector(`.promptCont [id*='${t.shiftKey?"last":"first"}Focusable']`).focus())}function Mc(t,e){let n=t.toLowerCase();for(let s in e)s.toLowerCase().includes(n)&&!e[s].classList.contains("filtered")?e[s].classList.remove("hidden"):e[s].classList.add("hidden")}function qs(t,e){e&&setTimeout(()=>{t.focus(),t.click(),t.select()})}function pt(t){t.shiftKey&&t.key=="Tab"&&t.preventDefault()}function mt(t){t.key=="Tab"&&!t.shiftKey&&t.preventDefault()}function Hs(t,e){let n=/[^a-zA-Z0-9~!#$%^&*()\-_+[\]{}\\|;:'",.<>/? ]/g;return t.replace(n,"").replaceAll(`
`,"").replace(/^ /,"").slice(0,e)}function Hi(t,e,n){(!t.maxLength||t.maxLength!=n)&&e.length>=n&&(t.maxLength=n)}function Lc(t,e){t={...t},e={...e};for(let n of rs)t[n]?t[n]=t[n].name:t[n]="";for(let n of Vt)e[n]?e[n]=e[n].name:e[n]="";return{eq:t,gear:e}}function Do(){window.history.replaceState(null,null,location.origin+location.pathname+"?ls=true")}function wn(t){t.target.closest("button").blur()}function up(t){let e,n,s,i,o,r,l,a,c,u;return{c(){e=b("li"),n=b("button"),s=b("img"),o=N(),r=b("span"),r.textContent=`${t[4]}`,l=N(),a=b("iconify-icon"),nt(s.src,i=t[0].image)||m(s,"src",i),m(s,"alt",""),Ze(a,"icon","maki:cross"),ee(e,"selectedItem",t[2])},m(f,d){F(f,e,d),p(e,n),p(n,s),p(n,o),p(n,r),p(n,l),p(n,a),t[13](e),c||(u=[Pl(t[5].call(null,r)),M(n,"click",t[6]),M(n,"mouseenter",t[9]),M(n,"focusin",t[10]),M(n,"mouseleave",t[11]),M(n,"focusout",t[12])],c=!0)},p(f,[d]){d&1&&!nt(s.src,i=f[0].image)&&m(s,"src",i),d&4&&ee(e,"selectedItem",f[2])},i:se,o:se,d(f){f&&L(e),t[13](null),c=!1,ge(u)}}}function dp(t,e,n){let s,i,o,r,l,a;K(t,lt,P=>n(14,s=P)),K(t,gn,P=>n(15,i=P)),K(t,Ct,P=>n(16,o=P)),K(t,kt,P=>n(17,r=P)),K(t,Nt,P=>n(18,l=P)),K(t,Ki,P=>n(19,a=P));let{itemData:c,slotOpen:u,eqSlotName:f}=e;const d=Dt();let _,h=!1,g=c.name,v;function w(P){setTimeout(()=>{Oo(_,g)&&a.push({node:_,itemName:g})})}function C(P){if(u||!u&&P.isTrusted==!1){d("itemSelect",{element:_,trusted:P.isTrusted}),_.classList.contains("selectedItem")||n(2,h=!1),n(2,h=!h),n(7,u=!1),G(kt,r[f]=h?c:oi,r),Pc(r,l);for(let Y of Object.keys(On)){G(lt,s[Y]=0,s);for(let j in r)r[j].noStats||(G(lt,s[Y]+=r[j].stats[Y],s),G(lt,s[Y]=Math.round(s[Y]*10)/10,s))}for(let Y of o.bonuses)if(i[Y.name])for(let j in s)G(lt,s[j]+=Y.stats[j],s),G(lt,s[j]=Math.round(s[j]*10)/10,s)}}const y=()=>n(3,v=!0),E=()=>n(3,v=!0),A=()=>n(3,v=!1),O=()=>n(3,v=!1);function T(P){te[P?"unshift":"push"](()=>{_=P,n(1,_)})}return t.$$set=P=>{"itemData"in P&&n(0,c=P.itemData),"slotOpen"in P&&n(7,u=P.slotOpen),"eqSlotName"in P&&n(8,f=P.eqSlotName)},[c,_,h,v,g,w,C,u,f,y,E,A,O,T]}class fp extends Ne{constructor(e){super(),Te(this,e,dp,up,pe,{itemData:0,slotOpen:7,eqSlotName:8})}}function hp(t){let e,n,s,i,o,r,l,a,c,u,f,d;return{c(){e=b("li"),n=b("button"),s=b("img"),o=N(),r=b("span"),r.textContent=`${t[5]}`,l=N(),a=b("iconify-icon"),nt(s.src,i=t[0].image)||m(s,"src",i),m(s,"alt",""),Ze(a,"icon",c=t[4]?"heroicons-solid:switch-vertical":"maki:cross"),n.disabled=u=!t[3]&&!t[4],ee(e,"selectedItem",t[1]),ee(e,"non-eligible",!t[3]&&!t[4]),ee(e,"switchable",t[4])},m(_,h){F(_,e,h),p(e,n),p(n,s),p(n,o),p(n,r),p(n,l),p(n,a),t[13](e),f||(d=[Pl(t[6].call(null,r)),M(n,"click",t[7])],f=!0)},p(_,[h]){h&1&&!nt(s.src,i=_[0].image)&&m(s,"src",i),h&16&&c!==(c=_[4]?"heroicons-solid:switch-vertical":"maki:cross")&&Ze(a,"icon",c),h&24&&u!==(u=!_[3]&&!_[4])&&(n.disabled=u),h&2&&ee(e,"selectedItem",_[1]),h&24&&ee(e,"non-eligible",!_[3]&&!_[4]),h&16&&ee(e,"switchable",_[4])},i:se,o:se,d(_){_&&L(e),t[13](null),f=!1,ge(d)}}}function _p(t,e,n){let s,i,o,r,l;K(t,Nt,O=>n(11,s=O)),K(t,$,O=>n(12,i=O)),K(t,kt,O=>n(14,o=O)),K(t,En,O=>n(15,r=O)),K(t,Ki,O=>n(16,l=O));let{itemData:a,slotOpen:c,index:u,weaponExpand:f}=e;const d=Dt();let _,h=!1,g=!0,v=!1,w=a.name,C={"Orange Salamander":["Green Salamander","Purple Salamander"],"Green Salamander":["Orange Salamander","Purple Salamander"],"Purple Salamander":["Orange Salamander","Green Salamander"],"White Salamander":["Black Salamander","Gold Salamander"],"Black Salamander":["White Salamander","Gold Salamander"],"Gold Salamander":["White Salamander","Black Salamander"]};function y(O){setTimeout(()=>{Oo(_,w)&&l.push({node:_,itemName:w})})}function E(O){g&&(c||!c&&O.isTrusted==!1)&&(a.tool&&f&&d("toolSelect"),d("itemSelect",{element:_,trusted:O.isTrusted}),_.classList.contains("selectedItem")||n(1,h=!1),n(8,c=!1),v?setTimeout(()=>{r[u][w].querySelector("button").click(),r[Object.keys(s).find(T=>s[T].name==w)][s[u]&&s[u].name?s[u].name:w].querySelector("button").click(),n(3,g=!0),n(4,v=!1)},5):(n(1,h=!h),G(Nt,s[u]=h?a:ri,s)),Pc(o,s))}function A(O){te[O?"unshift":"push"](()=>{_=O,n(2,_)})}return t.$$set=O=>{"itemData"in O&&n(0,a=O.itemData),"slotOpen"in O&&n(8,c=O.slotOpen),"index"in O&&n(9,u=O.index),"weaponExpand"in O&&n(10,f=O.weaponExpand)},t.$$.update=()=>{if(t.$$.dirty&3586&&s)for(let O in s){if(!f&&O!=u&&s[O].name==w){n(4,v=!0);break}if(O!=u&&C[s[O].name]&&C[s[O].name].includes(w)){n(3,g=!1);break}else h||n(3,g=!0)}if(t.$$.dirty&6656)if(i.randomize.ongoing)n(4,v=!1);else for(let O in s)if(O!=u&&s[O].name==w){n(4,v=!0);break}else n(4,v=!1)},[a,h,_,g,v,w,y,E,c,u,f,s,i,A]}class pp extends Ne{constructor(e){super(),Te(this,e,_p,hp,pe,{itemData:0,slotOpen:8,index:9,weaponExpand:10})}}function mp(t){const e=t-1;return e*e*e+1}function st(t,{delay:e=0,duration:n=400,easing:s=js}={}){const i=+getComputedStyle(t).opacity;return{delay:e,duration:n,easing:s,css:o=>`opacity: ${o*i}`}}function Ye(t,{delay:e=0,duration:n=400,easing:s=mp,start:i=0,opacity:o=0}={}){const r=getComputedStyle(t),l=+r.opacity,a=r.transform==="none"?"":r.transform,c=1-i,u=l*(1-o);return{delay:e,duration:n,easing:s,css:(f,d)=>`
			transform: ${a} scale(${1-c*d});
			opacity: ${l-u*d}
		`}}function Tr(t){let e,n,s,i;return{c(){e=b("img"),nt(e.src,n=t[5][t[3]])||m(e,"src",n),m(e,"alt","")},m(o,r){F(o,e,r),i=!0},p(o,r){(!i||r&8&&!nt(e.src,n=o[5][o[3]]))&&m(e,"src",n)},i(o){i||(o&&Ee(()=>{i&&(s||(s=Ie(e,st,{duration:150},!0)),s.run(1))}),i=!0)},o(o){o&&(s||(s=Ie(e,st,{duration:150},!1)),s.run(0)),i=!1},d(o){o&&L(e),o&&s&&s.end()}}}function gp(t){let e,n,s=t[5][t[3]],i,o,r=t[0].name+"",l,a,c,u=Tr(t);return{c(){e=b("li"),n=b("button"),u.c(),i=N(),o=b("span"),l=ie(r),ee(e,"selectedItem",t[4])},m(f,d){F(f,e,d),p(e,n),u.m(n,null),p(n,i),p(n,o),p(o,l),t[8](e),a||(c=[M(n,"click",t[6]),M(e,"mouseenter",t[9]),M(e,"focusin",t[10]),M(e,"mouseleave",t[11]),M(e,"focusout",t[12])],a=!0)},p(f,[d]){d&8&&pe(s,s=f[5][f[3]])?(We(),U(u,1,1,se),qe(),u=Tr(f),u.c(),B(u,1),u.m(n,i)):u.p(f,d),d&1&&r!==(r=f[0].name+"")&&Re(l,r)},i(f){B(u)},o(f){U(u)},d(f){f&&L(e),u.d(f),t[8](null),a=!1,ge(c)}}}function bp(t,e,n){let s,i,o;K(t,kn,P=>n(15,s=P)),K(t,kt,P=>n(16,i=P)),K(t,Ct,P=>n(17,o=P));let{itemData:r,ddOpen:l=!1}=e;const a=Dt();let c,u=!1,f=!1,d,_=0,h=r.pieces.length,g=["head","body","legs","feet"];g=h==2?g.slice(1,3):h==3?g.slice(0,3):g;let v=[];for(let P=0;P<h;P++)v.push(o[g[P]].find(Y=>Y.name==r.pieces[P]).image);function w(){f?d=setInterval(()=>{n(3,_++,_),_==h&&n(3,_=0)},750):(clearInterval(d),n(3,_=0))}function C(){a("setSelect");let P=0;for(let Y=0;Y<h;Y++)!i[g[Y]]||i[g[Y]].name!=r.pieces[Y]?s[g[Y]][r.pieces[Y]].querySelector("button").click():P++;P!=h&&n(7,l=!1)}function y(P){te[P?"unshift":"push"](()=>{c=P,n(2,c)})}const E=()=>n(1,f=!0),A=()=>n(1,f=!0),O=()=>n(1,f=!1),T=()=>n(1,f=!1);return t.$$set=P=>{"itemData"in P&&n(0,r=P.itemData),"ddOpen"in P&&n(7,l=P.ddOpen)},t.$$.update=()=>{t.$$.dirty&2&&(f||!f)&&w()},[r,f,c,_,u,v,C,l,y,E,A,O,T]}class vp extends Ne{constructor(e){super(),Te(this,e,bp,gp,pe,{itemData:0,ddOpen:7})}}const yp=t=>({}),Nr=t=>({});function wp(t){let e,n,s,i,o,r,l,a,c;const u=t[8].tooltip,f=Hc(u,t,t[7],Nr);return{c(){e=b("div"),n=b("span"),s=N(),i=b("input"),r=N(),f&&f.c(),m(i,"id",o=t[2]?"firstFocusable":t[3]?"lastFocusable":""),i.disabled=t[4],m(i,"type","checkbox"),i.checked=t[1],m(i,"class","svelte-1oscat4"),m(e,"class","toggleCont svelte-1oscat4"),ee(e,"unavailable",t[4])},m(d,_){F(d,e,_),p(e,n),n.innerHTML=t[0],p(e,s),p(e,i),p(e,r),f&&f.m(e,null),l=!0,a||(c=[M(i,"change",t[9]),M(i,"keydown",t[10])],a=!0)},p(d,[_]){(!l||_&1)&&(n.innerHTML=d[0]),(!l||_&12&&o!==(o=d[2]?"firstFocusable":d[3]?"lastFocusable":""))&&m(i,"id",o),(!l||_&16)&&(i.disabled=d[4]),(!l||_&2)&&(i.checked=d[1]),f&&f.p&&(!l||_&128)&&Uc(f,u,d,d[7],l?jc(u,d[7],_,yp):Vc(d[7]),Nr),(!l||_&16)&&ee(e,"unavailable",d[4])},i(d){l||(B(f,d),l=!0)},o(d){U(f,d),l=!1},d(d){d&&L(e),f&&f.d(d),a=!1,ge(c)}}}function Cp(t,e,n){let{$$slots:s={},$$scope:i}=e,{text:o,checked:r=!1,first:l=!1,last:a=!1,disabled:c=!1,forced:u=!1}=e;const f=Dt(),d=h=>{h.target.blur(),u?h.target.checked=!0:f("toggle",h.target.checked)},_=h=>{l&&pt(h),a&&mt(h),h.key=="Enter"&&!u?(h.target.checked=!h.target.checked,f("toggle",h.target.checked)):u&&(h.target.checked=!0)};return t.$$set=h=>{"text"in h&&n(0,o=h.text),"checked"in h&&n(1,r=h.checked),"first"in h&&n(2,l=h.first),"last"in h&&n(3,a=h.last),"disabled"in h&&n(4,c=h.disabled),"forced"in h&&n(5,u=h.forced),"$$scope"in h&&n(7,i=h.$$scope)},[o,r,l,a,c,u,f,i,s,d,_]}class rt extends Ne{constructor(e){super(),Te(this,e,Cp,wp,pe,{text:0,checked:1,first:2,last:3,disabled:4,forced:5})}}function Or(t,e,n){const s=t.slice();return s[26]=e[n][0],s[27]=e[n][1],s}function Dr(t,e,n){const s=t.slice();return s[26]=e[n][0],s[27]=e[n][1],s}function Rr(t){let e,n;function s(...i){return t[17](t[26],...i)}return e=new rt({props:{text:t[27],checked:t[5][t[26]]}}),e.$on("toggle",s),{c(){ae(e.$$.fragment)},m(i,o){oe(e,i,o),n=!0},p(i,o){t=i;const r={};o[0]&32&&(r.checked=t[5][t[26]]),e.$set(r)},i(i){n||(B(e.$$.fragment,i),n=!0)},o(i){U(e.$$.fragment,i),n=!1},d(i){re(e,i)}}}function kp(t){let e,n,s,i,o,r,l,a,c,u,f;r=new rt({props:{text:"Descension",checked:t[3],forced:t[3]}}),r.$on("toggle",t[18]),a=new rt({props:{text:"Ascension",checked:t[4],forced:t[4]}}),a.$on("toggle",t[19]);let d=Pe(Object.entries(t[8])),_=[];for(let g=0;g<d.length;g+=1)_[g]=Ar(Or(t,d,g));const h=g=>U(_[g],1,1,()=>{_[g]=null});return{c(){e=b("p"),e.textContent="Sort",n=N(),s=b("div"),i=b("span"),i.textContent="By:",o=N(),ae(r.$$.fragment),l=N(),ae(a.$$.fragment),c=N(),u=b("div");for(let g=0;g<_.length;g+=1)_[g].c();m(e,"id","title"),m(e,"class","svelte-15nzxbp"),m(i,"class","svelte-15nzxbp"),m(s,"class","radio ttFocus svelte-15nzxbp"),m(s,"id","sort"),m(u,"class","options svelte-15nzxbp")},m(g,v){F(g,e,v),F(g,n,v),F(g,s,v),p(s,i),p(s,o),oe(r,s,null),p(s,l),oe(a,s,null),F(g,c,v),F(g,u,v);for(let w=0;w<_.length;w+=1)_[w]&&_[w].m(u,null);f=!0},p(g,v){const w={};v[0]&8&&(w.checked=g[3]),v[0]&8&&(w.forced=g[3]),r.$set(w);const C={};if(v[0]&16&&(C.checked=g[4]),v[0]&16&&(C.forced=g[4]),a.$set(C),v[0]&832){d=Pe(Object.entries(g[8]));let y;for(y=0;y<d.length;y+=1){const E=Or(g,d,y);_[y]?(_[y].p(E,v),B(_[y],1)):(_[y]=Ar(E),_[y].c(),B(_[y],1),_[y].m(u,null))}for(We(),y=d.length;y<_.length;y+=1)h(y);qe()}},i(g){if(!f){B(r.$$.fragment,g),B(a.$$.fragment,g);for(let v=0;v<d.length;v+=1)B(_[v]);f=!0}},o(g){U(r.$$.fragment,g),U(a.$$.fragment,g),_=_.filter(Boolean);for(let v=0;v<_.length;v+=1)U(_[v]);f=!1},d(g){g&&(L(e),L(n),L(s),L(c),L(u)),re(r),re(a),dt(_,g)}}}function Ar(t){let e,n;function s(...i){return t[20](t[26],...i)}return e=new rt({props:{text:t[27],checked:t[6][t[26]],last:t[26]=="none"||t[26]=="tool"}}),e.$on("toggle",s),{c(){ae(e.$$.fragment)},m(i,o){oe(e,i,o),n=!0},p(i,o){t=i;const r={};o[0]&64&&(r.checked=t[6][t[26]]),e.$set(r)},i(i){n||(B(e.$$.fragment,i),n=!0)},o(i){U(e.$$.fragment,i),n=!1},d(i){re(e,i)}}}function Ep(t){let e,n,s,i,o,r,l,a,c,u,f,d,_,h,g,v,w,C,y,E,A,O,T,P,Y;a=new rt({props:{text:"Inclusive",checked:t[1],forced:t[1]}}),a.$on("toggle",t[13]),u=new rt({props:{text:"Exclusive",checked:t[2],forced:t[2]}}),u.$on("toggle",t[14]);let j=Pe(Object.entries(t[8])),I=[];for(let S=0;S<j.length;S+=1)I[S]=Rr(Dr(t,j,S));const D=S=>U(I[S],1,1,()=>{I[S]=null});let k=!t[7]&&kp(t);return{c(){e=b("div"),n=b("div"),s=b("p"),s.textContent="Filter",i=N(),o=b("div"),r=b("span"),r.textContent="Type:",l=N(),ae(a.$$.fragment),c=N(),ae(u.$$.fragment),f=N(),d=b("span"),d.textContent=`Whether to look for equipment that contains or doesn't contain\r
                the selected search types.`,_=N(),h=b("div"),g=b("div"),v=b("button"),v.textContent="Select all",w=N(),C=b("div"),y=b("button"),y.textContent="Clear all",E=N(),A=b("div");for(let S=0;S<I.length;S+=1)I[S].c();O=N(),k&&k.c(),m(s,"id","title"),m(s,"class","svelte-15nzxbp"),m(r,"class","svelte-15nzxbp"),m(d,"class","tooltip svelte-15nzxbp"),m(d,"id","bottom"),m(o,"class","radio ttFocus svelte-15nzxbp"),m(o,"id","filter"),m(v,"class","svelte-15nzxbp"),m(g,"class","svelte-15nzxbp"),m(y,"class","svelte-15nzxbp"),m(C,"class","svelte-15nzxbp"),m(h,"class","optionsAll svelte-15nzxbp"),m(A,"class","options svelte-15nzxbp"),m(n,"class","searchOptions svelte-15nzxbp"),m(e,"class","searchOptionsCont svelte-15nzxbp"),ee(e,"optionsOpen",t[0])},m(S,R){F(S,e,R),p(e,n),p(n,s),p(n,i),p(n,o),p(o,r),p(o,l),oe(a,o,null),p(o,c),oe(u,o,null),p(o,f),p(o,d),p(n,_),p(n,h),p(h,g),p(g,v),p(h,w),p(h,C),p(C,y),p(n,E),p(n,A);for(let H=0;H<I.length;H+=1)I[H]&&I[H].m(A,null);p(n,O),k&&k.m(n,null),T=!0,P||(Y=[M(v,"click",t[15]),M(y,"click",t[16])],P=!0)},p(S,R){const H={};R[0]&2&&(H.checked=S[1]),R[0]&2&&(H.forced=S[1]),a.$set(H);const X={};if(R[0]&4&&(X.checked=S[2]),R[0]&4&&(X.forced=S[2]),u.$set(X),R[0]&800){j=Pe(Object.entries(S[8]));let Z;for(Z=0;Z<j.length;Z+=1){const ne=Dr(S,j,Z);I[Z]?(I[Z].p(ne,R),B(I[Z],1)):(I[Z]=Rr(ne),I[Z].c(),B(I[Z],1),I[Z].m(A,null))}for(We(),Z=j.length;Z<I.length;Z+=1)D(Z);qe()}S[7]||k.p(S,R),(!T||R[0]&1)&&ee(e,"optionsOpen",S[0])},i(S){if(!T){B(a.$$.fragment,S),B(u.$$.fragment,S);for(let R=0;R<j.length;R+=1)B(I[R]);B(k),T=!0}},o(S){U(a.$$.fragment,S),U(u.$$.fragment,S),I=I.filter(Boolean);for(let R=0;R<I.length;R+=1)U(I[R]);U(k),T=!1},d(S){S&&L(e),re(a),re(u),dt(I,S),k&&k.d(),P=!1,ge(Y)}}}function Sp(t,e,n){let s;K(t,Ct,k=>n(22,s=k));let{optionsOpen:i,slotName:o,elementData:r,list:l}=e;const a=Dt();let c=o=="gear",u=!0,f=!1,d=!0,_=!1,h={},g={},v=c?{armor:"Armor",magicDmg:"Magic",meleeDmg:"Melee",rangedDmg:"Ranged",unique:"Unique",tool:"Tool"}:{...On,none:"No Stats"};for(let k of Object.keys(v))h[k]=!0;for(let k of Object.keys(v))g[k]=!1;let w=["Void Spike Ultradagger","Pureblood Dagger","Gnome Rocket Launcher"],C=[];function y(k){setTimeout(()=>{for(let S in r){let R=s[o].find(he=>he.name==S),H={...On},X={armor:!1,magicDmg:!1,meleeDmg:!1,rangedDmg:!1,unique:!1,tool:!1},Z=c?X:H,ne=!1;if(c)if(!R.tool&&!w.includes(R.name)){for(let he in h)for(let de of R.moves)if(X[he]=de.type.includes(he),X[he])break}else X.tool=!!R.tool,X.tool||(X.unique=R.info.type=="Unique",R.name=="Void Spike Ultradagger"&&(X.armor=!0,X.meleeDmg=!0));else{for(let he in h)H[he]=R.stats[he]!=0;H.none=!!R.noStats}if(u)for(let he in Z)if(h[he]&&Z[he]){ne=!1;break}else ne=!0;else if(f)for(let he in Z)if(h[he]&&Z[he]){ne=!0;break}else ne=!1;ne?r[S].classList.add("hidden","filtered"):r[S].classList.remove("hidden","filtered")}if(k=="sort"){let S=Object.keys(g).find(H=>g[H]),R=0;for(S&&!(S=="none"||S=="tool")?(C.sort((H,X)=>{let Z=E(H,X,!0).stats[S]-E(H,X,!1).stats[S];return R||(R=Z),Z}),R||(C=Object.values(r))):!S&&_&&(C=Object.values(r).toReversed()),S=="none"&&(C=[...Object.entries(r).filter(H=>s[o].find(X=>X.name==H[0]).noStats),...Object.entries(r).filter(H=>!s[o].find(X=>X.name==H[0]).noStats)],C=C.map(H=>H[1]),_&&C.reverse());l.lastElementChild;)l.removeChild(l.lastElementChild);if(S||!S&&_)for(let H of C)l.appendChild(H);else for(let H in r)l.appendChild(r[H])}a("listUpdate")})}function E(k,S,R){return s[o].find(H=>H.name==Object.keys(r).find(X=>r[X]===(d?R?S:k:R?k:S)))}const A=k=>{n(1,u=k.detail),k.detail&&n(2,f=!1),y("filter")},O=k=>{n(2,f=k.detail),k.detail&&n(1,u=!1),y("filter")},T=k=>{k.target.blur();for(let S in h)n(5,h[S]=!0,h);y("filter")},P=k=>{k.target.blur();for(let S in h)n(5,h[S]=!1,h);y("filter")},Y=(k,S)=>{n(5,h[k]=S.detail,h),y("filter")},j=k=>{n(3,d=k.detail),k.detail&&n(4,_=!1),y("sort")},I=k=>{n(4,_=k.detail),k.detail&&n(3,d=!1),y("sort")},D=(k,S)=>{if(n(6,g[k]=S.detail,g),S.detail)for(let R in g)R!=k&&n(6,g[R]=!1,g);y("sort")};return t.$$set=k=>{"optionsOpen"in k&&n(0,i=k.optionsOpen),"slotName"in k&&n(10,o=k.slotName),"elementData"in k&&n(11,r=k.elementData),"list"in k&&n(12,l=k.list)},t.$$.update=()=>{t.$$.dirty[0]&4096&&l&&(C=[...l.children])},[i,u,f,d,_,h,g,c,v,y,o,r,l,A,O,T,P,Y,j,I,D]}class Ip extends Ne{constructor(e){super(),Te(this,e,Sp,Ep,pe,{optionsOpen:0,slotName:10,elementData:11,list:12},null,[-1,-1])}}function Pr(t,e,n){const s=t.slice();return s[43]=e[n],s}function Tp(t){let e;return{c(){e=b("span"),e.textContent="Loading items...",m(e,"class","svelte-suojz2")},m(n,s){F(n,e,s)},p:se,i:se,o:se,d(n){n&&L(e)}}}function Np(t){let e,n,s,i,o,r,l,a=t[3]!="sets"&&Mr(t),c=Pe(t[6]),u=[];for(let d=0;d<c.length;d+=1)u[d]=Lr(Pr(t,c,d));const f=d=>U(u[d],1,1,()=>{u[d]=null});return{c(){e=b("input"),n=N(),a&&a.c(),s=N(),i=b("ul");for(let d=0;d<u.length;d+=1)u[d].c();m(e,"type","text"),m(e,"class","searchBarInput"),m(e,"placeholder","Search..."),m(i,"class","svelte-suojz2"),ee(i,"no-scrollbar",t[12].length<=4)},m(d,_){F(d,e,_),t[23](e),F(d,n,_),a&&a.m(d,_),F(d,s,_),F(d,i,_);for(let h=0;h<u.length;h+=1)u[h]&&u[h].m(i,null);t[32](i),o=!0,r||(l=[M(e,"keydown",t[15]),M(e,"input",t[16])],r=!0)},p(d,_){if(d[3]!="sets"?a?a.p(d,_):(a=Mr(d),a.c(),a.m(s.parentNode,s)):a&&(a.d(1),a=null),_[0]&149595){c=Pe(d[6]);let h;for(h=0;h<c.length;h+=1){const g=Pr(d,c,h);u[h]?(u[h].p(g,_),B(u[h],1)):(u[h]=Lr(g),u[h].c(),B(u[h],1),u[h].m(i,null))}for(We(),h=c.length;h<u.length;h+=1)f(h);qe()}(!o||_[0]&4096)&&ee(i,"no-scrollbar",d[12].length<=4)},i(d){if(!o){for(let _=0;_<c.length;_+=1)B(u[_]);o=!0}},o(d){u=u.filter(Boolean);for(let _=0;_<u.length;_+=1)U(u[_]);o=!1},d(d){d&&(L(e),L(n),L(s),L(i)),t[23](null),a&&a.d(d),dt(u,d),t[32](null),r=!1,ge(l)}}}function Mr(t){let e,n,s;return{c(){e=b("button"),e.innerHTML='<iconify-icon icon="mi:filter"></iconify-icon>',m(e,"class","optionsButton svelte-suojz2")},m(i,o){F(i,e,o),t[24](e),n||(s=M(e,"click",t[25]),n=!0)},p:se,d(i){i&&L(e),t[24](null),n=!1,s()}}}function Op(t){let e,n,s;function i(r){t[31](r)}let o={itemData:t[43],eqSlotName:t[3]};return t[0]!==void 0&&(o.slotOpen=t[0]),e=new fp({props:o}),te.push(()=>De(e,"slotOpen",i)),e.$on("itemSelect",t[17]),{c(){ae(e.$$.fragment)},m(r,l){oe(e,r,l),s=!0},p(r,l){const a={};l[0]&64&&(a.itemData=r[43]),l[0]&8&&(a.eqSlotName=r[3]),!n&&l[0]&1&&(n=!0,a.slotOpen=r[0],Oe(()=>n=!1)),e.$set(a)},i(r){s||(B(e.$$.fragment,r),s=!0)},o(r){U(e.$$.fragment,r),s=!1},d(r){re(e,r)}}}function Dp(t){let e,n,s;function i(r){t[29](r)}let o={itemData:t[43]};return t[0]!==void 0&&(o.ddOpen=t[0]),e=new vp({props:o}),te.push(()=>De(e,"ddOpen",i)),e.$on("setSelect",t[30]),{c(){ae(e.$$.fragment)},m(r,l){oe(e,r,l),s=!0},p(r,l){const a={};l[0]&64&&(a.itemData=r[43]),!n&&l[0]&1&&(n=!0,a.ddOpen=r[0],Oe(()=>n=!1)),e.$set(a)},i(r){s||(B(e.$$.fragment,r),s=!0)},o(r){U(e.$$.fragment,r),s=!1},d(r){re(e,r)}}}function Rp(t){let e,n,s,i;function o(a){t[26](a)}function r(a){t[27](a)}let l={itemData:t[43],index:t[4]};return t[0]!==void 0&&(l.slotOpen=t[0]),t[1]!==void 0&&(l.weaponExpand=t[1]),e=new pp({props:l}),te.push(()=>De(e,"slotOpen",o)),te.push(()=>De(e,"weaponExpand",r)),e.$on("itemSelect",t[17]),e.$on("toolSelect",t[28]),{c(){ae(e.$$.fragment)},m(a,c){oe(e,a,c),i=!0},p(a,c){const u={};c[0]&64&&(u.itemData=a[43]),c[0]&16&&(u.index=a[4]),!n&&c[0]&1&&(n=!0,u.slotOpen=a[0],Oe(()=>n=!1)),!s&&c[0]&2&&(s=!0,u.weaponExpand=a[1],Oe(()=>s=!1)),e.$set(u)},i(a){i||(B(e.$$.fragment,a),i=!0)},o(a){U(e.$$.fragment,a),i=!1},d(a){re(e,a)}}}function Lr(t){let e,n,s,i;const o=[Rp,Dp,Op],r=[];function l(a,c){return a[4]?0:a[3]=="sets"?1:2}return e=l(t),n=r[e]=o[e](t),{c(){n.c(),s=_t()},m(a,c){r[e].m(a,c),F(a,s,c),i=!0},p(a,c){let u=e;e=l(a),e===u?r[e].p(a,c):(We(),U(r[u],1,1,()=>{r[u]=null}),qe(),n=r[e],n?n.p(a,c):(n=r[e]=o[e](a),n.c()),B(n,1),n.m(s.parentNode,s))},i(a){i||(B(n),i=!0)},o(a){U(n),i=!1},d(a){a&&L(s),r[e].d(a)}}}function Fr(t){let e,n,s,i;function o(a){t[33](a)}function r(a){t[34](a)}let l={slotName:t[3],elementData:t[13]};return t[2]!==void 0&&(l.optionsOpen=t[2]),t[5]!==void 0&&(l.list=t[5]),e=new Ip({props:l}),te.push(()=>De(e,"optionsOpen",o)),te.push(()=>De(e,"list",r)),e.$on("listUpdate",t[16]),{c(){ae(e.$$.fragment)},m(a,c){oe(e,a,c),i=!0},p(a,c){const u={};c[0]&8&&(u.slotName=a[3]),c[0]&8192&&(u.elementData=a[13]),!n&&c[0]&4&&(n=!0,u.optionsOpen=a[2],Oe(()=>n=!1)),!s&&c[0]&32&&(s=!0,u.list=a[5],Oe(()=>s=!1)),e.$set(u)},i(a){i||(B(e.$$.fragment,a),i=!0)},o(a){U(e.$$.fragment,a),i=!1},d(a){re(e,a)}}}function Ap(t){let e,n,s,i,o,r,l;const a=[Np,Tp],c=[];function u(d,_){return d[6]?0:1}n=u(t),s=c[n]=a[n](t);let f=t[3]!="sets"&&Fr(t);return{c(){e=b("div"),s.c(),i=N(),f&&f.c(),m(e,"class","dropdown svelte-suojz2")},m(d,_){F(d,e,_),c[n].m(e,null),p(e,i),f&&f.m(e,null),t[35](e),o=!0,r||(l=[M(e,"transitionend",t[36]),M(e,"transitioncancel",t[37])],r=!0)},p(d,_){let h=n;n=u(d),n===h?c[n].p(d,_):(We(),U(c[h],1,1,()=>{c[h]=null}),qe(),s=c[n],s?s.p(d,_):(s=c[n]=a[n](d),s.c()),B(s,1),s.m(e,i)),d[3]!="sets"?f?(f.p(d,_),_[0]&8&&B(f,1)):(f=Fr(d),f.c(),B(f,1),f.m(e,null)):f&&(We(),U(f,1,1,()=>{f=null}),qe())},i(d){o||(B(s),B(f),o=!0)},o(d){U(s),U(f),o=!1},d(d){d&&L(e),c[n].d(),f&&f.d(),t[35](null),r=!1,ge(l)}}}function Pp(t,e,n){let s,i,o,r,l,a;K(t,Ct,J=>n(19,o=J)),K(t,kn,J=>n(20,r=J)),K(t,au,J=>n(21,l=J)),K(t,En,J=>n(22,a=J));let{slotName:c,index:u=0,slotOpen:f,weaponExpand:d=null,optionsOpen:_=!1}=e;const h=Dt();u?G(En,a[u]={},a):G(kn,r[c]={},r);let g,v,w,C,y,E=null,A=!1,O=!1,T=[];function P(){y&&y.classList.remove("lastElement"),n(12,T=w.querySelectorAll("li:not(.hidden)")),y=T[T.length-1],y&&y.classList.add("lastElement"),(!y||y.classList.contains("non-eligible"))&&(y=C)}function Y(J){!J.shiftKey&&J.key=="Tab"&&!_&&(J.preventDefault(),setTimeout(()=>v.focus()))}function j(){y&&y.removeEventListener("keydown",Y),P(),y&&y.addEventListener("keydown",Y)}function I(J){J.shiftKey&&J.key=="Tab"&&(J.preventDefault(),setTimeout(()=>(y.querySelector("button")||y).focus()))}function D(){Mc(v.value,s),j()}function k(J){h("itemSelect",J.detail.element),n(10,E=J.detail.element),A=J.detail.trusted;let et=w.querySelector(".selectedItem");et&&et!=J.detail.element&&et.classList.remove("selectedItem"),n(11,O=!0),A||(S(),w.scrollTo(0,E.offsetTop))}function S(){n(11,O=!1),n(8,v.value="",v),D()}function R(J){te[J?"unshift":"push"](()=>{v=J,n(8,v)})}function H(J){te[J?"unshift":"push"](()=>{C=J,n(9,C)})}const X=()=>n(2,_=!_);function Z(J){f=J,n(0,f)}function ne(J){d=J,n(1,d)}const he=()=>h("toolSelect");function de(J){f=J,n(0,f)}const fe=()=>n(11,O=!0);function z(J){f=J,n(0,f)}function Q(J){te[J?"unshift":"push"](()=>{w=J,n(5,w)})}function le(J){_=J,n(2,_)}function Ae(J){w=J,n(5,w)}function Ce(J){te[J?"unshift":"push"](()=>{g=J,n(7,g)})}const ke=J=>{J.propertyName=="visibility"&&J.target==g&&(O&&S(),!f&&E&&setTimeout(()=>w.scrollTo(0,E.offsetTop)),qs(v,f))},Ve=J=>{J.propertyName=="visibility"&&(n(11,O=!1),qs(v,f))};return t.$$set=J=>{"slotName"in J&&n(3,c=J.slotName),"index"in J&&n(4,u=J.index),"slotOpen"in J&&n(0,f=J.slotOpen),"weaponExpand"in J&&n(1,d=J.weaponExpand),"optionsOpen"in J&&n(2,_=J.optionsOpen)},t.$$.update=()=>{if(t.$$.dirty[0]&7340056&&n(13,s=u?a[u]:c=="sets"?l:r[c]),t.$$.dirty[0]&524296&&n(6,i=o[c]),t.$$.dirty[0]&96&&w){n(12,T=w.querySelectorAll("li:not(.hidden)"));for(let J=0;J<w.childElementCount;J++)n(13,s[i[J].name]=w.children[J],s);P(),j()}},[f,d,_,c,u,w,i,g,v,C,E,O,T,s,h,I,D,k,S,o,r,l,a,R,H,X,Z,ne,he,de,fe,z,Q,le,Ae,Ce,ke,Ve]}class Ro extends Ne{constructor(e){super(),Te(this,e,Pp,Ap,pe,{slotName:3,index:4,slotOpen:0,weaponExpand:1,optionsOpen:2},null,[-1,-1])}}function Br(t){let e,n,s,i,o,r,l=t[1].name+"",a,c,u,f,d,_;return{c(){e=b("a"),n=b("img"),o=N(),r=b("span"),a=ie(l),nt(n.src,s=t[1].image)||m(n,"src",s),m(n,"alt",i=t[1].name),m(n,"draggable","false"),m(n,"class","svelte-1ph7qia"),m(r,"class","tooltip"),m(r,"id","left"),m(e,"href",c=t[1].link),m(e,"target","_blank"),m(e,"class","svelte-1ph7qia"),Ge(e,"display",t[1].link?"":"none")},m(h,g){F(h,e,g),p(e,n),p(e,o),p(e,r),p(r,a),f=!0,d||(_=[M(e,"focusin",t[12]),M(e,"outroend",t[13])],d=!0)},p(h,g){(!f||g&2&&!nt(n.src,s=h[1].image))&&m(n,"src",s),(!f||g&2&&i!==(i=h[1].name))&&m(n,"alt",i),(!f||g&2)&&l!==(l=h[1].name+"")&&Re(a,l),(!f||g&2&&c!==(c=h[1].link))&&m(e,"href",c),g&2&&Ge(e,"display",h[1].link?"":"none")},i(h){f||(h&&Ee(()=>{f&&(u||(u=Ie(e,st,{duration:150},!0)),u.run(1))}),f=!0)},o(h){h&&(u||(u=Ie(e,st,{duration:150},!1)),u.run(0)),f=!1},d(h){h&&L(e),h&&u&&u.end(),d=!1,ge(_)}}}function Mp(t){let e,n,s=t[1],i,o,r=t[0].charAt(0).toUpperCase()+t[0].slice(1)+"",l,a,c,u,f,d,_,h,g,v,w,C,y=Br(t);function E(T){t[17](T)}function A(T){t[18](T)}let O={slotName:t[0]};return t[4]!==void 0&&(O.slotOpen=t[4]),t[6]!==void 0&&(O.optionsOpen=t[6]),_=new Ro({props:O}),te.push(()=>De(_,"slotOpen",E)),te.push(()=>De(_,"optionsOpen",A)),_.$on("itemSelect",t[19]),{c(){e=b("div"),n=b("div"),y.c(),i=N(),o=b("button"),l=ie(r),a=N(),c=b("iconify-icon"),u=N(),f=b("button"),f.innerHTML='<iconify-icon icon="maki:cross" class="svelte-1ph7qia"></iconify-icon> <span class="tooltip" id="top">Clear selection</span>',d=N(),ae(_.$$.fragment),m(n,"class","eqSlotIcon ff-border svelte-1ph7qia"),Ze(c,"icon","iconamoon:arrow-down-2-fill"),Ze(c,"class","svelte-1ph7qia"),m(o,"class","ddButton svelte-1ph7qia"),m(f,"class","clearButton svelte-1ph7qia"),m(e,"class","eqSlotCont svelte-1ph7qia"),ee(e,"slotOpen",t[4]),ee(e,"clearAllowed",t[5]&&t[7])},m(T,P){F(T,e,P),p(e,n),y.m(n,null),t[14](n),p(e,i),p(e,o),p(o,l),p(o,a),p(o,c),p(e,u),p(e,f),p(e,d),oe(_,e,null),t[20](e),v=!0,w||(C=[M(window,"mousedown",t[10]),M(window,"keydown",t[11]),M(o,"click",t[15]),M(f,"click",t[16]),M(e,"mouseenter",t[21]),M(e,"mouseleave",t[22])],w=!0)},p(T,[P]){P&2&&pe(s,s=T[1])?(We(),U(y,1,1,se),qe(),y=Br(T),y.c(),B(y,1),y.m(n,null)):y.p(T,P),(!v||P&1)&&r!==(r=T[0].charAt(0).toUpperCase()+T[0].slice(1)+"")&&Re(l,r);const Y={};P&1&&(Y.slotName=T[0]),!h&&P&16&&(h=!0,Y.slotOpen=T[4],Oe(()=>h=!1)),!g&&P&64&&(g=!0,Y.optionsOpen=T[6],Oe(()=>g=!1)),_.$set(Y),(!v||P&16)&&ee(e,"slotOpen",T[4]),(!v||P&160)&&ee(e,"clearAllowed",T[5]&&T[7])},i(T){v||(B(y),B(_.$$.fragment,T),v=!0)},o(T){U(y),U(_.$$.fragment,T),v=!1},d(T){T&&L(e),y.d(T),t[14](null),re(_),t[20](null),w=!1,ge(C)}}}function Lp(t,e,n){let s,i;K(t,kt,j=>n(9,s=j)),K(t,$,j=>n(8,i=j));let{eqSlotName:o}=e,r,l,a=oi,c,u,f,d;const _=j=>{(!r.contains(j.target)||j.target==r||j.target==l)&&(n(4,c=!1),n(6,f=!1),j.target!=r&&j.target!=l&&n(5,u=!1))},h=j=>{j.key=="Tab"?setTimeout(()=>{n(5,u=r.contains(document.activeElement))}):j.key=="Escape"&&(n(4,c=!1),n(6,f=!1))},g=j=>{j.relatedTarget==null&&n(5,u=!0)},v=()=>{setTimeout(()=>{ap(l)})};function w(j){te[j?"unshift":"push"](()=>{l=j,n(3,l)})}const C=()=>{i.screenshot.ongoing||n(4,c=!c)},y=()=>{n(5,u=!1),r.classList.contains("clearAllowed")&&d.querySelector("button").click()};function E(j){c=j,n(4,c)}function A(j){f=j,n(6,f)}const O=j=>{setTimeout(()=>{n(7,d=j.detail.classList.contains("selectedItem")?j.detail:null),n(6,f=!1)})};function T(j){te[j?"unshift":"push"](()=>{r=j,n(2,r)})}const P=()=>n(5,u=!0),Y=()=>{r.contains(document.activeElement)||n(5,u=!1)};return t.$$set=j=>{"eqSlotName"in j&&n(0,o=j.eqSlotName)},t.$$.update=()=>{t.$$.dirty&515&&s[o]&&s[o].name!=a.name&&n(1,a=s[o])},[o,a,r,l,c,u,f,d,i,s,_,h,g,v,w,C,y,E,A,O,T,P,Y]}class Fp extends Ne{constructor(e){super(),Te(this,e,Lp,Mp,pe,{eqSlotName:0})}}function zr(t,e,n){const s=t.slice();return s[1]=e[n],s[2]=e,s[3]=n,s}function Wr(t){let e,n,s;function i(r){t[0](r,t[1],t[2],t[3])}let o={};return t[1]!==void 0&&(o.eqSlotName=t[1]),e=new Fp({props:o}),te.push(()=>De(e,"eqSlotName",i)),{c(){ae(e.$$.fragment)},m(r,l){oe(e,r,l),s=!0},p(r,l){t=r;const a={};!n&&l&0&&(n=!0,a.eqSlotName=t[1],Oe(()=>n=!1)),e.$set(a)},i(r){s||(B(e.$$.fragment,r),s=!0)},o(r){U(e.$$.fragment,r),s=!1},d(r){re(e,r)}}}function Bp(t){let e,n,s=Pe(Array(...rs)),i=[];for(let r=0;r<s.length;r+=1)i[r]=Wr(zr(t,s,r));const o=r=>U(i[r],1,1,()=>{i[r]=null});return{c(){e=b("div");for(let r=0;r<i.length;r+=1)i[r].c();m(e,"class","armorBox svelte-1bs41wb")},m(r,l){F(r,e,l);for(let a=0;a<i.length;a+=1)i[a]&&i[a].m(e,null);n=!0},p(r,[l]){if(l&0){s=Pe(Array(...rs));let a;for(a=0;a<s.length;a+=1){const c=zr(r,s,a);i[a]?(i[a].p(c,l),B(i[a],1)):(i[a]=Wr(c),i[a].c(),B(i[a],1),i[a].m(e,null))}for(We(),a=s.length;a<i.length;a+=1)o(a);qe()}},i(r){if(!n){for(let l=0;l<s.length;l+=1)B(i[l]);n=!0}},o(r){i=i.filter(Boolean);for(let l=0;l<i.length;l+=1)U(i[l]);n=!1},d(r){r&&L(e),dt(i,r)}}}function zp(t,e,n){function s(i,o,r,l){r[l]=i}return[s]}class Wp extends Ne{constructor(e){super(),Te(this,e,zp,Bp,pe,{})}}function qp(t){let e,n=(t[3]?`${Math.floor(t[5]*.675+19.8)}% Reduction`:t[5])+"",s,i,o;return{c(){e=b("span"),s=ie(n),m(e,"class","statValue svelte-gx367h"),m(e,"tabindex","0"),ee(e,"hidden",t[2]),ee(e,"negative",t[5]<0),ee(e,"zero",t[5]==0),ee(e,"reduction",t[3])},m(r,l){F(r,e,l),p(e,s),i||(o=[M(e,"mouseenter",t[11]),M(e,"mouseleave",t[12]),M(e,"focusin",t[13]),M(e,"focusout",t[14])],i=!0)},p(r,l){l&40&&n!==(n=(r[3]?`${Math.floor(r[5]*.675+19.8)}% Reduction`:r[5])+"")&&Re(s,n),l&4&&ee(e,"hidden",r[2]),l&32&&ee(e,"negative",r[5]<0),l&32&&ee(e,"zero",r[5]==0),l&8&&ee(e,"reduction",r[3])},d(r){r&&L(e),i=!1,ge(o)}}}function Hp(t){let e,n=(t[0]!="endurance"?t[5]:t[5].toFixed(2))+"",s;return{c(){e=b("span"),s=ie(n),m(e,"class","statValue svelte-gx367h"),ee(e,"hidden",t[2]),ee(e,"negative",t[5]<0),ee(e,"zero",t[5]==0)},m(i,o){F(i,e,o),p(e,s)},p(i,o){o&33&&n!==(n=(i[0]!="endurance"?i[5]:i[5].toFixed(2))+"")&&Re(s,n),o&4&&ee(e,"hidden",i[2]),o&32&&ee(e,"negative",i[5]<0),o&32&&ee(e,"zero",i[5]==0)},d(i){i&&L(e)}}}function jp(t){let e;return{c(){e=b("iconify-icon"),Ze(e,"icon","codicon:sparkle-filled"),Ze(e,"class","svelte-gx367h")},m(n,s){F(n,e,s)},p:se,d(n){n&&L(e)}}}function Up(t){let e,n=`${t[1]} Bonus`,s;return{c(){e=b("span"),s=ie(n),m(e,"class","statName svelte-gx367h")},m(i,o){F(i,e,o),p(e,s)},p(i,o){o&2&&n!==(n=`${i[1]} Bonus`)&&Re(s,n)},d(i){i&&L(e)}}}function Vp(t){let e,n,s,i,o,r,l;function a(h,g){return h[0]!="armor"?Hp:qp}let c=a(t),u=c(t);function f(h,g){if(h[2])return Up;if(h[4])return jp}let d=f(t),_=d&&d(t);return{c(){e=b("div"),n=b("img"),i=N(),u.c(),o=N(),_&&_.c(),nt(n.src,s="stats/"+t[0]+".svg")||m(n,"src",s),m(n,"alt",t[1]),m(n,"class","svelte-gx367h"),m(e,"id",t[0]),m(e,"class","svelte-gx367h"),ee(e,"hidden",t[5]==0)},m(h,g){F(h,e,g),p(e,n),p(e,i),u.m(e,null),p(e,o),_&&_.m(e,null),r||(l=[M(n,"mouseenter",t[9]),M(n,"mouseleave",t[10])],r=!0)},p(h,[g]){g&1&&!nt(n.src,s="stats/"+h[0]+".svg")&&m(n,"src",s),g&2&&m(n,"alt",h[1]),c===(c=a(h))&&u?u.p(h,g):(u.d(1),u=c(h),u&&(u.c(),u.m(e,o))),d===(d=f(h))&&_?_.p(h,g):(_&&_.d(1),_=d&&d(h),_&&(_.c(),_.m(e,null))),g&1&&m(e,"id",h[0]),g&32&&ee(e,"hidden",h[5]==0)},i:se,o:se,d(h){h&&L(e),u.d(),_&&_.d(),r=!1,ge(l)}}}function Gp(t,e,n){let s,i,o,r;K(t,Ct,C=>n(6,i=C)),K(t,gn,C=>n(7,o=C)),K(t,lt,C=>n(8,r=C));let{codeName:l,formalName:a}=e,c,u,f=!1;const d=()=>n(2,c=!0),_=()=>n(2,c=!1),h=()=>n(3,u=!0),g=()=>n(3,u=!1),v=()=>n(3,u=!0),w=()=>n(3,u=!1);return t.$$set=C=>{"codeName"in C&&n(0,l=C.codeName),"formalName"in C&&n(1,a=C.formalName)},t.$$.update=()=>{if(t.$$.dirty&257&&n(5,s=r[l]),t.$$.dirty&193)for(let C in o)if(o[C]&&i.bonuses.find(y=>y.name==C).stats[l]!=0){n(4,f=!0);break}else n(4,f=!1)},[l,a,c,u,f,s,i,o,r,d,_,h,g,v,w]}class Yp extends Ne{constructor(e){super(),Te(this,e,Gp,Vp,pe,{codeName:0,formalName:1})}}function qr(t,e,n){const s=t.slice();return s[4]=e[n][0],s[5]=e[n][1],s[6]=e,s[7]=n,s}function Hr(t){let e,n,s,i;function o(a){t[1](a,t[4],t[6],t[7])}function r(a){t[2](a,t[5],t[6],t[7])}let l={};return t[4]!==void 0&&(l.codeName=t[4]),t[5]!==void 0&&(l.formalName=t[5]),e=new Yp({props:l}),te.push(()=>De(e,"codeName",o)),te.push(()=>De(e,"formalName",r)),{c(){ae(e.$$.fragment)},m(a,c){oe(e,a,c),i=!0},p(a,c){t=a;const u={};!n&&c&0&&(n=!0,u.codeName=t[4],Oe(()=>n=!1)),!s&&c&0&&(s=!0,u.formalName=t[5],Oe(()=>s=!1)),e.$set(u)},i(a){i||(B(e.$$.fragment,a),i=!0)},o(a){U(e.$$.fragment,a),i=!1},d(a){re(e,a)}}}function Kp(t){let e,n,s,i,o=Pe(Object.entries(On)),r=[];for(let a=0;a<o.length;a+=1)r[a]=Hr(qr(t,o,a));const l=a=>U(r[a],1,1,()=>{r[a]=null});return s=new rt({props:{text:"Show all stats"}}),s.$on("toggle",t[3]),{c(){e=b("div");for(let a=0;a<r.length;a+=1)r[a].c();n=N(),ae(s.$$.fragment),m(e,"class","statBox svelte-lu37w6"),ee(e,"showAll",t[0])},m(a,c){F(a,e,c);for(let u=0;u<r.length;u+=1)r[u]&&r[u].m(e,null);p(e,n),oe(s,e,null),i=!0},p(a,[c]){if(c&0){o=Pe(Object.entries(On));let u;for(u=0;u<o.length;u+=1){const f=qr(a,o,u);r[u]?(r[u].p(f,c),B(r[u],1)):(r[u]=Hr(f),r[u].c(),B(r[u],1),r[u].m(e,n))}for(We(),u=o.length;u<r.length;u+=1)l(u);qe()}(!i||c&1)&&ee(e,"showAll",a[0])},i(a){if(!i){for(let c=0;c<o.length;c+=1)B(r[c]);B(s.$$.fragment,a),i=!0}},o(a){r=r.filter(Boolean);for(let c=0;c<r.length;c+=1)U(r[c]);U(s.$$.fragment,a),i=!1},d(a){a&&L(e),dt(r,a),re(s)}}}function Qp(t,e,n){let s=!1;function i(l,a,c,u){c[u][0]=l}function o(l,a,c,u){c[u][1]=l}return[s,i,o,l=>n(0,s=l.detail)]}class xp extends Ne{constructor(e){super(),Te(this,e,Qp,Kp,pe,{})}}function Xp(t){let e,n,s,i,o,r,l,a,c,u;return{c(){e=b("div"),n=b("button"),n.textContent="-",s=N(),i=b("input"),o=N(),r=b("b"),r.textContent="%",l=N(),a=b("button"),a.textContent="+",m(n,"id","decrease"),m(n,"class","svelte-1d7zneu"),m(i,"type","number"),m(i,"placeholder","0"),m(i,"class","svelte-1d7zneu"),m(r,"class","svelte-1d7zneu"),m(a,"id","increase"),m(a,"class","svelte-1d7zneu"),m(e,"class","svelte-1d7zneu"),ee(e,"non-percent",!t[1])},m(f,d){F(f,e,d),p(e,n),p(e,s),p(e,i),It(i,t[0]),p(e,o),p(e,r),p(e,l),p(e,a),c||(u=[M(n,"click",t[4]),M(i,"input",t[5]),M(i,"input",t[2]),M(a,"click",t[6])],c=!0)},p(f,[d]){d&1&&Bl(i.value)!==f[0]&&It(i,f[0])},i:se,o:se,d(f){f&&L(e),c=!1,ge(u)}}}function Jp(t,e,n){let{weaponName:s,value:i}=e,o=s!="Nature's Wrath Spellbook",r;o?(i=100,r=100):(i=4,r=4);function l(){i<0?n(0,i=0):i>r&&n(0,i=r),i%1!=0&&n(0,i=Math.floor(i))}const a=()=>{n(0,i--,i),l()};function c(){i=Bl(this.value),n(0,i)}const u=()=>{n(0,i++,i),l()};return t.$$set=f=>{"weaponName"in f&&n(3,s=f.weaponName),"value"in f&&n(0,i=f.value)},[i,o,l,s,a,c,u]}class Zp extends Ne{constructor(e){super(),Te(this,e,Jp,Xp,pe,{weaponName:3,value:0})}}function jr(t,e,n){const s=t.slice();s[51]=e[n];const i=s[51].name.includes("Fantastic Beamstorm")?"~":"";s[22]=i;const o=s[51].name.includes("Charged");return s[52]=o,s}function $p(t){let e,n,s=t[2].description+"",i,o;return{c(){e=b("span"),n=ie('"'),i=ie(s),o=ie('"'),m(e,"id","toolDesc"),m(e,"class","svelte-hmrxuw")},m(r,l){F(r,e,l),p(e,n),p(e,i),p(e,o)},p(r,l){l[0]&4&&s!==(s=r[2].description+"")&&Re(i,s)},d(r){r&&L(e)}}}function em(t){let e,n,s,i=`${t[5]?"Type":t[3].name}:`,o,r,l=t[20],a,c,u,f,d,_=t[5]?"Return":"Expand",h,g,v,w,C=Vr(t),y=t[4]&&Gr(t);return{c(){e=b("button"),n=b("div"),s=b("span"),o=ie(i),r=N(),C.c(),c=N(),y&&y.c(),u=N(),f=b("span"),d=ie("("),h=ie(_),g=ie(")"),m(s,"class","svelte-hmrxuw"),Ge(s,"font-size",Object.keys(t[21]).includes(t[3].name)?`calc(var(--u) * ${t[21][t[3].name]})`:""),m(n,"id",a=t[5]?"":"basic"),m(n,"class","svelte-hmrxuw"),m(f,"class","tooltip svelte-hmrxuw"),m(f,"id","top"),m(e,"class","gearPreview svelte-hmrxuw"),Ge(e,"line-height",`${t[10]/6.5}px`)},m(E,A){F(E,e,A),p(e,n),p(n,s),p(s,o),p(n,r),C.m(n,null),p(e,c),y&&y.m(e,null),p(e,u),p(e,f),p(f,d),p(f,h),p(f,g),t[34](e),v||(w=M(e,"click",t[35]),v=!0)},p(E,A){A[0]&40&&i!==(i=`${E[5]?"Type":E[3].name}:`)&&Re(o,i),A[0]&2097160&&Ge(s,"font-size",Object.keys(E[21]).includes(E[3].name)?`calc(var(--u) * ${E[21][E[3].name]})`:""),A[0]&1048576&&pe(l,l=E[20])?(C.d(1),C=Vr(E),C.c(),C.m(n,null)):C.p(E,A),A[0]&32&&a!==(a=E[5]?"":"basic")&&m(n,"id",a),E[4]?y?y.p(E,A):(y=Gr(E),y.c(),y.m(e,u)):y&&(y.d(1),y=null),A[0]&32&&_!==(_=E[5]?"Return":"Expand")&&Re(h,_),A[0]&1024&&Ge(e,"line-height",`${E[10]/6.5}px`)},d(E){E&&L(e),C.d(E),y&&y.d(),t[34](null),v=!1,w()}}}function Ur(t){let e;return{c(){e=b("iconify-icon"),Ze(e,"icon","codicon:sparkle-filled"),Ze(e,"class","svelte-hmrxuw")},m(n,s){F(n,e,s)},d(n){n&&L(e)}}}function Vr(t){let e,n,s=(t[5]?t[2].info.type.replace("/","<b>,</b><br/>"):t[24](t[3]))+"",i,o=!t[5]&&t[6].basic&&Ur();return{c(){e=b("span"),n=new Jc(!1),i=N(),o&&o.c(),n.a=i,m(e,"class","svelte-hmrxuw")},m(r,l){F(r,e,l),n.m(s,e),p(e,i),o&&o.m(e,null)},p(r,l){l[0]&44&&s!==(s=(r[5]?r[2].info.type.replace("/","<b>,</b><br/>"):r[24](r[3]))+"")&&n.p(s),!r[5]&&r[6].basic?o||(o=Ur(),o.c(),o.m(e,null)):o&&(o.d(1),o=null)},d(r){r&&L(e),o&&o.d()}}}function Gr(t){let e,n,s=`${t[5]?"Special":t[4].name.split(" (")[0]}:`,i,o,r=t[20],l,a=Qr(t);return{c(){e=b("div"),n=b("span"),i=ie(s),o=N(),a.c(),m(n,"class","svelte-hmrxuw"),Ge(n,"font-size",Object.keys(t[21]).includes(t[4].name)?`calc(var(--u) * ${t[21][t[4].name]})`:""),m(e,"id",l=t[5]?"":"special"),m(e,"class","svelte-hmrxuw")},m(c,u){F(c,e,u),p(e,n),p(n,i),p(e,o),a.m(e,null)},p(c,u){u[0]&48&&s!==(s=`${c[5]?"Special":c[4].name.split(" (")[0]}:`)&&Re(i,s),u[0]&2097168&&Ge(n,"font-size",Object.keys(c[21]).includes(c[4].name)?`calc(var(--u) * ${c[21][c[4].name]})`:""),u[0]&1048576&&pe(r,r=c[20])?(a.d(1),a=Qr(c),a.c(),a.m(e,null)):a.p(c,u),u[0]&32&&l!==(l=c[5]?"":"special")&&m(e,"id",l)},d(c){c&&L(e),a.d(c)}}}function Yr(t){let e,n;return{c(){e=b("span"),n=ie(t[22]),m(e,"id","prefix"),m(e,"class","svelte-hmrxuw")},m(s,i){F(s,e,i),p(e,n)},p(s,i){i[0]&4194304&&Re(n,s[22])},d(s){s&&L(e)}}}function Kr(t){let e;return{c(){e=b("iconify-icon"),Ze(e,"icon","codicon:sparkle-filled"),Ze(e,"class","svelte-hmrxuw")},m(n,s){F(n,e,s)},d(n){n&&L(e)}}}function Qr(t){let e,n,s=(t[5]?t[2].info.special:t[24](t[4]))+"",i,o,r=t[22]&&!t[5]&&Yr(t),l=!t[5]&&t[6].special&&Kr();return{c(){e=b("span"),r&&r.c(),n=N(),i=ie(s),o=N(),l&&l.c(),m(e,"class","svelte-hmrxuw")},m(a,c){F(a,e,c),r&&r.m(e,null),p(e,n),p(e,i),p(e,o),l&&l.m(e,null)},p(a,c){a[22]&&!a[5]?r?r.p(a,c):(r=Yr(a),r.c(),r.m(e,n)):r&&(r.d(1),r=null),c[0]&52&&s!==(s=(a[5]?a[2].info.special:a[24](a[4]))+"")&&Re(i,s),!a[5]&&a[6].special?l||(l=Kr(),l.c(),l.m(e,null)):l&&(l.d(1),l=null)},d(a){a&&L(e),r&&r.d(),l&&l.d()}}}function xr(t){let e,n,s,i,o,r,l=t[2].name+"",a,c,u,f,d;return{c(){e=b("a"),n=b("img"),o=N(),r=b("span"),a=ie(l),nt(n.src,s=t[2].image)||m(n,"src",s),m(n,"alt",i=t[2].name),m(n,"draggable","false"),m(n,"class","svelte-hmrxuw"),m(r,"class","tooltip svelte-hmrxuw"),m(r,"id",c=t[19].screenshot.ongoing?"right":"top"),m(e,"href",u=t[2].link),m(e,"target","_blank"),m(e,"class","svelte-hmrxuw"),Ge(e,"display",t[2].link?"":"none"),Ge(e,"border-radius",t[2].tool?"calc(var(--u))":"")},m(_,h){F(_,e,h),p(e,n),p(e,o),p(e,r),p(r,a),d=!0},p(_,h){(!d||h[0]&4&&!nt(n.src,s=_[2].image))&&m(n,"src",s),(!d||h[0]&4&&i!==(i=_[2].name))&&m(n,"alt",i),(!d||h[0]&4)&&l!==(l=_[2].name+"")&&Re(a,l),(!d||h[0]&524288&&c!==(c=_[19].screenshot.ongoing?"right":"top"))&&m(r,"id",c),(!d||h[0]&4&&u!==(u=_[2].link))&&m(e,"href",u),h[0]&4&&Ge(e,"display",_[2].link?"":"none"),h[0]&4&&Ge(e,"border-radius",_[2].tool?"calc(var(--u))":"")},i(_){d||(_&&Ee(()=>{d&&(f||(f=Ie(e,st,{duration:150},!0)),f.run(1))}),d=!0)},o(_){_&&(f||(f=Ie(e,st,{duration:150},!1)),f.run(0)),d=!1},d(_){_&&L(e),_&&f&&f.end()}}}function Xr(t){let e,n,s,i,o,r,l,a,c,u;s=new rt({props:{text:"Toggle base values",checked:t[16]}}),s.$on("toggle",t[44]),o=new rt({props:{text:"Eyeball of Reckoning buff",checked:t[17]}}),o.$on("toggle",t[45]);let f=Pe(t[2].moves),d=[];for(let h=0;h<f.length;h+=1)d[h]=el(jr(t,f,h));const _=h=>U(d[h],1,1,()=>{d[h]=null});return{c(){e=b("div"),n=b("div"),ae(s.$$.fragment),i=N(),ae(o.$$.fragment),r=N(),l=b("div");for(let h=0;h<d.length;h+=1)d[h].c();m(n,"class","weaponToggles svelte-hmrxuw"),m(l,"class","weaponMoves svelte-hmrxuw"),m(e,"class","fullWeaponView svelte-hmrxuw")},m(h,g){F(h,e,g),p(e,n),oe(s,n,null),p(n,i),oe(o,n,null),p(e,r),p(e,l);for(let v=0;v<d.length;v+=1)d[v]&&d[v].m(l,null);u=!0},p(h,g){const v={};g[0]&65536&&(v.checked=h[16]),s.$set(v);const w={};if(g[0]&131072&&(w.checked=h[17]),o.$set(w),g[0]&51839108){f=Pe(h[2].moves);let C;for(C=0;C<f.length;C+=1){const y=jr(h,f,C);d[C]?(d[C].p(y,g),B(d[C],1)):(d[C]=el(y),d[C].c(),B(d[C],1),d[C].m(l,null))}for(We(),C=f.length;C<d.length;C+=1)_(C);qe()}},i(h){if(!u){B(s.$$.fragment,h),B(o.$$.fragment,h);for(let g=0;g<f.length;g+=1)B(d[g]);h&&Ee(()=>{u&&(c&&c.end(1),a=Hl(e,st,{duration:150,delay:300}),a.start())}),u=!0}},o(h){U(s.$$.fragment,h),U(o.$$.fragment,h),d=d.filter(Boolean);for(let g=0;g<d.length;g+=1)U(d[g]);a&&a.invalidate(),h&&(c=jl(e,st,{duration:150})),u=!1},d(h){h&&L(e),re(s),re(o),dt(d,h),h&&c&&c.end()}}}function Jr(t){let e,n,s,i;function o(a){t[46](a)}function r(a){t[47](a)}let l={};return t[7]!==void 0&&(l.value=t[7]),t[2].name!==void 0&&(l.weaponName=t[2].name),e=new Zp({props:l}),te.push(()=>De(e,"value",o)),te.push(()=>De(e,"weaponName",r)),{c(){ae(e.$$.fragment)},m(a,c){oe(e,a,c),i=!0},p(a,c){const u={};!n&&c[0]&128&&(n=!0,u.value=a[7],Oe(()=>n=!1)),!s&&c[0]&4&&(s=!0,u.weaponName=a[2].name,Oe(()=>s=!1)),e.$set(u)},i(a){i||(B(e.$$.fragment,a),i=!0)},o(a){U(e.$$.fragment,a),i=!1},d(a){re(e,a)}}}function Zr(t){let e;return{c(){e=b("iconify-icon"),Ze(e,"icon","codicon:sparkle-filled"),Ze(e,"class","svelte-hmrxuw")},m(n,s){F(n,e,s)},d(n){n&&L(e)}}}function $r(t){let e,n=t[22]+(t[16]&&!t[52]?t[51].base:t[52]?t[25](t[51]):t[24](t[51]))+"",s,i,o=t[18][t[51].name]&&!t[16]&&Zr();return{c(){e=b("span"),s=ie(n),i=N(),o&&o.c(),m(e,"class","svelte-hmrxuw")},m(r,l){F(r,e,l),p(e,s),p(e,i),o&&o.m(e,null)},p(r,l){l[0]&65540&&n!==(n=r[22]+(r[16]&&!r[52]?r[51].base:r[52]?r[25](r[51]):r[24](r[51]))+"")&&Re(s,n),r[18][r[51].name]&&!r[16]?o||(o=Zr(),o.c(),o.m(e,null)):o&&(o.d(1),o=null)},d(r){r&&L(e),o&&o.d()}}}function el(t){let e,n,s,i,o=(t[52]&&t[2].name=="Nature's Wrath Spellbook"?t[51].name.replace("Charged","Charge(s)"):t[51].name)+":",r,l,a=t[52]?[t[20],t[7],t[17]]:[t[20],t[17]],c,u,f=t[52]&&Jr(t),d=$r(t);return{c(){e=b("div"),n=b("div"),s=b("span"),f&&f.c(),i=N(),r=ie(o),l=N(),d.c(),c=N(),m(s,"class","svelte-hmrxuw"),m(n,"class","ff-border svelte-hmrxuw"),m(e,"class","svelte-hmrxuw")},m(_,h){F(_,e,h),p(e,n),p(n,s),f&&f.m(s,null),p(s,i),p(s,r),p(n,l),d.m(n,null),p(e,c),u=!0},p(_,h){_[52]?f?(f.p(_,h),h[0]&4&&B(f,1)):(f=Jr(_),f.c(),B(f,1),f.m(s,i)):f&&(We(),U(f,1,1,()=>{f=null}),qe()),(!u||h[0]&4)&&o!==(o=(_[52]&&_[2].name=="Nature's Wrath Spellbook"?_[51].name.replace("Charged","Charge(s)"):_[51].name)+":")&&Re(r,o),h[0]&1179780&&pe(a,a=_[52]?[_[20],_[7],_[17]]:[_[20],_[17]])?(d.d(1),d=$r(_),d.c(),d.m(n,null)):d.p(_,h)},i(_){u||(B(f),u=!0)},o(_){U(f),u=!1},d(_){_&&L(e),f&&f.d(),d.d(_)}}}function tm(t){let e,n,s,i,o,r,l=t[2],a,c,u,f,d,_,h,g,v,w,C,y;function E(k,S){if(k[2].name&&!k[2].tool)return em;if(k[2].tool)return $p}let A=E(t),O=A&&A(t),T=xr(t);function P(k){t[39](k)}function Y(k){t[40](k)}function j(k){t[41](k)}let I={slotName:t[0],index:t[1]};t[14]!==void 0&&(I.slotOpen=t[14]),t[5]!==void 0&&(I.weaponExpand=t[5]),t[15]!==void 0&&(I.optionsOpen=t[15]),f=new Ro({props:I}),te.push(()=>De(f,"slotOpen",P)),te.push(()=>De(f,"weaponExpand",Y)),te.push(()=>De(f,"optionsOpen",j)),f.$on("itemSelect",t[42]),f.$on("toolSelect",t[26]);let D=t[5]&&Xr(t);return{c(){e=b("div"),n=b("button"),n.innerHTML=`<iconify-icon icon="iconamoon:arrow-down-2-fill" class="svelte-hmrxuw"></iconify-icon>
        Gear`,s=N(),i=b("div"),O&&O.c(),o=N(),r=b("div"),T.c(),u=N(),ae(f.$$.fragment),g=N(),D&&D.c(),v=_t(),m(n,"class","ddButton svelte-hmrxuw"),m(r,"class","gearSlotIcon svelte-hmrxuw"),Ee(()=>t[36].call(r)),Ge(r,"min-width",`${t[11]}px`),m(i,"class","gearInfoCont ff-border svelte-hmrxuw"),Ee(()=>t[38].call(i)),Ge(i,"justify-content",t[2].name?"":"flex-end"),m(e,"class","gearSlot svelte-hmrxuw"),ee(e,"slotOpen",t[14]),ee(e,"weapon-expand",t[5])},m(k,S){F(k,e,S),p(e,n),t[32](n),p(e,s),p(e,i),O&&O.m(i,null),p(i,o),p(i,r),T.m(r,null),a=Gt(r,t[36].bind(r)),t[37](i),c=Gt(i,t[38].bind(i)),p(e,u),oe(f,e,null),t[43](e),F(k,g,S),D&&D.m(k,S),F(k,v,S),w=!0,C||(y=[M(window,"mousedown",t[30]),M(window,"keydown",t[31]),M(n,"click",t[33])],C=!0)},p(k,S){A===(A=E(k))&&O?O.p(k,S):(O&&O.d(1),O=A&&A(k),O&&(O.c(),O.m(i,o))),S[0]&4&&pe(l,l=k[2])?(We(),U(T,1,1,se),qe(),T=xr(k),T.c(),B(T,1),T.m(r,null)):T.p(k,S),S[0]&2048&&Ge(r,"min-width",`${k[11]}px`),S[0]&4&&Ge(i,"justify-content",k[2].name?"":"flex-end");const R={};S[0]&1&&(R.slotName=k[0]),S[0]&2&&(R.index=k[1]),!d&&S[0]&16384&&(d=!0,R.slotOpen=k[14],Oe(()=>d=!1)),!_&&S[0]&32&&(_=!0,R.weaponExpand=k[5],Oe(()=>_=!1)),!h&&S[0]&32768&&(h=!0,R.optionsOpen=k[15],Oe(()=>h=!1)),f.$set(R),(!w||S[0]&16384)&&ee(e,"slotOpen",k[14]),(!w||S[0]&32)&&ee(e,"weapon-expand",k[5]),k[5]?D?(D.p(k,S),S[0]&32&&B(D,1)):(D=Xr(k),D.c(),B(D,1),D.m(v.parentNode,v)):D&&(We(),U(D,1,1,()=>{D=null}),qe())},i(k){w||(B(T),B(f.$$.fragment,k),B(D),w=!0)},o(k){U(T),U(f.$$.fragment,k),U(D),w=!1},d(k){k&&(L(e),L(g),L(v)),t[32](null),O&&O.d(),T.d(k),a(),t[37](null),c(),re(f),t[43](null),D&&D.d(k),C=!1,ge(y)}}}function nm(t,e,n){let s,i,o,r,l,a,c;K(t,gn,V=>n(28,s=V)),K(t,Nt,V=>n(29,i=V)),K(t,Ct,V=>n(48,o=V)),K(t,$,V=>n(19,r=V)),K(t,lt,V=>n(20,l=V)),K(t,ai,V=>n(21,a=V)),K(t,Cn,V=>n(49,c=V));let{gearBox:u,slotName:f,index:d}=e,_,h,g,v,w,C,y,E=ri,A,O,T,P,Y,j=!1,I=!1,D="",k={basic:!1,special:!1},S={};function R(){if(y)for(let V of y.querySelectorAll(".gearPreview > div")){if(Object.keys(a).includes(V.id=="basic"?A.name:O?O.name:null))return;let W=lp(V,c);W&&(V.id=="basic"?G(ai,a[A.name]=W,a):G(ai,a[O.name]=W,a))}}function H(V){let W;if(V.name=="Void Needle")W=V.base+l[V.type]-l.armor*5.625;else if(E.name=="Pureblood Dagger"){let _e,je={magicDmg:l.magicDmg,meleeDmg:l.meleeDmg,rangedDmg:l.rangedDmg},ve=Object.keys(je).reduce((Fn,Po)=>je[Fn]>je[Po]?Fn:Po),ht=0;for(let Fn in je)Fn!=ve&&(ht+=je[Fn]);_e=l[ve]*2-ht,W=V.base+(V.name.includes("HP")?_e/2:_e)}else if(V.type.includes("/")){let _e=V.type.split("/"),je=0;for(let ve of _e)je+=l[ve]*V[`${ve}Mult`];W=V.base+je}else W=V.base+l[V.type]*V.mult;return I&&(!V.name.includes("HP")||V.name.includes("HP")&&E.name=="Pureblood Dagger")&&(W+=W*.08775),Y?Math.floor(W*10)/10:Math.floor(W)}function X(V){let W,_e=j?0:l[V.type];return E.name=="Celestial Powers Spellbook"?W=(80+_e*1.1)*(.8+2.2*_/100):E.name=="Staff of Dreams"?W=160+160*_/100+_e*(.4+1.3*_/100):E.name=="Nature's Wrath Spellbook"&&(W=260+400*_/4+_e*(1+1.5*_/4)),I&&(W+=W*.08775),Math.floor(W*10)/10}function Z(){console.log("what"),!r.screenshot.ongoing&&(n(16,j=!1),n(17,I=!1),Y?(n(5,Y=!1),u.classList.remove("weapon-expand"),setTimeout(R)):(u.classList.add("weapon-expand"),n(5,Y=!0)))}function ne(V,W){e:for(let _e in s){let je=o.bonuses.find(ht=>ht.name==_e).stats,ve=V?V.type:null;for(let ht in On){if(ve===null)break e;if(E.name=="Void Spike Ultradagger"&&W=="special"||V.name=="Void Needle"?ve="armor/meleeDmg":E.name=="Pureblood Dagger"?ve=_e=="Fish of Rage"?"":"magicDmg/meleeDmg/rangedDmg":E.name=="Gnome Rocket Launcher"&&(ve=""),s[_e]&&je[ht]!=0&&ve.includes(ht)){n(18,S[V.name]=!0,S),W&&n(6,k[W]=!0,k);break e}else n(18,S[V.name]=!1,S),W&&n(6,k[W]=!1,k)}}}const he=V=>{(!h.contains(V.target)||h.contains(V.target)&&g.contains(V.target))&&(n(14,T=!1),n(15,P=!1))},de=V=>{V.key=="Escape"&&(n(14,T=!1),n(15,P=!1))};function fe(V){te[V?"unshift":"push"](()=>{C=V,n(12,C)})}const z=()=>{r.screenshot.ongoing||n(14,T=!T)};function Q(V){te[V?"unshift":"push"](()=>{y=V,n(13,y)})}const le=V=>{wn(V),Z()};function Ae(){w=this.offsetHeight,n(11,w)}function Ce(V){te[V?"unshift":"push"](()=>{g=V,n(9,g)})}function ke(){v=this.offsetHeight,n(10,v)}function Ve(V){T=V,n(14,T)}function J(V){Y=V,n(5,Y)}function et(V){P=V,n(15,P)}const He=()=>{setTimeout(()=>{R(),(!E.name||E.tool)&&Y&&Z(),n(15,P=!1)})};function ce(V){te[V?"unshift":"push"](()=>{h=V,n(8,h)})}const q=V=>{n(16,j=V.detail),V.detail&&n(17,I=!1)},Le=V=>{n(17,I=V.detail),V.detail&&n(16,j=!1)};function me(V){_=V,n(7,_)}function it(V){t.$$.not_equal(E.name,V)&&(E.name=V,n(2,E),n(29,i),n(1,d),n(4,O))}return t.$$set=V=>{"gearBox"in V&&n(27,u=V.gearBox),"slotName"in V&&n(0,f=V.slotName),"index"in V&&n(1,d=V.index)},t.$$.update=()=>{if(t.$$.dirty[0]&536870934&&i[d]&&i[d].name!=E.name&&(n(2,E=i[d]),!E.tool&&E.name)){n(3,A=E.moves.filter(V=>V.basic)[0]),n(4,O=E.moves.filter(V=>V.special)[0]),n(18,S={});for(let V of E.moves)n(18,S[V.name]=!1,S),ne(V);O&&O.name.includes("Fantastic Beamstorm")?n(22,D="~"):n(22,D="")}if(t.$$.dirty[0]&268435580&&(s||Y)&&!E.tool&&E.name){for(let V in k)ne(V=="basic"?A:O||null,V);for(let V of E.moves)ne(V)}},[f,d,E,A,O,Y,k,_,h,g,v,w,C,y,T,P,j,I,S,r,l,a,D,R,H,X,Z,u,s,i,he,de,fe,z,Q,le,Ae,Ce,ke,Ve,J,et,He,ce,q,Le,me,it]}class sm extends Ne{constructor(e){super(),Te(this,e,nm,tm,pe,{gearBox:27,slotName:0,index:1},null,[-1,-1])}}function tl(t,e,n){const s=t.slice();return s[3]=e[n],s}function nl(t){let e,n,s;function i(r){t[1](r)}let o={slotName:"gear",index:t[3]};return t[0]!==void 0&&(o.gearBox=t[0]),e=new sm({props:o}),te.push(()=>De(e,"gearBox",i)),{c(){ae(e.$$.fragment)},m(r,l){oe(e,r,l),s=!0},p(r,l){const a={};!n&&l&1&&(n=!0,a.gearBox=r[0],Oe(()=>n=!1)),e.$set(a)},i(r){s||(B(e.$$.fragment,r),s=!0)},o(r){U(e.$$.fragment,r),s=!1},d(r){re(e,r)}}}function im(t){let e,n,s=Pe(Vt),i=[];for(let r=0;r<s.length;r+=1)i[r]=nl(tl(t,s,r));const o=r=>U(i[r],1,1,()=>{i[r]=null});return{c(){e=b("div");for(let r=0;r<i.length;r+=1)i[r].c();m(e,"class","gearBox svelte-1lv6xba")},m(r,l){F(r,e,l);for(let a=0;a<i.length;a+=1)i[a]&&i[a].m(e,null);t[2](e),n=!0},p(r,[l]){if(l&1){s=Pe(Vt);let a;for(a=0;a<s.length;a+=1){const c=tl(r,s,a);i[a]?(i[a].p(c,l),B(i[a],1)):(i[a]=nl(c),i[a].c(),B(i[a],1),i[a].m(e,null))}for(We(),a=s.length;a<i.length;a+=1)o(a);qe()}},i(r){if(!n){for(let l=0;l<s.length;l+=1)B(i[l]);n=!0}},o(r){i=i.filter(Boolean);for(let l=0;l<i.length;l+=1)U(i[l]);n=!1},d(r){r&&L(e),dt(i,r),t[2](null)}}}function om(t,e,n){let s;function i(r){s=r,n(0,s)}function o(r){te[r?"unshift":"push"](()=>{s=r,n(0,s)})}return[s,i,o]}class rm extends Ne{constructor(e){super(),Te(this,e,om,im,pe,{})}}function lm(t){let e,n,s,i,o,r,l,a;return{c(){e=b("div"),n=b("div"),s=b("button"),s.textContent="Clear armor",i=N(),o=b("div"),r=b("button"),r.textContent="Clear gear",m(s,"class","svelte-e94uvj"),m(n,"class","buttonCont svelte-e94uvj"),m(r,"class","svelte-e94uvj"),m(o,"class","buttonCont svelte-e94uvj"),m(e,"class","mainFeatures svelte-e94uvj"),m(e,"id","box")},m(c,u){F(c,e,u),p(e,n),p(n,s),p(e,i),p(e,o),p(o,r),l||(a=[M(s,"click",t[3]),M(r,"click",t[4])],l=!0)},p:se,i:se,o:se,d(c){c&&L(e),l=!1,ge(a)}}}function am(t,e,n){let s,i,o,r,l;K(t,Nt,d=>n(5,s=d)),K(t,En,d=>n(6,i=d)),K(t,kt,d=>n(7,o=d)),K(t,kn,d=>n(8,r=d)),K(t,Cn,d=>n(0,l=d));function a(){for(let d in o)o[d].name&&r[d][o[d].name].querySelector("button").click()}function c(){for(let d in s)s[d].name&&i[d][s[d].name].querySelector("button").click()}return[l,a,c,d=>{d.target.blur(),l||a()},d=>{d.target.blur(),l||c()}]}class cm extends Ne{constructor(e){super(),Te(this,e,am,lm,pe,{})}}function sl(t){let e,n,s;function i(r){t[3](r)}let o={slotName:"sets"};return t[0]!==void 0&&(o.slotOpen=t[0]),e=new Ro({props:o}),te.push(()=>De(e,"slotOpen",i)),{c(){ae(e.$$.fragment)},m(r,l){oe(e,r,l),s=!0},p(r,l){const a={};!n&&l&1&&(n=!0,a.slotOpen=r[0],Oe(()=>n=!1)),e.$set(a)},i(r){s||(B(e.$$.fragment,r),s=!0)},o(r){U(e.$$.fragment,r),s=!1},d(r){re(e,r)}}}function um(t){let e,n,s,i,o,r,l=t[1].head&&t[1].body&&t[1].legs&&t[1].feet&&sl(t);return{c(){e=b("button"),e.innerHTML=`Load armor set
    <iconify-icon icon="iconamoon:arrow-down-2-fill" rotate="180deg" class="svelte-l9dczq"></iconify-icon>`,n=N(),l&&l.c(),s=_t(),m(e,"class","svelte-l9dczq"),ee(e,"ddOpen",t[0])},m(a,c){F(a,e,c),F(a,n,c),l&&l.m(a,c),F(a,s,c),i=!0,o||(r=M(e,"click",t[2]),o=!0)},p(a,[c]){(!i||c&1)&&ee(e,"ddOpen",a[0]),a[1].head&&a[1].body&&a[1].legs&&a[1].feet?l?(l.p(a,c),c&2&&B(l,1)):(l=sl(a),l.c(),B(l,1),l.m(s.parentNode,s)):l&&(We(),U(l,1,1,()=>{l=null}),qe())},i(a){i||(B(l),i=!0)},o(a){U(l),i=!1},d(a){a&&(L(e),L(n),L(s)),l&&l.d(a),o=!1,r()}}}function dm(t,e,n){let s;K(t,Ct,l=>n(1,s=l));let{ddOpen:i=!1}=e;const o=()=>n(0,i=!i);function r(l){i=l,n(0,i)}return t.$$set=l=>{"ddOpen"in l&&n(0,i=l.ddOpen)},[i,s,o,r]}class fm extends Ne{constructor(e){super(),Te(this,e,dm,um,pe,{ddOpen:0})}}function hm(t){let e;return{c(){e=b("span"),e.textContent="Create some builds to get started!",m(e,"class","tooltip svelte-xynefd"),m(e,"id","top"),Ge(e,"left","70.5%")},m(n,s){F(n,e,s)},p:se,d(n){n&&L(e)}}}function _m(t){let e;return{c(){e=b("span"),e.textContent="Select some gear or armor to get started!",m(e,"class","tooltip svelte-xynefd"),m(e,"id","top"),Ge(e,"left",t[3]?"38%":"")},m(n,s){F(n,e,s)},p(n,s){s&8&&Ge(e,"left",n[3]?"38%":"")},d(n){n&&L(e)}}}function pm(t){let e,n,s,i,o,r,l,a,c,u,f,d,_,h,g,v,w,C,y,E,A,O,T,P,Y,j,I,D;function k(Z,ne){if(!Z[4])return _m;if(!Z[3])return hm}let S=k(t),R=S&&S(t);function H(Z){t[18](Z)}let X={};return t[1]!==void 0&&(X.ddOpen=t[1]),P=new fm({props:X}),te.push(()=>De(P,"ddOpen",H)),{c(){e=b("div"),n=b("div"),s=b("div"),i=b("button"),o=ie("Export new build"),l=N(),a=b("div"),c=b("button"),u=ie("Save to build"),d=N(),_=b("div"),h=b("button"),g=ie("Delete build"),w=N(),R&&R.c(),C=N(),y=b("div"),E=b("div"),A=b("button"),A.textContent="Load build",O=N(),T=b("div"),ae(P.$$.fragment),i.disabled=r=!t[4],m(i,"class","svelte-xynefd"),m(s,"class","buttonCont svelte-xynefd"),c.disabled=f=!t[4]||!t[3],m(c,"class","svelte-xynefd"),m(a,"class","buttonCont svelte-xynefd"),m(a,"id","middle"),h.disabled=v=!t[3],m(h,"class","svelte-xynefd"),m(_,"class","buttonCont svelte-xynefd"),m(n,"id","modify"),m(n,"class","svelte-xynefd"),ee(n,"no-tooltip",t[2]),m(A,"class","svelte-xynefd"),m(E,"class","buttonCont svelte-xynefd"),m(T,"class","buttonCont svelte-xynefd"),m(y,"id","load"),m(y,"class","svelte-xynefd"),m(e,"class","mainFeatures svelte-xynefd"),m(e,"id","build")},m(Z,ne){F(Z,e,ne),p(e,n),p(n,s),p(s,i),p(i,o),p(n,l),p(n,a),p(a,c),p(c,u),p(n,d),p(n,_),p(_,h),p(h,g),p(n,w),R&&R.m(n,null),p(e,C),p(e,y),p(y,E),p(E,A),p(y,O),p(y,T),oe(P,T,null),t[19](T),j=!0,I||(D=[M(window,"mousedown",t[8]),M(window,"keydown",t[9]),M(i,"click",t[10]),M(i,"mouseenter",t[11]),M(i,"mouseleave",t[12]),M(c,"click",t[13]),M(h,"click",t[14]),M(h,"mouseenter",t[15]),M(h,"mouseleave",t[16]),M(A,"click",t[17])],I=!0)},p(Z,[ne]){(!j||ne&16&&r!==(r=!Z[4]))&&(i.disabled=r),(!j||ne&24&&f!==(f=!Z[4]||!Z[3]))&&(c.disabled=f),(!j||ne&8&&v!==(v=!Z[3]))&&(h.disabled=v),S===(S=k(Z))&&R?R.p(Z,ne):(R&&R.d(1),R=S&&S(Z),R&&(R.c(),R.m(n,null))),(!j||ne&4)&&ee(n,"no-tooltip",Z[2]);const he={};!Y&&ne&2&&(Y=!0,he.ddOpen=Z[1],Oe(()=>Y=!1)),P.$set(he)},i(Z){j||(B(P.$$.fragment,Z),j=!0)},o(Z){U(P.$$.fragment,Z),j=!1},d(Z){Z&&L(e),R&&R.d(),re(P),t[19](null),I=!1,ge(D)}}}function mm(t,e,n){let s,i,o,r,l;K(t,gt,T=>n(7,s=T)),K(t,zt,T=>n(3,i=T)),K(t,Qi,T=>n(4,o=T)),K(t,Cn,T=>n(5,r=T)),K(t,$,T=>n(6,l=T));let a,c=!1,u=!1;const f=T=>{a.contains(T.target)||n(1,c=!1)},d=T=>{T.key=="Escape"&&n(1,c=!1)},_=()=>{o&&!r&&G($,l.export.ongoing=!0,l)},h=()=>n(2,u=!0),g=()=>n(2,u=!1),v=()=>{o&&i&&!r&&G($,l.save.ongoing=!0,l)},w=()=>{i&&!r&&G($,l.delete.ongoing=!0,l)},C=()=>n(2,u=!0),y=()=>n(2,u=!1),E=()=>{r||G($,l.load.ongoing=!0,l)};function A(T){c=T,n(1,c)}function O(T){te[T?"unshift":"push"](()=>{a=T,n(0,a)})}return t.$$.update=()=>{t.$$.dirty&128&&G(zt,i=Object.keys(s).length>0,i)},[a,c,u,i,o,r,l,s,f,d,_,h,g,v,w,C,y,E,A,O]}class gm extends Ne{constructor(e){super(),Te(this,e,mm,pm,pe,{})}}function il(t){let e;return{c(){e=b("span"),e.textContent="New changes! Exiting will erase them.",m(e,"id","alert")},m(n,s){F(n,e,s)},d(n){n&&L(e)}}}function bm(t){let e,n,s,i,o,r,l,a=25-t[3].length+"",c,u,f,d,_,h,g,v,w,C,y,E=275-t[4].length+"",A,O,T,P,Y,j,I,D,k,S,R,H,X,Z,ne,he,de=(t[3]||t[4])&&il();return{c(){e=b("div"),n=b("div"),s=ie(`Name:\r
        `),i=b("input"),r=N(),l=b("span"),c=ie(a),u=N(),f=b("div"),d=b("div"),_=b("span"),_.textContent="Description / Notes:",h=N(),de&&de.c(),g=N(),v=b("textarea"),C=N(),y=b("span"),A=ie(E),O=N(),T=b("div"),P=b("div"),Y=b("button"),j=ie("CANCEL"),D=N(),k=b("div"),S=b("button"),R=ie("EXPORT"),m(i,"class","buildNameInput"),m(i,"id","firstFocusable"),i.disabled=o=t[5].export.status==0,m(i,"type","text"),m(i,"placeholder",t[6]),m(i,"maxlength","25"),m(l,"class","charCounter svelte-1vypdkl"),m(l,"id","buildName"),m(n,"class","buildNameCont svelte-1vypdkl"),m(v,"class","buildDescInput"),v.disabled=w=t[5].export.status==0,m(v,"placeholder","[Empty]"),m(v,"maxlength","275"),m(v,"autocomplete","off"),m(y,"class","charCounter"),m(y,"id","buildDesc"),m(f,"class","buildDescCont"),Y.disabled=I=t[5].export.status==0,m(S,"id","lastFocusable"),S.disabled=H=t[5].export.status==0,m(T,"class","promptOptions"),m(e,"class","buildExporter svelte-1vypdkl")},m(fe,z){F(fe,e,z),p(e,n),p(n,s),p(n,i),t[8](i),It(i,t[3]),p(n,r),p(n,l),p(l,c),p(e,u),p(e,f),p(f,d),p(d,_),p(d,h),de&&de.m(d,null),p(f,g),p(f,v),It(v,t[4]),t[13](v),p(f,C),p(f,y),p(y,A),p(e,O),p(e,T),p(T,P),p(P,Y),p(Y,j),t[16](Y),p(T,D),p(T,k),p(k,S),p(S,R),Z=!0,ne||(he=[M(i,"input",t[9]),M(i,"input",t[10]),M(i,"keydown",t[11]),M(v,"input",t[12]),M(v,"input",t[14]),M(v,"keydown",t[15]),M(Y,"click",t[17]),M(S,"click",t[18]),M(S,"keydown",mt),M(e,"introstart",t[19])],ne=!0)},p(fe,[z]){(!Z||z&32&&o!==(o=fe[5].export.status==0))&&(i.disabled=o),z&8&&i.value!==fe[3]&&It(i,fe[3]),(!Z||z&8)&&a!==(a=25-fe[3].length+"")&&Re(c,a),fe[3]||fe[4]?de||(de=il(),de.c(),de.m(d,null)):de&&(de.d(1),de=null),(!Z||z&32&&w!==(w=fe[5].export.status==0))&&(v.disabled=w),z&16&&It(v,fe[4]),(!Z||z&16)&&E!==(E=275-fe[4].length+"")&&Re(A,E),(!Z||z&32&&I!==(I=fe[5].export.status==0))&&(Y.disabled=I),(!Z||z&32&&H!==(H=fe[5].export.status==0))&&(S.disabled=H)},i(fe){Z||(fe&&Ee(()=>{Z&&(X||(X=Ie(e,Ye,{duration:250},!0)),X.run(1))}),Z=!0)},o(fe){fe&&(X||(X=Ie(e,Ye,{duration:250},!1)),X.run(0)),Z=!1},d(fe){fe&&L(e),t[8](null),de&&de.d(),t[13](null),t[16](null),fe&&X&&X.end(),ne=!1,ge(he)}}}function vm(t,e,n){let s,i,o,r,l,a;K(t,$,k=>n(5,s=k)),K(t,at,k=>n(20,i=k)),K(t,zt,k=>n(21,o=k)),K(t,Nt,k=>n(22,r=k)),K(t,kt,k=>n(23,l=k)),K(t,gt,k=>n(24,a=k));let c=Object.keys(a).length,u,f,d,_="",h="",g=`My ${c+1+Ac[(c+1)%10]} build`;function v(){if(G($,s.export.status=0,s),_.endsWith(" ")&&n(3,_=_.replace(/  +/g," ").replace(/ $/,"")),h.endsWith(" ")&&n(4,h=h.replace(/  +/g," ").replace(/ $/,"")),Object.keys(a).includes(_)){G($,s.export.status=-1,s),G($,s.message="duplicate_name",s);return}let k=q_(Lt(Nn(Dn),"builds")).key,S=Lc(l,r);S.name=_||g,S.desc=h||"[Empty]",ti(Lt(Nn(Dn),`builds/${k}`),S).then(()=>{G($,s.export.status=1,s),G(zt,o=!0,o),Do(),gt.update(R=>({...R,[S.name]:{id:k,desc:S.desc}})),G(at,i=S,i),G(at,i.id=k,i),navigator.clipboard.writeText(`${location.origin+location.pathname}?id=${k}`)}).catch(()=>{G($,s.export.status=-1,s),G($,s.message="firebase_fail",s)})}function w(k){te[k?"unshift":"push"](()=>{u=k,n(0,u)})}function C(){_=this.value,n(3,_)}const y=k=>{n(3,_=Hs(k.target.value,25))},E=k=>{s.export.status==0&&k.preventDefault(),pt(k),Hi(u,k.target.value,25)};function A(){h=this.value,n(4,h)}function O(k){te[k?"unshift":"push"](()=>{f=k,n(1,f)})}const T=k=>{n(4,h=Hs(k.target.value,275))},P=k=>{s.export.status==0&&k.preventDefault(),Hi(f,k.target.value,275)};function Y(k){te[k?"unshift":"push"](()=>{d=k,n(2,d)})}return[u,f,d,_,h,s,g,v,w,C,y,E,A,O,T,P,Y,()=>{s.export.status!=0&&G($,s.export.ongoing=!1,s)},()=>{s.export.status!=0&&v()},()=>d.focus()]}class ym extends Ne{constructor(e){super(),Te(this,e,vm,bm,pe,{})}}function wm(t){let e,n,s,i,o=t[2]?"Copied!":"Copy link",r,l,a;return{c(){e=b("button"),n=b("b"),n.textContent="Build link",s=N(),i=b("span"),r=ie(o),m(i,"class","tooltip"),m(i,"id","top"),m(e,"class","copyButton svelte-1e8zrsj"),m(e,"id","firstFocusable")},m(c,u){F(c,e,u),p(e,n),p(e,s),p(e,i),p(i,r),l||(a=[M(e,"click",t[7]),M(e,"keydown",pt)],l=!0)},p(c,u){u&4&&o!==(o=c[2]?"Copied!":"Copy link")&&Re(r,o)},d(c){c&&L(e),l=!1,ge(a)}}}function Cm(t){let e,n,s,i,o,r,l=t[2]?"Copied!":"Copy ID",a,c,u,f;return{c(){e=b("button"),n=b("b"),n.textContent="ID:",s=N(),i=ie(t[4]),o=N(),r=b("span"),a=ie(l),m(r,"class","tooltip"),m(r,"id","top"),m(e,"class","copyButton svelte-1e8zrsj"),m(e,"id",c=t[1]!="save"?"firstFocusable":"")},m(d,_){F(d,e,_),p(e,n),p(e,s),p(e,i),p(e,o),p(e,r),p(r,a),u||(f=[M(e,"click",t[5]),M(e,"keydown",t[6])],u=!0)},p(d,_){_&4&&l!==(l=d[2]?"Copied!":"Copy ID")&&Re(a,l),_&2&&c!==(c=d[1]!="save"?"firstFocusable":"")&&m(e,"id",c)},d(d){d&&L(e),u=!1,ge(f)}}}function km(t){let e;function n(o,r){if(o[0]=="id")return Cm;if(o[0]=="link")return wm}let s=n(t),i=s&&s(t);return{c(){i&&i.c(),e=_t()},m(o,r){i&&i.m(o,r),F(o,e,r)},p(o,[r]){s===(s=n(o))&&i?i.p(o,r):(i&&i.d(1),i=s&&s(o),i&&(i.c(),i.m(e.parentNode,e)))},i:se,o:se,d(o){o&&L(e),i&&i.d(o)}}}function Em(t,e,n){let s;K(t,at,d=>n(8,s=d));let{type:i,source:o}=e,r=!1;function l(d){r||(navigator.clipboard.writeText(d),n(2,r=!0),setTimeout(()=>{n(2,r=!1)},1e3))}let a=s?s.id:null;const c=()=>l(a),u=()=>{o!="save"&&pt()},f=()=>l(`${location.origin+location.pathname}?id=${a}`);return t.$$set=d=>{"type"in d&&n(0,i=d.type),"source"in d&&n(1,o=d.source)},[i,o,r,l,a,c,u,f]}class ls extends Ne{constructor(e){super(),Te(this,e,Em,km,pe,{type:0,source:1})}}function Sm(t){let e,n,s,i;return e=new ls({props:{type:"link",source:"share"}}),s=new ls({props:{type:"id",source:"share"}}),{c(){ae(e.$$.fragment),n=N(),ae(s.$$.fragment)},m(o,r){oe(e,o,r),F(o,n,r),oe(s,o,r),i=!0},p:se,i(o){i||(B(e.$$.fragment,o),B(s.$$.fragment,o),i=!0)},o(o){U(e.$$.fragment,o),U(s.$$.fragment,o),i=!1},d(o){o&&L(n),re(e,o),re(s,o)}}}function Im(t){let e;return{c(){e=b("span"),e.textContent="Your build has been erased from your local saves and the database."},m(n,s){F(n,e,s)},p:se,i:se,o:se,d(n){n&&L(e)}}}function Tm(t){let e;function n(o,r){if(o[2].message=="not_found")return Am;if(o[2].message=="invalid_id")return Rm}let s=n(t),i=s&&s(t);return{c(){i&&i.c(),e=_t()},m(o,r){i&&i.m(o,r),F(o,e,r)},p(o,r){s!==(s=n(o))&&(i&&i.d(1),i=s&&s(o),i&&(i.c(),i.m(e.parentNode,e)))},i:se,o:se,d(o){o&&L(e),i&&i.d(o)}}}function Nm(t){let e,n,s,i,o,r;return s=new ls({props:{type:"link",source:"save"}}),o=new ls({props:{type:"id",source:"save"}}),{c(){e=b("span"),e.textContent="Your build has been overwritten.",n=N(),ae(s.$$.fragment),i=N(),ae(o.$$.fragment)},m(l,a){F(l,e,a),F(l,n,a),oe(s,l,a),F(l,i,a),oe(o,l,a),r=!0},p:se,i(l){r||(B(s.$$.fragment,l),B(o.$$.fragment,l),r=!0)},o(l){U(s.$$.fragment,l),U(o.$$.fragment,l),r=!1},d(l){l&&(L(e),L(n),L(i)),re(s,l),re(o,l)}}}function Om(t){let e,n,s,i;const o=[Mm,Pm],r=[];function l(a,c){return a[2].export.status==1?0:a[2].export.status==-1&&a[2].message=="duplicate_name"?1:-1}return~(e=l(t))&&(n=r[e]=o[e](t)),{c(){n&&n.c(),s=_t()},m(a,c){~e&&r[e].m(a,c),F(a,s,c),i=!0},p(a,c){let u=e;e=l(a),e!==u&&(n&&(We(),U(r[u],1,1,()=>{r[u]=null}),qe()),~e?(n=r[e],n||(n=r[e]=o[e](a),n.c()),B(n,1),n.m(s.parentNode,s)):n=null)},i(a){i||(B(n),i=!0)},o(a){U(n),i=!1},d(a){a&&L(s),~e&&r[e].d(a)}}}function Dm(t){let e,n,s=t[2].export.status?"exporting":t[2].save.status?"saving":t[2].load.status?"loading":"deleting",i,o,r,l,a,c,u,f;return{c(){e=b("span"),n=ie("A problem occurred while "),i=ie(s),o=ie(` your build.\r
            `),r=b("br"),l=ie(`\r
            If needed`),a=b("b"),a.textContent=",",c=ie(" you may contact "),u=b("hl"),u.textContent="xt.ss",f=ie(` on Discord for more\r
            details.`)},m(d,_){F(d,e,_),p(e,n),p(e,i),p(e,o),p(e,r),p(e,l),p(e,a),p(e,c),p(e,u),p(e,f)},p(d,_){_&4&&s!==(s=d[2].export.status?"exporting":d[2].save.status?"saving":d[2].load.status?"loading":"deleting")&&Re(i,s)},i:se,o:se,d(d){d&&L(e)}}}function Rm(t){let e;return{c(){e=b("span"),e.textContent="The ID you have entered is invalid. Please check it again."},m(n,s){F(n,e,s)},d(n){n&&L(e)}}}function Am(t){let e;return{c(){e=b("span"),e.innerHTML=`Your build could not be found within the database.
                <br/>
                If needed<b>,</b> you may contact <hl>xt.ss</hl> on Discord for more
                details.`},m(n,s){F(n,e,s)},d(n){n&&L(e)}}}function Pm(t){let e;return{c(){e=b("span"),e.innerHTML=`Another build of yours with the same name already exists.
                <br/>
                Please use a different one.`},m(n,s){F(n,e,s)},i:se,o:se,d(n){n&&L(e)}}}function Mm(t){let e,n,s,i;return s=new ls({props:{type:"id",source:"export"}}),{c(){e=b("span"),e.textContent="Your build's link has been copied to your clipboard.",n=N(),ae(s.$$.fragment)},m(o,r){F(o,e,r),F(o,n,r),oe(s,o,r),i=!0},i(o){i||(B(s.$$.fragment,o),i=!0)},o(o){U(s.$$.fragment,o),i=!1},d(o){o&&(L(e),L(n)),re(s,o)}}}function Lm(t){let e,n,s,i,o,r,l,a,c,u,f,d,_,h,g,v,w;const C=[Dm,Om,Nm,Tm,Im,Sm],y=[];function E(A,O){return A[1]==-1&&A[2].message=="firebase_fail"?0:A[2].export.status?1:A[2].save.status==1?2:A[2].load.status==-1?3:A[2].delete.status==1?4:A[2].share.ongoing?5:-1}return~(o=E(t))&&(r=y[o]=C[o](t)),{c(){e=b("div"),n=b("span"),s=ie(t[4]),i=N(),r&&r.c(),l=N(),a=b("div"),c=b("div"),u=b("button"),f=ie("OK"),m(n,"id","messageTitle"),m(n,"class","svelte-nfbx2w"),m(u,"id",d=(t[1]==-1?"firstFocusable ":"")+"lastFocusable"),m(a,"class","promptOptions svelte-nfbx2w"),m(e,"class","promptMessage svelte-nfbx2w")},m(A,O){F(A,e,O),p(e,n),p(n,s),p(e,i),~o&&y[o].m(e,null),p(e,l),p(e,a),p(a,c),p(c,u),p(u,f),t[6](u),g=!0,v||(w=[M(u,"click",t[7]),M(u,"keydown",t[8]),M(e,"introstart",t[9])],v=!0)},p(A,[O]){(!g||O&16)&&Re(s,A[4]);let T=o;o=E(A),o===T?~o&&y[o].p(A,O):(r&&(We(),U(y[T],1,1,()=>{y[T]=null}),qe()),~o?(r=y[o],r?r.p(A,O):(r=y[o]=C[o](A),r.c()),B(r,1),r.m(e,l)):r=null),(!g||O&2&&d!==(d=(A[1]==-1?"firstFocusable ":"")+"lastFocusable"))&&m(u,"id",d)},i(A){g||(B(r),A&&Ee(()=>{g&&(h&&h.end(1),_=Hl(e,Ye,{duration:200,delay:75}),_.start())}),g=!0)},o(A){U(r),_&&_.invalidate(),A&&(h=jl(e,Ye,{duration:200})),g=!1},d(A){A&&L(e),~o&&y[o].d(),t[6](null),A&&h&&h.end(),v=!1,ge(w)}}}function Fm(t,e,n){let s,i,o;K(t,$,_=>n(2,o=_));let{loadID:r}=e;const l=Dt();let a;function c(_){te[_?"unshift":"push"](()=>{a=_,n(3,a)})}const u=()=>{n(0,r=null),l("resetActions")},f=_=>{i==-1&&pt(_),mt(_)},d=()=>a.focus();return t.$$set=_=>{"loadID"in _&&n(0,r=_.loadID)},t.$$.update=()=>{t.$$.dirty&4&&n(1,i=o.export.status||o.save.status||o.load.status||o.delete.status),t.$$.dirty&6&&n(4,s=o.share.ongoing?"Share this build":`${o.export.status?"Export":o.save.status?"Save":o.load.status?"Load":"Delete"} ${i==1?"Success":"Failure"}!`)},[r,i,o,a,s,l,c,u,f,d]}class Bm extends Ne{constructor(e){super(),Te(this,e,Fm,Lm,pe,{loadID:0})}}function zm(t){let e,n,s,i,o,r;return{c(){e=b("li"),n=b("button"),s=b("span"),i=ie(t[0]),m(s,"class","svelte-1opo0ke"),m(e,"class","svelte-1opo0ke"),ee(e,"selectedItem",t[2])},m(l,a){F(l,e,a),p(e,n),p(n,s),p(s,i),t[7](e),o||(r=M(n,"click",t[3]),o=!0)},p(l,[a]){a&1&&Re(i,l[0]),a&4&&ee(e,"selectedItem",l[2])},i:se,o:se,d(l){l&&L(e),t[7](null),o=!1,r()}}}function Wm(t,e,n){let{chosenBuild:s,buildData:i,buildName:o,ddOpen:r}=e;const l=Dt();let a,c=s[0]==o;function u(){if(r){if(a.classList.contains("selectedItem")||n(2,c=!1),c)return;l("buildSelect",a),n(2,c=!0),n(5,r=!1),n(4,s=[o,i])}}function f(d){te[d?"unshift":"push"](()=>{a=d,n(1,a)})}return t.$$set=d=>{"chosenBuild"in d&&n(4,s=d.chosenBuild),"buildData"in d&&n(6,i=d.buildData),"buildName"in d&&n(0,o=d.buildName),"ddOpen"in d&&n(5,r=d.ddOpen)},[o,a,c,u,s,r,i,f]}class qm extends Ne{constructor(e){super(),Te(this,e,Wm,zm,pe,{chosenBuild:4,buildData:6,buildName:0,ddOpen:5})}}function ol(t,e,n){const s=t.slice();return s[25]=e[n][0],s[26]=e[n][1],s}function rl(t){let e,n,s,i;function o(a){t[13](a)}function r(a){t[14](a)}let l={buildData:t[26],buildName:t[25]};return t[0]!==void 0&&(l.chosenBuild=t[0]),t[1]!==void 0&&(l.ddOpen=t[1]),e=new qm({props:l}),te.push(()=>De(e,"chosenBuild",o)),te.push(()=>De(e,"ddOpen",r)),e.$on("buildSelect",t[11]),{c(){ae(e.$$.fragment)},m(a,c){oe(e,a,c),i=!0},p(a,c){const u={};c&16&&(u.buildData=a[26]),c&16&&(u.buildName=a[25]),!n&&c&1&&(n=!0,u.chosenBuild=a[0],Oe(()=>n=!1)),!s&&c&2&&(s=!0,u.ddOpen=a[1],Oe(()=>s=!1)),e.$set(u)},i(a){i||(B(e.$$.fragment,a),i=!0)},o(a){U(e.$$.fragment,a),i=!1},d(a){re(e,a)}}}function Hm(t){let e,n,s,i,o,r,l,a=Pe(Object.entries(t[4])),c=[];for(let f=0;f<a.length;f+=1)c[f]=rl(ol(t,a,f));const u=f=>U(c[f],1,1,()=>{c[f]=null});return{c(){e=b("div"),n=b("input"),s=N(),i=b("ul");for(let f=0;f<c.length;f+=1)c[f].c();m(n,"type","text"),m(n,"class","searchBarInput svelte-p20blu"),m(n,"placeholder","Search..."),m(i,"class","svelte-p20blu"),ee(i,"no-scrollbar",t[8].length<=4),m(e,"class","dropdown svelte-p20blu"),ee(e,"ddOpen",t[1])},m(f,d){F(f,e,d),p(e,n),t[12](n),p(e,s),p(e,i);for(let _=0;_<c.length;_+=1)c[_]&&c[_].m(i,null);t[15](i),t[16](e),o=!0,r||(l=[M(n,"input",t[10]),M(n,"keydown",t[9]),M(e,"transitionend",t[17]),M(e,"transitioncancel",t[18])],r=!0)},p(f,[d]){if(d&2067){a=Pe(Object.entries(f[4]));let _;for(_=0;_<a.length;_+=1){const h=ol(f,a,_);c[_]?(c[_].p(h,d),B(c[_],1)):(c[_]=rl(h),c[_].c(),B(c[_],1),c[_].m(i,null))}for(We(),_=a.length;_<c.length;_+=1)u(_);qe()}(!o||d&256)&&ee(i,"no-scrollbar",f[8].length<=4),(!o||d&2)&&ee(e,"ddOpen",f[1])},i(f){if(!o){for(let d=0;d<a.length;d+=1)B(c[d]);o=!0}},o(f){c=c.filter(Boolean);for(let d=0;d<c.length;d+=1)U(c[d]);o=!1},d(f){f&&L(e),t[12](null),dt(c,f),t[15](null),t[16](null),r=!1,ge(l)}}}function jm(t,e,n){let s;K(t,gt,D=>n(4,s=D));let{chosenBuild:i,ddOpen:o=!1,dropdown:r}=e;const l=Dt();let a,c,u,f,d={},_=!1,h=[];function g(D){!D.shiftKey&&D.key=="Tab"&&(D.preventDefault(),setTimeout(()=>a.focus()))}function v(){c&&c.removeEventListener("keydown",g),y(),c&&c.addEventListener("keydown",g)}function w(D){D.shiftKey&&D.key=="Tab"&&(D.preventDefault(),setTimeout(()=>(c.querySelector("button")||c).focus()))}function C(){Mc(a.value,d),v()}function y(){c&&c.classList.remove("lastElement"),n(8,h=u.querySelectorAll("li:not(.hidden)")),c=h[h.length-1],c?c.classList.add("lastElement"):c=a}function E(D){l("buildSelect"),n(6,f=D.detail);let k=u.querySelector(".selectedItem");k&&k!=D.detail&&k.classList.remove("selectedItem"),n(7,_=!0)}function A(D){te[D?"unshift":"push"](()=>{a=D,n(5,a)})}function O(D){i=D,n(0,i)}function T(D){o=D,n(1,o)}function P(D){te[D?"unshift":"push"](()=>{u=D,n(3,u)})}function Y(D){te[D?"unshift":"push"](()=>{r=D,n(2,r)})}const j=D=>{D.propertyName=="visibility"&&(_&&(n(7,_=!1),n(5,a.value="",a),C()),!o&&f&&u.scrollTo(0,f.offsetTop),qs(a,o))},I=D=>{D.propertyName=="visibility"&&(n(7,_=!1),qs(a,o))};return t.$$set=D=>{"chosenBuild"in D&&n(0,i=D.chosenBuild),"ddOpen"in D&&n(1,o=D.ddOpen),"dropdown"in D&&n(2,r=D.dropdown)},t.$$.update=()=>{if(t.$$.dirty&24&&u){n(8,h=u.querySelectorAll("li:not(.hidden)"));for(let D=0;D<u.childElementCount;D++)d[Object.keys(s)[D]]=u.children[D];y(),v()}},[i,o,r,u,s,a,f,_,h,w,C,E,A,O,T,P,Y,j,I]}class Ao extends Ne{constructor(e){super(),Te(this,e,jm,Hm,pe,{chosenBuild:0,ddOpen:1,dropdown:2})}}function ll(t){let e,n=(t[6]>t[5]*.8?t[11].slice(0,20)+"<b>...</b>":t[11])+"",s;return{c(){e=b("span"),Ee(()=>t[15].call(e))},m(i,o){F(i,e,o),e.innerHTML=n,s=Gt(e,t[15].bind(e))},p(i,o){o[0]&2144&&n!==(n=(i[6]>i[5]*.8?i[11].slice(0,20)+"<b>...</b>":i[11])+"")&&(e.innerHTML=n)},d(i){i&&L(e),s()}}}function al(t){let e;return{c(){e=b("span"),e.textContent="New changes! Exiting will erase them.",m(e,"id","alert")},m(n,s){F(n,e,s)},d(n){n&&L(e)}}}function Um(t){let e,n,s,i,o,r=t[11],l,a,c,u,f,d,_,h,g,v,w,C,y,E,A=275-t[2].length+"",O,T,P,Y,j,I,D,k,S,R,H,X,Z,ne,he,de,fe,z,Q,le,Ae,Ce=ll(t),ke=t[1]!=null&&t[1]!=t[2]&&al();function Ve(ce){t[26](ce)}function J(ce){t[27](ce)}function et(ce){t[28](ce)}let He={};return t[0]!==void 0&&(He.chosenBuild=t[0]),t[3]!==void 0&&(He.ddOpen=t[3]),t[9]!==void 0&&(He.dropdown=t[9]),ne=new Ao({props:He}),te.push(()=>De(ne,"chosenBuild",Ve)),te.push(()=>De(ne,"ddOpen",J)),te.push(()=>De(ne,"dropdown",et)),ne.$on("buildSelect",t[29]),{c(){e=b("div"),n=b("div"),s=b("span"),s.textContent="Save to:",i=N(),o=b("button"),Ce.c(),l=N(),a=b("iconify-icon"),f=N(),d=b("div"),_=b("div"),h=b("span"),h.textContent="Description / Notes:",g=N(),ke&&ke.c(),v=N(),w=b("textarea"),y=N(),E=b("span"),O=ie(A),T=N(),P=b("div"),Y=b("div"),j=b("button"),I=ie("CANCEL"),k=N(),S=b("div"),R=b("button"),H=ie("SAVE"),Z=N(),ae(ne.$$.fragment),Ze(a,"icon","iconamoon:arrow-down-2-fill"),m(o,"id","firstFocusable"),o.disabled=c=t[12].save.status==0,m(o,"class","promptDDButton svelte-106wt5q"),Ee(()=>t[17].call(o)),ee(o,"ddOpen",t[3]),m(n,"class","chosenBuildCont"),m(w,"class","buildDescInput"),w.disabled=C=t[12].save.status==0,m(w,"placeholder","[Empty]"),m(w,"maxlength","275"),m(w,"autocomplete","off"),m(E,"class","charCounter"),m(E,"id","buildDesc"),m(d,"class","buildDescCont"),j.disabled=D=t[12].save.status==0,m(R,"id","lastFocusable"),R.disabled=X=t[12].save.status==0,m(P,"class","promptOptions"),m(e,"class","buildSaver")},m(ce,q){F(ce,e,q),p(e,n),p(n,s),p(n,i),p(n,o),Ce.m(o,null),p(o,l),p(o,a),t[16](o),u=Gt(o,t[17].bind(o)),p(e,f),p(e,d),p(d,_),p(_,h),p(_,g),ke&&ke.m(_,null),p(d,v),p(d,w),t[19](w),It(w,t[10]),p(d,y),p(d,E),p(E,O),p(e,T),p(e,P),p(P,Y),p(Y,j),p(j,I),t[23](j),p(P,k),p(P,S),p(S,R),p(R,H),p(e,Z),oe(ne,e,null),Q=!0,le||(Ae=[M(window,"mousedown",t[14]),M(o,"click",t[18]),M(o,"keydown",pt),M(w,"input",t[20]),M(w,"input",t[21]),M(w,"keydown",t[22]),M(j,"click",t[24]),M(R,"click",t[25]),M(R,"keydown",mt),M(e,"introstart",t[30]),M(e,"keydown",t[31])],le=!0)},p(ce,q){q[0]&2048&&pe(r,r=ce[11])?(Ce.d(1),Ce=ll(ce),Ce.c(),Ce.m(o,l)):Ce.p(ce,q),(!Q||q[0]&4096&&c!==(c=ce[12].save.status==0))&&(o.disabled=c),(!Q||q[0]&8)&&ee(o,"ddOpen",ce[3]),ce[1]!=null&&ce[1]!=ce[2]?ke||(ke=al(),ke.c(),ke.m(_,null)):ke&&(ke.d(1),ke=null),(!Q||q[0]&4096&&C!==(C=ce[12].save.status==0))&&(w.disabled=C),q[0]&1024&&It(w,ce[10]),(!Q||q[0]&4)&&A!==(A=275-ce[2].length+"")&&Re(O,A),(!Q||q[0]&4096&&D!==(D=ce[12].save.status==0))&&(j.disabled=D),(!Q||q[0]&4096&&X!==(X=ce[12].save.status==0))&&(R.disabled=X);const Le={};!he&&q[0]&1&&(he=!0,Le.chosenBuild=ce[0],Oe(()=>he=!1)),!de&&q[0]&8&&(de=!0,Le.ddOpen=ce[3],Oe(()=>de=!1)),!fe&&q[0]&512&&(fe=!0,Le.dropdown=ce[9],Oe(()=>fe=!1)),ne.$set(Le)},i(ce){Q||(B(ne.$$.fragment,ce),ce&&Ee(()=>{Q&&(z||(z=Ie(e,Ye,{duration:250},!0)),z.run(1))}),Q=!0)},o(ce){U(ne.$$.fragment,ce),ce&&(z||(z=Ie(e,Ye,{duration:250},!1)),z.run(0)),Q=!1},d(ce){ce&&L(e),Ce.d(ce),t[16](null),u(),ke&&ke.d(),t[19](null),t[23](null),re(ne),ce&&z&&z.end(),le=!1,ge(Ae)}}}function Vm(t,e,n){let s,i,o,r,l,a,c,u;K(t,$,z=>n(12,r=z)),K(t,at,z=>n(32,l=z)),K(t,gt,z=>n(33,a=z)),K(t,Nt,z=>n(34,c=z)),K(t,kt,z=>n(35,u=z));let f=!1,d,_,h,g,v,w,C=Object.entries(a)[0],y=null;function E(){G($,r.save.status=0,r);let z=Lc(u,c),Q=y==null?i:y==""?"[Empty]":y,le=C[1].id;z.name=s,z.desc=Q,ti(Lt(Nn(Dn),`builds/${le}`),z).then(()=>{G($,r.save.status=1,r);let Ae={...a};Ae[s].desc=Q,Do(),gt.update(()=>Ae),G(at,l=z,l),G(at,l.id=le,l)}).catch(()=>{G($,r.save.status=-1,r),G($,r.message="firebase_fail",r)})}const A=z=>{!d.contains(z.target)&&!w.contains(z.target)&&n(3,f=!1)};function O(){h=this.offsetWidth,n(6,h)}function T(z){te[z?"unshift":"push"](()=>{d=z,n(4,d)})}function P(){_=this.offsetWidth,n(5,_)}const Y=()=>{r.save.status!=0&&n(3,f=!f)};function j(z){te[z?"unshift":"push"](()=>{g=z,n(7,g)})}function I(){o=this.value,n(10,o),n(1,y),n(2,i),n(0,C)}const D=z=>{n(1,y=Hs(z.target.value,275))},k=z=>{r.save.status==0&&z.preventDefault(),Hi(g,z.target.value,275)};function S(z){te[z?"unshift":"push"](()=>{v=z,n(8,v)})}const R=()=>{r.save.status!=0&&G($,r.save.ongoing=!1,r)},H=()=>{r.save.status!=0&&E()};function X(z){C=z,n(0,C)}function Z(z){f=z,n(3,f)}function ne(z){w=z,n(9,w)}const he=()=>n(1,y=null),de=()=>v.focus(),fe=z=>{z.key=="Escape"&&(n(3,f=!1),d.focus())};return t.$$.update=()=>{t.$$.dirty[0]&1&&n(11,s=C[0]),t.$$.dirty[0]&1&&n(2,i=C[1].desc),t.$$.dirty[0]&6&&n(10,o=y??i)},[C,y,i,f,d,_,h,g,v,w,o,s,r,E,A,O,T,P,Y,j,I,D,k,S,R,H,X,Z,ne,he,de,fe]}class Gm extends Ne{constructor(e){super(),Te(this,e,Vm,Um,pe,{},null,[-1,-1])}}function Ym(t){let e,n,s,i,o,r,l,a,c;return{c(){e=b("div"),n=b("span"),n.textContent="ID:",s=N(),i=b("input"),m(i,"class","buildIDInput svelte-w8elgk"),i.disabled=o=t[11].load.status==0,m(i,"type","text"),m(i,"placeholder","Example ID: -NDqeA1Scn0EAJcYWN3b"),m(i,"maxlength","25"),m(e,"class","buildIDCont svelte-w8elgk")},m(u,f){F(u,e,f),p(e,n),p(e,s),p(e,i),t[23](i),It(i,t[10]),l=!0,a||(c=[M(i,"input",t[24]),M(i,"input",t[25]),M(i,"keydown",t[26])],a=!0)},p(u,f){(!l||f[0]&2048&&o!==(o=u[11].load.status==0))&&(i.disabled=o),f[0]&1024&&i.value!==u[10]&&It(i,u[10])},i(u){l||(u&&Ee(()=>{l&&(r||(r=Ie(e,st,{duration:150},!0)),r.run(1))}),l=!0)},o(u){u&&(r||(r=Ie(e,st,{duration:150},!1)),r.run(0)),l=!1},d(u){u&&L(e),t[23](null),u&&r&&r.end(),a=!1,ge(c)}}}function Km(t){let e,n,s,i,o=t[9],r,l,a,c,u,f,d,_,h=cl(t);return{c(){e=b("div"),n=b("span"),n.textContent="Load:",s=N(),i=b("button"),h.c(),r=N(),l=b("iconify-icon"),Ze(l,"icon","iconamoon:arrow-down-2-fill"),i.disabled=a=t[11].load.status==0,m(i,"class","promptDDButton svelte-w8elgk"),Ee(()=>t[21].call(i)),ee(i,"ddOpen",t[8]),m(e,"class","chosenBuildCont svelte-w8elgk")},m(g,v){F(g,e,v),p(e,n),p(e,s),p(e,i),h.m(i,null),p(i,r),p(i,l),t[20](i),c=Gt(i,t[21].bind(i)),f=!0,d||(_=M(i,"click",t[22]),d=!0)},p(g,v){v[0]&512&&pe(o,o=g[9])?(h.d(1),h=cl(g),h.c(),h.m(i,r)):h.p(g,v),(!f||v[0]&2048&&a!==(a=g[11].load.status==0))&&(i.disabled=a),(!f||v[0]&256)&&ee(i,"ddOpen",g[8])},i(g){f||(g&&Ee(()=>{f&&(u||(u=Ie(e,st,{duration:150},!0)),u.run(1))}),f=!0)},o(g){g&&(u||(u=Ie(e,st,{duration:150},!1)),u.run(0)),f=!1},d(g){g&&L(e),h.d(g),t[20](null),c(),g&&u&&u.end(),d=!1,_()}}}function cl(t){let e,n=(t[6]>t[5]*.7?t[9].slice(0,20)+"<b>...</b>":t[9])+"",s;return{c(){e=b("span"),Ee(()=>t[19].call(e))},m(i,o){F(i,e,o),e.innerHTML=n,s=Gt(e,t[19].bind(e))},p(i,o){o[0]&608&&n!==(n=(i[6]>i[5]*.7?i[9].slice(0,20)+"<b>...</b>":i[9])+"")&&(e.innerHTML=n)},d(i){i&&L(e),s()}}}function ul(t){let e,n,s,i,o;function r(u){t[29](u)}function l(u){t[30](u)}function a(u){t[31](u)}let c={};return t[3]!==void 0&&(c.chosenBuild=t[3]),t[8]!==void 0&&(c.ddOpen=t[8]),t[7]!==void 0&&(c.dropdown=t[7]),e=new Ao({props:c}),te.push(()=>De(e,"chosenBuild",r)),te.push(()=>De(e,"ddOpen",l)),te.push(()=>De(e,"dropdown",a)),{c(){ae(e.$$.fragment)},m(u,f){oe(e,u,f),o=!0},p(u,f){const d={};!n&&f[0]&8&&(n=!0,d.chosenBuild=u[3],Oe(()=>n=!1)),!s&&f[0]&256&&(s=!0,d.ddOpen=u[8],Oe(()=>s=!1)),!i&&f[0]&128&&(i=!0,d.dropdown=u[7],Oe(()=>i=!1)),e.$set(d)},i(u){o||(B(e.$$.fragment,u),o=!0)},o(u){U(e.$$.fragment,u),o=!1},d(u){re(e,u)}}}function Qm(t){let e,n,s,i,o,r,l,a,c,u,f,d,_,h,g,v,w,C,y,E,A,O,T,P,Y,j,I,D,k,S,R,H,X,Z,ne;const he=[Km,Ym],de=[];function fe(Q,le){return Q[2]?0:1}C=fe(t),y=de[C]=he[C](t);let z=t[2]&&ul(t);return{c(){e=b("div"),n=b("span"),n.textContent="Load build via:",s=N(),i=b("div"),o=b("div"),r=b("button"),l=ie("Local saves"),u=N(),f=b("div"),d=b("button"),_=ie("Exported ID"),v=N(),w=b("div"),y.c(),E=N(),A=b("div"),O=b("div"),T=b("button"),P=ie("CANCEL"),j=N(),I=b("div"),D=b("button"),k=ie("LOAD"),R=N(),z&&z.c(),m(n,"class","svelte-w8elgk"),m(r,"id",a=t[2]?"firstFocusable":""),r.disabled=c=t[11].load.status==0||!t[12],m(r,"class","svelte-w8elgk"),ee(r,"chosen",t[2]),ee(r,"unavailable",!t[12]),m(o,"class","svelte-w8elgk"),m(d,"id",h=t[2]?"":"firstFocusable"),d.disabled=g=t[11].load.status==0,m(d,"class","svelte-w8elgk"),ee(d,"chosen",!t[2]),m(f,"class","svelte-w8elgk"),m(i,"class","loadMethodRadio svelte-w8elgk"),m(w,"class","loadMethodCont svelte-w8elgk"),T.disabled=Y=t[11].load.status==0,m(D,"id","lastFocusable"),D.disabled=S=t[11].load.status==0,m(A,"class","promptOptions svelte-w8elgk"),m(e,"class","buildLoader svelte-w8elgk")},m(Q,le){F(Q,e,le),p(e,n),p(e,s),p(e,i),p(i,o),p(o,r),p(r,l),p(i,u),p(i,f),p(f,d),p(d,_),p(e,v),p(e,w),de[C].m(w,null),p(e,E),p(e,A),p(A,O),p(O,T),p(T,P),t[27](T),p(A,j),p(A,I),p(I,D),p(D,k),p(e,R),z&&z.m(e,null),X=!0,Z||(ne=[M(window,"mousedown",t[14]),M(r,"click",t[15]),M(r,"keydown",t[16]),M(d,"click",t[17]),M(d,"keydown",t[18]),M(T,"click",t[28]),M(D,"keydown",mt),M(D,"click",t[13]),M(e,"introstart",t[32]),M(e,"keydown",t[33])],Z=!0)},p(Q,le){(!X||le[0]&4&&a!==(a=Q[2]?"firstFocusable":""))&&m(r,"id",a),(!X||le[0]&6144&&c!==(c=Q[11].load.status==0||!Q[12]))&&(r.disabled=c),(!X||le[0]&4)&&ee(r,"chosen",Q[2]),(!X||le[0]&4096)&&ee(r,"unavailable",!Q[12]),(!X||le[0]&4&&h!==(h=Q[2]?"":"firstFocusable"))&&m(d,"id",h),(!X||le[0]&2048&&g!==(g=Q[11].load.status==0))&&(d.disabled=g),(!X||le[0]&4)&&ee(d,"chosen",!Q[2]);let Ae=C;C=fe(Q),C===Ae?de[C].p(Q,le):(We(),U(de[Ae],1,1,()=>{de[Ae]=null}),qe(),y=de[C],y?y.p(Q,le):(y=de[C]=he[C](Q),y.c()),B(y,1),y.m(w,null)),(!X||le[0]&2048&&Y!==(Y=Q[11].load.status==0))&&(T.disabled=Y),(!X||le[0]&2048&&S!==(S=Q[11].load.status==0))&&(D.disabled=S),Q[2]?z?(z.p(Q,le),le[0]&4&&B(z,1)):(z=ul(Q),z.c(),B(z,1),z.m(e,null)):z&&(We(),U(z,1,1,()=>{z=null}),qe())},i(Q){X||(B(y),B(z),Q&&Ee(()=>{X&&(H||(H=Ie(e,Ye,{duration:250},!0)),H.run(1))}),X=!0)},o(Q){U(y),U(z),Q&&(H||(H=Ie(e,Ye,{duration:250},!1)),H.run(0)),X=!1},d(Q){Q&&L(e),de[C].d(),t[27](null),z&&z.d(),Q&&H&&H.end(),Z=!1,ge(ne)}}}function xm(t,e,n){let s,i,o;K(t,$,z=>n(11,s=z)),K(t,gt,z=>n(34,i=z)),K(t,zt,z=>n(12,o=z));const r=Dt();let l,a,c,u,f,d,_=o,h=!1,g=o?Object.entries(i)[0]:null,v,w="";function C(){if(!_&&!w.startsWith("-N")){G($,s.load.status=-1,s),G($,s.message="invalid_id",s);return}let z=Tc(Nn(Dn,"builds"),Ic()),Q=0;G($,s.load.status=0,s),Sc(z).then(le=>{let Ae=_?g[1].id:w;for(let Ce in le.val()){if(Ce==Ae){r("buildLoad",{build:le.val()[Ce],id:Ce});break}else Q==Object.keys(le.val()).length-1&&(G($,s.load.status=-1,s),G($,s.message=_?"not_found":"invalid_id",s));Q++}}).catch(()=>{G($,s.load.status=-1,s),G($,s.message="firebase_fail",s)})}const y=z=>{l&&!l.contains(z.target)&&!d.contains(z.target)&&n(8,h=!1)},E=()=>{s.load.status!=0&&o&&n(2,_=!0)},A=z=>{_&&pt(z)},O=()=>{s.load.status!=0&&n(2,_=!1)},T=z=>{_||pt(z)};function P(){f=this.offsetWidth,n(6,f)}function Y(z){te[z?"unshift":"push"](()=>{l=z,n(0,l)})}function j(){u=this.offsetWidth,n(5,u)}const I=()=>{s.load.status!=0&&n(8,h=!h)};function D(z){te[z?"unshift":"push"](()=>{c=z,n(1,c)})}function k(){w=this.value,n(10,w)}const S=z=>{n(10,w=Hs(z.target.value,25))},R=z=>{s.load.status==0&&z.preventDefault()};function H(z){te[z?"unshift":"push"](()=>{a=z,n(4,a)})}const X=()=>{s.load.status!=0&&G($,s.load.ongoing=!1,s)};function Z(z){g=z,n(3,g)}function ne(z){h=z,n(8,h)}function he(z){d=z,n(7,d)}const de=()=>a.focus(),fe=z=>{z.key=="Escape"&&(n(8,h=!1),l.focus())};return t.$$.update=()=>{t.$$.dirty[0]&8&&n(9,v=g!=null?g[0]:null),t.$$.dirty[0]&7&&setTimeout(_?()=>l.focus():()=>c.focus())},[l,c,_,g,a,u,f,d,h,v,w,s,o,C,y,E,A,O,T,P,Y,j,I,D,k,S,R,H,X,Z,ne,he,de,fe]}class Xm extends Ne{constructor(e){super(),Te(this,e,xm,Qm,pe,{},null,[-1,-1])}}function dl(t){let e,n=(t[3]>t[4]*.8?t[8].slice(0,20)+"<b>...</b>":t[8])+"",s;return{c(){e=b("span"),Ee(()=>t[12].call(e))},m(i,o){F(i,e,o),e.innerHTML=n,s=Gt(e,t[12].bind(e))},p(i,o){o&280&&n!==(n=(i[3]>i[4]*.8?i[8].slice(0,20)+"<b>...</b>":i[8])+"")&&(e.innerHTML=n)},d(i){i&&L(e),s()}}}function Jm(t){let e,n,s,i,o,r=t[8],l,a,c,u,f,d,_,h,g,v,w,C,y,E,A,O,T,P,Y,j,I,D,k,S,R,H,X,Z,ne=dl(t);d=new rt({props:{text:"I'm aware that this action is irreversible and want to erase this build from the database."}}),d.$on("toggle",t[16]);function he(Q){t[21](Q)}function de(Q){t[22](Q)}function fe(Q){t[23](Q)}let z={};return t[0]!==void 0&&(z.chosenBuild=t[0]),t[6]!==void 0&&(z.ddOpen=t[6]),t[5]!==void 0&&(z.dropdown=t[5]),I=new Ao({props:z}),te.push(()=>De(I,"chosenBuild",he)),te.push(()=>De(I,"ddOpen",de)),te.push(()=>De(I,"dropdown",fe)),{c(){e=b("div"),n=b("div"),s=b("span"),s.textContent="Delete:",i=N(),o=b("button"),ne.c(),l=N(),a=b("iconify-icon"),f=N(),ae(d.$$.fragment),_=N(),h=b("div"),g=b("div"),v=b("button"),w=ie("CANCEL"),E=N(),A=b("div"),O=b("button"),T=ie("DELETE"),j=N(),ae(I.$$.fragment),Ze(a,"icon","iconamoon:arrow-down-2-fill"),m(o,"class","promptDDButton svelte-1t9ajmz"),m(o,"id","firstFocusable"),o.disabled=c=t[9].delete.status==0,Ee(()=>t[14].call(o)),ee(o,"ddOpen",t[6]),m(n,"class","chosenBuildCont"),m(v,"id",C=t[7]?"":"lastFocusable"),v.disabled=y=t[9].delete.status==0,O.disabled=P=!t[7]||t[9].delete.status==0,m(O,"id",Y=t[7]?"lastFocusable":""),ee(O,"unavailable",!t[7]),m(h,"class","promptOptions svelte-1t9ajmz"),m(e,"class","buildDeleter svelte-1t9ajmz")},m(Q,le){F(Q,e,le),p(e,n),p(n,s),p(n,i),p(n,o),ne.m(o,null),p(o,l),p(o,a),t[13](o),u=Gt(o,t[14].bind(o)),p(e,f),oe(d,e,null),p(e,_),p(e,h),p(h,g),p(g,v),p(v,w),t[17](v),p(h,E),p(h,A),p(A,O),p(O,T),p(e,j),oe(I,e,null),H=!0,X||(Z=[M(window,"mousedown",t[11]),M(o,"click",t[15]),M(o,"keydown",pt),M(v,"click",t[18]),M(v,"keydown",t[19]),M(O,"click",t[20]),M(O,"keydown",mt),M(e,"introstart",t[24]),M(e,"keydown",t[25])],X=!0)},p(Q,[le]){le&256&&pe(r,r=Q[8])?(ne.d(1),ne=dl(Q),ne.c(),ne.m(o,l)):ne.p(Q,le),(!H||le&512&&c!==(c=Q[9].delete.status==0))&&(o.disabled=c),(!H||le&64)&&ee(o,"ddOpen",Q[6]),(!H||le&128&&C!==(C=Q[7]?"":"lastFocusable"))&&m(v,"id",C),(!H||le&512&&y!==(y=Q[9].delete.status==0))&&(v.disabled=y),(!H||le&640&&P!==(P=!Q[7]||Q[9].delete.status==0))&&(O.disabled=P),(!H||le&128&&Y!==(Y=Q[7]?"lastFocusable":""))&&m(O,"id",Y),(!H||le&128)&&ee(O,"unavailable",!Q[7]);const Ae={};!D&&le&1&&(D=!0,Ae.chosenBuild=Q[0],Oe(()=>D=!1)),!k&&le&64&&(k=!0,Ae.ddOpen=Q[6],Oe(()=>k=!1)),!S&&le&32&&(S=!0,Ae.dropdown=Q[5],Oe(()=>S=!1)),I.$set(Ae)},i(Q){H||(B(d.$$.fragment,Q),B(I.$$.fragment,Q),Q&&Ee(()=>{H&&(R||(R=Ie(e,Ye,{duration:250},!0)),R.run(1))}),H=!0)},o(Q){U(d.$$.fragment,Q),U(I.$$.fragment,Q),Q&&(R||(R=Ie(e,Ye,{duration:250},!1)),R.run(0)),H=!1},d(Q){Q&&L(e),ne.d(Q),t[13](null),u(),re(d),t[17](null),re(I),Q&&R&&R.end(),X=!1,ge(Z)}}}function Zm(t,e,n){let s,i,o,r;K(t,$,R=>n(9,i=R)),K(t,gt,R=>n(26,o=R)),K(t,at,R=>n(27,r=R));let l,a,c,u,f,d=!1,_=Object.entries(o)[0],h=!1;function g(){G($,i.delete.status=0,i);let R=_[1].id;H_(Lt(Nn(Dn),`builds/${R}`)).then(()=>{G($,i.delete.status=1,i),r&&R==r.id&&G(at,r=null,r);let H={...o};delete H[s],Do(),gt.update(()=>H)}).catch(H=>{console.log(H),G($,i.delete.status=-1,i),G($,i.message="firebase_fail",i)})}const v=R=>{!a.contains(R.target)&&!f.contains(R.target)&&n(6,d=!1)};function w(){c=this.offsetWidth,n(3,c)}function C(R){te[R?"unshift":"push"](()=>{a=R,n(2,a)})}function y(){u=this.offsetWidth,n(4,u)}const E=()=>{i.delete.status!=0&&n(6,d=!d)},A=R=>n(7,h=R.detail);function O(R){te[R?"unshift":"push"](()=>{l=R,n(1,l)})}const T=()=>{i.delete.status!=0&&G($,i.delete.ongoing=!1,i)},P=R=>{h||mt(R)},Y=()=>{h&&i.delete.status!=0&&g()};function j(R){_=R,n(0,_)}function I(R){d=R,n(6,d)}function D(R){f=R,n(5,f)}const k=()=>l.focus(),S=R=>{R.key=="Escape"&&(n(6,d=!1),a.focus())};return t.$$.update=()=>{t.$$.dirty&1&&n(8,s=_[0])},[_,l,a,c,u,f,d,h,s,i,g,v,w,C,y,E,A,O,T,P,Y,j,I,D,k,S]}class $m extends Ne{constructor(e){super(),Te(this,e,Zm,Jm,pe,{})}}function eg(t){let e,n,s,i,o,r,l,a,c,u,f,d,_,h;return{c(){e=b("div"),n=b("div"),s=b("button"),s.innerHTML='<iconify-icon icon="tabler:coins" class="svelte-1a77gzl"></iconify-icon> <span class="tooltip" id="right">Build costs</span>',i=N(),o=b("div"),r=b("button"),r.innerHTML='<iconify-icon icon="codicon:sparkle-filled" class="svelte-1a77gzl"></iconify-icon> <span class="tooltip" id="right">Add bonuses</span>',l=N(),a=b("div"),c=b("button"),c.innerHTML='<iconify-icon icon="fa-solid:random" class="svelte-1a77gzl"></iconify-icon> <span class="tooltip" id="right">Randomize build</span>',u=N(),f=b("div"),d=b("button"),d.innerHTML='<iconify-icon icon="fe:picture" class="svelte-1a77gzl"></iconify-icon> <span class="tooltip" id="right">Screenshot mode</span>',m(s,"class","svelte-1a77gzl"),m(n,"class","svelte-1a77gzl"),m(r,"class","svelte-1a77gzl"),m(o,"class","svelte-1a77gzl"),m(c,"class","svelte-1a77gzl"),m(a,"id","randomize"),m(a,"class","svelte-1a77gzl"),m(d,"class","svelte-1a77gzl"),m(f,"id","screenshot"),m(f,"class","svelte-1a77gzl"),m(e,"class","sideFeatures svelte-1a77gzl")},m(g,v){F(g,e,v),p(e,n),p(n,s),p(e,i),p(e,o),p(o,r),p(e,l),p(e,a),p(a,c),p(e,u),p(e,f),p(f,d),_||(h=[M(s,"click",t[2]),M(r,"click",t[3]),M(c,"click",t[4]),M(d,"click",t[5])],_=!0)},p:se,i:se,o:se,d(g){g&&L(e),_=!1,ge(h)}}}function tg(t,e,n){let s,i;return K(t,Cn,c=>n(0,s=c)),K(t,$,c=>n(1,i=c)),[s,i,c=>{wn(c),s||G($,i.costs.ongoing=!0,i)},c=>{wn(c),s||G($,i.bonus.ongoing=!0,i)},c=>{wn(c),s||G($,i.randomize.ongoing=!0,i)},()=>{s||(G($,i.screenshot.ongoing=!0,i),setTimeout(()=>G($,i.screenshot.ongoing=!1,i),3500))}]}class ng extends Ne{constructor(e){super(),Te(this,e,tg,eg,pe,{})}}function fl(t,e,n){const s=t.slice();s[11]=e[n];const i=s[1].bonuses[0].name==s[11].name;return s[12]=i,s}function hl(t){let e,n,s,i,o,r,l,a,c,u,f,d;function _(...g){return t[5](t[12],...g)}function h(...g){return t[6](t[11],...g)}return a=new rt({props:{text:t[11].name,checked:t[2][t[11].name]}}),a.$on("toggle",h),{c(){e=b("div"),n=b("a"),s=b("img"),l=N(),ae(a.$$.fragment),c=N(),nt(s.src,i=t[11].image)||m(s,"src",i),m(s,"alt",""),m(s,"class","svelte-1xnyxhr"),m(n,"id",o=t[12]?"firstFocusable":""),m(n,"href",r=t[11].link),m(n,"target","_blank"),m(n,"class","svelte-1xnyxhr"),m(e,"class","svelte-1xnyxhr")},m(g,v){F(g,e,v),p(e,n),p(n,s),p(e,l),oe(a,e,null),p(e,c),u=!0,f||(d=M(n,"keydown",_),f=!0)},p(g,v){t=g,(!u||v&2&&!nt(s.src,i=t[11].image))&&m(s,"src",i),(!u||v&2&&o!==(o=t[12]?"firstFocusable":""))&&m(n,"id",o),(!u||v&2&&r!==(r=t[11].link))&&m(n,"href",r);const w={};v&2&&(w.text=t[11].name),v&6&&(w.checked=t[2][t[11].name]),a.$set(w)},i(g){u||(B(a.$$.fragment,g),u=!0)},o(g){U(a.$$.fragment,g),u=!1},d(g){g&&L(e),re(a),f=!1,d()}}}function sg(t){let e,n,s,i,o,r,l,a,c,u,f,d,_,h=Pe(t[1].bonuses),g=[];for(let w=0;w<h.length;w+=1)g[w]=hl(fl(t,h,w));const v=w=>U(g[w],1,1,()=>{g[w]=null});return{c(){e=b("div"),n=b("div");for(let w=0;w<g.length;w+=1)g[w].c();s=N(),i=b("div"),o=b("div"),r=b("button"),r.textContent="CLEAR",l=N(),a=b("div"),c=b("button"),c.textContent="OK",m(n,"class","bonusesCont svelte-1xnyxhr"),m(c,"id","lastFocusable"),m(i,"class","promptOptions svelte-1xnyxhr"),m(e,"class","bonusChooser svelte-1xnyxhr")},m(w,C){F(w,e,C),p(e,n);for(let y=0;y<g.length;y+=1)g[y]&&g[y].m(n,null);p(e,s),p(e,i),p(i,o),p(o,r),p(i,l),p(i,a),p(a,c),t[8](c),f=!0,d||(_=[M(r,"click",t[7]),M(c,"click",t[9]),M(c,"keydown",mt),M(e,"introstart",t[10])],d=!0)},p(w,[C]){if(C&14){h=Pe(w[1].bonuses);let y;for(y=0;y<h.length;y+=1){const E=fl(w,h,y);g[y]?(g[y].p(E,C),B(g[y],1)):(g[y]=hl(E),g[y].c(),B(g[y],1),g[y].m(n,null))}for(We(),y=h.length;y<g.length;y+=1)v(y);qe()}},i(w){if(!f){for(let C=0;C<h.length;C+=1)B(g[C]);w&&Ee(()=>{f&&(u||(u=Ie(e,Ye,{duration:250},!0)),u.run(1))}),f=!0}},o(w){g=g.filter(Boolean);for(let C=0;C<g.length;C+=1)U(g[C]);w&&(u||(u=Ie(e,Ye,{duration:250},!1)),u.run(0)),f=!1},d(w){w&&L(e),dt(g,w),t[8](null),w&&u&&u.end(),d=!1,ge(_)}}}function ig(t,e,n){let s,i,o,r;K(t,Ct,h=>n(1,s=h)),K(t,gn,h=>n(2,i=h)),K(t,lt,h=>n(3,o=h)),K(t,$,h=>n(4,r=h));let l;const a=(h,g)=>{h&&pt(g)},c=(h,g)=>{G(gn,i[h.name]=g.detail,i);for(let v in o)g.detail?G(lt,o[v]+=h.stats[v],o):G(lt,o[v]-=h.stats[v],o),G(lt,o[v]=Math.round(o[v]*10)/10,o)},u=()=>{for(let h in i){if(!i[h])continue;let g=s.bonuses.find(v=>v.name==h);G(gn,i[h]=!1,i);for(let v in o)G(lt,o[v]-=g.stats[v],o),G(lt,o[v]=Math.round(o[v]*10)/10,o)}};function f(h){te[h?"unshift":"push"](()=>{l=h,n(0,l)})}return[l,s,i,o,r,a,c,u,f,()=>G($,r.bonus.ongoing=!1,r),()=>l.focus()]}class og extends Ne{constructor(e){super(),Te(this,e,ig,sg,pe,{})}}function rg(t){let e;return{c(){e=b("span"),e.textContent=`Includes equipment such as ore-based armor and their variants,\r
            ore-based weapons, and shoes with no special stats.`,m(e,"slot","tooltip"),m(e,"class","tooltip svelte-19uqsbs"),m(e,"id","right")},m(n,s){F(n,e,s)},p:se,d(n){n&&L(e)}}}function lg(t){let e,n,s,i,o,r,l,a,c,u,f,d,_,h,g,v,w,C,y,E,A,O,T,P,Y,j;return i=new rt({props:{text:"Force Mushroom Parasol",checked:t[0].parasol,first:!0}}),i.$on("toggle",t[5]),r=new rt({props:{text:"Randomize armor",checked:t[0].armor}}),r.$on("toggle",t[6]),a=new rt({props:{text:"Randomize gear",checked:t[0].gear}}),a.$on("toggle",t[7]),u=new rt({props:{text:"Allow 'basic' equipment",checked:t[0].basic,$$slots:{tooltip:[rg]},$$scope:{ctx:t}}}),u.$on("toggle",t[8]),{c(){e=b("div"),n=b("span"),n.textContent="Randomize your build",s=N(),ae(i.$$.fragment),o=N(),ae(r.$$.fragment),l=N(),ae(a.$$.fragment),c=N(),ae(u.$$.fragment),f=N(),d=b("div"),_=b("div"),h=b("button"),g=ie("CANCEL"),w=N(),C=b("div"),y=b("button"),E=ie("ROLL THE DICE"),m(n,"class","svelte-19uqsbs"),m(h,"id",v=t[2]?"":"lastFocusable"),m(y,"id",A=t[2]?"lastFocusable":""),y.disabled=O=!t[2],m(d,"class","promptOptions"),m(e,"class","buildRandomizer svelte-19uqsbs")},m(I,D){F(I,e,D),p(e,n),p(e,s),oe(i,e,null),p(e,o),oe(r,e,null),p(e,l),oe(a,e,null),p(e,c),oe(u,e,null),p(e,f),p(e,d),p(d,_),p(_,h),p(h,g),t[9](h),p(d,w),p(d,C),p(C,y),p(y,E),P=!0,Y||(j=[M(h,"click",t[10]),M(h,"keydown",t[11]),M(y,"click",t[12]),M(y,"keydown",t[13]),M(e,"introstart",t[14])],Y=!0)},p(I,[D]){const k={};D&1&&(k.checked=I[0].parasol),i.$set(k);const S={};D&1&&(S.checked=I[0].armor),r.$set(S);const R={};D&1&&(R.checked=I[0].gear),a.$set(R);const H={};D&1&&(H.checked=I[0].basic),D&16777216&&(H.$$scope={dirty:D,ctx:I}),u.$set(H),(!P||D&4&&v!==(v=I[2]?"":"lastFocusable"))&&m(h,"id",v),(!P||D&4&&A!==(A=I[2]?"lastFocusable":""))&&m(y,"id",A),(!P||D&4&&O!==(O=!I[2]))&&(y.disabled=O)},i(I){P||(B(i.$$.fragment,I),B(r.$$.fragment,I),B(a.$$.fragment,I),B(u.$$.fragment,I),I&&Ee(()=>{P&&(T||(T=Ie(e,Ye,{duration:250},!0)),T.run(1))}),P=!0)},o(I){U(i.$$.fragment,I),U(r.$$.fragment,I),U(a.$$.fragment,I),U(u.$$.fragment,I),I&&(T||(T=Ie(e,Ye,{duration:250},!1)),T.run(0)),P=!1},d(I){I&&L(e),re(i),re(r),re(a),re(u),t[9](null),I&&T&&T.end(),Y=!1,ge(j)}}}function ag(t,e,n){let s,i,o,r,l,a,c,u;K(t,zn,I=>n(0,i=I)),K(t,$,I=>n(3,o=I)),K(t,Ct,I=>n(15,r=I)),K(t,En,I=>n(16,l=I)),K(t,Nt,I=>n(17,a=I)),K(t,kn,I=>n(18,c=I)),K(t,kt,I=>n(19,u=I));let f,d=["Bronze","Iron","Cobalt","Titanium","Gold","Onyx"],_=["Hardened","Royal"],h=["Black","Brown","Green","Red","White","Dark","Golden","Grey","Phantom"];function g(){if(i.armor){for(let I of rs){let D=u[I]||oi;D.name&&c[I][D.name].querySelector("button").click()}setTimeout(()=>{for(let I of rs)(function D(){let k=Math.floor(Math.random()*r[I].length);i.basic||!i.basic&&!v(r[I][k].name)?c[I][r[I][k].name].querySelector("button").click():D()})()})}if(i.gear){for(let I of Vt){let D=a[I]||ri;D.name&&l[I][D.name].querySelector("button").click()}setTimeout(()=>{let I=!1,D=Vt.length,k=Vt.length;(function S(){setTimeout(()=>{let R=Math.floor(Math.random()*D);(function H(){let X=Math.floor(Math.random()*r.gear.length);!l[k][r.gear[X].name].querySelector("button").disabled&&!l[k][r.gear[X].name].classList.contains("switchable")&&(i.basic||!i.basic&&!v(r.gear[X].name))?(l[k][r.gear[!I&&i.parasol&&!R?0:X].name].querySelector("button").click(),!I&&!R?I=!0:I||D--):H()})(),--k&&S()},10)})()})}G($,o.randomize.ongoing=!1,o)}function v(I){let D=!1,k=I.split(" ");return D=d.includes(k[0])||_.includes(k[0])||I=="Mining Helmet"||h.includes(k[0]),D}const w=I=>G(zn,i.parasol=I.detail,i),C=I=>G(zn,i.armor=I.detail,i),y=I=>G(zn,i.gear=I.detail,i),E=I=>G(zn,i.basic=I.detail,i);function A(I){te[I?"unshift":"push"](()=>{f=I,n(1,f)})}const O=()=>G($,o.randomize.ongoing=!1,o),T=I=>{s||mt(I)},P=()=>{s&&g()},Y=I=>{s&&mt(I)},j=()=>f.focus();return t.$$.update=()=>{t.$$.dirty&1&&n(2,s=i.armor||i.gear)},[i,f,s,o,g,w,C,y,E,A,O,T,P,Y,j]}class cg extends Ne{constructor(e){super(),Te(this,e,ag,lg,pe,{})}}function _l(t,e,n){const s=t.slice();return s[5]=e[n],s}function ug(t){let e,n=Pe(t[1]),s=[];for(let i=0;i<n.length;i+=1)s[i]=pl(_l(t,n,i));return{c(){for(let i=0;i<s.length;i+=1)s[i].c();e=_t()},m(i,o){for(let r=0;r<s.length;r+=1)s[r]&&s[r].m(i,o);F(i,e,o)},p(i,o){if(o&2){n=Pe(i[1]);let r;for(r=0;r<n.length;r+=1){const l=_l(i,n,r);s[r]?s[r].p(l,o):(s[r]=pl(l),s[r].c(),s[r].m(e.parentNode,e))}for(;r<s.length;r+=1)s[r].d(1);s.length=n.length}},d(i){i&&L(e),dt(s,i)}}}function dg(t){let e,n,s;return{c(){e=b("span"),n=ie("— "),s=ie(t[1]),m(e,"id","info"),m(e,"class","svelte-1t3cage")},m(i,o){F(i,e,o),p(e,n),p(e,s)},p(i,o){o&2&&Re(s,i[1])},d(i){i&&L(e)}}}function pl(t){let e,n,s=t[5]+"",i;return{c(){e=b("span"),n=ie("— "),i=ie(s),m(e,"id","info"),m(e,"class","svelte-1t3cage")},m(o,r){F(o,e,r),p(e,n),p(e,i)},p(o,r){r&2&&s!==(s=o[5]+"")&&Re(i,s)},d(o){o&&L(e)}}}function fg(t){let e,n,s,i,o,r,l;function a(f,d){return typeof f[1]=="string"?dg:ug}let c=a(t),u=c(t);return{c(){e=b("li"),n=b("span"),s=ie("v"),i=ie(t[0]),o=N(),r=b("i"),r.textContent=`${t[3][t[2][1]-1]+" "+t[2][0]+Ac[t[2][0]%10]+", 20"+t[2][2]}`,l=N(),u.c(),m(n,"id","version"),m(n,"class","svelte-1t3cage"),m(r,"id","date"),m(r,"class","svelte-1t3cage"),m(e,"class","svelte-1t3cage")},m(f,d){F(f,e,d),p(e,n),p(n,s),p(n,i),p(e,o),p(e,r),p(e,l),u.m(e,null)},p(f,[d]){d&1&&Re(i,f[0]),c===(c=a(f))&&u?u.p(f,d):(u.d(1),u=c(f),u&&(u.c(),u.m(e,null)))},i:se,o:se,d(f){f&&L(e),u.d()}}}function hg(t,e,n){let{version:s,date:i,text:o}=e,r=i.split("/"),l=["January","February","March","April","May","June","July","August","Semptember","October","November","December"];return t.$$set=a=>{"version"in a&&n(0,s=a.version),"date"in a&&n(4,i=a.date),"text"in a&&n(1,o=a.text)},[s,o,r,l,i]}class Et extends Ne{constructor(e){super(),Te(this,e,hg,fg,pe,{version:0,date:4,text:1})}}function _g(t){let e,n,s,i,o,r,l,a,c,u,f,d,_,h,g,v,w,C,y,E,A,O,T,P,Y,j,I,D,k,S,R;return o=new Et({props:{version:"3.25.8",date:"11/1/24",text:"Fixed mutually exclusive gear staying disabled when deselecting the selected item"}}),l=new Et({props:{version:"3.25.7",date:"9/1/24",text:["Enabled 'unsaved changes' prompt to appear before leaving site when certain conditions are met","Fixed dropdowns blocking interactions behind them for a short period after being closed","Fixed dropdown sort incorrectly defaulting to the last sorted list in some cases"]}}),c=new Et({props:{version:"3.25.6",date:"7/1/24",text:"Fixed armor filter not working properly when 'Exclusive' filter type and 'No Stats' option were selected"}}),f=new Et({props:{version:"3.25.5",date:"6/1/24",text:["Fixed issue with switching gear slots while full weapon view was on","Tools are now selectable even if full weapon view is on"]}}),_=new Et({props:{version:"3.25.4",date:"5/1/24",text:'Fixed crash caused by using the build randomizer while "Force Mushroom Parasol" option was on'}}),g=new Et({props:{version:"3.25.3",date:"5/1/24",text:["Added feature to swap gear slots when clicking on an already selected gear item","Added visual cues to both deselecting and swapping options for dropdown items"]}}),w=new Et({props:{version:"3.25.2",date:"3/1/24",text:["Replaced 'Strict' filter type with 'Exclusive' filter type in search options of dropdowns","Added icons to resource links and credits"]}}),y=new Et({props:{version:"3.25.1",date:"2/1/24",text:`"Allow 'basic' equipment" option is no longer restricted when "Randomize gear" option isn't selected in the build randomizer`}}),A=new Et({props:{version:"3.25.0",date:"2/1/24",text:["Added 'Build Costs' feature","Removed spectacles from 'basic' equipment pool in the build randomizer"]}}),T=new Et({props:{version:"3.24.5",date:"31/12/23",text:"Initial Release"}}),{c(){e=b("div"),n=b("span"),n.textContent="Changelog",s=N(),i=b("ul"),ae(o.$$.fragment),r=N(),ae(l.$$.fragment),a=N(),ae(c.$$.fragment),u=N(),ae(f.$$.fragment),d=N(),ae(_.$$.fragment),h=N(),ae(g.$$.fragment),v=N(),ae(w.$$.fragment),C=N(),ae(y.$$.fragment),E=N(),ae(A.$$.fragment),O=N(),ae(T.$$.fragment),P=N(),Y=b("div"),j=b("div"),I=b("button"),I.textContent="OK",m(n,"id","title"),m(i,"id","contents"),m(i,"class","svelte-1k91i9r"),m(I,"id","firstFocusable lastFocusable"),m(Y,"class","promptOptions svelte-1k91i9r"),m(e,"class","infoPrompt svelte-1k91i9r")},m(H,X){F(H,e,X),p(e,n),p(e,s),p(e,i),oe(o,i,null),p(i,r),oe(l,i,null),p(i,a),oe(c,i,null),p(i,u),oe(f,i,null),p(i,d),oe(_,i,null),p(i,h),oe(g,i,null),p(i,v),oe(w,i,null),p(i,C),oe(y,i,null),p(i,E),oe(A,i,null),p(i,O),oe(T,i,null),p(e,P),p(e,Y),p(Y,j),p(j,I),t[2](I),k=!0,S||(R=[M(I,"click",t[3]),M(I,"keydown",t[4]),M(e,"introstart",t[5])],S=!0)},p:se,i(H){k||(B(o.$$.fragment,H),B(l.$$.fragment,H),B(c.$$.fragment,H),B(f.$$.fragment,H),B(_.$$.fragment,H),B(g.$$.fragment,H),B(w.$$.fragment,H),B(y.$$.fragment,H),B(A.$$.fragment,H),B(T.$$.fragment,H),H&&Ee(()=>{k&&(D||(D=Ie(e,Ye,{duration:250},!0)),D.run(1))}),k=!0)},o(H){U(o.$$.fragment,H),U(l.$$.fragment,H),U(c.$$.fragment,H),U(f.$$.fragment,H),U(_.$$.fragment,H),U(g.$$.fragment,H),U(w.$$.fragment,H),U(y.$$.fragment,H),U(A.$$.fragment,H),U(T.$$.fragment,H),H&&(D||(D=Ie(e,Ye,{duration:250},!1)),D.run(0)),k=!1},d(H){H&&L(e),re(o),re(l),re(c),re(f),re(_),re(g),re(w),re(y),re(A),re(T),t[2](null),H&&D&&D.end(),S=!1,ge(R)}}}function pg(t,e,n){let s;K(t,$,c=>n(1,s=c));let i;function o(c){te[c?"unshift":"push"](()=>{i=c,n(0,i)})}return[i,s,o,()=>G($,s.changelog.ongoing=!1,s),c=>{pt(c),mt(c)},()=>i.focus()]}class mg extends Ne{constructor(e){super(),Te(this,e,pg,_g,pe,{})}}function gg(t){let e,n,s,i,o,r,l,a,c,u,f,d,_,h,g,v,w,C,y,E,A,O;return{c(){e=b("div"),n=b("span"),n.textContent="Helpful Resources",s=N(),i=b("ul"),o=b("li"),r=b("iconify-icon"),l=N(),a=b("a"),a.textContent="Fantastic Frontier Wikia",c=N(),u=b("li"),u.innerHTML='<iconify-icon icon="ic:baseline-discord" class="svelte-18cf37p"></iconify-icon> <a href="https://discord.gg/ff" target="_blank" class="svelte-18cf37p">Fantastic Frontier Discord Server</a>',f=N(),d=b("li"),d.innerHTML='<iconify-icon icon="simple-icons:googledocs" class="svelte-18cf37p"></iconify-icon> <a href="https://docs.google.com/document/d/1H9HXoExCDVfXx15LQ4Te-2tTjrLFB-XCbMmx44Ynld4/edit" target="_blank" class="svelte-18cf37p">Fantastic Frontier Build List</a>',_=N(),h=b("li"),h.innerHTML='<iconify-icon icon="simple-icons:googledocs" class="svelte-18cf37p"></iconify-icon> <a href="https://docs.google.com/document/d/15vwSRojTqZ8LI09Wq4dvGF1kSTPmH2_gECQvwlSFki8/edit" target="_blank" class="svelte-18cf37p">Fantastic Frontier Max Stat List</a>',g=N(),v=b("div"),w=b("div"),C=b("button"),C.textContent="OK",m(n,"id","title"),Ze(r,"icon","simple-icons:fandom"),Ze(r,"class","svelte-18cf37p"),m(a,"id","firstFocusable"),m(a,"href","https://fantastic-frontier-roblox.fandom.com/wiki/Fantastic_Frontier_-_Roblox_Wiki"),m(a,"target","_blank"),m(a,"class","svelte-18cf37p"),m(o,"class","svelte-18cf37p"),m(u,"class","svelte-18cf37p"),m(d,"class","svelte-18cf37p"),m(h,"class","svelte-18cf37p"),m(i,"class","svelte-18cf37p"),m(C,"id","lastFocusable"),m(v,"class","promptOptions"),m(e,"class","infoPrompt")},m(T,P){F(T,e,P),p(e,n),p(e,s),p(e,i),p(i,o),p(o,r),p(o,l),p(o,a),p(i,c),p(i,u),p(i,f),p(i,d),p(i,_),p(i,h),p(e,g),p(e,v),p(v,w),p(w,C),t[2](C),E=!0,A||(O=[M(a,"keydown",pt),M(C,"click",t[3]),M(C,"keydown",mt),M(e,"introstart",t[4])],A=!0)},p:se,i(T){E||(T&&Ee(()=>{E&&(y||(y=Ie(e,Ye,{duration:250},!0)),y.run(1))}),E=!0)},o(T){T&&(y||(y=Ie(e,Ye,{duration:250},!1)),y.run(0)),E=!1},d(T){T&&L(e),t[2](null),T&&y&&y.end(),A=!1,ge(O)}}}function bg(t,e,n){let s;K(t,$,a=>n(1,s=a));let i;function o(a){te[a?"unshift":"push"](()=>{i=a,n(0,i)})}return[i,s,o,()=>G($,s.resources.ongoing=!1,s),()=>i.focus()]}class vg extends Ne{constructor(e){super(),Te(this,e,bg,gg,pe,{})}}function ml(t,e,n){const s=t.slice();return s[9]=e[n],s}function gl(t,e,n){const s=t.slice();return s[12]=e[n],s}function bl(t){let e,n,s,i,o,r,l,a=t[1][t[9]][t[12]].toLocaleString()+" Gold",c,u;return{c(){e=b("div"),n=b("span"),n.textContent=`${t[12].charAt(0).toUpperCase()+t[12].slice(1)+":"}`,s=N(),i=b("img"),r=N(),l=b("span"),c=ie(a),u=N(),m(n,"id","costTypeName"),m(n,"class","svelte-sk567b"),nt(i.src,o="https://static.wikia.nocookie.net/fantastic-frontier-roblox/images/b/ba/GoldCoins.png")||m(i,"src",o),m(i,"alt",""),m(i,"class","svelte-sk567b"),m(e,"class","svelte-sk567b")},m(f,d){F(f,e,d),p(e,n),p(e,s),p(e,i),p(e,r),p(e,l),p(l,c),p(e,u)},p(f,d){d&2&&a!==(a=f[1][f[9]][f[12]].toLocaleString()+" Gold")&&Re(c,a)},d(f){f&&L(e)}}}function vl(t){let e,n,s,i,o,r=Pe(["min","avg","max"]),l=[];for(let a=0;a<3;a+=1)l[a]=bl(gl(t,r,a));return{c(){e=b("div"),n=b("span"),n.textContent=`${t[9].charAt(0).toUpperCase()+t[9].slice(1)+" Costs"}`,s=N(),i=b("div");for(let a=0;a<3;a+=1)l[a].c();o=N(),m(n,"id","subtitle"),m(n,"class","svelte-sk567b"),m(i,"class","costTypes svelte-sk567b"),m(e,"class","costs svelte-sk567b"),m(e,"id",t[9])},m(a,c){F(a,e,c),p(e,n),p(e,s),p(e,i);for(let u=0;u<3;u+=1)l[u]&&l[u].m(i,null);p(e,o)},p(a,c){if(c&2){r=Pe(["min","avg","max"]);let u;for(u=0;u<3;u+=1){const f=gl(a,r,u);l[u]?l[u].p(f,c):(l[u]=bl(f),l[u].c(),l[u].m(i,null))}for(;u<3;u+=1)l[u].d(1)}},d(a){a&&L(e),dt(l,a)}}}function yg(t){let e,n,s,i,o,r,l,a,c,u,f=Pe(["armor","gear","total"]),d=[];for(let _=0;_<3;_+=1)d[_]=vl(ml(t,f,_));return{c(){e=b("div"),n=b("div");for(let _=0;_<3;_+=1)d[_].c();s=N(),i=b("div"),o=b("div"),r=b("button"),r.textContent="OK",m(n,"class","costsInfo svelte-sk567b"),m(r,"id","firstFocusable lastFocusable"),m(i,"class","promptOptions svelte-sk567b"),m(e,"class","buildCosts svelte-sk567b")},m(_,h){F(_,e,h),p(e,n);for(let g=0;g<3;g+=1)d[g]&&d[g].m(n,null);p(e,s),p(e,i),p(i,o),p(o,r),t[3](r),a=!0,c||(u=[M(r,"click",t[4]),M(r,"keydown",t[5]),M(e,"introstart",t[6])],c=!0)},p(_,[h]){if(h&2){f=Pe(["armor","gear","total"]);let g;for(g=0;g<3;g+=1){const v=ml(_,f,g);d[g]?d[g].p(v,h):(d[g]=vl(v),d[g].c(),d[g].m(n,null))}for(;g<3;g+=1)d[g].d(1)}},i(_){a||(_&&Ee(()=>{a&&(l||(l=Ie(e,Ye,{duration:250},!0)),l.run(1))}),a=!0)},o(_){_&&(l||(l=Ie(e,Ye,{duration:250},!1)),l.run(0)),a=!1},d(_){_&&L(e),dt(d,_),t[3](null),_&&l&&l.end(),c=!1,ge(u)}}}function wg(t,e,n){let s,i,o;K(t,Nt,d=>n(7,s=d)),K(t,kt,d=>n(8,i=d)),K(t,$,d=>n(2,o=d));let r,l={armor:{min:0,avg:0,max:0},gear:{min:0,avg:0,max:0},total:{min:0,avg:0,max:0}};for(let d in i)i[d].cost.min!=null&&(l.armor.min+=i[d].cost.min,l.armor.max+=i[d].cost.max);l.armor.avg=Math.ceil((l.armor.min+l.armor.max)/2);for(let d in s)s[d].cost.min!=null&&(l.gear.min+=s[d].cost.min,l.gear.max+=s[d].cost.max);l.gear.avg=Math.ceil((l.gear.min+l.gear.max)/2),l.total.min=l.armor.min+l.gear.min,l.total.max=l.armor.max+l.gear.max,l.total.avg=Math.ceil((l.total.min+l.total.max)/2);function a(d){te[d?"unshift":"push"](()=>{r=d,n(0,r)})}return[r,l,o,a,()=>G($,o.costs.ongoing=!1,o),d=>{pt(d),mt(d)},()=>r.focus()]}class Cg extends Ne{constructor(e){super(),Te(this,e,wg,yg,pe,{})}}const{document:St,window:$t}=Gc;function yl(t,e,n){const s=t.slice();return s[47]=e[n],s}function wl(t,e,n){const s=t.slice();return s[47]=e[n],s}function Cl(t){let e;return{c(){e=b("style"),e.textContent=`* {\r
                pointer-events: none;\r
            }\r
        `},m(n,s){F(n,e,s)},d(n){n&&L(e)}}}function kl(t){let e;return{c(){e=b("link"),m(e,"rel","preload"),m(e,"as","image"),m(e,"href",t[47])},m(n,s){F(n,e,s)},p:se,d(n){n&&L(e)}}}function El(t){let e;return{c(){e=b("style"),e.textContent=`body > div:not(.backgrounds),\r
            main > :not(.promptCont),\r
            .backgrounds > img,\r
            .info#resources,\r
            .info#changelog {\r
                filter: blur(calc(var(--u) * 0.5));\r
                pointer-events: none;\r
            }\r
            .sideFeatures {\r
                z-index: 3;\r
            }\r
            .sideFeatures button:hover,\r
            .sideFeatures button:focus,\r
            .info:hover,\r
            .info:focus {\r
                background-color: var(--transparent);\r
            }\r
            .sideFeatures button > .tooltip,\r
            .info:not(#credits) > .tooltip {\r
                opacity: 0 !important;\r
                visibility: hidden !important;\r
            }\r
        `},m(n,s){F(n,e,s)},d(n){n&&L(e)}}}function Sl(t){let e;return{c(){e=b("style"),e.textContent=`body {\r
                overflow: hidden;\r
            }\r
        `},m(n,s){F(n,e,s)},d(n){n&&L(e)}}}function Il(t){let e;return{c(){e=b("style"),e.textContent=`body {\r
                pointer-events: none;\r
            }\r
            #resources,\r
            #changelog,\r
            .mainFeatures,\r
            .sideFeatures,\r
            .statBox > .toggleCont,\r
            .ddButton > iconify-icon {\r
                opacity: 0;\r
                visibility: hidden;\r
            }\r
            .gearBox .ddButton > iconify-icon {\r
                width: 17.5% !important;\r
            }\r
            a > .tooltip {\r
                opacity: 1;\r
                visibility: visible;\r
            }\r
            .calcBox {\r
                translate: -3%;\r
            }\r
            .currentBuild {\r
                left: 50% !important;\r
                padding: calc(var(--u) * 2) !important;\r
            }\r
            .currentBuild > button {\r
                min-width: 0 !important;\r
                width: 0;\r
                opacity: 0;\r
                visibility: hidden;\r
            }`},m(n,s){F(n,e,s)},d(n){n&&L(e)}}}function Tl(t){let e,n;return{c(){e=b("img"),m(e,"class","background svelte-10x8dlv"),nt(e.src,n=t[47])||m(e,"src",n),m(e,"alt",""),ee(e,"active",t[19].indexOf(t[47])==t[9])},m(s,i){F(s,e,i)},p(s,i){i[0]&524800&&ee(e,"active",s[19].indexOf(s[47])==s[9])},d(s){s&&L(e)}}}function Nl(t){let e,n,s=Math.floor(t[16][t[3]]*100)+"",i,o,r,l;return{c(){e=b("span"),n=ie("Zoom: "),i=ie(s),o=b("b"),o.textContent="%",m(e,"class","info svelte-10x8dlv"),m(e,"id","zoomLevel")},m(a,c){F(a,e,c),p(e,n),p(e,i),p(e,o),l=!0},p(a,c){(!l||c[0]&8)&&s!==(s=Math.floor(a[16][a[3]]*100)+"")&&Re(i,s)},i(a){l||(a&&Ee(()=>{l&&(r||(r=Ie(e,st,{duration:150},!0)),r.run(1))}),l=!0)},o(a){a&&(r||(r=Ie(e,st,{duration:150},!1)),r.run(0)),l=!1},d(a){a&&L(e),a&&r&&r.end()}}}function Ol(t){let e,n,s=t[4].name+"",i,o,r,l,a,c,u,f,d,_,h=t[4].desc+"",g,v,w,C,y;return{c(){e=b("div"),n=b("span"),i=ie(s),o=N(),r=b("button"),r.innerHTML='<iconify-icon icon="ri:share-fill"></iconify-icon> <span class="tooltip" id="right">Share build</span>',l=N(),a=b("span"),c=ie(`Description / Notes:\r
                `),u=b("br"),f=N(),d=b("br"),_=N(),g=ie(h),m(n,"id","buildName"),m(n,"class","svelte-10x8dlv"),Ge(n,"line-break",(t[4].name.match(/ g/)||[]).length),m(r,"class","svelte-10x8dlv"),m(a,"class","tooltip"),m(a,"id","bottom"),m(e,"class","currentBuild svelte-10x8dlv"),ee(e,"no-tooltip",t[10])},m(E,A){F(E,e,A),p(e,n),p(n,i),p(e,o),p(e,r),p(e,l),p(e,a),p(a,c),p(a,u),p(a,f),p(a,d),p(a,_),p(a,g),w=!0,C||(y=[M(r,"click",t[29]),M(r,"mouseenter",t[30]),M(r,"mouseleave",t[31])],C=!0)},p(E,A){(!w||A[0]&16)&&s!==(s=E[4].name+"")&&Re(i,s),A[0]&16&&Ge(n,"line-break",(E[4].name.match(/ g/)||[]).length),(!w||A[0]&16)&&h!==(h=E[4].desc+"")&&Re(g,h),(!w||A[0]&1024)&&ee(e,"no-tooltip",E[10])},i(E){w||(E&&Ee(()=>{w&&(v||(v=Ie(e,st,{duration:100},!0)),v.run(1))}),w=!0)},o(E){E&&(v||(v=Ie(e,st,{duration:100},!1)),v.run(0)),w=!1},d(E){E&&L(e),E&&v&&v.end(),C=!1,ge(y)}}}function kg(t){let e,n,s;return n=new mg({}),{c(){e=b("div"),ae(n.$$.fragment),m(e,"class","promptCont svelte-10x8dlv")},m(i,o){F(i,e,o),oe(n,e,null),s=!0},p:se,i(i){s||(B(n.$$.fragment,i),s=!0)},o(i){U(n.$$.fragment,i),s=!1},d(i){i&&L(e),re(n)}}}function Eg(t){let e,n,s;return n=new vg({}),n.$on("loadPending",t[17]),{c(){e=b("div"),ae(n.$$.fragment),m(e,"class","promptCont svelte-10x8dlv")},m(i,o){F(i,e,o),oe(n,e,null),s=!0},p:se,i(i){s||(B(n.$$.fragment,i),s=!0)},o(i){U(n.$$.fragment,i),s=!1},d(i){i&&L(e),re(n)}}}function Sg(t){let e,n,s;return n=new cg({}),{c(){e=b("div"),ae(n.$$.fragment),m(e,"class","promptCont svelte-10x8dlv")},m(i,o){F(i,e,o),oe(n,e,null),s=!0},p:se,i(i){s||(B(n.$$.fragment,i),s=!0)},o(i){U(n.$$.fragment,i),s=!1},d(i){i&&L(e),re(n)}}}function Ig(t){let e,n,s;return n=new og({}),{c(){e=b("div"),ae(n.$$.fragment),m(e,"class","promptCont svelte-10x8dlv")},m(i,o){F(i,e,o),oe(n,e,null),s=!0},p:se,i(i){s||(B(n.$$.fragment,i),s=!0)},o(i){U(n.$$.fragment,i),s=!1},d(i){i&&L(e),re(n)}}}function Tg(t){let e,n,s;return n=new Cg({}),{c(){e=b("div"),ae(n.$$.fragment),m(e,"class","promptCont svelte-10x8dlv")},m(i,o){F(i,e,o),oe(n,e,null),s=!0},p:se,i(i){s||(B(n.$$.fragment,i),s=!0)},o(i){U(n.$$.fragment,i),s=!1},d(i){i&&L(e),re(n)}}}function Ng(t){let e,n,s;return n=new $m({}),{c(){e=b("div"),ae(n.$$.fragment),m(e,"class","promptCont svelte-10x8dlv")},m(i,o){F(i,e,o),oe(n,e,null),s=!0},p:se,i(i){s||(B(n.$$.fragment,i),s=!0)},o(i){U(n.$$.fragment,i),s=!1},d(i){i&&L(e),re(n)}}}function Og(t){let e,n,s;return n=new Xm({}),n.$on("buildLoad",t[33]),{c(){e=b("div"),ae(n.$$.fragment),m(e,"class","promptCont svelte-10x8dlv")},m(i,o){F(i,e,o),oe(n,e,null),s=!0},p:se,i(i){s||(B(n.$$.fragment,i),s=!0)},o(i){U(n.$$.fragment,i),s=!1},d(i){i&&L(e),re(n)}}}function Dg(t){let e,n,s;return n=new Gm({}),{c(){e=b("div"),ae(n.$$.fragment),m(e,"class","promptCont svelte-10x8dlv")},m(i,o){F(i,e,o),oe(n,e,null),s=!0},p:se,i(i){s||(B(n.$$.fragment,i),s=!0)},o(i){U(n.$$.fragment,i),s=!1},d(i){i&&L(e),re(n)}}}function Rg(t){let e,n,s;return n=new ym({}),{c(){e=b("div"),ae(n.$$.fragment),m(e,"class","promptCont svelte-10x8dlv")},m(i,o){F(i,e,o),oe(n,e,null),s=!0},p:se,i(i){s||(B(n.$$.fragment,i),s=!0)},o(i){U(n.$$.fragment,i),s=!1},d(i){i&&L(e),re(n)}}}function Ag(t){let e,n,s,i;function o(l){t[32](l)}let r={};return t[8]!==void 0&&(r.loadID=t[8]),n=new Bm({props:r}),te.push(()=>De(n,"loadID",o)),n.$on("resetActions",t[21]),{c(){e=b("div"),ae(n.$$.fragment),m(e,"class","promptCont svelte-10x8dlv")},m(l,a){F(l,e,a),oe(n,e,null),i=!0},p(l,a){const c={};!s&&a[0]&256&&(s=!0,c.loadID=l[8],Oe(()=>s=!1)),n.$set(c)},i(l){i||(B(n.$$.fragment,l),i=!0)},o(l){U(n.$$.fragment,l),i=!1},d(l){l&&L(e),re(n)}}}function Dl(t){let e;return{c(){e=b("div"),e.innerHTML='<iconify-icon icon="eos-icons:three-dots-loading" class="svelte-10x8dlv"></iconify-icon>',m(e,"class","promptCont svelte-10x8dlv")},m(n,s){F(n,e,s)},d(n){n&&L(e)}}}function Pg(t){let e,n,s,i,o,r,l,a,c,u,f,d,_,h,g,v,w,C,y,E,A,O,T,P,Y,j,I,D,k,S,R,H,X,Z,ne,he,de,fe,z,Q;Ee(t[27]);let le=!t[6]&&Cl(),Ae=Pe(t[19]),Ce=[];for(let W=0;W<Ae.length;W+=1)Ce[W]=kl(wl(t,Ae,W));let ke=(t[12]||!t[6])&&El(),Ve=t[5].screenshot.ongoing&&t[16][t[3]]<=1&&Sl(),J=t[5].screenshot.ongoing&&Il(),et=Pe(t[19]),He=[];for(let W=0;W<et.length;W+=1)He[W]=Tl(yl(t,et,W));let ce=t[7]&&Nl(t),q=t[4]&&Ol(t);v=new cm({}),C=new ng({}),O=new Wp({}),P=new xp({}),j=new rm({}),D=new gm({});const Le=[Ag,Rg,Dg,Og,Ng,Tg,Ig,Sg,Eg,kg],me=[];function it(W,_e){return W[11]||W[5].share.ongoing?0:W[5].export.ongoing?1:W[5].save.ongoing?2:W[5].load.ongoing&&!W[8]?3:W[5].delete.ongoing?4:W[5].costs.ongoing?5:W[5].bonus.ongoing?6:W[5].randomize.ongoing?7:W[5].resources.ongoing?8:W[5].changelog.ongoing?9:-1}~(S=it(t))&&(R=me[S]=Le[S](t));let V=!t[6]&&Dl();return{c(){le&&le.c(),e=_t();for(let W=0;W<Ce.length;W+=1)Ce[W].c();n=_t(),ke&&ke.c(),s=_t(),Ve&&Ve.c(),i=_t(),J&&J.c(),o=_t(),r=N(),l=b("div");for(let W=0;W<He.length;W+=1)He[W].c();a=N(),ce&&ce.c(),c=N(),u=b("span"),u.innerHTML=`<iconify-icon icon="ic:baseline-discord" class="svelte-10x8dlv"></iconify-icon>
    xt.ss
    <span class="tooltip svelte-10x8dlv" id="right">Contact me on Discord!</span>`,f=N(),d=b("button"),d.innerHTML='<iconify-icon icon="charm:stack"></iconify-icon> <span class="tooltip" id="left">Resources</span>',_=N(),h=b("main"),q&&q.c(),g=N(),ae(v.$$.fragment),w=N(),ae(C.$$.fragment),y=N(),E=b("div"),A=b("div"),ae(O.$$.fragment),T=N(),ae(P.$$.fragment),Y=N(),ae(j.$$.fragment),I=N(),ae(D.$$.fragment),k=N(),R&&R.c(),H=N(),X=b("button"),X.innerHTML='<iconify-icon icon="octicon:log-16"></iconify-icon> <span class="tooltip" id="right">Changelog</span>',Z=N(),ne=b("span"),ne.textContent=`${Mg}`,he=N(),V&&V.c(),de=_t(),m(l,"class","backgrounds"),m(u,"class","info svelte-10x8dlv"),m(u,"id","credits"),m(d,"class","info svelte-10x8dlv"),m(d,"id","resources"),m(A,"class","eqCont svelte-10x8dlv"),m(E,"class","calcBox svelte-10x8dlv"),m(E,"id","calc"),m(h,"class","svelte-10x8dlv"),ee(h,"portrait",!t[2]),m(X,"class","info svelte-10x8dlv"),m(X,"id","changelog"),m(ne,"class","info svelte-10x8dlv"),m(ne,"id","version")},m(W,_e){le&&le.m(St.head,null),p(St.head,e);for(let je=0;je<Ce.length;je+=1)Ce[je]&&Ce[je].m(St.head,null);p(St.head,n),ke&&ke.m(St.head,null),p(St.head,s),Ve&&Ve.m(St.head,null),p(St.head,i),J&&J.m(St.head,null),p(St.head,o),F(W,r,_e),F(W,l,_e);for(let je=0;je<He.length;je+=1)He[je]&&He[je].m(l,null);F(W,a,_e),ce&&ce.m(W,_e),F(W,c,_e),F(W,u,_e),F(W,f,_e),F(W,d,_e),F(W,_,_e),F(W,h,_e),q&&q.m(h,null),p(h,g),oe(v,h,null),p(h,w),oe(C,h,null),p(h,y),p(h,E),p(E,A),oe(O,A,null),p(A,T),oe(P,A,null),p(E,Y),oe(j,E,null),p(h,I),oe(D,h,null),p(h,k),~S&&me[S].m(h,null),F(W,H,_e),F(W,X,_e),F(W,Z,_e),F(W,ne,_e),F(W,he,_e),V&&V.m(W,_e),F(W,de,_e),fe=!0,z||(Q=[M($t,"beforeunload",t[23]),M($t,"storage",t[24]),M($t,"wheel",t[25],{passive:!1}),M($t,"keydown",t[26]),M($t,"resize",t[27]),M(d,"click",t[28]),M(X,"click",t[34])],z=!0)},p(W,_e){if(W[6]?le&&(le.d(1),le=null):le||(le=Cl(),le.c(),le.m(e.parentNode,e)),_e[0]&524288){Ae=Pe(W[19]);let ve;for(ve=0;ve<Ae.length;ve+=1){const ht=wl(W,Ae,ve);Ce[ve]?Ce[ve].p(ht,_e):(Ce[ve]=kl(ht),Ce[ve].c(),Ce[ve].m(n.parentNode,n))}for(;ve<Ce.length;ve+=1)Ce[ve].d(1);Ce.length=Ae.length}if(W[12]||!W[6]?ke||(ke=El(),ke.c(),ke.m(s.parentNode,s)):ke&&(ke.d(1),ke=null),W[5].screenshot.ongoing&&W[16][W[3]]<=1?Ve||(Ve=Sl(),Ve.c(),Ve.m(i.parentNode,i)):Ve&&(Ve.d(1),Ve=null),W[5].screenshot.ongoing?J||(J=Il(),J.c(),J.m(o.parentNode,o)):J&&(J.d(1),J=null),_e[0]&524800){et=Pe(W[19]);let ve;for(ve=0;ve<et.length;ve+=1){const ht=yl(W,et,ve);He[ve]?He[ve].p(ht,_e):(He[ve]=Tl(ht),He[ve].c(),He[ve].m(l,null))}for(;ve<He.length;ve+=1)He[ve].d(1);He.length=et.length}W[7]?ce?(ce.p(W,_e),_e[0]&128&&B(ce,1)):(ce=Nl(W),ce.c(),B(ce,1),ce.m(c.parentNode,c)):ce&&(We(),U(ce,1,1,()=>{ce=null}),qe()),W[4]?q?(q.p(W,_e),_e[0]&16&&B(q,1)):(q=Ol(W),q.c(),B(q,1),q.m(h,g)):q&&(We(),U(q,1,1,()=>{q=null}),qe());let je=S;S=it(W),S===je?~S&&me[S].p(W,_e):(R&&(We(),U(me[je],1,1,()=>{me[je]=null}),qe()),~S?(R=me[S],R?R.p(W,_e):(R=me[S]=Le[S](W),R.c()),B(R,1),R.m(h,null)):R=null),(!fe||_e[0]&4)&&ee(h,"portrait",!W[2]),W[6]?V&&(V.d(1),V=null):V||(V=Dl(),V.c(),V.m(de.parentNode,de))},i(W){fe||(B(ce),B(q),B(v.$$.fragment,W),B(C.$$.fragment,W),B(O.$$.fragment,W),B(P.$$.fragment,W),B(j.$$.fragment,W),B(D.$$.fragment,W),B(R),fe=!0)},o(W){U(ce),U(q),U(v.$$.fragment,W),U(C.$$.fragment,W),U(O.$$.fragment,W),U(P.$$.fragment,W),U(j.$$.fragment,W),U(D.$$.fragment,W),U(R),fe=!1},d(W){W&&(L(r),L(l),L(a),L(c),L(u),L(f),L(d),L(_),L(h),L(H),L(X),L(Z),L(ne),L(he),L(de)),le&&le.d(W),L(e),dt(Ce,W),L(n),ke&&ke.d(W),L(s),Ve&&Ve.d(W),L(i),J&&J.d(W),L(o),dt(He,W),ce&&ce.d(W),q&&q.d(),re(v),re(C),re(O),re(P),re(j),re(D),~S&&me[S].d(),V&&V.d(W),z=!1,ge(Q)}}}let Mg="v3.25.8";function Lg(t,e,n){let s,i,o,r,l,a,c,u,f,d,_,h,g;K(t,at,q=>n(4,i=q)),K(t,$,q=>n(5,o=q)),K(t,Cn,q=>n(12,r=q)),K(t,Ki,q=>n(22,l=q)),K(t,En,q=>n(38,a=q)),K(t,Nt,q=>n(39,c=q)),K(t,kn,q=>n(40,u=q)),K(t,kt,q=>n(41,f=q)),K(t,zt,q=>n(13,d=q)),K(t,gt,q=>n(14,_=q)),K(t,Ct,q=>n(42,h=q)),K(t,Qi,q=>n(15,g=q));let v=!1,w,C,y,E=7,A=[.2,.3,.45,.6,.75,.85,.95,1,1.1,1.25,1.5,1.75,2,2.5,3,4,5],O=!1,T,P=new URLSearchParams(location.search).get("id");for(let q of rp){let Le=`https://raw.githubusercontent.com/XT8SS/fantastic-calculator/gh-pages/ff-data/${q}.json`;fetch(Le).then(async me=>{if(me.status!=200){console.error(`Failed to fetch "${q}" data!
Status: ${me.status}`);return}G(Ct,h[q]=await me.json(),h)}).catch(me=>console.error(`Failed to initiate "${q}" data fetch!
${me}`))}tu(()=>{n(6,v=!0),P&&Y(),n(2,y=C>w),_[Object.keys(_)[0]]&&G(zt,d=!0,d)});function Y(){if(G($,o.load.ongoing=!0,o),!P.startsWith("-N"))G($,o.load.status=-1,o),G($,o.message="invalid_id",o);else{G($,o.load.status=0,o);let q=Tc(Nn(Dn,"builds"),Ic()),Le=0;Sc(q).then(me=>{for(let it in me.val()){if(it==P){j(me.val()[it],it);break}else Le==Object.keys(me.val()).length-1&&(G($,o.load.status=-1,o),G($,o.message="invalid_id",o));Le++}}).catch(()=>{G($,o.load.status=-1,o),G($,o.message="firebase_fail",o)})}}function j(q,Le){for(let me in q.eq){let it=f[me]||oi;q.eq[me]&&q.eq[me]!=it.name?u[me][q.eq[me]].querySelector("button").click():!q.eq[me]&&it.name&&u[me][it.name].querySelector("button").click()}for(let me of Vt){let it=c[me]||ri;it.name&&a[me][it.name].querySelector("button").click()}setTimeout(()=>{for(let me of Vt)q.gear[me]&&a[me][q.gear[me]].querySelector("button").click();G($,o.load.ongoing=!1,o),G($,o.load.status=null,o),Le&&(G(at,i=q,i),G(at,i.id=Le,i),n(8,P=null))})}let I=[],D=[],k,S,R=9;for(let q=0;q<R;q++)I.push(`backgrounds/BG${q}.jpg`);function H(q){S=Math.floor(Math.random()*q.length)}H(I);function X(){n(9,k=S),D.push(S)}X(),function q(){setTimeout(()=>{if(H(I),!D.length)X();else if(D.length>3&&(D=D.slice(1)),!D.includes(S))X();else{let Le=[...Array(R).keys()].filter(me=>!D.includes(me));H(Le),X()}document.hasFocus&&q()},45e3)}();function Z(){T=setTimeout(()=>{n(7,O=!1)},750)}function ne(){clearTimeout(T),n(7,O=!0),Z()}function he(){G($,o.export.status=null,o),G($,o.export.ongoing=!1,o),G($,o.save.status=null,o),G($,o.save.ongoing=!1,o),G($,o.load.status=null,o),G($,o.load.ongoing=!1,o),G($,o.delete.status=null,o),G($,o.delete.ongoing=!1,o),G($,o.share.ongoing=!1,o),G($,o.message="",o)}let de=!1;const fe=q=>{(g||r)&&q.preventDefault()},z=q=>{if(q.key=="builds")if(q.url.includes("ls=true")){G(gt,_=JSON.parse(q.newValue),_),G(zt,d=Object.keys(JSON.parse(q.newValue)).length>0,d),he();let Le=Object.keys(JSON.parse(q.oldValue)).filter(me=>!Object.keys(JSON.parse(q.newValue)).includes(me))[0];Le&&i&&Le==i.name&&G(at,i=null,i)}else window.localStorage.setItem("builds",JSON.stringify(_))},Q=q=>{let Le=q.wheelDeltaY;if(q.ctrlKey){if(q.preventDefault(),A[E]==.2&&Le<0||A[E]==5&&Le>0)return;Le>0?n(3,E++,E):n(3,E--,E),ne()}},le=q=>{q.ctrlKey&&(q.key=="-"||q.key=="+"||q.code=="Equal"||q.key=="0")&&(q.preventDefault(),(q.key=="+"||q.code=="Equal")&&A[E]!=5?n(3,E++,E):q.key=="-"&&A[E]!=.2?n(3,E--,E):q.key=="0"&&A[E]!=1&&n(3,E=7),ne()),r&&cp(q)};function Ae(){n(0,w=$t.outerHeight),n(1,C=$t.outerWidth)}const Ce=q=>{wn(q),r||G($,o.resources.ongoing=!0,o)},ke=()=>{r||G($,o.share.ongoing=!0,o)},Ve=()=>n(10,de=!0),J=()=>n(10,de=!1);function et(q){P=q,n(8,P)}const He=q=>j(q.detail.build,q.detail.id),ce=q=>{wn(q),r||G($,o.changelog.ongoing=!0,o)};return t.$$.update=()=>{if(t.$$.dirty[0]&4194319&&(C||w)&&(n(2,y=C>w),document.documentElement.style.setProperty("--u",`${(y?.75:window.outerWidth/window.outerHeight/2)*A[E]}${CSS.supports("height: 1lvh")?"l":""}vh`),l))for(let q of l)Oo(q.node,q.itemName);t.$$.dirty[0]&32&&n(11,s=o.export.status||o.save.status||o.load.status||o.delete.status),t.$$.dirty[0]&32&&G(Cn,r=o.export.ongoing||o.save.ongoing||o.load.ongoing||o.delete.ongoing||o.share.ongoing||o.costs.ongoing||o.bonus.ongoing||o.randomize.ongoing||o.resources.ongoing||o.changelog.ongoing,r),t.$$.dirty[0]&16&&(document.title=(i?i.name+" - ":"")+"Fantastic Calculator")},[w,C,y,E,i,o,v,O,P,k,de,s,r,d,_,g,A,Y,j,I,ne,he,l,fe,z,Q,le,Ae,Ce,ke,Ve,J,et,He,ce]}class Fg extends Ne{constructor(e){super(),Te(this,e,Lg,Pg,pe,{},null,[-1,-1])}}new Fg({target:document.body});
