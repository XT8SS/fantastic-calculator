var iu=Object.defineProperty;var su=(n,e,t)=>e in n?iu(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var Ht=(n,e,t)=>(su(n,typeof e!="symbol"?e+"":e,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&i(r)}).observe(document,{childList:!0,subtree:!0});function t(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(s){if(s.ep)return;s.ep=!0;const o=t(s);fetch(s.href,o)}})();function le(){}const Qi=n=>n;function ou(n,e){for(const t in e)n[t]=e[t];return n}function xl(n){return n()}function Wo(){return Object.create(null)}function we(n){n.forEach(xl)}function Bn(n){return typeof n=="function"}function ve(n,e){return n!=n?e==e:n!==e||n&&typeof n=="object"||typeof n=="function"}let yi;function Xe(n,e){return n===e?!0:(yi||(yi=document.createElement("a")),yi.href=e,n===yi.href)}function ru(n){return Object.keys(n).length===0}function lu(n,...e){if(n==null){for(const i of e)i(void 0);return le}const t=n.subscribe(...e);return t.unsubscribe?()=>t.unsubscribe():t}function K(n,e,t){n.$$.on_destroy.push(lu(e,t))}function au(n,e,t,i){if(n){const s=$l(n,e,t,i);return n[0](s)}}function $l(n,e,t,i){return n[1]&&i?ou(t.ctx.slice(),n[1](i(e))):t.ctx}function cu(n,e,t,i){if(n[2]&&i){const s=n[2](i(t));if(e.dirty===void 0)return s;if(typeof s=="object"){const o=[],r=Math.max(e.dirty.length,s.length);for(let a=0;a<r;a+=1)o[a]=e.dirty[a]|s[a];return o}return e.dirty|s}return e.dirty}function uu(n,e,t,i,s,o){if(s){const r=$l(e,t,i,o);n.p(r,s)}}function du(n){if(n.ctx.length>32){const e=[],t=n.ctx.length/32;for(let i=0;i<t;i++)e[i]=-1;return e}return-1}function U(n,e,t){return n.set(t),e}function ea(n){return n&&Bn(n.destroy)?n.destroy:le}const ta=typeof window<"u";let Js=ta?()=>window.performance.now():()=>Date.now(),Zs=ta?n=>requestAnimationFrame(n):le;const Cn=new Set;function na(n){Cn.forEach(e=>{e.c(n)||(Cn.delete(e),e.f())}),Cn.size!==0&&Zs(na)}function xs(n){let e;return Cn.size===0&&Zs(na),{promise:new Promise(t=>{Cn.add(e={c:n,f:t})}),abort(){Cn.delete(e)}}}const fu=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function p(n,e){n.appendChild(e)}function ia(n){if(!n)return document;const e=n.getRootNode?n.getRootNode():n.ownerDocument;return e&&e.host?e:n.ownerDocument}function hu(n){const e=b("style");return e.textContent="/* empty */",_u(ia(n),e),e.sheet}function _u(n,e){return p(n.head||n,e),e.sheet}function M(n,e,t){n.insertBefore(e,t||null)}function A(n){n.parentNode&&n.parentNode.removeChild(n)}function ot(n,e){for(let t=0;t<n.length;t+=1)n[t]&&n[t].d(e)}function b(n){return document.createElement(n)}function pu(n){return document.createElementNS("http://www.w3.org/2000/svg",n)}function ce(n){return document.createTextNode(n)}function S(){return ce(" ")}function rt(){return ce("")}function D(n,e,t,i){return n.addEventListener(e,t,i),()=>n.removeEventListener(e,t,i)}function m(n,e,t){t==null?n.removeAttribute(e):n.getAttribute(e)!==t&&n.setAttribute(e,t)}function Ae(n,e,t){e in n?n[e]=typeof n[e]=="boolean"&&t===""?!0:t:m(n,e,t)}function sa(n){return n===""?null:+n}function mu(n){return Array.from(n.childNodes)}function Ne(n,e){e=""+e,n.data!==e&&(n.data=e)}function Dt(n,e){n.value=e??""}function Je(n,e,t,i){t==null?n.style.removeProperty(e):n.style.setProperty(e,t,i?"important":"")}let wi;function gu(){if(wi===void 0){wi=!1;try{typeof window<"u"&&window.parent&&window.parent.document}catch{wi=!0}}return wi}function Jt(n,e){getComputedStyle(n).position==="static"&&(n.style.position="relative");const i=b("iframe");i.setAttribute("style","display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;"),i.setAttribute("aria-hidden","true"),i.tabIndex=-1;const s=gu();let o;return s?(i.src="data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}<\/script>",o=D(window,"message",r=>{r.source===i.contentWindow&&e()})):(i.src="about:blank",i.onload=()=>{o=D(i.contentWindow,"resize",e),e()}),p(n,i),()=>{(s||o&&i.contentWindow)&&o(),A(i)}}function ne(n,e,t){n.classList.toggle(e,!!t)}function oa(n,e,{bubbles:t=!1,cancelable:i=!1}={}){return new CustomEvent(n,{detail:e,bubbles:t,cancelable:i})}class bu{constructor(e=!1){Ht(this,"is_svg",!1);Ht(this,"e");Ht(this,"n");Ht(this,"t");Ht(this,"a");this.is_svg=e,this.e=this.n=null}c(e){this.h(e)}m(e,t,i=null){this.e||(this.is_svg?this.e=pu(t.nodeName):this.e=b(t.nodeType===11?"TEMPLATE":t.nodeName),this.t=t.tagName!=="TEMPLATE"?t:t.content,this.c(e)),this.i(i)}h(e){this.e.innerHTML=e,this.n=Array.from(this.e.nodeName==="TEMPLATE"?this.e.content.childNodes:this.e.childNodes)}i(e){for(let t=0;t<this.n.length;t+=1)M(this.t,this.n[t],e)}p(e){this.d(),this.h(e),this.i(this.a)}d(){this.n.forEach(A)}}const Ii=new Map;let Ti=0;function vu(n){let e=5381,t=n.length;for(;t--;)e=(e<<5)-e^n.charCodeAt(t);return e>>>0}function yu(n,e){const t={stylesheet:hu(e),rules:{}};return Ii.set(n,t),t}function Ni(n,e,t,i,s,o,r,a=0){const l=16.666/i;let c=`{
`;for(let v=0;v<=1;v+=l){const w=e+(t-e)*o(v);c+=v*100+`%{${r(w,1-w)}}
`}const u=c+`100% {${r(t,1-t)}}
}`,d=`__svelte_${vu(u)}_${a}`,f=ia(n),{stylesheet:h,rules:_}=Ii.get(f)||yu(f,n);_[d]||(_[d]=!0,h.insertRule(`@keyframes ${d} ${u}`,h.cssRules.length));const g=n.style.animation||"";return n.style.animation=`${g?`${g}, `:""}${d} ${i}ms linear ${s}ms 1 both`,Ti+=1,d}function Oi(n,e){const t=(n.style.animation||"").split(", "),i=t.filter(e?o=>o.indexOf(e)<0:o=>o.indexOf("__svelte")===-1),s=t.length-i.length;s&&(n.style.animation=i.join(", "),Ti-=s,Ti||wu())}function wu(){Zs(()=>{Ti||(Ii.forEach(n=>{const{ownerNode:e}=n.stylesheet;e&&A(e)}),Ii.clear())})}let $n;function Qn(n){$n=n}function ra(){if(!$n)throw new Error("Function called outside component initialization");return $n}function ku(n){ra().$$.on_mount.push(n)}function Mt(){const n=ra();return(e,t,{cancelable:i=!1}={})=>{const s=n.$$.callbacks[e];if(s){const o=oa(e,t,{cancelable:i});return s.slice().forEach(r=>{r.call(n,o)}),!o.defaultPrevented}return!0}}const wn=[],re=[];let En=[];const Ts=[],Cu=Promise.resolve();let Ns=!1;function Eu(){Ns||(Ns=!0,Cu.then(la))}function ke(n){En.push(n)}function Pe(n){Ts.push(n)}const _s=new Set;let bn=0;function la(){if(bn!==0)return;const n=$n;do{try{for(;bn<wn.length;){const e=wn[bn];bn++,Qn(e),Su(e.$$)}}catch(e){throw wn.length=0,bn=0,e}for(Qn(null),wn.length=0,bn=0;re.length;)re.pop()();for(let e=0;e<En.length;e+=1){const t=En[e];_s.has(t)||(_s.add(t),t())}En.length=0}while(wn.length);for(;Ts.length;)Ts.pop()();Ns=!1,_s.clear(),Qn(n)}function Su(n){if(n.fragment!==null){n.update(),we(n.before_update);const e=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,e),n.after_update.forEach(ke)}}function Iu(n){const e=[],t=[];En.forEach(i=>n.indexOf(i)===-1?e.push(i):t.push(i)),t.forEach(i=>i()),En=e}let Hn;function $s(){return Hn||(Hn=Promise.resolve(),Hn.then(()=>{Hn=null})),Hn}function cn(n,e,t){n.dispatchEvent(oa(`${e?"intro":"outro"}${t}`))}const Ei=new Set;let Rt;function Be(){Rt={r:0,c:[],p:Rt}}function qe(){Rt.r||we(Rt.c),Rt=Rt.p}function P(n,e){n&&n.i&&(Ei.delete(n),n.i(e))}function W(n,e,t,i){if(n&&n.o){if(Ei.has(n))return;Ei.add(n),Rt.c.push(()=>{Ei.delete(n),i&&(t&&n.d(1),i())}),n.o(e)}else i&&i()}const eo={duration:0};function aa(n,e,t){const i={direction:"in"};let s=e(n,t,i),o=!1,r,a,l=0;function c(){r&&Oi(n,r)}function u(){const{delay:f=0,duration:h=300,easing:_=Qi,tick:g=le,css:v}=s||eo;v&&(r=Ni(n,0,1,h,f,_,v,l++)),g(0,1);const w=Js()+f,k=w+h;a&&a.abort(),o=!0,ke(()=>cn(n,!0,"start")),a=xs(y=>{if(o){if(y>=k)return g(1,0),cn(n,!0,"end"),c(),o=!1;if(y>=w){const T=_((y-w)/h);g(T,1-T)}}return o})}let d=!1;return{start(){d||(d=!0,Oi(n),Bn(s)?(s=s(i),$s().then(u)):u())},invalidate(){d=!1},end(){o&&(c(),o=!1)}}}function ca(n,e,t){const i={direction:"out"};let s=e(n,t,i),o=!0,r;const a=Rt;a.r+=1;let l;function c(){const{delay:u=0,duration:d=300,easing:f=Qi,tick:h=le,css:_}=s||eo;_&&(r=Ni(n,1,0,d,u,f,_));const g=Js()+u,v=g+d;ke(()=>cn(n,!1,"start")),"inert"in n&&(l=n.inert,n.inert=!0),xs(w=>{if(o){if(w>=v)return h(0,1),cn(n,!1,"end"),--a.r||we(a.c),!1;if(w>=g){const k=f((w-g)/d);h(1-k,k)}}return o})}return Bn(s)?$s().then(()=>{s=s(i),c()}):c(),{end(u){u&&"inert"in n&&(n.inert=l),u&&s.tick&&s.tick(1,0),o&&(r&&Oi(n,r),o=!1)}}}function be(n,e,t,i){let o=e(n,t,{direction:"both"}),r=i?0:1,a=null,l=null,c=null,u;function d(){c&&Oi(n,c)}function f(_,g){const v=_.b-r;return g*=Math.abs(v),{a:r,b:_.b,d:v,duration:g,start:_.start,end:_.start+g,group:_.group}}function h(_){const{delay:g=0,duration:v=300,easing:w=Qi,tick:k=le,css:y}=o||eo,T={start:Js()+g,b:_};_||(T.group=Rt,Rt.r+=1),"inert"in n&&(_?u!==void 0&&(n.inert=u):(u=n.inert,n.inert=!0)),a||l?l=T:(y&&(d(),c=Ni(n,r,_,v,g,w,y)),_&&k(0,1),a=f(T,v),ke(()=>cn(n,_,"start")),xs(C=>{if(l&&C>l.start&&(a=f(l,v),l=null,cn(n,a.b,"start"),y&&(d(),c=Ni(n,r,a.b,a.duration,0,w,o.css))),a){if(C>=a.end)k(r=a.b,1-r),cn(n,a.b,"end"),l||(a.b?d():--a.group.r||we(a.group.c)),a=null;else if(C>=a.start){const z=C-a.start;r=a.a+a.d*w(z/a.duration),k(r,1-r)}}return!!(a||l)}))}return{run(_){Bn(o)?$s().then(()=>{o=o({direction:_?"in":"out"}),h(_)}):h(_)},end(){d(),a=l=null}}}function Oe(n){return(n==null?void 0:n.length)!==void 0?n:Array.from(n)}function Me(n,e,t){const i=n.$$.props[e];i!==void 0&&(n.$$.bound[i]=t,t(n.$$.ctx[i]))}function ae(n){n&&n.c()}function se(n,e,t){const{fragment:i,after_update:s}=n.$$;i&&i.m(e,t),ke(()=>{const o=n.$$.on_mount.map(xl).filter(Bn);n.$$.on_destroy?n.$$.on_destroy.push(...o):we(o),n.$$.on_mount=[]}),s.forEach(ke)}function oe(n,e){const t=n.$$;t.fragment!==null&&(Iu(t.after_update),we(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function Tu(n,e){n.$$.dirty[0]===-1&&(wn.push(n),Eu(),n.$$.dirty.fill(0)),n.$$.dirty[e/31|0]|=1<<e%31}function De(n,e,t,i,s,o,r=null,a=[-1]){const l=$n;Qn(n);const c=n.$$={fragment:null,ctx:[],props:o,update:le,not_equal:s,bound:Wo(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(l?l.$$.context:[])),callbacks:Wo(),dirty:a,skip_bound:!1,root:e.target||l.$$.root};r&&r(c.root);let u=!1;if(c.ctx=t?t(n,e.props||{},(d,f,...h)=>{const _=h.length?h[0]:f;return c.ctx&&s(c.ctx[d],c.ctx[d]=_)&&(!c.skip_bound&&c.bound[d]&&c.bound[d](_),u&&Tu(n,d)),f}):[],c.update(),u=!0,we(c.before_update),c.fragment=i?i(c.ctx):!1,e.target){if(e.hydrate){const d=mu(e.target);c.fragment&&c.fragment.l(d),d.forEach(A)}else c.fragment&&c.fragment.c();e.intro&&P(n.$$.fragment),se(n,e.target,e.anchor),la()}Qn(l)}class Re{constructor(){Ht(this,"$$");Ht(this,"$$set")}$destroy(){oe(this,1),this.$destroy=le}$on(e,t){if(!Bn(t))return le;const i=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return i.push(t),()=>{const s=i.indexOf(t);s!==-1&&i.splice(s,1)}}$set(e){this.$$set&&!ru(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Nu="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Nu);const vn=[];function $e(n,e=le){let t;const i=new Set;function s(a){if(ve(n,a)&&(n=a,t)){const l=!vn.length;for(const c of i)c[1](),vn.push(c,n);if(l){for(let c=0;c<vn.length;c+=2)vn[c][0](vn[c+1]);vn.length=0}}}function o(a){s(a(n))}function r(a,l=le){const c=[a,l];return i.add(c),i.size===1&&(t=e(s,o)||le),a(n),()=>{i.delete(c),i.size===0&&t&&(t(),t=null)}}return{set:s,update:o,subscribe:r}}let Ho=localStorage.getItem("builds"),Uo=0,Go=localStorage.getItem("changelogSeen"),Tt=$e({}),Nt=$e({}),ct=$e({armor:0,magicDmg:0,meleeDmg:0,rangedDmg:0,hpRegen:0,endurance:0,sightRange:0,walkSpeed:0,jumpPower:0,ammoReturn:0,height:0}),At=$e({}),to=$e([]),ps=$e({}),_t=$e(),no=$e(!1),wt=$e(Ho?JSON.parse(Ho):{}),Ut=$e(!1),Si=$e(Go?JSON.parse(Go):!1),dn=$e(!1),On=$e({}),Dn=$e({}),Ou=$e({}),vt=$e({armor:{min:0,avg:0,max:0},gear:{min:0,avg:0,max:0},total:{min:0,avg:0,max:0}}),Sn=$e({}),Un=$e({parasol:!0,armor:!0,gear:!0,basic:!0}),J=$e({item:{ongoing:!1,data:null},export:{ongoing:!1,status:null},save:{ongoing:!1,status:null},load:{ongoing:!1,status:null},delete:{ongoing:!1,status:null},share:{ongoing:!1},costs:{ongoing:!1},bonus:{ongoing:!1},screenshot:{ongoing:!1},randomize:{ongoing:!1},resources:{ongoing:!1},changelog:{ongoing:!1},policy:{ongoing:!1},message:""});wt.subscribe(n=>{Uo++,setTimeout(()=>{window.localStorage.setItem("builds",JSON.stringify(n)),Uo>1&&window.history.replaceState(null,null,location.origin+location.pathname)})});Si.subscribe(n=>window.localStorage.setItem("changelogSeen",n));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ua={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ee=function(n,e){if(!n)throw qn(e)},qn=function(n){return new Error("Firebase Database ("+ua.SDK_VERSION+") INTERNAL ASSERT FAILED: "+n)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const da=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let s=n.charCodeAt(i);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},Du=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const s=n[t++];if(s<128)e[i++]=String.fromCharCode(s);else if(s>191&&s<224){const o=n[t++];e[i++]=String.fromCharCode((s&31)<<6|o&63)}else if(s>239&&s<365){const o=n[t++],r=n[t++],a=n[t++],l=((s&7)<<18|(o&63)<<12|(r&63)<<6|a&63)-65536;e[i++]=String.fromCharCode(55296+(l>>10)),e[i++]=String.fromCharCode(56320+(l&1023))}else{const o=n[t++],r=n[t++];e[i++]=String.fromCharCode((s&15)<<12|(o&63)<<6|r&63)}}return e.join("")},io={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let s=0;s<n.length;s+=3){const o=n[s],r=s+1<n.length,a=r?n[s+1]:0,l=s+2<n.length,c=l?n[s+2]:0,u=o>>2,d=(o&3)<<4|a>>4;let f=(a&15)<<2|c>>6,h=c&63;l||(h=64,r||(f=64)),i.push(t[u],t[d],t[f],t[h])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(da(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):Du(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let s=0;s<n.length;){const o=t[n.charAt(s++)],a=s<n.length?t[n.charAt(s)]:0;++s;const c=s<n.length?t[n.charAt(s)]:64;++s;const d=s<n.length?t[n.charAt(s)]:64;if(++s,o==null||a==null||c==null||d==null)throw new Ru;const f=o<<2|a>>4;if(i.push(f),c!==64){const h=a<<4&240|c>>2;if(i.push(h),d!==64){const _=c<<6&192|d;i.push(_)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class Ru extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const fa=function(n){const e=da(n);return io.encodeByteArray(e,!0)},Di=function(n){return fa(n).replace(/\./g,"")},Os=function(n){try{return io.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Au(n){return ha(void 0,n)}function ha(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!Pu(t)||(n[t]=ha(n[t],e[t]));return n}function Pu(n){return n!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mu(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lu=()=>Mu().__FIREBASE_DEFAULTS__,Fu=()=>{if(typeof process>"u"||typeof process.env>"u")return;const n={}.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},Bu=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Os(n[1]);return e&&JSON.parse(e)},_a=()=>{try{return Lu()||Fu()||Bu()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},qu=n=>{var e,t;return(t=(e=_a())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},ju=n=>{const e=qu(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},pa=()=>{var n;return(n=_a())===null||n===void 0?void 0:n.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xi{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zu(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",s=n.iat||0,o=n.sub||n.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const r=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:s,exp:s+3600,auth_time:s,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},n),a="";return[Di(JSON.stringify(t)),Di(JSON.stringify(r)),a].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wu(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function ma(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Wu())}function Hu(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function ga(){return ua.NODE_ADMIN===!0}function Uu(){try{return typeof indexedDB=="object"}catch{return!1}}function Gu(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(i);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{var o;e(((o=s.error)===null||o===void 0?void 0:o.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vu="FirebaseError";class fi extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=Vu,Object.setPrototypeOf(this,fi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ba.prototype.create)}}class ba{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},s=`${this.service}/${e}`,o=this.errors[e],r=o?Ku(o,i):"Error",a=`${this.serviceName}: ${r} (${s}).`;return new fi(s,a,i)}}function Ku(n,e){return n.replace(Yu,(t,i)=>{const s=e[i];return s!=null?String(s):`<${i}?>`})}const Yu=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ei(n){return JSON.parse(n)}function Ze(n){return JSON.stringify(n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const va=function(n){let e={},t={},i={},s="";try{const o=n.split(".");e=ei(Os(o[0])||""),t=ei(Os(o[1])||""),s=o[2],i=t.d||{},delete t.d}catch{}return{header:e,claims:t,data:i,signature:s}},Qu=function(n){const e=va(n),t=e.claims;return!!t&&typeof t=="object"&&t.hasOwnProperty("iat")},Xu=function(n){const e=va(n).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lt(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function Rn(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]}function Vo(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Ri(n,e,t){const i={};for(const s in n)Object.prototype.hasOwnProperty.call(n,s)&&(i[s]=e.call(t,n[s],s,n));return i}function Ds(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const s of t){if(!i.includes(s))return!1;const o=n[s],r=e[s];if(Ko(o)&&Ko(r)){if(!Ds(o,r))return!1}else if(o!==r)return!1}for(const s of i)if(!t.includes(s))return!1;return!0}function Ko(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ju(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zu{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const i=this.W_;if(typeof e=="string")for(let d=0;d<16;d++)i[d]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let d=0;d<16;d++)i[d]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let d=16;d<80;d++){const f=i[d-3]^i[d-8]^i[d-14]^i[d-16];i[d]=(f<<1|f>>>31)&4294967295}let s=this.chain_[0],o=this.chain_[1],r=this.chain_[2],a=this.chain_[3],l=this.chain_[4],c,u;for(let d=0;d<80;d++){d<40?d<20?(c=a^o&(r^a),u=1518500249):(c=o^r^a,u=1859775393):d<60?(c=o&r|a&(o|r),u=2400959708):(c=o^r^a,u=3395469782);const f=(s<<5|s>>>27)+c+l+u+i[d]&4294967295;l=a,a=r,r=(o<<30|o>>>2)&4294967295,o=s,s=f}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+o&4294967295,this.chain_[2]=this.chain_[2]+r&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295}update(e,t){if(e==null)return;t===void 0&&(t=e.length);const i=t-this.blockSize;let s=0;const o=this.buf_;let r=this.inbuf_;for(;s<t;){if(r===0)for(;s<=i;)this.compress_(e,s),s+=this.blockSize;if(typeof e=="string"){for(;s<t;)if(o[r]=e.charCodeAt(s),++r,++s,r===this.blockSize){this.compress_(o),r=0;break}}else for(;s<t;)if(o[r]=e[s],++r,++s,r===this.blockSize){this.compress_(o),r=0;break}}this.inbuf_=r,this.total_+=t}digest(){const e=[];let t=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let s=this.blockSize-1;s>=56;s--)this.buf_[s]=t&255,t/=256;this.compress_(this.buf_);let i=0;for(let s=0;s<5;s++)for(let o=24;o>=0;o-=8)e[i]=this.chain_[s]>>o&255,++i;return e}}function so(n,e){return`${n} failed: ${e} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xu=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let s=n.charCodeAt(i);if(s>=55296&&s<=56319){const o=s-55296;i++,ee(i<n.length,"Surrogate pair missing trail surrogate.");const r=n.charCodeAt(i)-56320;s=65536+(o<<10)+r}s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):s<65536?(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},Ji=function(n){let e=0;for(let t=0;t<n.length;t++){const i=n.charCodeAt(t);i<128?e++:i<2048?e+=2:i>=55296&&i<=56319?(e+=4,t++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tn(n){return n&&n._delegate?n._delegate:n}class ti{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sn="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $u{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new Xi;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&i.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const i=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(o){if(s)return null;throw o}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(td(e))try{this.getOrInitializeService({instanceIdentifier:sn})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const o=this.getOrInitializeService({instanceIdentifier:s});i.resolve(o)}catch{}}}}clearInstance(e=sn){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=sn){return this.instances.has(e)}getOptions(e=sn){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[o,r]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(o);i===a&&r.resolve(s)}return s}onInit(e,t){var i;const s=this.normalizeInstanceIdentifier(t),o=(i=this.onInitCallbacks.get(s))!==null&&i!==void 0?i:new Set;o.add(e),this.onInitCallbacks.set(s,o);const r=this.instances.get(s);return r&&e(r,s),()=>{o.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const s of i)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:ed(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=sn){return this.component?this.component.multipleInstances?e:sn:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function ed(n){return n===sn?void 0:n}function td(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nd{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new $u(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ue;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Ue||(Ue={}));const id={debug:Ue.DEBUG,verbose:Ue.VERBOSE,info:Ue.INFO,warn:Ue.WARN,error:Ue.ERROR,silent:Ue.SILENT},sd=Ue.INFO,od={[Ue.DEBUG]:"log",[Ue.VERBOSE]:"log",[Ue.INFO]:"info",[Ue.WARN]:"warn",[Ue.ERROR]:"error"},rd=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),s=od[e];if(s)console[s](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class ya{constructor(e){this.name=e,this._logLevel=sd,this._logHandler=rd,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ue))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?id[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ue.DEBUG,...e),this._logHandler(this,Ue.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ue.VERBOSE,...e),this._logHandler(this,Ue.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ue.INFO,...e),this._logHandler(this,Ue.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ue.WARN,...e),this._logHandler(this,Ue.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ue.ERROR,...e),this._logHandler(this,Ue.ERROR,...e)}}const ld=(n,e)=>e.some(t=>n instanceof t);let Yo,Qo;function ad(){return Yo||(Yo=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function cd(){return Qo||(Qo=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const wa=new WeakMap,Rs=new WeakMap,ka=new WeakMap,ms=new WeakMap,oo=new WeakMap;function ud(n){const e=new Promise((t,i)=>{const s=()=>{n.removeEventListener("success",o),n.removeEventListener("error",r)},o=()=>{t(Gt(n.result)),s()},r=()=>{i(n.error),s()};n.addEventListener("success",o),n.addEventListener("error",r)});return e.then(t=>{t instanceof IDBCursor&&wa.set(t,n)}).catch(()=>{}),oo.set(e,n),e}function dd(n){if(Rs.has(n))return;const e=new Promise((t,i)=>{const s=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",r),n.removeEventListener("abort",r)},o=()=>{t(),s()},r=()=>{i(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",o),n.addEventListener("error",r),n.addEventListener("abort",r)});Rs.set(n,e)}let As={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Rs.get(n);if(e==="objectStoreNames")return n.objectStoreNames||ka.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Gt(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function fd(n){As=n(As)}function hd(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(gs(this),e,...t);return ka.set(i,e.sort?e.sort():[e]),Gt(i)}:cd().includes(n)?function(...e){return n.apply(gs(this),e),Gt(wa.get(this))}:function(...e){return Gt(n.apply(gs(this),e))}}function _d(n){return typeof n=="function"?hd(n):(n instanceof IDBTransaction&&dd(n),ld(n,ad())?new Proxy(n,As):n)}function Gt(n){if(n instanceof IDBRequest)return ud(n);if(ms.has(n))return ms.get(n);const e=_d(n);return e!==n&&(ms.set(n,e),oo.set(e,n)),e}const gs=n=>oo.get(n);function pd(n,e,{blocked:t,upgrade:i,blocking:s,terminated:o}={}){const r=indexedDB.open(n,e),a=Gt(r);return i&&r.addEventListener("upgradeneeded",l=>{i(Gt(r.result),l.oldVersion,l.newVersion,Gt(r.transaction),l)}),t&&r.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),a.then(l=>{o&&l.addEventListener("close",()=>o()),s&&l.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const md=["get","getKey","getAll","getAllKeys","count"],gd=["put","add","delete","clear"],bs=new Map;function Xo(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(bs.get(e))return bs.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,s=gd.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(s||md.includes(t)))return;const o=async function(r,...a){const l=this.transaction(r,s?"readwrite":"readonly");let c=l.store;return i&&(c=c.index(a.shift())),(await Promise.all([c[t](...a),s&&l.done]))[0]};return bs.set(e,o),o}fd(n=>({...n,get:(e,t,i)=>Xo(e,t)||n.get(e,t,i),has:(e,t)=>!!Xo(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bd{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(vd(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function vd(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Ps="@firebase/app",Jo="0.9.23";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fn=new ya("@firebase/app"),yd="@firebase/app-compat",wd="@firebase/analytics-compat",kd="@firebase/analytics",Cd="@firebase/app-check-compat",Ed="@firebase/app-check",Sd="@firebase/auth",Id="@firebase/auth-compat",Td="@firebase/database",Nd="@firebase/database-compat",Od="@firebase/functions",Dd="@firebase/functions-compat",Rd="@firebase/installations",Ad="@firebase/installations-compat",Pd="@firebase/messaging",Md="@firebase/messaging-compat",Ld="@firebase/performance",Fd="@firebase/performance-compat",Bd="@firebase/remote-config",qd="@firebase/remote-config-compat",jd="@firebase/storage",zd="@firebase/storage-compat",Wd="@firebase/firestore",Hd="@firebase/firestore-compat",Ud="firebase",Gd="10.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ms="[DEFAULT]",Vd={[Ps]:"fire-core",[yd]:"fire-core-compat",[kd]:"fire-analytics",[wd]:"fire-analytics-compat",[Ed]:"fire-app-check",[Cd]:"fire-app-check-compat",[Sd]:"fire-auth",[Id]:"fire-auth-compat",[Td]:"fire-rtdb",[Nd]:"fire-rtdb-compat",[Od]:"fire-fn",[Dd]:"fire-fn-compat",[Rd]:"fire-iid",[Ad]:"fire-iid-compat",[Pd]:"fire-fcm",[Md]:"fire-fcm-compat",[Ld]:"fire-perf",[Fd]:"fire-perf-compat",[Bd]:"fire-rc",[qd]:"fire-rc-compat",[jd]:"fire-gcs",[zd]:"fire-gcs-compat",[Wd]:"fire-fst",[Hd]:"fire-fst-compat","fire-js":"fire-js",[Ud]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ai=new Map,Ls=new Map;function Kd(n,e){try{n.container.addComponent(e)}catch(t){fn.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Pi(n){const e=n.name;if(Ls.has(e))return fn.debug(`There were multiple attempts to register component ${e}.`),!1;Ls.set(e,n);for(const t of Ai.values())Kd(t,n);return!0}function Yd(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qd={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},Vt=new ba("app","Firebase",Qd);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xd{constructor(e,t,i){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new ti("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Vt.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jd=Gd;function Ca(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i=Object.assign({name:Ms,automaticDataCollectionEnabled:!1},e),s=i.name;if(typeof s!="string"||!s)throw Vt.create("bad-app-name",{appName:String(s)});if(t||(t=pa()),!t)throw Vt.create("no-options");const o=Ai.get(s);if(o){if(Ds(t,o.options)&&Ds(i,o.config))return o;throw Vt.create("duplicate-app",{appName:s})}const r=new nd(s);for(const l of Ls.values())r.addComponent(l);const a=new Xd(t,i,r);return Ai.set(s,a),a}function Zd(n=Ms){const e=Ai.get(n);if(!e&&n===Ms&&pa())return Ca();if(!e)throw Vt.create("no-app",{appName:n});return e}function In(n,e,t){var i;let s=(i=Vd[n])!==null&&i!==void 0?i:n;t&&(s+=`-${t}`);const o=s.match(/\s|\//),r=e.match(/\s|\//);if(o||r){const a=[`Unable to register library "${s}" with version "${e}":`];o&&a.push(`library name "${s}" contains illegal characters (whitespace or "/")`),o&&r&&a.push("and"),r&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),fn.warn(a.join(" "));return}Pi(new ti(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xd="firebase-heartbeat-database",$d=1,ni="firebase-heartbeat-store";let vs=null;function Ea(){return vs||(vs=pd(xd,$d,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(ni)}}}).catch(n=>{throw Vt.create("idb-open",{originalErrorMessage:n.message})})),vs}async function ef(n){try{return await(await Ea()).transaction(ni).objectStore(ni).get(Sa(n))}catch(e){if(e instanceof fi)fn.warn(e.message);else{const t=Vt.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});fn.warn(t.message)}}}async function Zo(n,e){try{const i=(await Ea()).transaction(ni,"readwrite");await i.objectStore(ni).put(e,Sa(n)),await i.done}catch(t){if(t instanceof fi)fn.warn(t.message);else{const i=Vt.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});fn.warn(i.message)}}}function Sa(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tf=1024,nf=30*24*60*60*1e3;class sf{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new rf(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var e;const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=xo();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)))return this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const r=new Date(o.date).valueOf();return Date.now()-r<=nf}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var e;if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=xo(),{heartbeatsToSend:i,unsentEntries:s}=of(this._heartbeatsCache.heartbeats),o=Di(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=t,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}}function xo(){return new Date().toISOString().substring(0,10)}function of(n,e=tf){const t=[];let i=n.slice();for(const s of n){const o=t.find(r=>r.agent===s.agent);if(o){if(o.dates.push(s.date),$o(t)>e){o.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),$o(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class rf{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Uu()?Gu().then(()=>!0).catch(()=>!1):!1}async read(){return await this._canUseIndexedDBPromise?await ef(this.app)||{heartbeats:[]}:{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return Zo(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return Zo(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function $o(n){return Di(JSON.stringify({version:2,heartbeats:n})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lf(n){Pi(new ti("platform-logger",e=>new bd(e),"PRIVATE")),Pi(new ti("heartbeat",e=>new sf(e),"PRIVATE")),In(Ps,Jo,n),In(Ps,Jo,"esm2017"),In("fire-js","")}lf("");var af="firebase",cf="10.6.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */In(af,cf,"app");const er="@firebase/database",tr="1.0.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ia="";function uf(n){Ia=n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class df{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Ze(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:ei(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ff{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return Lt(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ta=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){const e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new df(e)}}catch{}return new ff},ln=Ta("localStorage"),Fs=Ta("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tn=new ya("@firebase/database"),hf=function(){let n=1;return function(){return n++}}(),Na=function(n){const e=xu(n),t=new Zu;t.update(e);const i=t.digest();return io.encodeByteArray(i)},hi=function(...n){let e="";for(let t=0;t<n.length;t++){const i=n[t];Array.isArray(i)||i&&typeof i=="object"&&typeof i.length=="number"?e+=hi.apply(null,i):typeof i=="object"?e+=Ze(i):e+=i,e+=" "}return e};let un=null,nr=!0;const _f=function(n,e){ee(!e||n===!0||n===!1,"Can't turn on custom loggers persistently."),n===!0?(Tn.logLevel=Ue.VERBOSE,un=Tn.log.bind(Tn),e&&Fs.set("logging_enabled",!0)):typeof n=="function"?un=n:(un=null,Fs.remove("logging_enabled"))},lt=function(...n){if(nr===!0&&(nr=!1,un===null&&Fs.get("logging_enabled")===!0&&_f(!0)),un){const e=hi.apply(null,n);un(e)}},_i=function(n){return function(...e){lt(n,...e)}},Bs=function(...n){const e="FIREBASE INTERNAL ERROR: "+hi(...n);Tn.error(e)},jt=function(...n){const e=`FIREBASE FATAL ERROR: ${hi(...n)}`;throw Tn.error(e),new Error(e)},mt=function(...n){const e="FIREBASE WARNING: "+hi(...n);Tn.warn(e)},pf=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&mt("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},ro=function(n){return typeof n=="number"&&(n!==n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},mf=function(n){if(document.readyState==="complete")n();else{let e=!1;const t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,n())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},hn="[MIN_NAME]",Zt="[MAX_NAME]",jn=function(n,e){if(n===e)return 0;if(n===hn||e===Zt)return-1;if(e===hn||n===Zt)return 1;{const t=ir(n),i=ir(e);return t!==null?i!==null?t-i===0?n.length-e.length:t-i:-1:i!==null?1:n<e?-1:1}},gf=function(n,e){return n===e?0:n<e?-1:1},Gn=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+Ze(e))},lo=function(n){if(typeof n!="object"||n===null)return Ze(n);const e=[];for(const i in n)e.push(i);e.sort();let t="{";for(let i=0;i<e.length;i++)i!==0&&(t+=","),t+=Ze(e[i]),t+=":",t+=lo(n[e[i]]);return t+="}",t},Oa=function(n,e){const t=n.length;if(t<=e)return[n];const i=[];for(let s=0;s<t;s+=e)s+e>t?i.push(n.substring(s,t)):i.push(n.substring(s,s+e));return i};function gt(n,e){for(const t in n)n.hasOwnProperty(t)&&e(t,n[t])}const Da=function(n){ee(!ro(n),"Invalid JSON number");const e=11,t=52,i=(1<<e-1)-1;let s,o,r,a,l;n===0?(o=0,r=0,s=1/n===-1/0?1:0):(s=n<0,n=Math.abs(n),n>=Math.pow(2,1-i)?(a=Math.min(Math.floor(Math.log(n)/Math.LN2),i),o=a+i,r=Math.round(n*Math.pow(2,t-a)-Math.pow(2,t))):(o=0,r=Math.round(n/Math.pow(2,1-i-t))));const c=[];for(l=t;l;l-=1)c.push(r%2?1:0),r=Math.floor(r/2);for(l=e;l;l-=1)c.push(o%2?1:0),o=Math.floor(o/2);c.push(s?1:0),c.reverse();const u=c.join("");let d="";for(l=0;l<64;l+=8){let f=parseInt(u.substr(l,8),2).toString(16);f.length===1&&(f="0"+f),d=d+f}return d.toLowerCase()},bf=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},vf=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function yf(n,e){let t="Unknown Error";n==="too_big"?t="The data requested exceeds the maximum size that can be accessed with a single request.":n==="permission_denied"?t="Client doesn't have permission to access the desired data.":n==="unavailable"&&(t="The service is unavailable");const i=new Error(n+" at "+e._path.toString()+": "+t);return i.code=n.toUpperCase(),i}const wf=new RegExp("^-?(0*)\\d{1,10}$"),kf=-2147483648,Cf=2147483647,ir=function(n){if(wf.test(n)){const e=Number(n);if(e>=kf&&e<=Cf)return e}return null},zn=function(n){try{n()}catch(e){setTimeout(()=>{const t=e.stack||"";throw mt("Exception was thrown by user callback.",t),e},Math.floor(0))}},Ef=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Xn=function(n,e){const t=setTimeout(n,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sf{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=t==null?void 0:t.getImmediate({optional:!0}),this.appCheck||t==null||t.get().then(i=>this.appCheck=i)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,i)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,i):t(null)},0)})}addTokenChangeListener(e){var t;(t=this.appCheckProvider)===null||t===void 0||t.get().then(i=>i.addTokenListener(e))}notifyForInvalidToken(){mt(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class If{constructor(e,t,i){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=i,this.auth_=null,this.auth_=i.getImmediate({optional:!0}),this.auth_||i.onInit(s=>this.auth_=s)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(lt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,i)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,i):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',mt(e)}}class Nn{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}Nn.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ao="5",Ra="v",Aa="s",Pa="r",Ma="f",La=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,Fa="ls",Ba="p",qs="ac",qa="websocket",ja="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class za{constructor(e,t,i,s,o=!1,r="",a=!1,l=!1){this.secure=t,this.namespace=i,this.webSocketOnly=s,this.nodeAdmin=o,this.persistenceKey=r,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=l,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=ln.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&ln.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}}function Tf(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams}function Wa(n,e,t){ee(typeof e=="string","typeof type must == string"),ee(typeof t=="object","typeof params must == object");let i;if(e===qa)i=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else if(e===ja)i=(n.secure?"https://":"http://")+n.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);Tf(n)&&(t.ns=n.namespace);const s=[];return gt(t,(o,r)=>{s.push(o+"="+r)}),i+s.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nf{constructor(){this.counters_={}}incrementCounter(e,t=1){Lt(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return Au(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ys={},ws={};function co(n){const e=n.toString();return ys[e]||(ys[e]=new Nf),ys[e]}function Of(n,e){const t=n.toString();return ws[t]||(ws[t]=e()),ws[t]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Df{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const i=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let s=0;s<i.length;++s)i[s]&&zn(()=>{this.onMessage_(i[s])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sr="start",Rf="close",Af="pLPCommand",Pf="pRTLPCB",Ha="id",Ua="pw",Ga="ser",Mf="cb",Lf="seg",Ff="ts",Bf="d",qf="dframe",Va=1870,Ka=30,jf=Va-Ka,zf=25e3,Wf=3e4;class kn{constructor(e,t,i,s,o,r,a){this.connId=e,this.repoInfo=t,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.transportSessionId=r,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=_i(e),this.stats_=co(t),this.urlFn=l=>(this.appCheckToken&&(l[qs]=this.appCheckToken),Wa(t,ja,l))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new Df(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(Wf)),mf(()=>{if(this.isClosed_)return;this.scriptTagHolder=new uo((...o)=>{const[r,a,l,c,u]=o;if(this.incrementIncomingBytes_(o),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,r===sr)this.id=a,this.password=l;else if(r===Rf)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+r)},(...o)=>{const[r,a]=o;this.incrementIncomingBytes_(o),this.myPacketOrderer.handleResponse(r,a)},()=>{this.onClosed_()},this.urlFn);const i={};i[sr]="t",i[Ga]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(i[Mf]=this.scriptTagHolder.uniqueCallbackIdentifier),i[Ra]=ao,this.transportSessionId&&(i[Aa]=this.transportSessionId),this.lastSessionId&&(i[Fa]=this.lastSessionId),this.applicationId&&(i[Ba]=this.applicationId),this.appCheckToken&&(i[qs]=this.appCheckToken),typeof location<"u"&&location.hostname&&La.test(location.hostname)&&(i[Pa]=Ma);const s=this.urlFn(i);this.log_("Connecting via long-poll to "+s),this.scriptTagHolder.addTag(s,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){kn.forceAllow_=!0}static forceDisallow(){kn.forceDisallow_=!0}static isAvailable(){return kn.forceAllow_?!0:!kn.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!bf()&&!vf()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=Ze(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const i=fa(t),s=Oa(i,jf);for(let o=0;o<s.length;o++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,s.length,s[o]),this.curSegmentNum++}addDisconnectPingFrame(e,t){this.myDisconnFrame=document.createElement("iframe");const i={};i[qf]="t",i[Ha]=e,i[Ua]=t,this.myDisconnFrame.src=this.urlFn(i),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=Ze(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class uo{constructor(e,t,i,s){this.onDisconnect=i,this.urlFn=s,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=hf(),window[Af+this.uniqueCallbackIdentifier]=e,window[Pf+this.uniqueCallbackIdentifier]=t,this.myIFrame=uo.createIFrame_();let o="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(o='<script>document.domain="'+document.domain+'";<\/script>');const r="<html><body>"+o+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(r),this.myIFrame.doc.close()}catch(a){lt("frame writing exception"),a.stack&&lt(a.stack),lt(a)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||lt("No IE domain setting required")}catch{const i=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+i+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[Ha]=this.myID,e[Ua]=this.myPW,e[Ga]=this.currentSerial;let t=this.urlFn(e),i="",s=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+Ka+i.length<=Va;){const r=this.pendingSegs.shift();i=i+"&"+Lf+s+"="+r.seg+"&"+Ff+s+"="+r.ts+"&"+Bf+s+"="+r.d,s++}return t=t+i,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,i){this.pendingSegs.push({seg:e,ts:t,d:i}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const i=()=>{this.outstandingRequests.delete(t),this.newRequest_()},s=setTimeout(i,Math.floor(zf)),o=()=>{clearTimeout(s),i()};this.addTag(e,o)}addTag(e,t){setTimeout(()=>{try{if(!this.sendNewPolls)return;const i=this.myIFrame.doc.createElement("script");i.type="text/javascript",i.async=!0,i.src=e,i.onload=i.onreadystatechange=function(){const s=i.readyState;(!s||s==="loaded"||s==="complete")&&(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),t())},i.onerror=()=>{lt("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(i)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hf=16384,Uf=45e3;let Mi=null;typeof MozWebSocket<"u"?Mi=MozWebSocket:typeof WebSocket<"u"&&(Mi=WebSocket);class Ct{constructor(e,t,i,s,o,r,a){this.connId=e,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=_i(this.connId),this.stats_=co(t),this.connURL=Ct.connectionURL_(t,r,a,s,i),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,i,s,o){const r={};return r[Ra]=ao,typeof location<"u"&&location.hostname&&La.test(location.hostname)&&(r[Pa]=Ma),t&&(r[Aa]=t),i&&(r[Fa]=i),s&&(r[qs]=s),o&&(r[Ba]=o),Wa(e,qa,r)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,ln.set("previous_websocket_failure",!0);try{let i;ga(),this.mySock=new Mi(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");const s=i.message||i.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");const s=i.message||i.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){Ct.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(t);i&&i.length>1&&parseFloat(i[1])<4.4&&(e=!0)}return!e&&Mi!==null&&!Ct.forceDisallow_}static previouslyFailed(){return ln.isInMemoryStorage||ln.get("previous_websocket_failure")===!0}markConnectionHealthy(){ln.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const t=this.frames.join("");this.frames=null;const i=ei(t);this.onMessage(i)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(ee(this.frames===null,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(t);else{const i=this.extractFrameCount_(t);i!==null&&this.appendFrame_(i)}}send(e){this.resetKeepAlive();const t=Ze(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const i=Oa(t,Hf);i.length>1&&this.sendString_(String(i.length));for(let s=0;s<i.length;s++)this.sendString_(i[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(Uf))}sendString_(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}Ct.responsesRequiredToBeHealthy=2;Ct.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ii{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[kn,Ct]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const t=Ct&&Ct.isAvailable();let i=t&&!Ct.previouslyFailed();if(e.webSocketOnly&&(t||mt("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[Ct];else{const s=this.transports_=[];for(const o of ii.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);ii.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}ii.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gf=6e4,Vf=5e3,Kf=10*1024,Yf=100*1024,ks="t",or="d",Qf="s",rr="r",Xf="e",lr="o",ar="a",cr="n",ur="p",Jf="h";class Zf{constructor(e,t,i,s,o,r,a,l,c,u){this.id=e,this.repoInfo_=t,this.applicationId_=i,this.appCheckToken_=s,this.authToken_=o,this.onMessage_=r,this.onReady_=a,this.onDisconnect_=l,this.onKill_=c,this.lastSessionId=u,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=_i("c:"+this.id+":"),this.transportManager_=new ii(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),i=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,i)},Math.floor(0));const s=e.healthyTimeout||0;s>0&&(this.healthyTimeout_=Xn(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>Yf?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>Kf?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(s)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(ks in e){const t=e[ks];t===ar?this.upgradeIfSecondaryHealthy_():t===rr?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===lr&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=Gn("t",e),i=Gn("d",e);if(t==="c")this.onSecondaryControl_(i);else if(t==="d")this.pendingDataMessages.push(i);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:ur,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:ar,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:cr,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=Gn("t",e),i=Gn("d",e);t==="c"?this.onControl_(i):t==="d"&&this.onDataMessage_(i)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=Gn(ks,e);if(or in e){const i=e[or];if(t===Jf){const s=Object.assign({},i);this.repoInfo_.isUsingEmulator&&(s.h=this.repoInfo_.host),this.onHandshake_(s)}else if(t===cr){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let s=0;s<this.pendingDataMessages.length;++s)this.onDataMessage_(this.pendingDataMessages[s]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===Qf?this.onConnectionShutdown_(i):t===rr?this.onReset_(i):t===Xf?Bs("Server Error: "+i):t===lr?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Bs("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,i=e.v,s=e.h;this.sessionId=e.s,this.repoInfo_.host=s,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),ao!==i&&mt("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),i=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,i),Xn(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(Gf))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Xn(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(Vf))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:ur,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(ln.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ya{put(e,t,i,s){}merge(e,t,i,s){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,i){}onDisconnectMerge(e,t,i){}onDisconnectCancel(e,t){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qa{constructor(e){this.allowedEvents_=e,this.listeners_={},ee(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const i=[...this.listeners_[e]];for(let s=0;s<i.length;s++)i[s].callback.apply(i[s].context,t)}}on(e,t,i){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:i});const s=this.getInitialEvent(e);s&&t.apply(i,s)}off(e,t,i){this.validateEventType_(e);const s=this.listeners_[e]||[];for(let o=0;o<s.length;o++)if(s[o].callback===t&&(!i||i===s[o].context)){s.splice(o,1);return}}validateEventType_(e){ee(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Li extends Qa{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!ma()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new Li}getInitialEvent(e){return ee(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dr=32,fr=768;class ze{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let i=0;for(let s=0;s<this.pieces_.length;s++)this.pieces_[s].length>0&&(this.pieces_[i]=this.pieces_[s],i++);this.pieces_.length=i,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}}function Le(){return new ze("")}function Te(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function xt(n){return n.pieces_.length-n.pieceNum_}function Ge(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new ze(n.pieces_,e)}function Xa(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function xf(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)n.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}function Ja(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function Za(n){if(n.pieceNum_>=n.pieces_.length)return null;const e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new ze(e,0)}function xe(n,e){const t=[];for(let i=n.pieceNum_;i<n.pieces_.length;i++)t.push(n.pieces_[i]);if(e instanceof ze)for(let i=e.pieceNum_;i<e.pieces_.length;i++)t.push(e.pieces_[i]);else{const i=e.split("/");for(let s=0;s<i.length;s++)i[s].length>0&&t.push(i[s])}return new ze(t,0)}function Ie(n){return n.pieceNum_>=n.pieces_.length}function ut(n,e){const t=Te(n),i=Te(e);if(t===null)return e;if(t===i)return ut(Ge(n),Ge(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function xa(n,e){if(xt(n)!==xt(e))return!1;for(let t=n.pieceNum_,i=e.pieceNum_;t<=n.pieces_.length;t++,i++)if(n.pieces_[t]!==e.pieces_[i])return!1;return!0}function Et(n,e){let t=n.pieceNum_,i=e.pieceNum_;if(xt(n)>xt(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[i])return!1;++t,++i}return!0}class $f{constructor(e,t){this.errorPrefix_=t,this.parts_=Ja(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let i=0;i<this.parts_.length;i++)this.byteLength_+=Ji(this.parts_[i]);$a(this)}}function eh(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=Ji(e),$a(n)}function th(n){const e=n.parts_.pop();n.byteLength_-=Ji(e),n.parts_.length>0&&(n.byteLength_-=1)}function $a(n){if(n.byteLength_>fr)throw new Error(n.errorPrefix_+"has a key path longer than "+fr+" bytes ("+n.byteLength_+").");if(n.parts_.length>dr)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+dr+") or object contains a cycle "+on(n))}function on(n){return n.parts_.length===0?"":"in property '"+n.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fo extends Qa{constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const i=!document[e];i!==this.visible_&&(this.visible_=i,this.trigger("visible",i))},!1)}static getInstance(){return new fo}getInitialEvent(e){return ee(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vn=1e3,nh=60*5*1e3,hr=30*1e3,ih=1.3,sh=3e4,oh="server_kill",_r=3;class qt extends Ya{constructor(e,t,i,s,o,r,a,l){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=i,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=r,this.appCheckTokenProvider_=a,this.authOverride_=l,this.id=qt.nextPersistentConnectionId_++,this.log_=_i("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Vn,this.maxReconnectDelay_=nh,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l&&!ga())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");fo.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&Li.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,i){const s=++this.requestNumber_,o={r:s,a:e,b:t};this.log_(Ze(o)),ee(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),i&&(this.requestCBHash_[s]=i)}get(e){this.initConnection_();const t=new Xi,s={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:r=>{const a=r.d;r.s==="ok"?t.resolve(a):t.reject(a)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;const o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),t.promise}listen(e,t,i,s){this.initConnection_();const o=e._queryIdentifier,r=e._path.toString();this.log_("Listen called for "+r+" "+o),this.listens.has(r)||this.listens.set(r,new Map),ee(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),ee(!this.listens.get(r).has(o),"listen() called twice for same path/queryId.");const a={onComplete:s,hashFn:t,query:e,tag:i};this.listens.get(r).set(o,a),this.connected_&&this.sendListen_(a)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,i=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(i)})}sendListen_(e){const t=e.query,i=t._path.toString(),s=t._queryIdentifier;this.log_("Listen on "+i+" for "+s);const o={p:i},r="q";e.tag&&(o.q=t._queryObject,o.t=e.tag),o.h=e.hashFn(),this.sendRequest(r,o,a=>{const l=a.d,c=a.s;qt.warnOnListenWarnings_(l,t),(this.listens.get(i)&&this.listens.get(i).get(s))===e&&(this.log_("listen response",a),c!=="ok"&&this.removeListen_(i,s),e.onComplete&&e.onComplete(c,l))})}static warnOnListenWarnings_(e,t){if(e&&typeof e=="object"&&Lt(e,"w")){const i=Rn(e,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){const s='".indexOn": "'+t._queryParams.getIndex().toString()+'"',o=t._path.toString();mt(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||Xu(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=hr)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=Qu(e)?"auth":"gauth",i={cred:e};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(t,i,s=>{const o=s.s,r=s.d||"error";this.authToken_===e&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,r))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const t=e.s,i=e.d||"error";t==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,i)})}unlisten(e,t){const i=e._path.toString(),s=e._queryIdentifier;this.log_("Unlisten called for "+i+" "+s),ee(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,s)&&this.connected_&&this.sendUnlisten_(i,s,e._queryObject,t)}sendUnlisten_(e,t,i,s){this.log_("Unlisten on "+e+" for "+t);const o={p:e},r="n";s&&(o.q=i,o.t=s),this.sendRequest(r,o)}onDisconnectPut(e,t,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,i):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:i})}onDisconnectMerge(e,t,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,i):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:i})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,i,s){const o={p:t,d:i};this.log_("onDisconnect "+e,o),this.sendRequest(e,o,r=>{s&&setTimeout(()=>{s(r.s,r.d)},Math.floor(0))})}put(e,t,i,s){this.putInternal("p",e,t,i,s)}merge(e,t,i,s){this.putInternal("m",e,t,i,s)}putInternal(e,t,i,s,o){this.initConnection_();const r={p:t,d:i};o!==void 0&&(r.h=o),this.outstandingPuts_.push({action:e,request:r,onComplete:s}),this.outstandingPutCount_++;const a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,i=this.outstandingPuts_[e].request,s=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,i,o=>{this.log_(t+" response",o),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,i=>{if(i.s!=="ok"){const o=i.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+Ze(e));const t=e.r,i=this.requestCBHash_[t];i&&(delete this.requestCBHash_[t],i(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),e==="d"?this.onDataUpdate_(t.p,t.d,!1,t.t):e==="m"?this.onDataUpdate_(t.p,t.d,!0,t.t):e==="c"?this.onListenRevoked_(t.p,t.q):e==="ac"?this.onAuthRevoked_(t.s,t.d):e==="apc"?this.onAppCheckRevoked_(t.s,t.d):e==="sd"?this.onSecurityDebugPacket_(t):Bs("Unrecognized action received from server: "+Ze(e)+`
Are you using the latest client?`)}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){ee(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Vn,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=Vn,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>sh&&(this.reconnectDelay_=Vn),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=new Date().getTime()-this.lastConnectionAttemptTime_;let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*ih)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+qt.nextConnectionId_++,o=this.lastSessionId;let r=!1,a=null;const l=function(){a?a.close():(r=!0,i())},c=function(d){ee(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(d)};this.realtime_={close:l,sendRequest:c};const u=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[d,f]=await Promise.all([this.authTokenProvider_.getToken(u),this.appCheckTokenProvider_.getToken(u)]);r?lt("getToken() completed but was canceled"):(lt("getToken() completed. Creating connection."),this.authToken_=d&&d.accessToken,this.appCheckToken_=f&&f.token,a=new Zf(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,i,h=>{mt(h+" ("+this.repoInfo_.toString()+")"),this.interrupt(oh)},o))}catch(d){this.log_("Failed to get token: "+d),r||(this.repoInfo_.nodeAdmin&&mt(d),l())}}}interrupt(e){lt("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){lt("Resuming connection for reason: "+e),delete this.interruptReasons_[e],Vo(this.interruptReasons_)&&(this.reconnectDelay_=Vn,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let i;t?i=t.map(o=>lo(o)).join("$"):i="default";const s=this.removeListen_(e,i);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(e,t){const i=new ze(e).toString();let s;if(this.listens.has(i)){const o=this.listens.get(i);s=o.get(t),o.delete(t),o.size===0&&this.listens.delete(i)}else s=void 0;return s}onAuthRevoked_(e,t){lt("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=_r&&(this.reconnectDelay_=hr,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){lt("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=_r&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let t="js";e["sdk."+t+"."+Ia.replace(/\./g,"-")]=1,ma()?e["framework.cordova"]=1:Hu()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=Li.getInstance().currentlyOnline();return Vo(this.interruptReasons_)&&e}}qt.nextPersistentConnectionId_=0;qt.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ee{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new Ee(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zi{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const i=new Ee(hn,e),s=new Ee(hn,t);return this.compare(i,s)!==0}minPost(){return Ee.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ki;class ec extends Zi{static get __EMPTY_NODE(){return ki}static set __EMPTY_NODE(e){ki=e}compare(e,t){return jn(e.name,t.name)}isDefinedOn(e){throw qn("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return Ee.MIN}maxPost(){return new Ee(Zt,ki)}makePost(e,t){return ee(typeof e=="string","KeyIndex indexValue must always be a string."),new Ee(e,ki)}toString(){return".key"}}const Kt=new ec;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ci{constructor(e,t,i,s,o=null){this.isReverse_=s,this.resultGenerator_=o,this.nodeStack_=[];let r=1;for(;!e.isEmpty();)if(e=e,r=t?i(e.key,t):1,s&&(r*=-1),r<0)this.isReverse_?e=e.left:e=e.right;else if(r===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class nt{constructor(e,t,i,s,o){this.key=e,this.value=t,this.color=i??nt.RED,this.left=s??pt.EMPTY_NODE,this.right=o??pt.EMPTY_NODE}copy(e,t,i,s,o){return new nt(e??this.key,t??this.value,i??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let s=this;const o=i(e,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(e,t,i),null):o===0?s=s.copy(null,t,null,null,null):s=s.copy(null,null,null,null,s.right.insert(e,t,i)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return pt.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let i,s;if(i=this,t(e,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),t(e,i.key)===0){if(i.right.isEmpty())return pt.EMPTY_NODE;s=i.right.min_(),i=i.copy(s.key,s.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,nt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,nt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}nt.RED=!0;nt.BLACK=!1;class rh{copy(e,t,i,s,o){return this}insert(e,t,i){return new nt(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class pt{constructor(e,t=pt.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new pt(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,nt.BLACK,null,null))}remove(e){return new pt(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,nt.BLACK,null,null))}get(e){let t,i=this.root_;for(;!i.isEmpty();){if(t=this.comparator_(e,i.key),t===0)return i.value;t<0?i=i.left:t>0&&(i=i.right)}return null}getPredecessorKey(e){let t,i=this.root_,s=null;for(;!i.isEmpty();)if(t=this.comparator_(e,i.key),t===0){if(i.left.isEmpty())return s?s.key:null;for(i=i.left;!i.right.isEmpty();)i=i.right;return i.key}else t<0?i=i.left:t>0&&(s=i,i=i.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Ci(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Ci(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Ci(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Ci(this.root_,null,this.comparator_,!0,e)}}pt.EMPTY_NODE=new rh;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lh(n,e){return jn(n.name,e.name)}function ho(n,e){return jn(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let js;function ah(n){js=n}const tc=function(n){return typeof n=="number"?"number:"+Da(n):"string:"+n},nc=function(n){if(n.isLeafNode()){const e=n.val();ee(typeof e=="string"||typeof e=="number"||typeof e=="object"&&Lt(e,".sv"),"Priority must be a string or number.")}else ee(n===js||n.isEmpty(),"priority of unexpected type.");ee(n===js||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let pr;class tt{constructor(e,t=tt.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,ee(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),nc(this.priorityNode_)}static set __childrenNodeConstructor(e){pr=e}static get __childrenNodeConstructor(){return pr}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new tt(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:tt.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return Ie(e)?this:Te(e)===".priority"?this.priorityNode_:tt.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return e===".priority"?this.updatePriority(t):t.isEmpty()&&e!==".priority"?this:tt.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const i=Te(e);return i===null?t:t.isEmpty()&&i!==".priority"?this:(ee(i!==".priority"||xt(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,tt.__childrenNodeConstructor.EMPTY_NODE.updateChild(Ge(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+tc(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",t==="number"?e+=Da(this.value_):e+=this.value_,this.lazyHash_=Na(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===tt.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof tt.__childrenNodeConstructor?-1:(ee(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,i=typeof this.value_,s=tt.VALUE_TYPE_ORDER.indexOf(t),o=tt.VALUE_TYPE_ORDER.indexOf(i);return ee(s>=0,"Unknown leaf type: "+t),ee(o>=0,"Unknown leaf type: "+i),s===o?i==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}else return!1}}tt.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ic,sc;function ch(n){ic=n}function uh(n){sc=n}class dh extends Zi{compare(e,t){const i=e.node.getPriority(),s=t.node.getPriority(),o=i.compareTo(s);return o===0?jn(e.name,t.name):o}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return Ee.MIN}maxPost(){return new Ee(Zt,new tt("[PRIORITY-POST]",sc))}makePost(e,t){const i=ic(e);return new Ee(t,new tt("[PRIORITY-POST]",i))}toString(){return".priority"}}const Qe=new dh;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fh=Math.log(2);class hh{constructor(e){const t=o=>parseInt(Math.log(o)/fh,10),i=o=>parseInt(Array(o+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;const s=i(this.count);this.bits_=e+1&s}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const Fi=function(n,e,t,i){n.sort(e);const s=function(l,c){const u=c-l;let d,f;if(u===0)return null;if(u===1)return d=n[l],f=t?t(d):d,new nt(f,d.node,nt.BLACK,null,null);{const h=parseInt(u/2,10)+l,_=s(l,h),g=s(h+1,c);return d=n[h],f=t?t(d):d,new nt(f,d.node,nt.BLACK,_,g)}},o=function(l){let c=null,u=null,d=n.length;const f=function(_,g){const v=d-_,w=d;d-=_;const k=s(v+1,w),y=n[v],T=t?t(y):y;h(new nt(T,y.node,g,null,k))},h=function(_){c?(c.left=_,c=_):(u=_,c=_)};for(let _=0;_<l.count;++_){const g=l.nextBitIsOne(),v=Math.pow(2,l.count-(_+1));g?f(v,nt.BLACK):(f(v,nt.BLACK),f(v,nt.RED))}return u},r=new hh(n.length),a=o(r);return new pt(i||e,a)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Cs;const yn={};class Bt{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return ee(yn&&Qe,"ChildrenNode.ts has not been loaded"),Cs=Cs||new Bt({".priority":yn},{".priority":Qe}),Cs}get(e){const t=Rn(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof pt?t:null}hasIndex(e){return Lt(this.indexSet_,e.toString())}addIndex(e,t){ee(e!==Kt,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const i=[];let s=!1;const o=t.getIterator(Ee.Wrap);let r=o.getNext();for(;r;)s=s||e.isDefinedOn(r.node),i.push(r),r=o.getNext();let a;s?a=Fi(i,e.getCompare()):a=yn;const l=e.toString(),c=Object.assign({},this.indexSet_);c[l]=e;const u=Object.assign({},this.indexes_);return u[l]=a,new Bt(u,c)}addToIndexes(e,t){const i=Ri(this.indexes_,(s,o)=>{const r=Rn(this.indexSet_,o);if(ee(r,"Missing index implementation for "+o),s===yn)if(r.isDefinedOn(e.node)){const a=[],l=t.getIterator(Ee.Wrap);let c=l.getNext();for(;c;)c.name!==e.name&&a.push(c),c=l.getNext();return a.push(e),Fi(a,r.getCompare())}else return yn;else{const a=t.get(e.name);let l=s;return a&&(l=l.remove(new Ee(e.name,a))),l.insert(e,e.node)}});return new Bt(i,this.indexSet_)}removeFromIndexes(e,t){const i=Ri(this.indexes_,s=>{if(s===yn)return s;{const o=t.get(e.name);return o?s.remove(new Ee(e.name,o)):s}});return new Bt(i,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Kn;class _e{constructor(e,t,i){this.children_=e,this.priorityNode_=t,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&nc(this.priorityNode_),this.children_.isEmpty()&&ee(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Kn||(Kn=new _e(new pt(ho),null,Bt.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Kn}updatePriority(e){return this.children_.isEmpty()?this:new _e(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const t=this.children_.get(e);return t===null?Kn:t}}getChild(e){const t=Te(e);return t===null?this:this.getImmediateChild(t).getChild(Ge(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,t){if(ee(t,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(t);{const i=new Ee(e,t);let s,o;t.isEmpty()?(s=this.children_.remove(e),o=this.indexMap_.removeFromIndexes(i,this.children_)):(s=this.children_.insert(e,t),o=this.indexMap_.addToIndexes(i,this.children_));const r=s.isEmpty()?Kn:this.priorityNode_;return new _e(s,r,o)}}updateChild(e,t){const i=Te(e);if(i===null)return t;{ee(Te(e)!==".priority"||xt(e)===1,".priority must be the last token in a path");const s=this.getImmediateChild(i).updateChild(Ge(e),t);return this.updateImmediateChild(i,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let i=0,s=0,o=!0;if(this.forEachChild(Qe,(r,a)=>{t[r]=a.val(e),i++,o&&_e.INTEGER_REGEXP_.test(r)?s=Math.max(s,Number(r)):o=!1}),!e&&o&&s<2*i){const r=[];for(const a in t)r[a]=t[a];return r}else return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+tc(this.getPriority().val())+":"),this.forEachChild(Qe,(t,i)=>{const s=i.hash();s!==""&&(e+=":"+t+":"+s)}),this.lazyHash_=e===""?"":Na(e)}return this.lazyHash_}getPredecessorChildName(e,t,i){const s=this.resolveIndex_(i);if(s){const o=s.getPredecessorKey(new Ee(e,t));return o?o.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const i=t.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new Ee(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const i=t.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new Ee(t,this.children_.get(t)):null}forEachChild(e,t){const i=this.resolveIndex_(e);return i?i.inorderTraversal(s=>t(s.name,s.node)):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const i=this.resolveIndex_(t);if(i)return i.getIteratorFrom(e,s=>s);{const s=this.children_.getIteratorFrom(e.name,Ee.Wrap);let o=s.peek();for(;o!=null&&t.compare(o,e)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const i=this.resolveIndex_(t);if(i)return i.getReverseIteratorFrom(e,s=>s);{const s=this.children_.getReverseIteratorFrom(e.name,Ee.Wrap);let o=s.peek();for(;o!=null&&t.compare(o,e)>0;)s.getNext(),o=s.peek();return s}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===pi?-1:0}withIndex(e){if(e===Kt||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new _e(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===Kt||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority()))if(this.children_.count()===t.children_.count()){const i=this.getIterator(Qe),s=t.getIterator(Qe);let o=i.getNext(),r=s.getNext();for(;o&&r;){if(o.name!==r.name||!o.node.equals(r.node))return!1;o=i.getNext(),r=s.getNext()}return o===null&&r===null}else return!1;else return!1}}resolveIndex_(e){return e===Kt?null:this.indexMap_.get(e.toString())}}_e.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class _h extends _e{constructor(){super(new pt(ho),_e.EMPTY_NODE,Bt.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return _e.EMPTY_NODE}isEmpty(){return!1}}const pi=new _h;Object.defineProperties(Ee,{MIN:{value:new Ee(hn,_e.EMPTY_NODE)},MAX:{value:new Ee(Zt,pi)}});ec.__EMPTY_NODE=_e.EMPTY_NODE;tt.__childrenNodeConstructor=_e;ah(pi);uh(pi);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ph=!0;function it(n,e=null){if(n===null)return _e.EMPTY_NODE;if(typeof n=="object"&&".priority"in n&&(e=n[".priority"]),ee(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof n=="object"&&".value"in n&&n[".value"]!==null&&(n=n[".value"]),typeof n!="object"||".sv"in n){const t=n;return new tt(t,it(e))}if(!(n instanceof Array)&&ph){const t=[];let i=!1;if(gt(n,(r,a)=>{if(r.substring(0,1)!=="."){const l=it(a);l.isEmpty()||(i=i||!l.getPriority().isEmpty(),t.push(new Ee(r,l)))}}),t.length===0)return _e.EMPTY_NODE;const o=Fi(t,lh,r=>r.name,ho);if(i){const r=Fi(t,Qe.getCompare());return new _e(o,it(e),new Bt({".priority":r},{".priority":Qe}))}else return new _e(o,it(e),Bt.Default)}else{let t=_e.EMPTY_NODE;return gt(n,(i,s)=>{if(Lt(n,i)&&i.substring(0,1)!=="."){const o=it(s);(o.isLeafNode()||!o.isEmpty())&&(t=t.updateImmediateChild(i,o))}}),t.updatePriority(it(e))}}ch(it);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oc extends Zi{constructor(e){super(),this.indexPath_=e,ee(!Ie(e)&&Te(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const i=this.extractChild(e.node),s=this.extractChild(t.node),o=i.compareTo(s);return o===0?jn(e.name,t.name):o}makePost(e,t){const i=it(e),s=_e.EMPTY_NODE.updateChild(this.indexPath_,i);return new Ee(t,s)}maxPost(){const e=_e.EMPTY_NODE.updateChild(this.indexPath_,pi);return new Ee(Zt,e)}toString(){return Ja(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mh extends Zi{compare(e,t){const i=e.node.compareTo(t.node);return i===0?jn(e.name,t.name):i}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return Ee.MIN}maxPost(){return Ee.MAX}makePost(e,t){const i=it(e);return new Ee(t,i)}toString(){return".value"}}const rc=new mh;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lc(n){return{type:"value",snapshotNode:n}}function An(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function si(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function oi(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}function gh(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _o{constructor(e){this.index_=e}updateChild(e,t,i,s,o,r){ee(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const a=e.getImmediateChild(t);return a.getChild(s).equals(i.getChild(s))&&a.isEmpty()===i.isEmpty()||(r!=null&&(i.isEmpty()?e.hasChild(t)?r.trackChildChange(si(t,a)):ee(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?r.trackChildChange(An(t,i)):r.trackChildChange(oi(t,i,a))),e.isLeafNode()&&i.isEmpty())?e:e.updateImmediateChild(t,i).withIndex(this.index_)}updateFullNode(e,t,i){return i!=null&&(e.isLeafNode()||e.forEachChild(Qe,(s,o)=>{t.hasChild(s)||i.trackChildChange(si(s,o))}),t.isLeafNode()||t.forEachChild(Qe,(s,o)=>{if(e.hasChild(s)){const r=e.getImmediateChild(s);r.equals(o)||i.trackChildChange(oi(s,o,r))}else i.trackChildChange(An(s,o))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?_e.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ri{constructor(e){this.indexedFilter_=new _o(e.getIndex()),this.index_=e.getIndex(),this.startPost_=ri.getStartPost_(e),this.endPost_=ri.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,i=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&i}updateChild(e,t,i,s,o,r){return this.matches(new Ee(t,i))||(i=_e.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,i,s,o,r)}updateFullNode(e,t,i){t.isLeafNode()&&(t=_e.EMPTY_NODE);let s=t.withIndex(this.index_);s=s.updatePriority(_e.EMPTY_NODE);const o=this;return t.forEachChild(Qe,(r,a)=>{o.matches(new Ee(r,a))||(s=s.updateImmediateChild(r,_e.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,s,i)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bh{constructor(e){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{const i=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?i<=0:i<0},this.withinEndPost=t=>{const i=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?i<=0:i<0},this.rangedFilter_=new ri(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,i,s,o,r){return this.rangedFilter_.matches(new Ee(t,i))||(i=_e.EMPTY_NODE),e.getImmediateChild(t).equals(i)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,i,s,o,r):this.fullLimitUpdateChild_(e,t,i,o,r)}updateFullNode(e,t,i){let s;if(t.isLeafNode()||t.isEmpty())s=_e.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<t.numChildren()&&t.isIndexed(this.index_)){s=_e.EMPTY_NODE.withIndex(this.index_);let o;this.reverse_?o=t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):o=t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let r=0;for(;o.hasNext()&&r<this.limit_;){const a=o.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))s=s.updateImmediateChild(a.name,a.node),r++;else break;else continue}}else{s=t.withIndex(this.index_),s=s.updatePriority(_e.EMPTY_NODE);let o;this.reverse_?o=s.getReverseIterator(this.index_):o=s.getIterator(this.index_);let r=0;for(;o.hasNext();){const a=o.getNext();r<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?r++:s=s.updateImmediateChild(a.name,_e.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,s,i)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,i,s,o){let r;if(this.reverse_){const d=this.index_.getCompare();r=(f,h)=>d(h,f)}else r=this.index_.getCompare();const a=e;ee(a.numChildren()===this.limit_,"");const l=new Ee(t,i),c=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),u=this.rangedFilter_.matches(l);if(a.hasChild(t)){const d=a.getImmediateChild(t);let f=s.getChildAfterChild(this.index_,c,this.reverse_);for(;f!=null&&(f.name===t||a.hasChild(f.name));)f=s.getChildAfterChild(this.index_,f,this.reverse_);const h=f==null?1:r(f,l);if(u&&!i.isEmpty()&&h>=0)return o!=null&&o.trackChildChange(oi(t,i,d)),a.updateImmediateChild(t,i);{o!=null&&o.trackChildChange(si(t,d));const g=a.updateImmediateChild(t,_e.EMPTY_NODE);return f!=null&&this.rangedFilter_.matches(f)?(o!=null&&o.trackChildChange(An(f.name,f.node)),g.updateImmediateChild(f.name,f.node)):g}}else return i.isEmpty()?e:u&&r(c,l)>=0?(o!=null&&(o.trackChildChange(si(c.name,c.node)),o.trackChildChange(An(t,i))),a.updateImmediateChild(t,i).updateImmediateChild(c.name,_e.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class po{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Qe}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return ee(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return ee(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:hn}hasEnd(){return this.endSet_}getIndexEndValue(){return ee(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return ee(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Zt}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return ee(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Qe}copy(){const e=new po;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function vh(n){return n.loadsAllData()?new _o(n.getIndex()):n.hasLimit()?new bh(n):new ri(n)}function yh(n,e){const t=n.copy();return t.index_=e,t}function mr(n){const e={};if(n.isDefault())return e;let t;if(n.index_===Qe?t="$priority":n.index_===rc?t="$value":n.index_===Kt?t="$key":(ee(n.index_ instanceof oc,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=Ze(t),n.startSet_){const i=n.startAfterSet_?"startAfter":"startAt";e[i]=Ze(n.indexStartValue_),n.startNameSet_&&(e[i]+=","+Ze(n.indexStartName_))}if(n.endSet_){const i=n.endBeforeSet_?"endBefore":"endAt";e[i]=Ze(n.indexEndValue_),n.endNameSet_&&(e[i]+=","+Ze(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function gr(n){const e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;t===""&&(n.isViewFromLeft()?t="l":t="r"),e.vf=t}return n.index_!==Qe&&(e.i=n.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bi extends Ya{constructor(e,t,i,s){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=i,this.appCheckTokenProvider_=s,this.log_=_i("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:(ee(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,i,s){const o=e._path.toString();this.log_("Listen called for "+o+" "+e._queryIdentifier);const r=Bi.getListenId_(e,i),a={};this.listens_[r]=a;const l=mr(e._queryParams);this.restRequest_(o+".json",l,(c,u)=>{let d=u;if(c===404&&(d=null,c=null),c===null&&this.onDataUpdate_(o,d,!1,i),Rn(this.listens_,r)===a){let f;c?c===401?f="permission_denied":f="rest_error:"+c:f="ok",s(f,null)}})}unlisten(e,t){const i=Bi.getListenId_(e,t);delete this.listens_[i]}get(e){const t=mr(e._queryParams),i=e._path.toString(),s=new Xi;return this.restRequest_(i+".json",t,(o,r)=>{let a=r;o===404&&(a=null,o=null),o===null?(this.onDataUpdate_(i,a,!1,null),s.resolve(a)):s.reject(new Error(a))}),s.promise}refreshAuthToken(e){}restRequest_(e,t={},i){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([s,o])=>{s&&s.accessToken&&(t.auth=s.accessToken),o&&o.token&&(t.ac=o.token);const r=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+Ju(t);this.log_("Sending REST request for "+r);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(i&&a.readyState===4){this.log_("REST Response for "+r+" received. status:",a.status,"response:",a.responseText);let l=null;if(a.status>=200&&a.status<300){try{l=ei(a.responseText)}catch{mt("Failed to parse JSON response for "+r+": "+a.responseText)}i(null,l)}else a.status!==401&&a.status!==404&&mt("Got unsuccessful REST response for "+r+" Status: "+a.status),i(a.status);i=null}},a.open("GET",r,!0),a.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wh{constructor(){this.rootNode_=_e.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qi(){return{value:null,children:new Map}}function ac(n,e,t){if(Ie(e))n.value=t,n.children.clear();else if(n.value!==null)n.value=n.value.updateChild(e,t);else{const i=Te(e);n.children.has(i)||n.children.set(i,qi());const s=n.children.get(i);e=Ge(e),ac(s,e,t)}}function zs(n,e,t){n.value!==null?t(e,n.value):kh(n,(i,s)=>{const o=new ze(e.toString()+"/"+i);zs(s,o,t)})}function kh(n,e){n.children.forEach((t,i)=>{e(i,t)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ch{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&gt(this.last_,(i,s)=>{t[i]=t[i]-s}),this.last_=e,t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const br=10*1e3,Eh=30*1e3,Sh=5*60*1e3;class Ih{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new Ch(e);const i=br+(Eh-br)*Math.random();Xn(this.reportStats_.bind(this),Math.floor(i))}reportStats_(){const e=this.statsListener_.get(),t={};let i=!1;gt(e,(s,o)=>{o>0&&Lt(this.statsToReport_,s)&&(t[s]=o,i=!0)}),i&&this.server_.reportStats(t),Xn(this.reportStats_.bind(this),Math.floor(Math.random()*2*Sh))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var St;(function(n){n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(St||(St={}));function cc(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function mo(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function go(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ji{constructor(e,t,i){this.path=e,this.affectedTree=t,this.revert=i,this.type=St.ACK_USER_WRITE,this.source=cc()}operationForChild(e){if(Ie(this.path)){if(this.affectedTree.value!=null)return ee(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new ze(e));return new ji(Le(),t,this.revert)}}else return ee(Te(this.path)===e,"operationForChild called for unrelated child."),new ji(Ge(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class li{constructor(e,t){this.source=e,this.path=t,this.type=St.LISTEN_COMPLETE}operationForChild(e){return Ie(this.path)?new li(this.source,Le()):new li(this.source,Ge(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _n{constructor(e,t,i){this.source=e,this.path=t,this.snap=i,this.type=St.OVERWRITE}operationForChild(e){return Ie(this.path)?new _n(this.source,Le(),this.snap.getImmediateChild(e)):new _n(this.source,Ge(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ai{constructor(e,t,i){this.source=e,this.path=t,this.children=i,this.type=St.MERGE}operationForChild(e){if(Ie(this.path)){const t=this.children.subtree(new ze(e));return t.isEmpty()?null:t.value?new _n(this.source,Le(),t.value):new ai(this.source,Le(),t)}else return ee(Te(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new ai(this.source,Ge(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $t{constructor(e,t,i){this.node_=e,this.fullyInitialized_=t,this.filtered_=i}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(Ie(e))return this.isFullyInitialized()&&!this.filtered_;const t=Te(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Th{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function Nh(n,e,t,i){const s=[],o=[];return e.forEach(r=>{r.type==="child_changed"&&n.index_.indexedValueChanged(r.oldSnap,r.snapshotNode)&&o.push(gh(r.childName,r.snapshotNode))}),Yn(n,s,"child_removed",e,i,t),Yn(n,s,"child_added",e,i,t),Yn(n,s,"child_moved",o,i,t),Yn(n,s,"child_changed",e,i,t),Yn(n,s,"value",e,i,t),s}function Yn(n,e,t,i,s,o){const r=i.filter(a=>a.type===t);r.sort((a,l)=>Dh(n,a,l)),r.forEach(a=>{const l=Oh(n,a,o);s.forEach(c=>{c.respondsTo(a.type)&&e.push(c.createEvent(l,n.query_))})})}function Oh(n,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}function Dh(n,e,t){if(e.childName==null||t.childName==null)throw qn("Should only compare child_ events.");const i=new Ee(e.childName,e.snapshotNode),s=new Ee(t.childName,t.snapshotNode);return n.index_.compare(i,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xi(n,e){return{eventCache:n,serverCache:e}}function Jn(n,e,t,i){return xi(new $t(e,t,i),n.serverCache)}function uc(n,e,t,i){return xi(n.eventCache,new $t(e,t,i))}function zi(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function pn(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Es;const Rh=()=>(Es||(Es=new pt(gf)),Es);class Ve{constructor(e,t=Rh()){this.value=e,this.children=t}static fromObject(e){let t=new Ve(null);return gt(e,(i,s)=>{t=t.set(new ze(i),s)}),t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:Le(),value:this.value};if(Ie(e))return null;{const i=Te(e),s=this.children.get(i);if(s!==null){const o=s.findRootMostMatchingPathAndValue(Ge(e),t);return o!=null?{path:xe(new ze(i),o.path),value:o.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(Ie(e))return this;{const t=Te(e),i=this.children.get(t);return i!==null?i.subtree(Ge(e)):new Ve(null)}}set(e,t){if(Ie(e))return new Ve(t,this.children);{const i=Te(e),o=(this.children.get(i)||new Ve(null)).set(Ge(e),t),r=this.children.insert(i,o);return new Ve(this.value,r)}}remove(e){if(Ie(e))return this.children.isEmpty()?new Ve(null):new Ve(null,this.children);{const t=Te(e),i=this.children.get(t);if(i){const s=i.remove(Ge(e));let o;return s.isEmpty()?o=this.children.remove(t):o=this.children.insert(t,s),this.value===null&&o.isEmpty()?new Ve(null):new Ve(this.value,o)}else return this}}get(e){if(Ie(e))return this.value;{const t=Te(e),i=this.children.get(t);return i?i.get(Ge(e)):null}}setTree(e,t){if(Ie(e))return t;{const i=Te(e),o=(this.children.get(i)||new Ve(null)).setTree(Ge(e),t);let r;return o.isEmpty()?r=this.children.remove(i):r=this.children.insert(i,o),new Ve(this.value,r)}}fold(e){return this.fold_(Le(),e)}fold_(e,t){const i={};return this.children.inorderTraversal((s,o)=>{i[s]=o.fold_(xe(e,s),t)}),t(e,this.value,i)}findOnPath(e,t){return this.findOnPath_(e,Le(),t)}findOnPath_(e,t,i){const s=this.value?i(t,this.value):!1;if(s)return s;if(Ie(e))return null;{const o=Te(e),r=this.children.get(o);return r?r.findOnPath_(Ge(e),xe(t,o),i):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,Le(),t)}foreachOnPath_(e,t,i){if(Ie(e))return this;{this.value&&i(t,this.value);const s=Te(e),o=this.children.get(s);return o?o.foreachOnPath_(Ge(e),xe(t,s),i):new Ve(null)}}foreach(e){this.foreach_(Le(),e)}foreach_(e,t){this.children.inorderTraversal((i,s)=>{s.foreach_(xe(e,i),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,i)=>{i.value&&e(t,i.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class It{constructor(e){this.writeTree_=e}static empty(){return new It(new Ve(null))}}function Zn(n,e,t){if(Ie(e))return new It(new Ve(t));{const i=n.writeTree_.findRootMostValueAndPath(e);if(i!=null){const s=i.path;let o=i.value;const r=ut(s,e);return o=o.updateChild(r,t),new It(n.writeTree_.set(s,o))}else{const s=new Ve(t),o=n.writeTree_.setTree(e,s);return new It(o)}}}function vr(n,e,t){let i=n;return gt(t,(s,o)=>{i=Zn(i,xe(e,s),o)}),i}function yr(n,e){if(Ie(e))return It.empty();{const t=n.writeTree_.setTree(e,new Ve(null));return new It(t)}}function Ws(n,e){return gn(n,e)!=null}function gn(n,e){const t=n.writeTree_.findRootMostValueAndPath(e);return t!=null?n.writeTree_.get(t.path).getChild(ut(t.path,e)):null}function wr(n){const e=[],t=n.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(Qe,(i,s)=>{e.push(new Ee(i,s))}):n.writeTree_.children.inorderTraversal((i,s)=>{s.value!=null&&e.push(new Ee(i,s.value))}),e}function Yt(n,e){if(Ie(e))return n;{const t=gn(n,e);return t!=null?new It(new Ve(t)):new It(n.writeTree_.subtree(e))}}function Hs(n){return n.writeTree_.isEmpty()}function Pn(n,e){return dc(Le(),n.writeTree_,e)}function dc(n,e,t){if(e.value!=null)return t.updateChild(n,e.value);{let i=null;return e.children.inorderTraversal((s,o)=>{s===".priority"?(ee(o.value!==null,"Priority writes must always be leaf nodes"),i=o.value):t=dc(xe(n,s),o,t)}),!t.getChild(n).isEmpty()&&i!==null&&(t=t.updateChild(xe(n,".priority"),i)),t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $i(n,e){return pc(e,n)}function Ah(n,e,t,i,s){ee(i>n.lastWriteId,"Stacking an older write on top of newer ones"),s===void 0&&(s=!0),n.allWrites.push({path:e,snap:t,writeId:i,visible:s}),s&&(n.visibleWrites=Zn(n.visibleWrites,e,t)),n.lastWriteId=i}function Ph(n,e){for(let t=0;t<n.allWrites.length;t++){const i=n.allWrites[t];if(i.writeId===e)return i}return null}function Mh(n,e){const t=n.allWrites.findIndex(a=>a.writeId===e);ee(t>=0,"removeWrite called with nonexistent writeId.");const i=n.allWrites[t];n.allWrites.splice(t,1);let s=i.visible,o=!1,r=n.allWrites.length-1;for(;s&&r>=0;){const a=n.allWrites[r];a.visible&&(r>=t&&Lh(a,i.path)?s=!1:Et(i.path,a.path)&&(o=!0)),r--}if(s){if(o)return Fh(n),!0;if(i.snap)n.visibleWrites=yr(n.visibleWrites,i.path);else{const a=i.children;gt(a,l=>{n.visibleWrites=yr(n.visibleWrites,xe(i.path,l))})}return!0}else return!1}function Lh(n,e){if(n.snap)return Et(n.path,e);for(const t in n.children)if(n.children.hasOwnProperty(t)&&Et(xe(n.path,t),e))return!0;return!1}function Fh(n){n.visibleWrites=fc(n.allWrites,Bh,Le()),n.allWrites.length>0?n.lastWriteId=n.allWrites[n.allWrites.length-1].writeId:n.lastWriteId=-1}function Bh(n){return n.visible}function fc(n,e,t){let i=It.empty();for(let s=0;s<n.length;++s){const o=n[s];if(e(o)){const r=o.path;let a;if(o.snap)Et(t,r)?(a=ut(t,r),i=Zn(i,a,o.snap)):Et(r,t)&&(a=ut(r,t),i=Zn(i,Le(),o.snap.getChild(a)));else if(o.children){if(Et(t,r))a=ut(t,r),i=vr(i,a,o.children);else if(Et(r,t))if(a=ut(r,t),Ie(a))i=vr(i,Le(),o.children);else{const l=Rn(o.children,Te(a));if(l){const c=l.getChild(Ge(a));i=Zn(i,Le(),c)}}}else throw qn("WriteRecord should have .snap or .children")}}return i}function hc(n,e,t,i,s){if(!i&&!s){const o=gn(n.visibleWrites,e);if(o!=null)return o;{const r=Yt(n.visibleWrites,e);if(Hs(r))return t;if(t==null&&!Ws(r,Le()))return null;{const a=t||_e.EMPTY_NODE;return Pn(r,a)}}}else{const o=Yt(n.visibleWrites,e);if(!s&&Hs(o))return t;if(!s&&t==null&&!Ws(o,Le()))return null;{const r=function(c){return(c.visible||s)&&(!i||!~i.indexOf(c.writeId))&&(Et(c.path,e)||Et(e,c.path))},a=fc(n.allWrites,r,e),l=t||_e.EMPTY_NODE;return Pn(a,l)}}}function qh(n,e,t){let i=_e.EMPTY_NODE;const s=gn(n.visibleWrites,e);if(s)return s.isLeafNode()||s.forEachChild(Qe,(o,r)=>{i=i.updateImmediateChild(o,r)}),i;if(t){const o=Yt(n.visibleWrites,e);return t.forEachChild(Qe,(r,a)=>{const l=Pn(Yt(o,new ze(r)),a);i=i.updateImmediateChild(r,l)}),wr(o).forEach(r=>{i=i.updateImmediateChild(r.name,r.node)}),i}else{const o=Yt(n.visibleWrites,e);return wr(o).forEach(r=>{i=i.updateImmediateChild(r.name,r.node)}),i}}function jh(n,e,t,i,s){ee(i||s,"Either existingEventSnap or existingServerSnap must exist");const o=xe(e,t);if(Ws(n.visibleWrites,o))return null;{const r=Yt(n.visibleWrites,o);return Hs(r)?s.getChild(t):Pn(r,s.getChild(t))}}function zh(n,e,t,i){const s=xe(e,t),o=gn(n.visibleWrites,s);if(o!=null)return o;if(i.isCompleteForChild(t)){const r=Yt(n.visibleWrites,s);return Pn(r,i.getNode().getImmediateChild(t))}else return null}function Wh(n,e){return gn(n.visibleWrites,e)}function Hh(n,e,t,i,s,o,r){let a;const l=Yt(n.visibleWrites,e),c=gn(l,Le());if(c!=null)a=c;else if(t!=null)a=Pn(l,t);else return[];if(a=a.withIndex(r),!a.isEmpty()&&!a.isLeafNode()){const u=[],d=r.getCompare(),f=o?a.getReverseIteratorFrom(i,r):a.getIteratorFrom(i,r);let h=f.getNext();for(;h&&u.length<s;)d(h,i)!==0&&u.push(h),h=f.getNext();return u}else return[]}function Uh(){return{visibleWrites:It.empty(),allWrites:[],lastWriteId:-1}}function Wi(n,e,t,i){return hc(n.writeTree,n.treePath,e,t,i)}function bo(n,e){return qh(n.writeTree,n.treePath,e)}function kr(n,e,t,i){return jh(n.writeTree,n.treePath,e,t,i)}function Hi(n,e){return Wh(n.writeTree,xe(n.treePath,e))}function Gh(n,e,t,i,s,o){return Hh(n.writeTree,n.treePath,e,t,i,s,o)}function vo(n,e,t){return zh(n.writeTree,n.treePath,e,t)}function _c(n,e){return pc(xe(n.treePath,e),n.writeTree)}function pc(n,e){return{treePath:n,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vh{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,i=e.childName;ee(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),ee(i!==".priority","Only non-priority child changes can be tracked.");const s=this.changeMap.get(i);if(s){const o=s.type;if(t==="child_added"&&o==="child_removed")this.changeMap.set(i,oi(i,e.snapshotNode,s.snapshotNode));else if(t==="child_removed"&&o==="child_added")this.changeMap.delete(i);else if(t==="child_removed"&&o==="child_changed")this.changeMap.set(i,si(i,s.oldSnap));else if(t==="child_changed"&&o==="child_added")this.changeMap.set(i,An(i,e.snapshotNode));else if(t==="child_changed"&&o==="child_changed")this.changeMap.set(i,oi(i,e.snapshotNode,s.oldSnap));else throw qn("Illegal combination of changes: "+e+" occurred after "+s)}else this.changeMap.set(i,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kh{getCompleteChild(e){return null}getChildAfterChild(e,t,i){return null}}const mc=new Kh;class yo{constructor(e,t,i=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=i}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const i=this.optCompleteServerCache_!=null?new $t(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return vo(this.writes_,e,i)}}getChildAfterChild(e,t,i){const s=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:pn(this.viewCache_),o=Gh(this.writes_,s,t,1,i,e);return o.length===0?null:o[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yh(n){return{filter:n}}function Qh(n,e){ee(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),ee(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}function Xh(n,e,t,i,s){const o=new Vh;let r,a;if(t.type===St.OVERWRITE){const c=t;c.source.fromUser?r=Us(n,e,c.path,c.snap,i,s,o):(ee(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered()&&!Ie(c.path),r=Ui(n,e,c.path,c.snap,i,s,a,o))}else if(t.type===St.MERGE){const c=t;c.source.fromUser?r=Zh(n,e,c.path,c.children,i,s,o):(ee(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered(),r=Gs(n,e,c.path,c.children,i,s,a,o))}else if(t.type===St.ACK_USER_WRITE){const c=t;c.revert?r=e_(n,e,c.path,i,s,o):r=xh(n,e,c.path,c.affectedTree,i,s,o)}else if(t.type===St.LISTEN_COMPLETE)r=$h(n,e,t.path,i,o);else throw qn("Unknown operation type: "+t.type);const l=o.getChanges();return Jh(e,r,l),{viewCache:r,changes:l}}function Jh(n,e,t){const i=e.eventCache;if(i.isFullyInitialized()){const s=i.getNode().isLeafNode()||i.getNode().isEmpty(),o=zi(n);(t.length>0||!n.eventCache.isFullyInitialized()||s&&!i.getNode().equals(o)||!i.getNode().getPriority().equals(o.getPriority()))&&t.push(lc(zi(e)))}}function gc(n,e,t,i,s,o){const r=e.eventCache;if(Hi(i,t)!=null)return e;{let a,l;if(Ie(t))if(ee(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const c=pn(e),u=c instanceof _e?c:_e.EMPTY_NODE,d=bo(i,u);a=n.filter.updateFullNode(e.eventCache.getNode(),d,o)}else{const c=Wi(i,pn(e));a=n.filter.updateFullNode(e.eventCache.getNode(),c,o)}else{const c=Te(t);if(c===".priority"){ee(xt(t)===1,"Can't have a priority with additional path components");const u=r.getNode();l=e.serverCache.getNode();const d=kr(i,t,u,l);d!=null?a=n.filter.updatePriority(u,d):a=r.getNode()}else{const u=Ge(t);let d;if(r.isCompleteForChild(c)){l=e.serverCache.getNode();const f=kr(i,t,r.getNode(),l);f!=null?d=r.getNode().getImmediateChild(c).updateChild(u,f):d=r.getNode().getImmediateChild(c)}else d=vo(i,c,e.serverCache);d!=null?a=n.filter.updateChild(r.getNode(),c,d,u,s,o):a=r.getNode()}}return Jn(e,a,r.isFullyInitialized()||Ie(t),n.filter.filtersNodes())}}function Ui(n,e,t,i,s,o,r,a){const l=e.serverCache;let c;const u=r?n.filter:n.filter.getIndexedFilter();if(Ie(t))c=u.updateFullNode(l.getNode(),i,null);else if(u.filtersNodes()&&!l.isFiltered()){const h=l.getNode().updateChild(t,i);c=u.updateFullNode(l.getNode(),h,null)}else{const h=Te(t);if(!l.isCompleteForPath(t)&&xt(t)>1)return e;const _=Ge(t),v=l.getNode().getImmediateChild(h).updateChild(_,i);h===".priority"?c=u.updatePriority(l.getNode(),v):c=u.updateChild(l.getNode(),h,v,_,mc,null)}const d=uc(e,c,l.isFullyInitialized()||Ie(t),u.filtersNodes()),f=new yo(s,d,o);return gc(n,d,t,s,f,a)}function Us(n,e,t,i,s,o,r){const a=e.eventCache;let l,c;const u=new yo(s,e,o);if(Ie(t))c=n.filter.updateFullNode(e.eventCache.getNode(),i,r),l=Jn(e,c,!0,n.filter.filtersNodes());else{const d=Te(t);if(d===".priority")c=n.filter.updatePriority(e.eventCache.getNode(),i),l=Jn(e,c,a.isFullyInitialized(),a.isFiltered());else{const f=Ge(t),h=a.getNode().getImmediateChild(d);let _;if(Ie(f))_=i;else{const g=u.getCompleteChild(d);g!=null?Xa(f)===".priority"&&g.getChild(Za(f)).isEmpty()?_=g:_=g.updateChild(f,i):_=_e.EMPTY_NODE}if(h.equals(_))l=e;else{const g=n.filter.updateChild(a.getNode(),d,_,f,u,r);l=Jn(e,g,a.isFullyInitialized(),n.filter.filtersNodes())}}}return l}function Cr(n,e){return n.eventCache.isCompleteForChild(e)}function Zh(n,e,t,i,s,o,r){let a=e;return i.foreach((l,c)=>{const u=xe(t,l);Cr(e,Te(u))&&(a=Us(n,a,u,c,s,o,r))}),i.foreach((l,c)=>{const u=xe(t,l);Cr(e,Te(u))||(a=Us(n,a,u,c,s,o,r))}),a}function Er(n,e,t){return t.foreach((i,s)=>{e=e.updateChild(i,s)}),e}function Gs(n,e,t,i,s,o,r,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let l=e,c;Ie(t)?c=i:c=new Ve(null).setTree(t,i);const u=e.serverCache.getNode();return c.children.inorderTraversal((d,f)=>{if(u.hasChild(d)){const h=e.serverCache.getNode().getImmediateChild(d),_=Er(n,h,f);l=Ui(n,l,new ze(d),_,s,o,r,a)}}),c.children.inorderTraversal((d,f)=>{const h=!e.serverCache.isCompleteForChild(d)&&f.value===null;if(!u.hasChild(d)&&!h){const _=e.serverCache.getNode().getImmediateChild(d),g=Er(n,_,f);l=Ui(n,l,new ze(d),g,s,o,r,a)}}),l}function xh(n,e,t,i,s,o,r){if(Hi(s,t)!=null)return e;const a=e.serverCache.isFiltered(),l=e.serverCache;if(i.value!=null){if(Ie(t)&&l.isFullyInitialized()||l.isCompleteForPath(t))return Ui(n,e,t,l.getNode().getChild(t),s,o,a,r);if(Ie(t)){let c=new Ve(null);return l.getNode().forEachChild(Kt,(u,d)=>{c=c.set(new ze(u),d)}),Gs(n,e,t,c,s,o,a,r)}else return e}else{let c=new Ve(null);return i.foreach((u,d)=>{const f=xe(t,u);l.isCompleteForPath(f)&&(c=c.set(u,l.getNode().getChild(f)))}),Gs(n,e,t,c,s,o,a,r)}}function $h(n,e,t,i,s){const o=e.serverCache,r=uc(e,o.getNode(),o.isFullyInitialized()||Ie(t),o.isFiltered());return gc(n,r,t,i,mc,s)}function e_(n,e,t,i,s,o){let r;if(Hi(i,t)!=null)return e;{const a=new yo(i,e,s),l=e.eventCache.getNode();let c;if(Ie(t)||Te(t)===".priority"){let u;if(e.serverCache.isFullyInitialized())u=Wi(i,pn(e));else{const d=e.serverCache.getNode();ee(d instanceof _e,"serverChildren would be complete if leaf node"),u=bo(i,d)}u=u,c=n.filter.updateFullNode(l,u,o)}else{const u=Te(t);let d=vo(i,u,e.serverCache);d==null&&e.serverCache.isCompleteForChild(u)&&(d=l.getImmediateChild(u)),d!=null?c=n.filter.updateChild(l,u,d,Ge(t),a,o):e.eventCache.getNode().hasChild(u)?c=n.filter.updateChild(l,u,_e.EMPTY_NODE,Ge(t),a,o):c=l,c.isEmpty()&&e.serverCache.isFullyInitialized()&&(r=Wi(i,pn(e)),r.isLeafNode()&&(c=n.filter.updateFullNode(c,r,o)))}return r=e.serverCache.isFullyInitialized()||Hi(i,Le())!=null,Jn(e,c,r,n.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t_{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const i=this.query_._queryParams,s=new _o(i.getIndex()),o=vh(i);this.processor_=Yh(o);const r=t.serverCache,a=t.eventCache,l=s.updateFullNode(_e.EMPTY_NODE,r.getNode(),null),c=o.updateFullNode(_e.EMPTY_NODE,a.getNode(),null),u=new $t(l,r.isFullyInitialized(),s.filtersNodes()),d=new $t(c,a.isFullyInitialized(),o.filtersNodes());this.viewCache_=xi(d,u),this.eventGenerator_=new Th(this.query_)}get query(){return this.query_}}function n_(n){return n.viewCache_.serverCache.getNode()}function i_(n){return zi(n.viewCache_)}function s_(n,e){const t=pn(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!Ie(e)&&!t.getImmediateChild(Te(e)).isEmpty())?t.getChild(e):null}function Sr(n){return n.eventRegistrations_.length===0}function o_(n,e){n.eventRegistrations_.push(e)}function Ir(n,e,t){const i=[];if(t){ee(e==null,"A cancel should cancel all event registrations.");const s=n.query._path;n.eventRegistrations_.forEach(o=>{const r=o.createCancelEvent(t,s);r&&i.push(r)})}if(e){let s=[];for(let o=0;o<n.eventRegistrations_.length;++o){const r=n.eventRegistrations_[o];if(!r.matches(e))s.push(r);else if(e.hasAnyCallback()){s=s.concat(n.eventRegistrations_.slice(o+1));break}}n.eventRegistrations_=s}else n.eventRegistrations_=[];return i}function Tr(n,e,t,i){e.type===St.MERGE&&e.source.queryId!==null&&(ee(pn(n.viewCache_),"We should always have a full cache before handling merges"),ee(zi(n.viewCache_),"Missing event cache, even though we have a server cache"));const s=n.viewCache_,o=Xh(n.processor_,s,e,t,i);return Qh(n.processor_,o.viewCache),ee(o.viewCache.serverCache.isFullyInitialized()||!s.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=o.viewCache,bc(n,o.changes,o.viewCache.eventCache.getNode(),null)}function r_(n,e){const t=n.viewCache_.eventCache,i=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(Qe,(o,r)=>{i.push(An(o,r))}),t.isFullyInitialized()&&i.push(lc(t.getNode())),bc(n,i,t.getNode(),e)}function bc(n,e,t,i){const s=i?[i]:n.eventRegistrations_;return Nh(n.eventGenerator_,e,t,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Gi;class vc{constructor(){this.views=new Map}}function l_(n){ee(!Gi,"__referenceConstructor has already been defined"),Gi=n}function a_(){return ee(Gi,"Reference.ts has not been loaded"),Gi}function c_(n){return n.views.size===0}function wo(n,e,t,i){const s=e.source.queryId;if(s!==null){const o=n.views.get(s);return ee(o!=null,"SyncTree gave us an op for an invalid query."),Tr(o,e,t,i)}else{let o=[];for(const r of n.views.values())o=o.concat(Tr(r,e,t,i));return o}}function yc(n,e,t,i,s){const o=e._queryIdentifier,r=n.views.get(o);if(!r){let a=Wi(t,s?i:null),l=!1;a?l=!0:i instanceof _e?(a=bo(t,i),l=!1):(a=_e.EMPTY_NODE,l=!1);const c=xi(new $t(a,l,!1),new $t(i,s,!1));return new t_(e,c)}return r}function u_(n,e,t,i,s,o){const r=yc(n,e,i,s,o);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,r),o_(r,t),r_(r,t)}function d_(n,e,t,i){const s=e._queryIdentifier,o=[];let r=[];const a=en(n);if(s==="default")for(const[l,c]of n.views.entries())r=r.concat(Ir(c,t,i)),Sr(c)&&(n.views.delete(l),c.query._queryParams.loadsAllData()||o.push(c.query));else{const l=n.views.get(s);l&&(r=r.concat(Ir(l,t,i)),Sr(l)&&(n.views.delete(s),l.query._queryParams.loadsAllData()||o.push(l.query)))}return a&&!en(n)&&o.push(new(a_())(e._repo,e._path)),{removed:o,events:r}}function wc(n){const e=[];for(const t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function Qt(n,e){let t=null;for(const i of n.views.values())t=t||s_(i,e);return t}function kc(n,e){if(e._queryParams.loadsAllData())return es(n);{const i=e._queryIdentifier;return n.views.get(i)}}function Cc(n,e){return kc(n,e)!=null}function en(n){return es(n)!=null}function es(n){for(const e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Vi;function f_(n){ee(!Vi,"__referenceConstructor has already been defined"),Vi=n}function h_(){return ee(Vi,"Reference.ts has not been loaded"),Vi}let __=1;class Nr{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Ve(null),this.pendingWriteTree_=Uh(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function Ec(n,e,t,i,s){return Ah(n.pendingWriteTree_,e,t,i,s),s?gi(n,new _n(cc(),e,t)):[]}function an(n,e,t=!1){const i=Ph(n.pendingWriteTree_,e);if(Mh(n.pendingWriteTree_,e)){let o=new Ve(null);return i.snap!=null?o=o.set(Le(),!0):gt(i.children,r=>{o=o.set(new ze(r),!0)}),gi(n,new ji(i.path,o,t))}else return[]}function mi(n,e,t){return gi(n,new _n(mo(),e,t))}function p_(n,e,t){const i=Ve.fromObject(t);return gi(n,new ai(mo(),e,i))}function m_(n,e){return gi(n,new li(mo(),e))}function g_(n,e,t){const i=Co(n,t);if(i){const s=Eo(i),o=s.path,r=s.queryId,a=ut(o,e),l=new li(go(r),a);return So(n,o,l)}else return[]}function Sc(n,e,t,i,s=!1){const o=e._path,r=n.syncPointTree_.get(o);let a=[];if(r&&(e._queryIdentifier==="default"||Cc(r,e))){const l=d_(r,e,t,i);c_(r)&&(n.syncPointTree_=n.syncPointTree_.remove(o));const c=l.removed;if(a=l.events,!s){const u=c.findIndex(f=>f._queryParams.loadsAllData())!==-1,d=n.syncPointTree_.findOnPath(o,(f,h)=>en(h));if(u&&!d){const f=n.syncPointTree_.subtree(o);if(!f.isEmpty()){const h=w_(f);for(let _=0;_<h.length;++_){const g=h[_],v=g.query,w=Oc(n,g);n.listenProvider_.startListening(xn(v),ci(n,v),w.hashFn,w.onComplete)}}}!d&&c.length>0&&!i&&(u?n.listenProvider_.stopListening(xn(e),null):c.forEach(f=>{const h=n.queryToTagMap.get(ts(f));n.listenProvider_.stopListening(xn(f),h)}))}k_(n,c)}return a}function Ic(n,e,t,i){const s=Co(n,i);if(s!=null){const o=Eo(s),r=o.path,a=o.queryId,l=ut(r,e),c=new _n(go(a),l,t);return So(n,r,c)}else return[]}function b_(n,e,t,i){const s=Co(n,i);if(s){const o=Eo(s),r=o.path,a=o.queryId,l=ut(r,e),c=Ve.fromObject(t),u=new ai(go(a),l,c);return So(n,r,u)}else return[]}function v_(n,e,t,i=!1){const s=e._path;let o=null,r=!1;n.syncPointTree_.foreachOnPath(s,(f,h)=>{const _=ut(f,s);o=o||Qt(h,_),r=r||en(h)});let a=n.syncPointTree_.get(s);a?(r=r||en(a),o=o||Qt(a,Le())):(a=new vc,n.syncPointTree_=n.syncPointTree_.set(s,a));let l;o!=null?l=!0:(l=!1,o=_e.EMPTY_NODE,n.syncPointTree_.subtree(s).foreachChild((h,_)=>{const g=Qt(_,Le());g&&(o=o.updateImmediateChild(h,g))}));const c=Cc(a,e);if(!c&&!e._queryParams.loadsAllData()){const f=ts(e);ee(!n.queryToTagMap.has(f),"View does not exist, but we have a tag");const h=C_();n.queryToTagMap.set(f,h),n.tagToQueryMap.set(h,f)}const u=$i(n.pendingWriteTree_,s);let d=u_(a,e,t,u,o,l);if(!c&&!r&&!i){const f=kc(a,e);d=d.concat(E_(n,e,f))}return d}function ko(n,e,t){const s=n.pendingWriteTree_,o=n.syncPointTree_.findOnPath(e,(r,a)=>{const l=ut(r,e),c=Qt(a,l);if(c)return c});return hc(s,e,o,t,!0)}function y_(n,e){const t=e._path;let i=null;n.syncPointTree_.foreachOnPath(t,(c,u)=>{const d=ut(c,t);i=i||Qt(u,d)});let s=n.syncPointTree_.get(t);s?i=i||Qt(s,Le()):(s=new vc,n.syncPointTree_=n.syncPointTree_.set(t,s));const o=i!=null,r=o?new $t(i,!0,!1):null,a=$i(n.pendingWriteTree_,e._path),l=yc(s,e,a,o?r.getNode():_e.EMPTY_NODE,o);return i_(l)}function gi(n,e){return Tc(e,n.syncPointTree_,null,$i(n.pendingWriteTree_,Le()))}function Tc(n,e,t,i){if(Ie(n.path))return Nc(n,e,t,i);{const s=e.get(Le());t==null&&s!=null&&(t=Qt(s,Le()));let o=[];const r=Te(n.path),a=n.operationForChild(r),l=e.children.get(r);if(l&&a){const c=t?t.getImmediateChild(r):null,u=_c(i,r);o=o.concat(Tc(a,l,c,u))}return s&&(o=o.concat(wo(s,n,i,t))),o}}function Nc(n,e,t,i){const s=e.get(Le());t==null&&s!=null&&(t=Qt(s,Le()));let o=[];return e.children.inorderTraversal((r,a)=>{const l=t?t.getImmediateChild(r):null,c=_c(i,r),u=n.operationForChild(r);u&&(o=o.concat(Nc(u,a,l,c)))}),s&&(o=o.concat(wo(s,n,i,t))),o}function Oc(n,e){const t=e.query,i=ci(n,t);return{hashFn:()=>(n_(e)||_e.EMPTY_NODE).hash(),onComplete:s=>{if(s==="ok")return i?g_(n,t._path,i):m_(n,t._path);{const o=yf(s,t);return Sc(n,t,null,o)}}}}function ci(n,e){const t=ts(e);return n.queryToTagMap.get(t)}function ts(n){return n._path.toString()+"$"+n._queryIdentifier}function Co(n,e){return n.tagToQueryMap.get(e)}function Eo(n){const e=n.indexOf("$");return ee(e!==-1&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new ze(n.substr(0,e))}}function So(n,e,t){const i=n.syncPointTree_.get(e);ee(i,"Missing sync point for query tag that we're tracking");const s=$i(n.pendingWriteTree_,e);return wo(i,t,s,null)}function w_(n){return n.fold((e,t,i)=>{if(t&&en(t))return[es(t)];{let s=[];return t&&(s=wc(t)),gt(i,(o,r)=>{s=s.concat(r)}),s}})}function xn(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(h_())(n._repo,n._path):n}function k_(n,e){for(let t=0;t<e.length;++t){const i=e[t];if(!i._queryParams.loadsAllData()){const s=ts(i),o=n.queryToTagMap.get(s);n.queryToTagMap.delete(s),n.tagToQueryMap.delete(o)}}}function C_(){return __++}function E_(n,e,t){const i=e._path,s=ci(n,e),o=Oc(n,t),r=n.listenProvider_.startListening(xn(e),s,o.hashFn,o.onComplete),a=n.syncPointTree_.subtree(i);if(s)ee(!en(a.value),"If we're adding a query, it shouldn't be shadowed");else{const l=a.fold((c,u,d)=>{if(!Ie(c)&&u&&en(u))return[es(u).query];{let f=[];return u&&(f=f.concat(wc(u).map(h=>h.query))),gt(d,(h,_)=>{f=f.concat(_)}),f}});for(let c=0;c<l.length;++c){const u=l[c];n.listenProvider_.stopListening(xn(u),ci(n,u))}}return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Io{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new Io(t)}node(){return this.node_}}class To{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=xe(this.path_,e);return new To(this.syncTree_,t)}node(){return ko(this.syncTree_,this.path_)}}const S_=function(n){return n=n||{},n.timestamp=n.timestamp||new Date().getTime(),n},Or=function(n,e,t){if(!n||typeof n!="object")return n;if(ee(".sv"in n,"Unexpected leaf node or priority contents"),typeof n[".sv"]=="string")return I_(n[".sv"],e,t);if(typeof n[".sv"]=="object")return T_(n[".sv"],e);ee(!1,"Unexpected server value: "+JSON.stringify(n,null,2))},I_=function(n,e,t){switch(n){case"timestamp":return t.timestamp;default:ee(!1,"Unexpected server value: "+n)}},T_=function(n,e,t){n.hasOwnProperty("increment")||ee(!1,"Unexpected server value: "+JSON.stringify(n,null,2));const i=n.increment;typeof i!="number"&&ee(!1,"Unexpected increment value: "+i);const s=e.node();if(ee(s!==null&&typeof s<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!s.isLeafNode())return i;const r=s.getValue();return typeof r!="number"?i:r+i},N_=function(n,e,t,i){return No(e,new To(t,n),i)},Dc=function(n,e,t){return No(n,new Io(e),t)};function No(n,e,t){const i=n.getPriority().val(),s=Or(i,e.getImmediateChild(".priority"),t);let o;if(n.isLeafNode()){const r=n,a=Or(r.getValue(),e,t);return a!==r.getValue()||s!==r.getPriority().val()?new tt(a,it(s)):n}else{const r=n;return o=r,s!==r.getPriority().val()&&(o=o.updatePriority(new tt(s))),r.forEachChild(Qe,(a,l)=>{const c=No(l,e.getImmediateChild(a),t);c!==l&&(o=o.updateImmediateChild(a,c))}),o}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oo{constructor(e="",t=null,i={children:{},childCount:0}){this.name=e,this.parent=t,this.node=i}}function Do(n,e){let t=e instanceof ze?e:new ze(e),i=n,s=Te(t);for(;s!==null;){const o=Rn(i.node.children,s)||{children:{},childCount:0};i=new Oo(s,i,o),t=Ge(t),s=Te(t)}return i}function Wn(n){return n.node.value}function Rc(n,e){n.node.value=e,Vs(n)}function Ac(n){return n.node.childCount>0}function O_(n){return Wn(n)===void 0&&!Ac(n)}function ns(n,e){gt(n.node.children,(t,i)=>{e(new Oo(t,n,i))})}function Pc(n,e,t,i){t&&!i&&e(n),ns(n,s=>{Pc(s,e,!0,i)}),t&&i&&e(n)}function D_(n,e,t){let i=t?n:n.parent;for(;i!==null;){if(e(i))return!0;i=i.parent}return!1}function bi(n){return new ze(n.parent===null?n.name:bi(n.parent)+"/"+n.name)}function Vs(n){n.parent!==null&&R_(n.parent,n.name,n)}function R_(n,e,t){const i=O_(t),s=Lt(n.node.children,e);i&&s?(delete n.node.children[e],n.node.childCount--,Vs(n)):!i&&!s&&(n.node.children[e]=t.node,n.node.childCount++,Vs(n))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A_=/[\[\].#$\/\u0000-\u001F\u007F]/,P_=/[\[\].#$\u0000-\u001F\u007F]/,Ss=10*1024*1024,Mc=function(n){return typeof n=="string"&&n.length!==0&&!A_.test(n)},Lc=function(n){return typeof n=="string"&&n.length!==0&&!P_.test(n)},M_=function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Lc(n)},Dr=function(n){return n===null||typeof n=="string"||typeof n=="number"&&!ro(n)||n&&typeof n=="object"&&Lt(n,".sv")},Fc=function(n,e,t,i){i&&e===void 0||Ro(so(n,"value"),e,t)},Ro=function(n,e,t){const i=t instanceof ze?new $f(t,n):t;if(e===void 0)throw new Error(n+"contains undefined "+on(i));if(typeof e=="function")throw new Error(n+"contains a function "+on(i)+" with contents = "+e.toString());if(ro(e))throw new Error(n+"contains "+e.toString()+" "+on(i));if(typeof e=="string"&&e.length>Ss/3&&Ji(e)>Ss)throw new Error(n+"contains a string greater than "+Ss+" utf8 bytes "+on(i)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let s=!1,o=!1;if(gt(e,(r,a)=>{if(r===".value")s=!0;else if(r!==".priority"&&r!==".sv"&&(o=!0,!Mc(r)))throw new Error(n+" contains an invalid key ("+r+") "+on(i)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);eh(i,r),Ro(n,a,i),th(i)}),s&&o)throw new Error(n+' contains ".value" child '+on(i)+" in addition to actual children.")}},Bc=function(n,e,t,i){if(!(i&&t===void 0)&&!Lc(t))throw new Error(so(n,e)+'was an invalid path = "'+t+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},L_=function(n,e,t,i){t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),Bc(n,e,t,i)},Ao=function(n,e){if(Te(e)===".info")throw new Error(n+" failed = Can't modify data under /.info/")},F_=function(n,e){const t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!Mc(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!M_(t))throw new Error(so(n,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B_{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function qc(n,e){let t=null;for(let i=0;i<e.length;i++){const s=e[i],o=s.getPath();t!==null&&!xa(o,t.path)&&(n.eventLists_.push(t),t=null),t===null&&(t={events:[],path:o}),t.events.push(s)}t&&n.eventLists_.push(t)}function Pt(n,e,t){qc(n,t),q_(n,i=>Et(i,e)||Et(e,i))}function q_(n,e){n.recursionDepth_++;let t=!0;for(let i=0;i<n.eventLists_.length;i++){const s=n.eventLists_[i];if(s){const o=s.path;e(o)?(j_(n.eventLists_[i]),n.eventLists_[i]=null):t=!1}}t&&(n.eventLists_=[]),n.recursionDepth_--}function j_(n){for(let e=0;e<n.events.length;e++){const t=n.events[e];if(t!==null){n.events[e]=null;const i=t.getEventRunner();un&&lt("event: "+t.toString()),zn(i)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z_="repo_interrupt",W_=25;class H_{constructor(e,t,i,s){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=i,this.appCheckProvider_=s,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new B_,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=qi(),this.transactionQueueTree_=new Oo,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function U_(n,e,t){if(n.stats_=co(n.repoInfo_),n.forceRestClient_||Ef())n.server_=new Bi(n.repoInfo_,(i,s,o,r)=>{Rr(n,i,s,o,r)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>Ar(n,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Ze(t)}catch(i){throw new Error("Invalid authOverride provided: "+i)}}n.persistentConnection_=new qt(n.repoInfo_,e,(i,s,o,r)=>{Rr(n,i,s,o,r)},i=>{Ar(n,i)},i=>{G_(n,i)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(i=>{n.server_.refreshAuthToken(i)}),n.appCheckProvider_.addTokenChangeListener(i=>{n.server_.refreshAppCheckToken(i.token)}),n.statsReporter_=Of(n.repoInfo_,()=>new Ih(n.stats_,n.server_)),n.infoData_=new wh,n.infoSyncTree_=new Nr({startListening:(i,s,o,r)=>{let a=[];const l=n.infoData_.getNode(i._path);return l.isEmpty()||(a=mi(n.infoSyncTree_,i._path,l),setTimeout(()=>{r("ok")},0)),a},stopListening:()=>{}}),Mo(n,"connected",!1),n.serverSyncTree_=new Nr({startListening:(i,s,o,r)=>(n.server_.listen(i,o,s,(a,l)=>{const c=r(a,l);Pt(n.eventQueue_,i._path,c)}),[]),stopListening:(i,s)=>{n.server_.unlisten(i,s)}})}function jc(n){const t=n.infoData_.getNode(new ze(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function Po(n){return S_({timestamp:jc(n)})}function Rr(n,e,t,i,s){n.dataUpdateCount++;const o=new ze(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let r=[];if(s)if(i){const l=Ri(t,c=>it(c));r=b_(n.serverSyncTree_,o,l,s)}else{const l=it(t);r=Ic(n.serverSyncTree_,o,l,s)}else if(i){const l=Ri(t,c=>it(c));r=p_(n.serverSyncTree_,o,l)}else{const l=it(t);r=mi(n.serverSyncTree_,o,l)}let a=o;r.length>0&&(a=ss(n,o)),Pt(n.eventQueue_,a,r)}function Ar(n,e){Mo(n,"connected",e),e===!1&&Y_(n)}function G_(n,e){gt(e,(t,i)=>{Mo(n,t,i)})}function Mo(n,e,t){const i=new ze("/.info/"+e),s=it(t);n.infoData_.updateSnapshot(i,s);const o=mi(n.infoSyncTree_,i,s);Pt(n.eventQueue_,i,o)}function zc(n){return n.nextWriteId_++}function V_(n,e,t){const i=y_(n.serverSyncTree_,e);return i!=null?Promise.resolve(i):n.server_.get(e).then(s=>{const o=it(s).withIndex(e._queryParams.getIndex());v_(n.serverSyncTree_,e,t,!0);let r;if(e._queryParams.loadsAllData())r=mi(n.serverSyncTree_,e._path,o);else{const a=ci(n.serverSyncTree_,e);r=Ic(n.serverSyncTree_,e._path,o,a)}return Pt(n.eventQueue_,e._path,r),Sc(n.serverSyncTree_,e,t,null,!0),o},s=>(is(n,"get for query "+Ze(e)+" failed: "+s),Promise.reject(new Error(s))))}function K_(n,e,t,i,s){is(n,"set",{path:e.toString(),value:t,priority:i});const o=Po(n),r=it(t,i),a=ko(n.serverSyncTree_,e),l=Dc(r,a,o),c=zc(n),u=Ec(n.serverSyncTree_,e,l,c,!0);qc(n.eventQueue_,u),n.server_.put(e.toString(),r.val(!0),(f,h)=>{const _=f==="ok";_||mt("set at "+e+" failed: "+f);const g=an(n.serverSyncTree_,c,!_);Pt(n.eventQueue_,e,g),X_(n,s,f,h)});const d=Vc(n,e);ss(n,d),Pt(n.eventQueue_,d,[])}function Y_(n){is(n,"onDisconnectEvents");const e=Po(n),t=qi();zs(n.onDisconnect_,Le(),(s,o)=>{const r=N_(s,o,n.serverSyncTree_,e);ac(t,s,r)});let i=[];zs(t,Le(),(s,o)=>{i=i.concat(mi(n.serverSyncTree_,s,o));const r=Vc(n,s);ss(n,r)}),n.onDisconnect_=qi(),Pt(n.eventQueue_,Le(),i)}function Q_(n){n.persistentConnection_&&n.persistentConnection_.interrupt(z_)}function is(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),lt(t,...e)}function X_(n,e,t,i){e&&zn(()=>{if(t==="ok")e(null);else{const s=(t||"error").toUpperCase();let o=s;i&&(o+=": "+i);const r=new Error(o);r.code=s,e(r)}})}function Wc(n,e,t){return ko(n.serverSyncTree_,e,t)||_e.EMPTY_NODE}function Lo(n,e=n.transactionQueueTree_){if(e||os(n,e),Wn(e)){const t=Uc(n,e);ee(t.length>0,"Sending zero length transaction queue"),t.every(s=>s.status===0)&&J_(n,bi(e),t)}else Ac(e)&&ns(e,t=>{Lo(n,t)})}function J_(n,e,t){const i=t.map(c=>c.currentWriteId),s=Wc(n,e,i);let o=s;const r=s.hash();for(let c=0;c<t.length;c++){const u=t[c];ee(u.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=1,u.retryCount++;const d=ut(e,u.path);o=o.updateChild(d,u.currentOutputSnapshotRaw)}const a=o.val(!0),l=e;n.server_.put(l.toString(),a,c=>{is(n,"transaction put response",{path:l.toString(),status:c});let u=[];if(c==="ok"){const d=[];for(let f=0;f<t.length;f++)t[f].status=2,u=u.concat(an(n.serverSyncTree_,t[f].currentWriteId)),t[f].onComplete&&d.push(()=>t[f].onComplete(null,!0,t[f].currentOutputSnapshotResolved)),t[f].unwatcher();os(n,Do(n.transactionQueueTree_,e)),Lo(n,n.transactionQueueTree_),Pt(n.eventQueue_,e,u);for(let f=0;f<d.length;f++)zn(d[f])}else{if(c==="datastale")for(let d=0;d<t.length;d++)t[d].status===3?t[d].status=4:t[d].status=0;else{mt("transaction at "+l.toString()+" failed: "+c);for(let d=0;d<t.length;d++)t[d].status=4,t[d].abortReason=c}ss(n,e)}},r)}function ss(n,e){const t=Hc(n,e),i=bi(t),s=Uc(n,t);return Z_(n,s,i),i}function Z_(n,e,t){if(e.length===0)return;const i=[];let s=[];const r=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){const l=e[a],c=ut(t,l.path);let u=!1,d;if(ee(c!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),l.status===4)u=!0,d=l.abortReason,s=s.concat(an(n.serverSyncTree_,l.currentWriteId,!0));else if(l.status===0)if(l.retryCount>=W_)u=!0,d="maxretry",s=s.concat(an(n.serverSyncTree_,l.currentWriteId,!0));else{const f=Wc(n,l.path,r);l.currentInputSnapshot=f;const h=e[a].update(f.val());if(h!==void 0){Ro("transaction failed: Data returned ",h,l.path);let _=it(h);typeof h=="object"&&h!=null&&Lt(h,".priority")||(_=_.updatePriority(f.getPriority()));const v=l.currentWriteId,w=Po(n),k=Dc(_,f,w);l.currentOutputSnapshotRaw=_,l.currentOutputSnapshotResolved=k,l.currentWriteId=zc(n),r.splice(r.indexOf(v),1),s=s.concat(Ec(n.serverSyncTree_,l.path,k,l.currentWriteId,l.applyLocally)),s=s.concat(an(n.serverSyncTree_,v,!0))}else u=!0,d="nodata",s=s.concat(an(n.serverSyncTree_,l.currentWriteId,!0))}Pt(n.eventQueue_,t,s),s=[],u&&(e[a].status=2,function(f){setTimeout(f,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(d==="nodata"?i.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):i.push(()=>e[a].onComplete(new Error(d),!1,null))))}os(n,n.transactionQueueTree_);for(let a=0;a<i.length;a++)zn(i[a]);Lo(n,n.transactionQueueTree_)}function Hc(n,e){let t,i=n.transactionQueueTree_;for(t=Te(e);t!==null&&Wn(i)===void 0;)i=Do(i,t),e=Ge(e),t=Te(e);return i}function Uc(n,e){const t=[];return Gc(n,e,t),t.sort((i,s)=>i.order-s.order),t}function Gc(n,e,t){const i=Wn(e);if(i)for(let s=0;s<i.length;s++)t.push(i[s]);ns(e,s=>{Gc(n,s,t)})}function os(n,e){const t=Wn(e);if(t){let i=0;for(let s=0;s<t.length;s++)t[s].status!==2&&(t[i]=t[s],i++);t.length=i,Rc(e,t.length>0?t:void 0)}ns(e,i=>{os(n,i)})}function Vc(n,e){const t=bi(Hc(n,e)),i=Do(n.transactionQueueTree_,e);return D_(i,s=>{Is(n,s)}),Is(n,i),Pc(i,s=>{Is(n,s)}),t}function Is(n,e){const t=Wn(e);if(t){const i=[];let s=[],o=-1;for(let r=0;r<t.length;r++)t[r].status===3||(t[r].status===1?(ee(o===r-1,"All SENT items should be at beginning of queue."),o=r,t[r].status=3,t[r].abortReason="set"):(ee(t[r].status===0,"Unexpected transaction status in abort"),t[r].unwatcher(),s=s.concat(an(n.serverSyncTree_,t[r].currentWriteId,!0)),t[r].onComplete&&i.push(t[r].onComplete.bind(null,new Error("set"),!1,null))));o===-1?Rc(e,void 0):t.length=o+1,Pt(n.eventQueue_,bi(e),s);for(let r=0;r<i.length;r++)zn(i[r])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x_(n){let e="";const t=n.split("/");for(let i=0;i<t.length;i++)if(t[i].length>0){let s=t[i];try{s=decodeURIComponent(s.replace(/\+/g," "))}catch{}e+="/"+s}return e}function $_(n){const e={};n.charAt(0)==="?"&&(n=n.substring(1));for(const t of n.split("&")){if(t.length===0)continue;const i=t.split("=");i.length===2?e[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):mt(`Invalid query segment '${t}' in query '${n}'`)}return e}const Pr=function(n,e){const t=ep(n),i=t.namespace;t.domain==="firebase.com"&&jt(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!i||i==="undefined")&&t.domain!=="localhost"&&jt("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||pf();const s=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new za(t.host,t.secure,i,s,e,"",i!==t.subdomain),path:new ze(t.pathString)}},ep=function(n){let e="",t="",i="",s="",o="",r=!0,a="https",l=443;if(typeof n=="string"){let c=n.indexOf("//");c>=0&&(a=n.substring(0,c-1),n=n.substring(c+2));let u=n.indexOf("/");u===-1&&(u=n.length);let d=n.indexOf("?");d===-1&&(d=n.length),e=n.substring(0,Math.min(u,d)),u<d&&(s=x_(n.substring(u,d)));const f=$_(n.substring(Math.min(n.length,d)));c=e.indexOf(":"),c>=0?(r=a==="https"||a==="wss",l=parseInt(e.substring(c+1),10)):c=e.length;const h=e.slice(0,c);if(h.toLowerCase()==="localhost")t="localhost";else if(h.split(".").length<=2)t=h;else{const _=e.indexOf(".");i=e.substring(0,_).toLowerCase(),t=e.substring(_+1),o=i}"ns"in f&&(o=f.ns)}return{host:e,port:l,domain:t,subdomain:i,secure:r,scheme:a,pathString:s,namespace:o}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mr="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",tp=function(){let n=0;const e=[];return function(t){const i=t===n;n=t;let s;const o=new Array(8);for(s=7;s>=0;s--)o[s]=Mr.charAt(t%64),t=Math.floor(t/64);ee(t===0,"Cannot push at time == 0");let r=o.join("");if(i){for(s=11;s>=0&&e[s]===63;s--)e[s]=0;e[s]++}else for(s=0;s<12;s++)e[s]=Math.floor(Math.random()*64);for(s=0;s<12;s++)r+=Mr.charAt(e[s]);return ee(r.length===20,"nextPushId: Length should be 20."),r}}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class np{constructor(e,t,i,s){this.eventType=e,this.eventRegistration=t,this.snapshot=i,this.prevName=s}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+Ze(this.snapshot.exportVal())}}class ip{constructor(e,t,i){this.eventRegistration=e,this.error=t,this.path=i}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sp{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return ee(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rs{constructor(e,t,i,s){this._repo=e,this._path=t,this._queryParams=i,this._orderByCalled=s}get key(){return Ie(this._path)?null:Xa(this._path)}get ref(){return new Wt(this._repo,this._path)}get _queryIdentifier(){const e=gr(this._queryParams),t=lo(e);return t==="{}"?"default":t}get _queryObject(){return gr(this._queryParams)}isEqual(e){if(e=tn(e),!(e instanceof rs))return!1;const t=this._repo===e._repo,i=xa(this._path,e._path),s=this._queryIdentifier===e._queryIdentifier;return t&&i&&s}toJSON(){return this.toString()}toString(){return this._repo.toString()+xf(this._path)}}function op(n,e){if(n._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function rp(n){let e=null,t=null;if(n.hasStart()&&(e=n.getIndexStartValue()),n.hasEnd()&&(t=n.getIndexEndValue()),n.getIndex()===Kt){const i="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",s="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(n.hasStart()){if(n.getIndexStartName()!==hn)throw new Error(i);if(typeof e!="string")throw new Error(s)}if(n.hasEnd()){if(n.getIndexEndName()!==Zt)throw new Error(i);if(typeof t!="string")throw new Error(s)}}else if(n.getIndex()===Qe){if(e!=null&&!Dr(e)||t!=null&&!Dr(t))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(ee(n.getIndex()instanceof oc||n.getIndex()===rc,"unknown index type."),e!=null&&typeof e=="object"||t!=null&&typeof t=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}class Wt extends rs{constructor(e,t){super(e,t,new po,!1)}get parent(){const e=Za(this._path);return e===null?null:new Wt(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}class ui{constructor(e,t,i){this._node=e,this.ref=t,this._index=i}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new ze(e),i=zt(this.ref,e);return new ui(this._node.getChild(t),i,Qe)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(i,s)=>e(new ui(s,zt(this.ref,i),Qe)))}hasChild(e){const t=new ze(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function Mn(n,e){return n=tn(n),n._checkNotDeleted("ref"),e!==void 0?zt(n._root,e):n._root}function zt(n,e){return n=tn(n),Te(n._path)===null?L_("child","path",e,!1):Bc("child","path",e,!1),new Wt(n._repo,xe(n._path,e))}function lp(n,e){n=tn(n),Ao("push",n._path),Fc("push",e,n._path,!0);const t=jc(n._repo),i=tp(t),s=zt(n,i),o=zt(n,i);let r;return e!=null?r=ls(o,e).then(()=>o):r=Promise.resolve(o),s.then=r.then.bind(r),s.catch=r.then.bind(r,void 0),s}function ap(n){return Ao("remove",n._path),ls(n,null)}function ls(n,e){n=tn(n),Ao("set",n._path),Fc("set",e,n._path,!1);const t=new Xi;return K_(n._repo,n._path,e,null,t.wrapCallback(()=>{})),t.promise}function Kc(n){n=tn(n);const e=new sp(()=>{}),t=new Fo(e);return V_(n._repo,n,t).then(i=>new ui(i,new Wt(n._repo,n._path),n._queryParams.getIndex()))}class Fo{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,t){const i=t._queryParams.getIndex();return new np("value",this,new ui(e.snapshotNode,new Wt(t._repo,t._path),i))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new ip(this,e,t):null}matches(e){return e instanceof Fo?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}class cp{}class up extends cp{_apply(e){op(e,"orderByKey");const t=yh(e._queryParams,Kt);return rp(t),new rs(e._repo,e._path,t,!0)}}function Yc(){return new up}function Qc(n,...e){let t=tn(n);for(const i of e)t=i._apply(t);return t}l_(Wt);f_(Wt);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dp="FIREBASE_DATABASE_EMULATOR_HOST",Ks={};let fp=!1;function hp(n,e,t,i){n.repoInfo_=new za(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0),i&&(n.authTokenProvider_=i)}function _p(n,e,t,i,s){let o=i||n.options.databaseURL;o===void 0&&(n.options.projectId||jt("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),lt("Using default host for project ",n.options.projectId),o=`${n.options.projectId}-default-rtdb.firebaseio.com`);let r=Pr(o,s),a=r.repoInfo,l,c;typeof process<"u"&&process.env&&(c=process.env[dp]),c?(l=!0,o=`http://${c}?ns=${a.namespace}`,r=Pr(o,s),a=r.repoInfo):l=!r.repoInfo.secure;const u=s&&l?new Nn(Nn.OWNER):new If(n.name,n.options,e);F_("Invalid Firebase Database URL",r),Ie(r.path)||jt("Database URL must point to the root of a Firebase Database (not including a child path).");const d=mp(a,n,u,new Sf(n.name,t));return new gp(d,n)}function pp(n,e){const t=Ks[e];(!t||t[n.key]!==n)&&jt(`Database ${e}(${n.repoInfo_}) has already been deleted.`),Q_(n),delete t[n.key]}function mp(n,e,t,i){let s=Ks[e.name];s||(s={},Ks[e.name]=s);let o=s[n.toURLString()];return o&&jt("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),o=new H_(n,fp,t,i),s[n.toURLString()]=o,o}class gp{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(U_(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Wt(this._repo,Le())),this._rootInternal}_delete(){return this._rootInternal!==null&&(pp(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&jt("Cannot call "+e+" on a deleted database.")}}function bp(n=Zd(),e){const t=Yd(n,"database").getImmediate({identifier:e});if(!t._instanceStarted){const i=ju("database");i&&vp(t,...i)}return t}function vp(n,e,t,i={}){n=tn(n),n._checkNotDeleted("useEmulator"),n._instanceStarted&&jt("Cannot call useEmulator() after instance has already been initialized.");const s=n._repoInternal;let o;if(s.repoInfo_.nodeAdmin)i.mockUserToken&&jt('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),o=new Nn(Nn.OWNER);else if(i.mockUserToken){const r=typeof i.mockUserToken=="string"?i.mockUserToken:zu(i.mockUserToken,n.app.options.projectId);o=new Nn(r)}hp(s,e,t,o)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yp(n){uf(Jd),Pi(new ti("database",(e,{instanceIdentifier:t})=>{const i=e.getProvider("app").getImmediate(),s=e.getProvider("auth-internal"),o=e.getProvider("app-check-internal");return _p(i,s,o,t)},"PUBLIC").setMultipleInstances(!0)),In(er,tr,n),In(er,tr,"esm2017")}qt.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)};qt.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)};yp();var Ys={},Xc={},as={};Object.defineProperty(as,"__esModule",{value:!0});as.rotx=void 0;function wp(n,e){return n.replace(/[a-zA-Z]/g,function(t){return String.fromCharCode((t<="Z"?90:122)>=(t=t.charCodeAt(0)+e)?t:t-26)})}as.rotx=wp;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.rotx=void 0;var e=as;Object.defineProperty(n,"rotx",{enumerable:!0,get:function(){return e.rotx}})})(Xc);var Jc={},cs={};Object.defineProperty(cs,"__esModule",{value:!0});cs.base64=void 0;class kp{encode(e){return typeof btoa>"u"?Buffer.from(e,"binary").toString("base64"):btoa(e)}decode(e){return typeof atob>"u"?Buffer.from(e,"base64").toString("binary"):atob(e)}}const Cp=new kp;cs.base64=Cp;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.base64=void 0;var e=cs;Object.defineProperty(n,"base64",{enumerable:!0,get:function(){return e.base64}})})(Jc);var Zc={},us={};Object.defineProperty(us,"__esModule",{value:!0});us.hex=void 0;class Ep{encode(e){let t="",i="";for(let s=0;s<e.length;s++)t=e.charCodeAt(s).toString(16),i+=("000"+t).slice(-4);return i}decode(e){let t=e.match(/.{1,4}/g)||[],i="";for(let s=0;s<t.length;s++)i+=String.fromCharCode(parseInt(t[s],16));return i}}const Sp=new Ep;us.hex=Sp;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.hex=void 0;var e=us;Object.defineProperty(n,"hex",{enumerable:!0,get:function(){return e.hex}})})(Zc);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.hex=n.base64=n.rotx=void 0;var e=Xc;Object.defineProperty(n,"rotx",{enumerable:!0,get:function(){return e.rotx}});var t=Jc;Object.defineProperty(n,"base64",{enumerable:!0,get:function(){return t.base64}});var i=Zc;Object.defineProperty(n,"hex",{enumerable:!0,get:function(){return i.hex}})})(Ys);let Ip={ixqSmg:"IQhiAgIPDNBgKzMmPcWG9XWqEsxI2uQ70F5X1rY",icbpLwuiqv:"nk-d3-8j3n9.nqzmjiamixx.kwu",libijiamCZT:"pbbxa://nk-d3-8j3n9-lmnictb-zblj.mczwxm-emab1.nqzmjiamlibijiam.ixx",xzwrmkbQl:"nk-d3-8j3n9",abwziomJcksmb:"nk-d3-8j3n9.ixxaxwb.kwu",umaaioqvoAmvlmzQl:"31377888705",ixxQl:"1:31377888705:emj:3018l8nk0i07m867mk0j40"},xc={};for(let[n,e]of Object.entries(Ip))xc[Ys.rotx(n,18)]=Ys.rotx(e,18);let Ot={armor:"Armor",magicDmg:"Magic",meleeDmg:"Melee",rangedDmg:"Ranged",hpRegen:"HP Regen",endurance:"Endurance",sightRange:"Sight Range",walkSpeed:"Walk Speed",jumpPower:"Jump Power",ammoReturn:"Ammo Return",height:"Height"},Ln=["head","body","legs","feet","neck","back","ring","misc"],ds={name:"",stats:{armor:0,magicDmg:0,meleeDmg:0,rangedDmg:0,hpRegen:0,endurance:0,sightRange:0,walkSpeed:0,jumpPower:0,ammoReturn:0,height:0},cost:{min:0,max:0},image:"",link:""},fs={name:"",info:{type:"",special:""},moves:[],cost:{min:0,max:0},image:"",link:""},Tp={armor:{min:0,avg:0,max:0},gear:{min:0,avg:0,max:0},total:{min:0,avg:0,max:0}},mn=[...Array(5).keys()].map(n=>++n),Fn=bp(Ca(xc)),Np=["head","body","legs","feet","neck","back","ring","misc","gear","sets","bonuses"],$c={0:"th",1:"st",2:"nd",3:"rd",4:"th",5:"th",6:"th",7:"th",8:"th",9:"th"};function eu(n,e){let t=!1;for(let i of[n,e])for(let s in i)if(i[s].name){t=!0;break}no.set(t),_t.set(null),window.history.replaceState(null,null,location.origin+location.pathname)}function Bo(n,e){let t=2.8,i=e.split(" ").length,s=n.querySelector("span");if(s.style.removeProperty("font-size"),i>2&&e.length/i>=5){for(;s.offsetHeight>n.offsetHeight*.75;)t-=.05,s.style.fontSize=`calc(var(--u) * ${t})`;return t<2.8}return null}function Op(n,e){let t=2.8,i=n.querySelector("span");for(i.style.removeProperty("font-size");i.offsetWidth>n.offsetWidth;)t-=.05,i.style.fontSize=`calc(var(--u) * ${t})`;for(;i.offsetHeight>n.offsetHeight*.75&&e;)t-=.05,i.style.fontSize=`calc(var(--u) * ${t})`;return t<2.8?t:null}function Dp(n){let e=2.35,t=n.querySelector(".tooltip");for(t.style.removeProperty("font-size");t.offsetHeight>n.offsetHeight*1.125;)e-=.02,t.style.fontSize=`calc(var(--u) * ${e})`}function Rp(n){document.activeElement==document.body&&n.key=="Tab"&&(n.preventDefault(),document.querySelector(`.promptCont [id*='${n.shiftKey?"last":"first"}Focusable']`).focus())}function tu(n,e){let t=n.toLowerCase();for(let i in e)i.toLowerCase().includes(t)&&!e[i].classList.contains("filtered")?e[i].classList.remove("hidden"):e[i].classList.add("hidden")}function Ki(n,e){e&&setTimeout(()=>{n.focus(),n.click(),n.select()})}function dt(n){n.shiftKey&&n.key=="Tab"&&n.preventDefault()}function ft(n){n.key=="Tab"&&!n.shiftKey&&n.preventDefault()}function Yi(n,e){let t=/[^a-zA-Z0-9~!#$%^&*()\-_+[\]{}\\|;:'",.<>/? ]/g;return n.replace(t,"").replaceAll(`
`,"").replace(/^ /,"").slice(0,e)}function Qs(n,e,t){(!n.maxLength||n.maxLength!=t)&&e.length>=t&&(n.maxLength=t)}function nu(n,e){n={...n},e={...e};for(let t of Ln)n[t]?n[t]=n[t].name:n[t]="";for(let t of mn)e[t]?e[t]=e[t].name:e[t]="";return{eq:n,gear:e}}function qo(){window.history.replaceState(null,null,location.origin+location.pathname+"?ls=true")}function Xt(n){n.target.closest("button").blur()}function Ap(n){let e,t,i,s,o,r,a,l,c,u,d,f;return{c(){e=b("li"),t=b("button"),i=b("img"),o=S(),r=b("span"),r.textContent=`${n[5]}`,a=S(),l=b("iconify-icon"),c=S(),u=b("iconify-icon"),Xe(i.src,s=n[0].image)||m(i,"src",s),m(i,"alt",""),Ae(l,"icon","maki:cross"),Ae(l,"id","cross"),Ae(u,"icon","eva:info-outline"),Ae(u,"id","info"),ne(e,"selectedItem",n[2])},m(h,_){M(h,e,_),p(e,t),p(t,i),p(t,o),p(t,r),p(t,a),p(t,l),p(t,c),p(t,u),n[20](e),d||(f=[ea(n[6].call(null,r)),D(t,"touchstart",n[9],{passive:!0}),D(t,"touchend",n[10],{passive:!0}),D(t,"mousedown",n[9]),D(t,"mouseup",n[10]),D(t,"click",n[15]),D(t,"mouseenter",n[16]),D(t,"focusin",n[17]),D(t,"mouseleave",n[18]),D(t,"focusout",n[19]),D(e,"contextmenu",Pp)],d=!0)},p(h,[_]){_&1&&!Xe(i.src,s=h[0].image)&&m(i,"src",s),_&4&&ne(e,"selectedItem",h[2])},i:le,o:le,d(h){h&&A(e),n[20](null),d=!1,we(f)}}}const Pp=n=>n.preventDefault();function Mp(n,e,t){let i,s,o,r,a,l,c;K(n,J,L=>t(4,i=L)),K(n,ct,L=>t(22,s=L)),K(n,Sn,L=>t(23,o=L)),K(n,Tt,L=>t(24,r=L)),K(n,Nt,L=>t(25,a=L)),K(n,At,L=>t(26,l=L)),K(n,to,L=>t(27,c=L));let{itemData:u,slotOpen:d,eqSlotName:f,scrolling:h}=e;const _=Mt();let g,v=!1,w=u.name,k,y=0,T;function C(L){setTimeout(()=>{Bo(g,w)&&c.push({node:g,itemName:w})})}function z(L){if(d||!d&&L.isTrusted==!1){_("itemSelect",{element:g,trusted:L.isTrusted}),g.classList.contains("selectedItem")||t(2,v=!1),t(2,v=!v),t(11,d=!1),U(Nt,a[f]=v?u:ds,a),eu(a,l);for(let F of Object.keys(Ot)){U(ct,s[F]=0,s);for(let H in a)a[H].noStats||(U(ct,s[F]+=a[H].stats[F],s),U(ct,s[F]=Math.round(s[F]*10)/10,s))}for(let F of r.bonuses)if(o[F.name])for(let H in s)U(ct,s[H]+=F.stats[H],s),U(ct,s[H]=Math.round(s[H]*10)/10,s)}}function E(){h||(U(J,i.item.ongoing=!0,i),U(J,i.item.data={...u,slot:f,type:"eq",element:g},i))}function B(){T=setInterval(()=>t(14,y+=50),50)}function j(){clearInterval(T),y>=750&&E(),t(14,y=0)}const V=L=>{L.shiftKey?E():i.item.ongoing||z(L)},N=()=>t(3,k=!0),I=()=>t(3,k=!0),O=()=>t(3,k=!1),Z=()=>t(3,k=!1);function R(L){re[L?"unshift":"push"](()=>{g=L,t(1,g)})}return n.$$set=L=>{"itemData"in L&&t(0,u=L.itemData),"slotOpen"in L&&t(11,d=L.slotOpen),"eqSlotName"in L&&t(12,f=L.eqSlotName),"scrolling"in L&&t(13,h=L.scrolling)},n.$$.update=()=>{n.$$.dirty&16384&&y==750&&_("displayInfo")},[u,g,v,k,i,w,C,z,E,B,j,d,f,h,y,V,N,I,O,Z,R]}class Lp extends Re{constructor(e){super(),De(this,e,Mp,Ap,ve,{itemData:0,slotOpen:11,eqSlotName:12,scrolling:13})}}function Fp(n){let e,t,i,s,o,r,a,l,c,u,d,f,h,_,g;return{c(){e=b("li"),t=b("button"),i=b("img"),o=S(),r=b("span"),r.textContent=`${n[6]}`,a=S(),l=b("iconify-icon"),d=S(),f=b("iconify-icon"),Xe(i.src,s=n[0].image)||m(i,"src",s),m(i,"alt",""),Ae(l,"icon",c=n[5]?"heroicons-solid:switch-vertical":"maki:cross"),Ae(l,"id",u=n[5]?"switchable":"cross"),Ae(f,"icon","eva:info-outline"),Ae(f,"id","info"),t.disabled=h=!n[4]&&!n[5],ne(e,"selectedItem",n[1]),ne(e,"non-eligible",!n[4]&&!n[5]),ne(e,"switchable",n[5])},m(v,w){M(v,e,w),p(e,t),p(t,i),p(t,o),p(t,r),p(t,a),p(t,l),p(t,d),p(t,f),n[19](e),_||(g=[ea(n[7].call(null,r)),D(t,"touchstart",n[10],{passive:!0}),D(t,"touchend",n[11],{passive:!0}),D(t,"mousedown",n[10]),D(t,"mouseup",n[11]),D(t,"click",n[18]),D(e,"contextmenu",Bp)],_=!0)},p(v,[w]){w&1&&!Xe(i.src,s=v[0].image)&&m(i,"src",s),w&32&&c!==(c=v[5]?"heroicons-solid:switch-vertical":"maki:cross")&&Ae(l,"icon",c),w&32&&u!==(u=v[5]?"switchable":"cross")&&Ae(l,"id",u),w&48&&h!==(h=!v[4]&&!v[5])&&(t.disabled=h),w&2&&ne(e,"selectedItem",v[1]),w&48&&ne(e,"non-eligible",!v[4]&&!v[5]),w&32&&ne(e,"switchable",v[5])},i:le,o:le,d(v){v&&A(e),n[19](null),_=!1,we(g)}}}const Bp=n=>n.preventDefault();function qp(n,e,t){let i,s,o,r,a;K(n,At,O=>t(17,i=O)),K(n,J,O=>t(2,s=O)),K(n,Nt,O=>t(21,o=O)),K(n,Dn,O=>t(22,r=O)),K(n,to,O=>t(23,a=O));let{itemData:l,slotOpen:c,index:u,weaponExpand:d,scrolling:f}=e;const h=Mt();let _,g=!1,v=!0,w=!1,k=l.name,y=0,T,C={"Orange Salamander":["Green Salamander","Purple Salamander"],"Green Salamander":["Orange Salamander","Purple Salamander"],"Purple Salamander":["Orange Salamander","Green Salamander"],"White Salamander":["Black Salamander","Gold Salamander"],"Black Salamander":["White Salamander","Gold Salamander"],"Gold Salamander":["White Salamander","Black Salamander"]};function z(O){setTimeout(()=>{Bo(_,k)&&a.push({node:_,itemName:k})})}function E(O){v&&(c||!c&&O.isTrusted==!1)&&(l.tool&&d&&h("toolSelect"),h("itemSelect",{element:_,trusted:O.isTrusted}),_.classList.contains("selectedItem")||t(1,g=!1),t(12,c=!1),w?setTimeout(()=>{r[u][k].querySelector("button").click(),r[Object.keys(i).find(Z=>i[Z].name==k)][i[u]&&i[u].name?i[u].name:k].querySelector("button").click(),t(4,v=!0),t(5,w=!1)},5):(t(1,g=!g),U(At,i[u]=g?l:fs,i)),eu(o,i))}function B(){f||(U(J,s.item.ongoing=!0,s),U(J,s.item.data={...l,type:"gear",element:_},s))}function j(){T=setInterval(()=>t(16,y+=50),50)}function V(){clearInterval(T),y>=750&&B(),t(16,y=0)}const N=O=>{O.shiftKey?B():s.item.ongoing||E(O)};function I(O){re[O?"unshift":"push"](()=>{_=O,t(3,_)})}return n.$$set=O=>{"itemData"in O&&t(0,l=O.itemData),"slotOpen"in O&&t(12,c=O.slotOpen),"index"in O&&t(13,u=O.index),"weaponExpand"in O&&t(14,d=O.weaponExpand),"scrolling"in O&&t(15,f=O.scrolling)},n.$$.update=()=>{if(n.$$.dirty&155650&&i)for(let O in i){if(!d&&O!=u&&i[O].name==k){t(5,w=!0);break}if(O!=u&&C[i[O].name]&&C[i[O].name].includes(k)){t(4,v=!1);break}else g||t(4,v=!0)}if(n.$$.dirty&139268)if(s.randomize.ongoing)t(5,w=!1);else for(let O in i)if(O!=u&&i[O].name==k){t(5,w=!0);break}else t(5,w=!1);n.$$.dirty&65536&&y==750&&h("displayInfo")},[l,g,s,_,v,w,k,z,E,B,j,V,c,u,d,f,y,i,N,I]}class jp extends Re{constructor(e){super(),De(this,e,qp,Fp,ve,{itemData:0,slotOpen:12,index:13,weaponExpand:14,scrolling:15})}}function zp(n){const e=n-1;return e*e*e+1}function Ke(n,{delay:e=0,duration:t=400,easing:i=Qi}={}){const s=+getComputedStyle(n).opacity;return{delay:e,duration:t,easing:i,css:o=>`opacity: ${o*s}`}}function Ye(n,{delay:e=0,duration:t=400,easing:i=zp,start:s=0,opacity:o=0}={}){const r=getComputedStyle(n),a=+r.opacity,l=r.transform==="none"?"":r.transform,c=1-s,u=a*(1-o);return{delay:e,duration:t,easing:i,css:(d,f)=>`
			transform: ${l} scale(${1-c*f});
			opacity: ${a-u*f}
		`}}function Lr(n){let e,t,i,s;return{c(){e=b("img"),Xe(e.src,t=n[5][n[3]])||m(e,"src",t),m(e,"alt","")},m(o,r){M(o,e,r),s=!0},p(o,r){(!s||r&8&&!Xe(e.src,t=o[5][o[3]]))&&m(e,"src",t)},i(o){s||(o&&ke(()=>{s&&(i||(i=be(e,Ke,{duration:150},!0)),i.run(1))}),s=!0)},o(o){o&&(i||(i=be(e,Ke,{duration:150},!1)),i.run(0)),s=!1},d(o){o&&A(e),o&&i&&i.end()}}}function Wp(n){let e,t,i=n[5][n[3]],s,o,r=n[0].name+"",a,l,c,u=Lr(n);return{c(){e=b("li"),t=b("button"),u.c(),s=S(),o=b("span"),a=ce(r),ne(e,"selectedItem",n[4])},m(d,f){M(d,e,f),p(e,t),u.m(t,null),p(t,s),p(t,o),p(o,a),n[8](e),l||(c=[D(t,"click",n[6]),D(e,"mouseenter",n[9]),D(e,"focusin",n[10]),D(e,"mouseleave",n[11]),D(e,"focusout",n[12])],l=!0)},p(d,[f]){f&8&&ve(i,i=d[5][d[3]])?(Be(),W(u,1,1,le),qe(),u=Lr(d),u.c(),P(u,1),u.m(t,s)):u.p(d,f),f&1&&r!==(r=d[0].name+"")&&Ne(a,r)},i(d){P(u)},o(d){W(u)},d(d){d&&A(e),u.d(d),n[8](null),l=!1,we(c)}}}function Hp(n,e,t){let i,s,o;K(n,On,B=>t(14,i=B)),K(n,Nt,B=>t(15,s=B)),K(n,Tt,B=>t(16,o=B));let{itemData:r,ddOpen:a=!1}=e;const l=Mt();let c,u=!1,d=!1,f,h=0,_=r.pieces.length,g=[];for(let B of r.pieces)e:for(let j of Ln)for(let V of o[j])if(V.name==B){g.push(j);break e}let v=[];for(let B=0;B<_;B++)v.push(o[g[B]].find(j=>j.name==r.pieces[B]).image);function w(){d?f=setInterval(()=>{t(3,h++,h),h==_&&t(3,h=0)},750):(clearInterval(f),t(3,h=0))}function k(){l("setSelect");let B=0;for(let j=0;j<_;j++)!s[g[j]]||s[g[j]].name!=r.pieces[j]?i[g[j]][r.pieces[j]].querySelector("button").click():B++;B!=_&&t(7,a=!1)}function y(B){re[B?"unshift":"push"](()=>{c=B,t(2,c)})}const T=()=>t(1,d=!0),C=()=>t(1,d=!0),z=()=>t(1,d=!1),E=()=>t(1,d=!1);return n.$$set=B=>{"itemData"in B&&t(0,r=B.itemData),"ddOpen"in B&&t(7,a=B.ddOpen)},n.$$.update=()=>{n.$$.dirty&2&&(d||!d)&&w()},[r,d,c,h,u,v,k,a,y,T,C,z,E]}class Up extends Re{constructor(e){super(),De(this,e,Hp,Wp,ve,{itemData:0,ddOpen:7})}}const Gp=n=>({}),Fr=n=>({});function Vp(n){let e,t,i,s,o,r,a,l,c;const u=n[8].tooltip,d=au(u,n,n[7],Fr);return{c(){e=b("div"),t=b("span"),i=S(),s=b("input"),r=S(),d&&d.c(),m(s,"id",o=n[2]?"firstFocusable":n[3]?"lastFocusable":""),s.disabled=n[4],m(s,"type","checkbox"),s.checked=n[1],m(s,"class","svelte-1oscat4"),m(e,"class","toggleCont svelte-1oscat4"),ne(e,"unavailable",n[4])},m(f,h){M(f,e,h),p(e,t),t.innerHTML=n[0],p(e,i),p(e,s),p(e,r),d&&d.m(e,null),a=!0,l||(c=[D(s,"change",n[9]),D(s,"keydown",n[10])],l=!0)},p(f,[h]){(!a||h&1)&&(t.innerHTML=f[0]),(!a||h&12&&o!==(o=f[2]?"firstFocusable":f[3]?"lastFocusable":""))&&m(s,"id",o),(!a||h&16)&&(s.disabled=f[4]),(!a||h&2)&&(s.checked=f[1]),d&&d.p&&(!a||h&128)&&uu(d,u,f,f[7],a?cu(u,f[7],h,Gp):du(f[7]),Fr),(!a||h&16)&&ne(e,"unavailable",f[4])},i(f){a||(P(d,f),a=!0)},o(f){W(d,f),a=!1},d(f){f&&A(e),d&&d.d(f),l=!1,we(c)}}}function Kp(n,e,t){let{$$slots:i={},$$scope:s}=e,{text:o,checked:r=!1,first:a=!1,last:l=!1,disabled:c=!1,forced:u=!1}=e;const d=Mt(),f=_=>{_.target.blur(),u?_.target.checked=!0:d("toggle",_.target.checked)},h=_=>{a&&dt(_),l&&ft(_),_.key=="Enter"&&!u?(_.target.checked=!_.target.checked,d("toggle",_.target.checked)):u&&(_.target.checked=!0)};return n.$$set=_=>{"text"in _&&t(0,o=_.text),"checked"in _&&t(1,r=_.checked),"first"in _&&t(2,a=_.first),"last"in _&&t(3,l=_.last),"disabled"in _&&t(4,c=_.disabled),"forced"in _&&t(5,u=_.forced),"$$scope"in _&&t(7,s=_.$$scope)},[o,r,a,l,c,u,d,s,i,f,h]}class at extends Re{constructor(e){super(),De(this,e,Kp,Vp,ve,{text:0,checked:1,first:2,last:3,disabled:4,forced:5})}}function Br(n,e,t){const i=n.slice();return i[28]=e[t][0],i[29]=e[t][1],i}function qr(n,e,t){const i=n.slice();return i[28]=e[t][0],i[29]=e[t][1],i}function jr(n){let e,t;function i(...s){return n[19](n[28],...s)}return e=new at({props:{text:n[29],checked:n[6][n[28]]}}),e.$on("toggle",i),{c(){ae(e.$$.fragment)},m(s,o){se(e,s,o),t=!0},p(s,o){n=s;const r={};o[0]&64&&(r.checked=n[6][n[28]]),e.$set(r)},i(s){t||(P(e.$$.fragment,s),t=!0)},o(s){W(e.$$.fragment,s),t=!1},d(s){oe(e,s)}}}function Yp(n){let e,t,i,s,o,r,a,l,c;s=new at({props:{text:"Descension",checked:n[4],forced:n[4]}}),s.$on("toggle",n[20]),r=new at({props:{text:"Ascension",checked:n[5],forced:n[5]}}),r.$on("toggle",n[21]);let u=Oe(Object.entries(n[9])),d=[];for(let h=0;h<u.length;h+=1)d[h]=zr(Br(n,u,h));const f=h=>W(d[h],1,1,()=>{d[h]=null});return{c(){e=b("p"),e.textContent="Sort",t=S(),i=b("div"),ae(s.$$.fragment),o=S(),ae(r.$$.fragment),a=S(),l=b("div");for(let h=0;h<d.length;h+=1)d[h].c();m(e,"id","title"),m(e,"class","svelte-1jaojxl"),m(i,"class","radio ttFocus svelte-1jaojxl"),m(i,"id","sort"),m(l,"class","options svelte-1jaojxl")},m(h,_){M(h,e,_),M(h,t,_),M(h,i,_),se(s,i,null),p(i,o),se(r,i,null),M(h,a,_),M(h,l,_);for(let g=0;g<d.length;g+=1)d[g]&&d[g].m(l,null);c=!0},p(h,_){const g={};_[0]&16&&(g.checked=h[4]),_[0]&16&&(g.forced=h[4]),s.$set(g);const v={};if(_[0]&32&&(v.checked=h[5]),_[0]&32&&(v.forced=h[5]),r.$set(v),_[0]&1664){u=Oe(Object.entries(h[9]));let w;for(w=0;w<u.length;w+=1){const k=Br(h,u,w);d[w]?(d[w].p(k,_),P(d[w],1)):(d[w]=zr(k),d[w].c(),P(d[w],1),d[w].m(l,null))}for(Be(),w=u.length;w<d.length;w+=1)f(w);qe()}},i(h){if(!c){P(s.$$.fragment,h),P(r.$$.fragment,h);for(let _=0;_<u.length;_+=1)P(d[_]);c=!0}},o(h){W(s.$$.fragment,h),W(r.$$.fragment,h),d=d.filter(Boolean);for(let _=0;_<d.length;_+=1)W(d[_]);c=!1},d(h){h&&(A(e),A(t),A(i),A(a),A(l)),oe(s),oe(r),ot(d,h)}}}function zr(n){let e,t;function i(...s){return n[22](n[28],...s)}return e=new at({props:{text:n[29],checked:n[7][n[28]],last:n[28]=="none"||n[28]=="tool"}}),e.$on("toggle",i),{c(){ae(e.$$.fragment)},m(s,o){se(e,s,o),t=!0},p(s,o){n=s;const r={};o[0]&128&&(r.checked=n[7][n[28]]),e.$set(r)},i(s){t||(P(e.$$.fragment,s),t=!0)},o(s){W(e.$$.fragment,s),t=!1},d(s){oe(e,s)}}}function Qp(n){let e,t,i,s,o,r,a,l,c,u,d,f,h,_,g,v,w,k,y,T,C,z,E;r=new at({props:{text:"Inclusive",checked:n[1],forced:n[1]}}),r.$on("toggle",n[14]),l=new at({props:{text:"Exclusive",checked:n[2],forced:n[2]}}),l.$on("toggle",n[15]),u=new at({props:{text:"Strict",checked:n[3],forced:n[3]}}),u.$on("toggle",n[16]);let B=Oe(Object.entries(n[9])),j=[];for(let I=0;I<B.length;I+=1)j[I]=jr(qr(n,B,I));const V=I=>W(j[I],1,1,()=>{j[I]=null});let N=!n[8]&&Yp(n);return{c(){e=b("div"),t=b("div"),i=b("p"),i.innerHTML=`Filter
            <span class="tooltip svelte-1jaojxl" id="bottom">Inclusive: Equipment that includes the selected search types
                <br/> <br/>
                Exclusive: Equipment that does not include the selected search types
                <br/> <br/>
                Strict: Equipment that includes the selected search types and no
                others</span> <iconify-icon icon="eva:info-outline"></iconify-icon>`,s=S(),o=b("div"),ae(r.$$.fragment),a=S(),ae(l.$$.fragment),c=S(),ae(u.$$.fragment),d=S(),f=b("div"),h=b("div"),_=b("button"),_.textContent="Select all",g=S(),v=b("div"),w=b("button"),w.textContent="Clear all",k=S(),y=b("div");for(let I=0;I<j.length;I+=1)j[I].c();T=S(),N&&N.c(),m(i,"id","title"),m(i,"class","svelte-1jaojxl"),m(o,"class","radio ttFocus svelte-1jaojxl"),m(o,"id","filter"),m(_,"class","svelte-1jaojxl"),m(h,"class","svelte-1jaojxl"),m(w,"class","svelte-1jaojxl"),m(v,"class","svelte-1jaojxl"),m(f,"class","optionsAll svelte-1jaojxl"),m(y,"class","options svelte-1jaojxl"),m(t,"class","searchOptions svelte-1jaojxl"),m(e,"class","searchOptionsCont svelte-1jaojxl"),ne(e,"optionsOpen",n[0])},m(I,O){M(I,e,O),p(e,t),p(t,i),p(t,s),p(t,o),se(r,o,null),p(o,a),se(l,o,null),p(o,c),se(u,o,null),p(t,d),p(t,f),p(f,h),p(h,_),p(f,g),p(f,v),p(v,w),p(t,k),p(t,y);for(let Z=0;Z<j.length;Z+=1)j[Z]&&j[Z].m(y,null);p(t,T),N&&N.m(t,null),C=!0,z||(E=[D(_,"click",n[17]),D(w,"click",n[18])],z=!0)},p(I,O){const Z={};O[0]&2&&(Z.checked=I[1]),O[0]&2&&(Z.forced=I[1]),r.$set(Z);const R={};O[0]&4&&(R.checked=I[2]),O[0]&4&&(R.forced=I[2]),l.$set(R);const L={};if(O[0]&8&&(L.checked=I[3]),O[0]&8&&(L.forced=I[3]),u.$set(L),O[0]&1600){B=Oe(Object.entries(I[9]));let F;for(F=0;F<B.length;F+=1){const H=qr(I,B,F);j[F]?(j[F].p(H,O),P(j[F],1)):(j[F]=jr(H),j[F].c(),P(j[F],1),j[F].m(y,null))}for(Be(),F=B.length;F<j.length;F+=1)V(F);qe()}I[8]||N.p(I,O),(!C||O[0]&1)&&ne(e,"optionsOpen",I[0])},i(I){if(!C){P(r.$$.fragment,I),P(l.$$.fragment,I),P(u.$$.fragment,I);for(let O=0;O<B.length;O+=1)P(j[O]);P(N),C=!0}},o(I){W(r.$$.fragment,I),W(l.$$.fragment,I),W(u.$$.fragment,I),j=j.filter(Boolean);for(let O=0;O<j.length;O+=1)W(j[O]);W(N),C=!1},d(I){I&&A(e),oe(r),oe(l),oe(u),ot(j,I),N&&N.d(),z=!1,we(E)}}}function Xp(n,e,t){let i;K(n,Tt,R=>t(24,i=R));let{optionsOpen:s,slotName:o,elementData:r,list:a}=e;const l=Mt();let c=o=="gear",u=!0,d=!1,f=!1,h=!0,_=!1,g={},v={},w=c?{armor:"Armor",magicDmg:"Magic",meleeDmg:"Melee",rangedDmg:"Ranged",unique:"Unique",tool:"Tool"}:{...Ot,none:"No Stats"};for(let R of Object.keys(w))g[R]=!0;for(let R of Object.keys(w))v[R]=!1;let k=["Void Spike Ultradagger","Pureblood Dagger","Gnome Rocket Launcher"],y=[];function T(R){setTimeout(()=>{for(let L in r){let F=i[o].find(te=>te.name==L),H={...Ot},X={armor:!1,magicDmg:!1,meleeDmg:!1,rangedDmg:!1,unique:!1,tool:!1},he=c?X:H,ue=!1;if(c)if(!F.tool&&!k.includes(F.name)){for(let te in g)for(let q of F.moves)if(X[te]=q.type.includes(te),X[te])break}else X.tool=!!F.tool,X.tool||(X.unique=F.info.type=="Unique",F.name=="Void Spike Ultradagger"&&(X.armor=!0,X.meleeDmg=!0));else{for(let te in g)H[te]=F.stats[te]!=0;H.none=!!F.noStats}if(u)for(let te in he)if(g[te]&&he[te]){ue=!1;break}else ue=!0;else if(d)for(let te in he)if(g[te]&&he[te]){ue=!0;break}else ue=!1;else if(f)for(let te in he)if(g[te]&&he[te]||!g[te]&&!he[te])ue=!1;else{ue=!0;break}ue?r[L].classList.add("hidden","filtered"):r[L].classList.remove("hidden","filtered")}if(R=="sort"){let L=Object.keys(v).find(H=>v[H]),F=0;for(L&&!(L=="none"||L=="tool")?(y.sort((H,X)=>{let he=C(H,X,!0).stats[L]-C(H,X,!1).stats[L];return F||(F=he),he}),F||(y=Object.values(r))):!L&&_&&(y=Object.values(r).toReversed()),L=="none"&&(y=[...Object.entries(r).filter(H=>i[o].find(X=>X.name==H[0]).noStats),...Object.entries(r).filter(H=>!i[o].find(X=>X.name==H[0]).noStats)],y=y.map(H=>H[1]),_&&y.reverse());a.lastElementChild;)a.removeChild(a.lastElementChild);if(L||!L&&_)for(let H of y)a.appendChild(H);else for(let H in r)a.appendChild(r[H])}l("listUpdate")})}function C(R,L,F){return i[o].find(H=>H.name==Object.keys(r).find(X=>r[X]===(h?F?L:R:F?R:L)))}const z=R=>{t(1,u=R.detail),R.detail&&(t(2,d=!1),t(3,f=!1)),T("filter")},E=R=>{t(2,d=R.detail),R.detail&&(t(1,u=!1),t(3,f=!1)),T("filter")},B=R=>{t(3,f=R.detail),R.detail&&(t(1,u=!1),t(2,d=!1)),T("filter")},j=R=>{R.target.blur();for(let L in g)t(6,g[L]=!0,g);T("filter")},V=R=>{R.target.blur();for(let L in g)t(6,g[L]=!1,g);T("filter")},N=(R,L)=>{t(6,g[R]=L.detail,g),T("filter")},I=R=>{t(4,h=R.detail),R.detail&&t(5,_=!1),T("sort")},O=R=>{t(5,_=R.detail),R.detail&&t(4,h=!1),T("sort")},Z=(R,L)=>{if(t(7,v[R]=L.detail,v),L.detail)for(let F in v)F!=R&&t(7,v[F]=!1,v);T("sort")};return n.$$set=R=>{"optionsOpen"in R&&t(0,s=R.optionsOpen),"slotName"in R&&t(11,o=R.slotName),"elementData"in R&&t(12,r=R.elementData),"list"in R&&t(13,a=R.list)},n.$$.update=()=>{n.$$.dirty[0]&8192&&a&&(y=[...a.children])},[s,u,d,f,h,_,g,v,c,w,T,o,r,a,z,E,B,j,V,N,I,O,Z]}class Jp extends Re{constructor(e){super(),De(this,e,Xp,Qp,ve,{optionsOpen:0,slotName:11,elementData:12,list:13},null,[-1,-1])}}function Wr(n,e,t){const i=n.slice();return i[61]=e[t],i}function Zp(n){let e;return{c(){e=b("span"),e.textContent="Loading items...",m(e,"class","svelte-suojz2")},m(t,i){M(t,e,i)},p:le,i:le,o:le,d(t){t&&A(e)}}}function xp(n){let e,t,i,s,o,r,a,l=n[3]!="sets"&&Hr(n),c=Oe(n[6]),u=[];for(let f=0;f<c.length;f+=1)u[f]=Ur(Wr(n,c,f));const d=f=>W(u[f],1,1,()=>{u[f]=null});return{c(){e=b("input"),t=S(),l&&l.c(),i=S(),s=b("ul");for(let f=0;f<u.length;f+=1)u[f].c();m(e,"type","text"),m(e,"class","searchBarInput"),m(e,"placeholder","Search..."),m(s,"class","svelte-suojz2"),ne(s,"no-scrollbar",n[15].length<=4)},m(f,h){M(f,e,h),n[29](e),M(f,t,h),l&&l.m(f,h),M(f,i,h),M(f,s,h);for(let _=0;_<u.length;_+=1)u[_]&&u[_].m(s,null);n[42](s),o=!0,r||(a=[D(e,"keydown",n[18]),D(e,"input",n[19]),D(s,"mouseup",n[43]),D(s,"touchend",n[44],{passive:!0}),D(s,"scroll",n[45]),D(s,"scrollend",n[46])],r=!0)},p(f,h){if(f[3]!="sets"?l?l.p(f,h):(l=Hr(f),l.c(),l.m(i.parentNode,i)):l&&(l.d(1),l=null),h[0]&1197019){c=Oe(f[6]);let _;for(_=0;_<c.length;_+=1){const g=Wr(f,c,_);u[_]?(u[_].p(g,h),P(u[_],1)):(u[_]=Ur(g),u[_].c(),P(u[_],1),u[_].m(s,null))}for(Be(),_=c.length;_<u.length;_+=1)d(_);qe()}(!o||h[0]&32768)&&ne(s,"no-scrollbar",f[15].length<=4)},i(f){if(!o){for(let h=0;h<c.length;h+=1)P(u[h]);o=!0}},o(f){u=u.filter(Boolean);for(let h=0;h<u.length;h+=1)W(u[h]);o=!1},d(f){f&&(A(e),A(t),A(i),A(s)),n[29](null),l&&l.d(f),ot(u,f),n[42](null),r=!1,we(a)}}}function Hr(n){let e,t,i;return{c(){e=b("button"),e.innerHTML='<iconify-icon icon="mi:filter"></iconify-icon>',m(e,"class","optionsButton svelte-suojz2")},m(s,o){M(s,e,o),n[30](e),t||(i=D(e,"click",n[31]),t=!0)},p:le,d(s){s&&A(e),n[30](null),t=!1,i()}}}function $p(n){let e,t,i,s;function o(l){n[39](l)}function r(l){n[40](l)}let a={itemData:n[61],eqSlotName:n[3]};return n[0]!==void 0&&(a.slotOpen=n[0]),n[9]!==void 0&&(a.scrolling=n[9]),e=new Lp({props:a}),re.push(()=>Me(e,"slotOpen",o)),re.push(()=>Me(e,"scrolling",r)),e.$on("itemSelect",n[20]),e.$on("displayInfo",n[41]),{c(){ae(e.$$.fragment)},m(l,c){se(e,l,c),s=!0},p(l,c){const u={};c[0]&64&&(u.itemData=l[61]),c[0]&8&&(u.eqSlotName=l[3]),!t&&c[0]&1&&(t=!0,u.slotOpen=l[0],Pe(()=>t=!1)),!i&&c[0]&512&&(i=!0,u.scrolling=l[9],Pe(()=>i=!1)),e.$set(u)},i(l){s||(P(e.$$.fragment,l),s=!0)},o(l){W(e.$$.fragment,l),s=!1},d(l){oe(e,l)}}}function em(n){let e,t,i;function s(r){n[37](r)}let o={itemData:n[61]};return n[0]!==void 0&&(o.ddOpen=n[0]),e=new Up({props:o}),re.push(()=>Me(e,"ddOpen",s)),e.$on("setSelect",n[38]),{c(){ae(e.$$.fragment)},m(r,a){se(e,r,a),i=!0},p(r,a){const l={};a[0]&64&&(l.itemData=r[61]),!t&&a[0]&1&&(t=!0,l.ddOpen=r[0],Pe(()=>t=!1)),e.$set(l)},i(r){i||(P(e.$$.fragment,r),i=!0)},o(r){W(e.$$.fragment,r),i=!1},d(r){oe(e,r)}}}function tm(n){let e,t,i,s,o;function r(u){n[32](u)}function a(u){n[33](u)}function l(u){n[34](u)}let c={itemData:n[61],index:n[4]};return n[0]!==void 0&&(c.slotOpen=n[0]),n[1]!==void 0&&(c.weaponExpand=n[1]),n[9]!==void 0&&(c.scrolling=n[9]),e=new jp({props:c}),re.push(()=>Me(e,"slotOpen",r)),re.push(()=>Me(e,"weaponExpand",a)),re.push(()=>Me(e,"scrolling",l)),e.$on("itemSelect",n[20]),e.$on("toolSelect",n[35]),e.$on("displayInfo",n[36]),{c(){ae(e.$$.fragment)},m(u,d){se(e,u,d),o=!0},p(u,d){const f={};d[0]&64&&(f.itemData=u[61]),d[0]&16&&(f.index=u[4]),!t&&d[0]&1&&(t=!0,f.slotOpen=u[0],Pe(()=>t=!1)),!i&&d[0]&2&&(i=!0,f.weaponExpand=u[1],Pe(()=>i=!1)),!s&&d[0]&512&&(s=!0,f.scrolling=u[9],Pe(()=>s=!1)),e.$set(f)},i(u){o||(P(e.$$.fragment,u),o=!0)},o(u){W(e.$$.fragment,u),o=!1},d(u){oe(e,u)}}}function Ur(n){let e,t,i,s;const o=[tm,em,$p],r=[];function a(l,c){return l[4]?0:l[3]=="sets"?1:2}return e=a(n),t=r[e]=o[e](n),{c(){t.c(),i=rt()},m(l,c){r[e].m(l,c),M(l,i,c),s=!0},p(l,c){let u=e;e=a(l),e===u?r[e].p(l,c):(Be(),W(r[u],1,1,()=>{r[u]=null}),qe(),t=r[e],t?t.p(l,c):(t=r[e]=o[e](l),t.c()),P(t,1),t.m(i.parentNode,i))},i(l){s||(P(t),s=!0)},o(l){W(t),s=!1},d(l){l&&A(i),r[e].d(l)}}}function Gr(n){let e,t,i,s;function o(l){n[47](l)}function r(l){n[48](l)}let a={slotName:n[3],elementData:n[16]};return n[2]!==void 0&&(a.optionsOpen=n[2]),n[5]!==void 0&&(a.list=n[5]),e=new Jp({props:a}),re.push(()=>Me(e,"optionsOpen",o)),re.push(()=>Me(e,"list",r)),e.$on("listUpdate",n[19]),{c(){ae(e.$$.fragment)},m(l,c){se(e,l,c),s=!0},p(l,c){const u={};c[0]&8&&(u.slotName=l[3]),c[0]&65536&&(u.elementData=l[16]),!t&&c[0]&4&&(t=!0,u.optionsOpen=l[2],Pe(()=>t=!1)),!i&&c[0]&32&&(i=!0,u.list=l[5],Pe(()=>i=!1)),e.$set(u)},i(l){s||(P(e.$$.fragment,l),s=!0)},o(l){W(e.$$.fragment,l),s=!1},d(l){oe(e,l)}}}function nm(n){let e,t,i,s,o,r,a;const l=[xp,Zp],c=[];function u(f,h){return f[6]?0:1}t=u(n),i=c[t]=l[t](n);let d=n[3]!="sets"&&Gr(n);return{c(){e=b("div"),i.c(),s=S(),d&&d.c(),m(e,"class","dropdown svelte-suojz2"),ne(e,"infoDisplay",n[7])},m(f,h){M(f,e,h),c[t].m(e,null),p(e,s),d&&d.m(e,null),n[49](e),o=!0,r||(a=[D(window,"keydown",n[26]),D(window,"keyup",n[27]),D(window,"mousedown",n[28]),D(e,"transitionend",n[50]),D(e,"transitioncancel",n[51])],r=!0)},p(f,h){let _=t;t=u(f),t===_?c[t].p(f,h):(Be(),W(c[_],1,1,()=>{c[_]=null}),qe(),i=c[t],i?i.p(f,h):(i=c[t]=l[t](f),i.c()),P(i,1),i.m(e,s)),f[3]!="sets"?d?(d.p(f,h),h[0]&8&&P(d,1)):(d=Gr(f),d.c(),P(d,1),d.m(e,null)):d&&(Be(),W(d,1,1,()=>{d=null}),qe()),(!o||h[0]&128)&&ne(e,"infoDisplay",f[7])},i(f){o||(P(i),P(d),o=!0)},o(f){W(i),W(d),o=!1},d(f){f&&A(e),c[t].d(),d&&d.d(),n[49](null),r=!1,we(a)}}}function im(n,e,t){let i,s,o,r,a,l,c,u,d;K(n,Tt,$=>t(22,o=$)),K(n,On,$=>t(23,r=$)),K(n,Ou,$=>t(24,a=$)),K(n,Dn,$=>t(25,l=$)),K(n,vt,$=>t(54,c=$)),K(n,At,$=>t(55,u=$)),K(n,Nt,$=>t(56,d=$));let{slotName:f,index:h=0,slotOpen:_,weaponExpand:g=null,optionsOpen:v=!1}=e;const w=Mt();h?U(Dn,l[h]={},l):U(On,r[f]={},r);let k=!1,y=!1,T=!1,C,z,E,B,j,V=null,N=!1,I=!1,O=[];function Z(){j&&j.classList.remove("lastElement"),t(15,O=E.querySelectorAll("li:not(.hidden)")),j=O[O.length-1],j&&j.classList.add("lastElement"),(!j||j.classList.contains("non-eligible"))&&(j=B)}function R($){!$.shiftKey&&$.key=="Tab"&&!v&&($.preventDefault(),setTimeout(()=>z.focus()))}function L(){j&&j.removeEventListener("keydown",R),Z(),j&&j.addEventListener("keydown",R)}function F($){$.shiftKey&&$.key=="Tab"&&($.preventDefault(),setTimeout(()=>(j.querySelector("button")||j).focus()))}function H(){tu(z.value,i),L()}function X($){w("itemSelect",$.detail.element),t(13,V=$.detail.element),N=$.detail.trusted;let hs=E.querySelector(".selectedItem");hs&&hs!=$.detail.element&&hs.classList.remove("selectedItem"),t(14,I=!0),N||(ue(),E.scrollTo(0,V.offsetTop)),setTimeout(he)}function he(){U(vt,c=structuredClone(Tp),c);for(let $ in d)d[$].cost.min!=null&&(U(vt,c.armor.min+=d[$].cost.min,c),U(vt,c.armor.max+=d[$].cost.max,c));U(vt,c.armor.avg=Math.ceil((c.armor.min+c.armor.max)/2),c);for(let $ in u)u[$].cost.min!=null&&(U(vt,c.gear.min+=u[$].cost.min,c),U(vt,c.gear.max+=u[$].cost.max,c));U(vt,c.gear.avg=Math.ceil((c.gear.min+c.gear.max)/2),c),U(vt,c.total.min=c.armor.min+c.gear.min,c),U(vt,c.total.max=c.armor.max+c.gear.max,c),U(vt,c.total.avg=Math.ceil((c.total.min+c.total.max)/2),c)}function ue(){t(14,I=!1),t(11,z.value="",z),H()}const te=$=>{f!="sets"&&!k&&$.shiftKey&&t(7,k=!0)},q=$=>{f!="sets"&&$.key=="Shift"&&!y&&t(7,k=!1)},Y=()=>(t(7,k=!1),t(8,y=!1));function de($){re[$?"unshift":"push"](()=>{z=$,t(11,z)})}function pe($){re[$?"unshift":"push"](()=>{B=$,t(12,B)})}const me=()=>t(2,v=!v);function ge($){_=$,t(0,_)}function Fe($){g=$,t(1,g)}function ie($){T=$,t(9,T)}const je=()=>w("toolSelect"),We=()=>(t(7,k=!0),t(8,y=!0));function ye($){_=$,t(0,_)}const Ce=()=>t(14,I=!0);function x($){_=$,t(0,_)}function Se($){T=$,t(9,T)}const ht=()=>(t(7,k=!0),t(8,y=!0));function et($){re[$?"unshift":"push"](()=>{E=$,t(5,E)})}const Q=()=>t(7,k=!1),G=()=>t(7,k=!1),fe=()=>t(9,T=!0),He=()=>t(9,T=!1);function yt($){v=$,t(2,v)}function bt($){E=$,t(5,E)}function Ft($){re[$?"unshift":"push"](()=>{C=$,t(10,C)})}const nn=$=>{$.propertyName=="visibility"&&$.target==C&&(I&&ue(),!_&&V&&setTimeout(()=>E.scrollTo(0,V.offsetTop)),Ki(z,_))},vi=$=>{$.propertyName=="visibility"&&$.target==C&&(t(14,I=!1),Ki(z,_))};return n.$$set=$=>{"slotName"in $&&t(3,f=$.slotName),"index"in $&&t(4,h=$.index),"slotOpen"in $&&t(0,_=$.slotOpen),"weaponExpand"in $&&t(1,g=$.weaponExpand),"optionsOpen"in $&&t(2,v=$.optionsOpen)},n.$$.update=()=>{if(n.$$.dirty[0]&58720280&&t(16,i=h?l[h]:f=="sets"?a:r[f]),n.$$.dirty[0]&4194312&&t(6,s=o[f]),n.$$.dirty[0]&96&&E){t(15,O=E.querySelectorAll("li:not(.hidden)"));for(let $=0;$<E.childElementCount;$++)t(16,i[s[$].name]=E.children[$],i);Z(),L()}},[_,g,v,f,h,E,s,k,y,T,C,z,B,V,I,O,i,w,F,H,X,ue,o,r,a,l,te,q,Y,de,pe,me,ge,Fe,ie,je,We,ye,Ce,x,Se,ht,et,Q,G,fe,He,yt,bt,Ft,nn,vi]}class jo extends Re{constructor(e){super(),De(this,e,im,nm,ve,{slotName:3,index:4,slotOpen:0,weaponExpand:1,optionsOpen:2},null,[-1,-1,-1])}}function Vr(n){let e,t,i,s,o,r,a=n[1].name+"",l,c,u,d,f;return{c(){e=b("button"),t=b("img"),o=S(),r=b("span"),l=ce(a),Xe(t.src,i=n[1].image)||m(t,"src",i),m(t,"alt",s=n[1].name),m(t,"draggable","false"),m(t,"class","svelte-nknpqm"),m(r,"class","tooltip"),m(r,"id","left"),m(e,"class","svelte-nknpqm"),Je(e,"display",n[1].link?"":"none")},m(h,_){M(h,e,_),p(e,t),p(e,o),p(e,r),p(r,l),u=!0,d||(f=[D(e,"click",n[13]),D(e,"focusin",n[14]),D(e,"outroend",n[15])],d=!0)},p(h,_){(!u||_&2&&!Xe(t.src,i=h[1].image))&&m(t,"src",i),(!u||_&2&&s!==(s=h[1].name))&&m(t,"alt",s),(!u||_&2)&&a!==(a=h[1].name+"")&&Ne(l,a),_&2&&Je(e,"display",h[1].link?"":"none")},i(h){u||(h&&ke(()=>{u&&(c||(c=be(e,Ke,{duration:150},!0)),c.run(1))}),u=!0)},o(h){h&&(c||(c=be(e,Ke,{duration:150},!1)),c.run(0)),u=!1},d(h){h&&A(e),h&&c&&c.end(),d=!1,we(f)}}}function sm(n){let e,t,i=n[1],s,o,r=n[0].charAt(0).toUpperCase()+n[0].slice(1)+"",a,l,c,u,d,f,h,_,g,v,w,k,y=Vr(n);function T(E){n[19](E)}function C(E){n[20](E)}let z={slotName:n[0]};return n[4]!==void 0&&(z.slotOpen=n[4]),n[6]!==void 0&&(z.optionsOpen=n[6]),h=new jo({props:z}),re.push(()=>Me(h,"slotOpen",T)),re.push(()=>Me(h,"optionsOpen",C)),h.$on("itemSelect",n[21]),{c(){e=b("div"),t=b("div"),y.c(),s=S(),o=b("button"),a=ce(r),l=S(),c=b("iconify-icon"),u=S(),d=b("button"),d.innerHTML='<iconify-icon icon="maki:cross" class="svelte-nknpqm"></iconify-icon> <span class="tooltip" id="top">Clear selection</span>',f=S(),ae(h.$$.fragment),m(t,"class","eqSlotIcon ff-border svelte-nknpqm"),Ae(c,"icon","iconamoon:arrow-down-2-fill"),Ae(c,"class","svelte-nknpqm"),m(o,"class","ddButton svelte-nknpqm"),m(d,"class","clearButton svelte-nknpqm"),m(e,"class","eqSlotCont svelte-nknpqm"),ne(e,"slotOpen",n[4]),ne(e,"clearAllowed",n[5]&&n[7])},m(E,B){M(E,e,B),p(e,t),y.m(t,null),n[16](t),p(e,s),p(e,o),p(o,a),p(o,l),p(o,c),p(e,u),p(e,d),p(e,f),se(h,e,null),n[22](e),v=!0,w||(k=[D(window,"mousedown",n[11]),D(window,"keydown",n[12]),D(o,"click",n[17]),D(d,"click",n[18]),D(e,"mouseenter",n[23]),D(e,"mouseleave",n[24])],w=!0)},p(E,[B]){B&2&&ve(i,i=E[1])?(Be(),W(y,1,1,le),qe(),y=Vr(E),y.c(),P(y,1),y.m(t,null)):y.p(E,B),(!v||B&1)&&r!==(r=E[0].charAt(0).toUpperCase()+E[0].slice(1)+"")&&Ne(a,r);const j={};B&1&&(j.slotName=E[0]),!_&&B&16&&(_=!0,j.slotOpen=E[4],Pe(()=>_=!1)),!g&&B&64&&(g=!0,j.optionsOpen=E[6],Pe(()=>g=!1)),h.$set(j),(!v||B&16)&&ne(e,"slotOpen",E[4]),(!v||B&160)&&ne(e,"clearAllowed",E[5]&&E[7])},i(E){v||(P(y),P(h.$$.fragment,E),v=!0)},o(E){W(y),W(h.$$.fragment,E),v=!1},d(E){E&&A(e),y.d(E),n[16](null),oe(h),n[22](null),w=!1,we(k)}}}function om(n,e,t){let i,s,o;K(n,Nt,I=>t(10,i=I)),K(n,dn,I=>t(8,s=I)),K(n,J,I=>t(9,o=I));let{eqSlotName:r}=e,a,l,c=ds,u,d,f,h;const _=I=>{(!a.contains(I.target)&&!s||I.target==a||I.target==l)&&(t(4,u=!1),t(6,f=!1),I.target!=a&&I.target!=l&&t(5,d=!1))},g=I=>{I.key=="Tab"?setTimeout(()=>{t(5,d=a.contains(document.activeElement))}):I.key=="Escape"&&(t(4,u=!1),t(6,f=!1))},v=()=>{s||(t(4,u=!1),U(J,o.item.ongoing=!0,o),U(J,o.item.data={...c,slot:r,type:"eq"},o))},w=I=>{I.relatedTarget==null&&t(5,d=!0)},k=()=>{setTimeout(()=>Dp(l))};function y(I){re[I?"unshift":"push"](()=>{l=I,t(3,l)})}const T=()=>{o.screenshot.ongoing||t(4,u=!u)},C=()=>{t(5,d=!1),a.classList.contains("clearAllowed")&&h.querySelector("button").click()};function z(I){u=I,t(4,u)}function E(I){f=I,t(6,f)}const B=I=>{setTimeout(()=>{t(7,h=I.detail.classList.contains("selectedItem")?I.detail:null),t(6,f=!1)})};function j(I){re[I?"unshift":"push"](()=>{a=I,t(2,a)})}const V=()=>t(5,d=!0),N=()=>{a.contains(document.activeElement)||t(5,d=!1)};return n.$$set=I=>{"eqSlotName"in I&&t(0,r=I.eqSlotName)},n.$$.update=()=>{n.$$.dirty&1027&&i[r]&&i[r].name!=c.name&&t(1,c=i[r])},[r,c,a,l,u,d,f,h,s,o,i,_,g,v,w,k,y,T,C,z,E,B,j,V,N]}class rm extends Re{constructor(e){super(),De(this,e,om,sm,ve,{eqSlotName:0})}}function Kr(n,e,t){const i=n.slice();return i[1]=e[t],i[2]=e,i[3]=t,i}function Yr(n){let e,t,i;function s(r){n[0](r,n[1],n[2],n[3])}let o={};return n[1]!==void 0&&(o.eqSlotName=n[1]),e=new rm({props:o}),re.push(()=>Me(e,"eqSlotName",s)),{c(){ae(e.$$.fragment)},m(r,a){se(e,r,a),i=!0},p(r,a){n=r;const l={};!t&&a&0&&(t=!0,l.eqSlotName=n[1],Pe(()=>t=!1)),e.$set(l)},i(r){i||(P(e.$$.fragment,r),i=!0)},o(r){W(e.$$.fragment,r),i=!1},d(r){oe(e,r)}}}function lm(n){let e,t,i=Oe(Array(...Ln)),s=[];for(let r=0;r<i.length;r+=1)s[r]=Yr(Kr(n,i,r));const o=r=>W(s[r],1,1,()=>{s[r]=null});return{c(){e=b("div");for(let r=0;r<s.length;r+=1)s[r].c();m(e,"class","armorBox svelte-35g1a3")},m(r,a){M(r,e,a);for(let l=0;l<s.length;l+=1)s[l]&&s[l].m(e,null);t=!0},p(r,[a]){if(a&0){i=Oe(Array(...Ln));let l;for(l=0;l<i.length;l+=1){const c=Kr(r,i,l);s[l]?(s[l].p(c,a),P(s[l],1)):(s[l]=Yr(c),s[l].c(),P(s[l],1),s[l].m(e,null))}for(Be(),l=i.length;l<s.length;l+=1)o(l);qe()}},i(r){if(!t){for(let a=0;a<i.length;a+=1)P(s[a]);t=!0}},o(r){s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)W(s[a]);t=!1},d(r){r&&A(e),ot(s,r)}}}function am(n,e,t){function i(s,o,r,a){r[a]=s}return[i]}class cm extends Re{constructor(e){super(),De(this,e,am,lm,ve,{})}}function um(n){let e,t=(n[3]?`${Math.floor(n[5]*.675+19.8)}% Reduction`:n[5])+"",i,s,o;return{c(){e=b("span"),i=ce(t),m(e,"class","statValue svelte-gx367h"),m(e,"tabindex","0"),ne(e,"hidden",n[2]),ne(e,"negative",n[5]<0),ne(e,"zero",n[5]==0),ne(e,"reduction",n[3])},m(r,a){M(r,e,a),p(e,i),s||(o=[D(e,"mouseenter",n[11]),D(e,"mouseleave",n[12]),D(e,"focusin",n[13]),D(e,"focusout",n[14])],s=!0)},p(r,a){a&40&&t!==(t=(r[3]?`${Math.floor(r[5]*.675+19.8)}% Reduction`:r[5])+"")&&Ne(i,t),a&4&&ne(e,"hidden",r[2]),a&32&&ne(e,"negative",r[5]<0),a&32&&ne(e,"zero",r[5]==0),a&8&&ne(e,"reduction",r[3])},d(r){r&&A(e),s=!1,we(o)}}}function dm(n){let e,t=(n[0]!="endurance"?n[5]:n[5].toFixed(2))+"",i;return{c(){e=b("span"),i=ce(t),m(e,"class","statValue svelte-gx367h"),ne(e,"hidden",n[2]),ne(e,"negative",n[5]<0),ne(e,"zero",n[5]==0)},m(s,o){M(s,e,o),p(e,i)},p(s,o){o&33&&t!==(t=(s[0]!="endurance"?s[5]:s[5].toFixed(2))+"")&&Ne(i,t),o&4&&ne(e,"hidden",s[2]),o&32&&ne(e,"negative",s[5]<0),o&32&&ne(e,"zero",s[5]==0)},d(s){s&&A(e)}}}function fm(n){let e;return{c(){e=b("iconify-icon"),Ae(e,"icon","codicon:sparkle-filled"),Ae(e,"class","svelte-gx367h")},m(t,i){M(t,e,i)},p:le,d(t){t&&A(e)}}}function hm(n){let e,t=`${n[1]} Bonus`,i;return{c(){e=b("span"),i=ce(t),m(e,"class","statName svelte-gx367h")},m(s,o){M(s,e,o),p(e,i)},p(s,o){o&2&&t!==(t=`${s[1]} Bonus`)&&Ne(i,t)},d(s){s&&A(e)}}}function _m(n){let e,t,i,s,o,r,a;function l(_,g){return _[0]!="armor"?dm:um}let c=l(n),u=c(n);function d(_,g){if(_[2])return hm;if(_[4])return fm}let f=d(n),h=f&&f(n);return{c(){e=b("div"),t=b("img"),s=S(),u.c(),o=S(),h&&h.c(),Xe(t.src,i="stats/"+n[0]+".svg")||m(t,"src",i),m(t,"alt",n[1]),m(t,"class","svelte-gx367h"),m(e,"id",n[0]),m(e,"class","svelte-gx367h"),ne(e,"hidden",n[5]==0)},m(_,g){M(_,e,g),p(e,t),p(e,s),u.m(e,null),p(e,o),h&&h.m(e,null),r||(a=[D(t,"mouseenter",n[9]),D(t,"mouseleave",n[10])],r=!0)},p(_,[g]){g&1&&!Xe(t.src,i="stats/"+_[0]+".svg")&&m(t,"src",i),g&2&&m(t,"alt",_[1]),c===(c=l(_))&&u?u.p(_,g):(u.d(1),u=c(_),u&&(u.c(),u.m(e,o))),f===(f=d(_))&&h?h.p(_,g):(h&&h.d(1),h=f&&f(_),h&&(h.c(),h.m(e,null))),g&1&&m(e,"id",_[0]),g&32&&ne(e,"hidden",_[5]==0)},i:le,o:le,d(_){_&&A(e),u.d(),h&&h.d(),r=!1,we(a)}}}function pm(n,e,t){let i,s,o,r;K(n,Tt,k=>t(6,s=k)),K(n,Sn,k=>t(7,o=k)),K(n,ct,k=>t(8,r=k));let{codeName:a,formalName:l}=e,c,u,d=!1;const f=()=>t(2,c=!0),h=()=>t(2,c=!1),_=()=>t(3,u=!0),g=()=>t(3,u=!1),v=()=>t(3,u=!0),w=()=>t(3,u=!1);return n.$$set=k=>{"codeName"in k&&t(0,a=k.codeName),"formalName"in k&&t(1,l=k.formalName)},n.$$.update=()=>{if(n.$$.dirty&257&&t(5,i=r[a]),n.$$.dirty&193)for(let k in o)if(o[k]&&s.bonuses.find(y=>y.name==k).stats[a]!=0){t(4,d=!0);break}else t(4,d=!1)},[a,l,c,u,d,i,s,o,r,f,h,_,g,v,w]}class mm extends Re{constructor(e){super(),De(this,e,pm,_m,ve,{codeName:0,formalName:1})}}function Qr(n,e,t){const i=n.slice();return i[8]=e[t][0],i[9]=e[t][1],i[10]=e,i[11]=t,i}function Xr(n){let e,t,i,s;function o(l){n[4](l,n[8],n[10],n[11])}function r(l){n[5](l,n[9],n[10],n[11])}let a={};return n[8]!==void 0&&(a.codeName=n[8]),n[9]!==void 0&&(a.formalName=n[9]),e=new mm({props:a}),re.push(()=>Me(e,"codeName",o)),re.push(()=>Me(e,"formalName",r)),{c(){ae(e.$$.fragment)},m(l,c){se(e,l,c),s=!0},p(l,c){n=l;const u={};!t&&c&0&&(t=!0,u.codeName=n[8],Pe(()=>t=!1)),!i&&c&0&&(i=!0,u.formalName=n[9],Pe(()=>i=!1)),e.$set(u)},i(l){s||(P(e.$$.fragment,l),s=!0)},o(l){W(e.$$.fragment,l),s=!1},d(l){oe(e,l)}}}function Jr(n){let e,t,i,s,o=n[2]?"Copied!":`Copy ${n[1]?"all":""} as text`,r,a,l,c,u;return{c(){e=b("button"),t=b("iconify-icon"),i=S(),s=b("span"),r=ce(o),Ae(t,"icon","ic:round-content-copy"),Ae(t,"class","svelte-1vdju8g"),m(s,"class","tooltip"),m(s,"id","top"),m(e,"class","copyStatsButton svelte-1vdju8g")},m(d,f){M(d,e,f),p(e,t),p(e,i),p(e,s),p(s,r),l=!0,c||(u=D(e,"click",n[6]),c=!0)},p(d,f){(!l||f&6)&&o!==(o=d[2]?"Copied!":`Copy ${d[1]?"all":""} as text`)&&Ne(r,o)},i(d){l||(d&&ke(()=>{l&&(a||(a=be(e,Ke,{duration:100},!0)),a.run(1))}),l=!0)},o(d){d&&(a||(a=be(e,Ke,{duration:100},!1)),a.run(0)),l=!1},d(d){d&&A(e),d&&a&&a.end(),c=!1,u()}}}function gm(n){let e,t,i,s,o,r=Oe(Object.entries(Ot)),a=[];for(let u=0;u<r.length;u+=1)a[u]=Xr(Qr(n,r,u));const l=u=>W(a[u],1,1,()=>{a[u]=null});let c=n[3]&&Jr(n);return s=new at({props:{text:"Show all stats"}}),s.$on("toggle",n[7]),{c(){e=b("div");for(let u=0;u<a.length;u+=1)a[u].c();t=S(),c&&c.c(),i=S(),ae(s.$$.fragment),m(e,"class","statBox svelte-1vdju8g"),ne(e,"showAll",n[1])},m(u,d){M(u,e,d);for(let f=0;f<a.length;f+=1)a[f]&&a[f].m(e,null);p(e,t),c&&c.m(e,null),p(e,i),se(s,e,null),o=!0},p(u,[d]){if(d&0){r=Oe(Object.entries(Ot));let f;for(f=0;f<r.length;f+=1){const h=Qr(u,r,f);a[f]?(a[f].p(h,d),P(a[f],1)):(a[f]=Xr(h),a[f].c(),P(a[f],1),a[f].m(e,t))}for(Be(),f=r.length;f<a.length;f+=1)l(f);qe()}u[3]?c?(c.p(u,d),d&8&&P(c,1)):(c=Jr(u),c.c(),P(c,1),c.m(e,i)):c&&(Be(),W(c,1,1,()=>{c=null}),qe()),(!o||d&2)&&ne(e,"showAll",u[1])},i(u){if(!o){for(let d=0;d<r.length;d+=1)P(a[d]);P(c),P(s.$$.fragment,u),o=!0}},o(u){a=a.filter(Boolean);for(let d=0;d<a.length;d+=1)W(a[d]);W(c),W(s.$$.fragment,u),o=!1},d(u){u&&A(e),ot(a,u),c&&c.d(),oe(s)}}}function bm(n,e,t){let i;K(n,ct,d=>t(0,i=d));let s=!1,o=!1,r=!1;function a(d,f,h,_){h[_][0]=d}function l(d,f,h,_){h[_][1]=d}const c=d=>{if(Xt(d),o)return;let f="";for(let[h,_]of Object.entries(Ot)){let g=h=="armor"?"":`
`,v=i[h];h=="armor"?v+=` (${Math.floor(v*.675+19.8)}% Reduction)`:h=="endurance"?v=v.toFixed(2)+"%":h=="ammoReturn"&&(v+="%"),(s||!s&&i[h])&&(f+=`${g}${_}: ${v}`)}navigator.clipboard.writeText(f),t(2,o=!0),setTimeout(()=>t(2,o=!1),1e3)},u=d=>t(1,s=d.detail);return n.$$.update=()=>{if(n.$$.dirty&1&&i){t(3,r=!1);for(let d in i)if(i[d]){t(3,r=!0);break}}},[i,s,o,r,a,l,c,u]}class vm extends Re{constructor(e){super(),De(this,e,bm,gm,ve,{})}}function ym(n){let e,t,i,s,o,r,a,l,c,u;return{c(){e=b("div"),t=b("button"),t.textContent="-",i=S(),s=b("input"),o=S(),r=b("b"),r.textContent="%",a=S(),l=b("button"),l.textContent="+",m(t,"id","decrease"),m(t,"class","svelte-1m4n74o"),m(s,"type","number"),m(s,"placeholder","0"),m(s,"class","svelte-1m4n74o"),m(r,"class","svelte-1m4n74o"),m(l,"id","increase"),m(l,"class","svelte-1m4n74o"),m(e,"class","svelte-1m4n74o"),ne(e,"non-percent",!n[1])},m(d,f){M(d,e,f),p(e,t),p(e,i),p(e,s),Dt(s,n[0]),p(e,o),p(e,r),p(e,a),p(e,l),c||(u=[D(t,"click",n[4]),D(s,"input",n[5]),D(s,"input",n[2]),D(l,"click",n[6])],c=!0)},p(d,[f]){f&1&&sa(s.value)!==d[0]&&Dt(s,d[0])},i:le,o:le,d(d){d&&A(e),c=!1,we(u)}}}function wm(n,e,t){let{weaponName:i,value:s}=e,o=i!="Nature's Wrath Spellbook",r;o?(s=100,r=100):(s=4,r=4);function a(){s<0?t(0,s=0):s>r&&t(0,s=r),s%1!=0&&t(0,s=Math.floor(s))}const l=()=>{t(0,s--,s),a()};function c(){s=sa(this.value),t(0,s)}const u=()=>{t(0,s++,s),a()};return n.$$set=d=>{"weaponName"in d&&t(3,i=d.weaponName),"value"in d&&t(0,s=d.value)},[s,o,a,i,l,c,u]}class km extends Re{constructor(e){super(),De(this,e,wm,ym,ve,{weaponName:3,value:0})}}function Zr(n,e,t){const i=n.slice();i[53]=e[t];const s=i[53].name.includes("Fantastic Beamstorm")?"~":"";i[23]=s;const o=i[24].includes(i[53].name);return i[54]=o,i}function Cm(n){let e,t,i=n[2].description+"",s,o;return{c(){e=b("span"),t=ce('"'),s=ce(i),o=ce('"'),m(e,"id","toolDesc"),m(e,"class","svelte-1tlszo6")},m(r,a){M(r,e,a),p(e,t),p(e,s),p(e,o)},p(r,a){a[0]&4&&i!==(i=r[2].description+"")&&Ne(s,i)},d(r){r&&A(e)}}}function Em(n){let e,t,i,s=`${n[5]?"Type":n[3].name}:`,o,r,a=n[20],l,c,u,d,f,h=n[5]?"Return":"Expand",_,g,v,w,k=$r(n),y=n[4]&&el(n);return{c(){e=b("button"),t=b("div"),i=b("span"),o=ce(s),r=S(),k.c(),c=S(),y&&y.c(),u=S(),d=b("span"),f=ce("("),_=ce(h),g=ce(")"),m(i,"class","svelte-1tlszo6"),Je(i,"font-size",Object.keys(n[21]).includes(n[3].name)?`calc(var(--u) * ${n[21][n[3].name]})`:""),m(t,"id",l=n[5]?"":"basic"),m(t,"class","svelte-1tlszo6"),m(d,"class","tooltip svelte-1tlszo6"),m(d,"id","top"),m(e,"class","gearPreview svelte-1tlszo6"),Je(e,"line-height",`${n[10]/6.5}px`)},m(T,C){M(T,e,C),p(e,t),p(t,i),p(i,o),p(t,r),k.m(t,null),p(e,c),y&&y.m(e,null),p(e,u),p(e,d),p(d,f),p(d,_),p(d,g),n[36](e),v||(w=D(e,"click",n[37]),v=!0)},p(T,C){C[0]&40&&s!==(s=`${T[5]?"Type":T[3].name}:`)&&Ne(o,s),C[0]&2097160&&Je(i,"font-size",Object.keys(T[21]).includes(T[3].name)?`calc(var(--u) * ${T[21][T[3].name]})`:""),C[0]&1048576&&ve(a,a=T[20])?(k.d(1),k=$r(T),k.c(),k.m(t,null)):k.p(T,C),C[0]&32&&l!==(l=T[5]?"":"basic")&&m(t,"id",l),T[4]?y?y.p(T,C):(y=el(T),y.c(),y.m(e,u)):y&&(y.d(1),y=null),C[0]&32&&h!==(h=T[5]?"Return":"Expand")&&Ne(_,h),C[0]&1024&&Je(e,"line-height",`${T[10]/6.5}px`)},d(T){T&&A(e),k.d(T),y&&y.d(),n[36](null),v=!1,w()}}}function xr(n){let e;return{c(){e=b("iconify-icon"),Ae(e,"icon","codicon:sparkle-filled"),Ae(e,"class","svelte-1tlszo6")},m(t,i){M(t,e,i)},d(t){t&&A(e)}}}function $r(n){let e,t,i=(n[5]?n[2].info.type.replace("/","<b>,</b><br/>"):n[26](n[3]))+"",s,o=!n[5]&&n[6].basic&&xr();return{c(){e=b("span"),t=new bu(!1),s=S(),o&&o.c(),t.a=s,m(e,"class","svelte-1tlszo6")},m(r,a){M(r,e,a),t.m(i,e),p(e,s),o&&o.m(e,null)},p(r,a){a[0]&44&&i!==(i=(r[5]?r[2].info.type.replace("/","<b>,</b><br/>"):r[26](r[3]))+"")&&t.p(i),!r[5]&&r[6].basic?o||(o=xr(),o.c(),o.m(e,null)):o&&(o.d(1),o=null)},d(r){r&&A(e),o&&o.d()}}}function el(n){let e,t,i=`${n[5]?"Special":n[4].name.split(" (")[0]}:`,s,o,r=n[20],a,l=il(n);return{c(){e=b("div"),t=b("span"),s=ce(i),o=S(),l.c(),m(t,"class","svelte-1tlszo6"),Je(t,"font-size",Object.keys(n[21]).includes(n[4].name)?`calc(var(--u) * ${n[21][n[4].name]})`:""),m(e,"id",a=n[5]?"":"special"),m(e,"class","svelte-1tlszo6")},m(c,u){M(c,e,u),p(e,t),p(t,s),p(e,o),l.m(e,null)},p(c,u){u[0]&48&&i!==(i=`${c[5]?"Special":c[4].name.split(" (")[0]}:`)&&Ne(s,i),u[0]&2097168&&Je(t,"font-size",Object.keys(c[21]).includes(c[4].name)?`calc(var(--u) * ${c[21][c[4].name]})`:""),u[0]&1048576&&ve(r,r=c[20])?(l.d(1),l=il(c),l.c(),l.m(e,null)):l.p(c,u),u[0]&32&&a!==(a=c[5]?"":"special")&&m(e,"id",a)},d(c){c&&A(e),l.d(c)}}}function tl(n){let e,t;return{c(){e=b("span"),t=ce(n[23]),m(e,"id","prefix"),m(e,"class","svelte-1tlszo6")},m(i,s){M(i,e,s),p(e,t)},p(i,s){s[0]&8388608&&Ne(t,i[23])},d(i){i&&A(e)}}}function nl(n){let e;return{c(){e=b("iconify-icon"),Ae(e,"icon","codicon:sparkle-filled"),Ae(e,"class","svelte-1tlszo6")},m(t,i){M(t,e,i)},d(t){t&&A(e)}}}function il(n){let e,t,i=(n[5]?n[2].info.special:n[26](n[4]))+"",s,o,r=n[23]&&!n[5]&&tl(n),a=!n[5]&&n[6].special&&nl();return{c(){e=b("span"),r&&r.c(),t=S(),s=ce(i),o=S(),a&&a.c(),m(e,"class","svelte-1tlszo6")},m(l,c){M(l,e,c),r&&r.m(e,null),p(e,t),p(e,s),p(e,o),a&&a.m(e,null)},p(l,c){l[23]&&!l[5]?r?r.p(l,c):(r=tl(l),r.c(),r.m(e,t)):r&&(r.d(1),r=null),c[0]&52&&i!==(i=(l[5]?l[2].info.special:l[26](l[4]))+"")&&Ne(s,i),!l[5]&&l[6].special?a||(a=nl(),a.c(),a.m(e,null)):a&&(a.d(1),a=null)},d(l){l&&A(e),r&&r.d(),a&&a.d()}}}function sl(n){let e,t,i,s,o,r,a=n[2].name+"",l,c,u,d,f,h;return{c(){e=b("button"),t=b("img"),o=S(),r=b("span"),l=ce(a),Xe(t.src,i=n[2].image)||m(t,"src",i),m(t,"alt",s=n[2].name),m(t,"draggable","false"),m(t,"class","svelte-1tlszo6"),m(r,"class","tooltip svelte-1tlszo6"),m(r,"id",c=n[19].screenshot.ongoing?"right":"top"),m(e,"class","svelte-1tlszo6"),Je(e,"display",n[2].link?"":"none"),Je(e,"border-radius",n[2].tool?"calc(var(--u))":"")},m(_,g){M(_,e,g),p(e,t),p(e,o),p(e,r),p(r,l),d=!0,f||(h=D(e,"click",n[38]),f=!0)},p(_,g){(!d||g[0]&4&&!Xe(t.src,i=_[2].image))&&m(t,"src",i),(!d||g[0]&4&&s!==(s=_[2].name))&&m(t,"alt",s),(!d||g[0]&4)&&a!==(a=_[2].name+"")&&Ne(l,a),(!d||g[0]&524288&&c!==(c=_[19].screenshot.ongoing?"right":"top"))&&m(r,"id",c),g[0]&4&&Je(e,"display",_[2].link?"":"none"),g[0]&4&&Je(e,"border-radius",_[2].tool?"calc(var(--u))":"")},i(_){d||(_&&ke(()=>{d&&(u||(u=be(e,Ke,{duration:150},!0)),u.run(1))}),d=!0)},o(_){_&&(u||(u=be(e,Ke,{duration:150},!1)),u.run(0)),d=!1},d(_){_&&A(e),_&&u&&u.end(),f=!1,h()}}}function ol(n){let e,t,i,s,o,r,a,l,c,u;i=new at({props:{text:"Toggle base values",checked:n[16]}}),i.$on("toggle",n[47]),o=new at({props:{text:"Eyeball of Reckoning buff",checked:n[17]}}),o.$on("toggle",n[48]);let d=Oe(n[2].moves),f=[];for(let _=0;_<d.length;_+=1)f[_]=cl(Zr(n,d,_));const h=_=>W(f[_],1,1,()=>{f[_]=null});return{c(){e=b("div"),t=b("div"),ae(i.$$.fragment),s=S(),ae(o.$$.fragment),r=S(),a=b("div");for(let _=0;_<f.length;_+=1)f[_].c();m(t,"class","weaponToggles svelte-1tlszo6"),m(a,"class","weaponMoves svelte-1tlszo6"),m(e,"class","fullWeaponView svelte-1tlszo6")},m(_,g){M(_,e,g),p(e,t),se(i,t,null),p(t,s),se(o,t,null),p(e,r),p(e,a);for(let v=0;v<f.length;v+=1)f[v]&&f[v].m(a,null);u=!0},p(_,g){const v={};g[0]&65536&&(v.checked=_[16]),i.$set(v);const w={};if(g[0]&131072&&(w.checked=_[17]),o.$set(w),g[0]&219611268){d=Oe(_[2].moves);let k;for(k=0;k<d.length;k+=1){const y=Zr(_,d,k);f[k]?(f[k].p(y,g),P(f[k],1)):(f[k]=cl(y),f[k].c(),P(f[k],1),f[k].m(a,null))}for(Be(),k=d.length;k<f.length;k+=1)h(k);qe()}},i(_){if(!u){P(i.$$.fragment,_),P(o.$$.fragment,_);for(let g=0;g<d.length;g+=1)P(f[g]);_&&ke(()=>{u&&(c&&c.end(1),l=aa(e,Ke,{duration:150,delay:300}),l.start())}),u=!0}},o(_){W(i.$$.fragment,_),W(o.$$.fragment,_),f=f.filter(Boolean);for(let g=0;g<f.length;g+=1)W(f[g]);l&&l.invalidate(),_&&(c=ca(e,Ke,{duration:150})),u=!1},d(_){_&&A(e),oe(i),oe(o),ot(f,_),_&&c&&c.end()}}}function rl(n){let e,t,i,s;function o(l){n[49](l)}function r(l){n[50](l)}let a={};return n[7]!==void 0&&(a.value=n[7]),n[2].name!==void 0&&(a.weaponName=n[2].name),e=new km({props:a}),re.push(()=>Me(e,"value",o)),re.push(()=>Me(e,"weaponName",r)),{c(){ae(e.$$.fragment)},m(l,c){se(e,l,c),s=!0},p(l,c){const u={};!t&&c[0]&128&&(t=!0,u.value=l[7],Pe(()=>t=!1)),!i&&c[0]&4&&(i=!0,u.weaponName=l[2].name,Pe(()=>i=!1)),e.$set(u)},i(l){s||(P(e.$$.fragment,l),s=!0)},o(l){W(e.$$.fragment,l),s=!1},d(l){oe(e,l)}}}function ll(n){let e;return{c(){e=b("iconify-icon"),Ae(e,"icon","codicon:sparkle-filled"),Ae(e,"class","svelte-1tlszo6")},m(t,i){M(t,e,i)},d(t){t&&A(e)}}}function al(n){let e,t=n[23]+(n[16]&&!n[54]?n[53].base:n[54]?n[27](n[53]):n[26](n[53]))+"",i,s,o=n[18][n[53].name]&&!n[16]&&ll();return{c(){e=b("span"),i=ce(t),s=S(),o&&o.c(),m(e,"class","svelte-1tlszo6")},m(r,a){M(r,e,a),p(e,i),p(e,s),o&&o.m(e,null)},p(r,a){a[0]&65540&&t!==(t=r[23]+(r[16]&&!r[54]?r[53].base:r[54]?r[27](r[53]):r[26](r[53]))+"")&&Ne(i,t),r[18][r[53].name]&&!r[16]?o||(o=ll(),o.c(),o.m(e,null)):o&&(o.d(1),o=null)},d(r){r&&A(e),o&&o.d()}}}function cl(n){let e,t,i,s,o=(n[54]&&n[2].name=="Nature's Wrath Spellbook"?n[53].name.replace("Charged","Charge(s)"):n[53].name)+":",r,a,l=n[54]?[n[20],n[7],n[17]]:[n[20],n[17]],c,u,d=n[54]&&rl(n),f=al(n);return{c(){e=b("div"),t=b("div"),i=b("span"),d&&d.c(),s=S(),r=ce(o),a=S(),f.c(),c=S(),m(i,"class","svelte-1tlszo6"),m(t,"class","ff-border svelte-1tlszo6"),m(e,"class","svelte-1tlszo6")},m(h,_){M(h,e,_),p(e,t),p(t,i),d&&d.m(i,null),p(i,s),p(i,r),p(t,a),f.m(t,null),p(e,c),u=!0},p(h,_){h[54]?d?(d.p(h,_),_[0]&4&&P(d,1)):(d=rl(h),d.c(),P(d,1),d.m(i,s)):d&&(Be(),W(d,1,1,()=>{d=null}),qe()),(!u||_[0]&4)&&o!==(o=(h[54]&&h[2].name=="Nature's Wrath Spellbook"?h[53].name.replace("Charged","Charge(s)"):h[53].name)+":")&&Ne(r,o),_[0]&1179780&&ve(l,l=h[54]?[h[20],h[7],h[17]]:[h[20],h[17]])?(f.d(1),f=al(h),f.c(),f.m(t,null)):f.p(h,_)},i(h){u||(P(d),u=!0)},o(h){W(d),u=!1},d(h){h&&A(e),d&&d.d(),f.d(h)}}}function Sm(n){let e,t,i,s,o="Gear"+(n[19].screenshot.ongoing?":":""),r,a,l,c,u,d=n[2],f,h,_,g,v,w,k,y,T,C,z,E;function B(F,H){if(F[2].name&&!F[2].tool)return Em;if(F[2].tool)return Cm}let j=B(n),V=j&&j(n),N=sl(n);function I(F){n[42](F)}function O(F){n[43](F)}function Z(F){n[44](F)}let R={slotName:n[0],index:n[1]};n[14]!==void 0&&(R.slotOpen=n[14]),n[5]!==void 0&&(R.weaponExpand=n[5]),n[15]!==void 0&&(R.optionsOpen=n[15]),g=new jo({props:R}),re.push(()=>Me(g,"slotOpen",I)),re.push(()=>Me(g,"weaponExpand",O)),re.push(()=>Me(g,"optionsOpen",Z)),g.$on("itemSelect",n[45]),g.$on("toolSelect",n[28]);let L=n[5]&&ol(n);return{c(){e=b("div"),t=b("button"),i=b("iconify-icon"),s=S(),r=ce(o),a=S(),l=b("div"),V&&V.c(),c=S(),u=b("div"),N.c(),_=S(),ae(g.$$.fragment),y=S(),L&&L.c(),T=rt(),Ae(i,"icon","iconamoon:arrow-down-2-fill"),Ae(i,"class","svelte-1tlszo6"),m(t,"class","ddButton svelte-1tlszo6"),m(u,"class","gearSlotIcon svelte-1tlszo6"),ke(()=>n[39].call(u)),Je(u,"min-width",`${n[11]}px`),m(l,"class","gearInfoCont ff-border svelte-1tlszo6"),ke(()=>n[41].call(l)),Je(l,"justify-content",n[2].name?"":"flex-end"),m(e,"class","gearSlot svelte-1tlszo6"),ne(e,"slotOpen",n[14]),ne(e,"weapon-expand",n[5])},m(F,H){M(F,e,H),p(e,t),p(t,i),p(t,s),p(t,r),n[34](t),p(e,a),p(e,l),V&&V.m(l,null),p(l,c),p(l,u),N.m(u,null),f=Jt(u,n[39].bind(u)),n[40](l),h=Jt(l,n[41].bind(l)),p(e,_),se(g,e,null),n[46](e),M(F,y,H),L&&L.m(F,H),M(F,T,H),C=!0,z||(E=[D(window,"mousedown",n[32]),D(window,"keydown",n[33]),D(t,"click",n[35])],z=!0)},p(F,H){(!C||H[0]&524288)&&o!==(o="Gear"+(F[19].screenshot.ongoing?":":""))&&Ne(r,o),j===(j=B(F))&&V?V.p(F,H):(V&&V.d(1),V=j&&j(F),V&&(V.c(),V.m(l,c))),H[0]&4&&ve(d,d=F[2])?(Be(),W(N,1,1,le),qe(),N=sl(F),N.c(),P(N,1),N.m(u,null)):N.p(F,H),H[0]&2048&&Je(u,"min-width",`${F[11]}px`),H[0]&4&&Je(l,"justify-content",F[2].name?"":"flex-end");const X={};H[0]&1&&(X.slotName=F[0]),H[0]&2&&(X.index=F[1]),!v&&H[0]&16384&&(v=!0,X.slotOpen=F[14],Pe(()=>v=!1)),!w&&H[0]&32&&(w=!0,X.weaponExpand=F[5],Pe(()=>w=!1)),!k&&H[0]&32768&&(k=!0,X.optionsOpen=F[15],Pe(()=>k=!1)),g.$set(X),(!C||H[0]&16384)&&ne(e,"slotOpen",F[14]),(!C||H[0]&32)&&ne(e,"weapon-expand",F[5]),F[5]?L?(L.p(F,H),H[0]&32&&P(L,1)):(L=ol(F),L.c(),P(L,1),L.m(T.parentNode,T)):L&&(Be(),W(L,1,1,()=>{L=null}),qe())},i(F){C||(P(N),P(g.$$.fragment,F),P(L),C=!0)},o(F){W(N),W(g.$$.fragment,F),W(L),C=!1},d(F){F&&(A(e),A(y),A(T)),n[34](null),V&&V.d(),N.d(F),f(),n[40](null),h(),oe(g),n[46](null),L&&L.d(F),z=!1,we(E)}}}function Im(n,e,t){let i,s,o,r,a,l,c;K(n,Sn,G=>t(30,i=G)),K(n,At,G=>t(31,s=G)),K(n,Tt,G=>t(51,o=G)),K(n,J,G=>t(19,r=G)),K(n,ct,G=>t(20,a=G)),K(n,ps,G=>t(21,l=G)),K(n,dn,G=>t(22,c=G));let{gearBox:u,slotName:d,index:f}=e,h,_,g,v,w,k,y,T=fs,C,z,E,B,j,V=!1,N=!1,I="",O=["Charged Basic Attack","Charged Solar Beam"],Z={basic:!1,special:!1},R={};function L(){if(y)for(let G of y.querySelectorAll(".gearPreview > div")){if(Object.keys(l).includes(G.id=="basic"?C.name:z?z.name:null))return;let fe=Op(G,c);fe&&(G.id=="basic"?U(ps,l[C.name]=fe,l):U(ps,l[z.name]=fe,l))}}function F(G){let fe;if(G.name=="Void Needle")fe=G.base+a[G.type]-a.armor*5.625;else if(T.name=="Pureblood Dagger"){let He,yt={magicDmg:a.magicDmg,meleeDmg:a.meleeDmg,rangedDmg:a.rangedDmg},bt=Object.keys(yt).reduce((nn,vi)=>yt[nn]>yt[vi]?nn:vi),Ft=0;for(let nn in yt)nn!=bt&&(Ft+=yt[nn]);He=a[bt]*2-Ft,fe=G.base+(G.name.includes("HP")?He/2:He)}else if(G.type.includes("/")){let He=G.type.split("/"),yt=0;for(let bt of He)yt+=a[bt]*G[`${bt}Mult`];fe=G.base+yt}else fe=G.base+a[G.type]*G.mult;return N&&(!G.name.includes("HP")||G.name.includes("HP")&&T.name=="Pureblood Dagger")&&(fe+=fe*.08775),j?Math.floor(fe*10)/10:Math.floor(fe)}function H(G){let fe,He=V?0:a[G.type];return T.name=="Celestial Powers Spellbook"?fe=(80+He*1.1)*(.8+2.2*h/100):T.name=="Staff of Dreams"?fe=160+160*h/100+He*(.4+1.3*h/100):T.name=="Nature's Wrath Spellbook"&&(fe=260+400*h/4+He*(1+1.5*h/4)),N&&(fe+=fe*.08775),Math.floor(fe*10)/10}function X(){r.screenshot.ongoing||(t(16,V=!1),t(17,N=!1),j?(t(5,j=!1),u.classList.remove("weapon-expand"),setTimeout(L)):(u.classList.add("weapon-expand"),t(5,j=!0)))}function he(G,fe){e:for(let He in i){let yt=o.bonuses.find(Ft=>Ft.name==He).stats,bt=G?G.type:null;for(let Ft in Ot){if(bt===null)break e;if(T.name=="Void Spike Ultradagger"&&fe=="special"||G.name=="Void Needle"?bt="armor/meleeDmg":T.name=="Pureblood Dagger"?bt=He=="Fish of Rage"?"":"magicDmg/meleeDmg/rangedDmg":T.name=="Gnome Rocket Launcher"&&(bt=""),i[He]&&yt[Ft]!=0&&bt.includes(Ft)){t(18,R[G.name]=!0,R),fe&&t(6,Z[fe]=!0,Z);break e}else t(18,R[G.name]=!1,R),fe&&t(6,Z[fe]=!1,Z)}}}const ue=G=>{(!_.contains(G.target)&&!c||_.contains(G.target)&&g.contains(G.target))&&(t(14,E=!1),t(15,B=!1))},te=G=>{G.key=="Escape"&&(t(14,E=!1),t(15,B=!1))};function q(G){re[G?"unshift":"push"](()=>{k=G,t(12,k)})}const Y=()=>{r.screenshot.ongoing||t(14,E=!E)};function de(G){re[G?"unshift":"push"](()=>{y=G,t(13,y)})}const pe=G=>{Xt(G),X()},me=()=>{c||(U(J,r.item.ongoing=!0,r),U(J,r.item.data={...T,type:"gear"},r))};function ge(){w=this.offsetHeight,t(11,w)}function Fe(G){re[G?"unshift":"push"](()=>{g=G,t(9,g)})}function ie(){v=this.offsetHeight,t(10,v)}function je(G){E=G,t(14,E)}function We(G){j=G,t(5,j)}function ye(G){B=G,t(15,B)}const Ce=()=>{setTimeout(()=>{L(),(!T.name||T.tool)&&j&&X(),t(15,B=!1)})};function x(G){re[G?"unshift":"push"](()=>{_=G,t(8,_)})}const Se=G=>{t(16,V=G.detail),G.detail&&t(17,N=!1)},ht=G=>{t(17,N=G.detail),G.detail&&t(16,V=!1)};function et(G){h=G,t(7,h)}function Q(G){n.$$.not_equal(T.name,G)&&(T.name=G,t(2,T),t(31,s),t(1,f),t(4,z))}return n.$$set=G=>{"gearBox"in G&&t(29,u=G.gearBox),"slotName"in G&&t(0,d=G.slotName),"index"in G&&t(1,f=G.index)},n.$$.update=()=>{if(n.$$.dirty[0]&22|n.$$.dirty[1]&1&&s[f]&&s[f].name!=T.name&&(t(2,T=s[f]),!T.tool&&T.name)){t(3,C=T.moves.filter(G=>G.basic)[0]),t(4,z=T.moves.filter(G=>G.special)[0]),t(18,R={});for(let G of T.moves)t(18,R[G.name]=!1,R),he(G);z&&z.name.includes("Fantastic Beamstorm")?t(23,I="~"):t(23,I="")}if(n.$$.dirty[0]&1073741948&&(i||j)&&!T.tool&&T.name){for(let G in Z)he(G=="basic"?C:z||null,G);for(let G of T.moves)he(G)}},[d,f,T,C,z,j,Z,h,_,g,v,w,k,y,E,B,V,N,R,r,a,l,c,I,O,L,F,H,X,u,i,s,ue,te,q,Y,de,pe,me,ge,Fe,ie,je,We,ye,Ce,x,Se,ht,et,Q]}class Tm extends Re{constructor(e){super(),De(this,e,Im,Sm,ve,{gearBox:29,slotName:0,index:1},null,[-1,-1])}}function ul(n,e,t){const i=n.slice();return i[3]=e[t],i}function dl(n){let e,t,i;function s(r){n[1](r)}let o={slotName:"gear",index:n[3]};return n[0]!==void 0&&(o.gearBox=n[0]),e=new Tm({props:o}),re.push(()=>Me(e,"gearBox",s)),{c(){ae(e.$$.fragment)},m(r,a){se(e,r,a),i=!0},p(r,a){const l={};!t&&a&1&&(t=!0,l.gearBox=r[0],Pe(()=>t=!1)),e.$set(l)},i(r){i||(P(e.$$.fragment,r),i=!0)},o(r){W(e.$$.fragment,r),i=!1},d(r){oe(e,r)}}}function Nm(n){let e,t,i=Oe(mn),s=[];for(let r=0;r<i.length;r+=1)s[r]=dl(ul(n,i,r));const o=r=>W(s[r],1,1,()=>{s[r]=null});return{c(){e=b("div");for(let r=0;r<s.length;r+=1)s[r].c();m(e,"class","gearBox svelte-1lv6xba")},m(r,a){M(r,e,a);for(let l=0;l<s.length;l+=1)s[l]&&s[l].m(e,null);n[2](e),t=!0},p(r,[a]){if(a&1){i=Oe(mn);let l;for(l=0;l<i.length;l+=1){const c=ul(r,i,l);s[l]?(s[l].p(c,a),P(s[l],1)):(s[l]=dl(c),s[l].c(),P(s[l],1),s[l].m(e,null))}for(Be(),l=i.length;l<s.length;l+=1)o(l);qe()}},i(r){if(!t){for(let a=0;a<i.length;a+=1)P(s[a]);t=!0}},o(r){s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)W(s[a]);t=!1},d(r){r&&A(e),ot(s,r),n[2](null)}}}function Om(n,e,t){let i;function s(r){i=r,t(0,i)}function o(r){re[r?"unshift":"push"](()=>{i=r,t(0,i)})}return[i,s,o]}class Dm extends Re{constructor(e){super(),De(this,e,Om,Nm,ve,{})}}function Rm(n){let e,t,i,s,o,r,a,l;return{c(){e=b("div"),t=b("div"),i=b("button"),i.textContent="Clear armor",s=S(),o=b("div"),r=b("button"),r.textContent="Clear gear",m(i,"class","svelte-e94uvj"),m(t,"class","buttonCont svelte-e94uvj"),m(r,"class","svelte-e94uvj"),m(o,"class","buttonCont svelte-e94uvj"),m(e,"class","mainFeatures svelte-e94uvj"),m(e,"id","box")},m(c,u){M(c,e,u),p(e,t),p(t,i),p(e,s),p(e,o),p(o,r),a||(l=[D(i,"click",n[3]),D(r,"click",n[4])],a=!0)},p:le,i:le,o:le,d(c){c&&A(e),a=!1,we(l)}}}function Am(n,e,t){let i,s,o,r,a;K(n,At,f=>t(5,i=f)),K(n,Dn,f=>t(6,s=f)),K(n,Nt,f=>t(7,o=f)),K(n,On,f=>t(8,r=f)),K(n,dn,f=>t(0,a=f));function l(){for(let f in o)o[f].name&&r[f][o[f].name].querySelector("button").click()}function c(){for(let f in i)i[f].name&&s[f][i[f].name].querySelector("button").click()}return[a,l,c,f=>{f.target.blur(),a||l()},f=>{f.target.blur(),a||c()}]}class Pm extends Re{constructor(e){super(),De(this,e,Am,Rm,ve,{})}}function fl(n){let e,t,i;function s(r){n[3](r)}let o={slotName:"sets"};return n[0]!==void 0&&(o.slotOpen=n[0]),e=new jo({props:o}),re.push(()=>Me(e,"slotOpen",s)),{c(){ae(e.$$.fragment)},m(r,a){se(e,r,a),i=!0},p(r,a){const l={};!t&&a&1&&(t=!0,l.slotOpen=r[0],Pe(()=>t=!1)),e.$set(l)},i(r){i||(P(e.$$.fragment,r),i=!0)},o(r){W(e.$$.fragment,r),i=!1},d(r){oe(e,r)}}}function Mm(n){let e,t,i,s,o,r,a=n[1].head&&n[1].body&&n[1].legs&&n[1].feet&&fl(n);return{c(){e=b("button"),e.innerHTML=`Load armor set
    <iconify-icon icon="iconamoon:arrow-down-2-fill" rotate="180deg" class="svelte-l9dczq"></iconify-icon>`,t=S(),a&&a.c(),i=rt(),m(e,"class","svelte-l9dczq"),ne(e,"ddOpen",n[0])},m(l,c){M(l,e,c),M(l,t,c),a&&a.m(l,c),M(l,i,c),s=!0,o||(r=D(e,"click",n[2]),o=!0)},p(l,[c]){(!s||c&1)&&ne(e,"ddOpen",l[0]),l[1].head&&l[1].body&&l[1].legs&&l[1].feet?a?(a.p(l,c),c&2&&P(a,1)):(a=fl(l),a.c(),P(a,1),a.m(i.parentNode,i)):a&&(Be(),W(a,1,1,()=>{a=null}),qe())},i(l){s||(P(a),s=!0)},o(l){W(a),s=!1},d(l){l&&(A(e),A(t),A(i)),a&&a.d(l),o=!1,r()}}}function Lm(n,e,t){let i;K(n,Tt,a=>t(1,i=a));let{ddOpen:s=!1}=e;const o=()=>t(0,s=!s);function r(a){s=a,t(0,s)}return n.$$set=a=>{"ddOpen"in a&&t(0,s=a.ddOpen)},[s,i,o,r]}class Fm extends Re{constructor(e){super(),De(this,e,Lm,Mm,ve,{ddOpen:0})}}function Bm(n){let e;return{c(){e=b("span"),e.textContent="Create some builds to get started!",m(e,"class","tooltip svelte-lhwdnk"),m(e,"id","top"),Je(e,"left","70.5%")},m(t,i){M(t,e,i)},p:le,d(t){t&&A(e)}}}function qm(n){let e;return{c(){e=b("span"),e.textContent="Select some gear or armor to get started!",m(e,"class","tooltip svelte-lhwdnk"),m(e,"id","top"),Je(e,"left",n[3]?"38%":"")},m(t,i){M(t,e,i)},p(t,i){i&8&&Je(e,"left",t[3]?"38%":"")},d(t){t&&A(e)}}}function jm(n){let e,t,i,s,o,r,a,l,c,u,d,f,h,_,g,v,w,k,y,T,C,z,E,B,j,V,N,I;function O(H,X){if(!H[4])return qm;if(!H[3])return Bm}let Z=O(n),R=Z&&Z(n);function L(H){n[18](H)}let F={};return n[1]!==void 0&&(F.ddOpen=n[1]),B=new Fm({props:F}),re.push(()=>Me(B,"ddOpen",L)),{c(){e=b("div"),t=b("div"),i=b("div"),s=b("button"),o=ce("Export new build"),a=S(),l=b("div"),c=b("button"),u=ce("Save to build"),f=S(),h=b("div"),_=b("button"),g=ce("Delete build"),w=S(),R&&R.c(),k=S(),y=b("div"),T=b("div"),C=b("button"),C.textContent="Load build",z=S(),E=b("div"),ae(B.$$.fragment),s.disabled=r=!n[4],m(s,"class","svelte-lhwdnk"),m(i,"class","buttonCont svelte-lhwdnk"),c.disabled=d=!n[4]||!n[3],m(c,"class","svelte-lhwdnk"),m(l,"class","buttonCont svelte-lhwdnk"),m(l,"id","middle"),_.disabled=v=!n[3],m(_,"class","svelte-lhwdnk"),m(h,"class","buttonCont svelte-lhwdnk"),m(t,"id","modify"),m(t,"class","svelte-lhwdnk"),ne(t,"no-tooltip",n[2]),m(C,"class","svelte-lhwdnk"),m(T,"class","buttonCont svelte-lhwdnk"),m(E,"class","buttonCont svelte-lhwdnk"),m(y,"id","load"),m(y,"class","svelte-lhwdnk"),m(e,"class","mainFeatures svelte-lhwdnk"),m(e,"id","build")},m(H,X){M(H,e,X),p(e,t),p(t,i),p(i,s),p(s,o),p(t,a),p(t,l),p(l,c),p(c,u),p(t,f),p(t,h),p(h,_),p(_,g),p(t,w),R&&R.m(t,null),p(e,k),p(e,y),p(y,T),p(T,C),p(y,z),p(y,E),se(B,E,null),n[19](E),V=!0,N||(I=[D(window,"mousedown",n[8]),D(window,"keydown",n[9]),D(s,"click",n[10]),D(s,"mouseenter",n[11]),D(s,"mouseleave",n[12]),D(c,"click",n[13]),D(_,"click",n[14]),D(_,"mouseenter",n[15]),D(_,"mouseleave",n[16]),D(C,"click",n[17])],N=!0)},p(H,[X]){(!V||X&16&&r!==(r=!H[4]))&&(s.disabled=r),(!V||X&24&&d!==(d=!H[4]||!H[3]))&&(c.disabled=d),(!V||X&8&&v!==(v=!H[3]))&&(_.disabled=v),Z===(Z=O(H))&&R?R.p(H,X):(R&&R.d(1),R=Z&&Z(H),R&&(R.c(),R.m(t,null))),(!V||X&4)&&ne(t,"no-tooltip",H[2]);const he={};!j&&X&2&&(j=!0,he.ddOpen=H[1],Pe(()=>j=!1)),B.$set(he)},i(H){V||(P(B.$$.fragment,H),V=!0)},o(H){W(B.$$.fragment,H),V=!1},d(H){H&&A(e),R&&R.d(),oe(B),n[19](null),N=!1,we(I)}}}function zm(n,e,t){let i,s,o,r,a;K(n,wt,E=>t(7,i=E)),K(n,Ut,E=>t(3,s=E)),K(n,no,E=>t(4,o=E)),K(n,dn,E=>t(5,r=E)),K(n,J,E=>t(6,a=E));let l,c=!1,u=!1;const d=E=>{l.contains(E.target)||t(1,c=!1)},f=E=>{E.key=="Escape"&&t(1,c=!1)},h=()=>{o&&!r&&U(J,a.export.ongoing=!0,a)},_=()=>t(2,u=!0),g=()=>t(2,u=!1),v=()=>{o&&s&&!r&&U(J,a.save.ongoing=!0,a)},w=()=>{s&&!r&&U(J,a.delete.ongoing=!0,a)},k=()=>t(2,u=!0),y=()=>t(2,u=!1),T=()=>{r||U(J,a.load.ongoing=!0,a)};function C(E){c=E,t(1,c)}function z(E){re[E?"unshift":"push"](()=>{l=E,t(0,l)})}return n.$$.update=()=>{n.$$.dirty&128&&U(Ut,s=Object.keys(i).length>0,s)},[l,c,u,s,o,r,a,i,d,f,h,_,g,v,w,k,y,T,C,z]}class Wm extends Re{constructor(e){super(),De(this,e,zm,jm,ve,{})}}function hl(n){let e;return{c(){e=b("span"),e.textContent="New changes! Exiting will erase them.",m(e,"id","alert")},m(t,i){M(t,e,i)},d(t){t&&A(e)}}}function Hm(n){let e,t,i,s,o,r,a,l=25-n[3].length+"",c,u,d,f,h,_,g,v,w,k,y,T=275-n[4].length+"",C,z,E,B,j,V,N,I,O,Z,R,L,F,H,X,he,ue=(n[3]||n[4])&&hl();return{c(){e=b("div"),t=b("div"),i=ce(`Name:\r
        `),s=b("input"),r=S(),a=b("span"),c=ce(l),u=S(),d=b("div"),f=b("div"),h=b("span"),h.textContent="Description / Notes:",_=S(),ue&&ue.c(),g=S(),v=b("textarea"),k=S(),y=b("span"),C=ce(T),z=S(),E=b("div"),B=b("div"),j=b("button"),V=ce("CANCEL"),I=S(),O=b("div"),Z=b("button"),R=ce("EXPORT"),m(s,"class","buildNameInput"),m(s,"id","firstFocusable"),s.disabled=o=n[5].export.status==0,m(s,"type","text"),m(s,"placeholder",n[6]),m(s,"maxlength","25"),m(a,"class","charCounter svelte-1vypdkl"),m(a,"id","buildName"),m(t,"class","buildNameCont svelte-1vypdkl"),m(v,"class","buildDescInput"),v.disabled=w=n[5].export.status==0,m(v,"placeholder","[Empty]"),m(v,"maxlength","275"),m(v,"autocomplete","off"),m(y,"class","charCounter"),m(y,"id","buildDesc"),m(d,"class","buildDescCont"),j.disabled=N=n[5].export.status==0,m(Z,"id","lastFocusable"),Z.disabled=L=n[5].export.status==0,m(E,"class","promptOptions"),m(e,"class","buildExporter svelte-1vypdkl")},m(te,q){M(te,e,q),p(e,t),p(t,i),p(t,s),n[8](s),Dt(s,n[3]),p(t,r),p(t,a),p(a,c),p(e,u),p(e,d),p(d,f),p(f,h),p(f,_),ue&&ue.m(f,null),p(d,g),p(d,v),Dt(v,n[4]),n[13](v),p(d,k),p(d,y),p(y,C),p(e,z),p(e,E),p(E,B),p(B,j),p(j,V),n[16](j),p(E,I),p(E,O),p(O,Z),p(Z,R),H=!0,X||(he=[D(s,"input",n[9]),D(s,"input",n[10]),D(s,"keydown",n[11]),D(v,"input",n[12]),D(v,"input",n[14]),D(v,"keydown",n[15]),D(j,"click",n[17]),D(Z,"click",n[18]),D(Z,"keydown",ft),D(e,"introstart",n[19])],X=!0)},p(te,[q]){(!H||q&32&&o!==(o=te[5].export.status==0))&&(s.disabled=o),q&8&&s.value!==te[3]&&Dt(s,te[3]),(!H||q&8)&&l!==(l=25-te[3].length+"")&&Ne(c,l),te[3]||te[4]?ue||(ue=hl(),ue.c(),ue.m(f,null)):ue&&(ue.d(1),ue=null),(!H||q&32&&w!==(w=te[5].export.status==0))&&(v.disabled=w),q&16&&Dt(v,te[4]),(!H||q&16)&&T!==(T=275-te[4].length+"")&&Ne(C,T),(!H||q&32&&N!==(N=te[5].export.status==0))&&(j.disabled=N),(!H||q&32&&L!==(L=te[5].export.status==0))&&(Z.disabled=L)},i(te){H||(te&&ke(()=>{H&&(F||(F=be(e,Ye,{duration:250},!0)),F.run(1))}),H=!0)},o(te){te&&(F||(F=be(e,Ye,{duration:250},!1)),F.run(0)),H=!1},d(te){te&&A(e),n[8](null),ue&&ue.d(),n[13](null),n[16](null),te&&F&&F.end(),X=!1,we(he)}}}function Um(n,e,t){let i,s,o,r,a,l;K(n,J,O=>t(5,i=O)),K(n,_t,O=>t(20,s=O)),K(n,Ut,O=>t(21,o=O)),K(n,At,O=>t(22,r=O)),K(n,Nt,O=>t(23,a=O)),K(n,wt,O=>t(24,l=O));let c=Object.keys(l).length,u,d,f,h="",_="",g=`My ${c+1+$c[(c+1)%10]} build`;function v(){if(U(J,i.export.status=0,i),h.endsWith(" ")&&t(3,h=h.replace(/  +/g," ").replace(/ $/,"")),_.endsWith(" ")&&t(4,_=_.replace(/  +/g," ").replace(/ $/,"")),Object.keys(l).includes(h)){U(J,i.export.status=-1,i),U(J,i.message="duplicate_name",i);return}let O=lp(zt(Mn(Fn),"builds")).key,Z=nu(a,r);Z.name=h||g,Z.desc=_||"[Empty]",ls(zt(Mn(Fn),`builds/${O}`),Z).then(()=>{U(J,i.export.status=1,i),U(Ut,o=!0,o),qo(),wt.update(R=>({...R,[Z.name]:{id:O,desc:Z.desc}})),U(_t,s=Z,s),U(_t,s.id=O,s),navigator.clipboard.writeText(`${location.origin+location.pathname}?id=${O}`)}).catch(()=>{U(J,i.export.status=-1,i),U(J,i.message="firebase_fail",i)})}function w(O){re[O?"unshift":"push"](()=>{u=O,t(0,u)})}function k(){h=this.value,t(3,h)}const y=O=>{t(3,h=Yi(O.target.value,25))},T=O=>{i.export.status==0&&O.preventDefault(),dt(O),Qs(u,O.target.value,25)};function C(){_=this.value,t(4,_)}function z(O){re[O?"unshift":"push"](()=>{d=O,t(1,d)})}const E=O=>{t(4,_=Yi(O.target.value,275))},B=O=>{i.export.status==0&&O.preventDefault(),Qs(d,O.target.value,275)};function j(O){re[O?"unshift":"push"](()=>{f=O,t(2,f)})}return[u,d,f,h,_,i,g,v,w,k,y,T,C,z,E,B,j,()=>{i.export.status!=0&&U(J,i.export.ongoing=!1,i)},()=>{i.export.status!=0&&v()},()=>f.focus()]}class Gm extends Re{constructor(e){super(),De(this,e,Um,Hm,ve,{})}}function Vm(n){let e,t,i,s,o=n[2]?"Copied!":"Copy link",r,a,l;return{c(){e=b("button"),t=b("b"),t.textContent="Build link",i=S(),s=b("span"),r=ce(o),m(s,"class","tooltip"),m(s,"id","top"),m(e,"class","copyButton svelte-1e8zrsj"),m(e,"id","firstFocusable")},m(c,u){M(c,e,u),p(e,t),p(e,i),p(e,s),p(s,r),a||(l=[D(e,"click",n[7]),D(e,"keydown",dt)],a=!0)},p(c,u){u&4&&o!==(o=c[2]?"Copied!":"Copy link")&&Ne(r,o)},d(c){c&&A(e),a=!1,we(l)}}}function Km(n){let e,t,i,s,o,r,a=n[2]?"Copied!":"Copy ID",l,c,u,d;return{c(){e=b("button"),t=b("b"),t.textContent="ID:",i=S(),s=ce(n[4]),o=S(),r=b("span"),l=ce(a),m(r,"class","tooltip"),m(r,"id","top"),m(e,"class","copyButton svelte-1e8zrsj"),m(e,"id",c=n[1]!="save"?"firstFocusable":"")},m(f,h){M(f,e,h),p(e,t),p(e,i),p(e,s),p(e,o),p(e,r),p(r,l),u||(d=[D(e,"click",n[5]),D(e,"keydown",n[6])],u=!0)},p(f,h){h&4&&a!==(a=f[2]?"Copied!":"Copy ID")&&Ne(l,a),h&2&&c!==(c=f[1]!="save"?"firstFocusable":"")&&m(e,"id",c)},d(f){f&&A(e),u=!1,we(d)}}}function Ym(n){let e;function t(o,r){if(o[0]=="id")return Km;if(o[0]=="link")return Vm}let i=t(n),s=i&&i(n);return{c(){s&&s.c(),e=rt()},m(o,r){s&&s.m(o,r),M(o,e,r)},p(o,[r]){i===(i=t(o))&&s?s.p(o,r):(s&&s.d(1),s=i&&i(o),s&&(s.c(),s.m(e.parentNode,e)))},i:le,o:le,d(o){o&&A(e),s&&s.d(o)}}}function Qm(n,e,t){let i;K(n,_t,f=>t(8,i=f));let{type:s,source:o}=e,r=!1;function a(f){r||(navigator.clipboard.writeText(f),t(2,r=!0),setTimeout(()=>t(2,r=!1),1e3))}let l=i?i.id:null;const c=()=>a(l),u=()=>{o!="save"&&dt()},d=()=>a(`${location.origin+location.pathname}?id=${l}`);return n.$$set=f=>{"type"in f&&t(0,s=f.type),"source"in f&&t(1,o=f.source)},[s,o,r,a,l,c,u,d]}class di extends Re{constructor(e){super(),De(this,e,Qm,Ym,ve,{type:0,source:1})}}function Xm(n){let e,t,i,s;return e=new di({props:{type:"link",source:"share"}}),i=new di({props:{type:"id",source:"share"}}),{c(){ae(e.$$.fragment),t=S(),ae(i.$$.fragment)},m(o,r){se(e,o,r),M(o,t,r),se(i,o,r),s=!0},p:le,i(o){s||(P(e.$$.fragment,o),P(i.$$.fragment,o),s=!0)},o(o){W(e.$$.fragment,o),W(i.$$.fragment,o),s=!1},d(o){o&&A(t),oe(e,o),oe(i,o)}}}function Jm(n){let e;return{c(){e=b("span"),e.textContent="Your build has been erased from your local saves and the database."},m(t,i){M(t,e,i)},p:le,i:le,o:le,d(t){t&&A(e)}}}function Zm(n){let e;function t(o,r){if(o[2].message=="not_found")return ng;if(o[2].message=="invalid_id")return tg}let i=t(n),s=i&&i(n);return{c(){s&&s.c(),e=rt()},m(o,r){s&&s.m(o,r),M(o,e,r)},p(o,r){i!==(i=t(o))&&(s&&s.d(1),s=i&&i(o),s&&(s.c(),s.m(e.parentNode,e)))},i:le,o:le,d(o){o&&A(e),s&&s.d(o)}}}function xm(n){let e,t,i,s,o,r;return i=new di({props:{type:"link",source:"save"}}),o=new di({props:{type:"id",source:"save"}}),{c(){e=b("span"),e.textContent="Your build has been overwritten.",t=S(),ae(i.$$.fragment),s=S(),ae(o.$$.fragment)},m(a,l){M(a,e,l),M(a,t,l),se(i,a,l),M(a,s,l),se(o,a,l),r=!0},p:le,i(a){r||(P(i.$$.fragment,a),P(o.$$.fragment,a),r=!0)},o(a){W(i.$$.fragment,a),W(o.$$.fragment,a),r=!1},d(a){a&&(A(e),A(t),A(s)),oe(i,a),oe(o,a)}}}function $m(n){let e,t,i,s;const o=[sg,ig],r=[];function a(l,c){return l[2].export.status==1?0:l[2].export.status==-1&&l[2].message=="duplicate_name"?1:-1}return~(e=a(n))&&(t=r[e]=o[e](n)),{c(){t&&t.c(),i=rt()},m(l,c){~e&&r[e].m(l,c),M(l,i,c),s=!0},p(l,c){let u=e;e=a(l),e!==u&&(t&&(Be(),W(r[u],1,1,()=>{r[u]=null}),qe()),~e?(t=r[e],t||(t=r[e]=o[e](l),t.c()),P(t,1),t.m(i.parentNode,i)):t=null)},i(l){s||(P(t),s=!0)},o(l){W(t),s=!1},d(l){l&&A(i),~e&&r[e].d(l)}}}function eg(n){let e,t,i=n[2].export.status?"exporting":n[2].save.status?"saving":n[2].load.status?"loading":"deleting",s,o,r,a,l,c,u,d;return{c(){e=b("span"),t=ce("A problem occurred while "),s=ce(i),o=ce(` your build.\r
            `),r=b("br"),a=ce(`\r
            If needed`),l=b("b"),l.textContent=",",c=ce(" you may contact "),u=b("hl"),u.textContent="xt.ss",d=ce(` on Discord for more\r
            details.`)},m(f,h){M(f,e,h),p(e,t),p(e,s),p(e,o),p(e,r),p(e,a),p(e,l),p(e,c),p(e,u),p(e,d)},p(f,h){h&4&&i!==(i=f[2].export.status?"exporting":f[2].save.status?"saving":f[2].load.status?"loading":"deleting")&&Ne(s,i)},i:le,o:le,d(f){f&&A(e)}}}function tg(n){let e;return{c(){e=b("span"),e.textContent="The ID you have entered is invalid. Please check it again."},m(t,i){M(t,e,i)},d(t){t&&A(e)}}}function ng(n){let e;return{c(){e=b("span"),e.innerHTML=`Your build could not be found within the database.
                <br/>
                If needed<b>,</b> you may contact <hl>xt.ss</hl> on Discord for more
                details.`},m(t,i){M(t,e,i)},d(t){t&&A(e)}}}function ig(n){let e;return{c(){e=b("span"),e.innerHTML=`Another build of yours with the same name already exists.
                <br/>
                Please use a different one.`},m(t,i){M(t,e,i)},i:le,o:le,d(t){t&&A(e)}}}function sg(n){let e,t,i,s;return i=new di({props:{type:"id",source:"export"}}),{c(){e=b("span"),e.textContent="Your build's link has been copied to your clipboard.",t=S(),ae(i.$$.fragment)},m(o,r){M(o,e,r),M(o,t,r),se(i,o,r),s=!0},i(o){s||(P(i.$$.fragment,o),s=!0)},o(o){W(i.$$.fragment,o),s=!1},d(o){o&&(A(e),A(t)),oe(i,o)}}}function og(n){let e,t,i,s,o,r,a,l,c,u,d,f,h,_,g,v,w;const k=[eg,$m,xm,Zm,Jm,Xm],y=[];function T(C,z){return C[1]==-1&&C[2].message=="firebase_fail"?0:C[2].export.status?1:C[2].save.status==1?2:C[2].load.status==-1?3:C[2].delete.status==1?4:C[2].share.ongoing?5:-1}return~(o=T(n))&&(r=y[o]=k[o](n)),{c(){e=b("div"),t=b("span"),i=ce(n[4]),s=S(),r&&r.c(),a=S(),l=b("div"),c=b("div"),u=b("button"),d=ce("OK"),m(t,"id","messageTitle"),m(t,"class","svelte-nfbx2w"),m(u,"id",f=(n[1]==-1?"firstFocusable ":"")+"lastFocusable"),m(l,"class","promptOptions svelte-nfbx2w"),m(e,"class","promptMessage svelte-nfbx2w")},m(C,z){M(C,e,z),p(e,t),p(t,i),p(e,s),~o&&y[o].m(e,null),p(e,a),p(e,l),p(l,c),p(c,u),p(u,d),n[6](u),g=!0,v||(w=[D(u,"click",n[7]),D(u,"keydown",n[8]),D(e,"introstart",n[9])],v=!0)},p(C,[z]){(!g||z&16)&&Ne(i,C[4]);let E=o;o=T(C),o===E?~o&&y[o].p(C,z):(r&&(Be(),W(y[E],1,1,()=>{y[E]=null}),qe()),~o?(r=y[o],r?r.p(C,z):(r=y[o]=k[o](C),r.c()),P(r,1),r.m(e,a)):r=null),(!g||z&2&&f!==(f=(C[1]==-1?"firstFocusable ":"")+"lastFocusable"))&&m(u,"id",f)},i(C){g||(P(r),C&&ke(()=>{g&&(_&&_.end(1),h=aa(e,Ye,{duration:200,delay:75}),h.start())}),g=!0)},o(C){W(r),h&&h.invalidate(),C&&(_=ca(e,Ye,{duration:200})),g=!1},d(C){C&&A(e),~o&&y[o].d(),n[6](null),C&&_&&_.end(),v=!1,we(w)}}}function rg(n,e,t){let i,s,o;K(n,J,h=>t(2,o=h));let{loadID:r}=e;const a=Mt();let l;function c(h){re[h?"unshift":"push"](()=>{l=h,t(3,l)})}const u=()=>{t(0,r=null),a("resetActions")},d=h=>{s==-1&&dt(h),ft(h)},f=()=>l.focus();return n.$$set=h=>{"loadID"in h&&t(0,r=h.loadID)},n.$$.update=()=>{n.$$.dirty&4&&t(1,s=o.export.status||o.save.status||o.load.status||o.delete.status),n.$$.dirty&6&&t(4,i=o.share.ongoing?"Share this build":`${o.export.status?"Export":o.save.status?"Save":o.load.status?"Load":"Delete"} ${s==1?"Success":"Failure"}!`)},[r,s,o,l,i,a,c,u,d,f]}class lg extends Re{constructor(e){super(),De(this,e,rg,og,ve,{loadID:0})}}function ag(n){let e,t,i,s,o,r;return{c(){e=b("li"),t=b("button"),i=b("span"),s=ce(n[0]),m(i,"class","svelte-1opo0ke"),m(e,"class","svelte-1opo0ke"),ne(e,"selectedItem",n[2])},m(a,l){M(a,e,l),p(e,t),p(t,i),p(i,s),n[7](e),o||(r=D(t,"click",n[3]),o=!0)},p(a,[l]){l&1&&Ne(s,a[0]),l&4&&ne(e,"selectedItem",a[2])},i:le,o:le,d(a){a&&A(e),n[7](null),o=!1,r()}}}function cg(n,e,t){let{chosenBuild:i,buildData:s,buildName:o,ddOpen:r}=e;const a=Mt();let l,c=i[0]==o;function u(){if(r){if(l.classList.contains("selectedItem")||t(2,c=!1),c)return;a("buildSelect",l),t(2,c=!0),t(5,r=!1),t(4,i=[o,s])}}function d(f){re[f?"unshift":"push"](()=>{l=f,t(1,l)})}return n.$$set=f=>{"chosenBuild"in f&&t(4,i=f.chosenBuild),"buildData"in f&&t(6,s=f.buildData),"buildName"in f&&t(0,o=f.buildName),"ddOpen"in f&&t(5,r=f.ddOpen)},[o,l,c,u,i,r,s,d]}class ug extends Re{constructor(e){super(),De(this,e,cg,ag,ve,{chosenBuild:4,buildData:6,buildName:0,ddOpen:5})}}function _l(n,e,t){const i=n.slice();return i[25]=e[t][0],i[26]=e[t][1],i}function pl(n){let e,t,i,s;function o(l){n[13](l)}function r(l){n[14](l)}let a={buildData:n[26],buildName:n[25]};return n[0]!==void 0&&(a.chosenBuild=n[0]),n[1]!==void 0&&(a.ddOpen=n[1]),e=new ug({props:a}),re.push(()=>Me(e,"chosenBuild",o)),re.push(()=>Me(e,"ddOpen",r)),e.$on("buildSelect",n[11]),{c(){ae(e.$$.fragment)},m(l,c){se(e,l,c),s=!0},p(l,c){const u={};c&16&&(u.buildData=l[26]),c&16&&(u.buildName=l[25]),!t&&c&1&&(t=!0,u.chosenBuild=l[0],Pe(()=>t=!1)),!i&&c&2&&(i=!0,u.ddOpen=l[1],Pe(()=>i=!1)),e.$set(u)},i(l){s||(P(e.$$.fragment,l),s=!0)},o(l){W(e.$$.fragment,l),s=!1},d(l){oe(e,l)}}}function dg(n){let e,t,i,s,o,r,a,l=Oe(Object.entries(n[4])),c=[];for(let d=0;d<l.length;d+=1)c[d]=pl(_l(n,l,d));const u=d=>W(c[d],1,1,()=>{c[d]=null});return{c(){e=b("div"),t=b("input"),i=S(),s=b("ul");for(let d=0;d<c.length;d+=1)c[d].c();m(t,"type","text"),m(t,"class","searchBarInput svelte-p20blu"),m(t,"placeholder","Search..."),m(s,"class","svelte-p20blu"),ne(s,"no-scrollbar",n[8].length<=4),m(e,"class","dropdown svelte-p20blu"),ne(e,"ddOpen",n[1])},m(d,f){M(d,e,f),p(e,t),n[12](t),p(e,i),p(e,s);for(let h=0;h<c.length;h+=1)c[h]&&c[h].m(s,null);n[15](s),n[16](e),o=!0,r||(a=[D(t,"input",n[10]),D(t,"keydown",n[9]),D(e,"transitionend",n[17]),D(e,"transitioncancel",n[18])],r=!0)},p(d,[f]){if(f&2067){l=Oe(Object.entries(d[4]));let h;for(h=0;h<l.length;h+=1){const _=_l(d,l,h);c[h]?(c[h].p(_,f),P(c[h],1)):(c[h]=pl(_),c[h].c(),P(c[h],1),c[h].m(s,null))}for(Be(),h=l.length;h<c.length;h+=1)u(h);qe()}(!o||f&256)&&ne(s,"no-scrollbar",d[8].length<=4),(!o||f&2)&&ne(e,"ddOpen",d[1])},i(d){if(!o){for(let f=0;f<l.length;f+=1)P(c[f]);o=!0}},o(d){c=c.filter(Boolean);for(let f=0;f<c.length;f+=1)W(c[f]);o=!1},d(d){d&&A(e),n[12](null),ot(c,d),n[15](null),n[16](null),r=!1,we(a)}}}function fg(n,e,t){let i;K(n,wt,I=>t(4,i=I));let{chosenBuild:s,ddOpen:o=!1,dropdown:r}=e;const a=Mt();let l,c,u,d,f={},h=!1,_=[];function g(I){!I.shiftKey&&I.key=="Tab"&&(I.preventDefault(),setTimeout(()=>l.focus()))}function v(){c&&c.removeEventListener("keydown",g),y(),c&&c.addEventListener("keydown",g)}function w(I){I.shiftKey&&I.key=="Tab"&&(I.preventDefault(),setTimeout(()=>(c.querySelector("button")||c).focus()))}function k(){tu(l.value,f),v()}function y(){c&&c.classList.remove("lastElement"),t(8,_=u.querySelectorAll("li:not(.hidden)")),c=_[_.length-1],c?c.classList.add("lastElement"):c=l}function T(I){a("buildSelect"),t(6,d=I.detail);let O=u.querySelector(".selectedItem");O&&O!=I.detail&&O.classList.remove("selectedItem"),t(7,h=!0)}function C(I){re[I?"unshift":"push"](()=>{l=I,t(5,l)})}function z(I){s=I,t(0,s)}function E(I){o=I,t(1,o)}function B(I){re[I?"unshift":"push"](()=>{u=I,t(3,u)})}function j(I){re[I?"unshift":"push"](()=>{r=I,t(2,r)})}const V=I=>{I.propertyName=="visibility"&&(h&&(t(7,h=!1),t(5,l.value="",l),k()),!o&&d&&u.scrollTo(0,d.offsetTop),Ki(l,o))},N=I=>{I.propertyName=="visibility"&&(t(7,h=!1),Ki(l,o))};return n.$$set=I=>{"chosenBuild"in I&&t(0,s=I.chosenBuild),"ddOpen"in I&&t(1,o=I.ddOpen),"dropdown"in I&&t(2,r=I.dropdown)},n.$$.update=()=>{if(n.$$.dirty&24&&u){t(8,_=u.querySelectorAll("li:not(.hidden)"));for(let I=0;I<u.childElementCount;I++)f[Object.keys(i)[I]]=u.children[I];y(),v()}},[s,o,r,u,i,l,d,h,_,w,k,T,C,z,E,B,j,V,N]}class zo extends Re{constructor(e){super(),De(this,e,fg,dg,ve,{chosenBuild:0,ddOpen:1,dropdown:2})}}function ml(n){let e,t=(n[6]>n[5]*.8?n[11].slice(0,20)+"<b>...</b>":n[11])+"",i;return{c(){e=b("span"),ke(()=>n[15].call(e))},m(s,o){M(s,e,o),e.innerHTML=t,i=Jt(e,n[15].bind(e))},p(s,o){o[0]&2144&&t!==(t=(s[6]>s[5]*.8?s[11].slice(0,20)+"<b>...</b>":s[11])+"")&&(e.innerHTML=t)},d(s){s&&A(e),i()}}}function gl(n){let e;return{c(){e=b("span"),e.textContent="New changes! Exiting will erase them.",m(e,"id","alert")},m(t,i){M(t,e,i)},d(t){t&&A(e)}}}function hg(n){let e,t,i,s,o,r=n[11],a,l,c,u,d,f,h,_,g,v,w,k,y,T,C=275-n[2].length+"",z,E,B,j,V,N,I,O,Z,R,L,F,H,X,he,ue,te,q,Y,de,pe,me=ml(n),ge=n[1]!=null&&n[1]!=n[2]&&gl();function Fe(ye){n[26](ye)}function ie(ye){n[27](ye)}function je(ye){n[28](ye)}let We={};return n[0]!==void 0&&(We.chosenBuild=n[0]),n[3]!==void 0&&(We.ddOpen=n[3]),n[9]!==void 0&&(We.dropdown=n[9]),X=new zo({props:We}),re.push(()=>Me(X,"chosenBuild",Fe)),re.push(()=>Me(X,"ddOpen",ie)),re.push(()=>Me(X,"dropdown",je)),X.$on("buildSelect",n[29]),{c(){e=b("div"),t=b("div"),i=b("span"),i.textContent="Save to:",s=S(),o=b("button"),me.c(),a=S(),l=b("iconify-icon"),d=S(),f=b("div"),h=b("div"),_=b("span"),_.textContent="Description / Notes:",g=S(),ge&&ge.c(),v=S(),w=b("textarea"),y=S(),T=b("span"),z=ce(C),E=S(),B=b("div"),j=b("div"),V=b("button"),N=ce("CANCEL"),O=S(),Z=b("div"),R=b("button"),L=ce("SAVE"),H=S(),ae(X.$$.fragment),Ae(l,"icon","iconamoon:arrow-down-2-fill"),m(o,"id","firstFocusable"),o.disabled=c=n[12].save.status==0,m(o,"class","promptDDButton svelte-106wt5q"),ke(()=>n[17].call(o)),ne(o,"ddOpen",n[3]),m(t,"class","chosenBuildCont"),m(w,"class","buildDescInput"),w.disabled=k=n[12].save.status==0,m(w,"placeholder","[Empty]"),m(w,"maxlength","275"),m(w,"autocomplete","off"),m(T,"class","charCounter"),m(T,"id","buildDesc"),m(f,"class","buildDescCont"),V.disabled=I=n[12].save.status==0,m(R,"id","lastFocusable"),R.disabled=F=n[12].save.status==0,m(B,"class","promptOptions"),m(e,"class","buildSaver")},m(ye,Ce){M(ye,e,Ce),p(e,t),p(t,i),p(t,s),p(t,o),me.m(o,null),p(o,a),p(o,l),n[16](o),u=Jt(o,n[17].bind(o)),p(e,d),p(e,f),p(f,h),p(h,_),p(h,g),ge&&ge.m(h,null),p(f,v),p(f,w),n[19](w),Dt(w,n[10]),p(f,y),p(f,T),p(T,z),p(e,E),p(e,B),p(B,j),p(j,V),p(V,N),n[23](V),p(B,O),p(B,Z),p(Z,R),p(R,L),p(e,H),se(X,e,null),Y=!0,de||(pe=[D(window,"mousedown",n[14]),D(o,"click",n[18]),D(o,"keydown",dt),D(w,"input",n[20]),D(w,"input",n[21]),D(w,"keydown",n[22]),D(V,"click",n[24]),D(R,"click",n[25]),D(R,"keydown",ft),D(e,"introstart",n[30]),D(e,"keydown",n[31])],de=!0)},p(ye,Ce){Ce[0]&2048&&ve(r,r=ye[11])?(me.d(1),me=ml(ye),me.c(),me.m(o,a)):me.p(ye,Ce),(!Y||Ce[0]&4096&&c!==(c=ye[12].save.status==0))&&(o.disabled=c),(!Y||Ce[0]&8)&&ne(o,"ddOpen",ye[3]),ye[1]!=null&&ye[1]!=ye[2]?ge||(ge=gl(),ge.c(),ge.m(h,null)):ge&&(ge.d(1),ge=null),(!Y||Ce[0]&4096&&k!==(k=ye[12].save.status==0))&&(w.disabled=k),Ce[0]&1024&&Dt(w,ye[10]),(!Y||Ce[0]&4)&&C!==(C=275-ye[2].length+"")&&Ne(z,C),(!Y||Ce[0]&4096&&I!==(I=ye[12].save.status==0))&&(V.disabled=I),(!Y||Ce[0]&4096&&F!==(F=ye[12].save.status==0))&&(R.disabled=F);const x={};!he&&Ce[0]&1&&(he=!0,x.chosenBuild=ye[0],Pe(()=>he=!1)),!ue&&Ce[0]&8&&(ue=!0,x.ddOpen=ye[3],Pe(()=>ue=!1)),!te&&Ce[0]&512&&(te=!0,x.dropdown=ye[9],Pe(()=>te=!1)),X.$set(x)},i(ye){Y||(P(X.$$.fragment,ye),ye&&ke(()=>{Y&&(q||(q=be(e,Ye,{duration:250},!0)),q.run(1))}),Y=!0)},o(ye){W(X.$$.fragment,ye),ye&&(q||(q=be(e,Ye,{duration:250},!1)),q.run(0)),Y=!1},d(ye){ye&&A(e),me.d(ye),n[16](null),u(),ge&&ge.d(),n[19](null),n[23](null),oe(X),ye&&q&&q.end(),de=!1,we(pe)}}}function _g(n,e,t){let i,s,o,r,a,l,c,u;K(n,J,q=>t(12,r=q)),K(n,_t,q=>t(32,a=q)),K(n,wt,q=>t(33,l=q)),K(n,At,q=>t(34,c=q)),K(n,Nt,q=>t(35,u=q));let d=!1,f,h,_,g,v,w,k=Object.entries(l)[0],y=null;function T(){U(J,r.save.status=0,r);let q=nu(u,c),Y=y==null?s:y==""?"[Empty]":y,de=k[1].id;q.name=i,q.desc=Y,ls(zt(Mn(Fn),`builds/${de}`),q).then(()=>{U(J,r.save.status=1,r);let pe={...l};pe[i].desc=Y,qo(),wt.update(()=>pe),U(_t,a=q,a),U(_t,a.id=de,a)}).catch(()=>{U(J,r.save.status=-1,r),U(J,r.message="firebase_fail",r)})}const C=q=>{!f.contains(q.target)&&!w.contains(q.target)&&t(3,d=!1)};function z(){_=this.offsetWidth,t(6,_)}function E(q){re[q?"unshift":"push"](()=>{f=q,t(4,f)})}function B(){h=this.offsetWidth,t(5,h)}const j=()=>{r.save.status!=0&&t(3,d=!d)};function V(q){re[q?"unshift":"push"](()=>{g=q,t(7,g)})}function N(){o=this.value,t(10,o),t(1,y),t(2,s),t(0,k)}const I=q=>{t(1,y=Yi(q.target.value,275))},O=q=>{r.save.status==0&&q.preventDefault(),Qs(g,q.target.value,275)};function Z(q){re[q?"unshift":"push"](()=>{v=q,t(8,v)})}const R=()=>{r.save.status!=0&&U(J,r.save.ongoing=!1,r)},L=()=>{r.save.status!=0&&T()};function F(q){k=q,t(0,k)}function H(q){d=q,t(3,d)}function X(q){w=q,t(9,w)}const he=()=>t(1,y=null),ue=()=>v.focus(),te=q=>{q.key=="Escape"&&(t(3,d=!1),f.focus())};return n.$$.update=()=>{n.$$.dirty[0]&1&&t(11,i=k[0]),n.$$.dirty[0]&1&&t(2,s=k[1].desc),n.$$.dirty[0]&6&&t(10,o=y??s)},[k,y,s,d,f,h,_,g,v,w,o,i,r,T,C,z,E,B,j,V,N,I,O,Z,R,L,F,H,X,he,ue,te]}class pg extends Re{constructor(e){super(),De(this,e,_g,hg,ve,{},null,[-1,-1])}}function mg(n){let e,t,i,s,o,r,a,l,c;return{c(){e=b("div"),t=b("span"),t.textContent="ID:",i=S(),s=b("input"),m(s,"class","buildIDInput svelte-w8elgk"),s.disabled=o=n[11].load.status==0,m(s,"type","text"),m(s,"placeholder","Example ID: -NDqeA1Scn0EAJcYWN3b"),m(s,"maxlength","25"),m(e,"class","buildIDCont svelte-w8elgk")},m(u,d){M(u,e,d),p(e,t),p(e,i),p(e,s),n[23](s),Dt(s,n[10]),a=!0,l||(c=[D(s,"input",n[24]),D(s,"input",n[25]),D(s,"keydown",n[26])],l=!0)},p(u,d){(!a||d[0]&2048&&o!==(o=u[11].load.status==0))&&(s.disabled=o),d[0]&1024&&s.value!==u[10]&&Dt(s,u[10])},i(u){a||(u&&ke(()=>{a&&(r||(r=be(e,Ke,{duration:150},!0)),r.run(1))}),a=!0)},o(u){u&&(r||(r=be(e,Ke,{duration:150},!1)),r.run(0)),a=!1},d(u){u&&A(e),n[23](null),u&&r&&r.end(),l=!1,we(c)}}}function gg(n){let e,t,i,s,o=n[9],r,a,l,c,u,d,f,h,_=bl(n);return{c(){e=b("div"),t=b("span"),t.textContent="Load:",i=S(),s=b("button"),_.c(),r=S(),a=b("iconify-icon"),Ae(a,"icon","iconamoon:arrow-down-2-fill"),s.disabled=l=n[11].load.status==0,m(s,"class","promptDDButton svelte-w8elgk"),ke(()=>n[21].call(s)),ne(s,"ddOpen",n[8]),m(e,"class","chosenBuildCont svelte-w8elgk")},m(g,v){M(g,e,v),p(e,t),p(e,i),p(e,s),_.m(s,null),p(s,r),p(s,a),n[20](s),c=Jt(s,n[21].bind(s)),d=!0,f||(h=D(s,"click",n[22]),f=!0)},p(g,v){v[0]&512&&ve(o,o=g[9])?(_.d(1),_=bl(g),_.c(),_.m(s,r)):_.p(g,v),(!d||v[0]&2048&&l!==(l=g[11].load.status==0))&&(s.disabled=l),(!d||v[0]&256)&&ne(s,"ddOpen",g[8])},i(g){d||(g&&ke(()=>{d&&(u||(u=be(e,Ke,{duration:150},!0)),u.run(1))}),d=!0)},o(g){g&&(u||(u=be(e,Ke,{duration:150},!1)),u.run(0)),d=!1},d(g){g&&A(e),_.d(g),n[20](null),c(),g&&u&&u.end(),f=!1,h()}}}function bl(n){let e,t=(n[6]>n[5]*.7?n[9].slice(0,20)+"<b>...</b>":n[9])+"",i;return{c(){e=b("span"),ke(()=>n[19].call(e))},m(s,o){M(s,e,o),e.innerHTML=t,i=Jt(e,n[19].bind(e))},p(s,o){o[0]&608&&t!==(t=(s[6]>s[5]*.7?s[9].slice(0,20)+"<b>...</b>":s[9])+"")&&(e.innerHTML=t)},d(s){s&&A(e),i()}}}function vl(n){let e,t,i,s,o;function r(u){n[29](u)}function a(u){n[30](u)}function l(u){n[31](u)}let c={};return n[3]!==void 0&&(c.chosenBuild=n[3]),n[8]!==void 0&&(c.ddOpen=n[8]),n[7]!==void 0&&(c.dropdown=n[7]),e=new zo({props:c}),re.push(()=>Me(e,"chosenBuild",r)),re.push(()=>Me(e,"ddOpen",a)),re.push(()=>Me(e,"dropdown",l)),{c(){ae(e.$$.fragment)},m(u,d){se(e,u,d),o=!0},p(u,d){const f={};!t&&d[0]&8&&(t=!0,f.chosenBuild=u[3],Pe(()=>t=!1)),!i&&d[0]&256&&(i=!0,f.ddOpen=u[8],Pe(()=>i=!1)),!s&&d[0]&128&&(s=!0,f.dropdown=u[7],Pe(()=>s=!1)),e.$set(f)},i(u){o||(P(e.$$.fragment,u),o=!0)},o(u){W(e.$$.fragment,u),o=!1},d(u){oe(e,u)}}}function bg(n){let e,t,i,s,o,r,a,l,c,u,d,f,h,_,g,v,w,k,y,T,C,z,E,B,j,V,N,I,O,Z,R,L,F,H,X;const he=[gg,mg],ue=[];function te(Y,de){return Y[2]?0:1}k=te(n),y=ue[k]=he[k](n);let q=n[2]&&vl(n);return{c(){e=b("div"),t=b("span"),t.textContent="Load build via:",i=S(),s=b("div"),o=b("div"),r=b("button"),a=ce("Local saves"),u=S(),d=b("div"),f=b("button"),h=ce("Exported ID"),v=S(),w=b("div"),y.c(),T=S(),C=b("div"),z=b("div"),E=b("button"),B=ce("CANCEL"),V=S(),N=b("div"),I=b("button"),O=ce("LOAD"),R=S(),q&&q.c(),m(t,"class","svelte-w8elgk"),m(r,"id",l=n[2]?"firstFocusable":""),r.disabled=c=n[11].load.status==0||!n[12],m(r,"class","svelte-w8elgk"),ne(r,"chosen",n[2]),ne(r,"unavailable",!n[12]),m(o,"class","svelte-w8elgk"),m(f,"id",_=n[2]?"":"firstFocusable"),f.disabled=g=n[11].load.status==0,m(f,"class","svelte-w8elgk"),ne(f,"chosen",!n[2]),m(d,"class","svelte-w8elgk"),m(s,"class","loadMethodRadio svelte-w8elgk"),m(w,"class","loadMethodCont svelte-w8elgk"),E.disabled=j=n[11].load.status==0,m(I,"id","lastFocusable"),I.disabled=Z=n[11].load.status==0,m(C,"class","promptOptions svelte-w8elgk"),m(e,"class","buildLoader svelte-w8elgk")},m(Y,de){M(Y,e,de),p(e,t),p(e,i),p(e,s),p(s,o),p(o,r),p(r,a),p(s,u),p(s,d),p(d,f),p(f,h),p(e,v),p(e,w),ue[k].m(w,null),p(e,T),p(e,C),p(C,z),p(z,E),p(E,B),n[27](E),p(C,V),p(C,N),p(N,I),p(I,O),p(e,R),q&&q.m(e,null),F=!0,H||(X=[D(window,"mousedown",n[14]),D(r,"click",n[15]),D(r,"keydown",n[16]),D(f,"click",n[17]),D(f,"keydown",n[18]),D(E,"click",n[28]),D(I,"keydown",ft),D(I,"click",n[13]),D(e,"introstart",n[32]),D(e,"keydown",n[33])],H=!0)},p(Y,de){(!F||de[0]&4&&l!==(l=Y[2]?"firstFocusable":""))&&m(r,"id",l),(!F||de[0]&6144&&c!==(c=Y[11].load.status==0||!Y[12]))&&(r.disabled=c),(!F||de[0]&4)&&ne(r,"chosen",Y[2]),(!F||de[0]&4096)&&ne(r,"unavailable",!Y[12]),(!F||de[0]&4&&_!==(_=Y[2]?"":"firstFocusable"))&&m(f,"id",_),(!F||de[0]&2048&&g!==(g=Y[11].load.status==0))&&(f.disabled=g),(!F||de[0]&4)&&ne(f,"chosen",!Y[2]);let pe=k;k=te(Y),k===pe?ue[k].p(Y,de):(Be(),W(ue[pe],1,1,()=>{ue[pe]=null}),qe(),y=ue[k],y?y.p(Y,de):(y=ue[k]=he[k](Y),y.c()),P(y,1),y.m(w,null)),(!F||de[0]&2048&&j!==(j=Y[11].load.status==0))&&(E.disabled=j),(!F||de[0]&2048&&Z!==(Z=Y[11].load.status==0))&&(I.disabled=Z),Y[2]?q?(q.p(Y,de),de[0]&4&&P(q,1)):(q=vl(Y),q.c(),P(q,1),q.m(e,null)):q&&(Be(),W(q,1,1,()=>{q=null}),qe())},i(Y){F||(P(y),P(q),Y&&ke(()=>{F&&(L||(L=be(e,Ye,{duration:250},!0)),L.run(1))}),F=!0)},o(Y){W(y),W(q),Y&&(L||(L=be(e,Ye,{duration:250},!1)),L.run(0)),F=!1},d(Y){Y&&A(e),ue[k].d(),n[27](null),q&&q.d(),Y&&L&&L.end(),H=!1,we(X)}}}function vg(n,e,t){let i,s,o;K(n,J,q=>t(11,i=q)),K(n,wt,q=>t(34,s=q)),K(n,Ut,q=>t(12,o=q));const r=Mt();let a,l,c,u,d,f,h=o,_=!1,g=o?Object.entries(s)[0]:null,v,w="";function k(){if(!h&&!w.startsWith("-N")){U(J,i.load.status=-1,i),U(J,i.message="invalid_id",i);return}let q=Qc(Mn(Fn,"builds"),Yc()),Y=0;U(J,i.load.status=0,i),Kc(q).then(de=>{let pe=h?g[1].id:w;for(let me in de.val()){if(me==pe){r("buildLoad",{build:de.val()[me],id:me});break}else Y==Object.keys(de.val()).length-1&&(U(J,i.load.status=-1,i),U(J,i.message=h?"not_found":"invalid_id",i));Y++}}).catch(()=>{U(J,i.load.status=-1,i),U(J,i.message="firebase_fail",i)})}const y=q=>{a&&!a.contains(q.target)&&!f.contains(q.target)&&t(8,_=!1)},T=()=>{i.load.status!=0&&o&&t(2,h=!0)},C=q=>{h&&dt(q)},z=()=>{i.load.status!=0&&t(2,h=!1)},E=q=>{h||dt(q)};function B(){d=this.offsetWidth,t(6,d)}function j(q){re[q?"unshift":"push"](()=>{a=q,t(0,a)})}function V(){u=this.offsetWidth,t(5,u)}const N=()=>{i.load.status!=0&&t(8,_=!_)};function I(q){re[q?"unshift":"push"](()=>{c=q,t(1,c)})}function O(){w=this.value,t(10,w)}const Z=q=>{t(10,w=Yi(q.target.value,25))},R=q=>{i.load.status==0&&q.preventDefault()};function L(q){re[q?"unshift":"push"](()=>{l=q,t(4,l)})}const F=()=>{i.load.status!=0&&U(J,i.load.ongoing=!1,i)};function H(q){g=q,t(3,g)}function X(q){_=q,t(8,_)}function he(q){f=q,t(7,f)}const ue=()=>l.focus(),te=q=>{q.key=="Escape"&&(t(8,_=!1),a.focus())};return n.$$.update=()=>{n.$$.dirty[0]&8&&t(9,v=g!=null?g[0]:null),n.$$.dirty[0]&7&&setTimeout(h?()=>a.focus():()=>c.focus())},[a,c,h,g,l,u,d,f,_,v,w,i,o,k,y,T,C,z,E,B,j,V,N,I,O,Z,R,L,F,H,X,he,ue,te]}class yg extends Re{constructor(e){super(),De(this,e,vg,bg,ve,{},null,[-1,-1])}}function yl(n){let e,t=(n[3]>n[4]*.8?n[8].slice(0,20)+"<b>...</b>":n[8])+"",i;return{c(){e=b("span"),ke(()=>n[12].call(e))},m(s,o){M(s,e,o),e.innerHTML=t,i=Jt(e,n[12].bind(e))},p(s,o){o&280&&t!==(t=(s[3]>s[4]*.8?s[8].slice(0,20)+"<b>...</b>":s[8])+"")&&(e.innerHTML=t)},d(s){s&&A(e),i()}}}function wg(n){let e,t,i,s,o,r=n[8],a,l,c,u,d,f,h,_,g,v,w,k,y,T,C,z,E,B,j,V,N,I,O,Z,R,L,F,H,X=yl(n);f=new at({props:{text:"I'm aware that this action is irreversible and want to erase this build from the database."}}),f.$on("toggle",n[16]);function he(Y){n[21](Y)}function ue(Y){n[22](Y)}function te(Y){n[23](Y)}let q={};return n[0]!==void 0&&(q.chosenBuild=n[0]),n[6]!==void 0&&(q.ddOpen=n[6]),n[5]!==void 0&&(q.dropdown=n[5]),N=new zo({props:q}),re.push(()=>Me(N,"chosenBuild",he)),re.push(()=>Me(N,"ddOpen",ue)),re.push(()=>Me(N,"dropdown",te)),{c(){e=b("div"),t=b("div"),i=b("span"),i.textContent="Delete:",s=S(),o=b("button"),X.c(),a=S(),l=b("iconify-icon"),d=S(),ae(f.$$.fragment),h=S(),_=b("div"),g=b("div"),v=b("button"),w=ce("CANCEL"),T=S(),C=b("div"),z=b("button"),E=ce("DELETE"),V=S(),ae(N.$$.fragment),Ae(l,"icon","iconamoon:arrow-down-2-fill"),m(o,"class","promptDDButton svelte-1t9ajmz"),m(o,"id","firstFocusable"),o.disabled=c=n[9].delete.status==0,ke(()=>n[14].call(o)),ne(o,"ddOpen",n[6]),m(t,"class","chosenBuildCont"),m(v,"id",k=n[7]?"":"lastFocusable"),v.disabled=y=n[9].delete.status==0,z.disabled=B=!n[7]||n[9].delete.status==0,m(z,"id",j=n[7]?"lastFocusable":""),ne(z,"unavailable",!n[7]),m(_,"class","promptOptions svelte-1t9ajmz"),m(e,"class","buildDeleter svelte-1t9ajmz")},m(Y,de){M(Y,e,de),p(e,t),p(t,i),p(t,s),p(t,o),X.m(o,null),p(o,a),p(o,l),n[13](o),u=Jt(o,n[14].bind(o)),p(e,d),se(f,e,null),p(e,h),p(e,_),p(_,g),p(g,v),p(v,w),n[17](v),p(_,T),p(_,C),p(C,z),p(z,E),p(e,V),se(N,e,null),L=!0,F||(H=[D(window,"mousedown",n[11]),D(o,"click",n[15]),D(o,"keydown",dt),D(v,"click",n[18]),D(v,"keydown",n[19]),D(z,"click",n[20]),D(z,"keydown",ft),D(e,"introstart",n[24]),D(e,"keydown",n[25])],F=!0)},p(Y,[de]){de&256&&ve(r,r=Y[8])?(X.d(1),X=yl(Y),X.c(),X.m(o,a)):X.p(Y,de),(!L||de&512&&c!==(c=Y[9].delete.status==0))&&(o.disabled=c),(!L||de&64)&&ne(o,"ddOpen",Y[6]),(!L||de&128&&k!==(k=Y[7]?"":"lastFocusable"))&&m(v,"id",k),(!L||de&512&&y!==(y=Y[9].delete.status==0))&&(v.disabled=y),(!L||de&640&&B!==(B=!Y[7]||Y[9].delete.status==0))&&(z.disabled=B),(!L||de&128&&j!==(j=Y[7]?"lastFocusable":""))&&m(z,"id",j),(!L||de&128)&&ne(z,"unavailable",!Y[7]);const pe={};!I&&de&1&&(I=!0,pe.chosenBuild=Y[0],Pe(()=>I=!1)),!O&&de&64&&(O=!0,pe.ddOpen=Y[6],Pe(()=>O=!1)),!Z&&de&32&&(Z=!0,pe.dropdown=Y[5],Pe(()=>Z=!1)),N.$set(pe)},i(Y){L||(P(f.$$.fragment,Y),P(N.$$.fragment,Y),Y&&ke(()=>{L&&(R||(R=be(e,Ye,{duration:250},!0)),R.run(1))}),L=!0)},o(Y){W(f.$$.fragment,Y),W(N.$$.fragment,Y),Y&&(R||(R=be(e,Ye,{duration:250},!1)),R.run(0)),L=!1},d(Y){Y&&A(e),X.d(Y),n[13](null),u(),oe(f),n[17](null),oe(N),Y&&R&&R.end(),F=!1,we(H)}}}function kg(n,e,t){let i,s,o,r;K(n,J,R=>t(9,s=R)),K(n,wt,R=>t(26,o=R)),K(n,_t,R=>t(27,r=R));let a,l,c,u,d,f=!1,h=Object.entries(o)[0],_=!1;function g(){U(J,s.delete.status=0,s);let R=h[1].id;ap(zt(Mn(Fn),`builds/${R}`)).then(()=>{U(J,s.delete.status=1,s),r&&R==r.id&&U(_t,r=null,r);let L={...o};delete L[i],qo(),wt.update(()=>L)}).catch(L=>{U(J,s.delete.status=-1,s),U(J,s.message="firebase_fail",s)})}const v=R=>{!l.contains(R.target)&&!d.contains(R.target)&&t(6,f=!1)};function w(){c=this.offsetWidth,t(3,c)}function k(R){re[R?"unshift":"push"](()=>{l=R,t(2,l)})}function y(){u=this.offsetWidth,t(4,u)}const T=()=>{s.delete.status!=0&&t(6,f=!f)},C=R=>t(7,_=R.detail);function z(R){re[R?"unshift":"push"](()=>{a=R,t(1,a)})}const E=()=>{s.delete.status!=0&&U(J,s.delete.ongoing=!1,s)},B=R=>{_||ft(R)},j=()=>{_&&s.delete.status!=0&&g()};function V(R){h=R,t(0,h)}function N(R){f=R,t(6,f)}function I(R){d=R,t(5,d)}const O=()=>a.focus(),Z=R=>{R.key=="Escape"&&(t(6,f=!1),l.focus())};return n.$$.update=()=>{n.$$.dirty&1&&t(8,i=h[0])},[h,a,l,c,u,d,f,_,i,s,g,v,w,k,y,T,C,z,E,B,j,V,N,I,O,Z]}class Cg extends Re{constructor(e){super(),De(this,e,kg,wg,ve,{})}}function Eg(n){let e,t,i,s,o,r,a,l,c,u,d,f,h,_;return{c(){e=b("div"),t=b("div"),i=b("button"),i.innerHTML='<iconify-icon icon="tabler:coins" class="svelte-czj12i"></iconify-icon> <span class="tooltip" id="right">Build costs</span>',s=S(),o=b("div"),r=b("button"),r.innerHTML='<iconify-icon icon="codicon:sparkle-filled" class="svelte-czj12i"></iconify-icon> <span class="tooltip" id="right">Add bonuses</span>',a=S(),l=b("div"),c=b("button"),c.innerHTML='<iconify-icon icon="fa-solid:random" class="svelte-czj12i"></iconify-icon> <span class="tooltip" id="right">Randomize build</span>',u=S(),d=b("div"),f=b("button"),f.innerHTML='<iconify-icon icon="fe:picture" class="svelte-czj12i"></iconify-icon> <span class="tooltip" id="right">Screenshot mode</span>',m(i,"class","svelte-czj12i"),m(t,"class","svelte-czj12i"),m(r,"class","svelte-czj12i"),m(o,"class","svelte-czj12i"),m(c,"class","svelte-czj12i"),m(l,"id","randomize"),m(l,"class","svelte-czj12i"),m(f,"class","svelte-czj12i"),m(d,"id","screenshot"),m(d,"class","svelte-czj12i"),m(e,"class","sideFeatures svelte-czj12i")},m(g,v){M(g,e,v),p(e,t),p(t,i),p(e,s),p(e,o),p(o,r),p(e,a),p(e,l),p(l,c),p(e,u),p(e,d),p(d,f),h||(_=[D(i,"click",n[2]),D(r,"click",n[3]),D(c,"click",n[4]),D(f,"click",n[5])],h=!0)},p:le,i:le,o:le,d(g){g&&A(e),h=!1,we(_)}}}function Sg(n,e,t){let i,s;return K(n,dn,c=>t(0,i=c)),K(n,J,c=>t(1,s=c)),[i,s,c=>{Xt(c),i||U(J,s.costs.ongoing=!0,s)},c=>{Xt(c),i||U(J,s.bonus.ongoing=!0,s)},c=>{Xt(c),i||U(J,s.randomize.ongoing=!0,s)},()=>{i||(U(J,s.screenshot.ongoing=!0,s),setTimeout(()=>U(J,s.screenshot.ongoing=!1,s),3500))}]}class Ig extends Re{constructor(e){super(),De(this,e,Sg,Eg,ve,{})}}function wl(n,e,t){const i=n.slice();i[11]=e[t];const s=i[1].bonuses[0].name==i[11].name;return i[12]=s,i}function kl(n){let e,t,i,s,o,r,a,l,c,u,d,f;function h(...g){return n[5](n[12],...g)}function _(...g){return n[6](n[11],...g)}return l=new at({props:{text:n[11].name,checked:n[2][n[11].name]}}),l.$on("toggle",_),{c(){e=b("div"),t=b("a"),i=b("img"),a=S(),ae(l.$$.fragment),c=S(),Xe(i.src,s=n[11].image)||m(i,"src",s),m(i,"alt",""),m(i,"class","svelte-1xnyxhr"),m(t,"id",o=n[12]?"firstFocusable":""),m(t,"href",r=n[11].link),m(t,"target","_blank"),m(t,"class","svelte-1xnyxhr"),m(e,"class","svelte-1xnyxhr")},m(g,v){M(g,e,v),p(e,t),p(t,i),p(e,a),se(l,e,null),p(e,c),u=!0,d||(f=D(t,"keydown",h),d=!0)},p(g,v){n=g,(!u||v&2&&!Xe(i.src,s=n[11].image))&&m(i,"src",s),(!u||v&2&&o!==(o=n[12]?"firstFocusable":""))&&m(t,"id",o),(!u||v&2&&r!==(r=n[11].link))&&m(t,"href",r);const w={};v&2&&(w.text=n[11].name),v&6&&(w.checked=n[2][n[11].name]),l.$set(w)},i(g){u||(P(l.$$.fragment,g),u=!0)},o(g){W(l.$$.fragment,g),u=!1},d(g){g&&A(e),oe(l),d=!1,f()}}}function Tg(n){let e,t,i,s,o,r,a,l,c,u,d,f,h,_=Oe(n[1].bonuses),g=[];for(let w=0;w<_.length;w+=1)g[w]=kl(wl(n,_,w));const v=w=>W(g[w],1,1,()=>{g[w]=null});return{c(){e=b("div"),t=b("div");for(let w=0;w<g.length;w+=1)g[w].c();i=S(),s=b("div"),o=b("div"),r=b("button"),r.textContent="CLEAR",a=S(),l=b("div"),c=b("button"),c.textContent="OK",m(t,"class","bonusesCont svelte-1xnyxhr"),m(c,"id","lastFocusable"),m(s,"class","promptOptions svelte-1xnyxhr"),m(e,"class","bonusChooser svelte-1xnyxhr")},m(w,k){M(w,e,k),p(e,t);for(let y=0;y<g.length;y+=1)g[y]&&g[y].m(t,null);p(e,i),p(e,s),p(s,o),p(o,r),p(s,a),p(s,l),p(l,c),n[8](c),d=!0,f||(h=[D(r,"click",n[7]),D(c,"click",n[9]),D(c,"keydown",ft),D(e,"introstart",n[10])],f=!0)},p(w,[k]){if(k&14){_=Oe(w[1].bonuses);let y;for(y=0;y<_.length;y+=1){const T=wl(w,_,y);g[y]?(g[y].p(T,k),P(g[y],1)):(g[y]=kl(T),g[y].c(),P(g[y],1),g[y].m(t,null))}for(Be(),y=_.length;y<g.length;y+=1)v(y);qe()}},i(w){if(!d){for(let k=0;k<_.length;k+=1)P(g[k]);w&&ke(()=>{d&&(u||(u=be(e,Ye,{duration:250},!0)),u.run(1))}),d=!0}},o(w){g=g.filter(Boolean);for(let k=0;k<g.length;k+=1)W(g[k]);w&&(u||(u=be(e,Ye,{duration:250},!1)),u.run(0)),d=!1},d(w){w&&A(e),ot(g,w),n[8](null),w&&u&&u.end(),f=!1,we(h)}}}function Ng(n,e,t){let i,s,o,r;K(n,Tt,_=>t(1,i=_)),K(n,Sn,_=>t(2,s=_)),K(n,ct,_=>t(3,o=_)),K(n,J,_=>t(4,r=_));let a;const l=(_,g)=>{_&&dt(g)},c=(_,g)=>{U(Sn,s[_.name]=g.detail,s);for(let v in o)g.detail?U(ct,o[v]+=_.stats[v],o):U(ct,o[v]-=_.stats[v],o),U(ct,o[v]=Math.round(o[v]*10)/10,o)},u=()=>{for(let _ in s){if(!s[_])continue;let g=i.bonuses.find(v=>v.name==_);U(Sn,s[_]=!1,s);for(let v in o)U(ct,o[v]-=g.stats[v],o),U(ct,o[v]=Math.round(o[v]*10)/10,o)}};function d(_){re[_?"unshift":"push"](()=>{a=_,t(0,a)})}return[a,i,s,o,r,l,c,u,d,()=>U(J,r.bonus.ongoing=!1,r),()=>a.focus()]}class Og extends Re{constructor(e){super(),De(this,e,Ng,Tg,ve,{})}}function Dg(n){let e;return{c(){e=b("span"),e.textContent=`Includes equipment such as ore-based armor and their variants,\r
            ore-based weapons, and shoes with no special stats`,m(e,"slot","tooltip"),m(e,"class","tooltip svelte-19uqsbs"),m(e,"id","right")},m(t,i){M(t,e,i)},p:le,d(t){t&&A(e)}}}function Rg(n){let e,t,i,s,o,r,a,l,c,u,d,f,h,_,g,v,w,k,y,T,C,z,E,B,j,V;return s=new at({props:{text:"Force Mushroom Parasol",checked:n[0].parasol,first:!0}}),s.$on("toggle",n[5]),r=new at({props:{text:"Randomize armor",checked:n[0].armor}}),r.$on("toggle",n[6]),l=new at({props:{text:"Randomize gear",checked:n[0].gear}}),l.$on("toggle",n[7]),u=new at({props:{text:"Allow 'basic' equipment",checked:n[0].basic,$$slots:{tooltip:[Dg]},$$scope:{ctx:n}}}),u.$on("toggle",n[8]),{c(){e=b("div"),t=b("span"),t.textContent="Randomize your build",i=S(),ae(s.$$.fragment),o=S(),ae(r.$$.fragment),a=S(),ae(l.$$.fragment),c=S(),ae(u.$$.fragment),d=S(),f=b("div"),h=b("div"),_=b("button"),g=ce("CANCEL"),w=S(),k=b("div"),y=b("button"),T=ce("ROLL THE DICE"),m(t,"class","svelte-19uqsbs"),m(_,"id",v=n[2]?"":"lastFocusable"),m(y,"id",C=n[2]?"lastFocusable":""),y.disabled=z=!n[2],m(f,"class","promptOptions"),m(e,"class","buildRandomizer svelte-19uqsbs")},m(N,I){M(N,e,I),p(e,t),p(e,i),se(s,e,null),p(e,o),se(r,e,null),p(e,a),se(l,e,null),p(e,c),se(u,e,null),p(e,d),p(e,f),p(f,h),p(h,_),p(_,g),n[9](_),p(f,w),p(f,k),p(k,y),p(y,T),B=!0,j||(V=[D(_,"click",n[10]),D(_,"keydown",n[11]),D(y,"click",n[12]),D(y,"keydown",n[13]),D(e,"introstart",n[14])],j=!0)},p(N,[I]){const O={};I&1&&(O.checked=N[0].parasol),s.$set(O);const Z={};I&1&&(Z.checked=N[0].armor),r.$set(Z);const R={};I&1&&(R.checked=N[0].gear),l.$set(R);const L={};I&1&&(L.checked=N[0].basic),I&16777216&&(L.$$scope={dirty:I,ctx:N}),u.$set(L),(!B||I&4&&v!==(v=N[2]?"":"lastFocusable"))&&m(_,"id",v),(!B||I&4&&C!==(C=N[2]?"lastFocusable":""))&&m(y,"id",C),(!B||I&4&&z!==(z=!N[2]))&&(y.disabled=z)},i(N){B||(P(s.$$.fragment,N),P(r.$$.fragment,N),P(l.$$.fragment,N),P(u.$$.fragment,N),N&&ke(()=>{B&&(E||(E=be(e,Ye,{duration:250},!0)),E.run(1))}),B=!0)},o(N){W(s.$$.fragment,N),W(r.$$.fragment,N),W(l.$$.fragment,N),W(u.$$.fragment,N),N&&(E||(E=be(e,Ye,{duration:250},!1)),E.run(0)),B=!1},d(N){N&&A(e),oe(s),oe(r),oe(l),oe(u),n[9](null),N&&E&&E.end(),j=!1,we(V)}}}function Ag(n,e,t){let i,s,o,r,a,l,c,u;K(n,Un,N=>t(0,s=N)),K(n,J,N=>t(3,o=N)),K(n,Tt,N=>t(15,r=N)),K(n,Dn,N=>t(16,a=N)),K(n,At,N=>t(17,l=N)),K(n,On,N=>t(18,c=N)),K(n,Nt,N=>t(19,u=N));let d,f=["Bronze","Iron","Cobalt","Titanium","Gold","Onyx"],h=["Hardened","Royal"],_=["Black","Brown","Green","Red","White","Dark","Golden","Grey","Phantom"];function g(){if(s.armor){for(let N of Ln){let I=u[N]||ds;I.name&&c[N][I.name].querySelector("button").click()}setTimeout(()=>{for(let N of Ln)(function I(){let O=Math.floor(Math.random()*r[N].length);!c[N][r[N][O].name].classList.contains("selectedItem")&&(s.basic||!s.basic&&!v(r[N][O].name))?c[N][r[N][O].name].querySelector("button").click():I()})()})}if(s.gear){for(let N in l){let I=l[N]||fs;I.name&&a[N][I.name].querySelector("button").click()}setTimeout(()=>{let N=!1,I=mn.length,O=mn.length,Z=[];for(let R in l)Z.push(l[R].name);(function R(){setTimeout(()=>{let L=Math.floor(Math.random()*I);(function F(){let H=Math.floor(Math.random()*r.gear.length);!Z.includes(r.gear[H].name)&&!a[O][r.gear[H].name].classList.contains("switchable")&&(!N||N&&H!=0)&&(s.basic||!s.basic&&!v(r.gear[H].name))?(a[O][r.gear[!N&&s.parasol&&!L?0:H].name].querySelector("button").click(),!N&&!L?N=!0:N||I--):F()})(),--O&&R()},25)})()},50)}U(J,o.randomize.ongoing=!1,o)}function v(N){let I=!1,O=N.split(" ");return I=f.includes(O[0])||h.includes(O[0])||N=="Mining Helmet"||_.includes(O[0]),I}const w=N=>U(Un,s.parasol=N.detail,s),k=N=>U(Un,s.armor=N.detail,s),y=N=>U(Un,s.gear=N.detail,s),T=N=>U(Un,s.basic=N.detail,s);function C(N){re[N?"unshift":"push"](()=>{d=N,t(1,d)})}const z=()=>U(J,o.randomize.ongoing=!1,o),E=N=>{i||ft(N)},B=()=>{i&&g()},j=N=>{i&&ft(N)},V=()=>d.focus();return n.$$.update=()=>{n.$$.dirty&1&&t(2,i=s.armor||s.gear)},[s,d,i,o,g,w,k,y,T,C,z,E,B,j,V]}class Pg extends Re{constructor(e){super(),De(this,e,Ag,Rg,ve,{})}}function Cl(n,e,t){const i=n.slice();return i[5]=e[t],i}function Mg(n){let e,t=Oe(n[1]),i=[];for(let s=0;s<t.length;s+=1)i[s]=El(Cl(n,t,s));return{c(){for(let s=0;s<i.length;s+=1)i[s].c();e=rt()},m(s,o){for(let r=0;r<i.length;r+=1)i[r]&&i[r].m(s,o);M(s,e,o)},p(s,o){if(o&2){t=Oe(s[1]);let r;for(r=0;r<t.length;r+=1){const a=Cl(s,t,r);i[r]?i[r].p(a,o):(i[r]=El(a),i[r].c(),i[r].m(e.parentNode,e))}for(;r<i.length;r+=1)i[r].d(1);i.length=t.length}},d(s){s&&A(e),ot(i,s)}}}function Lg(n){let e,t,i;return{c(){e=b("span"),t=ce(" "),i=ce(n[1]),m(e,"id","info"),m(e,"class","svelte-ipufpe")},m(s,o){M(s,e,o),p(e,t),p(e,i)},p(s,o){o&2&&Ne(i,s[1])},d(s){s&&A(e)}}}function El(n){let e,t,i=n[5]+"",s;return{c(){e=b("span"),t=ce(" "),s=ce(i),m(e,"id","info"),m(e,"class","svelte-ipufpe")},m(o,r){M(o,e,r),p(e,t),p(e,s)},p(o,r){r&2&&i!==(i=o[5]+"")&&Ne(s,i)},d(o){o&&A(e)}}}function Fg(n){let e,t,i,s,o,r,a;function l(d,f){return typeof d[1]=="string"?Lg:Mg}let c=l(n),u=c(n);return{c(){e=b("li"),t=b("span"),i=ce("v"),s=ce(n[0]),o=S(),r=b("i"),r.textContent=`${n[3][n[2][1]-1]+" "+n[2][0]+(Math.floor(n[2][0]/10)===1?"th":$c[n[2][0]%10])+", 20"+n[2][2]}`,a=S(),u.c(),m(t,"id","version"),m(t,"class","svelte-ipufpe"),m(r,"id","date"),m(r,"class","svelte-ipufpe"),m(e,"class","svelte-ipufpe")},m(d,f){M(d,e,f),p(e,t),p(t,i),p(t,s),p(e,o),p(e,r),p(e,a),u.m(e,null)},p(d,[f]){f&1&&Ne(s,d[0]),c===(c=l(d))&&u?u.p(d,f):(u.d(1),u=c(d),u&&(u.c(),u.m(e,null)))},i:le,o:le,d(d){d&&A(e),u.d()}}}function Bg(n,e,t){let{version:i,date:s,text:o}=e,r=s.split("/"),a=["January","February","March","April","May","June","July","August","Semptember","October","November","December"];return n.$$set=l=>{"version"in l&&t(0,i=l.version),"date"in l&&t(4,s=l.date),"text"in l&&t(1,o=l.text)},[i,o,r,a,s]}class st extends Re{constructor(e){super(),De(this,e,Bg,Fg,ve,{version:0,date:4,text:1})}}function qg(n){let e,t,i,s,o,r,a,l,c,u,d,f,h,_,g,v,w,k,y,T,C,z,E,B,j,V,N,I,O,Z,R,L,F,H,X,he,ue,te,q,Y,de,pe,me,ge,Fe;return o=new st({props:{version:"3.26.5",date:"22/3/24",text:"Added policy information"}}),a=new st({props:{version:"3.26.4",date:"21/3/24",text:["Added feature to copy stats as text","Fixed detailed view prompt activating while scrolling"]}}),c=new st({props:{version:"3.26.3",date:"24/2/24",text:"Reimplemented 'Strict' filter type in search options"}}),d=new st({props:{version:"3.26.2",date:"22/2/24",text:"Fixed build randomizer not working properly"}}),h=new st({props:{version:"3.26.1",date:"22/2/24",text:"Holding Shift and interacting with a dropdown item or simply holding down on it activates detailed view prompt"}}),g=new st({props:{version:"3.26.0",date:"21/2/24",text:"Added detailed view prompt to armor and gear whenever the selected item's icon is clicked"}}),w=new st({props:{version:"3.25.9",date:"14/1/24",text:"Added build costs visibility while 'screenshot mode' is active"}}),y=new st({props:{version:"3.25.8",date:"11/1/24",text:"Fixed mutually exclusive gear staying disabled when deselecting the selected item"}}),C=new st({props:{version:"3.25.7",date:"9/1/24",text:["Enabled 'unsaved changes' prompt to appear before leaving site when certain conditions are met","Fixed dropdowns blocking interactions behind them for a short period after being closed","Fixed dropdown sort incorrectly defaulting to the last sorted list in some cases"]}}),E=new st({props:{version:"3.25.6",date:"7/1/24",text:"Fixed armor filter not working properly when 'Exclusive' filter type and 'No Stats' option were selected"}}),j=new st({props:{version:"3.25.5",date:"6/1/24",text:["Fixed issue with switching gear slots while full weapon view was on","Tools are now selectable even if full weapon view is on"]}}),N=new st({props:{version:"3.25.4",date:"5/1/24",text:'Fixed crash caused by using the build randomizer while "Force Mushroom Parasol" option was on'}}),O=new st({props:{version:"3.25.3",date:"5/1/24",text:["Added feature to swap gear slots when clicking on an already selected gear item","Added visual cues to both deselecting and swapping options for dropdown items"]}}),R=new st({props:{version:"3.25.2",date:"3/1/24",text:["Replaced 'Strict' filter type with 'Exclusive' filter type in search options of dropdowns","Added icons to resource links and credits"]}}),F=new st({props:{version:"3.25.1",date:"2/1/24",text:`"Allow 'basic' equipment" option is no longer restricted when "Randomize gear" option isn't selected in the build randomizer`}}),X=new st({props:{version:"3.25.0",date:"2/1/24",text:["Added 'Build Costs' feature","Removed spectacles from 'basic' equipment pool in the build randomizer"]}}),ue=new st({props:{version:"3.24.5",date:"31/12/23",text:"v3 Release"}}),{c(){e=b("div"),t=b("span"),t.textContent="Changelog",i=S(),s=b("ul"),ae(o.$$.fragment),r=S(),ae(a.$$.fragment),l=S(),ae(c.$$.fragment),u=S(),ae(d.$$.fragment),f=S(),ae(h.$$.fragment),_=S(),ae(g.$$.fragment),v=S(),ae(w.$$.fragment),k=S(),ae(y.$$.fragment),T=S(),ae(C.$$.fragment),z=S(),ae(E.$$.fragment),B=S(),ae(j.$$.fragment),V=S(),ae(N.$$.fragment),I=S(),ae(O.$$.fragment),Z=S(),ae(R.$$.fragment),L=S(),ae(F.$$.fragment),H=S(),ae(X.$$.fragment),he=S(),ae(ue.$$.fragment),te=S(),q=b("div"),Y=b("div"),de=b("button"),de.textContent="OK",m(t,"id","title"),m(s,"id","contents"),m(s,"class","svelte-1k91i9r"),m(de,"id","firstFocusable lastFocusable"),m(q,"class","promptOptions svelte-1k91i9r"),m(e,"class","infoPrompt svelte-1k91i9r")},m(ie,je){M(ie,e,je),p(e,t),p(e,i),p(e,s),se(o,s,null),p(s,r),se(a,s,null),p(s,l),se(c,s,null),p(s,u),se(d,s,null),p(s,f),se(h,s,null),p(s,_),se(g,s,null),p(s,v),se(w,s,null),p(s,k),se(y,s,null),p(s,T),se(C,s,null),p(s,z),se(E,s,null),p(s,B),se(j,s,null),p(s,V),se(N,s,null),p(s,I),se(O,s,null),p(s,Z),se(R,s,null),p(s,L),se(F,s,null),p(s,H),se(X,s,null),p(s,he),se(ue,s,null),p(e,te),p(e,q),p(q,Y),p(Y,de),n[2](de),me=!0,ge||(Fe=[D(de,"click",n[3]),D(de,"keydown",n[4]),D(e,"introstart",n[5])],ge=!0)},p:le,i(ie){me||(P(o.$$.fragment,ie),P(a.$$.fragment,ie),P(c.$$.fragment,ie),P(d.$$.fragment,ie),P(h.$$.fragment,ie),P(g.$$.fragment,ie),P(w.$$.fragment,ie),P(y.$$.fragment,ie),P(C.$$.fragment,ie),P(E.$$.fragment,ie),P(j.$$.fragment,ie),P(N.$$.fragment,ie),P(O.$$.fragment,ie),P(R.$$.fragment,ie),P(F.$$.fragment,ie),P(X.$$.fragment,ie),P(ue.$$.fragment,ie),ie&&ke(()=>{me&&(pe||(pe=be(e,Ye,{duration:250},!0)),pe.run(1))}),me=!0)},o(ie){W(o.$$.fragment,ie),W(a.$$.fragment,ie),W(c.$$.fragment,ie),W(d.$$.fragment,ie),W(h.$$.fragment,ie),W(g.$$.fragment,ie),W(w.$$.fragment,ie),W(y.$$.fragment,ie),W(C.$$.fragment,ie),W(E.$$.fragment,ie),W(j.$$.fragment,ie),W(N.$$.fragment,ie),W(O.$$.fragment,ie),W(R.$$.fragment,ie),W(F.$$.fragment,ie),W(X.$$.fragment,ie),W(ue.$$.fragment,ie),ie&&(pe||(pe=be(e,Ye,{duration:250},!1)),pe.run(0)),me=!1},d(ie){ie&&A(e),oe(o),oe(a),oe(c),oe(d),oe(h),oe(g),oe(w),oe(y),oe(C),oe(E),oe(j),oe(N),oe(O),oe(R),oe(F),oe(X),oe(ue),n[2](null),ie&&pe&&pe.end(),ge=!1,we(Fe)}}}function jg(n,e,t){let i;K(n,J,c=>t(1,i=c));let s;function o(c){re[c?"unshift":"push"](()=>{s=c,t(0,s)})}return[s,i,o,()=>U(J,i.changelog.ongoing=!1,i),c=>{dt(c),ft(c)},()=>s.focus()]}class zg extends Re{constructor(e){super(),De(this,e,jg,qg,ve,{})}}function Wg(n){let e,t,i,s,o,r,a,l,c,u,d,f,h,_,g,v,w,k,y,T,C,z;return{c(){e=b("div"),t=b("span"),t.textContent="Resources",i=S(),s=b("ul"),o=b("li"),r=b("iconify-icon"),a=S(),l=b("a"),l.textContent="Fantastic Frontier Wiki",c=S(),u=b("li"),u.innerHTML='<iconify-icon icon="ic:baseline-discord" class="svelte-18cf37p"></iconify-icon> <a href="https://discord.gg/ff" target="_blank" class="svelte-18cf37p">Fantastic Frontier Discord Server</a>',d=S(),f=b("li"),f.innerHTML='<iconify-icon icon="simple-icons:googledocs" class="svelte-18cf37p"></iconify-icon> <a href="https://docs.google.com/document/d/1H9HXoExCDVfXx15LQ4Te-2tTjrLFB-XCbMmx44Ynld4/edit" target="_blank" class="svelte-18cf37p">Fantastic Frontier Build List</a>',h=S(),_=b("li"),_.innerHTML='<iconify-icon icon="simple-icons:googledocs" class="svelte-18cf37p"></iconify-icon> <a href="https://docs.google.com/document/d/15vwSRojTqZ8LI09Wq4dvGF1kSTPmH2_gECQvwlSFki8/edit" target="_blank" class="svelte-18cf37p">Fantastic Frontier Max Stat List</a>',g=S(),v=b("div"),w=b("div"),k=b("button"),k.textContent="OK",m(t,"id","title"),Ae(r,"icon","simple-icons:fandom"),Ae(r,"class","svelte-18cf37p"),m(l,"id","firstFocusable"),m(l,"href","https://fantastic-frontier-roblox.fandom.com/wiki/Fantastic_Frontier_-_Roblox_Wiki"),m(l,"target","_blank"),m(l,"class","svelte-18cf37p"),m(o,"class","svelte-18cf37p"),m(u,"class","svelte-18cf37p"),m(f,"class","svelte-18cf37p"),m(_,"class","svelte-18cf37p"),m(s,"class","svelte-18cf37p"),m(k,"id","lastFocusable"),m(v,"class","promptOptions"),m(e,"class","infoPrompt")},m(E,B){M(E,e,B),p(e,t),p(e,i),p(e,s),p(s,o),p(o,r),p(o,a),p(o,l),p(s,c),p(s,u),p(s,d),p(s,f),p(s,h),p(s,_),p(e,g),p(e,v),p(v,w),p(w,k),n[2](k),T=!0,C||(z=[D(l,"keydown",dt),D(k,"click",n[3]),D(k,"keydown",ft),D(e,"introstart",n[4])],C=!0)},p:le,i(E){T||(E&&ke(()=>{T&&(y||(y=be(e,Ye,{duration:250},!0)),y.run(1))}),T=!0)},o(E){E&&(y||(y=be(e,Ye,{duration:250},!1)),y.run(0)),T=!1},d(E){E&&A(e),n[2](null),E&&y&&y.end(),C=!1,we(z)}}}function Hg(n,e,t){let i;K(n,J,l=>t(1,i=l));let s;function o(l){re[l?"unshift":"push"](()=>{s=l,t(0,s)})}return[s,i,o,()=>U(J,i.resources.ongoing=!1,i),()=>s.focus()]}class Ug extends Re{constructor(e){super(),De(this,e,Hg,Wg,ve,{})}}function Sl(n,e,t){const i=n.slice();return i[7]=e[t],i}function Il(n,e,t){const i=n.slice();return i[10]=e[t],i}function Tl(n){let e,t,i,s,o,r,a,l=n[1][n[7]][n[10]].toLocaleString()+" Gold",c,u;return{c(){e=b("div"),t=b("span"),t.textContent=`${n[10].charAt(0).toUpperCase()+n[10].slice(1)+":"}`,i=S(),s=b("img"),r=S(),a=b("span"),c=ce(l),u=S(),m(t,"id","costTypeName"),m(t,"class","svelte-sk567b"),Xe(s.src,o="https://static.wikia.nocookie.net/fantastic-frontier-roblox/images/b/ba/GoldCoins.png")||m(s,"src",o),m(s,"alt",""),m(s,"class","svelte-sk567b"),m(e,"class","svelte-sk567b")},m(d,f){M(d,e,f),p(e,t),p(e,i),p(e,s),p(e,r),p(e,a),p(a,c),p(e,u)},p(d,f){f&2&&l!==(l=d[1][d[7]][d[10]].toLocaleString()+" Gold")&&Ne(c,l)},d(d){d&&A(e)}}}function Nl(n){let e,t,i,s,o,r=Oe(["min","avg","max"]),a=[];for(let l=0;l<3;l+=1)a[l]=Tl(Il(n,r,l));return{c(){e=b("div"),t=b("span"),t.textContent=`${n[7].charAt(0).toUpperCase()+n[7].slice(1)+" Costs"}`,i=S(),s=b("div");for(let l=0;l<3;l+=1)a[l].c();o=S(),m(t,"id","subtitle"),m(t,"class","svelte-sk567b"),m(s,"class","costTypes svelte-sk567b"),m(e,"class","costs svelte-sk567b"),m(e,"id",n[7])},m(l,c){M(l,e,c),p(e,t),p(e,i),p(e,s);for(let u=0;u<3;u+=1)a[u]&&a[u].m(s,null);p(e,o)},p(l,c){if(c&2){r=Oe(["min","avg","max"]);let u;for(u=0;u<3;u+=1){const d=Il(l,r,u);a[u]?a[u].p(d,c):(a[u]=Tl(d),a[u].c(),a[u].m(s,null))}for(;u<3;u+=1)a[u].d(1)}},d(l){l&&A(e),ot(a,l)}}}function Gg(n){let e,t,i,s,o,r,a,l,c,u,d=Oe(["armor","gear","total"]),f=[];for(let h=0;h<3;h+=1)f[h]=Nl(Sl(n,d,h));return{c(){e=b("div"),t=b("div");for(let h=0;h<3;h+=1)f[h].c();i=S(),s=b("div"),o=b("div"),r=b("button"),r.textContent="OK",m(t,"class","costsInfo svelte-sk567b"),m(r,"id","firstFocusable lastFocusable"),m(s,"class","promptOptions svelte-sk567b"),m(e,"class","buildCosts svelte-sk567b")},m(h,_){M(h,e,_),p(e,t);for(let g=0;g<3;g+=1)f[g]&&f[g].m(t,null);p(e,i),p(e,s),p(s,o),p(o,r),n[3](r),l=!0,c||(u=[D(r,"click",n[4]),D(r,"keydown",n[5]),D(e,"introstart",n[6])],c=!0)},p(h,[_]){if(_&2){d=Oe(["armor","gear","total"]);let g;for(g=0;g<3;g+=1){const v=Sl(h,d,g);f[g]?f[g].p(v,_):(f[g]=Nl(v),f[g].c(),f[g].m(t,null))}for(;g<3;g+=1)f[g].d(1)}},i(h){l||(h&&ke(()=>{l&&(a||(a=be(e,Ye,{duration:250},!0)),a.run(1))}),l=!0)},o(h){h&&(a||(a=be(e,Ye,{duration:250},!1)),a.run(0)),l=!1},d(h){h&&A(e),ot(f,h),n[3](null),h&&a&&a.end(),c=!1,we(u)}}}function Vg(n,e,t){let i,s;K(n,vt,u=>t(1,i=u)),K(n,J,u=>t(2,s=u));let o;function r(u){re[u?"unshift":"push"](()=>{o=u,t(0,o)})}return[o,i,s,r,()=>U(J,s.costs.ongoing=!1,s),u=>{dt(u),ft(u)},()=>o.focus()]}class Kg extends Re{constructor(e){super(),De(this,e,Vg,Gg,ve,{})}}function Ol(n,e,t){const i=n.slice();return i[19]=e[t][0],i[20]=e[t][1],i}function Dl(n,e,t){const i=n.slice();return i[11]=e[t],i}function Rl(n,e,t){const i=n.slice();return i[16]=e[t],i}function Yg(n){const e=n.slice(),t=e[14]?e[5][e[2].name][e[11].name]:`${Math.round(e[11].mult*100*10)/10}<b>%</b> ${Ot[e[11].type]}`;return e[15]=t,e}function Al(n){const e=n.slice(),t=e[5][e[2].name]!=null&&e[5][e[2].name][e[11].name]!=null;return e[14]=t,e}function Qg(n){let e;return{c(){e=b("span"),e.textContent=`Slot: ${n[2].slot.charAt(0).toUpperCase()+n[2].slot.slice(1)}`},m(t,i){M(t,e,i)},p:le,d(t){t&&A(e)}}}function Xg(n){let e;return{c(){e=b("span"),e.textContent=`Type: ${n[2].tool?"Tool":n[2].info.type}`},m(t,i){M(t,e,i)},p:le,d(t){t&&A(e)}}}function Jg(n){let e,t,i,s,o=Oe(Object.entries(Ot)),r=[];for(let a=0;a<o.length;a+=1)r[a]=Pl(Ol(n,o,a));return{c(){e=b("div"),t=b("span"),t.textContent=`${n[2].noStats?"No stats available":"Stats:"}`,i=S(),s=b("div");for(let a=0;a<r.length;a+=1)r[a].c();m(t,"id","subtitle"),m(t,"class","svelte-1d71l7d"),m(s,"class","svelte-1d71l7d"),m(e,"id","itemStats"),m(e,"class","svelte-1d71l7d")},m(a,l){M(a,e,l),p(e,t),p(e,i),p(e,s);for(let c=0;c<r.length;c+=1)r[c]&&r[c].m(s,null)},p(a,l){if(l&4){o=Oe(Object.entries(Ot));let c;for(c=0;c<o.length;c+=1){const u=Ol(a,o,c);r[c]?r[c].p(u,l):(r[c]=Pl(u),r[c].c(),r[c].m(s,null))}for(;c<r.length;c+=1)r[c].d(1);r.length=o.length}},d(a){a&&A(e),ot(r,a)}}}function Zg(n){let e;function t(o,r){return o[2].tool?eb:$g}let s=t(n)(n);return{c(){s.c(),e=rt()},m(o,r){s.m(o,r),M(o,e,r)},p(o,r){s.p(o,r)},d(o){o&&A(e),s.d(o)}}}function xg(n){let e,t,i,s,o,r=(n[19]=="endurance"?n[2].stats[n[19]].toFixed(2):n[2].stats[n[19]])+"",a,l;return{c(){e=b("div"),t=b("img"),s=S(),o=b("span"),a=ce(r),l=S(),Xe(t.src,i="stats/"+n[19]+".svg")||m(t,"src",i),m(t,"alt",n[20]),m(t,"class","svelte-1d71l7d"),m(o,"class","statValue svelte-1d71l7d"),m(o,"id",n[19]),ne(o,"negative",n[2].stats[n[19]]<0),m(e,"class","svelte-1d71l7d")},m(c,u){M(c,e,u),p(e,t),p(e,s),p(e,o),p(o,a),p(e,l)},p(c,u){u&4&&ne(o,"negative",c[2].stats[c[19]]<0)},d(c){c&&A(e)}}}function Pl(n){let e,t=n[2].stats[n[19]]!=0&&xg(n);return{c(){t&&t.c(),e=rt()},m(i,s){t&&t.m(i,s),M(i,e,s)},p(i,s){i[2].stats[i[19]]!=0&&t.p(i,s)},d(i){i&&A(e),t&&t.d(i)}}}function $g(n){let e,t,i,s,o,r=Oe(n[2].moves),a=[];for(let l=0;l<r.length;l+=1)a[l]=Fl(Dl(n,r,l));return{c(){e=b("div"),t=b("div"),i=b("div"),s=b("div"),s.innerHTML='<span class="svelte-1d71l7d">Move</span> <span class="svelte-1d71l7d">Base Value</span> <span class="svelte-1d71l7d">Scaling(s)</span>',o=S();for(let l=0;l<a.length;l+=1)a[l].c();m(s,"id","subtitle"),m(s,"class","svelte-1d71l7d"),m(i,"class","svelte-1d71l7d"),m(t,"id","itemMoves"),m(t,"class","svelte-1d71l7d"),m(e,"id","itemMovesCont"),m(e,"class","svelte-1d71l7d")},m(l,c){M(l,e,c),p(e,t),p(t,i),p(i,s),p(i,o);for(let u=0;u<a.length;u+=1)a[u]&&a[u].m(i,null)},p(l,c){if(c&52){r=Oe(l[2].moves);let u;for(u=0;u<r.length;u+=1){const d=Dl(l,r,u);a[u]?a[u].p(d,c):(a[u]=Fl(d),a[u].c(),a[u].m(i,null))}for(;u<a.length;u+=1)a[u].d(1);a.length=r.length}},d(l){l&&A(e),ot(a,l)}}}function eb(n){let e;return{c(){e=b("div"),e.innerHTML='<span id="subtitle" class="svelte-1d71l7d">No moves available</span>',m(e,"id","itemMovesCont"),m(e,"class","svelte-1d71l7d"),Je(e,"text-align","center")},m(t,i){M(t,e,i)},p:le,d(t){t&&A(e)}}}function tb(n){let e,t,i,s,o,r;function a(d,f){return!d[11].type||!d[11].type.includes("/")?Ml:nb}function l(d,f){return f===Ml?Yg(d):d}let c=a(n),u=c(l(n,c));return{c(){e=b("div"),t=b("span"),t.textContent=`${n[11].name}`,i=S(),s=b("span"),s.textContent=`${(n[11].name.includes("Fantastic Beamstorm")?"~":"")+n[11].base}`,o=S(),u.c(),r=S(),m(t,"class","svelte-1d71l7d"),m(s,"class","svelte-1d71l7d"),m(e,"class","svelte-1d71l7d")},m(d,f){M(d,e,f),p(e,t),p(e,i),p(e,s),p(e,o),u.m(e,null),p(e,r)},p(d,f){u.p(l(d,c),f)},d(d){d&&A(e),u.d()}}}function nb(n){let e,t=Oe(n[11].type.split("/")),i=[];for(let s=0;s<t.length;s+=1)i[s]=Ll(Rl(n,t,s));return{c(){e=b("span");for(let s=0;s<i.length;s+=1)i[s].c();m(e,"id","hybrid"),m(e,"class","svelte-1d71l7d")},m(s,o){M(s,e,o);for(let r=0;r<i.length;r+=1)i[r]&&i[r].m(e,null)},p(s,o){if(o&4){t=Oe(s[11].type.split("/"));let r;for(r=0;r<t.length;r+=1){const a=Rl(s,t,r);i[r]?i[r].p(a,o):(i[r]=Ll(a),i[r].c(),i[r].m(e,null))}for(;r<i.length;r+=1)i[r].d(1);i.length=t.length}},d(s){s&&A(e),ot(i,s)}}}function Ml(n){let e,t=n[15]+"";return{c(){e=b("span"),m(e,"class","svelte-1d71l7d"),Je(e,"font-size",n[15].length>30?"calc(var(--u) * 2.5)":"")},m(i,s){M(i,e,s),e.innerHTML=t},p:le,d(i){i&&A(e)}}}function Ll(n){let e,t=Math.round(n[11][`${n[16]}Mult`]*100*10)/10+"",i,s,o,r=Ot[n[16]]+"",a,l;return{c(){e=b("span"),i=ce(t),s=b("b"),s.textContent="%",o=S(),a=ce(r),l=S()},m(c,u){M(c,e,u),p(e,i),p(e,s),p(e,o),p(e,a),p(e,l)},p:le,d(c){c&&A(e)}}}function Fl(n){let e=!n[4].includes(n[11].name),t,i=e&&tb(Al(n));return{c(){i&&i.c(),t=rt()},m(s,o){i&&i.m(s,o),M(s,t,o)},p(s,o){e&&i.p(Al(s),o)},d(s){s&&A(t),i&&i.d(s)}}}function ib(n){let e,t,i,s,o,r,a,l,c,u,d,f,h,_,g,v,w,k,y,T,C,z,E,B,j,V,N,I,O,Z,R,L,F,H,X,he,ue,te,q,Y;function de(je,We){return je[3]?Xg:Qg}let me=de(n)(n);function ge(je,We){return je[3]?Zg:Jg}let ie=ge(n)(n);return{c(){e=b("div"),t=b("div"),i=b("a"),s=b("img"),r=S(),a=b("div"),l=b("span"),l.textContent="Click the image in order to visit the wiki page",c=S(),u=b("span"),u.textContent=`Name: ${n[2].name}`,d=S(),me.c(),f=S(),ie.c(),h=S(),_=b("div"),g=b("span"),g.textContent="Costs:",v=S(),w=b("div"),k=b("div"),y=b("span"),y.textContent="Minimum:",T=S(),C=b("img"),E=S(),B=b("span"),B.textContent=`${n[2].cost.min==null?"Unpurchasable":n[2].cost.min.toLocaleString()+" Gold"}`,j=S(),V=b("div"),N=b("span"),N.textContent="Maximum:",I=S(),O=b("img"),R=S(),L=b("span"),L.textContent=`${n[2].cost.max==null?"Unpurchasable":n[2].cost.max.toLocaleString()+" Gold"}`,F=S(),H=b("div"),X=b("div"),he=b("button"),he.textContent="OK",Xe(s.src,o=n[2].image)||m(s,"src",o),m(s,"alt",""),m(s,"class","svelte-1d71l7d"),m(i,"href",n[2].link),m(i,"target","_blank"),m(i,"class","svelte-1d71l7d"),m(l,"id","tip"),m(l,"class","svelte-1d71l7d"),m(a,"class","svelte-1d71l7d"),m(t,"id","basicInfo"),m(t,"class","svelte-1d71l7d"),m(g,"id","subtitle"),m(g,"class","svelte-1d71l7d"),m(y,"class","svelte-1d71l7d"),Xe(C.src,z="https://static.wikia.nocookie.net/fantastic-frontier-roblox/images/b/ba/GoldCoins.png")||m(C,"src",z),m(C,"alt",""),m(C,"class","svelte-1d71l7d"),m(B,"class","svelte-1d71l7d"),m(k,"class","svelte-1d71l7d"),m(N,"class","svelte-1d71l7d"),Xe(O.src,Z="https://static.wikia.nocookie.net/fantastic-frontier-roblox/images/b/ba/GoldCoins.png")||m(O,"src",Z),m(O,"alt",""),m(O,"class","svelte-1d71l7d"),m(L,"class","svelte-1d71l7d"),m(V,"class","svelte-1d71l7d"),m(w,"class","svelte-1d71l7d"),m(_,"id","itemCosts"),m(_,"class","svelte-1d71l7d"),m(he,"id","firstFocusable lastFocusable"),m(H,"class","promptOptions svelte-1d71l7d"),m(e,"class","itemInfo svelte-1d71l7d")},m(je,We){M(je,e,We),p(e,t),p(t,i),p(i,s),p(t,r),p(t,a),p(a,l),p(a,c),p(a,u),p(a,d),me.m(a,null),p(e,f),ie.m(e,null),p(e,h),p(e,_),p(_,g),p(_,v),p(_,w),p(w,k),p(k,y),p(k,T),p(k,C),p(k,E),p(k,B),p(w,j),p(w,V),p(V,N),p(V,I),p(V,O),p(V,R),p(V,L),p(e,F),p(e,H),p(H,X),p(X,he),n[6](he),te=!0,q||(Y=[D(he,"click",n[7]),D(he,"keydown",n[8]),D(e,"introstart",n[9]),D(e,"outroend",n[10])],q=!0)},p(je,[We]){me.p(je,We),ie.p(je,We)},i(je){te||(je&&ke(()=>{te&&(ue||(ue=be(e,Ye,{duration:250},!0)),ue.run(1))}),te=!0)},o(je){je&&(ue||(ue=be(e,Ye,{duration:250},!1)),ue.run(0)),te=!1},d(je){je&&A(e),me.d(),ie.d(),n[6](null),je&&ue&&ue.end(),q=!1,we(Y)}}}function sb(n,e,t){let i;K(n,J,_=>t(1,i=_));let s,o=i.item.data,r=o.type=="gear",a=["Charged Basic Attack","Charged Solar Beam"],l={"Void Spike Ultradagger":{"Void Needle":"100<b>%</b> Melee - 562.5<b>%</b> Armor"},"Pureblood Dagger":{"Basic Attack":"200<b>%</b> HighestBonus - 100<b>%</b> LowerBonuses","Blood Sap":"200<b>%</b> HighestBonus - 100<b>%</b> LowerBonuses","+ HP per Blood Sap":"(200<b>%</b> HighestBonus - 100<b>%</b> LowerBonuses) / 2"},"Gnome Rocket Launcher":{"Basic Attack":"None"}};function c(_){re[_?"unshift":"push"](()=>{s=_,t(0,s)})}return[s,i,o,r,a,l,c,()=>U(J,i.item.ongoing=!1,i),_=>{dt(_),ft(_)},()=>s.focus(),()=>{o.element&&o.element.querySelector("button").focus()}]}class ob extends Re{constructor(e){super(),De(this,e,sb,ib,ve,{})}}function rb(n){let e,t,i,s,o,r,a,l,c,u,d,f;return{c(){e=b("div"),t=b("span"),t.textContent="Fantastic Calculator Policy",i=S(),s=b("div"),s.innerHTML=`<span id="subtitle" class="svelte-u03pyj">About</span> <p>This tool is a passion project, one that is independent and is not
            affiliated with or sponsored by the creators of Fantastic Frontier.</p> <span id="subtitle" class="svelte-u03pyj">Privacy Policy</span> <p>This policy explains what information Fantastic Calculator (&quot;we&quot;,
            &quot;us&quot; or &quot;our&quot;) collects, uses, and shares when you use our website.</p> <span id="subtitle" class="svelte-u03pyj">Information We Collect</span> <p>We collect information provided by you; that is which is inputted
            directly into our tool. We also collect information about how you
            use and interact with our website, general demographic details, and
            information about your device or browser.</p> <span id="subtitle" class="svelte-u03pyj">How We Use This Information</span> <p>Your information may be utilized to test and improve the tool, once
            the aggregated, non-identifying information provided has been
            collected and analyzed.</p> <span id="subtitle" class="svelte-u03pyj">Contact</span> <p>For any questions or inquiries, feel free to contact us at <hl>@xt.ss</hl>.</p>`,o=S(),r=b("div"),a=b("div"),l=b("button"),l.textContent="OK",m(t,"id","title"),m(s,"id","contents"),m(l,"id","firstFocusable lastFocusable"),m(r,"class","promptOptions svelte-u03pyj"),m(e,"class","infoPrompt svelte-u03pyj")},m(h,_){M(h,e,_),p(e,t),p(e,i),p(e,s),p(e,o),p(e,r),p(r,a),p(a,l),n[2](l),u=!0,d||(f=[D(l,"click",n[3]),D(l,"keydown",n[4])],d=!0)},p:le,i(h){u||(h&&ke(()=>{u&&(c||(c=be(e,Ye,{duration:250},!0)),c.run(1))}),u=!0)},o(h){h&&(c||(c=be(e,Ye,{duration:250},!1)),c.run(0)),u=!1},d(h){h&&A(e),n[2](null),h&&c&&c.end(),d=!1,we(f)}}}function lb(n,e,t){let i;K(n,J,l=>t(1,i=l));let s;function o(l){re[l?"unshift":"push"](()=>{s=l,t(0,s)})}return[s,i,o,()=>U(J,i.policy.ongoing=!1,i),l=>{dt(l),ft(l)}]}class ab extends Re{constructor(e){super(),De(this,e,lb,rb,ve,{})}}const{document:kt,window:rn}=fu;function Bl(n,e,t){const i=n.slice();return i[52]=e[t],i}function ql(n,e,t){const i=n.slice();return i[52]=e[t],i}function jl(n){let e;return{c(){e=b("style"),e.textContent=`* {\r
                pointer-events: none;\r
            }\r
        `},m(t,i){M(t,e,i)},d(t){t&&A(e)}}}function zl(n){let e;return{c(){e=b("link"),m(e,"rel","preload"),m(e,"as","image"),m(e,"href",n[52])},m(t,i){M(t,e,i)},p:le,d(t){t&&A(e)}}}function Wl(n){let e;return{c(){e=b("style"),e.textContent=`body > div:not(.backgrounds),\r
            main > :not(.promptCont),\r
            .backgrounds > img,\r
            .info#resources,\r
            .info#changelog {\r
                filter: blur(calc(var(--u) * 0.5));\r
                pointer-events: none;\r
            }\r
            .sideFeatures {\r
                z-index: 3;\r
            }\r
            .sideFeatures button:hover,\r
            .sideFeatures button:focus,\r
            .info:hover,\r
            .info:focus {\r
                background-color: var(--transparent);\r
            }\r
            .sideFeatures button > .tooltip,\r
            .info:not(#credits) > .tooltip {\r
                opacity: 0 !important;\r
                visibility: hidden !important;\r
            }\r
        `},m(t,i){M(t,e,i)},d(t){t&&A(e)}}}function Hl(n){let e;return{c(){e=b("style"),e.textContent=`body {\r
                overflow: hidden;\r
            }\r
        `},m(t,i){M(t,e,i)},d(t){t&&A(e)}}}function Ul(n){let e;return{c(){e=b("style"),e.textContent=`body {\r
                pointer-events: none;\r
            }\r
            #resources,\r
            #changelog,\r
            .mainFeatures,\r
            .sideFeatures,\r
            .statBox > .toggleCont,\r
            .ddButton > iconify-icon,\r
            .copyStatsButton {\r
                opacity: 0;\r
                visibility: hidden;\r
            }\r
            .gearBox .ddButton > iconify-icon {\r
                width: 15% !important;\r
            }\r
            .eqSlotIcon button > .tooltip,\r
            .gearSlotIcon button > .tooltip {\r
                opacity: 1;\r
                visibility: visible;\r
            }\r
            .calcBox {\r
                translate: -3%;\r
            }\r
            .currentBuild {\r
                left: 50% !important;\r
                padding: calc(var(--u) * 2) !important;\r
            }\r
            .currentBuild > button {\r
                min-width: 0 !important;\r
                width: 0;\r
                opacity: 0;\r
                visibility: hidden;\r
            }`},m(t,i){M(t,e,i)},d(t){t&&A(e)}}}function Gl(n){let e,t,i,s,o,r,a,l,c,u,d,f,h,_,g,v,w,k,y,T,C,z,E,B,j,V,N,I,O,Z,R,L,F,H,X,he,ue,te,q,Y,de=Oe(n[22]),pe=[];for(let x=0;x<de.length;x+=1)pe[x]=Vl(Bl(n,de,x));let me=n[8]&&Kl(n),ge=n[5].screenshot.ongoing&&Yl(n),Fe=n[4]&&Ql(n);d=new Pm({}),h=new Ig({}),w=new cm({}),y=new vm({}),C=new Dm({}),E=new Wm({});let ie=n[5].screenshot.ongoing&&Xl(n);const je=[yb,vb,bb,gb,mb,pb,_b,hb,fb,db,ub,cb],We=[];function ye(x,Se){return x[5].item.ongoing?0:x[12]||x[5].share.ongoing?1:x[5].export.ongoing?2:x[5].save.ongoing?3:x[5].load.ongoing&&!x[9]?4:x[5].delete.ongoing?5:x[5].costs.ongoing?6:x[5].bonus.ongoing?7:x[5].randomize.ongoing?8:x[5].resources.ongoing?9:x[5].changelog.ongoing?10:x[5].policy.ongoing?11:-1}~(V=ye(n))&&(N=We[V]=je[V](n));let Ce=!n[14]&&Jl();return{c(){e=b("div");for(let x=0;x<pe.length;x+=1)pe[x].c();t=S(),me&&me.c(),i=S(),s=b("span"),s.innerHTML=`<iconify-icon icon="ic:baseline-discord" class="svelte-13td2qe"></iconify-icon>
        xt.ss
        <span class="tooltip svelte-13td2qe" id="right">Contact me on Discord!</span>`,o=S(),r=b("button"),r.innerHTML='<iconify-icon icon="charm:stack"></iconify-icon> <span class="tooltip" id="left">Resources</span>',a=S(),l=b("main"),ge&&ge.c(),c=S(),Fe&&Fe.c(),u=S(),ae(d.$$.fragment),f=S(),ae(h.$$.fragment),_=S(),g=b("div"),v=b("div"),ae(w.$$.fragment),k=S(),ae(y.$$.fragment),T=S(),ae(C.$$.fragment),z=S(),ae(E.$$.fragment),B=S(),ie&&ie.c(),j=S(),N&&N.c(),I=S(),O=b("button"),Z=b("iconify-icon"),R=S(),L=b("span"),L.textContent="Changelog",F=S(),Ce&&Ce.c(),H=S(),X=b("button"),X.innerHTML='<iconify-icon icon="material-symbols:policy-outline-rounded"></iconify-icon> <span class="tooltip" id="left">Policy</span>',he=S(),ue=b("span"),ue.textContent=`${Xs}`,m(e,"class","backgrounds"),m(s,"class","info svelte-13td2qe"),m(s,"id","credits"),m(r,"class","info svelte-13td2qe"),m(r,"id","resources"),m(v,"class","eqCont svelte-13td2qe"),m(g,"class","calcBox svelte-13td2qe"),m(g,"id","calc"),m(l,"class","svelte-13td2qe"),ne(l,"portrait",!n[2]),Ae(Z,"icon","octicon:log-16"),m(L,"class","tooltip"),m(L,"id","right"),m(O,"class","info svelte-13td2qe"),m(O,"id","changelog"),m(X,"class","info svelte-13td2qe"),m(X,"id","policy"),m(ue,"class","info svelte-13td2qe"),m(ue,"id","version")},m(x,Se){M(x,e,Se);for(let ht=0;ht<pe.length;ht+=1)pe[ht]&&pe[ht].m(e,null);M(x,t,Se),me&&me.m(x,Se),M(x,i,Se),M(x,s,Se),M(x,o,Se),M(x,r,Se),M(x,a,Se),M(x,l,Se),ge&&ge.m(l,null),p(l,c),Fe&&Fe.m(l,null),p(l,u),se(d,l,null),p(l,f),se(h,l,null),p(l,_),p(l,g),p(g,v),se(w,v,null),p(v,k),se(y,v,null),p(g,T),se(C,g,null),p(l,z),se(E,l,null),p(l,B),ie&&ie.m(l,null),p(l,j),~V&&We[V].m(l,null),M(x,I,Se),M(x,O,Se),p(O,Z),p(O,R),p(O,L),p(O,F),Ce&&Ce.m(O,null),M(x,H,Se),M(x,X,Se),M(x,he,Se),M(x,ue,Se),te=!0,q||(Y=[D(r,"click",n[32]),D(O,"click",n[38]),D(X,"click",n[39])],q=!0)},p(x,Se){if(Se[0]&4195328){de=Oe(x[22]);let et;for(et=0;et<de.length;et+=1){const Q=Bl(x,de,et);pe[et]?pe[et].p(Q,Se):(pe[et]=Vl(Q),pe[et].c(),pe[et].m(e,null))}for(;et<pe.length;et+=1)pe[et].d(1);pe.length=de.length}x[8]?me?(me.p(x,Se),Se[0]&256&&P(me,1)):(me=Kl(x),me.c(),P(me,1),me.m(i.parentNode,i)):me&&(Be(),W(me,1,1,()=>{me=null}),qe()),x[5].screenshot.ongoing?ge?(ge.p(x,Se),Se[0]&32&&P(ge,1)):(ge=Yl(x),ge.c(),P(ge,1),ge.m(l,c)):ge&&(Be(),W(ge,1,1,()=>{ge=null}),qe()),x[4]?Fe?(Fe.p(x,Se),Se[0]&16&&P(Fe,1)):(Fe=Ql(x),Fe.c(),P(Fe,1),Fe.m(l,u)):Fe&&(Be(),W(Fe,1,1,()=>{Fe=null}),qe()),x[5].screenshot.ongoing?ie?(ie.p(x,Se),Se[0]&32&&P(ie,1)):(ie=Xl(x),ie.c(),P(ie,1),ie.m(l,j)):ie&&(Be(),W(ie,1,1,()=>{ie=null}),qe());let ht=V;V=ye(x),V===ht?~V&&We[V].p(x,Se):(N&&(Be(),W(We[ht],1,1,()=>{We[ht]=null}),qe()),~V?(N=We[V],N?N.p(x,Se):(N=We[V]=je[V](x),N.c()),P(N,1),N.m(l,null)):N=null),(!te||Se[0]&4)&&ne(l,"portrait",!x[2]),x[14]?Ce&&(Be(),W(Ce,1,1,()=>{Ce=null}),qe()):Ce?Se[0]&16384&&P(Ce,1):(Ce=Jl(),Ce.c(),P(Ce,1),Ce.m(O,null))},i(x){te||(P(me),P(ge),P(Fe),P(d.$$.fragment,x),P(h.$$.fragment,x),P(w.$$.fragment,x),P(y.$$.fragment,x),P(C.$$.fragment,x),P(E.$$.fragment,x),P(ie),P(N),P(Ce),te=!0)},o(x){W(me),W(ge),W(Fe),W(d.$$.fragment,x),W(h.$$.fragment,x),W(w.$$.fragment,x),W(y.$$.fragment,x),W(C.$$.fragment,x),W(E.$$.fragment,x),W(ie),W(N),W(Ce),te=!1},d(x){x&&(A(e),A(t),A(i),A(s),A(o),A(r),A(a),A(l),A(I),A(O),A(H),A(X),A(he),A(ue)),ot(pe,x),me&&me.d(x),ge&&ge.d(),Fe&&Fe.d(),oe(d),oe(h),oe(w),oe(y),oe(C),oe(E),ie&&ie.d(),~V&&We[V].d(),Ce&&Ce.d(),q=!1,we(Y)}}}function Vl(n){let e,t;return{c(){e=b("img"),m(e,"class","background svelte-13td2qe"),Xe(e.src,t=n[52])||m(e,"src",t),m(e,"alt",""),ne(e,"active",n[22].indexOf(n[52])==n[10])},m(i,s){M(i,e,s)},p(i,s){s[0]&4195328&&ne(e,"active",i[22].indexOf(i[52])==i[10])},d(i){i&&A(e)}}}function Kl(n){let e,t,i=Math.floor(n[19][n[3]]*100)+"",s,o,r,a;return{c(){e=b("span"),t=ce("Zoom: "),s=ce(i),o=b("b"),o.textContent="%",m(e,"class","info svelte-13td2qe"),m(e,"id","zoomLevel")},m(l,c){M(l,e,c),p(e,t),p(e,s),p(e,o),a=!0},p(l,c){(!a||c[0]&8)&&i!==(i=Math.floor(l[19][l[3]]*100)+"")&&Ne(s,i)},i(l){a||(l&&ke(()=>{a&&(r||(r=be(e,Ke,{duration:150},!0)),r.run(1))}),a=!0)},o(l){l&&(r||(r=be(e,Ke,{duration:150},!1)),r.run(0)),a=!1},d(l){l&&A(e),l&&r&&r.end()}}}function Yl(n){let e,t,i,s,o,r,a,l,c=n[18].armor.avg.toLocaleString()+" Gold",u,d,f,h,_,g,v,w,k,y=n[18].gear.avg.toLocaleString()+" Gold",T,C,z;return{c(){e=b("div"),t=b("div"),i=b("span"),i.textContent="Avg. armor cost:",s=S(),o=b("img"),a=S(),l=b("span"),u=ce(c),d=S(),f=b("div"),h=b("span"),h.textContent="Avg. gear cost:",_=S(),g=b("img"),w=S(),k=b("span"),T=ce(y),Xe(o.src,r="https://static.wikia.nocookie.net/fantastic-frontier-roblox/images/b/ba/GoldCoins.png")||m(o,"src",r),m(o,"alt",""),m(o,"class","svelte-13td2qe"),m(t,"class","svelte-13td2qe"),Xe(g.src,v="https://static.wikia.nocookie.net/fantastic-frontier-roblox/images/b/ba/GoldCoins.png")||m(g,"src",v),m(g,"alt",""),m(g,"class","svelte-13td2qe"),m(f,"class","svelte-13td2qe"),m(e,"class","costPreview svelte-13td2qe"),m(e,"id","specific")},m(E,B){M(E,e,B),p(e,t),p(t,i),p(t,s),p(t,o),p(t,a),p(t,l),p(l,u),p(e,d),p(e,f),p(f,h),p(f,_),p(f,g),p(f,w),p(f,k),p(k,T),z=!0},p(E,B){(!z||B[0]&262144)&&c!==(c=E[18].armor.avg.toLocaleString()+" Gold")&&Ne(u,c),(!z||B[0]&262144)&&y!==(y=E[18].gear.avg.toLocaleString()+" Gold")&&Ne(T,y)},i(E){z||(E&&ke(()=>{z&&(C||(C=be(e,Ke,{duration:150},!0)),C.run(1))}),z=!0)},o(E){E&&(C||(C=be(e,Ke,{duration:150},!1)),C.run(0)),z=!1},d(E){E&&A(e),E&&C&&C.end()}}}function Ql(n){let e,t,i=n[4].name+"",s,o,r,a,l,c,u,d,f,h,_=n[4].desc+"",g,v,w,k,y;return{c(){e=b("div"),t=b("span"),s=ce(i),o=S(),r=b("button"),r.innerHTML='<iconify-icon icon="ri:share-fill"></iconify-icon> <span class="tooltip" id="right">Share build</span>',a=S(),l=b("span"),c=ce(`Description / Notes:\r
                    `),u=b("br"),d=S(),f=b("br"),h=S(),g=ce(_),m(t,"id","buildName"),m(t,"class","svelte-13td2qe"),m(r,"class","svelte-13td2qe"),m(l,"class","tooltip"),m(l,"id","bottom"),m(e,"class","currentBuild svelte-13td2qe"),ne(e,"no-tooltip",n[11])},m(T,C){M(T,e,C),p(e,t),p(t,s),p(e,o),p(e,r),p(e,a),p(e,l),p(l,c),p(l,u),p(l,d),p(l,f),p(l,h),p(l,g),w=!0,k||(y=[D(r,"click",n[33]),D(r,"mouseenter",n[34]),D(r,"mouseleave",n[35])],k=!0)},p(T,C){(!w||C[0]&16)&&i!==(i=T[4].name+"")&&Ne(s,i),(!w||C[0]&16)&&_!==(_=T[4].desc+"")&&Ne(g,_),(!w||C[0]&2048)&&ne(e,"no-tooltip",T[11])},i(T){w||(T&&ke(()=>{w&&(v||(v=be(e,Ke,{duration:100},!0)),v.run(1))}),w=!0)},o(T){T&&(v||(v=be(e,Ke,{duration:100},!1)),v.run(0)),w=!1},d(T){T&&A(e),T&&v&&v.end(),k=!1,we(y)}}}function Xl(n){let e,t,i,s,o,r,a,l,c=n[18].total.avg.toLocaleString()+" Gold",u,d,f;return{c(){e=b("div"),t=b("div"),i=b("span"),i.textContent="Avg. total cost:",s=S(),o=b("img"),a=S(),l=b("span"),u=ce(c),Xe(o.src,r="https://static.wikia.nocookie.net/fantastic-frontier-roblox/images/b/ba/GoldCoins.png")||m(o,"src",r),m(o,"alt",""),m(o,"class","svelte-13td2qe"),m(t,"class","svelte-13td2qe"),m(e,"class","costPreview svelte-13td2qe"),m(e,"id","total")},m(h,_){M(h,e,_),p(e,t),p(t,i),p(t,s),p(t,o),p(t,a),p(t,l),p(l,u),f=!0},p(h,_){(!f||_[0]&262144)&&c!==(c=h[18].total.avg.toLocaleString()+" Gold")&&Ne(u,c)},i(h){f||(h&&ke(()=>{f&&(d||(d=be(e,Ke,{duration:150},!0)),d.run(1))}),f=!0)},o(h){h&&(d||(d=be(e,Ke,{duration:150},!1)),d.run(0)),f=!1},d(h){h&&A(e),h&&d&&d.end()}}}function cb(n){let e,t,i;return t=new ab({}),{c(){e=b("div"),ae(t.$$.fragment),m(e,"class","promptCont svelte-13td2qe")},m(s,o){M(s,e,o),se(t,e,null),i=!0},p:le,i(s){i||(P(t.$$.fragment,s),i=!0)},o(s){W(t.$$.fragment,s),i=!1},d(s){s&&A(e),oe(t)}}}function ub(n){let e,t,i;return t=new zg({}),{c(){e=b("div"),ae(t.$$.fragment),m(e,"class","promptCont svelte-13td2qe")},m(s,o){M(s,e,o),se(t,e,null),i=!0},p:le,i(s){i||(P(t.$$.fragment,s),i=!0)},o(s){W(t.$$.fragment,s),i=!1},d(s){s&&A(e),oe(t)}}}function db(n){let e,t,i;return t=new Ug({}),t.$on("loadPending",n[20]),{c(){e=b("div"),ae(t.$$.fragment),m(e,"class","promptCont svelte-13td2qe")},m(s,o){M(s,e,o),se(t,e,null),i=!0},p:le,i(s){i||(P(t.$$.fragment,s),i=!0)},o(s){W(t.$$.fragment,s),i=!1},d(s){s&&A(e),oe(t)}}}function fb(n){let e,t,i;return t=new Pg({}),{c(){e=b("div"),ae(t.$$.fragment),m(e,"class","promptCont svelte-13td2qe")},m(s,o){M(s,e,o),se(t,e,null),i=!0},p:le,i(s){i||(P(t.$$.fragment,s),i=!0)},o(s){W(t.$$.fragment,s),i=!1},d(s){s&&A(e),oe(t)}}}function hb(n){let e,t,i;return t=new Og({}),{c(){e=b("div"),ae(t.$$.fragment),m(e,"class","promptCont svelte-13td2qe")},m(s,o){M(s,e,o),se(t,e,null),i=!0},p:le,i(s){i||(P(t.$$.fragment,s),i=!0)},o(s){W(t.$$.fragment,s),i=!1},d(s){s&&A(e),oe(t)}}}function _b(n){let e,t,i;return t=new Kg({}),{c(){e=b("div"),ae(t.$$.fragment),m(e,"class","promptCont svelte-13td2qe")},m(s,o){M(s,e,o),se(t,e,null),i=!0},p:le,i(s){i||(P(t.$$.fragment,s),i=!0)},o(s){W(t.$$.fragment,s),i=!1},d(s){s&&A(e),oe(t)}}}function pb(n){let e,t,i;return t=new Cg({}),{c(){e=b("div"),ae(t.$$.fragment),m(e,"class","promptCont svelte-13td2qe")},m(s,o){M(s,e,o),se(t,e,null),i=!0},p:le,i(s){i||(P(t.$$.fragment,s),i=!0)},o(s){W(t.$$.fragment,s),i=!1},d(s){s&&A(e),oe(t)}}}function mb(n){let e,t,i;return t=new yg({}),t.$on("buildLoad",n[37]),{c(){e=b("div"),ae(t.$$.fragment),m(e,"class","promptCont svelte-13td2qe")},m(s,o){M(s,e,o),se(t,e,null),i=!0},p:le,i(s){i||(P(t.$$.fragment,s),i=!0)},o(s){W(t.$$.fragment,s),i=!1},d(s){s&&A(e),oe(t)}}}function gb(n){let e,t,i;return t=new pg({}),{c(){e=b("div"),ae(t.$$.fragment),m(e,"class","promptCont svelte-13td2qe")},m(s,o){M(s,e,o),se(t,e,null),i=!0},p:le,i(s){i||(P(t.$$.fragment,s),i=!0)},o(s){W(t.$$.fragment,s),i=!1},d(s){s&&A(e),oe(t)}}}function bb(n){let e,t,i;return t=new Gm({}),{c(){e=b("div"),ae(t.$$.fragment),m(e,"class","promptCont svelte-13td2qe")},m(s,o){M(s,e,o),se(t,e,null),i=!0},p:le,i(s){i||(P(t.$$.fragment,s),i=!0)},o(s){W(t.$$.fragment,s),i=!1},d(s){s&&A(e),oe(t)}}}function vb(n){let e,t,i,s;function o(a){n[36](a)}let r={};return n[9]!==void 0&&(r.loadID=n[9]),t=new lg({props:r}),re.push(()=>Me(t,"loadID",o)),t.$on("resetActions",n[24]),{c(){e=b("div"),ae(t.$$.fragment),m(e,"class","promptCont svelte-13td2qe")},m(a,l){M(a,e,l),se(t,e,null),s=!0},p(a,l){const c={};!i&&l[0]&512&&(i=!0,c.loadID=a[9],Pe(()=>i=!1)),t.$set(c)},i(a){s||(P(t.$$.fragment,a),s=!0)},o(a){W(t.$$.fragment,a),s=!1},d(a){a&&A(e),oe(t)}}}function yb(n){let e,t,i;return t=new ob({}),{c(){e=b("div"),ae(t.$$.fragment),m(e,"class","promptCont svelte-13td2qe")},m(s,o){M(s,e,o),se(t,e,null),i=!0},p:le,i(s){i||(P(t.$$.fragment,s),i=!0)},o(s){W(t.$$.fragment,s),i=!1},d(s){s&&A(e),oe(t)}}}function Jl(n){let e,t,i;return{c(){e=b("iconify-icon"),Ae(e,"icon","uil:exclamation"),Ae(e,"id","unseen"),Ae(e,"class","svelte-13td2qe")},m(s,o){M(s,e,o),i=!0},i(s){i||(s&&ke(()=>{i&&(t||(t=be(e,Ke,{duration:150},!0)),t.run(1))}),i=!0)},o(s){s&&(t||(t=be(e,Ke,{duration:150},!1)),t.run(0)),i=!1},d(s){s&&A(e),s&&t&&t.end()}}}function Zl(n){let e;return{c(){e=b("div"),e.innerHTML='<iconify-icon icon="eos-icons:three-dots-loading" class="svelte-13td2qe"></iconify-icon>',m(e,"class","promptCont svelte-13td2qe")},m(t,i){M(t,e,i)},d(t){t&&A(e)}}}function wb(n){let e,t,i,s,o,r,a,l,c,u,d,f;ke(n[30]);let h=!n[6]&&jl(),_=Oe(n[22]),g=[];for(let C=0;C<_.length;C+=1)g[C]=zl(ql(n,_,C));let v=(n[13]||!n[6])&&Wl(),w=n[5].screenshot.ongoing&&n[19][n[3]]<=1&&Hl(),k=n[5].screenshot.ongoing&&Ul(),y=(n[7]||!n[7]&&n[6])&&Gl(n),T=!n[6]&&Zl();return{c(){e=S(),h&&h.c(),t=rt();for(let C=0;C<g.length;C+=1)g[C].c();i=rt(),v&&v.c(),s=rt(),w&&w.c(),o=rt(),k&&k.c(),r=rt(),a=S(),y&&y.c(),l=S(),T&&T.c(),c=rt()},m(C,z){M(C,e,z),h&&h.m(kt.head,null),p(kt.head,t);for(let E=0;E<g.length;E+=1)g[E]&&g[E].m(kt.head,null);p(kt.head,i),v&&v.m(kt.head,null),p(kt.head,s),w&&w.m(kt.head,null),p(kt.head,o),k&&k.m(kt.head,null),p(kt.head,r),M(C,a,z),y&&y.m(C,z),M(C,l,z),T&&T.m(C,z),M(C,c,z),u=!0,d||(f=[D(rn,"beforeunload",n[26]),D(rn,"storage",n[27]),D(rn,"wheel",n[28],{passive:!1}),D(rn,"keydown",n[29]),D(rn,"resize",n[30]),D(kt,"visibilitychange",n[31])],d=!0)},p(C,z){if(C[6]?h&&(h.d(1),h=null):h||(h=jl(),h.c(),h.m(t.parentNode,t)),z[0]&4194304){_=Oe(C[22]);let E;for(E=0;E<_.length;E+=1){const B=ql(C,_,E);g[E]?g[E].p(B,z):(g[E]=zl(B),g[E].c(),g[E].m(i.parentNode,i))}for(;E<g.length;E+=1)g[E].d(1);g.length=_.length}C[13]||!C[6]?v||(v=Wl(),v.c(),v.m(s.parentNode,s)):v&&(v.d(1),v=null),C[5].screenshot.ongoing&&C[19][C[3]]<=1?w||(w=Hl(),w.c(),w.m(o.parentNode,o)):w&&(w.d(1),w=null),C[5].screenshot.ongoing?k||(k=Ul(),k.c(),k.m(r.parentNode,r)):k&&(k.d(1),k=null),C[7]||!C[7]&&C[6]?y?(y.p(C,z),z[0]&192&&P(y,1)):(y=Gl(C),y.c(),P(y,1),y.m(l.parentNode,l)):y&&(Be(),W(y,1,1,()=>{y=null}),qe()),C[6]?T&&(T.d(1),T=null):T||(T=Zl(),T.c(),T.m(c.parentNode,c))},i(C){u||(P(y),u=!0)},o(C){W(y),u=!1},d(C){C&&(A(e),A(a),A(l),A(c)),h&&h.d(C),A(t),ot(g,C),A(i),v&&v.d(C),A(s),w&&w.d(C),A(o),k&&k.d(C),A(r),y&&y.d(C),T&&T.d(C),d=!1,we(f)}}}let Xs="v3.26.5";function kb(n,e,t){let i,s,o,r,a,l,c,u,d,f,h,_,g,v,w;K(n,_t,Q=>t(4,s=Q)),K(n,J,Q=>t(5,o=Q)),K(n,dn,Q=>t(13,r=Q)),K(n,to,Q=>t(25,a=Q)),K(n,Dn,Q=>t(43,l=Q)),K(n,At,Q=>t(44,c=Q)),K(n,On,Q=>t(45,u=Q)),K(n,Nt,Q=>t(46,d=Q)),K(n,Si,Q=>t(14,f=Q)),K(n,Ut,Q=>t(15,h=Q)),K(n,wt,Q=>t(16,_=Q)),K(n,Tt,Q=>t(47,g=Q)),K(n,no,Q=>t(17,v=Q)),K(n,vt,Q=>t(18,w=Q));let k=!1,y=!1,T,C,z,E=7,B=[.2,.3,.45,.6,.75,.85,.95,1,1.1,1.25,1.5,1.75,2,2.5,3,4,5],j=!1,V,N=new URLSearchParams(location.search).get("id");for(let Q of Np){let G=`https://raw.githubusercontent.com/XT8SS/fantastic-calculator/gh-pages/ff-data/${Q}.json`;fetch(G).then(async fe=>{if(fe.status!=200){console.error(`Failed to fetch "${Q}" data!
Status: ${fe.status}`);return}U(Tt,g[Q]=await fe.json(),g)}).catch(fe=>console.error(`Failed to initiate "${Q}" data fetch!
${fe}`))}ku(()=>{t(6,k=!0),N&&I(),t(2,z=C>T),_[Object.keys(_)[0]]&&U(Ut,h=!0,h),localStorage.getItem("version")!=Xs&&(U(Si,f=!1,f),localStorage.setItem("version",Xs)),localStorage.getItem("changelogSeen")||localStorage.setItem("changelogSeen",!1)});function I(){if(U(J,o.load.ongoing=!0,o),!N.startsWith("-N"))U(J,o.load.status=-1,o),U(J,o.message="invalid_id",o);else{U(J,o.load.status=0,o);let Q=Qc(Mn(Fn,"builds"),Yc()),G=0;Kc(Q).then(fe=>{for(let He in fe.val()){if(He==N){O(fe.val()[He],He);break}else G==Object.keys(fe.val()).length-1&&(U(J,o.load.status=-1,o),U(J,o.message="invalid_id",o));G++}}).catch(()=>{U(J,o.load.status=-1,o),U(J,o.message="firebase_fail",o)})}}function O(Q,G){for(let fe in Q.eq){let He=d[fe]||ds;Q.eq[fe]&&Q.eq[fe]!=He.name?u[fe][Q.eq[fe]].querySelector("button").click():!Q.eq[fe]&&He.name&&u[fe][He.name].querySelector("button").click()}for(let fe of mn){let He=c[fe]||fs;He.name&&l[fe][He.name].querySelector("button").click()}setTimeout(()=>{for(let fe of mn)Q.gear[fe]&&l[fe][Q.gear[fe]].querySelector("button").click();U(J,o.load.ongoing=!1,o),U(J,o.load.status=null,o),G&&(U(_t,s=Q,s),U(_t,s.id=G,s),t(9,N=null))})}let Z=[],R=[],L,F,H=9;for(let Q=0;Q<H;Q++)Z.push(`backgrounds/BG${Q}.jpg`);function X(Q){F=Math.floor(Math.random()*Q.length)}X(Z);function he(){t(10,L=F),R.push(F)}he(),function Q(){setTimeout(()=>{if(X(Z),!R.length)he();else if(R.length>3&&(R=R.slice(1)),!R.includes(F))he();else{let G=[...Array(H).keys()].filter(fe=>!R.includes(fe));X(G),he()}document.hasFocus&&Q()},45e3)}();function ue(){V=setTimeout(()=>{t(8,j=!1)},750)}function te(){clearTimeout(V),t(8,j=!0),ue()}function q(){U(J,o.export.status=null,o),U(J,o.export.ongoing=!1,o),U(J,o.save.status=null,o),U(J,o.save.ongoing=!1,o),U(J,o.load.status=null,o),U(J,o.load.ongoing=!1,o),U(J,o.delete.status=null,o),U(J,o.delete.ongoing=!1,o),U(J,o.share.ongoing=!1,o),U(J,o.message="",o)}let Y=!1;const de=Q=>{(v||r)&&Q.preventDefault()},pe=Q=>{if(Q.key=="builds")if(Q.url.includes("ls=true")){U(wt,_=JSON.parse(Q.newValue),_),U(Ut,h=Object.keys(JSON.parse(Q.newValue)).length>0,h),q();let G=Object.keys(JSON.parse(Q.oldValue)).filter(fe=>!Object.keys(JSON.parse(Q.newValue)).includes(fe))[0];G&&s&&G==s.name&&U(_t,s=null,s)}else window.localStorage.setItem("builds",JSON.stringify(_))},me=Q=>{let G=Q.wheelDeltaY;if(Q.ctrlKey){if(Q.preventDefault(),B[E]==.2&&G<0||B[E]==5&&G>0)return;G>0?t(3,E++,E):t(3,E--,E),te()}},ge=Q=>{Q.ctrlKey&&(Q.key=="-"||Q.key=="+"||Q.code=="Equal"||Q.key=="0")&&(Q.preventDefault(),(Q.key=="+"||Q.code=="Equal")&&B[E]!=5?t(3,E++,E):Q.key=="-"&&B[E]!=.2?t(3,E--,E):Q.key=="0"&&B[E]!=1&&t(3,E=7),te()),r&&Rp(Q)};function Fe(){t(0,T=rn.outerHeight),t(1,C=rn.outerWidth)}const ie=()=>t(7,y=document.visibilityState),je=Q=>{Xt(Q),r||U(J,o.resources.ongoing=!0,o)},We=()=>{r||U(J,o.share.ongoing=!0,o)},ye=()=>t(11,Y=!0),Ce=()=>t(11,Y=!1);function x(Q){N=Q,t(9,N)}const Se=Q=>O(Q.detail.build,Q.detail.id),ht=Q=>{Xt(Q),!r&&(U(J,o.changelog.ongoing=!0,o),U(Si,f=!0,f))},et=Q=>{Xt(Q),r||U(J,o.policy.ongoing=!0,o)};return n.$$.update=()=>{if(n.$$.dirty[0]&33554447&&(C||T)&&(t(2,z=C>T),document.documentElement.style.setProperty("--u",`${(z?.75:window.outerWidth/window.outerHeight/2)*B[E]}${CSS.supports("height: 1lvh")?"l":""}vh`),a))for(let Q of a)Bo(Q.node,Q.itemName);n.$$.dirty[0]&32&&t(12,i=o.export.status||o.save.status||o.load.status||o.delete.status),n.$$.dirty[0]&32&&U(dn,r=o.item.ongoing||o.export.ongoing||o.save.ongoing||o.load.ongoing||o.delete.ongoing||o.share.ongoing||o.costs.ongoing||o.bonus.ongoing||o.randomize.ongoing||o.resources.ongoing||o.changelog.ongoing||o.policy.ongoing,r),n.$$.dirty[0]&16&&(document.title=(s?s.name+" - ":"")+"Fantastic Calculator")},[T,C,z,E,s,o,k,y,j,N,L,Y,i,r,f,h,_,v,w,B,I,O,Z,te,q,a,de,pe,me,ge,Fe,ie,je,We,ye,Ce,x,Se,ht,et]}class Cb extends Re{constructor(e){super(),De(this,e,kb,wb,ve,{},null,[-1,-1])}}new Cb({target:document.body});
