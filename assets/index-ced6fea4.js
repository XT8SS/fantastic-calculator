var lu=Object.defineProperty;var au=(n,e,t)=>e in n?lu(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var Qt=(n,e,t)=>(au(n,typeof e!="symbol"?e+"":e,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&i(r)}).observe(document,{childList:!0,subtree:!0});function t(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(s){if(s.ep)return;s.ep=!0;const o=t(s);fetch(s.href,o)}})();function ie(){}const es=n=>n;function cu(n,e){for(const t in e)n[t]=e[t];return n}function na(n){return n()}function Ko(){return Object.create(null)}function be(n){n.forEach(na)}function Un(n){return typeof n=="function"}function ge(n,e){return n!=n?e==e:n!==e||n&&typeof n=="object"||typeof n=="function"}let Ii;function $e(n,e){return n===e?!0:(Ii||(Ii=document.createElement("a")),Ii.href=e,n===Ii.href)}function uu(n){return Object.keys(n).length===0}function du(n,...e){if(n==null){for(const i of e)i(void 0);return ie}const t=n.subscribe(...e);return t.unsubscribe?()=>t.unsubscribe():t}function J(n,e,t){n.$$.on_destroy.push(du(e,t))}function fu(n,e,t,i){if(n){const s=ia(n,e,t,i);return n[0](s)}}function ia(n,e,t,i){return n[1]&&i?cu(t.ctx.slice(),n[1](i(e))):t.ctx}function hu(n,e,t,i){if(n[2]&&i){const s=n[2](i(t));if(e.dirty===void 0)return s;if(typeof s=="object"){const o=[],r=Math.max(e.dirty.length,s.length);for(let l=0;l<r;l+=1)o[l]=e.dirty[l]|s[l];return o}return e.dirty|s}return e.dirty}function _u(n,e,t,i,s,o){if(s){const r=ia(e,t,i,o);n.p(r,s)}}function pu(n){if(n.ctx.length>32){const e=[],t=n.ctx.length/32;for(let i=0;i<t;i++)e[i]=-1;return e}return-1}function G(n,e,t){return n.set(t),e}function sa(n){return n&&Un(n.destroy)?n.destroy:ie}const oa=typeof window<"u";let to=oa?()=>window.performance.now():()=>Date.now(),no=oa?n=>requestAnimationFrame(n):ie;const On=new Set;function ra(n){On.forEach(e=>{e.c(n)||(On.delete(e),e.f())}),On.size!==0&&no(ra)}function io(n){let e;return On.size===0&&no(ra),{promise:new Promise(t=>{On.add(e={c:n,f:t})}),abort(){On.delete(e)}}}const mu=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function p(n,e){n.appendChild(e)}function la(n){if(!n)return document;const e=n.getRootNode?n.getRootNode():n.ownerDocument;return e&&e.host?e:n.ownerDocument}function gu(n){const e=g("style");return e.textContent="/* empty */",bu(la(n),e),e.sheet}function bu(n,e){return p(n.head||n,e),e.sheet}function L(n,e,t){n.insertBefore(e,t||null)}function P(n){n.parentNode&&n.parentNode.removeChild(n)}function ft(n,e){for(let t=0;t<n.length;t+=1)n[t]&&n[t].d(e)}function g(n){return document.createElement(n)}function vu(n){return document.createElementNS("http://www.w3.org/2000/svg",n)}function ae(n){return document.createTextNode(n)}function C(){return ae(" ")}function _t(){return ae("")}function O(n,e,t,i){return n.addEventListener(e,t,i),()=>n.removeEventListener(e,t,i)}function m(n,e,t){t==null?n.removeAttribute(e):n.getAttribute(e)!==t&&n.setAttribute(e,t)}function Pe(n,e,t){e in n?n[e]=typeof n[e]=="boolean"&&t===""?!0:t:m(n,e,t)}function aa(n){return n===""?null:+n}function yu(n){return Array.from(n.childNodes)}function Te(n,e){e=""+e,n.data!==e&&(n.data=e)}function Bt(n,e){n.value=e??""}function et(n,e,t,i){t==null?n.style.removeProperty(e):n.style.setProperty(e,t,i?"important":"")}let Ti;function wu(){if(Ti===void 0){Ti=!1;try{typeof window<"u"&&window.parent&&window.parent.document}catch{Ti=!0}}return Ti}function nn(n,e){getComputedStyle(n).position==="static"&&(n.style.position="relative");const i=g("iframe");i.setAttribute("style","display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;"),i.setAttribute("aria-hidden","true"),i.tabIndex=-1;const s=wu();let o;return s?(i.src="data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}<\/script>",o=O(window,"message",r=>{r.source===i.contentWindow&&e()})):(i.src="about:blank",i.onload=()=>{o=O(i.contentWindow,"resize",e),e()}),p(n,i),()=>{(s||o&&i.contentWindow)&&o(),P(i)}}function te(n,e,t){n.classList.toggle(e,!!t)}function ca(n,e,{bubbles:t=!1,cancelable:i=!1}={}){return new CustomEvent(n,{detail:e,bubbles:t,cancelable:i})}class ku{constructor(e=!1){Qt(this,"is_svg",!1);Qt(this,"e");Qt(this,"n");Qt(this,"t");Qt(this,"a");this.is_svg=e,this.e=this.n=null}c(e){this.h(e)}m(e,t,i=null){this.e||(this.is_svg?this.e=vu(t.nodeName):this.e=g(t.nodeType===11?"TEMPLATE":t.nodeName),this.t=t.tagName!=="TEMPLATE"?t:t.content,this.c(e)),this.i(i)}h(e){this.e.innerHTML=e,this.n=Array.from(this.e.nodeName==="TEMPLATE"?this.e.content.childNodes:this.e.childNodes)}i(e){for(let t=0;t<this.n.length;t+=1)L(this.t,this.n[t],e)}p(e){this.d(),this.h(e),this.i(this.a)}d(){this.n.forEach(P)}}const Ai=new Map;let Pi=0;function Cu(n){let e=5381,t=n.length;for(;t--;)e=(e<<5)-e^n.charCodeAt(t);return e>>>0}function Eu(n,e){const t={stylesheet:gu(e),rules:{}};return Ai.set(n,t),t}function Mi(n,e,t,i,s,o,r,l=0){const a=16.666/i;let c=`{
`;for(let v=0;v<=1;v+=a){const w=e+(t-e)*o(v);c+=v*100+`%{${r(w,1-w)}}
`}const u=c+`100% {${r(t,1-t)}}
}`,d=`__svelte_${Cu(u)}_${l}`,f=la(n),{stylesheet:_,rules:h}=Ai.get(f)||Eu(f,n);h[d]||(h[d]=!0,_.insertRule(`@keyframes ${d} ${u}`,_.cssRules.length));const b=n.style.animation||"";return n.style.animation=`${b?`${b}, `:""}${d} ${i}ms linear ${s}ms 1 both`,Pi+=1,d}function Li(n,e){const t=(n.style.animation||"").split(", "),i=t.filter(e?o=>o.indexOf(e)<0:o=>o.indexOf("__svelte")===-1),s=t.length-i.length;s&&(n.style.animation=i.join(", "),Pi-=s,Pi||Su())}function Su(){no(()=>{Pi||(Ai.forEach(n=>{const{ownerNode:e}=n.stylesheet;e&&P(e)}),Ai.clear())})}let ri;function ti(n){ri=n}function ua(){if(!ri)throw new Error("Function called outside component initialization");return ri}function Iu(n){ua().$$.on_mount.push(n)}function Wt(){const n=ua();return(e,t,{cancelable:i=!1}={})=>{const s=n.$$.callbacks[e];if(s){const o=ca(e,t,{cancelable:i});return s.slice().forEach(r=>{r.call(n,o)}),!o.defaultPrevented}return!0}}const Tn=[],re=[];let Dn=[];const As=[],Tu=Promise.resolve();let Ps=!1;function Nu(){Ps||(Ps=!0,Tu.then(da))}function ye(n){Dn.push(n)}function Me(n){As.push(n)}const vs=new Set;let En=0;function da(){if(En!==0)return;const n=ri;do{try{for(;En<Tn.length;){const e=Tn[En];En++,ti(e),Ou(e.$$)}}catch(e){throw Tn.length=0,En=0,e}for(ti(null),Tn.length=0,En=0;re.length;)re.pop()();for(let e=0;e<Dn.length;e+=1){const t=Dn[e];vs.has(t)||(vs.add(t),t())}Dn.length=0}while(Tn.length);for(;As.length;)As.pop()();Ps=!1,vs.clear(),ti(n)}function Ou(n){if(n.fragment!==null){n.update(),be(n.before_update);const e=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,e),n.after_update.forEach(ye)}}function Du(n){const e=[],t=[];Dn.forEach(i=>n.indexOf(i)===-1?e.push(i):t.push(i)),t.forEach(i=>i()),Dn=e}let Xn;function so(){return Xn||(Xn=Promise.resolve(),Xn.then(()=>{Xn=null})),Xn}function pn(n,e,t){n.dispatchEvent(ca(`${e?"intro":"outro"}${t}`))}const Di=new Set;let qt;function We(){qt={r:0,c:[],p:qt}}function He(){qt.r||be(qt.c),qt=qt.p}function F(n,e){n&&n.i&&(Di.delete(n),n.i(e))}function W(n,e,t,i){if(n&&n.o){if(Di.has(n))return;Di.add(n),qt.c.push(()=>{Di.delete(n),i&&(t&&n.d(1),i())}),n.o(e)}else i&&i()}const oo={duration:0};function fa(n,e,t){const i={direction:"in"};let s=e(n,t,i),o=!1,r,l,a=0;function c(){r&&Li(n,r)}function u(){const{delay:f=0,duration:_=300,easing:h=es,tick:b=ie,css:v}=s||oo;v&&(r=Mi(n,0,1,_,f,h,v,a++)),b(0,1);const w=to()+f,k=w+_;l&&l.abort(),o=!0,ye(()=>pn(n,!0,"start")),l=io(y=>{if(o){if(y>=k)return b(1,0),pn(n,!0,"end"),c(),o=!1;if(y>=w){const I=h((y-w)/_);b(I,1-I)}}return o})}let d=!1;return{start(){d||(d=!0,Li(n),Un(s)?(s=s(i),so().then(u)):u())},invalidate(){d=!1},end(){o&&(c(),o=!1)}}}function ha(n,e,t){const i={direction:"out"};let s=e(n,t,i),o=!0,r;const l=qt;l.r+=1;let a;function c(){const{delay:u=0,duration:d=300,easing:f=es,tick:_=ie,css:h}=s||oo;h&&(r=Mi(n,1,0,d,u,f,h));const b=to()+u,v=b+d;ye(()=>pn(n,!1,"start")),"inert"in n&&(a=n.inert,n.inert=!0),io(w=>{if(o){if(w>=v)return _(0,1),pn(n,!1,"end"),--l.r||be(l.c),!1;if(w>=b){const k=f((w-b)/d);_(1-k,k)}}return o})}return Un(s)?so().then(()=>{s=s(i),c()}):c(),{end(u){u&&"inert"in n&&(n.inert=a),u&&s.tick&&s.tick(1,0),o&&(r&&Li(n,r),o=!1)}}}function me(n,e,t,i){let o=e(n,t,{direction:"both"}),r=i?0:1,l=null,a=null,c=null,u;function d(){c&&Li(n,c)}function f(h,b){const v=h.b-r;return b*=Math.abs(v),{a:r,b:h.b,d:v,duration:b,start:h.start,end:h.start+b,group:h.group}}function _(h){const{delay:b=0,duration:v=300,easing:w=es,tick:k=ie,css:y}=o||oo,I={start:to()+b,b:h};h||(I.group=qt,qt.r+=1),"inert"in n&&(h?u!==void 0&&(n.inert=u):(u=n.inert,n.inert=!0)),l||a?a=I:(y&&(d(),c=Mi(n,r,h,v,b,w,y)),h&&k(0,1),l=f(I,v),ye(()=>pn(n,h,"start")),io(D=>{if(a&&D>a.start&&(l=f(a,v),a=null,pn(n,l.b,"start"),y&&(d(),c=Mi(n,r,l.b,l.duration,0,w,o.css))),l){if(D>=l.end)k(r=l.b,1-r),pn(n,l.b,"end"),a||(l.b?d():--l.group.r||be(l.group.c)),l=null;else if(D>=l.start){const z=D-l.start;r=l.a+l.d*w(z/l.duration),k(r,1-r)}}return!!(l||a)}))}return{run(h){Un(o)?so().then(()=>{o=o({direction:h?"in":"out"}),_(h)}):_(h)},end(){d(),l=a=null}}}function De(n){return(n==null?void 0:n.length)!==void 0?n:Array.from(n)}function Le(n,e,t){const i=n.$$.props[e];i!==void 0&&(n.$$.bound[i]=t,t(n.$$.ctx[i]))}function le(n){n&&n.c()}function se(n,e,t){const{fragment:i,after_update:s}=n.$$;i&&i.m(e,t),ye(()=>{const o=n.$$.on_mount.map(na).filter(Un);n.$$.on_destroy?n.$$.on_destroy.push(...o):be(o),n.$$.on_mount=[]}),s.forEach(ye)}function oe(n,e){const t=n.$$;t.fragment!==null&&(Du(t.after_update),be(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function Ru(n,e){n.$$.dirty[0]===-1&&(Tn.push(n),Nu(),n.$$.dirty.fill(0)),n.$$.dirty[e/31|0]|=1<<e%31}function Re(n,e,t,i,s,o,r=null,l=[-1]){const a=ri;ti(n);const c=n.$$={fragment:null,ctx:[],props:o,update:ie,not_equal:s,bound:Ko(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(a?a.$$.context:[])),callbacks:Ko(),dirty:l,skip_bound:!1,root:e.target||a.$$.root};r&&r(c.root);let u=!1;if(c.ctx=t?t(n,e.props||{},(d,f,..._)=>{const h=_.length?_[0]:f;return c.ctx&&s(c.ctx[d],c.ctx[d]=h)&&(!c.skip_bound&&c.bound[d]&&c.bound[d](h),u&&Ru(n,d)),f}):[],c.update(),u=!0,be(c.before_update),c.fragment=i?i(c.ctx):!1,e.target){if(e.hydrate){const d=yu(e.target);c.fragment&&c.fragment.l(d),d.forEach(P)}else c.fragment&&c.fragment.c();e.intro&&F(n.$$.fragment),se(n,e.target,e.anchor),da()}ti(a)}class Ae{constructor(){Qt(this,"$$");Qt(this,"$$set")}$destroy(){oe(this,1),this.$destroy=ie}$on(e,t){if(!Un(t))return ie;const i=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return i.push(t),()=>{const s=i.indexOf(t);s!==-1&&i.splice(s,1)}}$set(e){this.$$set&&!uu(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Au="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Au);const Sn=[];function ot(n,e=ie){let t;const i=new Set;function s(l){if(ge(n,l)&&(n=l,t)){const a=!Sn.length;for(const c of i)c[1](),Sn.push(c,n);if(a){for(let c=0;c<Sn.length;c+=2)Sn[c][0](Sn[c+1]);Sn.length=0}}}function o(l){s(l(n))}function r(l,a=ie){const c=[l,a];return i.add(c),i.size===1&&(t=e(s,o)||ie),l(n),()=>{i.delete(c),i.size===0&&t&&(t(),t=null)}}return{set:s,update:o,subscribe:r}}let Yo=localStorage.getItem("builds"),Qo=0,Xo=localStorage.getItem("changelogSeen"),Pt=ot({}),Mt=ot({}),gt=ot({armor:0,magicDmg:0,meleeDmg:0,rangedDmg:0,hpRegen:0,endurance:0,sightRange:0,walkSpeed:0,jumpPower:0,ammoReturn:0,height:0}),zt=ot({}),ro=ot([]),ys=ot({}),wt=ot(),lo=ot(!1),Nt=ot(Yo?JSON.parse(Yo):{}),Xt=ot(!1),Ri=ot(Xo?JSON.parse(Xo):!1),gn=ot(!1),Ln=ot({}),Fn=ot({}),Pu=ot({}),It=ot({armor:{min:0,avg:0,max:0},gear:{min:0,avg:0,max:0},total:{min:0,avg:0,max:0}}),Rn=ot({}),Jn=ot({parasol:!0,armor:!0,gear:!0,basic:!0}),x=ot({item:{ongoing:!1,data:null},export:{ongoing:!1,status:null},save:{ongoing:!1,status:null},load:{ongoing:!1,status:null},delete:{ongoing:!1,status:null},share:{ongoing:!1},costs:{ongoing:!1},bonus:{ongoing:!1},screenshot:{ongoing:!1},randomize:{ongoing:!1},resources:{ongoing:!1},changelog:{ongoing:!1},policy:{ongoing:!1},message:""});Nt.subscribe(n=>{Qo++,setTimeout(()=>{window.localStorage.setItem("builds",JSON.stringify(n)),Qo>1&&window.history.replaceState(null,null,location.origin+location.pathname)})});Ri.subscribe(n=>window.localStorage.setItem("changelogSeen",n));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _a={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ee=function(n,e){if(!n)throw Gn(e)},Gn=function(n){return new Error("Firebase Database ("+_a.SDK_VERSION+") INTERNAL ASSERT FAILED: "+n)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pa=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let s=n.charCodeAt(i);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},Mu=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const s=n[t++];if(s<128)e[i++]=String.fromCharCode(s);else if(s>191&&s<224){const o=n[t++];e[i++]=String.fromCharCode((s&31)<<6|o&63)}else if(s>239&&s<365){const o=n[t++],r=n[t++],l=n[t++],a=((s&7)<<18|(o&63)<<12|(r&63)<<6|l&63)-65536;e[i++]=String.fromCharCode(55296+(a>>10)),e[i++]=String.fromCharCode(56320+(a&1023))}else{const o=n[t++],r=n[t++];e[i++]=String.fromCharCode((s&15)<<12|(o&63)<<6|r&63)}}return e.join("")},ao={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let s=0;s<n.length;s+=3){const o=n[s],r=s+1<n.length,l=r?n[s+1]:0,a=s+2<n.length,c=a?n[s+2]:0,u=o>>2,d=(o&3)<<4|l>>4;let f=(l&15)<<2|c>>6,_=c&63;a||(_=64,r||(f=64)),i.push(t[u],t[d],t[f],t[_])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(pa(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):Mu(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let s=0;s<n.length;){const o=t[n.charAt(s++)],l=s<n.length?t[n.charAt(s)]:0;++s;const c=s<n.length?t[n.charAt(s)]:64;++s;const d=s<n.length?t[n.charAt(s)]:64;if(++s,o==null||l==null||c==null||d==null)throw new Lu;const f=o<<2|l>>4;if(i.push(f),c!==64){const _=l<<4&240|c>>2;if(i.push(_),d!==64){const h=c<<6&192|d;i.push(h)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class Lu extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const ma=function(n){const e=pa(n);return ao.encodeByteArray(e,!0)},Fi=function(n){return ma(n).replace(/\./g,"")},Ms=function(n){try{return ao.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fu(n){return ga(void 0,n)}function ga(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!Bu(t)||(n[t]=ga(n[t],e[t]));return n}function Bu(n){return n!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qu(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zu=()=>qu().__FIREBASE_DEFAULTS__,ju=()=>{if(typeof process>"u"||typeof process.env>"u")return;const n={}.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},Wu=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Ms(n[1]);return e&&JSON.parse(e)},ba=()=>{try{return zu()||ju()||Wu()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Hu=n=>{var e,t;return(t=(e=ba())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},Uu=n=>{const e=Hu(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},va=()=>{var n;return(n=ba())===null||n===void 0?void 0:n.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ts{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gu(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",s=n.iat||0,o=n.sub||n.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const r=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:s,exp:s+3600,auth_time:s,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},n),l="";return[Fi(JSON.stringify(t)),Fi(JSON.stringify(r)),l].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vu(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function ya(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Vu())}function Ku(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function wa(){return _a.NODE_ADMIN===!0}function Yu(){try{return typeof indexedDB=="object"}catch{return!1}}function Qu(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(i);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{var o;e(((o=s.error)===null||o===void 0?void 0:o.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xu="FirebaseError";class vi extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=Xu,Object.setPrototypeOf(this,vi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ka.prototype.create)}}class ka{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},s=`${this.service}/${e}`,o=this.errors[e],r=o?Ju(o,i):"Error",l=`${this.serviceName}: ${r} (${s}).`;return new vi(s,l,i)}}function Ju(n,e){return n.replace(Zu,(t,i)=>{const s=e[i];return s!=null?String(s):`<${i}?>`})}const Zu=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function li(n){return JSON.parse(n)}function it(n){return JSON.stringify(n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ca=function(n){let e={},t={},i={},s="";try{const o=n.split(".");e=li(Ms(o[0])||""),t=li(Ms(o[1])||""),s=o[2],i=t.d||{},delete t.d}catch{}return{header:e,claims:t,data:i,signature:s}},xu=function(n){const e=Ca(n),t=e.claims;return!!t&&typeof t=="object"&&t.hasOwnProperty("iat")},$u=function(n){const e=Ca(n).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ht(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function Bn(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]}function Jo(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Bi(n,e,t){const i={};for(const s in n)Object.prototype.hasOwnProperty.call(n,s)&&(i[s]=e.call(t,n[s],s,n));return i}function Ls(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const s of t){if(!i.includes(s))return!1;const o=n[s],r=e[s];if(Zo(o)&&Zo(r)){if(!Ls(o,r))return!1}else if(o!==r)return!1}for(const s of i)if(!t.includes(s))return!1;return!0}function Zo(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ed(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class td{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const i=this.W_;if(typeof e=="string")for(let d=0;d<16;d++)i[d]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let d=0;d<16;d++)i[d]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let d=16;d<80;d++){const f=i[d-3]^i[d-8]^i[d-14]^i[d-16];i[d]=(f<<1|f>>>31)&4294967295}let s=this.chain_[0],o=this.chain_[1],r=this.chain_[2],l=this.chain_[3],a=this.chain_[4],c,u;for(let d=0;d<80;d++){d<40?d<20?(c=l^o&(r^l),u=1518500249):(c=o^r^l,u=1859775393):d<60?(c=o&r|l&(o|r),u=2400959708):(c=o^r^l,u=3395469782);const f=(s<<5|s>>>27)+c+a+u+i[d]&4294967295;a=l,l=r,r=(o<<30|o>>>2)&4294967295,o=s,s=f}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+o&4294967295,this.chain_[2]=this.chain_[2]+r&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+a&4294967295}update(e,t){if(e==null)return;t===void 0&&(t=e.length);const i=t-this.blockSize;let s=0;const o=this.buf_;let r=this.inbuf_;for(;s<t;){if(r===0)for(;s<=i;)this.compress_(e,s),s+=this.blockSize;if(typeof e=="string"){for(;s<t;)if(o[r]=e.charCodeAt(s),++r,++s,r===this.blockSize){this.compress_(o),r=0;break}}else for(;s<t;)if(o[r]=e[s],++r,++s,r===this.blockSize){this.compress_(o),r=0;break}}this.inbuf_=r,this.total_+=t}digest(){const e=[];let t=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let s=this.blockSize-1;s>=56;s--)this.buf_[s]=t&255,t/=256;this.compress_(this.buf_);let i=0;for(let s=0;s<5;s++)for(let o=24;o>=0;o-=8)e[i]=this.chain_[s]>>o&255,++i;return e}}function co(n,e){return`${n} failed: ${e} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nd=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let s=n.charCodeAt(i);if(s>=55296&&s<=56319){const o=s-55296;i++,ee(i<n.length,"Surrogate pair missing trail surrogate.");const r=n.charCodeAt(i)-56320;s=65536+(o<<10)+r}s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):s<65536?(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},ns=function(n){let e=0;for(let t=0;t<n.length;t++){const i=n.charCodeAt(t);i<128?e++:i<2048?e+=2:i>=55296&&i<=56319?(e+=4,t++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function an(n){return n&&n._delegate?n._delegate:n}class ai{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const un="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class id{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new ts;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&i.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const i=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(o){if(s)return null;throw o}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(od(e))try{this.getOrInitializeService({instanceIdentifier:un})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const o=this.getOrInitializeService({instanceIdentifier:s});i.resolve(o)}catch{}}}}clearInstance(e=un){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=un){return this.instances.has(e)}getOptions(e=un){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[o,r]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(o);i===l&&r.resolve(s)}return s}onInit(e,t){var i;const s=this.normalizeInstanceIdentifier(t),o=(i=this.onInitCallbacks.get(s))!==null&&i!==void 0?i:new Set;o.add(e),this.onInitCallbacks.set(s,o);const r=this.instances.get(s);return r&&e(r,s),()=>{o.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const s of i)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:sd(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=un){return this.component?this.component.multipleInstances?e:un:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function sd(n){return n===un?void 0:n}function od(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rd{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new id(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ke;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Ke||(Ke={}));const ld={debug:Ke.DEBUG,verbose:Ke.VERBOSE,info:Ke.INFO,warn:Ke.WARN,error:Ke.ERROR,silent:Ke.SILENT},ad=Ke.INFO,cd={[Ke.DEBUG]:"log",[Ke.VERBOSE]:"log",[Ke.INFO]:"info",[Ke.WARN]:"warn",[Ke.ERROR]:"error"},ud=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),s=cd[e];if(s)console[s](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Ea{constructor(e){this.name=e,this._logLevel=ad,this._logHandler=ud,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ke))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?ld[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ke.DEBUG,...e),this._logHandler(this,Ke.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ke.VERBOSE,...e),this._logHandler(this,Ke.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ke.INFO,...e),this._logHandler(this,Ke.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ke.WARN,...e),this._logHandler(this,Ke.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ke.ERROR,...e),this._logHandler(this,Ke.ERROR,...e)}}const dd=(n,e)=>e.some(t=>n instanceof t);let xo,$o;function fd(){return xo||(xo=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function hd(){return $o||($o=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Sa=new WeakMap,Fs=new WeakMap,Ia=new WeakMap,ws=new WeakMap,uo=new WeakMap;function _d(n){const e=new Promise((t,i)=>{const s=()=>{n.removeEventListener("success",o),n.removeEventListener("error",r)},o=()=>{t(Jt(n.result)),s()},r=()=>{i(n.error),s()};n.addEventListener("success",o),n.addEventListener("error",r)});return e.then(t=>{t instanceof IDBCursor&&Sa.set(t,n)}).catch(()=>{}),uo.set(e,n),e}function pd(n){if(Fs.has(n))return;const e=new Promise((t,i)=>{const s=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",r),n.removeEventListener("abort",r)},o=()=>{t(),s()},r=()=>{i(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",o),n.addEventListener("error",r),n.addEventListener("abort",r)});Fs.set(n,e)}let Bs={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Fs.get(n);if(e==="objectStoreNames")return n.objectStoreNames||Ia.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Jt(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function md(n){Bs=n(Bs)}function gd(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(ks(this),e,...t);return Ia.set(i,e.sort?e.sort():[e]),Jt(i)}:hd().includes(n)?function(...e){return n.apply(ks(this),e),Jt(Sa.get(this))}:function(...e){return Jt(n.apply(ks(this),e))}}function bd(n){return typeof n=="function"?gd(n):(n instanceof IDBTransaction&&pd(n),dd(n,fd())?new Proxy(n,Bs):n)}function Jt(n){if(n instanceof IDBRequest)return _d(n);if(ws.has(n))return ws.get(n);const e=bd(n);return e!==n&&(ws.set(n,e),uo.set(e,n)),e}const ks=n=>uo.get(n);function vd(n,e,{blocked:t,upgrade:i,blocking:s,terminated:o}={}){const r=indexedDB.open(n,e),l=Jt(r);return i&&r.addEventListener("upgradeneeded",a=>{i(Jt(r.result),a.oldVersion,a.newVersion,Jt(r.transaction),a)}),t&&r.addEventListener("blocked",a=>t(a.oldVersion,a.newVersion,a)),l.then(a=>{o&&a.addEventListener("close",()=>o()),s&&a.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),l}const yd=["get","getKey","getAll","getAllKeys","count"],wd=["put","add","delete","clear"],Cs=new Map;function er(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Cs.get(e))return Cs.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,s=wd.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(s||yd.includes(t)))return;const o=async function(r,...l){const a=this.transaction(r,s?"readwrite":"readonly");let c=a.store;return i&&(c=c.index(l.shift())),(await Promise.all([c[t](...l),s&&a.done]))[0]};return Cs.set(e,o),o}md(n=>({...n,get:(e,t,i)=>er(e,t)||n.get(e,t,i),has:(e,t)=>!!er(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kd{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(Cd(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function Cd(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const qs="@firebase/app",tr="0.9.23";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bn=new Ea("@firebase/app"),Ed="@firebase/app-compat",Sd="@firebase/analytics-compat",Id="@firebase/analytics",Td="@firebase/app-check-compat",Nd="@firebase/app-check",Od="@firebase/auth",Dd="@firebase/auth-compat",Rd="@firebase/database",Ad="@firebase/database-compat",Pd="@firebase/functions",Md="@firebase/functions-compat",Ld="@firebase/installations",Fd="@firebase/installations-compat",Bd="@firebase/messaging",qd="@firebase/messaging-compat",zd="@firebase/performance",jd="@firebase/performance-compat",Wd="@firebase/remote-config",Hd="@firebase/remote-config-compat",Ud="@firebase/storage",Gd="@firebase/storage-compat",Vd="@firebase/firestore",Kd="@firebase/firestore-compat",Yd="firebase",Qd="10.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zs="[DEFAULT]",Xd={[qs]:"fire-core",[Ed]:"fire-core-compat",[Id]:"fire-analytics",[Sd]:"fire-analytics-compat",[Nd]:"fire-app-check",[Td]:"fire-app-check-compat",[Od]:"fire-auth",[Dd]:"fire-auth-compat",[Rd]:"fire-rtdb",[Ad]:"fire-rtdb-compat",[Pd]:"fire-fn",[Md]:"fire-fn-compat",[Ld]:"fire-iid",[Fd]:"fire-iid-compat",[Bd]:"fire-fcm",[qd]:"fire-fcm-compat",[zd]:"fire-perf",[jd]:"fire-perf-compat",[Wd]:"fire-rc",[Hd]:"fire-rc-compat",[Ud]:"fire-gcs",[Gd]:"fire-gcs-compat",[Vd]:"fire-fst",[Kd]:"fire-fst-compat","fire-js":"fire-js",[Yd]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qi=new Map,js=new Map;function Jd(n,e){try{n.container.addComponent(e)}catch(t){bn.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function zi(n){const e=n.name;if(js.has(e))return bn.debug(`There were multiple attempts to register component ${e}.`),!1;js.set(e,n);for(const t of qi.values())Jd(t,n);return!0}function Zd(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xd={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},Zt=new ka("app","Firebase",xd);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $d{constructor(e,t,i){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new ai("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Zt.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ef=Qd;function Ta(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i=Object.assign({name:zs,automaticDataCollectionEnabled:!1},e),s=i.name;if(typeof s!="string"||!s)throw Zt.create("bad-app-name",{appName:String(s)});if(t||(t=va()),!t)throw Zt.create("no-options");const o=qi.get(s);if(o){if(Ls(t,o.options)&&Ls(i,o.config))return o;throw Zt.create("duplicate-app",{appName:s})}const r=new rd(s);for(const a of js.values())r.addComponent(a);const l=new $d(t,i,r);return qi.set(s,l),l}function tf(n=zs){const e=qi.get(n);if(!e&&n===zs&&va())return Ta();if(!e)throw Zt.create("no-app",{appName:n});return e}function An(n,e,t){var i;let s=(i=Xd[n])!==null&&i!==void 0?i:n;t&&(s+=`-${t}`);const o=s.match(/\s|\//),r=e.match(/\s|\//);if(o||r){const l=[`Unable to register library "${s}" with version "${e}":`];o&&l.push(`library name "${s}" contains illegal characters (whitespace or "/")`),o&&r&&l.push("and"),r&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),bn.warn(l.join(" "));return}zi(new ai(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nf="firebase-heartbeat-database",sf=1,ci="firebase-heartbeat-store";let Es=null;function Na(){return Es||(Es=vd(nf,sf,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(ci)}}}).catch(n=>{throw Zt.create("idb-open",{originalErrorMessage:n.message})})),Es}async function of(n){try{return await(await Na()).transaction(ci).objectStore(ci).get(Oa(n))}catch(e){if(e instanceof vi)bn.warn(e.message);else{const t=Zt.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});bn.warn(t.message)}}}async function nr(n,e){try{const i=(await Na()).transaction(ci,"readwrite");await i.objectStore(ci).put(e,Oa(n)),await i.done}catch(t){if(t instanceof vi)bn.warn(t.message);else{const i=Zt.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});bn.warn(i.message)}}}function Oa(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rf=1024,lf=30*24*60*60*1e3;class af{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new uf(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var e;const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=ir();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)))return this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const r=new Date(o.date).valueOf();return Date.now()-r<=lf}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var e;if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=ir(),{heartbeatsToSend:i,unsentEntries:s}=cf(this._heartbeatsCache.heartbeats),o=Fi(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=t,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}}function ir(){return new Date().toISOString().substring(0,10)}function cf(n,e=rf){const t=[];let i=n.slice();for(const s of n){const o=t.find(r=>r.agent===s.agent);if(o){if(o.dates.push(s.date),sr(t)>e){o.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),sr(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class uf{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Yu()?Qu().then(()=>!0).catch(()=>!1):!1}async read(){return await this._canUseIndexedDBPromise?await of(this.app)||{heartbeats:[]}:{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return nr(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return nr(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function sr(n){return Fi(JSON.stringify({version:2,heartbeats:n})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function df(n){zi(new ai("platform-logger",e=>new kd(e),"PRIVATE")),zi(new ai("heartbeat",e=>new af(e),"PRIVATE")),An(qs,tr,n),An(qs,tr,"esm2017"),An("fire-js","")}df("");var ff="firebase",hf="10.6.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */An(ff,hf,"app");const or="@firebase/database",rr="1.0.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Da="";function _f(n){Da=n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pf{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),it(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:li(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mf{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return Ht(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ra=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){const e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new pf(e)}}catch{}return new mf},hn=Ra("localStorage"),Ws=Ra("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pn=new Ea("@firebase/database"),gf=function(){let n=1;return function(){return n++}}(),Aa=function(n){const e=nd(n),t=new td;t.update(e);const i=t.digest();return ao.encodeByteArray(i)},yi=function(...n){let e="";for(let t=0;t<n.length;t++){const i=n[t];Array.isArray(i)||i&&typeof i=="object"&&typeof i.length=="number"?e+=yi.apply(null,i):typeof i=="object"?e+=it(i):e+=i,e+=" "}return e};let mn=null,lr=!0;const bf=function(n,e){ee(!e||n===!0||n===!1,"Can't turn on custom loggers persistently."),n===!0?(Pn.logLevel=Ke.VERBOSE,mn=Pn.log.bind(Pn),e&&Ws.set("logging_enabled",!0)):typeof n=="function"?mn=n:(mn=null,Ws.remove("logging_enabled"))},pt=function(...n){if(lr===!0&&(lr=!1,mn===null&&Ws.get("logging_enabled")===!0&&bf(!0)),mn){const e=yi.apply(null,n);mn(e)}},wi=function(n){return function(...e){pt(n,...e)}},Hs=function(...n){const e="FIREBASE INTERNAL ERROR: "+yi(...n);Pn.error(e)},Vt=function(...n){const e=`FIREBASE FATAL ERROR: ${yi(...n)}`;throw Pn.error(e),new Error(e)},Ct=function(...n){const e="FIREBASE WARNING: "+yi(...n);Pn.warn(e)},vf=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Ct("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},fo=function(n){return typeof n=="number"&&(n!==n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},yf=function(n){if(document.readyState==="complete")n();else{let e=!1;const t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,n())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},vn="[MIN_NAME]",sn="[MAX_NAME]",Vn=function(n,e){if(n===e)return 0;if(n===vn||e===sn)return-1;if(e===vn||n===sn)return 1;{const t=ar(n),i=ar(e);return t!==null?i!==null?t-i===0?n.length-e.length:t-i:-1:i!==null?1:n<e?-1:1}},wf=function(n,e){return n===e?0:n<e?-1:1},Zn=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+it(e))},ho=function(n){if(typeof n!="object"||n===null)return it(n);const e=[];for(const i in n)e.push(i);e.sort();let t="{";for(let i=0;i<e.length;i++)i!==0&&(t+=","),t+=it(e[i]),t+=":",t+=ho(n[e[i]]);return t+="}",t},Pa=function(n,e){const t=n.length;if(t<=e)return[n];const i=[];for(let s=0;s<t;s+=e)s+e>t?i.push(n.substring(s,t)):i.push(n.substring(s,s+e));return i};function Et(n,e){for(const t in n)n.hasOwnProperty(t)&&e(t,n[t])}const Ma=function(n){ee(!fo(n),"Invalid JSON number");const e=11,t=52,i=(1<<e-1)-1;let s,o,r,l,a;n===0?(o=0,r=0,s=1/n===-1/0?1:0):(s=n<0,n=Math.abs(n),n>=Math.pow(2,1-i)?(l=Math.min(Math.floor(Math.log(n)/Math.LN2),i),o=l+i,r=Math.round(n*Math.pow(2,t-l)-Math.pow(2,t))):(o=0,r=Math.round(n/Math.pow(2,1-i-t))));const c=[];for(a=t;a;a-=1)c.push(r%2?1:0),r=Math.floor(r/2);for(a=e;a;a-=1)c.push(o%2?1:0),o=Math.floor(o/2);c.push(s?1:0),c.reverse();const u=c.join("");let d="";for(a=0;a<64;a+=8){let f=parseInt(u.substr(a,8),2).toString(16);f.length===1&&(f="0"+f),d=d+f}return d.toLowerCase()},kf=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},Cf=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function Ef(n,e){let t="Unknown Error";n==="too_big"?t="The data requested exceeds the maximum size that can be accessed with a single request.":n==="permission_denied"?t="Client doesn't have permission to access the desired data.":n==="unavailable"&&(t="The service is unavailable");const i=new Error(n+" at "+e._path.toString()+": "+t);return i.code=n.toUpperCase(),i}const Sf=new RegExp("^-?(0*)\\d{1,10}$"),If=-2147483648,Tf=2147483647,ar=function(n){if(Sf.test(n)){const e=Number(n);if(e>=If&&e<=Tf)return e}return null},Kn=function(n){try{n()}catch(e){setTimeout(()=>{const t=e.stack||"";throw Ct("Exception was thrown by user callback.",t),e},Math.floor(0))}},Nf=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},ni=function(n,e){const t=setTimeout(n,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Of{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=t==null?void 0:t.getImmediate({optional:!0}),this.appCheck||t==null||t.get().then(i=>this.appCheck=i)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,i)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,i):t(null)},0)})}addTokenChangeListener(e){var t;(t=this.appCheckProvider)===null||t===void 0||t.get().then(i=>i.addTokenListener(e))}notifyForInvalidToken(){Ct(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Df{constructor(e,t,i){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=i,this.auth_=null,this.auth_=i.getImmediate({optional:!0}),this.auth_||i.onInit(s=>this.auth_=s)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(pt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,i)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,i):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Ct(e)}}class Mn{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}Mn.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _o="5",La="v",Fa="s",Ba="r",qa="f",za=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,ja="ls",Wa="p",Us="ac",Ha="websocket",Ua="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ga{constructor(e,t,i,s,o=!1,r="",l=!1,a=!1){this.secure=t,this.namespace=i,this.webSocketOnly=s,this.nodeAdmin=o,this.persistenceKey=r,this.includeNamespaceInQueryParams=l,this.isUsingEmulator=a,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=hn.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&hn.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}}function Rf(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams}function Va(n,e,t){ee(typeof e=="string","typeof type must == string"),ee(typeof t=="object","typeof params must == object");let i;if(e===Ha)i=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else if(e===Ua)i=(n.secure?"https://":"http://")+n.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);Rf(n)&&(t.ns=n.namespace);const s=[];return Et(t,(o,r)=>{s.push(o+"="+r)}),i+s.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Af{constructor(){this.counters_={}}incrementCounter(e,t=1){Ht(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return Fu(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ss={},Is={};function po(n){const e=n.toString();return Ss[e]||(Ss[e]=new Af),Ss[e]}function Pf(n,e){const t=n.toString();return Is[t]||(Is[t]=e()),Is[t]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mf{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const i=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let s=0;s<i.length;++s)i[s]&&Kn(()=>{this.onMessage_(i[s])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cr="start",Lf="close",Ff="pLPCommand",Bf="pRTLPCB",Ka="id",Ya="pw",Qa="ser",qf="cb",zf="seg",jf="ts",Wf="d",Hf="dframe",Xa=1870,Ja=30,Uf=Xa-Ja,Gf=25e3,Vf=3e4;class Nn{constructor(e,t,i,s,o,r,l){this.connId=e,this.repoInfo=t,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.transportSessionId=r,this.lastSessionId=l,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=wi(e),this.stats_=po(t),this.urlFn=a=>(this.appCheckToken&&(a[Us]=this.appCheckToken),Va(t,Ua,a))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new Mf(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(Vf)),yf(()=>{if(this.isClosed_)return;this.scriptTagHolder=new mo((...o)=>{const[r,l,a,c,u]=o;if(this.incrementIncomingBytes_(o),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,r===cr)this.id=l,this.password=a;else if(r===Lf)l?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(l,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+r)},(...o)=>{const[r,l]=o;this.incrementIncomingBytes_(o),this.myPacketOrderer.handleResponse(r,l)},()=>{this.onClosed_()},this.urlFn);const i={};i[cr]="t",i[Qa]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(i[qf]=this.scriptTagHolder.uniqueCallbackIdentifier),i[La]=_o,this.transportSessionId&&(i[Fa]=this.transportSessionId),this.lastSessionId&&(i[ja]=this.lastSessionId),this.applicationId&&(i[Wa]=this.applicationId),this.appCheckToken&&(i[Us]=this.appCheckToken),typeof location<"u"&&location.hostname&&za.test(location.hostname)&&(i[Ba]=qa);const s=this.urlFn(i);this.log_("Connecting via long-poll to "+s),this.scriptTagHolder.addTag(s,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Nn.forceAllow_=!0}static forceDisallow(){Nn.forceDisallow_=!0}static isAvailable(){return Nn.forceAllow_?!0:!Nn.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!kf()&&!Cf()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=it(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const i=ma(t),s=Pa(i,Uf);for(let o=0;o<s.length;o++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,s.length,s[o]),this.curSegmentNum++}addDisconnectPingFrame(e,t){this.myDisconnFrame=document.createElement("iframe");const i={};i[Hf]="t",i[Ka]=e,i[Ya]=t,this.myDisconnFrame.src=this.urlFn(i),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=it(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class mo{constructor(e,t,i,s){this.onDisconnect=i,this.urlFn=s,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=gf(),window[Ff+this.uniqueCallbackIdentifier]=e,window[Bf+this.uniqueCallbackIdentifier]=t,this.myIFrame=mo.createIFrame_();let o="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(o='<script>document.domain="'+document.domain+'";<\/script>');const r="<html><body>"+o+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(r),this.myIFrame.doc.close()}catch(l){pt("frame writing exception"),l.stack&&pt(l.stack),pt(l)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||pt("No IE domain setting required")}catch{const i=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+i+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[Ka]=this.myID,e[Ya]=this.myPW,e[Qa]=this.currentSerial;let t=this.urlFn(e),i="",s=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+Ja+i.length<=Xa;){const r=this.pendingSegs.shift();i=i+"&"+zf+s+"="+r.seg+"&"+jf+s+"="+r.ts+"&"+Wf+s+"="+r.d,s++}return t=t+i,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,i){this.pendingSegs.push({seg:e,ts:t,d:i}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const i=()=>{this.outstandingRequests.delete(t),this.newRequest_()},s=setTimeout(i,Math.floor(Gf)),o=()=>{clearTimeout(s),i()};this.addTag(e,o)}addTag(e,t){setTimeout(()=>{try{if(!this.sendNewPolls)return;const i=this.myIFrame.doc.createElement("script");i.type="text/javascript",i.async=!0,i.src=e,i.onload=i.onreadystatechange=function(){const s=i.readyState;(!s||s==="loaded"||s==="complete")&&(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),t())},i.onerror=()=>{pt("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(i)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kf=16384,Yf=45e3;let ji=null;typeof MozWebSocket<"u"?ji=MozWebSocket:typeof WebSocket<"u"&&(ji=WebSocket);class Ot{constructor(e,t,i,s,o,r,l){this.connId=e,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=wi(this.connId),this.stats_=po(t),this.connURL=Ot.connectionURL_(t,r,l,s,i),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,i,s,o){const r={};return r[La]=_o,typeof location<"u"&&location.hostname&&za.test(location.hostname)&&(r[Ba]=qa),t&&(r[Fa]=t),i&&(r[ja]=i),s&&(r[Us]=s),o&&(r[Wa]=o),Va(e,Ha,r)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,hn.set("previous_websocket_failure",!0);try{let i;wa(),this.mySock=new ji(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");const s=i.message||i.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");const s=i.message||i.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){Ot.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(t);i&&i.length>1&&parseFloat(i[1])<4.4&&(e=!0)}return!e&&ji!==null&&!Ot.forceDisallow_}static previouslyFailed(){return hn.isInMemoryStorage||hn.get("previous_websocket_failure")===!0}markConnectionHealthy(){hn.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const t=this.frames.join("");this.frames=null;const i=li(t);this.onMessage(i)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(ee(this.frames===null,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(t);else{const i=this.extractFrameCount_(t);i!==null&&this.appendFrame_(i)}}send(e){this.resetKeepAlive();const t=it(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const i=Pa(t,Kf);i.length>1&&this.sendString_(String(i.length));for(let s=0;s<i.length;s++)this.sendString_(i[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(Yf))}sendString_(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}Ot.responsesRequiredToBeHealthy=2;Ot.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ui{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[Nn,Ot]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const t=Ot&&Ot.isAvailable();let i=t&&!Ot.previouslyFailed();if(e.webSocketOnly&&(t||Ct("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[Ot];else{const s=this.transports_=[];for(const o of ui.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);ui.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}ui.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qf=6e4,Xf=5e3,Jf=10*1024,Zf=100*1024,Ts="t",ur="d",xf="s",dr="r",$f="e",fr="o",hr="a",_r="n",pr="p",eh="h";class th{constructor(e,t,i,s,o,r,l,a,c,u){this.id=e,this.repoInfo_=t,this.applicationId_=i,this.appCheckToken_=s,this.authToken_=o,this.onMessage_=r,this.onReady_=l,this.onDisconnect_=a,this.onKill_=c,this.lastSessionId=u,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=wi("c:"+this.id+":"),this.transportManager_=new ui(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),i=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,i)},Math.floor(0));const s=e.healthyTimeout||0;s>0&&(this.healthyTimeout_=ni(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>Zf?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>Jf?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(s)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(Ts in e){const t=e[Ts];t===hr?this.upgradeIfSecondaryHealthy_():t===dr?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===fr&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=Zn("t",e),i=Zn("d",e);if(t==="c")this.onSecondaryControl_(i);else if(t==="d")this.pendingDataMessages.push(i);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:pr,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:hr,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:_r,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=Zn("t",e),i=Zn("d",e);t==="c"?this.onControl_(i):t==="d"&&this.onDataMessage_(i)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=Zn(Ts,e);if(ur in e){const i=e[ur];if(t===eh){const s=Object.assign({},i);this.repoInfo_.isUsingEmulator&&(s.h=this.repoInfo_.host),this.onHandshake_(s)}else if(t===_r){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let s=0;s<this.pendingDataMessages.length;++s)this.onDataMessage_(this.pendingDataMessages[s]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===xf?this.onConnectionShutdown_(i):t===dr?this.onReset_(i):t===$f?Hs("Server Error: "+i):t===fr?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Hs("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,i=e.v,s=e.h;this.sessionId=e.s,this.repoInfo_.host=s,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),_o!==i&&Ct("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),i=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,i),ni(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(Qf))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):ni(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(Xf))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:pr,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(hn.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Za{put(e,t,i,s){}merge(e,t,i,s){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,i){}onDisconnectMerge(e,t,i){}onDisconnectCancel(e,t){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xa{constructor(e){this.allowedEvents_=e,this.listeners_={},ee(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const i=[...this.listeners_[e]];for(let s=0;s<i.length;s++)i[s].callback.apply(i[s].context,t)}}on(e,t,i){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:i});const s=this.getInitialEvent(e);s&&t.apply(i,s)}off(e,t,i){this.validateEventType_(e);const s=this.listeners_[e]||[];for(let o=0;o<s.length;o++)if(s[o].callback===t&&(!i||i===s[o].context)){s.splice(o,1);return}}validateEventType_(e){ee(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wi extends xa{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!ya()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new Wi}getInitialEvent(e){return ee(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mr=32,gr=768;class Ge{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let i=0;for(let s=0;s<this.pieces_.length;s++)this.pieces_[s].length>0&&(this.pieces_[i]=this.pieces_[s],i++);this.pieces_.length=i,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}}function Be(){return new Ge("")}function Ie(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function on(n){return n.pieces_.length-n.pieceNum_}function Ye(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new Ge(n.pieces_,e)}function $a(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function nh(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)n.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}function ec(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function tc(n){if(n.pieceNum_>=n.pieces_.length)return null;const e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new Ge(e,0)}function st(n,e){const t=[];for(let i=n.pieceNum_;i<n.pieces_.length;i++)t.push(n.pieces_[i]);if(e instanceof Ge)for(let i=e.pieceNum_;i<e.pieces_.length;i++)t.push(e.pieces_[i]);else{const i=e.split("/");for(let s=0;s<i.length;s++)i[s].length>0&&t.push(i[s])}return new Ge(t,0)}function Ce(n){return n.pieceNum_>=n.pieces_.length}function bt(n,e){const t=Ie(n),i=Ie(e);if(t===null)return e;if(t===i)return bt(Ye(n),Ye(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function nc(n,e){if(on(n)!==on(e))return!1;for(let t=n.pieceNum_,i=e.pieceNum_;t<=n.pieces_.length;t++,i++)if(n.pieces_[t]!==e.pieces_[i])return!1;return!0}function Dt(n,e){let t=n.pieceNum_,i=e.pieceNum_;if(on(n)>on(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[i])return!1;++t,++i}return!0}class ih{constructor(e,t){this.errorPrefix_=t,this.parts_=ec(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let i=0;i<this.parts_.length;i++)this.byteLength_+=ns(this.parts_[i]);ic(this)}}function sh(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=ns(e),ic(n)}function oh(n){const e=n.parts_.pop();n.byteLength_-=ns(e),n.parts_.length>0&&(n.byteLength_-=1)}function ic(n){if(n.byteLength_>gr)throw new Error(n.errorPrefix_+"has a key path longer than "+gr+" bytes ("+n.byteLength_+").");if(n.parts_.length>mr)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+mr+") or object contains a cycle "+dn(n))}function dn(n){return n.parts_.length===0?"":"in property '"+n.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class go extends xa{constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const i=!document[e];i!==this.visible_&&(this.visible_=i,this.trigger("visible",i))},!1)}static getInstance(){return new go}getInitialEvent(e){return ee(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xn=1e3,rh=60*5*1e3,br=30*1e3,lh=1.3,ah=3e4,ch="server_kill",vr=3;class Gt extends Za{constructor(e,t,i,s,o,r,l,a){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=i,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=r,this.appCheckTokenProvider_=l,this.authOverride_=a,this.id=Gt.nextPersistentConnectionId_++,this.log_=wi("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=xn,this.maxReconnectDelay_=rh,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,a&&!wa())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");go.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&Wi.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,i){const s=++this.requestNumber_,o={r:s,a:e,b:t};this.log_(it(o)),ee(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),i&&(this.requestCBHash_[s]=i)}get(e){this.initConnection_();const t=new ts,s={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:r=>{const l=r.d;r.s==="ok"?t.resolve(l):t.reject(l)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;const o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),t.promise}listen(e,t,i,s){this.initConnection_();const o=e._queryIdentifier,r=e._path.toString();this.log_("Listen called for "+r+" "+o),this.listens.has(r)||this.listens.set(r,new Map),ee(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),ee(!this.listens.get(r).has(o),"listen() called twice for same path/queryId.");const l={onComplete:s,hashFn:t,query:e,tag:i};this.listens.get(r).set(o,l),this.connected_&&this.sendListen_(l)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,i=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(i)})}sendListen_(e){const t=e.query,i=t._path.toString(),s=t._queryIdentifier;this.log_("Listen on "+i+" for "+s);const o={p:i},r="q";e.tag&&(o.q=t._queryObject,o.t=e.tag),o.h=e.hashFn(),this.sendRequest(r,o,l=>{const a=l.d,c=l.s;Gt.warnOnListenWarnings_(a,t),(this.listens.get(i)&&this.listens.get(i).get(s))===e&&(this.log_("listen response",l),c!=="ok"&&this.removeListen_(i,s),e.onComplete&&e.onComplete(c,a))})}static warnOnListenWarnings_(e,t){if(e&&typeof e=="object"&&Ht(e,"w")){const i=Bn(e,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){const s='".indexOn": "'+t._queryParams.getIndex().toString()+'"',o=t._path.toString();Ct(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||$u(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=br)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=xu(e)?"auth":"gauth",i={cred:e};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(t,i,s=>{const o=s.s,r=s.d||"error";this.authToken_===e&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,r))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const t=e.s,i=e.d||"error";t==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,i)})}unlisten(e,t){const i=e._path.toString(),s=e._queryIdentifier;this.log_("Unlisten called for "+i+" "+s),ee(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,s)&&this.connected_&&this.sendUnlisten_(i,s,e._queryObject,t)}sendUnlisten_(e,t,i,s){this.log_("Unlisten on "+e+" for "+t);const o={p:e},r="n";s&&(o.q=i,o.t=s),this.sendRequest(r,o)}onDisconnectPut(e,t,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,i):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:i})}onDisconnectMerge(e,t,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,i):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:i})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,i,s){const o={p:t,d:i};this.log_("onDisconnect "+e,o),this.sendRequest(e,o,r=>{s&&setTimeout(()=>{s(r.s,r.d)},Math.floor(0))})}put(e,t,i,s){this.putInternal("p",e,t,i,s)}merge(e,t,i,s){this.putInternal("m",e,t,i,s)}putInternal(e,t,i,s,o){this.initConnection_();const r={p:t,d:i};o!==void 0&&(r.h=o),this.outstandingPuts_.push({action:e,request:r,onComplete:s}),this.outstandingPutCount_++;const l=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(l):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,i=this.outstandingPuts_[e].request,s=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,i,o=>{this.log_(t+" response",o),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,i=>{if(i.s!=="ok"){const o=i.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+it(e));const t=e.r,i=this.requestCBHash_[t];i&&(delete this.requestCBHash_[t],i(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),e==="d"?this.onDataUpdate_(t.p,t.d,!1,t.t):e==="m"?this.onDataUpdate_(t.p,t.d,!0,t.t):e==="c"?this.onListenRevoked_(t.p,t.q):e==="ac"?this.onAuthRevoked_(t.s,t.d):e==="apc"?this.onAppCheckRevoked_(t.s,t.d):e==="sd"?this.onSecurityDebugPacket_(t):Hs("Unrecognized action received from server: "+it(e)+`
Are you using the latest client?`)}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){ee(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=xn,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=xn,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>ah&&(this.reconnectDelay_=xn),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=new Date().getTime()-this.lastConnectionAttemptTime_;let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*lh)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+Gt.nextConnectionId_++,o=this.lastSessionId;let r=!1,l=null;const a=function(){l?l.close():(r=!0,i())},c=function(d){ee(l,"sendRequest call when we're not connected not allowed."),l.sendRequest(d)};this.realtime_={close:a,sendRequest:c};const u=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[d,f]=await Promise.all([this.authTokenProvider_.getToken(u),this.appCheckTokenProvider_.getToken(u)]);r?pt("getToken() completed but was canceled"):(pt("getToken() completed. Creating connection."),this.authToken_=d&&d.accessToken,this.appCheckToken_=f&&f.token,l=new th(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,i,_=>{Ct(_+" ("+this.repoInfo_.toString()+")"),this.interrupt(ch)},o))}catch(d){this.log_("Failed to get token: "+d),r||(this.repoInfo_.nodeAdmin&&Ct(d),a())}}}interrupt(e){pt("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){pt("Resuming connection for reason: "+e),delete this.interruptReasons_[e],Jo(this.interruptReasons_)&&(this.reconnectDelay_=xn,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let i;t?i=t.map(o=>ho(o)).join("$"):i="default";const s=this.removeListen_(e,i);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(e,t){const i=new Ge(e).toString();let s;if(this.listens.has(i)){const o=this.listens.get(i);s=o.get(t),o.delete(t),o.size===0&&this.listens.delete(i)}else s=void 0;return s}onAuthRevoked_(e,t){pt("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=vr&&(this.reconnectDelay_=br,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){pt("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=vr&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let t="js";e["sdk."+t+"."+Da.replace(/\./g,"-")]=1,ya()?e["framework.cordova"]=1:Ku()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=Wi.getInstance().currentlyOnline();return Jo(this.interruptReasons_)&&e}}Gt.nextPersistentConnectionId_=0;Gt.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class we{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new we(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class is{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const i=new we(vn,e),s=new we(vn,t);return this.compare(i,s)!==0}minPost(){return we.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ni;class sc extends is{static get __EMPTY_NODE(){return Ni}static set __EMPTY_NODE(e){Ni=e}compare(e,t){return Vn(e.name,t.name)}isDefinedOn(e){throw Gn("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return we.MIN}maxPost(){return new we(sn,Ni)}makePost(e,t){return ee(typeof e=="string","KeyIndex indexValue must always be a string."),new we(e,Ni)}toString(){return".key"}}const xt=new sc;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oi{constructor(e,t,i,s,o=null){this.isReverse_=s,this.resultGenerator_=o,this.nodeStack_=[];let r=1;for(;!e.isEmpty();)if(e=e,r=t?i(e.key,t):1,s&&(r*=-1),r<0)this.isReverse_?e=e.left:e=e.right;else if(r===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class lt{constructor(e,t,i,s,o){this.key=e,this.value=t,this.color=i??lt.RED,this.left=s??kt.EMPTY_NODE,this.right=o??kt.EMPTY_NODE}copy(e,t,i,s,o){return new lt(e??this.key,t??this.value,i??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let s=this;const o=i(e,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(e,t,i),null):o===0?s=s.copy(null,t,null,null,null):s=s.copy(null,null,null,null,s.right.insert(e,t,i)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return kt.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let i,s;if(i=this,t(e,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),t(e,i.key)===0){if(i.right.isEmpty())return kt.EMPTY_NODE;s=i.right.min_(),i=i.copy(s.key,s.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,lt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,lt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}lt.RED=!0;lt.BLACK=!1;class uh{copy(e,t,i,s,o){return this}insert(e,t,i){return new lt(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class kt{constructor(e,t=kt.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new kt(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,lt.BLACK,null,null))}remove(e){return new kt(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,lt.BLACK,null,null))}get(e){let t,i=this.root_;for(;!i.isEmpty();){if(t=this.comparator_(e,i.key),t===0)return i.value;t<0?i=i.left:t>0&&(i=i.right)}return null}getPredecessorKey(e){let t,i=this.root_,s=null;for(;!i.isEmpty();)if(t=this.comparator_(e,i.key),t===0){if(i.left.isEmpty())return s?s.key:null;for(i=i.left;!i.right.isEmpty();)i=i.right;return i.key}else t<0?i=i.left:t>0&&(s=i,i=i.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Oi(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Oi(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Oi(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Oi(this.root_,null,this.comparator_,!0,e)}}kt.EMPTY_NODE=new uh;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dh(n,e){return Vn(n.name,e.name)}function bo(n,e){return Vn(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Gs;function fh(n){Gs=n}const oc=function(n){return typeof n=="number"?"number:"+Ma(n):"string:"+n},rc=function(n){if(n.isLeafNode()){const e=n.val();ee(typeof e=="string"||typeof e=="number"||typeof e=="object"&&Ht(e,".sv"),"Priority must be a string or number.")}else ee(n===Gs||n.isEmpty(),"priority of unexpected type.");ee(n===Gs||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let yr;class rt{constructor(e,t=rt.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,ee(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),rc(this.priorityNode_)}static set __childrenNodeConstructor(e){yr=e}static get __childrenNodeConstructor(){return yr}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new rt(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:rt.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return Ce(e)?this:Ie(e)===".priority"?this.priorityNode_:rt.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return e===".priority"?this.updatePriority(t):t.isEmpty()&&e!==".priority"?this:rt.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const i=Ie(e);return i===null?t:t.isEmpty()&&i!==".priority"?this:(ee(i!==".priority"||on(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,rt.__childrenNodeConstructor.EMPTY_NODE.updateChild(Ye(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+oc(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",t==="number"?e+=Ma(this.value_):e+=this.value_,this.lazyHash_=Aa(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===rt.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof rt.__childrenNodeConstructor?-1:(ee(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,i=typeof this.value_,s=rt.VALUE_TYPE_ORDER.indexOf(t),o=rt.VALUE_TYPE_ORDER.indexOf(i);return ee(s>=0,"Unknown leaf type: "+t),ee(o>=0,"Unknown leaf type: "+i),s===o?i==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}else return!1}}rt.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let lc,ac;function hh(n){lc=n}function _h(n){ac=n}class ph extends is{compare(e,t){const i=e.node.getPriority(),s=t.node.getPriority(),o=i.compareTo(s);return o===0?Vn(e.name,t.name):o}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return we.MIN}maxPost(){return new we(sn,new rt("[PRIORITY-POST]",ac))}makePost(e,t){const i=lc(e);return new we(t,new rt("[PRIORITY-POST]",i))}toString(){return".priority"}}const xe=new ph;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mh=Math.log(2);class gh{constructor(e){const t=o=>parseInt(Math.log(o)/mh,10),i=o=>parseInt(Array(o+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;const s=i(this.count);this.bits_=e+1&s}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const Hi=function(n,e,t,i){n.sort(e);const s=function(a,c){const u=c-a;let d,f;if(u===0)return null;if(u===1)return d=n[a],f=t?t(d):d,new lt(f,d.node,lt.BLACK,null,null);{const _=parseInt(u/2,10)+a,h=s(a,_),b=s(_+1,c);return d=n[_],f=t?t(d):d,new lt(f,d.node,lt.BLACK,h,b)}},o=function(a){let c=null,u=null,d=n.length;const f=function(h,b){const v=d-h,w=d;d-=h;const k=s(v+1,w),y=n[v],I=t?t(y):y;_(new lt(I,y.node,b,null,k))},_=function(h){c?(c.left=h,c=h):(u=h,c=h)};for(let h=0;h<a.count;++h){const b=a.nextBitIsOne(),v=Math.pow(2,a.count-(h+1));b?f(v,lt.BLACK):(f(v,lt.BLACK),f(v,lt.RED))}return u},r=new gh(n.length),l=o(r);return new kt(i||e,l)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ns;const In={};class Ut{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return ee(In&&xe,"ChildrenNode.ts has not been loaded"),Ns=Ns||new Ut({".priority":In},{".priority":xe}),Ns}get(e){const t=Bn(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof kt?t:null}hasIndex(e){return Ht(this.indexSet_,e.toString())}addIndex(e,t){ee(e!==xt,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const i=[];let s=!1;const o=t.getIterator(we.Wrap);let r=o.getNext();for(;r;)s=s||e.isDefinedOn(r.node),i.push(r),r=o.getNext();let l;s?l=Hi(i,e.getCompare()):l=In;const a=e.toString(),c=Object.assign({},this.indexSet_);c[a]=e;const u=Object.assign({},this.indexes_);return u[a]=l,new Ut(u,c)}addToIndexes(e,t){const i=Bi(this.indexes_,(s,o)=>{const r=Bn(this.indexSet_,o);if(ee(r,"Missing index implementation for "+o),s===In)if(r.isDefinedOn(e.node)){const l=[],a=t.getIterator(we.Wrap);let c=a.getNext();for(;c;)c.name!==e.name&&l.push(c),c=a.getNext();return l.push(e),Hi(l,r.getCompare())}else return In;else{const l=t.get(e.name);let a=s;return l&&(a=a.remove(new we(e.name,l))),a.insert(e,e.node)}});return new Ut(i,this.indexSet_)}removeFromIndexes(e,t){const i=Bi(this.indexes_,s=>{if(s===In)return s;{const o=t.get(e.name);return o?s.remove(new we(e.name,o)):s}});return new Ut(i,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let $n;class _e{constructor(e,t,i){this.children_=e,this.priorityNode_=t,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&rc(this.priorityNode_),this.children_.isEmpty()&&ee(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return $n||($n=new _e(new kt(bo),null,Ut.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||$n}updatePriority(e){return this.children_.isEmpty()?this:new _e(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const t=this.children_.get(e);return t===null?$n:t}}getChild(e){const t=Ie(e);return t===null?this:this.getImmediateChild(t).getChild(Ye(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,t){if(ee(t,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(t);{const i=new we(e,t);let s,o;t.isEmpty()?(s=this.children_.remove(e),o=this.indexMap_.removeFromIndexes(i,this.children_)):(s=this.children_.insert(e,t),o=this.indexMap_.addToIndexes(i,this.children_));const r=s.isEmpty()?$n:this.priorityNode_;return new _e(s,r,o)}}updateChild(e,t){const i=Ie(e);if(i===null)return t;{ee(Ie(e)!==".priority"||on(e)===1,".priority must be the last token in a path");const s=this.getImmediateChild(i).updateChild(Ye(e),t);return this.updateImmediateChild(i,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let i=0,s=0,o=!0;if(this.forEachChild(xe,(r,l)=>{t[r]=l.val(e),i++,o&&_e.INTEGER_REGEXP_.test(r)?s=Math.max(s,Number(r)):o=!1}),!e&&o&&s<2*i){const r=[];for(const l in t)r[l]=t[l];return r}else return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+oc(this.getPriority().val())+":"),this.forEachChild(xe,(t,i)=>{const s=i.hash();s!==""&&(e+=":"+t+":"+s)}),this.lazyHash_=e===""?"":Aa(e)}return this.lazyHash_}getPredecessorChildName(e,t,i){const s=this.resolveIndex_(i);if(s){const o=s.getPredecessorKey(new we(e,t));return o?o.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const i=t.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new we(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const i=t.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new we(t,this.children_.get(t)):null}forEachChild(e,t){const i=this.resolveIndex_(e);return i?i.inorderTraversal(s=>t(s.name,s.node)):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const i=this.resolveIndex_(t);if(i)return i.getIteratorFrom(e,s=>s);{const s=this.children_.getIteratorFrom(e.name,we.Wrap);let o=s.peek();for(;o!=null&&t.compare(o,e)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const i=this.resolveIndex_(t);if(i)return i.getReverseIteratorFrom(e,s=>s);{const s=this.children_.getReverseIteratorFrom(e.name,we.Wrap);let o=s.peek();for(;o!=null&&t.compare(o,e)>0;)s.getNext(),o=s.peek();return s}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===ki?-1:0}withIndex(e){if(e===xt||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new _e(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===xt||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority()))if(this.children_.count()===t.children_.count()){const i=this.getIterator(xe),s=t.getIterator(xe);let o=i.getNext(),r=s.getNext();for(;o&&r;){if(o.name!==r.name||!o.node.equals(r.node))return!1;o=i.getNext(),r=s.getNext()}return o===null&&r===null}else return!1;else return!1}}resolveIndex_(e){return e===xt?null:this.indexMap_.get(e.toString())}}_e.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class bh extends _e{constructor(){super(new kt(bo),_e.EMPTY_NODE,Ut.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return _e.EMPTY_NODE}isEmpty(){return!1}}const ki=new bh;Object.defineProperties(we,{MIN:{value:new we(vn,_e.EMPTY_NODE)},MAX:{value:new we(sn,ki)}});sc.__EMPTY_NODE=_e.EMPTY_NODE;rt.__childrenNodeConstructor=_e;fh(ki);_h(ki);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vh=!0;function at(n,e=null){if(n===null)return _e.EMPTY_NODE;if(typeof n=="object"&&".priority"in n&&(e=n[".priority"]),ee(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof n=="object"&&".value"in n&&n[".value"]!==null&&(n=n[".value"]),typeof n!="object"||".sv"in n){const t=n;return new rt(t,at(e))}if(!(n instanceof Array)&&vh){const t=[];let i=!1;if(Et(n,(r,l)=>{if(r.substring(0,1)!=="."){const a=at(l);a.isEmpty()||(i=i||!a.getPriority().isEmpty(),t.push(new we(r,a)))}}),t.length===0)return _e.EMPTY_NODE;const o=Hi(t,dh,r=>r.name,bo);if(i){const r=Hi(t,xe.getCompare());return new _e(o,at(e),new Ut({".priority":r},{".priority":xe}))}else return new _e(o,at(e),Ut.Default)}else{let t=_e.EMPTY_NODE;return Et(n,(i,s)=>{if(Ht(n,i)&&i.substring(0,1)!=="."){const o=at(s);(o.isLeafNode()||!o.isEmpty())&&(t=t.updateImmediateChild(i,o))}}),t.updatePriority(at(e))}}hh(at);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cc extends is{constructor(e){super(),this.indexPath_=e,ee(!Ce(e)&&Ie(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const i=this.extractChild(e.node),s=this.extractChild(t.node),o=i.compareTo(s);return o===0?Vn(e.name,t.name):o}makePost(e,t){const i=at(e),s=_e.EMPTY_NODE.updateChild(this.indexPath_,i);return new we(t,s)}maxPost(){const e=_e.EMPTY_NODE.updateChild(this.indexPath_,ki);return new we(sn,e)}toString(){return ec(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yh extends is{compare(e,t){const i=e.node.compareTo(t.node);return i===0?Vn(e.name,t.name):i}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return we.MIN}maxPost(){return we.MAX}makePost(e,t){const i=at(e);return new we(t,i)}toString(){return".value"}}const uc=new yh;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dc(n){return{type:"value",snapshotNode:n}}function qn(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function di(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function fi(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}function wh(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vo{constructor(e){this.index_=e}updateChild(e,t,i,s,o,r){ee(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const l=e.getImmediateChild(t);return l.getChild(s).equals(i.getChild(s))&&l.isEmpty()===i.isEmpty()||(r!=null&&(i.isEmpty()?e.hasChild(t)?r.trackChildChange(di(t,l)):ee(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):l.isEmpty()?r.trackChildChange(qn(t,i)):r.trackChildChange(fi(t,i,l))),e.isLeafNode()&&i.isEmpty())?e:e.updateImmediateChild(t,i).withIndex(this.index_)}updateFullNode(e,t,i){return i!=null&&(e.isLeafNode()||e.forEachChild(xe,(s,o)=>{t.hasChild(s)||i.trackChildChange(di(s,o))}),t.isLeafNode()||t.forEachChild(xe,(s,o)=>{if(e.hasChild(s)){const r=e.getImmediateChild(s);r.equals(o)||i.trackChildChange(fi(s,o,r))}else i.trackChildChange(qn(s,o))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?_e.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hi{constructor(e){this.indexedFilter_=new vo(e.getIndex()),this.index_=e.getIndex(),this.startPost_=hi.getStartPost_(e),this.endPost_=hi.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,i=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&i}updateChild(e,t,i,s,o,r){return this.matches(new we(t,i))||(i=_e.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,i,s,o,r)}updateFullNode(e,t,i){t.isLeafNode()&&(t=_e.EMPTY_NODE);let s=t.withIndex(this.index_);s=s.updatePriority(_e.EMPTY_NODE);const o=this;return t.forEachChild(xe,(r,l)=>{o.matches(new we(r,l))||(s=s.updateImmediateChild(r,_e.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,s,i)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kh{constructor(e){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{const i=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?i<=0:i<0},this.withinEndPost=t=>{const i=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?i<=0:i<0},this.rangedFilter_=new hi(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,i,s,o,r){return this.rangedFilter_.matches(new we(t,i))||(i=_e.EMPTY_NODE),e.getImmediateChild(t).equals(i)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,i,s,o,r):this.fullLimitUpdateChild_(e,t,i,o,r)}updateFullNode(e,t,i){let s;if(t.isLeafNode()||t.isEmpty())s=_e.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<t.numChildren()&&t.isIndexed(this.index_)){s=_e.EMPTY_NODE.withIndex(this.index_);let o;this.reverse_?o=t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):o=t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let r=0;for(;o.hasNext()&&r<this.limit_;){const l=o.getNext();if(this.withinDirectionalStart(l))if(this.withinDirectionalEnd(l))s=s.updateImmediateChild(l.name,l.node),r++;else break;else continue}}else{s=t.withIndex(this.index_),s=s.updatePriority(_e.EMPTY_NODE);let o;this.reverse_?o=s.getReverseIterator(this.index_):o=s.getIterator(this.index_);let r=0;for(;o.hasNext();){const l=o.getNext();r<this.limit_&&this.withinDirectionalStart(l)&&this.withinDirectionalEnd(l)?r++:s=s.updateImmediateChild(l.name,_e.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,s,i)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,i,s,o){let r;if(this.reverse_){const d=this.index_.getCompare();r=(f,_)=>d(_,f)}else r=this.index_.getCompare();const l=e;ee(l.numChildren()===this.limit_,"");const a=new we(t,i),c=this.reverse_?l.getFirstChild(this.index_):l.getLastChild(this.index_),u=this.rangedFilter_.matches(a);if(l.hasChild(t)){const d=l.getImmediateChild(t);let f=s.getChildAfterChild(this.index_,c,this.reverse_);for(;f!=null&&(f.name===t||l.hasChild(f.name));)f=s.getChildAfterChild(this.index_,f,this.reverse_);const _=f==null?1:r(f,a);if(u&&!i.isEmpty()&&_>=0)return o!=null&&o.trackChildChange(fi(t,i,d)),l.updateImmediateChild(t,i);{o!=null&&o.trackChildChange(di(t,d));const b=l.updateImmediateChild(t,_e.EMPTY_NODE);return f!=null&&this.rangedFilter_.matches(f)?(o!=null&&o.trackChildChange(qn(f.name,f.node)),b.updateImmediateChild(f.name,f.node)):b}}else return i.isEmpty()?e:u&&r(c,a)>=0?(o!=null&&(o.trackChildChange(di(c.name,c.node)),o.trackChildChange(qn(t,i))),l.updateImmediateChild(t,i).updateImmediateChild(c.name,_e.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yo{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=xe}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return ee(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return ee(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:vn}hasEnd(){return this.endSet_}getIndexEndValue(){return ee(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return ee(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:sn}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return ee(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===xe}copy(){const e=new yo;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function Ch(n){return n.loadsAllData()?new vo(n.getIndex()):n.hasLimit()?new kh(n):new hi(n)}function Eh(n,e){const t=n.copy();return t.index_=e,t}function wr(n){const e={};if(n.isDefault())return e;let t;if(n.index_===xe?t="$priority":n.index_===uc?t="$value":n.index_===xt?t="$key":(ee(n.index_ instanceof cc,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=it(t),n.startSet_){const i=n.startAfterSet_?"startAfter":"startAt";e[i]=it(n.indexStartValue_),n.startNameSet_&&(e[i]+=","+it(n.indexStartName_))}if(n.endSet_){const i=n.endBeforeSet_?"endBefore":"endAt";e[i]=it(n.indexEndValue_),n.endNameSet_&&(e[i]+=","+it(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function kr(n){const e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;t===""&&(n.isViewFromLeft()?t="l":t="r"),e.vf=t}return n.index_!==xe&&(e.i=n.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ui extends Za{constructor(e,t,i,s){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=i,this.appCheckTokenProvider_=s,this.log_=wi("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:(ee(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,i,s){const o=e._path.toString();this.log_("Listen called for "+o+" "+e._queryIdentifier);const r=Ui.getListenId_(e,i),l={};this.listens_[r]=l;const a=wr(e._queryParams);this.restRequest_(o+".json",a,(c,u)=>{let d=u;if(c===404&&(d=null,c=null),c===null&&this.onDataUpdate_(o,d,!1,i),Bn(this.listens_,r)===l){let f;c?c===401?f="permission_denied":f="rest_error:"+c:f="ok",s(f,null)}})}unlisten(e,t){const i=Ui.getListenId_(e,t);delete this.listens_[i]}get(e){const t=wr(e._queryParams),i=e._path.toString(),s=new ts;return this.restRequest_(i+".json",t,(o,r)=>{let l=r;o===404&&(l=null,o=null),o===null?(this.onDataUpdate_(i,l,!1,null),s.resolve(l)):s.reject(new Error(l))}),s.promise}refreshAuthToken(e){}restRequest_(e,t={},i){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([s,o])=>{s&&s.accessToken&&(t.auth=s.accessToken),o&&o.token&&(t.ac=o.token);const r=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+ed(t);this.log_("Sending REST request for "+r);const l=new XMLHttpRequest;l.onreadystatechange=()=>{if(i&&l.readyState===4){this.log_("REST Response for "+r+" received. status:",l.status,"response:",l.responseText);let a=null;if(l.status>=200&&l.status<300){try{a=li(l.responseText)}catch{Ct("Failed to parse JSON response for "+r+": "+l.responseText)}i(null,a)}else l.status!==401&&l.status!==404&&Ct("Got unsuccessful REST response for "+r+" Status: "+l.status),i(l.status);i=null}},l.open("GET",r,!0),l.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sh{constructor(){this.rootNode_=_e.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gi(){return{value:null,children:new Map}}function fc(n,e,t){if(Ce(e))n.value=t,n.children.clear();else if(n.value!==null)n.value=n.value.updateChild(e,t);else{const i=Ie(e);n.children.has(i)||n.children.set(i,Gi());const s=n.children.get(i);e=Ye(e),fc(s,e,t)}}function Vs(n,e,t){n.value!==null?t(e,n.value):Ih(n,(i,s)=>{const o=new Ge(e.toString()+"/"+i);Vs(s,o,t)})}function Ih(n,e){n.children.forEach((t,i)=>{e(i,t)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Th{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&Et(this.last_,(i,s)=>{t[i]=t[i]-s}),this.last_=e,t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cr=10*1e3,Nh=30*1e3,Oh=5*60*1e3;class Dh{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new Th(e);const i=Cr+(Nh-Cr)*Math.random();ni(this.reportStats_.bind(this),Math.floor(i))}reportStats_(){const e=this.statsListener_.get(),t={};let i=!1;Et(e,(s,o)=>{o>0&&Ht(this.statsToReport_,s)&&(t[s]=o,i=!0)}),i&&this.server_.reportStats(t),ni(this.reportStats_.bind(this),Math.floor(Math.random()*2*Oh))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Rt;(function(n){n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(Rt||(Rt={}));function hc(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function wo(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function ko(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vi{constructor(e,t,i){this.path=e,this.affectedTree=t,this.revert=i,this.type=Rt.ACK_USER_WRITE,this.source=hc()}operationForChild(e){if(Ce(this.path)){if(this.affectedTree.value!=null)return ee(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new Ge(e));return new Vi(Be(),t,this.revert)}}else return ee(Ie(this.path)===e,"operationForChild called for unrelated child."),new Vi(Ye(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _i{constructor(e,t){this.source=e,this.path=t,this.type=Rt.LISTEN_COMPLETE}operationForChild(e){return Ce(this.path)?new _i(this.source,Be()):new _i(this.source,Ye(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yn{constructor(e,t,i){this.source=e,this.path=t,this.snap=i,this.type=Rt.OVERWRITE}operationForChild(e){return Ce(this.path)?new yn(this.source,Be(),this.snap.getImmediateChild(e)):new yn(this.source,Ye(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pi{constructor(e,t,i){this.source=e,this.path=t,this.children=i,this.type=Rt.MERGE}operationForChild(e){if(Ce(this.path)){const t=this.children.subtree(new Ge(e));return t.isEmpty()?null:t.value?new yn(this.source,Be(),t.value):new pi(this.source,Be(),t)}else return ee(Ie(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new pi(this.source,Ye(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rn{constructor(e,t,i){this.node_=e,this.fullyInitialized_=t,this.filtered_=i}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(Ce(e))return this.isFullyInitialized()&&!this.filtered_;const t=Ie(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rh{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function Ah(n,e,t,i){const s=[],o=[];return e.forEach(r=>{r.type==="child_changed"&&n.index_.indexedValueChanged(r.oldSnap,r.snapshotNode)&&o.push(wh(r.childName,r.snapshotNode))}),ei(n,s,"child_removed",e,i,t),ei(n,s,"child_added",e,i,t),ei(n,s,"child_moved",o,i,t),ei(n,s,"child_changed",e,i,t),ei(n,s,"value",e,i,t),s}function ei(n,e,t,i,s,o){const r=i.filter(l=>l.type===t);r.sort((l,a)=>Mh(n,l,a)),r.forEach(l=>{const a=Ph(n,l,o);s.forEach(c=>{c.respondsTo(l.type)&&e.push(c.createEvent(a,n.query_))})})}function Ph(n,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}function Mh(n,e,t){if(e.childName==null||t.childName==null)throw Gn("Should only compare child_ events.");const i=new we(e.childName,e.snapshotNode),s=new we(t.childName,t.snapshotNode);return n.index_.compare(i,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ss(n,e){return{eventCache:n,serverCache:e}}function ii(n,e,t,i){return ss(new rn(e,t,i),n.serverCache)}function _c(n,e,t,i){return ss(n.eventCache,new rn(e,t,i))}function Ki(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function wn(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Os;const Lh=()=>(Os||(Os=new kt(wf)),Os);class Xe{constructor(e,t=Lh()){this.value=e,this.children=t}static fromObject(e){let t=new Xe(null);return Et(e,(i,s)=>{t=t.set(new Ge(i),s)}),t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:Be(),value:this.value};if(Ce(e))return null;{const i=Ie(e),s=this.children.get(i);if(s!==null){const o=s.findRootMostMatchingPathAndValue(Ye(e),t);return o!=null?{path:st(new Ge(i),o.path),value:o.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(Ce(e))return this;{const t=Ie(e),i=this.children.get(t);return i!==null?i.subtree(Ye(e)):new Xe(null)}}set(e,t){if(Ce(e))return new Xe(t,this.children);{const i=Ie(e),o=(this.children.get(i)||new Xe(null)).set(Ye(e),t),r=this.children.insert(i,o);return new Xe(this.value,r)}}remove(e){if(Ce(e))return this.children.isEmpty()?new Xe(null):new Xe(null,this.children);{const t=Ie(e),i=this.children.get(t);if(i){const s=i.remove(Ye(e));let o;return s.isEmpty()?o=this.children.remove(t):o=this.children.insert(t,s),this.value===null&&o.isEmpty()?new Xe(null):new Xe(this.value,o)}else return this}}get(e){if(Ce(e))return this.value;{const t=Ie(e),i=this.children.get(t);return i?i.get(Ye(e)):null}}setTree(e,t){if(Ce(e))return t;{const i=Ie(e),o=(this.children.get(i)||new Xe(null)).setTree(Ye(e),t);let r;return o.isEmpty()?r=this.children.remove(i):r=this.children.insert(i,o),new Xe(this.value,r)}}fold(e){return this.fold_(Be(),e)}fold_(e,t){const i={};return this.children.inorderTraversal((s,o)=>{i[s]=o.fold_(st(e,s),t)}),t(e,this.value,i)}findOnPath(e,t){return this.findOnPath_(e,Be(),t)}findOnPath_(e,t,i){const s=this.value?i(t,this.value):!1;if(s)return s;if(Ce(e))return null;{const o=Ie(e),r=this.children.get(o);return r?r.findOnPath_(Ye(e),st(t,o),i):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,Be(),t)}foreachOnPath_(e,t,i){if(Ce(e))return this;{this.value&&i(t,this.value);const s=Ie(e),o=this.children.get(s);return o?o.foreachOnPath_(Ye(e),st(t,s),i):new Xe(null)}}foreach(e){this.foreach_(Be(),e)}foreach_(e,t){this.children.inorderTraversal((i,s)=>{s.foreach_(st(e,i),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,i)=>{i.value&&e(t,i.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class At{constructor(e){this.writeTree_=e}static empty(){return new At(new Xe(null))}}function si(n,e,t){if(Ce(e))return new At(new Xe(t));{const i=n.writeTree_.findRootMostValueAndPath(e);if(i!=null){const s=i.path;let o=i.value;const r=bt(s,e);return o=o.updateChild(r,t),new At(n.writeTree_.set(s,o))}else{const s=new Xe(t),o=n.writeTree_.setTree(e,s);return new At(o)}}}function Er(n,e,t){let i=n;return Et(t,(s,o)=>{i=si(i,st(e,s),o)}),i}function Sr(n,e){if(Ce(e))return At.empty();{const t=n.writeTree_.setTree(e,new Xe(null));return new At(t)}}function Ks(n,e){return Cn(n,e)!=null}function Cn(n,e){const t=n.writeTree_.findRootMostValueAndPath(e);return t!=null?n.writeTree_.get(t.path).getChild(bt(t.path,e)):null}function Ir(n){const e=[],t=n.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(xe,(i,s)=>{e.push(new we(i,s))}):n.writeTree_.children.inorderTraversal((i,s)=>{s.value!=null&&e.push(new we(i,s.value))}),e}function $t(n,e){if(Ce(e))return n;{const t=Cn(n,e);return t!=null?new At(new Xe(t)):new At(n.writeTree_.subtree(e))}}function Ys(n){return n.writeTree_.isEmpty()}function zn(n,e){return pc(Be(),n.writeTree_,e)}function pc(n,e,t){if(e.value!=null)return t.updateChild(n,e.value);{let i=null;return e.children.inorderTraversal((s,o)=>{s===".priority"?(ee(o.value!==null,"Priority writes must always be leaf nodes"),i=o.value):t=pc(st(n,s),o,t)}),!t.getChild(n).isEmpty()&&i!==null&&(t=t.updateChild(st(n,".priority"),i)),t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function os(n,e){return vc(e,n)}function Fh(n,e,t,i,s){ee(i>n.lastWriteId,"Stacking an older write on top of newer ones"),s===void 0&&(s=!0),n.allWrites.push({path:e,snap:t,writeId:i,visible:s}),s&&(n.visibleWrites=si(n.visibleWrites,e,t)),n.lastWriteId=i}function Bh(n,e){for(let t=0;t<n.allWrites.length;t++){const i=n.allWrites[t];if(i.writeId===e)return i}return null}function qh(n,e){const t=n.allWrites.findIndex(l=>l.writeId===e);ee(t>=0,"removeWrite called with nonexistent writeId.");const i=n.allWrites[t];n.allWrites.splice(t,1);let s=i.visible,o=!1,r=n.allWrites.length-1;for(;s&&r>=0;){const l=n.allWrites[r];l.visible&&(r>=t&&zh(l,i.path)?s=!1:Dt(i.path,l.path)&&(o=!0)),r--}if(s){if(o)return jh(n),!0;if(i.snap)n.visibleWrites=Sr(n.visibleWrites,i.path);else{const l=i.children;Et(l,a=>{n.visibleWrites=Sr(n.visibleWrites,st(i.path,a))})}return!0}else return!1}function zh(n,e){if(n.snap)return Dt(n.path,e);for(const t in n.children)if(n.children.hasOwnProperty(t)&&Dt(st(n.path,t),e))return!0;return!1}function jh(n){n.visibleWrites=mc(n.allWrites,Wh,Be()),n.allWrites.length>0?n.lastWriteId=n.allWrites[n.allWrites.length-1].writeId:n.lastWriteId=-1}function Wh(n){return n.visible}function mc(n,e,t){let i=At.empty();for(let s=0;s<n.length;++s){const o=n[s];if(e(o)){const r=o.path;let l;if(o.snap)Dt(t,r)?(l=bt(t,r),i=si(i,l,o.snap)):Dt(r,t)&&(l=bt(r,t),i=si(i,Be(),o.snap.getChild(l)));else if(o.children){if(Dt(t,r))l=bt(t,r),i=Er(i,l,o.children);else if(Dt(r,t))if(l=bt(r,t),Ce(l))i=Er(i,Be(),o.children);else{const a=Bn(o.children,Ie(l));if(a){const c=a.getChild(Ye(l));i=si(i,Be(),c)}}}else throw Gn("WriteRecord should have .snap or .children")}}return i}function gc(n,e,t,i,s){if(!i&&!s){const o=Cn(n.visibleWrites,e);if(o!=null)return o;{const r=$t(n.visibleWrites,e);if(Ys(r))return t;if(t==null&&!Ks(r,Be()))return null;{const l=t||_e.EMPTY_NODE;return zn(r,l)}}}else{const o=$t(n.visibleWrites,e);if(!s&&Ys(o))return t;if(!s&&t==null&&!Ks(o,Be()))return null;{const r=function(c){return(c.visible||s)&&(!i||!~i.indexOf(c.writeId))&&(Dt(c.path,e)||Dt(e,c.path))},l=mc(n.allWrites,r,e),a=t||_e.EMPTY_NODE;return zn(l,a)}}}function Hh(n,e,t){let i=_e.EMPTY_NODE;const s=Cn(n.visibleWrites,e);if(s)return s.isLeafNode()||s.forEachChild(xe,(o,r)=>{i=i.updateImmediateChild(o,r)}),i;if(t){const o=$t(n.visibleWrites,e);return t.forEachChild(xe,(r,l)=>{const a=zn($t(o,new Ge(r)),l);i=i.updateImmediateChild(r,a)}),Ir(o).forEach(r=>{i=i.updateImmediateChild(r.name,r.node)}),i}else{const o=$t(n.visibleWrites,e);return Ir(o).forEach(r=>{i=i.updateImmediateChild(r.name,r.node)}),i}}function Uh(n,e,t,i,s){ee(i||s,"Either existingEventSnap or existingServerSnap must exist");const o=st(e,t);if(Ks(n.visibleWrites,o))return null;{const r=$t(n.visibleWrites,o);return Ys(r)?s.getChild(t):zn(r,s.getChild(t))}}function Gh(n,e,t,i){const s=st(e,t),o=Cn(n.visibleWrites,s);if(o!=null)return o;if(i.isCompleteForChild(t)){const r=$t(n.visibleWrites,s);return zn(r,i.getNode().getImmediateChild(t))}else return null}function Vh(n,e){return Cn(n.visibleWrites,e)}function Kh(n,e,t,i,s,o,r){let l;const a=$t(n.visibleWrites,e),c=Cn(a,Be());if(c!=null)l=c;else if(t!=null)l=zn(a,t);else return[];if(l=l.withIndex(r),!l.isEmpty()&&!l.isLeafNode()){const u=[],d=r.getCompare(),f=o?l.getReverseIteratorFrom(i,r):l.getIteratorFrom(i,r);let _=f.getNext();for(;_&&u.length<s;)d(_,i)!==0&&u.push(_),_=f.getNext();return u}else return[]}function Yh(){return{visibleWrites:At.empty(),allWrites:[],lastWriteId:-1}}function Yi(n,e,t,i){return gc(n.writeTree,n.treePath,e,t,i)}function Co(n,e){return Hh(n.writeTree,n.treePath,e)}function Tr(n,e,t,i){return Uh(n.writeTree,n.treePath,e,t,i)}function Qi(n,e){return Vh(n.writeTree,st(n.treePath,e))}function Qh(n,e,t,i,s,o){return Kh(n.writeTree,n.treePath,e,t,i,s,o)}function Eo(n,e,t){return Gh(n.writeTree,n.treePath,e,t)}function bc(n,e){return vc(st(n.treePath,e),n.writeTree)}function vc(n,e){return{treePath:n,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xh{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,i=e.childName;ee(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),ee(i!==".priority","Only non-priority child changes can be tracked.");const s=this.changeMap.get(i);if(s){const o=s.type;if(t==="child_added"&&o==="child_removed")this.changeMap.set(i,fi(i,e.snapshotNode,s.snapshotNode));else if(t==="child_removed"&&o==="child_added")this.changeMap.delete(i);else if(t==="child_removed"&&o==="child_changed")this.changeMap.set(i,di(i,s.oldSnap));else if(t==="child_changed"&&o==="child_added")this.changeMap.set(i,qn(i,e.snapshotNode));else if(t==="child_changed"&&o==="child_changed")this.changeMap.set(i,fi(i,e.snapshotNode,s.oldSnap));else throw Gn("Illegal combination of changes: "+e+" occurred after "+s)}else this.changeMap.set(i,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jh{getCompleteChild(e){return null}getChildAfterChild(e,t,i){return null}}const yc=new Jh;class So{constructor(e,t,i=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=i}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const i=this.optCompleteServerCache_!=null?new rn(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Eo(this.writes_,e,i)}}getChildAfterChild(e,t,i){const s=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:wn(this.viewCache_),o=Qh(this.writes_,s,t,1,i,e);return o.length===0?null:o[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zh(n){return{filter:n}}function xh(n,e){ee(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),ee(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}function $h(n,e,t,i,s){const o=new Xh;let r,l;if(t.type===Rt.OVERWRITE){const c=t;c.source.fromUser?r=Qs(n,e,c.path,c.snap,i,s,o):(ee(c.source.fromServer,"Unknown source."),l=c.source.tagged||e.serverCache.isFiltered()&&!Ce(c.path),r=Xi(n,e,c.path,c.snap,i,s,l,o))}else if(t.type===Rt.MERGE){const c=t;c.source.fromUser?r=t_(n,e,c.path,c.children,i,s,o):(ee(c.source.fromServer,"Unknown source."),l=c.source.tagged||e.serverCache.isFiltered(),r=Xs(n,e,c.path,c.children,i,s,l,o))}else if(t.type===Rt.ACK_USER_WRITE){const c=t;c.revert?r=s_(n,e,c.path,i,s,o):r=n_(n,e,c.path,c.affectedTree,i,s,o)}else if(t.type===Rt.LISTEN_COMPLETE)r=i_(n,e,t.path,i,o);else throw Gn("Unknown operation type: "+t.type);const a=o.getChanges();return e_(e,r,a),{viewCache:r,changes:a}}function e_(n,e,t){const i=e.eventCache;if(i.isFullyInitialized()){const s=i.getNode().isLeafNode()||i.getNode().isEmpty(),o=Ki(n);(t.length>0||!n.eventCache.isFullyInitialized()||s&&!i.getNode().equals(o)||!i.getNode().getPriority().equals(o.getPriority()))&&t.push(dc(Ki(e)))}}function wc(n,e,t,i,s,o){const r=e.eventCache;if(Qi(i,t)!=null)return e;{let l,a;if(Ce(t))if(ee(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const c=wn(e),u=c instanceof _e?c:_e.EMPTY_NODE,d=Co(i,u);l=n.filter.updateFullNode(e.eventCache.getNode(),d,o)}else{const c=Yi(i,wn(e));l=n.filter.updateFullNode(e.eventCache.getNode(),c,o)}else{const c=Ie(t);if(c===".priority"){ee(on(t)===1,"Can't have a priority with additional path components");const u=r.getNode();a=e.serverCache.getNode();const d=Tr(i,t,u,a);d!=null?l=n.filter.updatePriority(u,d):l=r.getNode()}else{const u=Ye(t);let d;if(r.isCompleteForChild(c)){a=e.serverCache.getNode();const f=Tr(i,t,r.getNode(),a);f!=null?d=r.getNode().getImmediateChild(c).updateChild(u,f):d=r.getNode().getImmediateChild(c)}else d=Eo(i,c,e.serverCache);d!=null?l=n.filter.updateChild(r.getNode(),c,d,u,s,o):l=r.getNode()}}return ii(e,l,r.isFullyInitialized()||Ce(t),n.filter.filtersNodes())}}function Xi(n,e,t,i,s,o,r,l){const a=e.serverCache;let c;const u=r?n.filter:n.filter.getIndexedFilter();if(Ce(t))c=u.updateFullNode(a.getNode(),i,null);else if(u.filtersNodes()&&!a.isFiltered()){const _=a.getNode().updateChild(t,i);c=u.updateFullNode(a.getNode(),_,null)}else{const _=Ie(t);if(!a.isCompleteForPath(t)&&on(t)>1)return e;const h=Ye(t),v=a.getNode().getImmediateChild(_).updateChild(h,i);_===".priority"?c=u.updatePriority(a.getNode(),v):c=u.updateChild(a.getNode(),_,v,h,yc,null)}const d=_c(e,c,a.isFullyInitialized()||Ce(t),u.filtersNodes()),f=new So(s,d,o);return wc(n,d,t,s,f,l)}function Qs(n,e,t,i,s,o,r){const l=e.eventCache;let a,c;const u=new So(s,e,o);if(Ce(t))c=n.filter.updateFullNode(e.eventCache.getNode(),i,r),a=ii(e,c,!0,n.filter.filtersNodes());else{const d=Ie(t);if(d===".priority")c=n.filter.updatePriority(e.eventCache.getNode(),i),a=ii(e,c,l.isFullyInitialized(),l.isFiltered());else{const f=Ye(t),_=l.getNode().getImmediateChild(d);let h;if(Ce(f))h=i;else{const b=u.getCompleteChild(d);b!=null?$a(f)===".priority"&&b.getChild(tc(f)).isEmpty()?h=b:h=b.updateChild(f,i):h=_e.EMPTY_NODE}if(_.equals(h))a=e;else{const b=n.filter.updateChild(l.getNode(),d,h,f,u,r);a=ii(e,b,l.isFullyInitialized(),n.filter.filtersNodes())}}}return a}function Nr(n,e){return n.eventCache.isCompleteForChild(e)}function t_(n,e,t,i,s,o,r){let l=e;return i.foreach((a,c)=>{const u=st(t,a);Nr(e,Ie(u))&&(l=Qs(n,l,u,c,s,o,r))}),i.foreach((a,c)=>{const u=st(t,a);Nr(e,Ie(u))||(l=Qs(n,l,u,c,s,o,r))}),l}function Or(n,e,t){return t.foreach((i,s)=>{e=e.updateChild(i,s)}),e}function Xs(n,e,t,i,s,o,r,l){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let a=e,c;Ce(t)?c=i:c=new Xe(null).setTree(t,i);const u=e.serverCache.getNode();return c.children.inorderTraversal((d,f)=>{if(u.hasChild(d)){const _=e.serverCache.getNode().getImmediateChild(d),h=Or(n,_,f);a=Xi(n,a,new Ge(d),h,s,o,r,l)}}),c.children.inorderTraversal((d,f)=>{const _=!e.serverCache.isCompleteForChild(d)&&f.value===null;if(!u.hasChild(d)&&!_){const h=e.serverCache.getNode().getImmediateChild(d),b=Or(n,h,f);a=Xi(n,a,new Ge(d),b,s,o,r,l)}}),a}function n_(n,e,t,i,s,o,r){if(Qi(s,t)!=null)return e;const l=e.serverCache.isFiltered(),a=e.serverCache;if(i.value!=null){if(Ce(t)&&a.isFullyInitialized()||a.isCompleteForPath(t))return Xi(n,e,t,a.getNode().getChild(t),s,o,l,r);if(Ce(t)){let c=new Xe(null);return a.getNode().forEachChild(xt,(u,d)=>{c=c.set(new Ge(u),d)}),Xs(n,e,t,c,s,o,l,r)}else return e}else{let c=new Xe(null);return i.foreach((u,d)=>{const f=st(t,u);a.isCompleteForPath(f)&&(c=c.set(u,a.getNode().getChild(f)))}),Xs(n,e,t,c,s,o,l,r)}}function i_(n,e,t,i,s){const o=e.serverCache,r=_c(e,o.getNode(),o.isFullyInitialized()||Ce(t),o.isFiltered());return wc(n,r,t,i,yc,s)}function s_(n,e,t,i,s,o){let r;if(Qi(i,t)!=null)return e;{const l=new So(i,e,s),a=e.eventCache.getNode();let c;if(Ce(t)||Ie(t)===".priority"){let u;if(e.serverCache.isFullyInitialized())u=Yi(i,wn(e));else{const d=e.serverCache.getNode();ee(d instanceof _e,"serverChildren would be complete if leaf node"),u=Co(i,d)}u=u,c=n.filter.updateFullNode(a,u,o)}else{const u=Ie(t);let d=Eo(i,u,e.serverCache);d==null&&e.serverCache.isCompleteForChild(u)&&(d=a.getImmediateChild(u)),d!=null?c=n.filter.updateChild(a,u,d,Ye(t),l,o):e.eventCache.getNode().hasChild(u)?c=n.filter.updateChild(a,u,_e.EMPTY_NODE,Ye(t),l,o):c=a,c.isEmpty()&&e.serverCache.isFullyInitialized()&&(r=Yi(i,wn(e)),r.isLeafNode()&&(c=n.filter.updateFullNode(c,r,o)))}return r=e.serverCache.isFullyInitialized()||Qi(i,Be())!=null,ii(e,c,r,n.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o_{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const i=this.query_._queryParams,s=new vo(i.getIndex()),o=Ch(i);this.processor_=Zh(o);const r=t.serverCache,l=t.eventCache,a=s.updateFullNode(_e.EMPTY_NODE,r.getNode(),null),c=o.updateFullNode(_e.EMPTY_NODE,l.getNode(),null),u=new rn(a,r.isFullyInitialized(),s.filtersNodes()),d=new rn(c,l.isFullyInitialized(),o.filtersNodes());this.viewCache_=ss(d,u),this.eventGenerator_=new Rh(this.query_)}get query(){return this.query_}}function r_(n){return n.viewCache_.serverCache.getNode()}function l_(n){return Ki(n.viewCache_)}function a_(n,e){const t=wn(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!Ce(e)&&!t.getImmediateChild(Ie(e)).isEmpty())?t.getChild(e):null}function Dr(n){return n.eventRegistrations_.length===0}function c_(n,e){n.eventRegistrations_.push(e)}function Rr(n,e,t){const i=[];if(t){ee(e==null,"A cancel should cancel all event registrations.");const s=n.query._path;n.eventRegistrations_.forEach(o=>{const r=o.createCancelEvent(t,s);r&&i.push(r)})}if(e){let s=[];for(let o=0;o<n.eventRegistrations_.length;++o){const r=n.eventRegistrations_[o];if(!r.matches(e))s.push(r);else if(e.hasAnyCallback()){s=s.concat(n.eventRegistrations_.slice(o+1));break}}n.eventRegistrations_=s}else n.eventRegistrations_=[];return i}function Ar(n,e,t,i){e.type===Rt.MERGE&&e.source.queryId!==null&&(ee(wn(n.viewCache_),"We should always have a full cache before handling merges"),ee(Ki(n.viewCache_),"Missing event cache, even though we have a server cache"));const s=n.viewCache_,o=$h(n.processor_,s,e,t,i);return xh(n.processor_,o.viewCache),ee(o.viewCache.serverCache.isFullyInitialized()||!s.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=o.viewCache,kc(n,o.changes,o.viewCache.eventCache.getNode(),null)}function u_(n,e){const t=n.viewCache_.eventCache,i=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(xe,(o,r)=>{i.push(qn(o,r))}),t.isFullyInitialized()&&i.push(dc(t.getNode())),kc(n,i,t.getNode(),e)}function kc(n,e,t,i){const s=i?[i]:n.eventRegistrations_;return Ah(n.eventGenerator_,e,t,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ji;class Cc{constructor(){this.views=new Map}}function d_(n){ee(!Ji,"__referenceConstructor has already been defined"),Ji=n}function f_(){return ee(Ji,"Reference.ts has not been loaded"),Ji}function h_(n){return n.views.size===0}function Io(n,e,t,i){const s=e.source.queryId;if(s!==null){const o=n.views.get(s);return ee(o!=null,"SyncTree gave us an op for an invalid query."),Ar(o,e,t,i)}else{let o=[];for(const r of n.views.values())o=o.concat(Ar(r,e,t,i));return o}}function Ec(n,e,t,i,s){const o=e._queryIdentifier,r=n.views.get(o);if(!r){let l=Yi(t,s?i:null),a=!1;l?a=!0:i instanceof _e?(l=Co(t,i),a=!1):(l=_e.EMPTY_NODE,a=!1);const c=ss(new rn(l,a,!1),new rn(i,s,!1));return new o_(e,c)}return r}function __(n,e,t,i,s,o){const r=Ec(n,e,i,s,o);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,r),c_(r,t),u_(r,t)}function p_(n,e,t,i){const s=e._queryIdentifier,o=[];let r=[];const l=ln(n);if(s==="default")for(const[a,c]of n.views.entries())r=r.concat(Rr(c,t,i)),Dr(c)&&(n.views.delete(a),c.query._queryParams.loadsAllData()||o.push(c.query));else{const a=n.views.get(s);a&&(r=r.concat(Rr(a,t,i)),Dr(a)&&(n.views.delete(s),a.query._queryParams.loadsAllData()||o.push(a.query)))}return l&&!ln(n)&&o.push(new(f_())(e._repo,e._path)),{removed:o,events:r}}function Sc(n){const e=[];for(const t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function en(n,e){let t=null;for(const i of n.views.values())t=t||a_(i,e);return t}function Ic(n,e){if(e._queryParams.loadsAllData())return rs(n);{const i=e._queryIdentifier;return n.views.get(i)}}function Tc(n,e){return Ic(n,e)!=null}function ln(n){return rs(n)!=null}function rs(n){for(const e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Zi;function m_(n){ee(!Zi,"__referenceConstructor has already been defined"),Zi=n}function g_(){return ee(Zi,"Reference.ts has not been loaded"),Zi}let b_=1;class Pr{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Xe(null),this.pendingWriteTree_=Yh(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function Nc(n,e,t,i,s){return Fh(n.pendingWriteTree_,e,t,i,s),s?Ei(n,new yn(hc(),e,t)):[]}function _n(n,e,t=!1){const i=Bh(n.pendingWriteTree_,e);if(qh(n.pendingWriteTree_,e)){let o=new Xe(null);return i.snap!=null?o=o.set(Be(),!0):Et(i.children,r=>{o=o.set(new Ge(r),!0)}),Ei(n,new Vi(i.path,o,t))}else return[]}function Ci(n,e,t){return Ei(n,new yn(wo(),e,t))}function v_(n,e,t){const i=Xe.fromObject(t);return Ei(n,new pi(wo(),e,i))}function y_(n,e){return Ei(n,new _i(wo(),e))}function w_(n,e,t){const i=No(n,t);if(i){const s=Oo(i),o=s.path,r=s.queryId,l=bt(o,e),a=new _i(ko(r),l);return Do(n,o,a)}else return[]}function Oc(n,e,t,i,s=!1){const o=e._path,r=n.syncPointTree_.get(o);let l=[];if(r&&(e._queryIdentifier==="default"||Tc(r,e))){const a=p_(r,e,t,i);h_(r)&&(n.syncPointTree_=n.syncPointTree_.remove(o));const c=a.removed;if(l=a.events,!s){const u=c.findIndex(f=>f._queryParams.loadsAllData())!==-1,d=n.syncPointTree_.findOnPath(o,(f,_)=>ln(_));if(u&&!d){const f=n.syncPointTree_.subtree(o);if(!f.isEmpty()){const _=S_(f);for(let h=0;h<_.length;++h){const b=_[h],v=b.query,w=Pc(n,b);n.listenProvider_.startListening(oi(v),mi(n,v),w.hashFn,w.onComplete)}}}!d&&c.length>0&&!i&&(u?n.listenProvider_.stopListening(oi(e),null):c.forEach(f=>{const _=n.queryToTagMap.get(ls(f));n.listenProvider_.stopListening(oi(f),_)}))}I_(n,c)}return l}function Dc(n,e,t,i){const s=No(n,i);if(s!=null){const o=Oo(s),r=o.path,l=o.queryId,a=bt(r,e),c=new yn(ko(l),a,t);return Do(n,r,c)}else return[]}function k_(n,e,t,i){const s=No(n,i);if(s){const o=Oo(s),r=o.path,l=o.queryId,a=bt(r,e),c=Xe.fromObject(t),u=new pi(ko(l),a,c);return Do(n,r,u)}else return[]}function C_(n,e,t,i=!1){const s=e._path;let o=null,r=!1;n.syncPointTree_.foreachOnPath(s,(f,_)=>{const h=bt(f,s);o=o||en(_,h),r=r||ln(_)});let l=n.syncPointTree_.get(s);l?(r=r||ln(l),o=o||en(l,Be())):(l=new Cc,n.syncPointTree_=n.syncPointTree_.set(s,l));let a;o!=null?a=!0:(a=!1,o=_e.EMPTY_NODE,n.syncPointTree_.subtree(s).foreachChild((_,h)=>{const b=en(h,Be());b&&(o=o.updateImmediateChild(_,b))}));const c=Tc(l,e);if(!c&&!e._queryParams.loadsAllData()){const f=ls(e);ee(!n.queryToTagMap.has(f),"View does not exist, but we have a tag");const _=T_();n.queryToTagMap.set(f,_),n.tagToQueryMap.set(_,f)}const u=os(n.pendingWriteTree_,s);let d=__(l,e,t,u,o,a);if(!c&&!r&&!i){const f=Ic(l,e);d=d.concat(N_(n,e,f))}return d}function To(n,e,t){const s=n.pendingWriteTree_,o=n.syncPointTree_.findOnPath(e,(r,l)=>{const a=bt(r,e),c=en(l,a);if(c)return c});return gc(s,e,o,t,!0)}function E_(n,e){const t=e._path;let i=null;n.syncPointTree_.foreachOnPath(t,(c,u)=>{const d=bt(c,t);i=i||en(u,d)});let s=n.syncPointTree_.get(t);s?i=i||en(s,Be()):(s=new Cc,n.syncPointTree_=n.syncPointTree_.set(t,s));const o=i!=null,r=o?new rn(i,!0,!1):null,l=os(n.pendingWriteTree_,e._path),a=Ec(s,e,l,o?r.getNode():_e.EMPTY_NODE,o);return l_(a)}function Ei(n,e){return Rc(e,n.syncPointTree_,null,os(n.pendingWriteTree_,Be()))}function Rc(n,e,t,i){if(Ce(n.path))return Ac(n,e,t,i);{const s=e.get(Be());t==null&&s!=null&&(t=en(s,Be()));let o=[];const r=Ie(n.path),l=n.operationForChild(r),a=e.children.get(r);if(a&&l){const c=t?t.getImmediateChild(r):null,u=bc(i,r);o=o.concat(Rc(l,a,c,u))}return s&&(o=o.concat(Io(s,n,i,t))),o}}function Ac(n,e,t,i){const s=e.get(Be());t==null&&s!=null&&(t=en(s,Be()));let o=[];return e.children.inorderTraversal((r,l)=>{const a=t?t.getImmediateChild(r):null,c=bc(i,r),u=n.operationForChild(r);u&&(o=o.concat(Ac(u,l,a,c)))}),s&&(o=o.concat(Io(s,n,i,t))),o}function Pc(n,e){const t=e.query,i=mi(n,t);return{hashFn:()=>(r_(e)||_e.EMPTY_NODE).hash(),onComplete:s=>{if(s==="ok")return i?w_(n,t._path,i):y_(n,t._path);{const o=Ef(s,t);return Oc(n,t,null,o)}}}}function mi(n,e){const t=ls(e);return n.queryToTagMap.get(t)}function ls(n){return n._path.toString()+"$"+n._queryIdentifier}function No(n,e){return n.tagToQueryMap.get(e)}function Oo(n){const e=n.indexOf("$");return ee(e!==-1&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new Ge(n.substr(0,e))}}function Do(n,e,t){const i=n.syncPointTree_.get(e);ee(i,"Missing sync point for query tag that we're tracking");const s=os(n.pendingWriteTree_,e);return Io(i,t,s,null)}function S_(n){return n.fold((e,t,i)=>{if(t&&ln(t))return[rs(t)];{let s=[];return t&&(s=Sc(t)),Et(i,(o,r)=>{s=s.concat(r)}),s}})}function oi(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(g_())(n._repo,n._path):n}function I_(n,e){for(let t=0;t<e.length;++t){const i=e[t];if(!i._queryParams.loadsAllData()){const s=ls(i),o=n.queryToTagMap.get(s);n.queryToTagMap.delete(s),n.tagToQueryMap.delete(o)}}}function T_(){return b_++}function N_(n,e,t){const i=e._path,s=mi(n,e),o=Pc(n,t),r=n.listenProvider_.startListening(oi(e),s,o.hashFn,o.onComplete),l=n.syncPointTree_.subtree(i);if(s)ee(!ln(l.value),"If we're adding a query, it shouldn't be shadowed");else{const a=l.fold((c,u,d)=>{if(!Ce(c)&&u&&ln(u))return[rs(u).query];{let f=[];return u&&(f=f.concat(Sc(u).map(_=>_.query))),Et(d,(_,h)=>{f=f.concat(h)}),f}});for(let c=0;c<a.length;++c){const u=a[c];n.listenProvider_.stopListening(oi(u),mi(n,u))}}return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ro{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new Ro(t)}node(){return this.node_}}class Ao{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=st(this.path_,e);return new Ao(this.syncTree_,t)}node(){return To(this.syncTree_,this.path_)}}const O_=function(n){return n=n||{},n.timestamp=n.timestamp||new Date().getTime(),n},Mr=function(n,e,t){if(!n||typeof n!="object")return n;if(ee(".sv"in n,"Unexpected leaf node or priority contents"),typeof n[".sv"]=="string")return D_(n[".sv"],e,t);if(typeof n[".sv"]=="object")return R_(n[".sv"],e);ee(!1,"Unexpected server value: "+JSON.stringify(n,null,2))},D_=function(n,e,t){switch(n){case"timestamp":return t.timestamp;default:ee(!1,"Unexpected server value: "+n)}},R_=function(n,e,t){n.hasOwnProperty("increment")||ee(!1,"Unexpected server value: "+JSON.stringify(n,null,2));const i=n.increment;typeof i!="number"&&ee(!1,"Unexpected increment value: "+i);const s=e.node();if(ee(s!==null&&typeof s<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!s.isLeafNode())return i;const r=s.getValue();return typeof r!="number"?i:r+i},A_=function(n,e,t,i){return Po(e,new Ao(t,n),i)},Mc=function(n,e,t){return Po(n,new Ro(e),t)};function Po(n,e,t){const i=n.getPriority().val(),s=Mr(i,e.getImmediateChild(".priority"),t);let o;if(n.isLeafNode()){const r=n,l=Mr(r.getValue(),e,t);return l!==r.getValue()||s!==r.getPriority().val()?new rt(l,at(s)):n}else{const r=n;return o=r,s!==r.getPriority().val()&&(o=o.updatePriority(new rt(s))),r.forEachChild(xe,(l,a)=>{const c=Po(a,e.getImmediateChild(l),t);c!==a&&(o=o.updateImmediateChild(l,c))}),o}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mo{constructor(e="",t=null,i={children:{},childCount:0}){this.name=e,this.parent=t,this.node=i}}function Lo(n,e){let t=e instanceof Ge?e:new Ge(e),i=n,s=Ie(t);for(;s!==null;){const o=Bn(i.node.children,s)||{children:{},childCount:0};i=new Mo(s,i,o),t=Ye(t),s=Ie(t)}return i}function Yn(n){return n.node.value}function Lc(n,e){n.node.value=e,Js(n)}function Fc(n){return n.node.childCount>0}function P_(n){return Yn(n)===void 0&&!Fc(n)}function as(n,e){Et(n.node.children,(t,i)=>{e(new Mo(t,n,i))})}function Bc(n,e,t,i){t&&!i&&e(n),as(n,s=>{Bc(s,e,!0,i)}),t&&i&&e(n)}function M_(n,e,t){let i=t?n:n.parent;for(;i!==null;){if(e(i))return!0;i=i.parent}return!1}function Si(n){return new Ge(n.parent===null?n.name:Si(n.parent)+"/"+n.name)}function Js(n){n.parent!==null&&L_(n.parent,n.name,n)}function L_(n,e,t){const i=P_(t),s=Ht(n.node.children,e);i&&s?(delete n.node.children[e],n.node.childCount--,Js(n)):!i&&!s&&(n.node.children[e]=t.node,n.node.childCount++,Js(n))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F_=/[\[\].#$\/\u0000-\u001F\u007F]/,B_=/[\[\].#$\u0000-\u001F\u007F]/,Ds=10*1024*1024,qc=function(n){return typeof n=="string"&&n.length!==0&&!F_.test(n)},zc=function(n){return typeof n=="string"&&n.length!==0&&!B_.test(n)},q_=function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),zc(n)},Lr=function(n){return n===null||typeof n=="string"||typeof n=="number"&&!fo(n)||n&&typeof n=="object"&&Ht(n,".sv")},jc=function(n,e,t,i){i&&e===void 0||Fo(co(n,"value"),e,t)},Fo=function(n,e,t){const i=t instanceof Ge?new ih(t,n):t;if(e===void 0)throw new Error(n+"contains undefined "+dn(i));if(typeof e=="function")throw new Error(n+"contains a function "+dn(i)+" with contents = "+e.toString());if(fo(e))throw new Error(n+"contains "+e.toString()+" "+dn(i));if(typeof e=="string"&&e.length>Ds/3&&ns(e)>Ds)throw new Error(n+"contains a string greater than "+Ds+" utf8 bytes "+dn(i)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let s=!1,o=!1;if(Et(e,(r,l)=>{if(r===".value")s=!0;else if(r!==".priority"&&r!==".sv"&&(o=!0,!qc(r)))throw new Error(n+" contains an invalid key ("+r+") "+dn(i)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);sh(i,r),Fo(n,l,i),oh(i)}),s&&o)throw new Error(n+' contains ".value" child '+dn(i)+" in addition to actual children.")}},Wc=function(n,e,t,i){if(!(i&&t===void 0)&&!zc(t))throw new Error(co(n,e)+'was an invalid path = "'+t+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},z_=function(n,e,t,i){t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),Wc(n,e,t,i)},Bo=function(n,e){if(Ie(e)===".info")throw new Error(n+" failed = Can't modify data under /.info/")},j_=function(n,e){const t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!qc(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!q_(t))throw new Error(co(n,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W_{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function Hc(n,e){let t=null;for(let i=0;i<e.length;i++){const s=e[i],o=s.getPath();t!==null&&!nc(o,t.path)&&(n.eventLists_.push(t),t=null),t===null&&(t={events:[],path:o}),t.events.push(s)}t&&n.eventLists_.push(t)}function jt(n,e,t){Hc(n,t),H_(n,i=>Dt(i,e)||Dt(e,i))}function H_(n,e){n.recursionDepth_++;let t=!0;for(let i=0;i<n.eventLists_.length;i++){const s=n.eventLists_[i];if(s){const o=s.path;e(o)?(U_(n.eventLists_[i]),n.eventLists_[i]=null):t=!1}}t&&(n.eventLists_=[]),n.recursionDepth_--}function U_(n){for(let e=0;e<n.events.length;e++){const t=n.events[e];if(t!==null){n.events[e]=null;const i=t.getEventRunner();mn&&pt("event: "+t.toString()),Kn(i)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G_="repo_interrupt",V_=25;class K_{constructor(e,t,i,s){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=i,this.appCheckProvider_=s,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new W_,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Gi(),this.transactionQueueTree_=new Mo,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function Y_(n,e,t){if(n.stats_=po(n.repoInfo_),n.forceRestClient_||Nf())n.server_=new Ui(n.repoInfo_,(i,s,o,r)=>{Fr(n,i,s,o,r)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>Br(n,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{it(t)}catch(i){throw new Error("Invalid authOverride provided: "+i)}}n.persistentConnection_=new Gt(n.repoInfo_,e,(i,s,o,r)=>{Fr(n,i,s,o,r)},i=>{Br(n,i)},i=>{Q_(n,i)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(i=>{n.server_.refreshAuthToken(i)}),n.appCheckProvider_.addTokenChangeListener(i=>{n.server_.refreshAppCheckToken(i.token)}),n.statsReporter_=Pf(n.repoInfo_,()=>new Dh(n.stats_,n.server_)),n.infoData_=new Sh,n.infoSyncTree_=new Pr({startListening:(i,s,o,r)=>{let l=[];const a=n.infoData_.getNode(i._path);return a.isEmpty()||(l=Ci(n.infoSyncTree_,i._path,a),setTimeout(()=>{r("ok")},0)),l},stopListening:()=>{}}),zo(n,"connected",!1),n.serverSyncTree_=new Pr({startListening:(i,s,o,r)=>(n.server_.listen(i,o,s,(l,a)=>{const c=r(l,a);jt(n.eventQueue_,i._path,c)}),[]),stopListening:(i,s)=>{n.server_.unlisten(i,s)}})}function Uc(n){const t=n.infoData_.getNode(new Ge(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function qo(n){return O_({timestamp:Uc(n)})}function Fr(n,e,t,i,s){n.dataUpdateCount++;const o=new Ge(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let r=[];if(s)if(i){const a=Bi(t,c=>at(c));r=k_(n.serverSyncTree_,o,a,s)}else{const a=at(t);r=Dc(n.serverSyncTree_,o,a,s)}else if(i){const a=Bi(t,c=>at(c));r=v_(n.serverSyncTree_,o,a)}else{const a=at(t);r=Ci(n.serverSyncTree_,o,a)}let l=o;r.length>0&&(l=us(n,o)),jt(n.eventQueue_,l,r)}function Br(n,e){zo(n,"connected",e),e===!1&&Z_(n)}function Q_(n,e){Et(e,(t,i)=>{zo(n,t,i)})}function zo(n,e,t){const i=new Ge("/.info/"+e),s=at(t);n.infoData_.updateSnapshot(i,s);const o=Ci(n.infoSyncTree_,i,s);jt(n.eventQueue_,i,o)}function Gc(n){return n.nextWriteId_++}function X_(n,e,t){const i=E_(n.serverSyncTree_,e);return i!=null?Promise.resolve(i):n.server_.get(e).then(s=>{const o=at(s).withIndex(e._queryParams.getIndex());C_(n.serverSyncTree_,e,t,!0);let r;if(e._queryParams.loadsAllData())r=Ci(n.serverSyncTree_,e._path,o);else{const l=mi(n.serverSyncTree_,e);r=Dc(n.serverSyncTree_,e._path,o,l)}return jt(n.eventQueue_,e._path,r),Oc(n.serverSyncTree_,e,t,null,!0),o},s=>(cs(n,"get for query "+it(e)+" failed: "+s),Promise.reject(new Error(s))))}function J_(n,e,t,i,s){cs(n,"set",{path:e.toString(),value:t,priority:i});const o=qo(n),r=at(t,i),l=To(n.serverSyncTree_,e),a=Mc(r,l,o),c=Gc(n),u=Nc(n.serverSyncTree_,e,a,c,!0);Hc(n.eventQueue_,u),n.server_.put(e.toString(),r.val(!0),(f,_)=>{const h=f==="ok";h||Ct("set at "+e+" failed: "+f);const b=_n(n.serverSyncTree_,c,!h);jt(n.eventQueue_,e,b),$_(n,s,f,_)});const d=Xc(n,e);us(n,d),jt(n.eventQueue_,d,[])}function Z_(n){cs(n,"onDisconnectEvents");const e=qo(n),t=Gi();Vs(n.onDisconnect_,Be(),(s,o)=>{const r=A_(s,o,n.serverSyncTree_,e);fc(t,s,r)});let i=[];Vs(t,Be(),(s,o)=>{i=i.concat(Ci(n.serverSyncTree_,s,o));const r=Xc(n,s);us(n,r)}),n.onDisconnect_=Gi(),jt(n.eventQueue_,Be(),i)}function x_(n){n.persistentConnection_&&n.persistentConnection_.interrupt(G_)}function cs(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),pt(t,...e)}function $_(n,e,t,i){e&&Kn(()=>{if(t==="ok")e(null);else{const s=(t||"error").toUpperCase();let o=s;i&&(o+=": "+i);const r=new Error(o);r.code=s,e(r)}})}function Vc(n,e,t){return To(n.serverSyncTree_,e,t)||_e.EMPTY_NODE}function jo(n,e=n.transactionQueueTree_){if(e||ds(n,e),Yn(e)){const t=Yc(n,e);ee(t.length>0,"Sending zero length transaction queue"),t.every(s=>s.status===0)&&ep(n,Si(e),t)}else Fc(e)&&as(e,t=>{jo(n,t)})}function ep(n,e,t){const i=t.map(c=>c.currentWriteId),s=Vc(n,e,i);let o=s;const r=s.hash();for(let c=0;c<t.length;c++){const u=t[c];ee(u.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=1,u.retryCount++;const d=bt(e,u.path);o=o.updateChild(d,u.currentOutputSnapshotRaw)}const l=o.val(!0),a=e;n.server_.put(a.toString(),l,c=>{cs(n,"transaction put response",{path:a.toString(),status:c});let u=[];if(c==="ok"){const d=[];for(let f=0;f<t.length;f++)t[f].status=2,u=u.concat(_n(n.serverSyncTree_,t[f].currentWriteId)),t[f].onComplete&&d.push(()=>t[f].onComplete(null,!0,t[f].currentOutputSnapshotResolved)),t[f].unwatcher();ds(n,Lo(n.transactionQueueTree_,e)),jo(n,n.transactionQueueTree_),jt(n.eventQueue_,e,u);for(let f=0;f<d.length;f++)Kn(d[f])}else{if(c==="datastale")for(let d=0;d<t.length;d++)t[d].status===3?t[d].status=4:t[d].status=0;else{Ct("transaction at "+a.toString()+" failed: "+c);for(let d=0;d<t.length;d++)t[d].status=4,t[d].abortReason=c}us(n,e)}},r)}function us(n,e){const t=Kc(n,e),i=Si(t),s=Yc(n,t);return tp(n,s,i),i}function tp(n,e,t){if(e.length===0)return;const i=[];let s=[];const r=e.filter(l=>l.status===0).map(l=>l.currentWriteId);for(let l=0;l<e.length;l++){const a=e[l],c=bt(t,a.path);let u=!1,d;if(ee(c!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),a.status===4)u=!0,d=a.abortReason,s=s.concat(_n(n.serverSyncTree_,a.currentWriteId,!0));else if(a.status===0)if(a.retryCount>=V_)u=!0,d="maxretry",s=s.concat(_n(n.serverSyncTree_,a.currentWriteId,!0));else{const f=Vc(n,a.path,r);a.currentInputSnapshot=f;const _=e[l].update(f.val());if(_!==void 0){Fo("transaction failed: Data returned ",_,a.path);let h=at(_);typeof _=="object"&&_!=null&&Ht(_,".priority")||(h=h.updatePriority(f.getPriority()));const v=a.currentWriteId,w=qo(n),k=Mc(h,f,w);a.currentOutputSnapshotRaw=h,a.currentOutputSnapshotResolved=k,a.currentWriteId=Gc(n),r.splice(r.indexOf(v),1),s=s.concat(Nc(n.serverSyncTree_,a.path,k,a.currentWriteId,a.applyLocally)),s=s.concat(_n(n.serverSyncTree_,v,!0))}else u=!0,d="nodata",s=s.concat(_n(n.serverSyncTree_,a.currentWriteId,!0))}jt(n.eventQueue_,t,s),s=[],u&&(e[l].status=2,function(f){setTimeout(f,Math.floor(0))}(e[l].unwatcher),e[l].onComplete&&(d==="nodata"?i.push(()=>e[l].onComplete(null,!1,e[l].currentInputSnapshot)):i.push(()=>e[l].onComplete(new Error(d),!1,null))))}ds(n,n.transactionQueueTree_);for(let l=0;l<i.length;l++)Kn(i[l]);jo(n,n.transactionQueueTree_)}function Kc(n,e){let t,i=n.transactionQueueTree_;for(t=Ie(e);t!==null&&Yn(i)===void 0;)i=Lo(i,t),e=Ye(e),t=Ie(e);return i}function Yc(n,e){const t=[];return Qc(n,e,t),t.sort((i,s)=>i.order-s.order),t}function Qc(n,e,t){const i=Yn(e);if(i)for(let s=0;s<i.length;s++)t.push(i[s]);as(e,s=>{Qc(n,s,t)})}function ds(n,e){const t=Yn(e);if(t){let i=0;for(let s=0;s<t.length;s++)t[s].status!==2&&(t[i]=t[s],i++);t.length=i,Lc(e,t.length>0?t:void 0)}as(e,i=>{ds(n,i)})}function Xc(n,e){const t=Si(Kc(n,e)),i=Lo(n.transactionQueueTree_,e);return M_(i,s=>{Rs(n,s)}),Rs(n,i),Bc(i,s=>{Rs(n,s)}),t}function Rs(n,e){const t=Yn(e);if(t){const i=[];let s=[],o=-1;for(let r=0;r<t.length;r++)t[r].status===3||(t[r].status===1?(ee(o===r-1,"All SENT items should be at beginning of queue."),o=r,t[r].status=3,t[r].abortReason="set"):(ee(t[r].status===0,"Unexpected transaction status in abort"),t[r].unwatcher(),s=s.concat(_n(n.serverSyncTree_,t[r].currentWriteId,!0)),t[r].onComplete&&i.push(t[r].onComplete.bind(null,new Error("set"),!1,null))));o===-1?Lc(e,void 0):t.length=o+1,jt(n.eventQueue_,Si(e),s);for(let r=0;r<i.length;r++)Kn(i[r])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function np(n){let e="";const t=n.split("/");for(let i=0;i<t.length;i++)if(t[i].length>0){let s=t[i];try{s=decodeURIComponent(s.replace(/\+/g," "))}catch{}e+="/"+s}return e}function ip(n){const e={};n.charAt(0)==="?"&&(n=n.substring(1));for(const t of n.split("&")){if(t.length===0)continue;const i=t.split("=");i.length===2?e[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):Ct(`Invalid query segment '${t}' in query '${n}'`)}return e}const qr=function(n,e){const t=sp(n),i=t.namespace;t.domain==="firebase.com"&&Vt(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!i||i==="undefined")&&t.domain!=="localhost"&&Vt("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||vf();const s=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new Ga(t.host,t.secure,i,s,e,"",i!==t.subdomain),path:new Ge(t.pathString)}},sp=function(n){let e="",t="",i="",s="",o="",r=!0,l="https",a=443;if(typeof n=="string"){let c=n.indexOf("//");c>=0&&(l=n.substring(0,c-1),n=n.substring(c+2));let u=n.indexOf("/");u===-1&&(u=n.length);let d=n.indexOf("?");d===-1&&(d=n.length),e=n.substring(0,Math.min(u,d)),u<d&&(s=np(n.substring(u,d)));const f=ip(n.substring(Math.min(n.length,d)));c=e.indexOf(":"),c>=0?(r=l==="https"||l==="wss",a=parseInt(e.substring(c+1),10)):c=e.length;const _=e.slice(0,c);if(_.toLowerCase()==="localhost")t="localhost";else if(_.split(".").length<=2)t=_;else{const h=e.indexOf(".");i=e.substring(0,h).toLowerCase(),t=e.substring(h+1),o=i}"ns"in f&&(o=f.ns)}return{host:e,port:a,domain:t,subdomain:i,secure:r,scheme:l,pathString:s,namespace:o}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zr="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",op=function(){let n=0;const e=[];return function(t){const i=t===n;n=t;let s;const o=new Array(8);for(s=7;s>=0;s--)o[s]=zr.charAt(t%64),t=Math.floor(t/64);ee(t===0,"Cannot push at time == 0");let r=o.join("");if(i){for(s=11;s>=0&&e[s]===63;s--)e[s]=0;e[s]++}else for(s=0;s<12;s++)e[s]=Math.floor(Math.random()*64);for(s=0;s<12;s++)r+=zr.charAt(e[s]);return ee(r.length===20,"nextPushId: Length should be 20."),r}}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rp{constructor(e,t,i,s){this.eventType=e,this.eventRegistration=t,this.snapshot=i,this.prevName=s}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+it(this.snapshot.exportVal())}}class lp{constructor(e,t,i){this.eventRegistration=e,this.error=t,this.path=i}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ap{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return ee(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fs{constructor(e,t,i,s){this._repo=e,this._path=t,this._queryParams=i,this._orderByCalled=s}get key(){return Ce(this._path)?null:$a(this._path)}get ref(){return new Yt(this._repo,this._path)}get _queryIdentifier(){const e=kr(this._queryParams),t=ho(e);return t==="{}"?"default":t}get _queryObject(){return kr(this._queryParams)}isEqual(e){if(e=an(e),!(e instanceof fs))return!1;const t=this._repo===e._repo,i=nc(this._path,e._path),s=this._queryIdentifier===e._queryIdentifier;return t&&i&&s}toJSON(){return this.toString()}toString(){return this._repo.toString()+nh(this._path)}}function cp(n,e){if(n._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function up(n){let e=null,t=null;if(n.hasStart()&&(e=n.getIndexStartValue()),n.hasEnd()&&(t=n.getIndexEndValue()),n.getIndex()===xt){const i="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",s="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(n.hasStart()){if(n.getIndexStartName()!==vn)throw new Error(i);if(typeof e!="string")throw new Error(s)}if(n.hasEnd()){if(n.getIndexEndName()!==sn)throw new Error(i);if(typeof t!="string")throw new Error(s)}}else if(n.getIndex()===xe){if(e!=null&&!Lr(e)||t!=null&&!Lr(t))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(ee(n.getIndex()instanceof cc||n.getIndex()===uc,"unknown index type."),e!=null&&typeof e=="object"||t!=null&&typeof t=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}class Yt extends fs{constructor(e,t){super(e,t,new yo,!1)}get parent(){const e=tc(this._path);return e===null?null:new Yt(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}class gi{constructor(e,t,i){this._node=e,this.ref=t,this._index=i}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new Ge(e),i=Kt(this.ref,e);return new gi(this._node.getChild(t),i,xe)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(i,s)=>e(new gi(s,Kt(this.ref,i),xe)))}hasChild(e){const t=new Ge(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function jn(n,e){return n=an(n),n._checkNotDeleted("ref"),e!==void 0?Kt(n._root,e):n._root}function Kt(n,e){return n=an(n),Ie(n._path)===null?z_("child","path",e,!1):Wc("child","path",e,!1),new Yt(n._repo,st(n._path,e))}function dp(n,e){n=an(n),Bo("push",n._path),jc("push",e,n._path,!0);const t=Uc(n._repo),i=op(t),s=Kt(n,i),o=Kt(n,i);let r;return e!=null?r=hs(o,e).then(()=>o):r=Promise.resolve(o),s.then=r.then.bind(r),s.catch=r.then.bind(r,void 0),s}function fp(n){return Bo("remove",n._path),hs(n,null)}function hs(n,e){n=an(n),Bo("set",n._path),jc("set",e,n._path,!1);const t=new ts;return J_(n._repo,n._path,e,null,t.wrapCallback(()=>{})),t.promise}function Jc(n){n=an(n);const e=new ap(()=>{}),t=new Wo(e);return X_(n._repo,n,t).then(i=>new gi(i,new Yt(n._repo,n._path),n._queryParams.getIndex()))}class Wo{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,t){const i=t._queryParams.getIndex();return new rp("value",this,new gi(e.snapshotNode,new Yt(t._repo,t._path),i))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new lp(this,e,t):null}matches(e){return e instanceof Wo?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}class hp{}class _p extends hp{_apply(e){cp(e,"orderByKey");const t=Eh(e._queryParams,xt);return up(t),new fs(e._repo,e._path,t,!0)}}function Zc(){return new _p}function xc(n,...e){let t=an(n);for(const i of e)t=i._apply(t);return t}d_(Yt);m_(Yt);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pp="FIREBASE_DATABASE_EMULATOR_HOST",Zs={};let mp=!1;function gp(n,e,t,i){n.repoInfo_=new Ga(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0),i&&(n.authTokenProvider_=i)}function bp(n,e,t,i,s){let o=i||n.options.databaseURL;o===void 0&&(n.options.projectId||Vt("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),pt("Using default host for project ",n.options.projectId),o=`${n.options.projectId}-default-rtdb.firebaseio.com`);let r=qr(o,s),l=r.repoInfo,a,c;typeof process<"u"&&process.env&&(c=process.env[pp]),c?(a=!0,o=`http://${c}?ns=${l.namespace}`,r=qr(o,s),l=r.repoInfo):a=!r.repoInfo.secure;const u=s&&a?new Mn(Mn.OWNER):new Df(n.name,n.options,e);j_("Invalid Firebase Database URL",r),Ce(r.path)||Vt("Database URL must point to the root of a Firebase Database (not including a child path).");const d=yp(l,n,u,new Of(n.name,t));return new wp(d,n)}function vp(n,e){const t=Zs[e];(!t||t[n.key]!==n)&&Vt(`Database ${e}(${n.repoInfo_}) has already been deleted.`),x_(n),delete t[n.key]}function yp(n,e,t,i){let s=Zs[e.name];s||(s={},Zs[e.name]=s);let o=s[n.toURLString()];return o&&Vt("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),o=new K_(n,mp,t,i),s[n.toURLString()]=o,o}class wp{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(Y_(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Yt(this._repo,Be())),this._rootInternal}_delete(){return this._rootInternal!==null&&(vp(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Vt("Cannot call "+e+" on a deleted database.")}}function kp(n=tf(),e){const t=Zd(n,"database").getImmediate({identifier:e});if(!t._instanceStarted){const i=Uu("database");i&&Cp(t,...i)}return t}function Cp(n,e,t,i={}){n=an(n),n._checkNotDeleted("useEmulator"),n._instanceStarted&&Vt("Cannot call useEmulator() after instance has already been initialized.");const s=n._repoInternal;let o;if(s.repoInfo_.nodeAdmin)i.mockUserToken&&Vt('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),o=new Mn(Mn.OWNER);else if(i.mockUserToken){const r=typeof i.mockUserToken=="string"?i.mockUserToken:Gu(i.mockUserToken,n.app.options.projectId);o=new Mn(r)}gp(s,e,t,o)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ep(n){_f(ef),zi(new ai("database",(e,{instanceIdentifier:t})=>{const i=e.getProvider("app").getImmediate(),s=e.getProvider("auth-internal"),o=e.getProvider("app-check-internal");return bp(i,s,o,t)},"PUBLIC").setMultipleInstances(!0)),An(or,rr,n),An(or,rr,"esm2017")}Gt.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)};Gt.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)};Ep();var xs={},$c={},_s={};Object.defineProperty(_s,"__esModule",{value:!0});_s.rotx=void 0;function Sp(n,e){return n.replace(/[a-zA-Z]/g,function(t){return String.fromCharCode((t<="Z"?90:122)>=(t=t.charCodeAt(0)+e)?t:t-26)})}_s.rotx=Sp;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.rotx=void 0;var e=_s;Object.defineProperty(n,"rotx",{enumerable:!0,get:function(){return e.rotx}})})($c);var eu={},ps={};Object.defineProperty(ps,"__esModule",{value:!0});ps.base64=void 0;class Ip{encode(e){return typeof btoa>"u"?Buffer.from(e,"binary").toString("base64"):btoa(e)}decode(e){return typeof atob>"u"?Buffer.from(e,"base64").toString("binary"):atob(e)}}const Tp=new Ip;ps.base64=Tp;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.base64=void 0;var e=ps;Object.defineProperty(n,"base64",{enumerable:!0,get:function(){return e.base64}})})(eu);var tu={},ms={};Object.defineProperty(ms,"__esModule",{value:!0});ms.hex=void 0;class Np{encode(e){let t="",i="";for(let s=0;s<e.length;s++)t=e.charCodeAt(s).toString(16),i+=("000"+t).slice(-4);return i}decode(e){let t=e.match(/.{1,4}/g)||[],i="";for(let s=0;s<t.length;s++)i+=String.fromCharCode(parseInt(t[s],16));return i}}const Op=new Np;ms.hex=Op;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.hex=void 0;var e=ms;Object.defineProperty(n,"hex",{enumerable:!0,get:function(){return e.hex}})})(tu);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.hex=n.base64=n.rotx=void 0;var e=$c;Object.defineProperty(n,"rotx",{enumerable:!0,get:function(){return e.rotx}});var t=eu;Object.defineProperty(n,"base64",{enumerable:!0,get:function(){return t.base64}});var i=tu;Object.defineProperty(n,"hex",{enumerable:!0,get:function(){return i.hex}})})(xs);let Dp={ixqSmg:"IQhiAgIPDNBgKzMmPcWG9XWqEsxI2uQ70F5X1rY",icbpLwuiqv:"nk-d3-8j3n9.nqzmjiamixx.kwu",libijiamCZT:"pbbxa://nk-d3-8j3n9-lmnictb-zblj.mczwxm-emab1.nqzmjiamlibijiam.ixx",xzwrmkbQl:"nk-d3-8j3n9",abwziomJcksmb:"nk-d3-8j3n9.ixxaxwb.kwu",umaaioqvoAmvlmzQl:"31377888705",ixxQl:"1:31377888705:emj:3018l8nk0i07m867mk0j40"},nu={};for(let[n,e]of Object.entries(Dp))nu[xs.rotx(n,18)]=xs.rotx(e,18);let Lt={armor:"Armor",magicDmg:"Magic",meleeDmg:"Melee",rangedDmg:"Ranged",hpRegen:"HP Regen",endurance:"Endurance",sightRange:"Sight Range",walkSpeed:"Walk Speed",jumpPower:"Jump Power",ammoReturn:"Ammo Return",height:"Height"},Wn=["head","body","legs","feet","neck","back","ring","misc"],gs={name:"",stats:{armor:0,magicDmg:0,meleeDmg:0,rangedDmg:0,hpRegen:0,endurance:0,sightRange:0,walkSpeed:0,jumpPower:0,ammoReturn:0,height:0},cost:{min:0,max:0},image:"",link:""},bs={name:"",info:{type:"",special:""},moves:[],cost:{min:0,max:0},image:"",link:""},Rp={armor:{min:0,avg:0,max:0},gear:{min:0,avg:0,max:0},total:{min:0,avg:0,max:0}},kn=[...Array(5).keys()].map(n=>++n),Hn=kp(Ta(nu)),Ap=["head","body","legs","feet","neck","back","ring","misc","gear","sets","bonuses"],iu={0:"th",1:"st",2:"nd",3:"rd",4:"th",5:"th",6:"th",7:"th",8:"th",9:"th"};function su(n,e){let t=!1;for(let i of[n,e])for(let s in i)if(i[s].name){t=!0;break}lo.set(t),wt.set(null),window.history.replaceState(null,null,location.origin+location.pathname)}function Ho(n,e){let t=2.8,i=e.split(" ").length,s=n.querySelector("span");if(s.style.removeProperty("font-size"),i>2&&e.length/i>=5){for(;s.offsetHeight>n.offsetHeight*.75;)t-=.05,s.style.fontSize=`calc(var(--u) * ${t})`;return t<2.8}return null}function Pp(n,e){let t=2.8,i=n.querySelector("span");for(i.style.removeProperty("font-size");i.offsetWidth>n.offsetWidth;)t-=.05,i.style.fontSize=`calc(var(--u) * ${t})`;for(;i.offsetHeight>n.offsetHeight*.75&&e;)t-=.05,i.style.fontSize=`calc(var(--u) * ${t})`;return t<2.8?t:null}function Mp(n){let e=2.35,t=n.querySelector(".tooltip");for(t.style.removeProperty("font-size");t.offsetHeight>n.offsetHeight*1.125;)e-=.02,t.style.fontSize=`calc(var(--u) * ${e})`}function Lp(n){document.activeElement==document.body&&n.key=="Tab"&&(n.preventDefault(),document.querySelector(`.promptCont [id*='${n.shiftKey?"last":"first"}Focusable']`).focus())}function ou(n,e){let t=n.toLowerCase();for(let i in e)i.toLowerCase().includes(t)&&!e[i].classList.contains("filtered")?e[i].classList.remove("hidden"):e[i].classList.add("hidden")}function xi(n,e){e&&setTimeout(()=>{n.focus(),n.click(),n.select()})}function vt(n){n.shiftKey&&n.key=="Tab"&&n.preventDefault()}function yt(n){n.key=="Tab"&&!n.shiftKey&&n.preventDefault()}function $i(n,e){let t=/[^a-zA-Z0-9~!#$%^&*()\-_+[\]{}\\|;:'",.<>/? ]/g;return n.replace(t,"").replaceAll(`
`,"").replace(/^ /,"").slice(0,e)}function $s(n,e,t){(!n.maxLength||n.maxLength!=t)&&e.length>=t&&(n.maxLength=t)}function ru(n,e){n={...n},e={...e};for(let t of Wn)n[t]?n[t]=n[t].name:n[t]="";for(let t of kn)e[t]?e[t]=e[t].name:e[t]="";return{eq:n,gear:e}}function Uo(){window.history.replaceState(null,null,location.origin+location.pathname+"?ls=true")}function tn(n){n.target.closest("button").blur()}function Fp(n){let e,t,i,s,o,r,l,a,c,u,d,f;return{c(){e=g("li"),t=g("button"),i=g("img"),o=C(),r=g("span"),r.textContent=`${n[5]}`,l=C(),a=g("iconify-icon"),c=C(),u=g("iconify-icon"),$e(i.src,s=n[0].image)||m(i,"src",s),m(i,"alt",""),Pe(a,"icon","maki:cross"),Pe(a,"id","cross"),Pe(u,"icon","eva:info-outline"),Pe(u,"id","info"),te(e,"selectedItem",n[2])},m(_,h){L(_,e,h),p(e,t),p(t,i),p(t,o),p(t,r),p(t,l),p(t,a),p(t,c),p(t,u),n[20](e),d||(f=[sa(n[6].call(null,r)),O(t,"touchstart",n[9],{passive:!0}),O(t,"touchend",n[10],{passive:!0}),O(t,"mousedown",n[9]),O(t,"mouseup",n[10]),O(t,"click",n[15]),O(t,"mouseenter",n[16]),O(t,"focusin",n[17]),O(t,"mouseleave",n[18]),O(t,"focusout",n[19]),O(e,"contextmenu",Bp)],d=!0)},p(_,[h]){h&1&&!$e(i.src,s=_[0].image)&&m(i,"src",s),h&4&&te(e,"selectedItem",_[2])},i:ie,o:ie,d(_){_&&P(e),n[20](null),d=!1,be(f)}}}const Bp=n=>n.preventDefault();function qp(n,e,t){let i,s,o,r,l,a,c;J(n,x,A=>t(4,i=A)),J(n,gt,A=>t(22,s=A)),J(n,Rn,A=>t(23,o=A)),J(n,Pt,A=>t(24,r=A)),J(n,Mt,A=>t(25,l=A)),J(n,zt,A=>t(26,a=A)),J(n,ro,A=>t(27,c=A));let{itemData:u,slotOpen:d,eqSlotName:f,scrolling:_}=e;const h=Wt();let b,v=!1,w=u.name,k,y=0,I;function D(A){setTimeout(()=>{Ho(b,w)&&c.push({node:b,itemName:w})})}function z(A){if(d||!d&&A.isTrusted==!1){h("itemSelect",{element:b,trusted:A.isTrusted}),b.classList.contains("selectedItem")||t(2,v=!1),t(2,v=!v),t(11,d=!1),G(Mt,l[f]=v?u:gs,l),su(l,a);for(let M of Object.keys(Lt)){G(gt,s[M]=0,s);for(let H in l)l[H].noStats||(G(gt,s[M]+=l[H].stats[M],s),G(gt,s[M]=Math.round(s[M]*10)/10,s))}for(let M of r.bonuses)if(o[M.name])for(let H in s)G(gt,s[H]+=M.stats[H],s),G(gt,s[H]=Math.round(s[H]*10)/10,s)}}function S(){_||(G(x,i.item.ongoing=!0,i),G(x,i.item.data={...u,slot:f,type:"eq",element:b},i))}function j(){I=setInterval(()=>t(14,y+=50),50)}function B(){clearInterval(I),y>=750&&S(),t(14,y=0)}const Q=A=>{A.shiftKey?S():i.item.ongoing||z(A)},N=()=>t(3,k=!0),E=()=>t(3,k=!0),T=()=>t(3,k=!1),$=()=>t(3,k=!1);function R(A){re[A?"unshift":"push"](()=>{b=A,t(1,b)})}return n.$$set=A=>{"itemData"in A&&t(0,u=A.itemData),"slotOpen"in A&&t(11,d=A.slotOpen),"eqSlotName"in A&&t(12,f=A.eqSlotName),"scrolling"in A&&t(13,_=A.scrolling)},n.$$.update=()=>{n.$$.dirty&16384&&y==750&&h("displayInfo")},[u,b,v,k,i,w,D,z,S,j,B,d,f,_,y,Q,N,E,T,$,R]}class zp extends Ae{constructor(e){super(),Re(this,e,qp,Fp,ge,{itemData:0,slotOpen:11,eqSlotName:12,scrolling:13})}}function jp(n){let e,t,i,s,o,r,l,a,c,u,d,f,_,h,b;return{c(){e=g("li"),t=g("button"),i=g("img"),o=C(),r=g("span"),r.textContent=`${n[6]}`,l=C(),a=g("iconify-icon"),d=C(),f=g("iconify-icon"),$e(i.src,s=n[0].image)||m(i,"src",s),m(i,"alt",""),Pe(a,"icon",c=n[5]?"heroicons-solid:switch-vertical":"maki:cross"),Pe(a,"id",u=n[5]?"switchable":"cross"),Pe(f,"icon","eva:info-outline"),Pe(f,"id","info"),t.disabled=_=!n[4]&&!n[5],te(e,"selectedItem",n[1]),te(e,"non-eligible",!n[4]&&!n[5]),te(e,"switchable",n[5])},m(v,w){L(v,e,w),p(e,t),p(t,i),p(t,o),p(t,r),p(t,l),p(t,a),p(t,d),p(t,f),n[19](e),h||(b=[sa(n[7].call(null,r)),O(t,"touchstart",n[10],{passive:!0}),O(t,"touchend",n[11],{passive:!0}),O(t,"mousedown",n[10]),O(t,"mouseup",n[11]),O(t,"click",n[18]),O(e,"contextmenu",Wp)],h=!0)},p(v,[w]){w&1&&!$e(i.src,s=v[0].image)&&m(i,"src",s),w&32&&c!==(c=v[5]?"heroicons-solid:switch-vertical":"maki:cross")&&Pe(a,"icon",c),w&32&&u!==(u=v[5]?"switchable":"cross")&&Pe(a,"id",u),w&48&&_!==(_=!v[4]&&!v[5])&&(t.disabled=_),w&2&&te(e,"selectedItem",v[1]),w&48&&te(e,"non-eligible",!v[4]&&!v[5]),w&32&&te(e,"switchable",v[5])},i:ie,o:ie,d(v){v&&P(e),n[19](null),h=!1,be(b)}}}const Wp=n=>n.preventDefault();function Hp(n,e,t){let i,s,o,r,l;J(n,zt,T=>t(17,i=T)),J(n,x,T=>t(2,s=T)),J(n,Mt,T=>t(21,o=T)),J(n,Fn,T=>t(22,r=T)),J(n,ro,T=>t(23,l=T));let{itemData:a,slotOpen:c,index:u,weaponExpand:d,scrolling:f}=e;const _=Wt();let h,b=!1,v=!0,w=!1,k=a.name,y=0,I,D={"Orange Salamander":["Green Salamander","Purple Salamander"],"Green Salamander":["Orange Salamander","Purple Salamander"],"Purple Salamander":["Orange Salamander","Green Salamander"],"White Salamander":["Black Salamander","Gold Salamander"],"Black Salamander":["White Salamander","Gold Salamander"],"Gold Salamander":["White Salamander","Black Salamander"]};function z(T){setTimeout(()=>{Ho(h,k)&&l.push({node:h,itemName:k})})}function S(T){v&&(c||!c&&T.isTrusted==!1)&&(a.tool&&d&&_("toolSelect"),_("itemSelect",{element:h,trusted:T.isTrusted}),h.classList.contains("selectedItem")||t(1,b=!1),t(12,c=!1),w?setTimeout(()=>{r[u][k].querySelector("button").click(),r[Object.keys(i).find($=>i[$].name==k)][i[u]&&i[u].name?i[u].name:k].querySelector("button").click(),t(4,v=!0),t(5,w=!1)},5):(t(1,b=!b),G(zt,i[u]=b?a:bs,i)),su(o,i))}function j(){f||(G(x,s.item.ongoing=!0,s),G(x,s.item.data={...a,type:"gear",element:h},s))}function B(){I=setInterval(()=>t(16,y+=50),50)}function Q(){clearInterval(I),y>=750&&j(),t(16,y=0)}const N=T=>{T.shiftKey?j():s.item.ongoing||S(T)};function E(T){re[T?"unshift":"push"](()=>{h=T,t(3,h)})}return n.$$set=T=>{"itemData"in T&&t(0,a=T.itemData),"slotOpen"in T&&t(12,c=T.slotOpen),"index"in T&&t(13,u=T.index),"weaponExpand"in T&&t(14,d=T.weaponExpand),"scrolling"in T&&t(15,f=T.scrolling)},n.$$.update=()=>{if(n.$$.dirty&155650&&i)for(let T in i){if(!d&&T!=u&&i[T].name==k){t(5,w=!0);break}if(T!=u&&D[i[T].name]&&D[i[T].name].includes(k)){t(4,v=!1);break}else b||t(4,v=!0)}if(n.$$.dirty&139268)if(s.randomize.ongoing)t(5,w=!1);else for(let T in i)if(T!=u&&i[T].name==k){t(5,w=!0);break}else t(5,w=!1);n.$$.dirty&65536&&y==750&&_("displayInfo")},[a,b,s,h,v,w,k,z,S,j,B,Q,c,u,d,f,y,i,N,E]}class Up extends Ae{constructor(e){super(),Re(this,e,Hp,jp,ge,{itemData:0,slotOpen:12,index:13,weaponExpand:14,scrolling:15})}}function Gp(n){const e=n-1;return e*e*e+1}function Je(n,{delay:e=0,duration:t=400,easing:i=es}={}){const s=+getComputedStyle(n).opacity;return{delay:e,duration:t,easing:i,css:o=>`opacity: ${o*s}`}}function Ze(n,{delay:e=0,duration:t=400,easing:i=Gp,start:s=0,opacity:o=0}={}){const r=getComputedStyle(n),l=+r.opacity,a=r.transform==="none"?"":r.transform,c=1-s,u=l*(1-o);return{delay:e,duration:t,easing:i,css:(d,f)=>`
			transform: ${a} scale(${1-c*f});
			opacity: ${l-u*f}
		`}}function jr(n){let e,t,i,s;return{c(){e=g("img"),$e(e.src,t=n[5][n[3]])||m(e,"src",t),m(e,"alt","")},m(o,r){L(o,e,r),s=!0},p(o,r){(!s||r&8&&!$e(e.src,t=o[5][o[3]]))&&m(e,"src",t)},i(o){s||(o&&ye(()=>{s&&(i||(i=me(e,Je,{duration:150},!0)),i.run(1))}),s=!0)},o(o){o&&(i||(i=me(e,Je,{duration:150},!1)),i.run(0)),s=!1},d(o){o&&P(e),o&&i&&i.end()}}}function Vp(n){let e,t,i=n[5][n[3]],s,o,r=n[0].name+"",l,a,c,u=jr(n);return{c(){e=g("li"),t=g("button"),u.c(),s=C(),o=g("span"),l=ae(r),te(e,"selectedItem",n[4])},m(d,f){L(d,e,f),p(e,t),u.m(t,null),p(t,s),p(t,o),p(o,l),n[8](e),a||(c=[O(t,"click",n[6]),O(e,"mouseenter",n[9]),O(e,"focusin",n[10]),O(e,"mouseleave",n[11]),O(e,"focusout",n[12])],a=!0)},p(d,[f]){f&8&&ge(i,i=d[5][d[3]])?(We(),W(u,1,1,ie),He(),u=jr(d),u.c(),F(u,1),u.m(t,s)):u.p(d,f),f&1&&r!==(r=d[0].name+"")&&Te(l,r)},i(d){F(u)},o(d){W(u)},d(d){d&&P(e),u.d(d),n[8](null),a=!1,be(c)}}}function Kp(n,e,t){let i,s,o;J(n,Ln,j=>t(14,i=j)),J(n,Mt,j=>t(15,s=j)),J(n,Pt,j=>t(16,o=j));let{itemData:r,ddOpen:l=!1}=e;const a=Wt();let c,u=!1,d=!1,f,_=0,h=r.pieces.length,b=[];for(let j of r.pieces)e:for(let B of Wn)for(let Q of o[B])if(Q.name==j){b.push(B);break e}let v=[];for(let j=0;j<h;j++)v.push(o[b[j]].find(B=>B.name==r.pieces[j]).image);function w(){d?f=setInterval(()=>{t(3,_++,_),_==h&&t(3,_=0)},750):(clearInterval(f),t(3,_=0))}function k(){a("setSelect");let j=0;for(let B=0;B<h;B++)!s[b[B]]||s[b[B]].name!=r.pieces[B]?i[b[B]][r.pieces[B]].querySelector("button").click():j++;j!=h&&t(7,l=!1)}function y(j){re[j?"unshift":"push"](()=>{c=j,t(2,c)})}const I=()=>t(1,d=!0),D=()=>t(1,d=!0),z=()=>t(1,d=!1),S=()=>t(1,d=!1);return n.$$set=j=>{"itemData"in j&&t(0,r=j.itemData),"ddOpen"in j&&t(7,l=j.ddOpen)},n.$$.update=()=>{n.$$.dirty&2&&(d||!d)&&w()},[r,d,c,_,u,v,k,l,y,I,D,z,S]}class Yp extends Ae{constructor(e){super(),Re(this,e,Kp,Vp,ge,{itemData:0,ddOpen:7})}}const Qp=n=>({}),Wr=n=>({});function Xp(n){let e,t,i,s,o,r,l,a,c;const u=n[8].tooltip,d=fu(u,n,n[7],Wr);return{c(){e=g("div"),t=g("span"),i=C(),s=g("input"),r=C(),d&&d.c(),m(s,"id",o=n[2]?"firstFocusable":n[3]?"lastFocusable":""),s.disabled=n[4],m(s,"type","checkbox"),s.checked=n[1],m(s,"class","svelte-1oscat4"),m(e,"class","toggleCont svelte-1oscat4"),te(e,"unavailable",n[4])},m(f,_){L(f,e,_),p(e,t),t.innerHTML=n[0],p(e,i),p(e,s),p(e,r),d&&d.m(e,null),l=!0,a||(c=[O(s,"change",n[9]),O(s,"keydown",n[10])],a=!0)},p(f,[_]){(!l||_&1)&&(t.innerHTML=f[0]),(!l||_&12&&o!==(o=f[2]?"firstFocusable":f[3]?"lastFocusable":""))&&m(s,"id",o),(!l||_&16)&&(s.disabled=f[4]),(!l||_&2)&&(s.checked=f[1]),d&&d.p&&(!l||_&128)&&_u(d,u,f,f[7],l?hu(u,f[7],_,Qp):pu(f[7]),Wr),(!l||_&16)&&te(e,"unavailable",f[4])},i(f){l||(F(d,f),l=!0)},o(f){W(d,f),l=!1},d(f){f&&P(e),d&&d.d(f),a=!1,be(c)}}}function Jp(n,e,t){let{$$slots:i={},$$scope:s}=e,{text:o,checked:r=!1,first:l=!1,last:a=!1,disabled:c=!1,forced:u=!1}=e;const d=Wt(),f=h=>{h.target.blur(),u?h.target.checked=!0:d("toggle",h.target.checked)},_=h=>{l&&vt(h),a&&yt(h),h.key=="Enter"&&!u?(h.target.checked=!h.target.checked,d("toggle",h.target.checked)):u&&(h.target.checked=!0)};return n.$$set=h=>{"text"in h&&t(0,o=h.text),"checked"in h&&t(1,r=h.checked),"first"in h&&t(2,l=h.first),"last"in h&&t(3,a=h.last),"disabled"in h&&t(4,c=h.disabled),"forced"in h&&t(5,u=h.forced),"$$scope"in h&&t(7,s=h.$$scope)},[o,r,l,a,c,u,d,s,i,f,_]}class mt extends Ae{constructor(e){super(),Re(this,e,Jp,Xp,ge,{text:0,checked:1,first:2,last:3,disabled:4,forced:5})}}function Hr(n,e,t){const i=n.slice();return i[28]=e[t][0],i[29]=e[t][1],i}function Ur(n,e,t){const i=n.slice();return i[28]=e[t][0],i[29]=e[t][1],i}function Gr(n){let e,t;function i(...s){return n[19](n[28],...s)}return e=new mt({props:{text:n[29],checked:n[6][n[28]]}}),e.$on("toggle",i),{c(){le(e.$$.fragment)},m(s,o){se(e,s,o),t=!0},p(s,o){n=s;const r={};o[0]&64&&(r.checked=n[6][n[28]]),e.$set(r)},i(s){t||(F(e.$$.fragment,s),t=!0)},o(s){W(e.$$.fragment,s),t=!1},d(s){oe(e,s)}}}function Zp(n){let e,t,i,s,o,r,l,a,c;s=new mt({props:{text:"Descension",checked:n[4],forced:n[4]}}),s.$on("toggle",n[20]),r=new mt({props:{text:"Ascension",checked:n[5],forced:n[5]}}),r.$on("toggle",n[21]);let u=De(Object.entries(n[9])),d=[];for(let _=0;_<u.length;_+=1)d[_]=Vr(Hr(n,u,_));const f=_=>W(d[_],1,1,()=>{d[_]=null});return{c(){e=g("p"),e.textContent="Sort",t=C(),i=g("div"),le(s.$$.fragment),o=C(),le(r.$$.fragment),l=C(),a=g("div");for(let _=0;_<d.length;_+=1)d[_].c();m(e,"id","title"),m(e,"class","svelte-1jaojxl"),m(i,"class","radio ttFocus svelte-1jaojxl"),m(i,"id","sort"),m(a,"class","options svelte-1jaojxl")},m(_,h){L(_,e,h),L(_,t,h),L(_,i,h),se(s,i,null),p(i,o),se(r,i,null),L(_,l,h),L(_,a,h);for(let b=0;b<d.length;b+=1)d[b]&&d[b].m(a,null);c=!0},p(_,h){const b={};h[0]&16&&(b.checked=_[4]),h[0]&16&&(b.forced=_[4]),s.$set(b);const v={};if(h[0]&32&&(v.checked=_[5]),h[0]&32&&(v.forced=_[5]),r.$set(v),h[0]&1664){u=De(Object.entries(_[9]));let w;for(w=0;w<u.length;w+=1){const k=Hr(_,u,w);d[w]?(d[w].p(k,h),F(d[w],1)):(d[w]=Vr(k),d[w].c(),F(d[w],1),d[w].m(a,null))}for(We(),w=u.length;w<d.length;w+=1)f(w);He()}},i(_){if(!c){F(s.$$.fragment,_),F(r.$$.fragment,_);for(let h=0;h<u.length;h+=1)F(d[h]);c=!0}},o(_){W(s.$$.fragment,_),W(r.$$.fragment,_),d=d.filter(Boolean);for(let h=0;h<d.length;h+=1)W(d[h]);c=!1},d(_){_&&(P(e),P(t),P(i),P(l),P(a)),oe(s),oe(r),ft(d,_)}}}function Vr(n){let e,t;function i(...s){return n[22](n[28],...s)}return e=new mt({props:{text:n[29],checked:n[7][n[28]],last:n[28]=="none"||n[28]=="tool"}}),e.$on("toggle",i),{c(){le(e.$$.fragment)},m(s,o){se(e,s,o),t=!0},p(s,o){n=s;const r={};o[0]&128&&(r.checked=n[7][n[28]]),e.$set(r)},i(s){t||(F(e.$$.fragment,s),t=!0)},o(s){W(e.$$.fragment,s),t=!1},d(s){oe(e,s)}}}function xp(n){let e,t,i,s,o,r,l,a,c,u,d,f,_,h,b,v,w,k,y,I,D,z,S;r=new mt({props:{text:"Inclusive",checked:n[1],forced:n[1]}}),r.$on("toggle",n[14]),a=new mt({props:{text:"Exclusive",checked:n[2],forced:n[2]}}),a.$on("toggle",n[15]),u=new mt({props:{text:"Strict",checked:n[3],forced:n[3]}}),u.$on("toggle",n[16]);let j=De(Object.entries(n[9])),B=[];for(let E=0;E<j.length;E+=1)B[E]=Gr(Ur(n,j,E));const Q=E=>W(B[E],1,1,()=>{B[E]=null});let N=!n[8]&&Zp(n);return{c(){e=g("div"),t=g("div"),i=g("p"),i.innerHTML=`Filter
            <span class="tooltip svelte-1jaojxl" id="bottom">Inclusive: Equipment that includes the selected search types
                <br/> <br/>
                Exclusive: Equipment that does not include the selected search types
                <br/> <br/>
                Strict: Equipment that includes the selected search types and no
                others</span> <iconify-icon icon="eva:info-outline"></iconify-icon>`,s=C(),o=g("div"),le(r.$$.fragment),l=C(),le(a.$$.fragment),c=C(),le(u.$$.fragment),d=C(),f=g("div"),_=g("div"),h=g("button"),h.textContent="Select all",b=C(),v=g("div"),w=g("button"),w.textContent="Clear all",k=C(),y=g("div");for(let E=0;E<B.length;E+=1)B[E].c();I=C(),N&&N.c(),m(i,"id","title"),m(i,"class","svelte-1jaojxl"),m(o,"class","radio ttFocus svelte-1jaojxl"),m(o,"id","filter"),m(h,"class","svelte-1jaojxl"),m(_,"class","svelte-1jaojxl"),m(w,"class","svelte-1jaojxl"),m(v,"class","svelte-1jaojxl"),m(f,"class","optionsAll svelte-1jaojxl"),m(y,"class","options svelte-1jaojxl"),m(t,"class","searchOptions svelte-1jaojxl"),m(e,"class","searchOptionsCont svelte-1jaojxl"),te(e,"optionsOpen",n[0])},m(E,T){L(E,e,T),p(e,t),p(t,i),p(t,s),p(t,o),se(r,o,null),p(o,l),se(a,o,null),p(o,c),se(u,o,null),p(t,d),p(t,f),p(f,_),p(_,h),p(f,b),p(f,v),p(v,w),p(t,k),p(t,y);for(let $=0;$<B.length;$+=1)B[$]&&B[$].m(y,null);p(t,I),N&&N.m(t,null),D=!0,z||(S=[O(h,"click",n[17]),O(w,"click",n[18])],z=!0)},p(E,T){const $={};T[0]&2&&($.checked=E[1]),T[0]&2&&($.forced=E[1]),r.$set($);const R={};T[0]&4&&(R.checked=E[2]),T[0]&4&&(R.forced=E[2]),a.$set(R);const A={};if(T[0]&8&&(A.checked=E[3]),T[0]&8&&(A.forced=E[3]),u.$set(A),T[0]&1600){j=De(Object.entries(E[9]));let M;for(M=0;M<j.length;M+=1){const H=Ur(E,j,M);B[M]?(B[M].p(H,T),F(B[M],1)):(B[M]=Gr(H),B[M].c(),F(B[M],1),B[M].m(y,null))}for(We(),M=j.length;M<B.length;M+=1)Q(M);He()}E[8]||N.p(E,T),(!D||T[0]&1)&&te(e,"optionsOpen",E[0])},i(E){if(!D){F(r.$$.fragment,E),F(a.$$.fragment,E),F(u.$$.fragment,E);for(let T=0;T<j.length;T+=1)F(B[T]);F(N),D=!0}},o(E){W(r.$$.fragment,E),W(a.$$.fragment,E),W(u.$$.fragment,E),B=B.filter(Boolean);for(let T=0;T<B.length;T+=1)W(B[T]);W(N),D=!1},d(E){E&&P(e),oe(r),oe(a),oe(u),ft(B,E),N&&N.d(),z=!1,be(S)}}}function $p(n,e,t){let i;J(n,Pt,R=>t(24,i=R));let{optionsOpen:s,slotName:o,elementData:r,list:l}=e;const a=Wt();let c=o=="gear",u=!0,d=!1,f=!1,_=!0,h=!1,b={},v={},w=c?{armor:"Armor",magicDmg:"Magic",meleeDmg:"Melee",rangedDmg:"Ranged",unique:"Unique",tool:"Tool"}:{...Lt,none:"No Stats"};for(let R of Object.keys(w))b[R]=!0;for(let R of Object.keys(w))v[R]=!1;let k=["Void Spike Ultradagger","Pureblood Dagger","Gnome Rocket Launcher"],y=[];function I(R){setTimeout(()=>{for(let A in r){let M=i[o].find(ne=>ne.name==A),H={...Lt},X={armor:!1,magicDmg:!1,meleeDmg:!1,rangedDmg:!1,unique:!1,tool:!1},he=c?X:H,ce=!1;if(c)if(!M.tool&&!k.includes(M.name)){for(let ne in b)for(let q of M.moves)if(X[ne]=q.type.includes(ne),X[ne])break}else X.tool=!!M.tool,X.tool||(X.unique=M.info.type=="Unique",M.name=="Void Spike Ultradagger"&&(X.armor=!0,X.meleeDmg=!0));else{for(let ne in b)H[ne]=M.stats[ne]!=0;H.none=!!M.noStats}if(u)for(let ne in he)if(b[ne]&&he[ne]){ce=!1;break}else ce=!0;else if(d)for(let ne in he)if(b[ne]&&he[ne]){ce=!0;break}else ce=!1;else if(f)for(let ne in he)if(b[ne]&&he[ne]||!b[ne]&&!he[ne])ce=!1;else{ce=!0;break}ce?r[A].classList.add("hidden","filtered"):r[A].classList.remove("hidden","filtered")}if(R=="sort"){let A=Object.keys(v).find(H=>v[H]),M=0;for(A&&!(A=="none"||A=="tool")?(y.sort((H,X)=>{let he=D(H,X,!0).stats[A]-D(H,X,!1).stats[A];return M||(M=he),he}),M||(y=Object.values(r))):!A&&h&&(y=Object.values(r).toReversed()),A=="none"&&(y=[...Object.entries(r).filter(H=>i[o].find(X=>X.name==H[0]).noStats),...Object.entries(r).filter(H=>!i[o].find(X=>X.name==H[0]).noStats)],y=y.map(H=>H[1]),h&&y.reverse());l.lastElementChild;)l.removeChild(l.lastElementChild);if(A||!A&&h)for(let H of y)l.appendChild(H);else for(let H in r)l.appendChild(r[H])}a("listUpdate")})}function D(R,A,M){return i[o].find(H=>H.name==Object.keys(r).find(X=>r[X]===(_?M?A:R:M?R:A)))}const z=R=>{t(1,u=R.detail),R.detail&&(t(2,d=!1),t(3,f=!1)),I("filter")},S=R=>{t(2,d=R.detail),R.detail&&(t(1,u=!1),t(3,f=!1)),I("filter")},j=R=>{t(3,f=R.detail),R.detail&&(t(1,u=!1),t(2,d=!1)),I("filter")},B=R=>{R.target.blur();for(let A in b)t(6,b[A]=!0,b);I("filter")},Q=R=>{R.target.blur();for(let A in b)t(6,b[A]=!1,b);I("filter")},N=(R,A)=>{t(6,b[R]=A.detail,b),I("filter")},E=R=>{t(4,_=R.detail),R.detail&&t(5,h=!1),I("sort")},T=R=>{t(5,h=R.detail),R.detail&&t(4,_=!1),I("sort")},$=(R,A)=>{if(t(7,v[R]=A.detail,v),A.detail)for(let M in v)M!=R&&t(7,v[M]=!1,v);I("sort")};return n.$$set=R=>{"optionsOpen"in R&&t(0,s=R.optionsOpen),"slotName"in R&&t(11,o=R.slotName),"elementData"in R&&t(12,r=R.elementData),"list"in R&&t(13,l=R.list)},n.$$.update=()=>{n.$$.dirty[0]&8192&&l&&(y=[...l.children])},[s,u,d,f,_,h,b,v,c,w,I,o,r,l,z,S,j,B,Q,N,E,T,$]}class em extends Ae{constructor(e){super(),Re(this,e,$p,xp,ge,{optionsOpen:0,slotName:11,elementData:12,list:13},null,[-1,-1])}}function Kr(n,e,t){const i=n.slice();return i[61]=e[t],i}function tm(n){let e;return{c(){e=g("span"),e.textContent="Loading items...",m(e,"class","svelte-suojz2")},m(t,i){L(t,e,i)},p:ie,i:ie,o:ie,d(t){t&&P(e)}}}function nm(n){let e,t,i,s,o,r,l,a=n[3]!="sets"&&Yr(n),c=De(n[6]),u=[];for(let f=0;f<c.length;f+=1)u[f]=Qr(Kr(n,c,f));const d=f=>W(u[f],1,1,()=>{u[f]=null});return{c(){e=g("input"),t=C(),a&&a.c(),i=C(),s=g("ul");for(let f=0;f<u.length;f+=1)u[f].c();m(e,"type","text"),m(e,"class","searchBarInput"),m(e,"placeholder","Search..."),m(s,"class","svelte-suojz2"),te(s,"no-scrollbar",n[15].length<=4)},m(f,_){L(f,e,_),n[29](e),L(f,t,_),a&&a.m(f,_),L(f,i,_),L(f,s,_);for(let h=0;h<u.length;h+=1)u[h]&&u[h].m(s,null);n[42](s),o=!0,r||(l=[O(e,"keydown",n[18]),O(e,"input",n[19]),O(s,"mouseup",n[43]),O(s,"touchend",n[44],{passive:!0}),O(s,"scroll",n[45]),O(s,"scrollend",n[46])],r=!0)},p(f,_){if(f[3]!="sets"?a?a.p(f,_):(a=Yr(f),a.c(),a.m(i.parentNode,i)):a&&(a.d(1),a=null),_[0]&1197019){c=De(f[6]);let h;for(h=0;h<c.length;h+=1){const b=Kr(f,c,h);u[h]?(u[h].p(b,_),F(u[h],1)):(u[h]=Qr(b),u[h].c(),F(u[h],1),u[h].m(s,null))}for(We(),h=c.length;h<u.length;h+=1)d(h);He()}(!o||_[0]&32768)&&te(s,"no-scrollbar",f[15].length<=4)},i(f){if(!o){for(let _=0;_<c.length;_+=1)F(u[_]);o=!0}},o(f){u=u.filter(Boolean);for(let _=0;_<u.length;_+=1)W(u[_]);o=!1},d(f){f&&(P(e),P(t),P(i),P(s)),n[29](null),a&&a.d(f),ft(u,f),n[42](null),r=!1,be(l)}}}function Yr(n){let e,t,i;return{c(){e=g("button"),e.innerHTML='<iconify-icon icon="mi:filter"></iconify-icon>',m(e,"class","optionsButton svelte-suojz2")},m(s,o){L(s,e,o),n[30](e),t||(i=O(e,"click",n[31]),t=!0)},p:ie,d(s){s&&P(e),n[30](null),t=!1,i()}}}function im(n){let e,t,i,s;function o(a){n[39](a)}function r(a){n[40](a)}let l={itemData:n[61],eqSlotName:n[3]};return n[0]!==void 0&&(l.slotOpen=n[0]),n[9]!==void 0&&(l.scrolling=n[9]),e=new zp({props:l}),re.push(()=>Le(e,"slotOpen",o)),re.push(()=>Le(e,"scrolling",r)),e.$on("itemSelect",n[20]),e.$on("displayInfo",n[41]),{c(){le(e.$$.fragment)},m(a,c){se(e,a,c),s=!0},p(a,c){const u={};c[0]&64&&(u.itemData=a[61]),c[0]&8&&(u.eqSlotName=a[3]),!t&&c[0]&1&&(t=!0,u.slotOpen=a[0],Me(()=>t=!1)),!i&&c[0]&512&&(i=!0,u.scrolling=a[9],Me(()=>i=!1)),e.$set(u)},i(a){s||(F(e.$$.fragment,a),s=!0)},o(a){W(e.$$.fragment,a),s=!1},d(a){oe(e,a)}}}function sm(n){let e,t,i;function s(r){n[37](r)}let o={itemData:n[61]};return n[0]!==void 0&&(o.ddOpen=n[0]),e=new Yp({props:o}),re.push(()=>Le(e,"ddOpen",s)),e.$on("setSelect",n[38]),{c(){le(e.$$.fragment)},m(r,l){se(e,r,l),i=!0},p(r,l){const a={};l[0]&64&&(a.itemData=r[61]),!t&&l[0]&1&&(t=!0,a.ddOpen=r[0],Me(()=>t=!1)),e.$set(a)},i(r){i||(F(e.$$.fragment,r),i=!0)},o(r){W(e.$$.fragment,r),i=!1},d(r){oe(e,r)}}}function om(n){let e,t,i,s,o;function r(u){n[32](u)}function l(u){n[33](u)}function a(u){n[34](u)}let c={itemData:n[61],index:n[4]};return n[0]!==void 0&&(c.slotOpen=n[0]),n[1]!==void 0&&(c.weaponExpand=n[1]),n[9]!==void 0&&(c.scrolling=n[9]),e=new Up({props:c}),re.push(()=>Le(e,"slotOpen",r)),re.push(()=>Le(e,"weaponExpand",l)),re.push(()=>Le(e,"scrolling",a)),e.$on("itemSelect",n[20]),e.$on("toolSelect",n[35]),e.$on("displayInfo",n[36]),{c(){le(e.$$.fragment)},m(u,d){se(e,u,d),o=!0},p(u,d){const f={};d[0]&64&&(f.itemData=u[61]),d[0]&16&&(f.index=u[4]),!t&&d[0]&1&&(t=!0,f.slotOpen=u[0],Me(()=>t=!1)),!i&&d[0]&2&&(i=!0,f.weaponExpand=u[1],Me(()=>i=!1)),!s&&d[0]&512&&(s=!0,f.scrolling=u[9],Me(()=>s=!1)),e.$set(f)},i(u){o||(F(e.$$.fragment,u),o=!0)},o(u){W(e.$$.fragment,u),o=!1},d(u){oe(e,u)}}}function Qr(n){let e,t,i,s;const o=[om,sm,im],r=[];function l(a,c){return a[4]?0:a[3]=="sets"?1:2}return e=l(n),t=r[e]=o[e](n),{c(){t.c(),i=_t()},m(a,c){r[e].m(a,c),L(a,i,c),s=!0},p(a,c){let u=e;e=l(a),e===u?r[e].p(a,c):(We(),W(r[u],1,1,()=>{r[u]=null}),He(),t=r[e],t?t.p(a,c):(t=r[e]=o[e](a),t.c()),F(t,1),t.m(i.parentNode,i))},i(a){s||(F(t),s=!0)},o(a){W(t),s=!1},d(a){a&&P(i),r[e].d(a)}}}function Xr(n){let e,t,i,s;function o(a){n[47](a)}function r(a){n[48](a)}let l={slotName:n[3],elementData:n[16]};return n[2]!==void 0&&(l.optionsOpen=n[2]),n[5]!==void 0&&(l.list=n[5]),e=new em({props:l}),re.push(()=>Le(e,"optionsOpen",o)),re.push(()=>Le(e,"list",r)),e.$on("listUpdate",n[19]),{c(){le(e.$$.fragment)},m(a,c){se(e,a,c),s=!0},p(a,c){const u={};c[0]&8&&(u.slotName=a[3]),c[0]&65536&&(u.elementData=a[16]),!t&&c[0]&4&&(t=!0,u.optionsOpen=a[2],Me(()=>t=!1)),!i&&c[0]&32&&(i=!0,u.list=a[5],Me(()=>i=!1)),e.$set(u)},i(a){s||(F(e.$$.fragment,a),s=!0)},o(a){W(e.$$.fragment,a),s=!1},d(a){oe(e,a)}}}function rm(n){let e,t,i,s,o,r,l;const a=[nm,tm],c=[];function u(f,_){return f[6]?0:1}t=u(n),i=c[t]=a[t](n);let d=n[3]!="sets"&&Xr(n);return{c(){e=g("div"),i.c(),s=C(),d&&d.c(),m(e,"class","dropdown svelte-suojz2"),te(e,"infoDisplay",n[7])},m(f,_){L(f,e,_),c[t].m(e,null),p(e,s),d&&d.m(e,null),n[49](e),o=!0,r||(l=[O(window,"keydown",n[26]),O(window,"keyup",n[27]),O(window,"mousedown",n[28]),O(e,"transitionend",n[50]),O(e,"transitioncancel",n[51])],r=!0)},p(f,_){let h=t;t=u(f),t===h?c[t].p(f,_):(We(),W(c[h],1,1,()=>{c[h]=null}),He(),i=c[t],i?i.p(f,_):(i=c[t]=a[t](f),i.c()),F(i,1),i.m(e,s)),f[3]!="sets"?d?(d.p(f,_),_[0]&8&&F(d,1)):(d=Xr(f),d.c(),F(d,1),d.m(e,null)):d&&(We(),W(d,1,1,()=>{d=null}),He()),(!o||_[0]&128)&&te(e,"infoDisplay",f[7])},i(f){o||(F(i),F(d),o=!0)},o(f){W(i),W(d),o=!1},d(f){f&&P(e),c[t].d(),d&&d.d(),n[49](null),r=!1,be(l)}}}function lm(n,e,t){let i,s,o,r,l,a,c,u,d;J(n,Pt,Y=>t(22,o=Y)),J(n,Ln,Y=>t(23,r=Y)),J(n,Pu,Y=>t(24,l=Y)),J(n,Fn,Y=>t(25,a=Y)),J(n,It,Y=>t(54,c=Y)),J(n,zt,Y=>t(55,u=Y)),J(n,Mt,Y=>t(56,d=Y));let{slotName:f,index:_=0,slotOpen:h,weaponExpand:b=null,optionsOpen:v=!1}=e;const w=Wt();_?G(Fn,a[_]={},a):G(Ln,r[f]={},r);let k=!1,y=!1,I=!1,D,z,S,j,B,Q=null,N=!1,E=!1,T=[];function $(){B&&B.classList.remove("lastElement"),t(15,T=S.querySelectorAll("li:not(.hidden)")),B=T[T.length-1],B&&B.classList.add("lastElement"),(!B||B.classList.contains("non-eligible"))&&(B=j)}function R(Y){!Y.shiftKey&&Y.key=="Tab"&&!v&&(Y.preventDefault(),setTimeout(()=>z.focus()))}function A(){B&&B.removeEventListener("keydown",R),$(),B&&B.addEventListener("keydown",R)}function M(Y){Y.shiftKey&&Y.key=="Tab"&&(Y.preventDefault(),setTimeout(()=>(B.querySelector("button")||B).focus()))}function H(){ou(z.value,i),A()}function X(Y){w("itemSelect",Y.detail.element),t(13,Q=Y.detail.element),N=Y.detail.trusted;let ut=S.querySelector(".selectedItem");ut&&ut!=Y.detail.element&&ut.classList.remove("selectedItem"),t(14,E=!0),N||(ce(),S.scrollTo(0,Q.offsetTop)),setTimeout(he)}function he(){G(It,c=structuredClone(Rp),c);for(let Y in d)d[Y].cost.min!=null&&(G(It,c.armor.min+=d[Y].cost.min,c),G(It,c.armor.max+=d[Y].cost.max,c));G(It,c.armor.avg=Math.ceil((c.armor.min+c.armor.max)/2),c);for(let Y in u)u[Y].cost.min!=null&&(G(It,c.gear.min+=u[Y].cost.min,c),G(It,c.gear.max+=u[Y].cost.max,c));G(It,c.gear.avg=Math.ceil((c.gear.min+c.gear.max)/2),c),G(It,c.total.min=c.armor.min+c.gear.min,c),G(It,c.total.max=c.armor.max+c.gear.max,c),G(It,c.total.avg=Math.ceil((c.total.min+c.total.max)/2),c)}function ce(){t(14,E=!1),t(11,z.value="",z),H()}const ne=Y=>{f!="sets"&&!k&&Y.shiftKey&&t(7,k=!0)},q=Y=>{f!="sets"&&Y.key=="Shift"&&!y&&t(7,k=!1)},Z=()=>(t(7,k=!1),t(8,y=!1));function ue(Y){re[Y?"unshift":"push"](()=>{z=Y,t(11,z)})}function Ee(Y){re[Y?"unshift":"push"](()=>{j=Y,t(12,j)})}const Se=()=>t(2,v=!v);function ze(Y){h=Y,t(0,h)}function ct(Y){b=Y,t(1,b)}function de(Y){I=Y,t(9,I)}const je=()=>w("toolSelect"),tt=()=>(t(7,k=!0),t(8,y=!0));function fe(Y){h=Y,t(0,h)}const Ue=()=>t(14,E=!0);function Ve(Y){h=Y,t(0,h)}function nt(Y){I=Y,t(9,I)}const V=()=>(t(7,k=!0),t(8,y=!0));function Ne(Y){re[Y?"unshift":"push"](()=>{S=Y,t(5,S)})}const ve=()=>t(7,k=!1),U=()=>t(7,k=!1),pe=()=>t(9,I=!0),Oe=()=>t(9,I=!1);function qe(Y){v=Y,t(2,v)}function Fe(Y){S=Y,t(5,S)}function Tt(Y){re[Y?"unshift":"push"](()=>{D=Y,t(10,D)})}const ht=Y=>{Y.propertyName=="visibility"&&Y.target==D&&(E&&ce(),!h&&Q&&setTimeout(()=>S.scrollTo(0,Q.offsetTop)),xi(z,h))},cn=Y=>{Y.propertyName=="visibility"&&Y.target==D&&(t(14,E=!1),xi(z,h))};return n.$$set=Y=>{"slotName"in Y&&t(3,f=Y.slotName),"index"in Y&&t(4,_=Y.index),"slotOpen"in Y&&t(0,h=Y.slotOpen),"weaponExpand"in Y&&t(1,b=Y.weaponExpand),"optionsOpen"in Y&&t(2,v=Y.optionsOpen)},n.$$.update=()=>{if(n.$$.dirty[0]&58720280&&t(16,i=_?a[_]:f=="sets"?l:r[f]),n.$$.dirty[0]&4194312&&t(6,s=o[f]),n.$$.dirty[0]&96&&S){t(15,T=S.querySelectorAll("li:not(.hidden)"));for(let Y=0;Y<S.childElementCount;Y++)t(16,i[s[Y].name]=S.children[Y],i);$(),A()}},[h,b,v,f,_,S,s,k,y,I,D,z,j,Q,E,T,i,w,M,H,X,ce,o,r,l,a,ne,q,Z,ue,Ee,Se,ze,ct,de,je,tt,fe,Ue,Ve,nt,V,Ne,ve,U,pe,Oe,qe,Fe,Tt,ht,cn]}class Go extends Ae{constructor(e){super(),Re(this,e,lm,rm,ge,{slotName:3,index:4,slotOpen:0,weaponExpand:1,optionsOpen:2},null,[-1,-1,-1])}}function Jr(n){let e,t,i,s,o,r,l=n[1].name+"",a,c,u,d,f;return{c(){e=g("button"),t=g("img"),o=C(),r=g("span"),a=ae(l),$e(t.src,i=n[1].image)||m(t,"src",i),m(t,"alt",s=n[1].name),m(t,"draggable","false"),m(t,"class","svelte-nknpqm"),m(r,"class","tooltip"),m(r,"id","left"),m(e,"class","svelte-nknpqm"),et(e,"display",n[1].link?"":"none")},m(_,h){L(_,e,h),p(e,t),p(e,o),p(e,r),p(r,a),u=!0,d||(f=[O(e,"click",n[13]),O(e,"focusin",n[14]),O(e,"outroend",n[15])],d=!0)},p(_,h){(!u||h&2&&!$e(t.src,i=_[1].image))&&m(t,"src",i),(!u||h&2&&s!==(s=_[1].name))&&m(t,"alt",s),(!u||h&2)&&l!==(l=_[1].name+"")&&Te(a,l),h&2&&et(e,"display",_[1].link?"":"none")},i(_){u||(_&&ye(()=>{u&&(c||(c=me(e,Je,{duration:150},!0)),c.run(1))}),u=!0)},o(_){_&&(c||(c=me(e,Je,{duration:150},!1)),c.run(0)),u=!1},d(_){_&&P(e),_&&c&&c.end(),d=!1,be(f)}}}function am(n){let e,t,i=n[1],s,o,r=n[0].charAt(0).toUpperCase()+n[0].slice(1)+"",l,a,c,u,d,f,_,h,b,v,w,k,y=Jr(n);function I(S){n[19](S)}function D(S){n[20](S)}let z={slotName:n[0]};return n[4]!==void 0&&(z.slotOpen=n[4]),n[6]!==void 0&&(z.optionsOpen=n[6]),_=new Go({props:z}),re.push(()=>Le(_,"slotOpen",I)),re.push(()=>Le(_,"optionsOpen",D)),_.$on("itemSelect",n[21]),{c(){e=g("div"),t=g("div"),y.c(),s=C(),o=g("button"),l=ae(r),a=C(),c=g("iconify-icon"),u=C(),d=g("button"),d.innerHTML='<iconify-icon icon="maki:cross" class="svelte-nknpqm"></iconify-icon> <span class="tooltip" id="top">Clear selection</span>',f=C(),le(_.$$.fragment),m(t,"class","eqSlotIcon ff-border svelte-nknpqm"),Pe(c,"icon","iconamoon:arrow-down-2-fill"),Pe(c,"class","svelte-nknpqm"),m(o,"class","ddButton svelte-nknpqm"),m(d,"class","clearButton svelte-nknpqm"),m(e,"class","eqSlotCont svelte-nknpqm"),te(e,"slotOpen",n[4]),te(e,"clearAllowed",n[5]&&n[7])},m(S,j){L(S,e,j),p(e,t),y.m(t,null),n[16](t),p(e,s),p(e,o),p(o,l),p(o,a),p(o,c),p(e,u),p(e,d),p(e,f),se(_,e,null),n[22](e),v=!0,w||(k=[O(window,"mousedown",n[11]),O(window,"keydown",n[12]),O(o,"click",n[17]),O(d,"click",n[18]),O(e,"mouseenter",n[23]),O(e,"mouseleave",n[24])],w=!0)},p(S,[j]){j&2&&ge(i,i=S[1])?(We(),W(y,1,1,ie),He(),y=Jr(S),y.c(),F(y,1),y.m(t,null)):y.p(S,j),(!v||j&1)&&r!==(r=S[0].charAt(0).toUpperCase()+S[0].slice(1)+"")&&Te(l,r);const B={};j&1&&(B.slotName=S[0]),!h&&j&16&&(h=!0,B.slotOpen=S[4],Me(()=>h=!1)),!b&&j&64&&(b=!0,B.optionsOpen=S[6],Me(()=>b=!1)),_.$set(B),(!v||j&16)&&te(e,"slotOpen",S[4]),(!v||j&160)&&te(e,"clearAllowed",S[5]&&S[7])},i(S){v||(F(y),F(_.$$.fragment,S),v=!0)},o(S){W(y),W(_.$$.fragment,S),v=!1},d(S){S&&P(e),y.d(S),n[16](null),oe(_),n[22](null),w=!1,be(k)}}}function cm(n,e,t){let i,s,o;J(n,Mt,E=>t(10,i=E)),J(n,gn,E=>t(8,s=E)),J(n,x,E=>t(9,o=E));let{eqSlotName:r}=e,l,a,c=gs,u,d,f,_;const h=E=>{(!l.contains(E.target)&&!s||E.target==l||E.target==a)&&(t(4,u=!1),t(6,f=!1),E.target!=l&&E.target!=a&&t(5,d=!1))},b=E=>{E.key=="Tab"?setTimeout(()=>{t(5,d=l.contains(document.activeElement))}):E.key=="Escape"&&(t(4,u=!1),t(6,f=!1))},v=()=>{s||(t(4,u=!1),G(x,o.item.ongoing=!0,o),G(x,o.item.data={...c,slot:r,type:"eq"},o))},w=E=>{E.relatedTarget==null&&t(5,d=!0)},k=()=>{setTimeout(()=>Mp(a))};function y(E){re[E?"unshift":"push"](()=>{a=E,t(3,a)})}const I=()=>{o.screenshot.ongoing||t(4,u=!u)},D=()=>{t(5,d=!1),l.classList.contains("clearAllowed")&&_.querySelector("button").click()};function z(E){u=E,t(4,u)}function S(E){f=E,t(6,f)}const j=E=>{setTimeout(()=>{t(7,_=E.detail.classList.contains("selectedItem")?E.detail:null),t(6,f=!1)})};function B(E){re[E?"unshift":"push"](()=>{l=E,t(2,l)})}const Q=()=>t(5,d=!0),N=()=>{l.contains(document.activeElement)||t(5,d=!1)};return n.$$set=E=>{"eqSlotName"in E&&t(0,r=E.eqSlotName)},n.$$.update=()=>{n.$$.dirty&1027&&i[r]&&i[r].name!=c.name&&t(1,c=i[r])},[r,c,l,a,u,d,f,_,s,o,i,h,b,v,w,k,y,I,D,z,S,j,B,Q,N]}class um extends Ae{constructor(e){super(),Re(this,e,cm,am,ge,{eqSlotName:0})}}function Zr(n,e,t){const i=n.slice();return i[1]=e[t],i[2]=e,i[3]=t,i}function xr(n){let e,t,i;function s(r){n[0](r,n[1],n[2],n[3])}let o={};return n[1]!==void 0&&(o.eqSlotName=n[1]),e=new um({props:o}),re.push(()=>Le(e,"eqSlotName",s)),{c(){le(e.$$.fragment)},m(r,l){se(e,r,l),i=!0},p(r,l){n=r;const a={};!t&&l&0&&(t=!0,a.eqSlotName=n[1],Me(()=>t=!1)),e.$set(a)},i(r){i||(F(e.$$.fragment,r),i=!0)},o(r){W(e.$$.fragment,r),i=!1},d(r){oe(e,r)}}}function dm(n){let e,t,i=De(Array(...Wn)),s=[];for(let r=0;r<i.length;r+=1)s[r]=xr(Zr(n,i,r));const o=r=>W(s[r],1,1,()=>{s[r]=null});return{c(){e=g("div");for(let r=0;r<s.length;r+=1)s[r].c();m(e,"class","armorBox svelte-35g1a3")},m(r,l){L(r,e,l);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null);t=!0},p(r,[l]){if(l&0){i=De(Array(...Wn));let a;for(a=0;a<i.length;a+=1){const c=Zr(r,i,a);s[a]?(s[a].p(c,l),F(s[a],1)):(s[a]=xr(c),s[a].c(),F(s[a],1),s[a].m(e,null))}for(We(),a=i.length;a<s.length;a+=1)o(a);He()}},i(r){if(!t){for(let l=0;l<i.length;l+=1)F(s[l]);t=!0}},o(r){s=s.filter(Boolean);for(let l=0;l<s.length;l+=1)W(s[l]);t=!1},d(r){r&&P(e),ft(s,r)}}}function fm(n,e,t){function i(s,o,r,l){r[l]=s}return[i]}class hm extends Ae{constructor(e){super(),Re(this,e,fm,dm,ge,{})}}function _m(n){let e,t=(n[3]?`${Math.floor(n[5]*.675+19.8)}% Reduction`:n[5])+"",i,s,o;return{c(){e=g("span"),i=ae(t),m(e,"class","statValue svelte-gx367h"),m(e,"tabindex","0"),te(e,"hidden",n[2]),te(e,"negative",n[5]<0),te(e,"zero",n[5]==0),te(e,"reduction",n[3])},m(r,l){L(r,e,l),p(e,i),s||(o=[O(e,"mouseenter",n[11]),O(e,"mouseleave",n[12]),O(e,"focusin",n[13]),O(e,"focusout",n[14])],s=!0)},p(r,l){l&40&&t!==(t=(r[3]?`${Math.floor(r[5]*.675+19.8)}% Reduction`:r[5])+"")&&Te(i,t),l&4&&te(e,"hidden",r[2]),l&32&&te(e,"negative",r[5]<0),l&32&&te(e,"zero",r[5]==0),l&8&&te(e,"reduction",r[3])},d(r){r&&P(e),s=!1,be(o)}}}function pm(n){let e,t=(n[0]!="endurance"?n[5]:n[5].toFixed(2))+"",i;return{c(){e=g("span"),i=ae(t),m(e,"class","statValue svelte-gx367h"),te(e,"hidden",n[2]),te(e,"negative",n[5]<0),te(e,"zero",n[5]==0)},m(s,o){L(s,e,o),p(e,i)},p(s,o){o&33&&t!==(t=(s[0]!="endurance"?s[5]:s[5].toFixed(2))+"")&&Te(i,t),o&4&&te(e,"hidden",s[2]),o&32&&te(e,"negative",s[5]<0),o&32&&te(e,"zero",s[5]==0)},d(s){s&&P(e)}}}function mm(n){let e;return{c(){e=g("iconify-icon"),Pe(e,"icon","codicon:sparkle-filled"),Pe(e,"class","svelte-gx367h")},m(t,i){L(t,e,i)},p:ie,d(t){t&&P(e)}}}function gm(n){let e,t=`${n[1]} Bonus`,i;return{c(){e=g("span"),i=ae(t),m(e,"class","statName svelte-gx367h")},m(s,o){L(s,e,o),p(e,i)},p(s,o){o&2&&t!==(t=`${s[1]} Bonus`)&&Te(i,t)},d(s){s&&P(e)}}}function bm(n){let e,t,i,s,o,r,l;function a(h,b){return h[0]!="armor"?pm:_m}let c=a(n),u=c(n);function d(h,b){if(h[2])return gm;if(h[4])return mm}let f=d(n),_=f&&f(n);return{c(){e=g("div"),t=g("img"),s=C(),u.c(),o=C(),_&&_.c(),$e(t.src,i="stats/"+n[0]+".svg")||m(t,"src",i),m(t,"alt",n[1]),m(t,"class","svelte-gx367h"),m(e,"id",n[0]),m(e,"class","svelte-gx367h"),te(e,"hidden",n[5]==0)},m(h,b){L(h,e,b),p(e,t),p(e,s),u.m(e,null),p(e,o),_&&_.m(e,null),r||(l=[O(t,"mouseenter",n[9]),O(t,"mouseleave",n[10])],r=!0)},p(h,[b]){b&1&&!$e(t.src,i="stats/"+h[0]+".svg")&&m(t,"src",i),b&2&&m(t,"alt",h[1]),c===(c=a(h))&&u?u.p(h,b):(u.d(1),u=c(h),u&&(u.c(),u.m(e,o))),f===(f=d(h))&&_?_.p(h,b):(_&&_.d(1),_=f&&f(h),_&&(_.c(),_.m(e,null))),b&1&&m(e,"id",h[0]),b&32&&te(e,"hidden",h[5]==0)},i:ie,o:ie,d(h){h&&P(e),u.d(),_&&_.d(),r=!1,be(l)}}}function vm(n,e,t){let i,s,o,r;J(n,Pt,k=>t(6,s=k)),J(n,Rn,k=>t(7,o=k)),J(n,gt,k=>t(8,r=k));let{codeName:l,formalName:a}=e,c,u,d=!1;const f=()=>t(2,c=!0),_=()=>t(2,c=!1),h=()=>t(3,u=!0),b=()=>t(3,u=!1),v=()=>t(3,u=!0),w=()=>t(3,u=!1);return n.$$set=k=>{"codeName"in k&&t(0,l=k.codeName),"formalName"in k&&t(1,a=k.formalName)},n.$$.update=()=>{if(n.$$.dirty&257&&t(5,i=r[l]),n.$$.dirty&193)for(let k in o)if(o[k]&&s.bonuses.find(y=>y.name==k).stats[l]!=0){t(4,d=!0);break}else t(4,d=!1)},[l,a,c,u,d,i,s,o,r,f,_,h,b,v,w]}class ym extends Ae{constructor(e){super(),Re(this,e,vm,bm,ge,{codeName:0,formalName:1})}}function $r(n,e,t){const i=n.slice();return i[8]=e[t][0],i[9]=e[t][1],i[10]=e,i[11]=t,i}function el(n){let e,t,i,s;function o(a){n[4](a,n[8],n[10],n[11])}function r(a){n[5](a,n[9],n[10],n[11])}let l={};return n[8]!==void 0&&(l.codeName=n[8]),n[9]!==void 0&&(l.formalName=n[9]),e=new ym({props:l}),re.push(()=>Le(e,"codeName",o)),re.push(()=>Le(e,"formalName",r)),{c(){le(e.$$.fragment)},m(a,c){se(e,a,c),s=!0},p(a,c){n=a;const u={};!t&&c&0&&(t=!0,u.codeName=n[8],Me(()=>t=!1)),!i&&c&0&&(i=!0,u.formalName=n[9],Me(()=>i=!1)),e.$set(u)},i(a){s||(F(e.$$.fragment,a),s=!0)},o(a){W(e.$$.fragment,a),s=!1},d(a){oe(e,a)}}}function tl(n){let e,t,i,s,o=n[2]?"Copied!":`Copy ${n[1]?"all":""} as text`,r,l,a,c,u;return{c(){e=g("button"),t=g("iconify-icon"),i=C(),s=g("span"),r=ae(o),Pe(t,"icon","ic:round-content-copy"),Pe(t,"class","svelte-hth2ds"),m(s,"class","tooltip"),m(s,"id","top"),m(e,"class","copyStatsButton svelte-hth2ds")},m(d,f){L(d,e,f),p(e,t),p(e,i),p(e,s),p(s,r),a=!0,c||(u=O(e,"click",n[6]),c=!0)},p(d,f){(!a||f&6)&&o!==(o=d[2]?"Copied!":`Copy ${d[1]?"all":""} as text`)&&Te(r,o)},i(d){a||(d&&ye(()=>{a&&(l||(l=me(e,Je,{duration:100},!0)),l.run(1))}),a=!0)},o(d){d&&(l||(l=me(e,Je,{duration:100},!1)),l.run(0)),a=!1},d(d){d&&P(e),d&&l&&l.end(),c=!1,u()}}}function wm(n){let e;return{c(){e=g("span"),e.textContent="Show all stats",m(e,"slot","tooltip"),m(e,"class","tooltip"),m(e,"id","top")},m(t,i){L(t,e,i)},p:ie,d(t){t&&P(e)}}}function km(n){let e,t,i,s,o,r=De(Object.entries(Lt)),l=[];for(let u=0;u<r.length;u+=1)l[u]=el($r(n,r,u));const a=u=>W(l[u],1,1,()=>{l[u]=null});let c=n[3]&&tl(n);return s=new mt({props:{text:"",$$slots:{tooltip:[wm]},$$scope:{ctx:n}}}),s.$on("toggle",n[7]),{c(){e=g("div");for(let u=0;u<l.length;u+=1)l[u].c();t=C(),c&&c.c(),i=C(),le(s.$$.fragment),m(e,"class","statBox svelte-hth2ds"),te(e,"showAll",n[1])},m(u,d){L(u,e,d);for(let f=0;f<l.length;f+=1)l[f]&&l[f].m(e,null);p(e,t),c&&c.m(e,null),p(e,i),se(s,e,null),o=!0},p(u,[d]){if(d&0){r=De(Object.entries(Lt));let _;for(_=0;_<r.length;_+=1){const h=$r(u,r,_);l[_]?(l[_].p(h,d),F(l[_],1)):(l[_]=el(h),l[_].c(),F(l[_],1),l[_].m(e,t))}for(We(),_=r.length;_<l.length;_+=1)a(_);He()}u[3]?c?(c.p(u,d),d&8&&F(c,1)):(c=tl(u),c.c(),F(c,1),c.m(e,i)):c&&(We(),W(c,1,1,()=>{c=null}),He());const f={};d&4096&&(f.$$scope={dirty:d,ctx:u}),s.$set(f),(!o||d&2)&&te(e,"showAll",u[1])},i(u){if(!o){for(let d=0;d<r.length;d+=1)F(l[d]);F(c),F(s.$$.fragment,u),o=!0}},o(u){l=l.filter(Boolean);for(let d=0;d<l.length;d+=1)W(l[d]);W(c),W(s.$$.fragment,u),o=!1},d(u){u&&P(e),ft(l,u),c&&c.d(),oe(s)}}}function Cm(n,e,t){let i;J(n,gt,d=>t(0,i=d));let s=!1,o=!1,r=!1;function l(d,f,_,h){_[h][0]=d}function a(d,f,_,h){_[h][1]=d}const c=d=>{if(tn(d),o)return;let f="";for(let[_,h]of Object.entries(Lt)){let b=_=="armor"?"":`
`,v=i[_];_=="armor"?v+=` (${Math.floor(v*.675+19.8)}% Reduction)`:_=="endurance"?v=v.toFixed(2)+"%":_=="ammoReturn"&&(v+="%"),(s||!s&&i[_])&&(f+=`${b}${h}: ${v}`)}navigator.clipboard.writeText(f),t(2,o=!0),setTimeout(()=>t(2,o=!1),1e3)},u=d=>t(1,s=d.detail);return n.$$.update=()=>{if(n.$$.dirty&1&&i){t(3,r=!1);for(let d in i)if(i[d]){t(3,r=!0);break}}},[i,s,o,r,l,a,c,u]}class Em extends Ae{constructor(e){super(),Re(this,e,Cm,km,ge,{})}}function Sm(n){let e,t,i,s,o,r,l,a,c,u;return{c(){e=g("div"),t=g("button"),t.textContent="-",i=C(),s=g("input"),o=C(),r=g("b"),r.textContent="%",l=C(),a=g("button"),a.textContent="+",m(t,"id","decrease"),m(t,"class","svelte-1m4n74o"),m(s,"type","number"),m(s,"placeholder","0"),m(s,"class","svelte-1m4n74o"),m(r,"class","svelte-1m4n74o"),m(a,"id","increase"),m(a,"class","svelte-1m4n74o"),m(e,"class","svelte-1m4n74o"),te(e,"non-percent",!n[1])},m(d,f){L(d,e,f),p(e,t),p(e,i),p(e,s),Bt(s,n[0]),p(e,o),p(e,r),p(e,l),p(e,a),c||(u=[O(t,"click",n[4]),O(s,"input",n[5]),O(s,"input",n[2]),O(a,"click",n[6])],c=!0)},p(d,[f]){f&1&&aa(s.value)!==d[0]&&Bt(s,d[0])},i:ie,o:ie,d(d){d&&P(e),c=!1,be(u)}}}function Im(n,e,t){let{weaponName:i,value:s}=e,o=i!="Nature's Wrath Spellbook",r;o?(s=100,r=100):(s=4,r=4);function l(){s<0?t(0,s=0):s>r&&t(0,s=r),s%1!=0&&t(0,s=Math.floor(s))}const a=()=>{t(0,s--,s),l()};function c(){s=aa(this.value),t(0,s)}const u=()=>{t(0,s++,s),l()};return n.$$set=d=>{"weaponName"in d&&t(3,i=d.weaponName),"value"in d&&t(0,s=d.value)},[s,o,l,i,a,c,u]}class Tm extends Ae{constructor(e){super(),Re(this,e,Im,Sm,ge,{weaponName:3,value:0})}}function nl(n,e,t){const i=n.slice();i[53]=e[t];const s=i[53].name.includes("Fantastic Beamstorm")?"~":"";i[23]=s;const o=i[24].includes(i[53].name);return i[54]=o,i}function Nm(n){let e,t,i=n[2].description+"",s,o;return{c(){e=g("span"),t=ae('"'),s=ae(i),o=ae('"'),m(e,"id","toolDesc"),m(e,"class","svelte-1tlszo6")},m(r,l){L(r,e,l),p(e,t),p(e,s),p(e,o)},p(r,l){l[0]&4&&i!==(i=r[2].description+"")&&Te(s,i)},d(r){r&&P(e)}}}function Om(n){let e,t,i,s=`${n[5]?"Type":n[3].name}:`,o,r,l=n[20],a,c,u,d,f,_=n[5]?"Return":"Expand",h,b,v,w,k=sl(n),y=n[4]&&ol(n);return{c(){e=g("button"),t=g("div"),i=g("span"),o=ae(s),r=C(),k.c(),c=C(),y&&y.c(),u=C(),d=g("span"),f=ae("("),h=ae(_),b=ae(")"),m(i,"class","svelte-1tlszo6"),et(i,"font-size",Object.keys(n[21]).includes(n[3].name)?`calc(var(--u) * ${n[21][n[3].name]})`:""),m(t,"id",a=n[5]?"":"basic"),m(t,"class","svelte-1tlszo6"),m(d,"class","tooltip svelte-1tlszo6"),m(d,"id","top"),m(e,"class","gearPreview svelte-1tlszo6"),et(e,"line-height",`${n[10]/6.5}px`)},m(I,D){L(I,e,D),p(e,t),p(t,i),p(i,o),p(t,r),k.m(t,null),p(e,c),y&&y.m(e,null),p(e,u),p(e,d),p(d,f),p(d,h),p(d,b),n[36](e),v||(w=O(e,"click",n[37]),v=!0)},p(I,D){D[0]&40&&s!==(s=`${I[5]?"Type":I[3].name}:`)&&Te(o,s),D[0]&2097160&&et(i,"font-size",Object.keys(I[21]).includes(I[3].name)?`calc(var(--u) * ${I[21][I[3].name]})`:""),D[0]&1048576&&ge(l,l=I[20])?(k.d(1),k=sl(I),k.c(),k.m(t,null)):k.p(I,D),D[0]&32&&a!==(a=I[5]?"":"basic")&&m(t,"id",a),I[4]?y?y.p(I,D):(y=ol(I),y.c(),y.m(e,u)):y&&(y.d(1),y=null),D[0]&32&&_!==(_=I[5]?"Return":"Expand")&&Te(h,_),D[0]&1024&&et(e,"line-height",`${I[10]/6.5}px`)},d(I){I&&P(e),k.d(I),y&&y.d(),n[36](null),v=!1,w()}}}function il(n){let e;return{c(){e=g("iconify-icon"),Pe(e,"icon","codicon:sparkle-filled"),Pe(e,"class","svelte-1tlszo6")},m(t,i){L(t,e,i)},d(t){t&&P(e)}}}function sl(n){let e,t,i=(n[5]?n[2].info.type.replace("/","<b>,</b><br/>"):n[26](n[3]))+"",s,o=!n[5]&&n[6].basic&&il();return{c(){e=g("span"),t=new ku(!1),s=C(),o&&o.c(),t.a=s,m(e,"class","svelte-1tlszo6")},m(r,l){L(r,e,l),t.m(i,e),p(e,s),o&&o.m(e,null)},p(r,l){l[0]&44&&i!==(i=(r[5]?r[2].info.type.replace("/","<b>,</b><br/>"):r[26](r[3]))+"")&&t.p(i),!r[5]&&r[6].basic?o||(o=il(),o.c(),o.m(e,null)):o&&(o.d(1),o=null)},d(r){r&&P(e),o&&o.d()}}}function ol(n){let e,t,i=`${n[5]?"Special":n[4].name.split(" (")[0]}:`,s,o,r=n[20],l,a=al(n);return{c(){e=g("div"),t=g("span"),s=ae(i),o=C(),a.c(),m(t,"class","svelte-1tlszo6"),et(t,"font-size",Object.keys(n[21]).includes(n[4].name)?`calc(var(--u) * ${n[21][n[4].name]})`:""),m(e,"id",l=n[5]?"":"special"),m(e,"class","svelte-1tlszo6")},m(c,u){L(c,e,u),p(e,t),p(t,s),p(e,o),a.m(e,null)},p(c,u){u[0]&48&&i!==(i=`${c[5]?"Special":c[4].name.split(" (")[0]}:`)&&Te(s,i),u[0]&2097168&&et(t,"font-size",Object.keys(c[21]).includes(c[4].name)?`calc(var(--u) * ${c[21][c[4].name]})`:""),u[0]&1048576&&ge(r,r=c[20])?(a.d(1),a=al(c),a.c(),a.m(e,null)):a.p(c,u),u[0]&32&&l!==(l=c[5]?"":"special")&&m(e,"id",l)},d(c){c&&P(e),a.d(c)}}}function rl(n){let e,t;return{c(){e=g("span"),t=ae(n[23]),m(e,"id","prefix"),m(e,"class","svelte-1tlszo6")},m(i,s){L(i,e,s),p(e,t)},p(i,s){s[0]&8388608&&Te(t,i[23])},d(i){i&&P(e)}}}function ll(n){let e;return{c(){e=g("iconify-icon"),Pe(e,"icon","codicon:sparkle-filled"),Pe(e,"class","svelte-1tlszo6")},m(t,i){L(t,e,i)},d(t){t&&P(e)}}}function al(n){let e,t,i=(n[5]?n[2].info.special:n[26](n[4]))+"",s,o,r=n[23]&&!n[5]&&rl(n),l=!n[5]&&n[6].special&&ll();return{c(){e=g("span"),r&&r.c(),t=C(),s=ae(i),o=C(),l&&l.c(),m(e,"class","svelte-1tlszo6")},m(a,c){L(a,e,c),r&&r.m(e,null),p(e,t),p(e,s),p(e,o),l&&l.m(e,null)},p(a,c){a[23]&&!a[5]?r?r.p(a,c):(r=rl(a),r.c(),r.m(e,t)):r&&(r.d(1),r=null),c[0]&52&&i!==(i=(a[5]?a[2].info.special:a[26](a[4]))+"")&&Te(s,i),!a[5]&&a[6].special?l||(l=ll(),l.c(),l.m(e,null)):l&&(l.d(1),l=null)},d(a){a&&P(e),r&&r.d(),l&&l.d()}}}function cl(n){let e,t,i,s,o,r,l=n[2].name+"",a,c,u,d,f,_;return{c(){e=g("button"),t=g("img"),o=C(),r=g("span"),a=ae(l),$e(t.src,i=n[2].image)||m(t,"src",i),m(t,"alt",s=n[2].name),m(t,"draggable","false"),m(t,"class","svelte-1tlszo6"),m(r,"class","tooltip svelte-1tlszo6"),m(r,"id",c=n[19].screenshot.ongoing?"right":"top"),m(e,"class","svelte-1tlszo6"),et(e,"display",n[2].link?"":"none"),et(e,"border-radius",n[2].tool?"calc(var(--u))":"")},m(h,b){L(h,e,b),p(e,t),p(e,o),p(e,r),p(r,a),d=!0,f||(_=O(e,"click",n[38]),f=!0)},p(h,b){(!d||b[0]&4&&!$e(t.src,i=h[2].image))&&m(t,"src",i),(!d||b[0]&4&&s!==(s=h[2].name))&&m(t,"alt",s),(!d||b[0]&4)&&l!==(l=h[2].name+"")&&Te(a,l),(!d||b[0]&524288&&c!==(c=h[19].screenshot.ongoing?"right":"top"))&&m(r,"id",c),b[0]&4&&et(e,"display",h[2].link?"":"none"),b[0]&4&&et(e,"border-radius",h[2].tool?"calc(var(--u))":"")},i(h){d||(h&&ye(()=>{d&&(u||(u=me(e,Je,{duration:150},!0)),u.run(1))}),d=!0)},o(h){h&&(u||(u=me(e,Je,{duration:150},!1)),u.run(0)),d=!1},d(h){h&&P(e),h&&u&&u.end(),f=!1,_()}}}function ul(n){let e,t,i,s,o,r,l,a,c,u;i=new mt({props:{text:"Toggle base values",checked:n[16]}}),i.$on("toggle",n[47]),o=new mt({props:{text:"Eyeball of Reckoning buff",checked:n[17]}}),o.$on("toggle",n[48]);let d=De(n[2].moves),f=[];for(let h=0;h<d.length;h+=1)f[h]=_l(nl(n,d,h));const _=h=>W(f[h],1,1,()=>{f[h]=null});return{c(){e=g("div"),t=g("div"),le(i.$$.fragment),s=C(),le(o.$$.fragment),r=C(),l=g("div");for(let h=0;h<f.length;h+=1)f[h].c();m(t,"class","weaponToggles svelte-1tlszo6"),m(l,"class","weaponMoves svelte-1tlszo6"),m(e,"class","fullWeaponView svelte-1tlszo6")},m(h,b){L(h,e,b),p(e,t),se(i,t,null),p(t,s),se(o,t,null),p(e,r),p(e,l);for(let v=0;v<f.length;v+=1)f[v]&&f[v].m(l,null);u=!0},p(h,b){const v={};b[0]&65536&&(v.checked=h[16]),i.$set(v);const w={};if(b[0]&131072&&(w.checked=h[17]),o.$set(w),b[0]&219611268){d=De(h[2].moves);let k;for(k=0;k<d.length;k+=1){const y=nl(h,d,k);f[k]?(f[k].p(y,b),F(f[k],1)):(f[k]=_l(y),f[k].c(),F(f[k],1),f[k].m(l,null))}for(We(),k=d.length;k<f.length;k+=1)_(k);He()}},i(h){if(!u){F(i.$$.fragment,h),F(o.$$.fragment,h);for(let b=0;b<d.length;b+=1)F(f[b]);h&&ye(()=>{u&&(c&&c.end(1),a=fa(e,Je,{duration:150,delay:300}),a.start())}),u=!0}},o(h){W(i.$$.fragment,h),W(o.$$.fragment,h),f=f.filter(Boolean);for(let b=0;b<f.length;b+=1)W(f[b]);a&&a.invalidate(),h&&(c=ha(e,Je,{duration:150})),u=!1},d(h){h&&P(e),oe(i),oe(o),ft(f,h),h&&c&&c.end()}}}function dl(n){let e,t,i,s;function o(a){n[49](a)}function r(a){n[50](a)}let l={};return n[7]!==void 0&&(l.value=n[7]),n[2].name!==void 0&&(l.weaponName=n[2].name),e=new Tm({props:l}),re.push(()=>Le(e,"value",o)),re.push(()=>Le(e,"weaponName",r)),{c(){le(e.$$.fragment)},m(a,c){se(e,a,c),s=!0},p(a,c){const u={};!t&&c[0]&128&&(t=!0,u.value=a[7],Me(()=>t=!1)),!i&&c[0]&4&&(i=!0,u.weaponName=a[2].name,Me(()=>i=!1)),e.$set(u)},i(a){s||(F(e.$$.fragment,a),s=!0)},o(a){W(e.$$.fragment,a),s=!1},d(a){oe(e,a)}}}function fl(n){let e;return{c(){e=g("iconify-icon"),Pe(e,"icon","codicon:sparkle-filled"),Pe(e,"class","svelte-1tlszo6")},m(t,i){L(t,e,i)},d(t){t&&P(e)}}}function hl(n){let e,t=n[23]+(n[16]&&!n[54]?n[53].base:n[54]?n[27](n[53]):n[26](n[53]))+"",i,s,o=n[18][n[53].name]&&!n[16]&&fl();return{c(){e=g("span"),i=ae(t),s=C(),o&&o.c(),m(e,"class","svelte-1tlszo6")},m(r,l){L(r,e,l),p(e,i),p(e,s),o&&o.m(e,null)},p(r,l){l[0]&65540&&t!==(t=r[23]+(r[16]&&!r[54]?r[53].base:r[54]?r[27](r[53]):r[26](r[53]))+"")&&Te(i,t),r[18][r[53].name]&&!r[16]?o||(o=fl(),o.c(),o.m(e,null)):o&&(o.d(1),o=null)},d(r){r&&P(e),o&&o.d()}}}function _l(n){let e,t,i,s,o=(n[54]&&n[2].name=="Nature's Wrath Spellbook"?n[53].name.replace("Charged","Charge(s)"):n[53].name)+":",r,l,a=n[54]?[n[20],n[7],n[17]]:[n[20],n[17]],c,u,d=n[54]&&dl(n),f=hl(n);return{c(){e=g("div"),t=g("div"),i=g("span"),d&&d.c(),s=C(),r=ae(o),l=C(),f.c(),c=C(),m(i,"class","svelte-1tlszo6"),m(t,"class","ff-border svelte-1tlszo6"),m(e,"class","svelte-1tlszo6")},m(_,h){L(_,e,h),p(e,t),p(t,i),d&&d.m(i,null),p(i,s),p(i,r),p(t,l),f.m(t,null),p(e,c),u=!0},p(_,h){_[54]?d?(d.p(_,h),h[0]&4&&F(d,1)):(d=dl(_),d.c(),F(d,1),d.m(i,s)):d&&(We(),W(d,1,1,()=>{d=null}),He()),(!u||h[0]&4)&&o!==(o=(_[54]&&_[2].name=="Nature's Wrath Spellbook"?_[53].name.replace("Charged","Charge(s)"):_[53].name)+":")&&Te(r,o),h[0]&1179780&&ge(a,a=_[54]?[_[20],_[7],_[17]]:[_[20],_[17]])?(f.d(1),f=hl(_),f.c(),f.m(t,null)):f.p(_,h)},i(_){u||(F(d),u=!0)},o(_){W(d),u=!1},d(_){_&&P(e),d&&d.d(),f.d(_)}}}function Dm(n){let e,t,i,s,o="Gear"+(n[19].screenshot.ongoing?":":""),r,l,a,c,u,d=n[2],f,_,h,b,v,w,k,y,I,D,z,S;function j(M,H){if(M[2].name&&!M[2].tool)return Om;if(M[2].tool)return Nm}let B=j(n),Q=B&&B(n),N=cl(n);function E(M){n[42](M)}function T(M){n[43](M)}function $(M){n[44](M)}let R={slotName:n[0],index:n[1]};n[14]!==void 0&&(R.slotOpen=n[14]),n[5]!==void 0&&(R.weaponExpand=n[5]),n[15]!==void 0&&(R.optionsOpen=n[15]),b=new Go({props:R}),re.push(()=>Le(b,"slotOpen",E)),re.push(()=>Le(b,"weaponExpand",T)),re.push(()=>Le(b,"optionsOpen",$)),b.$on("itemSelect",n[45]),b.$on("toolSelect",n[28]);let A=n[5]&&ul(n);return{c(){e=g("div"),t=g("button"),i=g("iconify-icon"),s=C(),r=ae(o),l=C(),a=g("div"),Q&&Q.c(),c=C(),u=g("div"),N.c(),h=C(),le(b.$$.fragment),y=C(),A&&A.c(),I=_t(),Pe(i,"icon","iconamoon:arrow-down-2-fill"),Pe(i,"class","svelte-1tlszo6"),m(t,"class","ddButton svelte-1tlszo6"),m(u,"class","gearSlotIcon svelte-1tlszo6"),ye(()=>n[39].call(u)),et(u,"min-width",`${n[11]}px`),m(a,"class","gearInfoCont ff-border svelte-1tlszo6"),ye(()=>n[41].call(a)),et(a,"justify-content",n[2].name?"":"flex-end"),m(e,"class","gearSlot svelte-1tlszo6"),te(e,"slotOpen",n[14]),te(e,"weapon-expand",n[5])},m(M,H){L(M,e,H),p(e,t),p(t,i),p(t,s),p(t,r),n[34](t),p(e,l),p(e,a),Q&&Q.m(a,null),p(a,c),p(a,u),N.m(u,null),f=nn(u,n[39].bind(u)),n[40](a),_=nn(a,n[41].bind(a)),p(e,h),se(b,e,null),n[46](e),L(M,y,H),A&&A.m(M,H),L(M,I,H),D=!0,z||(S=[O(window,"mousedown",n[32]),O(window,"keydown",n[33]),O(t,"click",n[35])],z=!0)},p(M,H){(!D||H[0]&524288)&&o!==(o="Gear"+(M[19].screenshot.ongoing?":":""))&&Te(r,o),B===(B=j(M))&&Q?Q.p(M,H):(Q&&Q.d(1),Q=B&&B(M),Q&&(Q.c(),Q.m(a,c))),H[0]&4&&ge(d,d=M[2])?(We(),W(N,1,1,ie),He(),N=cl(M),N.c(),F(N,1),N.m(u,null)):N.p(M,H),H[0]&2048&&et(u,"min-width",`${M[11]}px`),H[0]&4&&et(a,"justify-content",M[2].name?"":"flex-end");const X={};H[0]&1&&(X.slotName=M[0]),H[0]&2&&(X.index=M[1]),!v&&H[0]&16384&&(v=!0,X.slotOpen=M[14],Me(()=>v=!1)),!w&&H[0]&32&&(w=!0,X.weaponExpand=M[5],Me(()=>w=!1)),!k&&H[0]&32768&&(k=!0,X.optionsOpen=M[15],Me(()=>k=!1)),b.$set(X),(!D||H[0]&16384)&&te(e,"slotOpen",M[14]),(!D||H[0]&32)&&te(e,"weapon-expand",M[5]),M[5]?A?(A.p(M,H),H[0]&32&&F(A,1)):(A=ul(M),A.c(),F(A,1),A.m(I.parentNode,I)):A&&(We(),W(A,1,1,()=>{A=null}),He())},i(M){D||(F(N),F(b.$$.fragment,M),F(A),D=!0)},o(M){W(N),W(b.$$.fragment,M),W(A),D=!1},d(M){M&&(P(e),P(y),P(I)),n[34](null),Q&&Q.d(),N.d(M),f(),n[40](null),_(),oe(b),n[46](null),A&&A.d(M),z=!1,be(S)}}}function Rm(n,e,t){let i,s,o,r,l,a,c;J(n,Rn,U=>t(30,i=U)),J(n,zt,U=>t(31,s=U)),J(n,Pt,U=>t(51,o=U)),J(n,x,U=>t(19,r=U)),J(n,gt,U=>t(20,l=U)),J(n,ys,U=>t(21,a=U)),J(n,gn,U=>t(22,c=U));let{gearBox:u,slotName:d,index:f}=e,_,h,b,v,w,k,y,I=bs,D,z,S,j,B,Q=!1,N=!1,E="",T=["Charged Basic Attack","Charged Solar Beam"],$={basic:!1,special:!1},R={};function A(){if(y)for(let U of y.querySelectorAll(".gearPreview > div")){if(Object.keys(a).includes(U.id=="basic"?D.name:z?z.name:null))return;let pe=Pp(U,c);pe&&(U.id=="basic"?G(ys,a[D.name]=pe,a):G(ys,a[z.name]=pe,a))}}function M(U){let pe;if(U.name=="Void Needle")pe=U.base+l[U.type]-l.armor*5.625;else if(I.name=="Pureblood Dagger"){let Oe,qe={magicDmg:l.magicDmg,meleeDmg:l.meleeDmg,rangedDmg:l.rangedDmg},Fe=Object.keys(qe).reduce((ht,cn)=>qe[ht]>qe[cn]?ht:cn),Tt=0;for(let ht in qe)ht!=Fe&&(Tt+=qe[ht]);Oe=l[Fe]*2-Tt,pe=U.base+(U.name.includes("HP")?Oe/2:Oe)}else if(U.type.includes("/")){let Oe=U.type.split("/"),qe=0;for(let Fe of Oe)qe+=l[Fe]*U[`${Fe}Mult`];pe=U.base+qe}else pe=U.base+l[U.type]*U.mult;return N&&(!U.name.includes("HP")||U.name.includes("HP")&&I.name=="Pureblood Dagger")&&(pe+=pe*.08775),B?Math.floor(pe*10)/10:Math.floor(pe)}function H(U){let pe,Oe=Q?0:l[U.type];return I.name=="Celestial Powers Spellbook"?pe=(80+Oe*1.1)*(.8+2.2*_/100):I.name=="Staff of Dreams"?pe=160+160*_/100+Oe*(.4+1.3*_/100):I.name=="Nature's Wrath Spellbook"&&(pe=260+400*_/4+Oe*(1+1.5*_/4)),N&&(pe+=pe*.08775),Math.floor(pe*10)/10}function X(){r.screenshot.ongoing||(t(16,Q=!1),t(17,N=!1),B?(t(5,B=!1),u.classList.remove("weapon-expand"),setTimeout(A)):(u.classList.add("weapon-expand"),t(5,B=!0)))}function he(U,pe){e:for(let Oe in i){let qe=o.bonuses.find(Tt=>Tt.name==Oe).stats,Fe=U?U.type:null;for(let Tt in Lt){if(Fe===null)break e;if(I.name=="Void Spike Ultradagger"&&pe=="special"||U.name=="Void Needle"?Fe="armor/meleeDmg":I.name=="Pureblood Dagger"?Fe=Oe=="Fish of Rage"?"":"magicDmg/meleeDmg/rangedDmg":I.name=="Gnome Rocket Launcher"&&(Fe=""),i[Oe]&&qe[Tt]!=0&&Fe.includes(Tt)){t(18,R[U.name]=!0,R),pe&&t(6,$[pe]=!0,$);break e}else t(18,R[U.name]=!1,R),pe&&t(6,$[pe]=!1,$)}}}const ce=U=>{(!h.contains(U.target)&&!c||h.contains(U.target)&&b.contains(U.target))&&(t(14,S=!1),t(15,j=!1))},ne=U=>{U.key=="Escape"&&(t(14,S=!1),t(15,j=!1))};function q(U){re[U?"unshift":"push"](()=>{k=U,t(12,k)})}const Z=()=>{r.screenshot.ongoing||t(14,S=!S)};function ue(U){re[U?"unshift":"push"](()=>{y=U,t(13,y)})}const Ee=U=>{tn(U),X()},Se=()=>{c||(G(x,r.item.ongoing=!0,r),G(x,r.item.data={...I,type:"gear"},r))};function ze(){w=this.offsetHeight,t(11,w)}function ct(U){re[U?"unshift":"push"](()=>{b=U,t(9,b)})}function de(){v=this.offsetHeight,t(10,v)}function je(U){S=U,t(14,S)}function tt(U){B=U,t(5,B)}function fe(U){j=U,t(15,j)}const Ue=()=>{setTimeout(()=>{A(),(!I.name||I.tool)&&B&&X(),t(15,j=!1)})};function Ve(U){re[U?"unshift":"push"](()=>{h=U,t(8,h)})}const nt=U=>{t(16,Q=U.detail),U.detail&&t(17,N=!1)},V=U=>{t(17,N=U.detail),U.detail&&t(16,Q=!1)};function Ne(U){_=U,t(7,_)}function ve(U){n.$$.not_equal(I.name,U)&&(I.name=U,t(2,I),t(31,s),t(1,f),t(4,z))}return n.$$set=U=>{"gearBox"in U&&t(29,u=U.gearBox),"slotName"in U&&t(0,d=U.slotName),"index"in U&&t(1,f=U.index)},n.$$.update=()=>{if(n.$$.dirty[0]&22|n.$$.dirty[1]&1&&s[f]&&s[f].name!=I.name&&(t(2,I=s[f]),!I.tool&&I.name)){t(3,D=I.moves.filter(U=>U.basic)[0]),t(4,z=I.moves.filter(U=>U.special)[0]),t(18,R={});for(let U of I.moves)t(18,R[U.name]=!1,R),he(U);z&&z.name.includes("Fantastic Beamstorm")?t(23,E="~"):t(23,E="")}if(n.$$.dirty[0]&1073741948&&(i||B)&&!I.tool&&I.name){for(let U in $)he(U=="basic"?D:z||null,U);for(let U of I.moves)he(U)}},[d,f,I,D,z,B,$,_,h,b,v,w,k,y,S,j,Q,N,R,r,l,a,c,E,T,A,M,H,X,u,i,s,ce,ne,q,Z,ue,Ee,Se,ze,ct,de,je,tt,fe,Ue,Ve,nt,V,Ne,ve]}class Am extends Ae{constructor(e){super(),Re(this,e,Rm,Dm,ge,{gearBox:29,slotName:0,index:1},null,[-1,-1])}}function pl(n,e,t){const i=n.slice();return i[3]=e[t],i}function ml(n){let e,t,i;function s(r){n[1](r)}let o={slotName:"gear",index:n[3]};return n[0]!==void 0&&(o.gearBox=n[0]),e=new Am({props:o}),re.push(()=>Le(e,"gearBox",s)),{c(){le(e.$$.fragment)},m(r,l){se(e,r,l),i=!0},p(r,l){const a={};!t&&l&1&&(t=!0,a.gearBox=r[0],Me(()=>t=!1)),e.$set(a)},i(r){i||(F(e.$$.fragment,r),i=!0)},o(r){W(e.$$.fragment,r),i=!1},d(r){oe(e,r)}}}function Pm(n){let e,t,i=De(kn),s=[];for(let r=0;r<i.length;r+=1)s[r]=ml(pl(n,i,r));const o=r=>W(s[r],1,1,()=>{s[r]=null});return{c(){e=g("div");for(let r=0;r<s.length;r+=1)s[r].c();m(e,"class","gearBox svelte-1lv6xba")},m(r,l){L(r,e,l);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null);n[2](e),t=!0},p(r,[l]){if(l&1){i=De(kn);let a;for(a=0;a<i.length;a+=1){const c=pl(r,i,a);s[a]?(s[a].p(c,l),F(s[a],1)):(s[a]=ml(c),s[a].c(),F(s[a],1),s[a].m(e,null))}for(We(),a=i.length;a<s.length;a+=1)o(a);He()}},i(r){if(!t){for(let l=0;l<i.length;l+=1)F(s[l]);t=!0}},o(r){s=s.filter(Boolean);for(let l=0;l<s.length;l+=1)W(s[l]);t=!1},d(r){r&&P(e),ft(s,r),n[2](null)}}}function Mm(n,e,t){let i;function s(r){i=r,t(0,i)}function o(r){re[r?"unshift":"push"](()=>{i=r,t(0,i)})}return[i,s,o]}class Lm extends Ae{constructor(e){super(),Re(this,e,Mm,Pm,ge,{})}}function Fm(n){let e,t,i,s,o,r,l,a;return{c(){e=g("div"),t=g("div"),i=g("button"),i.textContent="Clear armor",s=C(),o=g("div"),r=g("button"),r.textContent="Clear gear",m(i,"class","svelte-e94uvj"),m(t,"class","buttonCont svelte-e94uvj"),m(r,"class","svelte-e94uvj"),m(o,"class","buttonCont svelte-e94uvj"),m(e,"class","mainFeatures svelte-e94uvj"),m(e,"id","box")},m(c,u){L(c,e,u),p(e,t),p(t,i),p(e,s),p(e,o),p(o,r),l||(a=[O(i,"click",n[3]),O(r,"click",n[4])],l=!0)},p:ie,i:ie,o:ie,d(c){c&&P(e),l=!1,be(a)}}}function Bm(n,e,t){let i,s,o,r,l;J(n,zt,f=>t(5,i=f)),J(n,Fn,f=>t(6,s=f)),J(n,Mt,f=>t(7,o=f)),J(n,Ln,f=>t(8,r=f)),J(n,gn,f=>t(0,l=f));function a(){for(let f in o)o[f].name&&r[f][o[f].name].querySelector("button").click()}function c(){for(let f in i)i[f].name&&s[f][i[f].name].querySelector("button").click()}return[l,a,c,f=>{f.target.blur(),l||a()},f=>{f.target.blur(),l||c()}]}class qm extends Ae{constructor(e){super(),Re(this,e,Bm,Fm,ge,{})}}function gl(n){let e,t,i;function s(r){n[3](r)}let o={slotName:"sets"};return n[0]!==void 0&&(o.slotOpen=n[0]),e=new Go({props:o}),re.push(()=>Le(e,"slotOpen",s)),{c(){le(e.$$.fragment)},m(r,l){se(e,r,l),i=!0},p(r,l){const a={};!t&&l&1&&(t=!0,a.slotOpen=r[0],Me(()=>t=!1)),e.$set(a)},i(r){i||(F(e.$$.fragment,r),i=!0)},o(r){W(e.$$.fragment,r),i=!1},d(r){oe(e,r)}}}function zm(n){let e,t,i,s,o,r,l=n[1].head&&n[1].body&&n[1].legs&&n[1].feet&&gl(n);return{c(){e=g("button"),e.innerHTML=`Load armor set
    <iconify-icon icon="iconamoon:arrow-down-2-fill" rotate="180deg" class="svelte-l9dczq"></iconify-icon>`,t=C(),l&&l.c(),i=_t(),m(e,"class","svelte-l9dczq"),te(e,"ddOpen",n[0])},m(a,c){L(a,e,c),L(a,t,c),l&&l.m(a,c),L(a,i,c),s=!0,o||(r=O(e,"click",n[2]),o=!0)},p(a,[c]){(!s||c&1)&&te(e,"ddOpen",a[0]),a[1].head&&a[1].body&&a[1].legs&&a[1].feet?l?(l.p(a,c),c&2&&F(l,1)):(l=gl(a),l.c(),F(l,1),l.m(i.parentNode,i)):l&&(We(),W(l,1,1,()=>{l=null}),He())},i(a){s||(F(l),s=!0)},o(a){W(l),s=!1},d(a){a&&(P(e),P(t),P(i)),l&&l.d(a),o=!1,r()}}}function jm(n,e,t){let i;J(n,Pt,l=>t(1,i=l));let{ddOpen:s=!1}=e;const o=()=>t(0,s=!s);function r(l){s=l,t(0,s)}return n.$$set=l=>{"ddOpen"in l&&t(0,s=l.ddOpen)},[s,i,o,r]}class Wm extends Ae{constructor(e){super(),Re(this,e,jm,zm,ge,{ddOpen:0})}}function Hm(n){let e;return{c(){e=g("span"),e.textContent="Create some builds to get started!",m(e,"class","tooltip svelte-lhwdnk"),m(e,"id","top"),et(e,"left","70.5%")},m(t,i){L(t,e,i)},p:ie,d(t){t&&P(e)}}}function Um(n){let e;return{c(){e=g("span"),e.textContent="Select some gear or armor to get started!",m(e,"class","tooltip svelte-lhwdnk"),m(e,"id","top"),et(e,"left",n[3]?"38%":"")},m(t,i){L(t,e,i)},p(t,i){i&8&&et(e,"left",t[3]?"38%":"")},d(t){t&&P(e)}}}function Gm(n){let e,t,i,s,o,r,l,a,c,u,d,f,_,h,b,v,w,k,y,I,D,z,S,j,B,Q,N,E;function T(H,X){if(!H[4])return Um;if(!H[3])return Hm}let $=T(n),R=$&&$(n);function A(H){n[18](H)}let M={};return n[1]!==void 0&&(M.ddOpen=n[1]),j=new Wm({props:M}),re.push(()=>Le(j,"ddOpen",A)),{c(){e=g("div"),t=g("div"),i=g("div"),s=g("button"),o=ae("Export new build"),l=C(),a=g("div"),c=g("button"),u=ae("Save to build"),f=C(),_=g("div"),h=g("button"),b=ae("Delete build"),w=C(),R&&R.c(),k=C(),y=g("div"),I=g("div"),D=g("button"),D.textContent="Load build",z=C(),S=g("div"),le(j.$$.fragment),s.disabled=r=!n[4],m(s,"class","svelte-lhwdnk"),m(i,"class","buttonCont svelte-lhwdnk"),c.disabled=d=!n[4]||!n[3],m(c,"class","svelte-lhwdnk"),m(a,"class","buttonCont svelte-lhwdnk"),m(a,"id","middle"),h.disabled=v=!n[3],m(h,"class","svelte-lhwdnk"),m(_,"class","buttonCont svelte-lhwdnk"),m(t,"id","modify"),m(t,"class","svelte-lhwdnk"),te(t,"no-tooltip",n[2]),m(D,"class","svelte-lhwdnk"),m(I,"class","buttonCont svelte-lhwdnk"),m(S,"class","buttonCont svelte-lhwdnk"),m(y,"id","load"),m(y,"class","svelte-lhwdnk"),m(e,"class","mainFeatures svelte-lhwdnk"),m(e,"id","build")},m(H,X){L(H,e,X),p(e,t),p(t,i),p(i,s),p(s,o),p(t,l),p(t,a),p(a,c),p(c,u),p(t,f),p(t,_),p(_,h),p(h,b),p(t,w),R&&R.m(t,null),p(e,k),p(e,y),p(y,I),p(I,D),p(y,z),p(y,S),se(j,S,null),n[19](S),Q=!0,N||(E=[O(window,"mousedown",n[8]),O(window,"keydown",n[9]),O(s,"click",n[10]),O(s,"mouseenter",n[11]),O(s,"mouseleave",n[12]),O(c,"click",n[13]),O(h,"click",n[14]),O(h,"mouseenter",n[15]),O(h,"mouseleave",n[16]),O(D,"click",n[17])],N=!0)},p(H,[X]){(!Q||X&16&&r!==(r=!H[4]))&&(s.disabled=r),(!Q||X&24&&d!==(d=!H[4]||!H[3]))&&(c.disabled=d),(!Q||X&8&&v!==(v=!H[3]))&&(h.disabled=v),$===($=T(H))&&R?R.p(H,X):(R&&R.d(1),R=$&&$(H),R&&(R.c(),R.m(t,null))),(!Q||X&4)&&te(t,"no-tooltip",H[2]);const he={};!B&&X&2&&(B=!0,he.ddOpen=H[1],Me(()=>B=!1)),j.$set(he)},i(H){Q||(F(j.$$.fragment,H),Q=!0)},o(H){W(j.$$.fragment,H),Q=!1},d(H){H&&P(e),R&&R.d(),oe(j),n[19](null),N=!1,be(E)}}}function Vm(n,e,t){let i,s,o,r,l;J(n,Nt,S=>t(7,i=S)),J(n,Xt,S=>t(3,s=S)),J(n,lo,S=>t(4,o=S)),J(n,gn,S=>t(5,r=S)),J(n,x,S=>t(6,l=S));let a,c=!1,u=!1;const d=S=>{a.contains(S.target)||t(1,c=!1)},f=S=>{S.key=="Escape"&&t(1,c=!1)},_=()=>{o&&!r&&G(x,l.export.ongoing=!0,l)},h=()=>t(2,u=!0),b=()=>t(2,u=!1),v=()=>{o&&s&&!r&&G(x,l.save.ongoing=!0,l)},w=()=>{s&&!r&&G(x,l.delete.ongoing=!0,l)},k=()=>t(2,u=!0),y=()=>t(2,u=!1),I=()=>{r||G(x,l.load.ongoing=!0,l)};function D(S){c=S,t(1,c)}function z(S){re[S?"unshift":"push"](()=>{a=S,t(0,a)})}return n.$$.update=()=>{n.$$.dirty&128&&G(Xt,s=Object.keys(i).length>0,s)},[a,c,u,s,o,r,l,i,d,f,_,h,b,v,w,k,y,I,D,z]}class Km extends Ae{constructor(e){super(),Re(this,e,Vm,Gm,ge,{})}}function bl(n){let e;return{c(){e=g("span"),e.textContent="New changes! Exiting will erase them.",m(e,"id","alert")},m(t,i){L(t,e,i)},d(t){t&&P(e)}}}function Ym(n){let e,t,i,s,o,r,l,a=25-n[3].length+"",c,u,d,f,_,h,b,v,w,k,y,I=275-n[4].length+"",D,z,S,j,B,Q,N,E,T,$,R,A,M,H,X,he,ce=(n[3]||n[4])&&bl();return{c(){e=g("div"),t=g("div"),i=ae(`Name:\r
        `),s=g("input"),r=C(),l=g("span"),c=ae(a),u=C(),d=g("div"),f=g("div"),_=g("span"),_.textContent="Description / Notes:",h=C(),ce&&ce.c(),b=C(),v=g("textarea"),k=C(),y=g("span"),D=ae(I),z=C(),S=g("div"),j=g("div"),B=g("button"),Q=ae("CANCEL"),E=C(),T=g("div"),$=g("button"),R=ae("EXPORT"),m(s,"class","buildNameInput"),m(s,"id","firstFocusable"),s.disabled=o=n[5].export.status==0,m(s,"type","text"),m(s,"placeholder",n[6]),m(s,"maxlength","25"),m(l,"class","charCounter svelte-1vypdkl"),m(l,"id","buildName"),m(t,"class","buildNameCont svelte-1vypdkl"),m(v,"class","buildDescInput"),v.disabled=w=n[5].export.status==0,m(v,"placeholder","[Empty]"),m(v,"maxlength","275"),m(v,"autocomplete","off"),m(y,"class","charCounter"),m(y,"id","buildDesc"),m(d,"class","buildDescCont"),B.disabled=N=n[5].export.status==0,m($,"id","lastFocusable"),$.disabled=A=n[5].export.status==0,m(S,"class","promptOptions"),m(e,"class","buildExporter svelte-1vypdkl")},m(ne,q){L(ne,e,q),p(e,t),p(t,i),p(t,s),n[8](s),Bt(s,n[3]),p(t,r),p(t,l),p(l,c),p(e,u),p(e,d),p(d,f),p(f,_),p(f,h),ce&&ce.m(f,null),p(d,b),p(d,v),Bt(v,n[4]),n[13](v),p(d,k),p(d,y),p(y,D),p(e,z),p(e,S),p(S,j),p(j,B),p(B,Q),n[16](B),p(S,E),p(S,T),p(T,$),p($,R),H=!0,X||(he=[O(s,"input",n[9]),O(s,"input",n[10]),O(s,"keydown",n[11]),O(v,"input",n[12]),O(v,"input",n[14]),O(v,"keydown",n[15]),O(B,"click",n[17]),O($,"click",n[18]),O($,"keydown",yt),O(e,"introstart",n[19])],X=!0)},p(ne,[q]){(!H||q&32&&o!==(o=ne[5].export.status==0))&&(s.disabled=o),q&8&&s.value!==ne[3]&&Bt(s,ne[3]),(!H||q&8)&&a!==(a=25-ne[3].length+"")&&Te(c,a),ne[3]||ne[4]?ce||(ce=bl(),ce.c(),ce.m(f,null)):ce&&(ce.d(1),ce=null),(!H||q&32&&w!==(w=ne[5].export.status==0))&&(v.disabled=w),q&16&&Bt(v,ne[4]),(!H||q&16)&&I!==(I=275-ne[4].length+"")&&Te(D,I),(!H||q&32&&N!==(N=ne[5].export.status==0))&&(B.disabled=N),(!H||q&32&&A!==(A=ne[5].export.status==0))&&($.disabled=A)},i(ne){H||(ne&&ye(()=>{H&&(M||(M=me(e,Ze,{duration:250},!0)),M.run(1))}),H=!0)},o(ne){ne&&(M||(M=me(e,Ze,{duration:250},!1)),M.run(0)),H=!1},d(ne){ne&&P(e),n[8](null),ce&&ce.d(),n[13](null),n[16](null),ne&&M&&M.end(),X=!1,be(he)}}}function Qm(n,e,t){let i,s,o,r,l,a;J(n,x,T=>t(5,i=T)),J(n,wt,T=>t(20,s=T)),J(n,Xt,T=>t(21,o=T)),J(n,zt,T=>t(22,r=T)),J(n,Mt,T=>t(23,l=T)),J(n,Nt,T=>t(24,a=T));let c=Object.keys(a).length,u,d,f,_="",h="",b=`My ${c+1+iu[(c+1)%10]} build`;function v(){if(G(x,i.export.status=0,i),_.endsWith(" ")&&t(3,_=_.replace(/  +/g," ").replace(/ $/,"")),h.endsWith(" ")&&t(4,h=h.replace(/  +/g," ").replace(/ $/,"")),Object.keys(a).includes(_)){G(x,i.export.status=-1,i),G(x,i.message="duplicate_name",i);return}let T=dp(Kt(jn(Hn),"builds")).key,$=ru(l,r);$.name=_||b,$.desc=h||"[Empty]",hs(Kt(jn(Hn),`builds/${T}`),$).then(()=>{G(x,i.export.status=1,i),G(Xt,o=!0,o),Uo(),Nt.update(R=>({...R,[$.name]:{id:T,desc:$.desc}})),G(wt,s=$,s),G(wt,s.id=T,s),navigator.clipboard.writeText(`${location.origin+location.pathname}?id=${T}`)}).catch(()=>{G(x,i.export.status=-1,i),G(x,i.message="firebase_fail",i)})}function w(T){re[T?"unshift":"push"](()=>{u=T,t(0,u)})}function k(){_=this.value,t(3,_)}const y=T=>{t(3,_=$i(T.target.value,25))},I=T=>{i.export.status==0&&T.preventDefault(),vt(T),$s(u,T.target.value,25)};function D(){h=this.value,t(4,h)}function z(T){re[T?"unshift":"push"](()=>{d=T,t(1,d)})}const S=T=>{t(4,h=$i(T.target.value,275))},j=T=>{i.export.status==0&&T.preventDefault(),$s(d,T.target.value,275)};function B(T){re[T?"unshift":"push"](()=>{f=T,t(2,f)})}return[u,d,f,_,h,i,b,v,w,k,y,I,D,z,S,j,B,()=>{i.export.status!=0&&G(x,i.export.ongoing=!1,i)},()=>{i.export.status!=0&&v()},()=>f.focus()]}class Xm extends Ae{constructor(e){super(),Re(this,e,Qm,Ym,ge,{})}}function Jm(n){let e,t,i,s,o=n[2]?"Copied!":"Copy link",r,l,a;return{c(){e=g("button"),t=g("b"),t.textContent="Build link",i=C(),s=g("span"),r=ae(o),m(s,"class","tooltip"),m(s,"id","top"),m(e,"class","copyButton svelte-1e8zrsj"),m(e,"id","firstFocusable")},m(c,u){L(c,e,u),p(e,t),p(e,i),p(e,s),p(s,r),l||(a=[O(e,"click",n[7]),O(e,"keydown",vt)],l=!0)},p(c,u){u&4&&o!==(o=c[2]?"Copied!":"Copy link")&&Te(r,o)},d(c){c&&P(e),l=!1,be(a)}}}function Zm(n){let e,t,i,s,o,r,l=n[2]?"Copied!":"Copy ID",a,c,u,d;return{c(){e=g("button"),t=g("b"),t.textContent="ID:",i=C(),s=ae(n[4]),o=C(),r=g("span"),a=ae(l),m(r,"class","tooltip"),m(r,"id","top"),m(e,"class","copyButton svelte-1e8zrsj"),m(e,"id",c=n[1]!="save"?"firstFocusable":"")},m(f,_){L(f,e,_),p(e,t),p(e,i),p(e,s),p(e,o),p(e,r),p(r,a),u||(d=[O(e,"click",n[5]),O(e,"keydown",n[6])],u=!0)},p(f,_){_&4&&l!==(l=f[2]?"Copied!":"Copy ID")&&Te(a,l),_&2&&c!==(c=f[1]!="save"?"firstFocusable":"")&&m(e,"id",c)},d(f){f&&P(e),u=!1,be(d)}}}function xm(n){let e;function t(o,r){if(o[0]=="id")return Zm;if(o[0]=="link")return Jm}let i=t(n),s=i&&i(n);return{c(){s&&s.c(),e=_t()},m(o,r){s&&s.m(o,r),L(o,e,r)},p(o,[r]){i===(i=t(o))&&s?s.p(o,r):(s&&s.d(1),s=i&&i(o),s&&(s.c(),s.m(e.parentNode,e)))},i:ie,o:ie,d(o){o&&P(e),s&&s.d(o)}}}function $m(n,e,t){let i;J(n,wt,f=>t(8,i=f));let{type:s,source:o}=e,r=!1;function l(f){r||(navigator.clipboard.writeText(f),t(2,r=!0),setTimeout(()=>t(2,r=!1),1e3))}let a=i?i.id:null;const c=()=>l(a),u=()=>{o!="save"&&vt()},d=()=>l(`${location.origin+location.pathname}?id=${a}`);return n.$$set=f=>{"type"in f&&t(0,s=f.type),"source"in f&&t(1,o=f.source)},[s,o,r,l,a,c,u,d]}class bi extends Ae{constructor(e){super(),Re(this,e,$m,xm,ge,{type:0,source:1})}}function eg(n){let e,t,i,s;return e=new bi({props:{type:"link",source:"share"}}),i=new bi({props:{type:"id",source:"share"}}),{c(){le(e.$$.fragment),t=C(),le(i.$$.fragment)},m(o,r){se(e,o,r),L(o,t,r),se(i,o,r),s=!0},p:ie,i(o){s||(F(e.$$.fragment,o),F(i.$$.fragment,o),s=!0)},o(o){W(e.$$.fragment,o),W(i.$$.fragment,o),s=!1},d(o){o&&P(t),oe(e,o),oe(i,o)}}}function tg(n){let e;return{c(){e=g("span"),e.textContent="Your build has been erased from your local saves and the database."},m(t,i){L(t,e,i)},p:ie,i:ie,o:ie,d(t){t&&P(e)}}}function ng(n){let e;function t(o,r){if(o[2].message=="not_found")return lg;if(o[2].message=="invalid_id")return rg}let i=t(n),s=i&&i(n);return{c(){s&&s.c(),e=_t()},m(o,r){s&&s.m(o,r),L(o,e,r)},p(o,r){i!==(i=t(o))&&(s&&s.d(1),s=i&&i(o),s&&(s.c(),s.m(e.parentNode,e)))},i:ie,o:ie,d(o){o&&P(e),s&&s.d(o)}}}function ig(n){let e,t,i,s,o,r;return i=new bi({props:{type:"link",source:"save"}}),o=new bi({props:{type:"id",source:"save"}}),{c(){e=g("span"),e.textContent="Your build has been overwritten.",t=C(),le(i.$$.fragment),s=C(),le(o.$$.fragment)},m(l,a){L(l,e,a),L(l,t,a),se(i,l,a),L(l,s,a),se(o,l,a),r=!0},p:ie,i(l){r||(F(i.$$.fragment,l),F(o.$$.fragment,l),r=!0)},o(l){W(i.$$.fragment,l),W(o.$$.fragment,l),r=!1},d(l){l&&(P(e),P(t),P(s)),oe(i,l),oe(o,l)}}}function sg(n){let e,t,i,s;const o=[cg,ag],r=[];function l(a,c){return a[2].export.status==1?0:a[2].export.status==-1&&a[2].message=="duplicate_name"?1:-1}return~(e=l(n))&&(t=r[e]=o[e](n)),{c(){t&&t.c(),i=_t()},m(a,c){~e&&r[e].m(a,c),L(a,i,c),s=!0},p(a,c){let u=e;e=l(a),e!==u&&(t&&(We(),W(r[u],1,1,()=>{r[u]=null}),He()),~e?(t=r[e],t||(t=r[e]=o[e](a),t.c()),F(t,1),t.m(i.parentNode,i)):t=null)},i(a){s||(F(t),s=!0)},o(a){W(t),s=!1},d(a){a&&P(i),~e&&r[e].d(a)}}}function og(n){let e,t,i=n[2].export.status?"exporting":n[2].save.status?"saving":n[2].load.status?"loading":"deleting",s,o,r,l,a,c,u,d;return{c(){e=g("span"),t=ae("A problem occurred while "),s=ae(i),o=ae(` your build.\r
            `),r=g("br"),l=ae(`\r
            If needed`),a=g("b"),a.textContent=",",c=ae(" you may contact "),u=g("hl"),u.textContent="xt.ss",d=ae(` on Discord for more\r
            details.`)},m(f,_){L(f,e,_),p(e,t),p(e,s),p(e,o),p(e,r),p(e,l),p(e,a),p(e,c),p(e,u),p(e,d)},p(f,_){_&4&&i!==(i=f[2].export.status?"exporting":f[2].save.status?"saving":f[2].load.status?"loading":"deleting")&&Te(s,i)},i:ie,o:ie,d(f){f&&P(e)}}}function rg(n){let e;return{c(){e=g("span"),e.textContent="The ID you have entered is invalid. Please check it again."},m(t,i){L(t,e,i)},d(t){t&&P(e)}}}function lg(n){let e;return{c(){e=g("span"),e.innerHTML=`Your build could not be found within the database.
                <br/>
                If needed<b>,</b> you may contact <hl>xt.ss</hl> on Discord for more
                details.`},m(t,i){L(t,e,i)},d(t){t&&P(e)}}}function ag(n){let e;return{c(){e=g("span"),e.innerHTML=`Another build of yours with the same name already exists.
                <br/>
                Please use a different one.`},m(t,i){L(t,e,i)},i:ie,o:ie,d(t){t&&P(e)}}}function cg(n){let e,t,i,s;return i=new bi({props:{type:"id",source:"export"}}),{c(){e=g("span"),e.textContent="Your build's link has been copied to your clipboard.",t=C(),le(i.$$.fragment)},m(o,r){L(o,e,r),L(o,t,r),se(i,o,r),s=!0},i(o){s||(F(i.$$.fragment,o),s=!0)},o(o){W(i.$$.fragment,o),s=!1},d(o){o&&(P(e),P(t)),oe(i,o)}}}function ug(n){let e,t,i,s,o,r,l,a,c,u,d,f,_,h,b,v,w;const k=[og,sg,ig,ng,tg,eg],y=[];function I(D,z){return D[1]==-1&&D[2].message=="firebase_fail"?0:D[2].export.status?1:D[2].save.status==1?2:D[2].load.status==-1?3:D[2].delete.status==1?4:D[2].share.ongoing?5:-1}return~(o=I(n))&&(r=y[o]=k[o](n)),{c(){e=g("div"),t=g("span"),i=ae(n[4]),s=C(),r&&r.c(),l=C(),a=g("div"),c=g("div"),u=g("button"),d=ae("OK"),m(t,"id","messageTitle"),m(t,"class","svelte-nfbx2w"),m(u,"id",f=(n[1]==-1?"firstFocusable ":"")+"lastFocusable"),m(a,"class","promptOptions svelte-nfbx2w"),m(e,"class","promptMessage svelte-nfbx2w")},m(D,z){L(D,e,z),p(e,t),p(t,i),p(e,s),~o&&y[o].m(e,null),p(e,l),p(e,a),p(a,c),p(c,u),p(u,d),n[6](u),b=!0,v||(w=[O(u,"click",n[7]),O(u,"keydown",n[8]),O(e,"introstart",n[9])],v=!0)},p(D,[z]){(!b||z&16)&&Te(i,D[4]);let S=o;o=I(D),o===S?~o&&y[o].p(D,z):(r&&(We(),W(y[S],1,1,()=>{y[S]=null}),He()),~o?(r=y[o],r?r.p(D,z):(r=y[o]=k[o](D),r.c()),F(r,1),r.m(e,l)):r=null),(!b||z&2&&f!==(f=(D[1]==-1?"firstFocusable ":"")+"lastFocusable"))&&m(u,"id",f)},i(D){b||(F(r),D&&ye(()=>{b&&(h&&h.end(1),_=fa(e,Ze,{duration:200,delay:75}),_.start())}),b=!0)},o(D){W(r),_&&_.invalidate(),D&&(h=ha(e,Ze,{duration:200})),b=!1},d(D){D&&P(e),~o&&y[o].d(),n[6](null),D&&h&&h.end(),v=!1,be(w)}}}function dg(n,e,t){let i,s,o;J(n,x,_=>t(2,o=_));let{loadID:r}=e;const l=Wt();let a;function c(_){re[_?"unshift":"push"](()=>{a=_,t(3,a)})}const u=()=>{t(0,r=null),l("resetActions")},d=_=>{s==-1&&vt(_),yt(_)},f=()=>a.focus();return n.$$set=_=>{"loadID"in _&&t(0,r=_.loadID)},n.$$.update=()=>{n.$$.dirty&4&&t(1,s=o.export.status||o.save.status||o.load.status||o.delete.status),n.$$.dirty&6&&t(4,i=o.share.ongoing?"Share this build":`${o.export.status?"Export":o.save.status?"Save":o.load.status?"Load":"Delete"} ${s==1?"Success":"Failure"}!`)},[r,s,o,a,i,l,c,u,d,f]}class fg extends Ae{constructor(e){super(),Re(this,e,dg,ug,ge,{loadID:0})}}function hg(n){let e,t,i,s,o,r;return{c(){e=g("li"),t=g("button"),i=g("span"),s=ae(n[0]),m(i,"class","svelte-1opo0ke"),m(e,"class","svelte-1opo0ke"),te(e,"selectedItem",n[2])},m(l,a){L(l,e,a),p(e,t),p(t,i),p(i,s),n[7](e),o||(r=O(t,"click",n[3]),o=!0)},p(l,[a]){a&1&&Te(s,l[0]),a&4&&te(e,"selectedItem",l[2])},i:ie,o:ie,d(l){l&&P(e),n[7](null),o=!1,r()}}}function _g(n,e,t){let{chosenBuild:i,buildData:s,buildName:o,ddOpen:r}=e;const l=Wt();let a,c=i[0]==o;function u(){if(r){if(a.classList.contains("selectedItem")||t(2,c=!1),c)return;l("buildSelect",a),t(2,c=!0),t(5,r=!1),t(4,i=[o,s])}}function d(f){re[f?"unshift":"push"](()=>{a=f,t(1,a)})}return n.$$set=f=>{"chosenBuild"in f&&t(4,i=f.chosenBuild),"buildData"in f&&t(6,s=f.buildData),"buildName"in f&&t(0,o=f.buildName),"ddOpen"in f&&t(5,r=f.ddOpen)},[o,a,c,u,i,r,s,d]}class pg extends Ae{constructor(e){super(),Re(this,e,_g,hg,ge,{chosenBuild:4,buildData:6,buildName:0,ddOpen:5})}}function vl(n,e,t){const i=n.slice();return i[25]=e[t][0],i[26]=e[t][1],i}function yl(n){let e,t,i,s;function o(a){n[13](a)}function r(a){n[14](a)}let l={buildData:n[26],buildName:n[25]};return n[0]!==void 0&&(l.chosenBuild=n[0]),n[1]!==void 0&&(l.ddOpen=n[1]),e=new pg({props:l}),re.push(()=>Le(e,"chosenBuild",o)),re.push(()=>Le(e,"ddOpen",r)),e.$on("buildSelect",n[11]),{c(){le(e.$$.fragment)},m(a,c){se(e,a,c),s=!0},p(a,c){const u={};c&16&&(u.buildData=a[26]),c&16&&(u.buildName=a[25]),!t&&c&1&&(t=!0,u.chosenBuild=a[0],Me(()=>t=!1)),!i&&c&2&&(i=!0,u.ddOpen=a[1],Me(()=>i=!1)),e.$set(u)},i(a){s||(F(e.$$.fragment,a),s=!0)},o(a){W(e.$$.fragment,a),s=!1},d(a){oe(e,a)}}}function mg(n){let e,t,i,s,o,r,l,a=De(Object.entries(n[4])),c=[];for(let d=0;d<a.length;d+=1)c[d]=yl(vl(n,a,d));const u=d=>W(c[d],1,1,()=>{c[d]=null});return{c(){e=g("div"),t=g("input"),i=C(),s=g("ul");for(let d=0;d<c.length;d+=1)c[d].c();m(t,"type","text"),m(t,"class","searchBarInput svelte-p20blu"),m(t,"placeholder","Search..."),m(s,"class","svelte-p20blu"),te(s,"no-scrollbar",n[8].length<=4),m(e,"class","dropdown svelte-p20blu"),te(e,"ddOpen",n[1])},m(d,f){L(d,e,f),p(e,t),n[12](t),p(e,i),p(e,s);for(let _=0;_<c.length;_+=1)c[_]&&c[_].m(s,null);n[15](s),n[16](e),o=!0,r||(l=[O(t,"input",n[10]),O(t,"keydown",n[9]),O(e,"transitionend",n[17]),O(e,"transitioncancel",n[18])],r=!0)},p(d,[f]){if(f&2067){a=De(Object.entries(d[4]));let _;for(_=0;_<a.length;_+=1){const h=vl(d,a,_);c[_]?(c[_].p(h,f),F(c[_],1)):(c[_]=yl(h),c[_].c(),F(c[_],1),c[_].m(s,null))}for(We(),_=a.length;_<c.length;_+=1)u(_);He()}(!o||f&256)&&te(s,"no-scrollbar",d[8].length<=4),(!o||f&2)&&te(e,"ddOpen",d[1])},i(d){if(!o){for(let f=0;f<a.length;f+=1)F(c[f]);o=!0}},o(d){c=c.filter(Boolean);for(let f=0;f<c.length;f+=1)W(c[f]);o=!1},d(d){d&&P(e),n[12](null),ft(c,d),n[15](null),n[16](null),r=!1,be(l)}}}function gg(n,e,t){let i;J(n,Nt,E=>t(4,i=E));let{chosenBuild:s,ddOpen:o=!1,dropdown:r}=e;const l=Wt();let a,c,u,d,f={},_=!1,h=[];function b(E){!E.shiftKey&&E.key=="Tab"&&(E.preventDefault(),setTimeout(()=>a.focus()))}function v(){c&&c.removeEventListener("keydown",b),y(),c&&c.addEventListener("keydown",b)}function w(E){E.shiftKey&&E.key=="Tab"&&(E.preventDefault(),setTimeout(()=>(c.querySelector("button")||c).focus()))}function k(){ou(a.value,f),v()}function y(){c&&c.classList.remove("lastElement"),t(8,h=u.querySelectorAll("li:not(.hidden)")),c=h[h.length-1],c?c.classList.add("lastElement"):c=a}function I(E){l("buildSelect"),t(6,d=E.detail);let T=u.querySelector(".selectedItem");T&&T!=E.detail&&T.classList.remove("selectedItem"),t(7,_=!0)}function D(E){re[E?"unshift":"push"](()=>{a=E,t(5,a)})}function z(E){s=E,t(0,s)}function S(E){o=E,t(1,o)}function j(E){re[E?"unshift":"push"](()=>{u=E,t(3,u)})}function B(E){re[E?"unshift":"push"](()=>{r=E,t(2,r)})}const Q=E=>{E.propertyName=="visibility"&&(_&&(t(7,_=!1),t(5,a.value="",a),k()),!o&&d&&u.scrollTo(0,d.offsetTop),xi(a,o))},N=E=>{E.propertyName=="visibility"&&(t(7,_=!1),xi(a,o))};return n.$$set=E=>{"chosenBuild"in E&&t(0,s=E.chosenBuild),"ddOpen"in E&&t(1,o=E.ddOpen),"dropdown"in E&&t(2,r=E.dropdown)},n.$$.update=()=>{if(n.$$.dirty&24&&u){t(8,h=u.querySelectorAll("li:not(.hidden)"));for(let E=0;E<u.childElementCount;E++)f[Object.keys(i)[E]]=u.children[E];y(),v()}},[s,o,r,u,i,a,d,_,h,w,k,I,D,z,S,j,B,Q,N]}class Vo extends Ae{constructor(e){super(),Re(this,e,gg,mg,ge,{chosenBuild:0,ddOpen:1,dropdown:2})}}function wl(n){let e,t=(n[6]>n[5]*.8?n[11].slice(0,20)+"<b>...</b>":n[11])+"",i;return{c(){e=g("span"),ye(()=>n[15].call(e))},m(s,o){L(s,e,o),e.innerHTML=t,i=nn(e,n[15].bind(e))},p(s,o){o[0]&2144&&t!==(t=(s[6]>s[5]*.8?s[11].slice(0,20)+"<b>...</b>":s[11])+"")&&(e.innerHTML=t)},d(s){s&&P(e),i()}}}function kl(n){let e;return{c(){e=g("span"),e.textContent="New changes! Exiting will erase them.",m(e,"id","alert")},m(t,i){L(t,e,i)},d(t){t&&P(e)}}}function bg(n){let e,t,i,s,o,r=n[11],l,a,c,u,d,f,_,h,b,v,w,k,y,I,D=275-n[2].length+"",z,S,j,B,Q,N,E,T,$,R,A,M,H,X,he,ce,ne,q,Z,ue,Ee,Se=wl(n),ze=n[1]!=null&&n[1]!=n[2]&&kl();function ct(fe){n[26](fe)}function de(fe){n[27](fe)}function je(fe){n[28](fe)}let tt={};return n[0]!==void 0&&(tt.chosenBuild=n[0]),n[3]!==void 0&&(tt.ddOpen=n[3]),n[9]!==void 0&&(tt.dropdown=n[9]),X=new Vo({props:tt}),re.push(()=>Le(X,"chosenBuild",ct)),re.push(()=>Le(X,"ddOpen",de)),re.push(()=>Le(X,"dropdown",je)),X.$on("buildSelect",n[29]),{c(){e=g("div"),t=g("div"),i=g("span"),i.textContent="Save to:",s=C(),o=g("button"),Se.c(),l=C(),a=g("iconify-icon"),d=C(),f=g("div"),_=g("div"),h=g("span"),h.textContent="Description / Notes:",b=C(),ze&&ze.c(),v=C(),w=g("textarea"),y=C(),I=g("span"),z=ae(D),S=C(),j=g("div"),B=g("div"),Q=g("button"),N=ae("CANCEL"),T=C(),$=g("div"),R=g("button"),A=ae("SAVE"),H=C(),le(X.$$.fragment),Pe(a,"icon","iconamoon:arrow-down-2-fill"),m(o,"id","firstFocusable"),o.disabled=c=n[12].save.status==0,m(o,"class","promptDDButton svelte-106wt5q"),ye(()=>n[17].call(o)),te(o,"ddOpen",n[3]),m(t,"class","chosenBuildCont"),m(w,"class","buildDescInput"),w.disabled=k=n[12].save.status==0,m(w,"placeholder","[Empty]"),m(w,"maxlength","275"),m(w,"autocomplete","off"),m(I,"class","charCounter"),m(I,"id","buildDesc"),m(f,"class","buildDescCont"),Q.disabled=E=n[12].save.status==0,m(R,"id","lastFocusable"),R.disabled=M=n[12].save.status==0,m(j,"class","promptOptions"),m(e,"class","buildSaver")},m(fe,Ue){L(fe,e,Ue),p(e,t),p(t,i),p(t,s),p(t,o),Se.m(o,null),p(o,l),p(o,a),n[16](o),u=nn(o,n[17].bind(o)),p(e,d),p(e,f),p(f,_),p(_,h),p(_,b),ze&&ze.m(_,null),p(f,v),p(f,w),n[19](w),Bt(w,n[10]),p(f,y),p(f,I),p(I,z),p(e,S),p(e,j),p(j,B),p(B,Q),p(Q,N),n[23](Q),p(j,T),p(j,$),p($,R),p(R,A),p(e,H),se(X,e,null),Z=!0,ue||(Ee=[O(window,"mousedown",n[14]),O(o,"click",n[18]),O(o,"keydown",vt),O(w,"input",n[20]),O(w,"input",n[21]),O(w,"keydown",n[22]),O(Q,"click",n[24]),O(R,"click",n[25]),O(R,"keydown",yt),O(e,"introstart",n[30]),O(e,"keydown",n[31])],ue=!0)},p(fe,Ue){Ue[0]&2048&&ge(r,r=fe[11])?(Se.d(1),Se=wl(fe),Se.c(),Se.m(o,l)):Se.p(fe,Ue),(!Z||Ue[0]&4096&&c!==(c=fe[12].save.status==0))&&(o.disabled=c),(!Z||Ue[0]&8)&&te(o,"ddOpen",fe[3]),fe[1]!=null&&fe[1]!=fe[2]?ze||(ze=kl(),ze.c(),ze.m(_,null)):ze&&(ze.d(1),ze=null),(!Z||Ue[0]&4096&&k!==(k=fe[12].save.status==0))&&(w.disabled=k),Ue[0]&1024&&Bt(w,fe[10]),(!Z||Ue[0]&4)&&D!==(D=275-fe[2].length+"")&&Te(z,D),(!Z||Ue[0]&4096&&E!==(E=fe[12].save.status==0))&&(Q.disabled=E),(!Z||Ue[0]&4096&&M!==(M=fe[12].save.status==0))&&(R.disabled=M);const Ve={};!he&&Ue[0]&1&&(he=!0,Ve.chosenBuild=fe[0],Me(()=>he=!1)),!ce&&Ue[0]&8&&(ce=!0,Ve.ddOpen=fe[3],Me(()=>ce=!1)),!ne&&Ue[0]&512&&(ne=!0,Ve.dropdown=fe[9],Me(()=>ne=!1)),X.$set(Ve)},i(fe){Z||(F(X.$$.fragment,fe),fe&&ye(()=>{Z&&(q||(q=me(e,Ze,{duration:250},!0)),q.run(1))}),Z=!0)},o(fe){W(X.$$.fragment,fe),fe&&(q||(q=me(e,Ze,{duration:250},!1)),q.run(0)),Z=!1},d(fe){fe&&P(e),Se.d(fe),n[16](null),u(),ze&&ze.d(),n[19](null),n[23](null),oe(X),fe&&q&&q.end(),ue=!1,be(Ee)}}}function vg(n,e,t){let i,s,o,r,l,a,c,u;J(n,x,q=>t(12,r=q)),J(n,wt,q=>t(32,l=q)),J(n,Nt,q=>t(33,a=q)),J(n,zt,q=>t(34,c=q)),J(n,Mt,q=>t(35,u=q));let d=!1,f,_,h,b,v,w,k=Object.entries(a)[0],y=null;function I(){G(x,r.save.status=0,r);let q=ru(u,c),Z=y==null?s:y==""?"[Empty]":y,ue=k[1].id;q.name=i,q.desc=Z,hs(Kt(jn(Hn),`builds/${ue}`),q).then(()=>{G(x,r.save.status=1,r);let Ee={...a};Ee[i].desc=Z,Uo(),Nt.update(()=>Ee),G(wt,l=q,l),G(wt,l.id=ue,l)}).catch(()=>{G(x,r.save.status=-1,r),G(x,r.message="firebase_fail",r)})}const D=q=>{!f.contains(q.target)&&!w.contains(q.target)&&t(3,d=!1)};function z(){h=this.offsetWidth,t(6,h)}function S(q){re[q?"unshift":"push"](()=>{f=q,t(4,f)})}function j(){_=this.offsetWidth,t(5,_)}const B=()=>{r.save.status!=0&&t(3,d=!d)};function Q(q){re[q?"unshift":"push"](()=>{b=q,t(7,b)})}function N(){o=this.value,t(10,o),t(1,y),t(2,s),t(0,k)}const E=q=>{t(1,y=$i(q.target.value,275))},T=q=>{r.save.status==0&&q.preventDefault(),$s(b,q.target.value,275)};function $(q){re[q?"unshift":"push"](()=>{v=q,t(8,v)})}const R=()=>{r.save.status!=0&&G(x,r.save.ongoing=!1,r)},A=()=>{r.save.status!=0&&I()};function M(q){k=q,t(0,k)}function H(q){d=q,t(3,d)}function X(q){w=q,t(9,w)}const he=()=>t(1,y=null),ce=()=>v.focus(),ne=q=>{q.key=="Escape"&&(t(3,d=!1),f.focus())};return n.$$.update=()=>{n.$$.dirty[0]&1&&t(11,i=k[0]),n.$$.dirty[0]&1&&t(2,s=k[1].desc),n.$$.dirty[0]&6&&t(10,o=y??s)},[k,y,s,d,f,_,h,b,v,w,o,i,r,I,D,z,S,j,B,Q,N,E,T,$,R,A,M,H,X,he,ce,ne]}class yg extends Ae{constructor(e){super(),Re(this,e,vg,bg,ge,{},null,[-1,-1])}}function wg(n){let e,t,i,s,o,r,l,a,c;return{c(){e=g("div"),t=g("span"),t.textContent="ID:",i=C(),s=g("input"),m(s,"class","buildIDInput svelte-w8elgk"),s.disabled=o=n[11].load.status==0,m(s,"type","text"),m(s,"placeholder","Example ID: -NDqeA1Scn0EAJcYWN3b"),m(s,"maxlength","25"),m(e,"class","buildIDCont svelte-w8elgk")},m(u,d){L(u,e,d),p(e,t),p(e,i),p(e,s),n[23](s),Bt(s,n[10]),l=!0,a||(c=[O(s,"input",n[24]),O(s,"input",n[25]),O(s,"keydown",n[26])],a=!0)},p(u,d){(!l||d[0]&2048&&o!==(o=u[11].load.status==0))&&(s.disabled=o),d[0]&1024&&s.value!==u[10]&&Bt(s,u[10])},i(u){l||(u&&ye(()=>{l&&(r||(r=me(e,Je,{duration:150},!0)),r.run(1))}),l=!0)},o(u){u&&(r||(r=me(e,Je,{duration:150},!1)),r.run(0)),l=!1},d(u){u&&P(e),n[23](null),u&&r&&r.end(),a=!1,be(c)}}}function kg(n){let e,t,i,s,o=n[9],r,l,a,c,u,d,f,_,h=Cl(n);return{c(){e=g("div"),t=g("span"),t.textContent="Load:",i=C(),s=g("button"),h.c(),r=C(),l=g("iconify-icon"),Pe(l,"icon","iconamoon:arrow-down-2-fill"),s.disabled=a=n[11].load.status==0,m(s,"class","promptDDButton svelte-w8elgk"),ye(()=>n[21].call(s)),te(s,"ddOpen",n[8]),m(e,"class","chosenBuildCont svelte-w8elgk")},m(b,v){L(b,e,v),p(e,t),p(e,i),p(e,s),h.m(s,null),p(s,r),p(s,l),n[20](s),c=nn(s,n[21].bind(s)),d=!0,f||(_=O(s,"click",n[22]),f=!0)},p(b,v){v[0]&512&&ge(o,o=b[9])?(h.d(1),h=Cl(b),h.c(),h.m(s,r)):h.p(b,v),(!d||v[0]&2048&&a!==(a=b[11].load.status==0))&&(s.disabled=a),(!d||v[0]&256)&&te(s,"ddOpen",b[8])},i(b){d||(b&&ye(()=>{d&&(u||(u=me(e,Je,{duration:150},!0)),u.run(1))}),d=!0)},o(b){b&&(u||(u=me(e,Je,{duration:150},!1)),u.run(0)),d=!1},d(b){b&&P(e),h.d(b),n[20](null),c(),b&&u&&u.end(),f=!1,_()}}}function Cl(n){let e,t=(n[6]>n[5]*.7?n[9].slice(0,20)+"<b>...</b>":n[9])+"",i;return{c(){e=g("span"),ye(()=>n[19].call(e))},m(s,o){L(s,e,o),e.innerHTML=t,i=nn(e,n[19].bind(e))},p(s,o){o[0]&608&&t!==(t=(s[6]>s[5]*.7?s[9].slice(0,20)+"<b>...</b>":s[9])+"")&&(e.innerHTML=t)},d(s){s&&P(e),i()}}}function El(n){let e,t,i,s,o;function r(u){n[29](u)}function l(u){n[30](u)}function a(u){n[31](u)}let c={};return n[3]!==void 0&&(c.chosenBuild=n[3]),n[8]!==void 0&&(c.ddOpen=n[8]),n[7]!==void 0&&(c.dropdown=n[7]),e=new Vo({props:c}),re.push(()=>Le(e,"chosenBuild",r)),re.push(()=>Le(e,"ddOpen",l)),re.push(()=>Le(e,"dropdown",a)),{c(){le(e.$$.fragment)},m(u,d){se(e,u,d),o=!0},p(u,d){const f={};!t&&d[0]&8&&(t=!0,f.chosenBuild=u[3],Me(()=>t=!1)),!i&&d[0]&256&&(i=!0,f.ddOpen=u[8],Me(()=>i=!1)),!s&&d[0]&128&&(s=!0,f.dropdown=u[7],Me(()=>s=!1)),e.$set(f)},i(u){o||(F(e.$$.fragment,u),o=!0)},o(u){W(e.$$.fragment,u),o=!1},d(u){oe(e,u)}}}function Cg(n){let e,t,i,s,o,r,l,a,c,u,d,f,_,h,b,v,w,k,y,I,D,z,S,j,B,Q,N,E,T,$,R,A,M,H,X;const he=[kg,wg],ce=[];function ne(Z,ue){return Z[2]?0:1}k=ne(n),y=ce[k]=he[k](n);let q=n[2]&&El(n);return{c(){e=g("div"),t=g("span"),t.textContent="Load build via:",i=C(),s=g("div"),o=g("div"),r=g("button"),l=ae("Local saves"),u=C(),d=g("div"),f=g("button"),_=ae("Exported ID"),v=C(),w=g("div"),y.c(),I=C(),D=g("div"),z=g("div"),S=g("button"),j=ae("CANCEL"),Q=C(),N=g("div"),E=g("button"),T=ae("LOAD"),R=C(),q&&q.c(),m(t,"class","svelte-w8elgk"),m(r,"id",a=n[2]?"firstFocusable":""),r.disabled=c=n[11].load.status==0||!n[12],m(r,"class","svelte-w8elgk"),te(r,"chosen",n[2]),te(r,"unavailable",!n[12]),m(o,"class","svelte-w8elgk"),m(f,"id",h=n[2]?"":"firstFocusable"),f.disabled=b=n[11].load.status==0,m(f,"class","svelte-w8elgk"),te(f,"chosen",!n[2]),m(d,"class","svelte-w8elgk"),m(s,"class","loadMethodRadio svelte-w8elgk"),m(w,"class","loadMethodCont svelte-w8elgk"),S.disabled=B=n[11].load.status==0,m(E,"id","lastFocusable"),E.disabled=$=n[11].load.status==0,m(D,"class","promptOptions svelte-w8elgk"),m(e,"class","buildLoader svelte-w8elgk")},m(Z,ue){L(Z,e,ue),p(e,t),p(e,i),p(e,s),p(s,o),p(o,r),p(r,l),p(s,u),p(s,d),p(d,f),p(f,_),p(e,v),p(e,w),ce[k].m(w,null),p(e,I),p(e,D),p(D,z),p(z,S),p(S,j),n[27](S),p(D,Q),p(D,N),p(N,E),p(E,T),p(e,R),q&&q.m(e,null),M=!0,H||(X=[O(window,"mousedown",n[14]),O(r,"click",n[15]),O(r,"keydown",n[16]),O(f,"click",n[17]),O(f,"keydown",n[18]),O(S,"click",n[28]),O(E,"keydown",yt),O(E,"click",n[13]),O(e,"introstart",n[32]),O(e,"keydown",n[33])],H=!0)},p(Z,ue){(!M||ue[0]&4&&a!==(a=Z[2]?"firstFocusable":""))&&m(r,"id",a),(!M||ue[0]&6144&&c!==(c=Z[11].load.status==0||!Z[12]))&&(r.disabled=c),(!M||ue[0]&4)&&te(r,"chosen",Z[2]),(!M||ue[0]&4096)&&te(r,"unavailable",!Z[12]),(!M||ue[0]&4&&h!==(h=Z[2]?"":"firstFocusable"))&&m(f,"id",h),(!M||ue[0]&2048&&b!==(b=Z[11].load.status==0))&&(f.disabled=b),(!M||ue[0]&4)&&te(f,"chosen",!Z[2]);let Ee=k;k=ne(Z),k===Ee?ce[k].p(Z,ue):(We(),W(ce[Ee],1,1,()=>{ce[Ee]=null}),He(),y=ce[k],y?y.p(Z,ue):(y=ce[k]=he[k](Z),y.c()),F(y,1),y.m(w,null)),(!M||ue[0]&2048&&B!==(B=Z[11].load.status==0))&&(S.disabled=B),(!M||ue[0]&2048&&$!==($=Z[11].load.status==0))&&(E.disabled=$),Z[2]?q?(q.p(Z,ue),ue[0]&4&&F(q,1)):(q=El(Z),q.c(),F(q,1),q.m(e,null)):q&&(We(),W(q,1,1,()=>{q=null}),He())},i(Z){M||(F(y),F(q),Z&&ye(()=>{M&&(A||(A=me(e,Ze,{duration:250},!0)),A.run(1))}),M=!0)},o(Z){W(y),W(q),Z&&(A||(A=me(e,Ze,{duration:250},!1)),A.run(0)),M=!1},d(Z){Z&&P(e),ce[k].d(),n[27](null),q&&q.d(),Z&&A&&A.end(),H=!1,be(X)}}}function Eg(n,e,t){let i,s,o;J(n,x,q=>t(11,i=q)),J(n,Nt,q=>t(34,s=q)),J(n,Xt,q=>t(12,o=q));const r=Wt();let l,a,c,u,d,f,_=o,h=!1,b=o?Object.entries(s)[0]:null,v,w="";function k(){if(!_&&!w.startsWith("-N")){G(x,i.load.status=-1,i),G(x,i.message="invalid_id",i);return}let q=xc(jn(Hn,"builds"),Zc()),Z=0;G(x,i.load.status=0,i),Jc(q).then(ue=>{let Ee=_?b[1].id:w;for(let Se in ue.val()){if(Se==Ee){r("buildLoad",{build:ue.val()[Se],id:Se});break}else Z==Object.keys(ue.val()).length-1&&(G(x,i.load.status=-1,i),G(x,i.message=_?"not_found":"invalid_id",i));Z++}}).catch(()=>{G(x,i.load.status=-1,i),G(x,i.message="firebase_fail",i)})}const y=q=>{l&&!l.contains(q.target)&&!f.contains(q.target)&&t(8,h=!1)},I=()=>{i.load.status!=0&&o&&t(2,_=!0)},D=q=>{_&&vt(q)},z=()=>{i.load.status!=0&&t(2,_=!1)},S=q=>{_||vt(q)};function j(){d=this.offsetWidth,t(6,d)}function B(q){re[q?"unshift":"push"](()=>{l=q,t(0,l)})}function Q(){u=this.offsetWidth,t(5,u)}const N=()=>{i.load.status!=0&&t(8,h=!h)};function E(q){re[q?"unshift":"push"](()=>{c=q,t(1,c)})}function T(){w=this.value,t(10,w)}const $=q=>{t(10,w=$i(q.target.value,25))},R=q=>{i.load.status==0&&q.preventDefault()};function A(q){re[q?"unshift":"push"](()=>{a=q,t(4,a)})}const M=()=>{i.load.status!=0&&G(x,i.load.ongoing=!1,i)};function H(q){b=q,t(3,b)}function X(q){h=q,t(8,h)}function he(q){f=q,t(7,f)}const ce=()=>a.focus(),ne=q=>{q.key=="Escape"&&(t(8,h=!1),l.focus())};return n.$$.update=()=>{n.$$.dirty[0]&8&&t(9,v=b!=null?b[0]:null),n.$$.dirty[0]&7&&setTimeout(_?()=>l.focus():()=>c.focus())},[l,c,_,b,a,u,d,f,h,v,w,i,o,k,y,I,D,z,S,j,B,Q,N,E,T,$,R,A,M,H,X,he,ce,ne]}class Sg extends Ae{constructor(e){super(),Re(this,e,Eg,Cg,ge,{},null,[-1,-1])}}function Sl(n){let e,t=(n[3]>n[4]*.8?n[8].slice(0,20)+"<b>...</b>":n[8])+"",i;return{c(){e=g("span"),ye(()=>n[12].call(e))},m(s,o){L(s,e,o),e.innerHTML=t,i=nn(e,n[12].bind(e))},p(s,o){o&280&&t!==(t=(s[3]>s[4]*.8?s[8].slice(0,20)+"<b>...</b>":s[8])+"")&&(e.innerHTML=t)},d(s){s&&P(e),i()}}}function Ig(n){let e,t,i,s,o,r=n[8],l,a,c,u,d,f,_,h,b,v,w,k,y,I,D,z,S,j,B,Q,N,E,T,$,R,A,M,H,X=Sl(n);f=new mt({props:{text:"I'm aware that this action is irreversible and want to erase this build from the database."}}),f.$on("toggle",n[16]);function he(Z){n[21](Z)}function ce(Z){n[22](Z)}function ne(Z){n[23](Z)}let q={};return n[0]!==void 0&&(q.chosenBuild=n[0]),n[6]!==void 0&&(q.ddOpen=n[6]),n[5]!==void 0&&(q.dropdown=n[5]),N=new Vo({props:q}),re.push(()=>Le(N,"chosenBuild",he)),re.push(()=>Le(N,"ddOpen",ce)),re.push(()=>Le(N,"dropdown",ne)),{c(){e=g("div"),t=g("div"),i=g("span"),i.textContent="Delete:",s=C(),o=g("button"),X.c(),l=C(),a=g("iconify-icon"),d=C(),le(f.$$.fragment),_=C(),h=g("div"),b=g("div"),v=g("button"),w=ae("CANCEL"),I=C(),D=g("div"),z=g("button"),S=ae("DELETE"),Q=C(),le(N.$$.fragment),Pe(a,"icon","iconamoon:arrow-down-2-fill"),m(o,"class","promptDDButton svelte-1t9ajmz"),m(o,"id","firstFocusable"),o.disabled=c=n[9].delete.status==0,ye(()=>n[14].call(o)),te(o,"ddOpen",n[6]),m(t,"class","chosenBuildCont"),m(v,"id",k=n[7]?"":"lastFocusable"),v.disabled=y=n[9].delete.status==0,z.disabled=j=!n[7]||n[9].delete.status==0,m(z,"id",B=n[7]?"lastFocusable":""),te(z,"unavailable",!n[7]),m(h,"class","promptOptions svelte-1t9ajmz"),m(e,"class","buildDeleter svelte-1t9ajmz")},m(Z,ue){L(Z,e,ue),p(e,t),p(t,i),p(t,s),p(t,o),X.m(o,null),p(o,l),p(o,a),n[13](o),u=nn(o,n[14].bind(o)),p(e,d),se(f,e,null),p(e,_),p(e,h),p(h,b),p(b,v),p(v,w),n[17](v),p(h,I),p(h,D),p(D,z),p(z,S),p(e,Q),se(N,e,null),A=!0,M||(H=[O(window,"mousedown",n[11]),O(o,"click",n[15]),O(o,"keydown",vt),O(v,"click",n[18]),O(v,"keydown",n[19]),O(z,"click",n[20]),O(z,"keydown",yt),O(e,"introstart",n[24]),O(e,"keydown",n[25])],M=!0)},p(Z,[ue]){ue&256&&ge(r,r=Z[8])?(X.d(1),X=Sl(Z),X.c(),X.m(o,l)):X.p(Z,ue),(!A||ue&512&&c!==(c=Z[9].delete.status==0))&&(o.disabled=c),(!A||ue&64)&&te(o,"ddOpen",Z[6]),(!A||ue&128&&k!==(k=Z[7]?"":"lastFocusable"))&&m(v,"id",k),(!A||ue&512&&y!==(y=Z[9].delete.status==0))&&(v.disabled=y),(!A||ue&640&&j!==(j=!Z[7]||Z[9].delete.status==0))&&(z.disabled=j),(!A||ue&128&&B!==(B=Z[7]?"lastFocusable":""))&&m(z,"id",B),(!A||ue&128)&&te(z,"unavailable",!Z[7]);const Ee={};!E&&ue&1&&(E=!0,Ee.chosenBuild=Z[0],Me(()=>E=!1)),!T&&ue&64&&(T=!0,Ee.ddOpen=Z[6],Me(()=>T=!1)),!$&&ue&32&&($=!0,Ee.dropdown=Z[5],Me(()=>$=!1)),N.$set(Ee)},i(Z){A||(F(f.$$.fragment,Z),F(N.$$.fragment,Z),Z&&ye(()=>{A&&(R||(R=me(e,Ze,{duration:250},!0)),R.run(1))}),A=!0)},o(Z){W(f.$$.fragment,Z),W(N.$$.fragment,Z),Z&&(R||(R=me(e,Ze,{duration:250},!1)),R.run(0)),A=!1},d(Z){Z&&P(e),X.d(Z),n[13](null),u(),oe(f),n[17](null),oe(N),Z&&R&&R.end(),M=!1,be(H)}}}function Tg(n,e,t){let i,s,o,r;J(n,x,R=>t(9,s=R)),J(n,Nt,R=>t(26,o=R)),J(n,wt,R=>t(27,r=R));let l,a,c,u,d,f=!1,_=Object.entries(o)[0],h=!1;function b(){G(x,s.delete.status=0,s);let R=_[1].id;fp(Kt(jn(Hn),`builds/${R}`)).then(()=>{G(x,s.delete.status=1,s),r&&R==r.id&&G(wt,r=null,r);let A={...o};delete A[i],Uo(),Nt.update(()=>A)}).catch(A=>{G(x,s.delete.status=-1,s),G(x,s.message="firebase_fail",s)})}const v=R=>{!a.contains(R.target)&&!d.contains(R.target)&&t(6,f=!1)};function w(){c=this.offsetWidth,t(3,c)}function k(R){re[R?"unshift":"push"](()=>{a=R,t(2,a)})}function y(){u=this.offsetWidth,t(4,u)}const I=()=>{s.delete.status!=0&&t(6,f=!f)},D=R=>t(7,h=R.detail);function z(R){re[R?"unshift":"push"](()=>{l=R,t(1,l)})}const S=()=>{s.delete.status!=0&&G(x,s.delete.ongoing=!1,s)},j=R=>{h||yt(R)},B=()=>{h&&s.delete.status!=0&&b()};function Q(R){_=R,t(0,_)}function N(R){f=R,t(6,f)}function E(R){d=R,t(5,d)}const T=()=>l.focus(),$=R=>{R.key=="Escape"&&(t(6,f=!1),a.focus())};return n.$$.update=()=>{n.$$.dirty&1&&t(8,i=_[0])},[_,l,a,c,u,d,f,h,i,s,b,v,w,k,y,I,D,z,S,j,B,Q,N,E,T,$]}class Ng extends Ae{constructor(e){super(),Re(this,e,Tg,Ig,ge,{})}}function Og(n){let e,t,i,s,o,r,l,a,c,u,d,f,_,h;return{c(){e=g("div"),t=g("div"),i=g("button"),i.innerHTML='<iconify-icon icon="tabler:coins" class="svelte-czj12i"></iconify-icon> <span class="tooltip" id="right">Build costs</span>',s=C(),o=g("div"),r=g("button"),r.innerHTML='<iconify-icon icon="codicon:sparkle-filled" class="svelte-czj12i"></iconify-icon> <span class="tooltip" id="right">Add bonuses</span>',l=C(),a=g("div"),c=g("button"),c.innerHTML='<iconify-icon icon="fa-solid:random" class="svelte-czj12i"></iconify-icon> <span class="tooltip" id="right">Randomize build</span>',u=C(),d=g("div"),f=g("button"),f.innerHTML='<iconify-icon icon="fe:picture" class="svelte-czj12i"></iconify-icon> <span class="tooltip" id="right">Screenshot mode</span>',m(i,"class","svelte-czj12i"),m(t,"class","svelte-czj12i"),m(r,"class","svelte-czj12i"),m(o,"class","svelte-czj12i"),m(c,"class","svelte-czj12i"),m(a,"id","randomize"),m(a,"class","svelte-czj12i"),m(f,"class","svelte-czj12i"),m(d,"id","screenshot"),m(d,"class","svelte-czj12i"),m(e,"class","sideFeatures svelte-czj12i")},m(b,v){L(b,e,v),p(e,t),p(t,i),p(e,s),p(e,o),p(o,r),p(e,l),p(e,a),p(a,c),p(e,u),p(e,d),p(d,f),_||(h=[O(i,"click",n[2]),O(r,"click",n[3]),O(c,"click",n[4]),O(f,"click",n[5])],_=!0)},p:ie,i:ie,o:ie,d(b){b&&P(e),_=!1,be(h)}}}function Dg(n,e,t){let i,s;return J(n,gn,c=>t(0,i=c)),J(n,x,c=>t(1,s=c)),[i,s,c=>{tn(c),i||G(x,s.costs.ongoing=!0,s)},c=>{tn(c),i||G(x,s.bonus.ongoing=!0,s)},c=>{tn(c),i||G(x,s.randomize.ongoing=!0,s)},()=>{i||(G(x,s.screenshot.ongoing=!0,s),setTimeout(()=>G(x,s.screenshot.ongoing=!1,s),3500))}]}class Rg extends Ae{constructor(e){super(),Re(this,e,Dg,Og,ge,{})}}function Il(n,e,t){const i=n.slice();i[11]=e[t];const s=i[1].bonuses[0].name==i[11].name;return i[12]=s,i}function Tl(n){let e,t,i,s,o,r,l,a,c,u,d,f;function _(...b){return n[5](n[12],...b)}function h(...b){return n[6](n[11],...b)}return a=new mt({props:{text:n[11].name,checked:n[2][n[11].name]}}),a.$on("toggle",h),{c(){e=g("div"),t=g("a"),i=g("img"),l=C(),le(a.$$.fragment),c=C(),$e(i.src,s=n[11].image)||m(i,"src",s),m(i,"alt",""),m(i,"class","svelte-1xnyxhr"),m(t,"id",o=n[12]?"firstFocusable":""),m(t,"href",r=n[11].link),m(t,"target","_blank"),m(t,"class","svelte-1xnyxhr"),m(e,"class","svelte-1xnyxhr")},m(b,v){L(b,e,v),p(e,t),p(t,i),p(e,l),se(a,e,null),p(e,c),u=!0,d||(f=O(t,"keydown",_),d=!0)},p(b,v){n=b,(!u||v&2&&!$e(i.src,s=n[11].image))&&m(i,"src",s),(!u||v&2&&o!==(o=n[12]?"firstFocusable":""))&&m(t,"id",o),(!u||v&2&&r!==(r=n[11].link))&&m(t,"href",r);const w={};v&2&&(w.text=n[11].name),v&6&&(w.checked=n[2][n[11].name]),a.$set(w)},i(b){u||(F(a.$$.fragment,b),u=!0)},o(b){W(a.$$.fragment,b),u=!1},d(b){b&&P(e),oe(a),d=!1,f()}}}function Ag(n){let e,t,i,s,o,r,l,a,c,u,d,f,_,h=De(n[1].bonuses),b=[];for(let w=0;w<h.length;w+=1)b[w]=Tl(Il(n,h,w));const v=w=>W(b[w],1,1,()=>{b[w]=null});return{c(){e=g("div"),t=g("div");for(let w=0;w<b.length;w+=1)b[w].c();i=C(),s=g("div"),o=g("div"),r=g("button"),r.textContent="CLEAR",l=C(),a=g("div"),c=g("button"),c.textContent="OK",m(t,"class","bonusesCont svelte-1xnyxhr"),m(c,"id","lastFocusable"),m(s,"class","promptOptions svelte-1xnyxhr"),m(e,"class","bonusChooser svelte-1xnyxhr")},m(w,k){L(w,e,k),p(e,t);for(let y=0;y<b.length;y+=1)b[y]&&b[y].m(t,null);p(e,i),p(e,s),p(s,o),p(o,r),p(s,l),p(s,a),p(a,c),n[8](c),d=!0,f||(_=[O(r,"click",n[7]),O(c,"click",n[9]),O(c,"keydown",yt),O(e,"introstart",n[10])],f=!0)},p(w,[k]){if(k&14){h=De(w[1].bonuses);let y;for(y=0;y<h.length;y+=1){const I=Il(w,h,y);b[y]?(b[y].p(I,k),F(b[y],1)):(b[y]=Tl(I),b[y].c(),F(b[y],1),b[y].m(t,null))}for(We(),y=h.length;y<b.length;y+=1)v(y);He()}},i(w){if(!d){for(let k=0;k<h.length;k+=1)F(b[k]);w&&ye(()=>{d&&(u||(u=me(e,Ze,{duration:250},!0)),u.run(1))}),d=!0}},o(w){b=b.filter(Boolean);for(let k=0;k<b.length;k+=1)W(b[k]);w&&(u||(u=me(e,Ze,{duration:250},!1)),u.run(0)),d=!1},d(w){w&&P(e),ft(b,w),n[8](null),w&&u&&u.end(),f=!1,be(_)}}}function Pg(n,e,t){let i,s,o,r;J(n,Pt,h=>t(1,i=h)),J(n,Rn,h=>t(2,s=h)),J(n,gt,h=>t(3,o=h)),J(n,x,h=>t(4,r=h));let l;const a=(h,b)=>{h&&vt(b)},c=(h,b)=>{G(Rn,s[h.name]=b.detail,s);for(let v in o)b.detail?G(gt,o[v]+=h.stats[v],o):G(gt,o[v]-=h.stats[v],o),G(gt,o[v]=Math.round(o[v]*10)/10,o)},u=()=>{for(let h in s){if(!s[h])continue;let b=i.bonuses.find(v=>v.name==h);G(Rn,s[h]=!1,s);for(let v in o)G(gt,o[v]-=b.stats[v],o),G(gt,o[v]=Math.round(o[v]*10)/10,o)}};function d(h){re[h?"unshift":"push"](()=>{l=h,t(0,l)})}return[l,i,s,o,r,a,c,u,d,()=>G(x,r.bonus.ongoing=!1,r),()=>l.focus()]}class Mg extends Ae{constructor(e){super(),Re(this,e,Pg,Ag,ge,{})}}function Lg(n){let e;return{c(){e=g("span"),e.textContent=`Includes equipment such as ore-based armor and their variants,\r
            ore-based weapons, and shoes with no special stats`,m(e,"slot","tooltip"),m(e,"class","tooltip svelte-19uqsbs"),m(e,"id","right")},m(t,i){L(t,e,i)},p:ie,d(t){t&&P(e)}}}function Fg(n){let e,t,i,s,o,r,l,a,c,u,d,f,_,h,b,v,w,k,y,I,D,z,S,j,B,Q;return s=new mt({props:{text:"Force Mushroom Parasol",checked:n[0].parasol,first:!0}}),s.$on("toggle",n[5]),r=new mt({props:{text:"Randomize armor",checked:n[0].armor}}),r.$on("toggle",n[6]),a=new mt({props:{text:"Randomize gear",checked:n[0].gear}}),a.$on("toggle",n[7]),u=new mt({props:{text:"Allow 'basic' equipment",checked:n[0].basic,$$slots:{tooltip:[Lg]},$$scope:{ctx:n}}}),u.$on("toggle",n[8]),{c(){e=g("div"),t=g("span"),t.textContent="Randomize your build",i=C(),le(s.$$.fragment),o=C(),le(r.$$.fragment),l=C(),le(a.$$.fragment),c=C(),le(u.$$.fragment),d=C(),f=g("div"),_=g("div"),h=g("button"),b=ae("CANCEL"),w=C(),k=g("div"),y=g("button"),I=ae("ROLL THE DICE"),m(t,"class","svelte-19uqsbs"),m(h,"id",v=n[2]?"":"lastFocusable"),m(y,"id",D=n[2]?"lastFocusable":""),y.disabled=z=!n[2],m(f,"class","promptOptions"),m(e,"class","buildRandomizer svelte-19uqsbs")},m(N,E){L(N,e,E),p(e,t),p(e,i),se(s,e,null),p(e,o),se(r,e,null),p(e,l),se(a,e,null),p(e,c),se(u,e,null),p(e,d),p(e,f),p(f,_),p(_,h),p(h,b),n[9](h),p(f,w),p(f,k),p(k,y),p(y,I),j=!0,B||(Q=[O(h,"click",n[10]),O(h,"keydown",n[11]),O(y,"click",n[12]),O(y,"keydown",n[13]),O(e,"introstart",n[14])],B=!0)},p(N,[E]){const T={};E&1&&(T.checked=N[0].parasol),s.$set(T);const $={};E&1&&($.checked=N[0].armor),r.$set($);const R={};E&1&&(R.checked=N[0].gear),a.$set(R);const A={};E&1&&(A.checked=N[0].basic),E&16777216&&(A.$$scope={dirty:E,ctx:N}),u.$set(A),(!j||E&4&&v!==(v=N[2]?"":"lastFocusable"))&&m(h,"id",v),(!j||E&4&&D!==(D=N[2]?"lastFocusable":""))&&m(y,"id",D),(!j||E&4&&z!==(z=!N[2]))&&(y.disabled=z)},i(N){j||(F(s.$$.fragment,N),F(r.$$.fragment,N),F(a.$$.fragment,N),F(u.$$.fragment,N),N&&ye(()=>{j&&(S||(S=me(e,Ze,{duration:250},!0)),S.run(1))}),j=!0)},o(N){W(s.$$.fragment,N),W(r.$$.fragment,N),W(a.$$.fragment,N),W(u.$$.fragment,N),N&&(S||(S=me(e,Ze,{duration:250},!1)),S.run(0)),j=!1},d(N){N&&P(e),oe(s),oe(r),oe(a),oe(u),n[9](null),N&&S&&S.end(),B=!1,be(Q)}}}function Bg(n,e,t){let i,s,o,r,l,a,c,u;J(n,Jn,N=>t(0,s=N)),J(n,x,N=>t(3,o=N)),J(n,Pt,N=>t(15,r=N)),J(n,Fn,N=>t(16,l=N)),J(n,zt,N=>t(17,a=N)),J(n,Ln,N=>t(18,c=N)),J(n,Mt,N=>t(19,u=N));let d,f=["Bronze","Iron","Cobalt","Titanium","Gold","Onyx"],_=["Hardened","Royal"],h=["Black","Brown","Green","Red","White","Dark","Golden","Grey","Phantom"];function b(){if(s.armor){for(let N of Wn){let E=u[N]||gs;E.name&&c[N][E.name].querySelector("button").click()}setTimeout(()=>{for(let N of Wn)(function E(){let T=Math.floor(Math.random()*r[N].length);!c[N][r[N][T].name].classList.contains("selectedItem")&&(s.basic||!s.basic&&!v(r[N][T].name))?c[N][r[N][T].name].querySelector("button").click():E()})()})}if(s.gear){for(let N in a){let E=a[N]||bs;E.name&&l[N][E.name].querySelector("button").click()}setTimeout(()=>{let N=!1,E=kn.length,T=kn.length,$=[];for(let R in a)$.push(a[R].name);(function R(){setTimeout(()=>{let A=Math.floor(Math.random()*E);(function M(){let H=Math.floor(Math.random()*r.gear.length);!$.includes(r.gear[H].name)&&!l[T][r.gear[H].name].classList.contains("switchable")&&(!N||N&&H!=0)&&(s.basic||!s.basic&&!v(r.gear[H].name))?(l[T][r.gear[!N&&s.parasol&&!A?0:H].name].querySelector("button").click(),!N&&!A?N=!0:N||E--):M()})(),--T&&R()},25)})()},50)}G(x,o.randomize.ongoing=!1,o)}function v(N){let E=!1,T=N.split(" ");return E=f.includes(T[0])||_.includes(T[0])||N=="Mining Helmet"||h.includes(T[0]),E}const w=N=>G(Jn,s.parasol=N.detail,s),k=N=>G(Jn,s.armor=N.detail,s),y=N=>G(Jn,s.gear=N.detail,s),I=N=>G(Jn,s.basic=N.detail,s);function D(N){re[N?"unshift":"push"](()=>{d=N,t(1,d)})}const z=()=>G(x,o.randomize.ongoing=!1,o),S=N=>{i||yt(N)},j=()=>{i&&b()},B=N=>{i&&yt(N)},Q=()=>d.focus();return n.$$.update=()=>{n.$$.dirty&1&&t(2,i=s.armor||s.gear)},[s,d,i,o,b,w,k,y,I,D,z,S,j,B,Q]}class qg extends Ae{constructor(e){super(),Re(this,e,Bg,Fg,ge,{})}}function Nl(n,e,t){const i=n.slice();return i[5]=e[t],i}function zg(n){let e,t=De(n[1]),i=[];for(let s=0;s<t.length;s+=1)i[s]=Ol(Nl(n,t,s));return{c(){for(let s=0;s<i.length;s+=1)i[s].c();e=_t()},m(s,o){for(let r=0;r<i.length;r+=1)i[r]&&i[r].m(s,o);L(s,e,o)},p(s,o){if(o&2){t=De(s[1]);let r;for(r=0;r<t.length;r+=1){const l=Nl(s,t,r);i[r]?i[r].p(l,o):(i[r]=Ol(l),i[r].c(),i[r].m(e.parentNode,e))}for(;r<i.length;r+=1)i[r].d(1);i.length=t.length}},d(s){s&&P(e),ft(i,s)}}}function jg(n){let e,t,i;return{c(){e=g("span"),t=ae("— "),i=ae(n[1]),m(e,"id","info"),m(e,"class","svelte-ipufpe")},m(s,o){L(s,e,o),p(e,t),p(e,i)},p(s,o){o&2&&Te(i,s[1])},d(s){s&&P(e)}}}function Ol(n){let e,t,i=n[5]+"",s;return{c(){e=g("span"),t=ae("— "),s=ae(i),m(e,"id","info"),m(e,"class","svelte-ipufpe")},m(o,r){L(o,e,r),p(e,t),p(e,s)},p(o,r){r&2&&i!==(i=o[5]+"")&&Te(s,i)},d(o){o&&P(e)}}}function Wg(n){let e,t,i,s,o,r,l;function a(d,f){return typeof d[1]=="string"?jg:zg}let c=a(n),u=c(n);return{c(){e=g("li"),t=g("span"),i=ae("v"),s=ae(n[0]),o=C(),r=g("i"),r.textContent=`${n[3][n[2][1]-1]+" "+n[2][0]+(Math.floor(n[2][0]/10)===1?"th":iu[n[2][0]%10])+", 20"+n[2][2]}`,l=C(),u.c(),m(t,"id","version"),m(t,"class","svelte-ipufpe"),m(r,"id","date"),m(r,"class","svelte-ipufpe"),m(e,"class","svelte-ipufpe")},m(d,f){L(d,e,f),p(e,t),p(t,i),p(t,s),p(e,o),p(e,r),p(e,l),u.m(e,null)},p(d,[f]){f&1&&Te(s,d[0]),c===(c=a(d))&&u?u.p(d,f):(u.d(1),u=c(d),u&&(u.c(),u.m(e,null)))},i:ie,o:ie,d(d){d&&P(e),u.d()}}}function Hg(n,e,t){let{version:i,date:s,text:o}=e,r=s.split("/"),l=["January","February","March","April","May","June","July","August","Semptember","October","November","December"];return n.$$set=a=>{"version"in a&&t(0,i=a.version),"date"in a&&t(4,s=a.date),"text"in a&&t(1,o=a.text)},[i,o,r,l,s]}class dt extends Ae{constructor(e){super(),Re(this,e,Hg,Wg,ge,{version:0,date:4,text:1})}}function Ug(n){let e,t,i,s,o,r,l,a,c,u,d,f,_,h,b,v,w,k,y,I,D,z,S,j,B,Q,N,E,T,$,R,A,M,H,X,he,ce,ne,q,Z,ue,Ee,Se,ze,ct;return o=new dt({props:{version:"3.26.5",date:"22/3/24",text:"Added policy information"}}),l=new dt({props:{version:"3.26.4",date:"21/3/24",text:["Added feature to copy stats as text","Fixed detailed view prompt activating while scrolling"]}}),c=new dt({props:{version:"3.26.3",date:"24/2/24",text:"Reimplemented 'Strict' filter type in search options"}}),d=new dt({props:{version:"3.26.2",date:"22/2/24",text:"Fixed build randomizer not working properly"}}),_=new dt({props:{version:"3.26.1",date:"22/2/24",text:"Holding Shift and interacting with a dropdown item or simply holding down on it activates detailed view prompt"}}),b=new dt({props:{version:"3.26.0",date:"21/2/24",text:"Added detailed view prompt to armor and gear whenever the selected item's icon is clicked"}}),w=new dt({props:{version:"3.25.9",date:"14/1/24",text:"Added build costs visibility while 'screenshot mode' is active"}}),y=new dt({props:{version:"3.25.8",date:"11/1/24",text:"Fixed mutually exclusive gear staying disabled when deselecting the selected item"}}),D=new dt({props:{version:"3.25.7",date:"9/1/24",text:["Enabled 'unsaved changes' prompt to appear before leaving site when certain conditions are met","Fixed dropdowns blocking interactions behind them for a short period after being closed","Fixed dropdown sort incorrectly defaulting to the last sorted list in some cases"]}}),S=new dt({props:{version:"3.25.6",date:"7/1/24",text:"Fixed armor filter not working properly when 'Exclusive' filter type and 'No Stats' option were selected"}}),B=new dt({props:{version:"3.25.5",date:"6/1/24",text:["Fixed issue with switching gear slots while full weapon view was on","Tools are now selectable even if full weapon view is on"]}}),N=new dt({props:{version:"3.25.4",date:"5/1/24",text:'Fixed crash caused by using the build randomizer while "Force Mushroom Parasol" option was on'}}),T=new dt({props:{version:"3.25.3",date:"5/1/24",text:["Added feature to swap gear slots when clicking on an already selected gear item","Added visual cues to both deselecting and swapping options for dropdown items"]}}),R=new dt({props:{version:"3.25.2",date:"3/1/24",text:["Replaced 'Strict' filter type with 'Exclusive' filter type in search options of dropdowns","Added icons to resource links and credits"]}}),M=new dt({props:{version:"3.25.1",date:"2/1/24",text:`"Allow 'basic' equipment" option is no longer restricted when "Randomize gear" option isn't selected in the build randomizer`}}),X=new dt({props:{version:"3.25.0",date:"2/1/24",text:["Added 'Build Costs' feature","Removed spectacles from 'basic' equipment pool in the build randomizer"]}}),ce=new dt({props:{version:"3.24.5",date:"31/12/23",text:"v3 Release"}}),{c(){e=g("div"),t=g("span"),t.textContent="Changelog",i=C(),s=g("ul"),le(o.$$.fragment),r=C(),le(l.$$.fragment),a=C(),le(c.$$.fragment),u=C(),le(d.$$.fragment),f=C(),le(_.$$.fragment),h=C(),le(b.$$.fragment),v=C(),le(w.$$.fragment),k=C(),le(y.$$.fragment),I=C(),le(D.$$.fragment),z=C(),le(S.$$.fragment),j=C(),le(B.$$.fragment),Q=C(),le(N.$$.fragment),E=C(),le(T.$$.fragment),$=C(),le(R.$$.fragment),A=C(),le(M.$$.fragment),H=C(),le(X.$$.fragment),he=C(),le(ce.$$.fragment),ne=C(),q=g("div"),Z=g("div"),ue=g("button"),ue.textContent="OK",m(t,"id","title"),m(s,"id","contents"),m(s,"class","svelte-1k91i9r"),m(ue,"id","firstFocusable lastFocusable"),m(q,"class","promptOptions svelte-1k91i9r"),m(e,"class","infoPrompt svelte-1k91i9r")},m(de,je){L(de,e,je),p(e,t),p(e,i),p(e,s),se(o,s,null),p(s,r),se(l,s,null),p(s,a),se(c,s,null),p(s,u),se(d,s,null),p(s,f),se(_,s,null),p(s,h),se(b,s,null),p(s,v),se(w,s,null),p(s,k),se(y,s,null),p(s,I),se(D,s,null),p(s,z),se(S,s,null),p(s,j),se(B,s,null),p(s,Q),se(N,s,null),p(s,E),se(T,s,null),p(s,$),se(R,s,null),p(s,A),se(M,s,null),p(s,H),se(X,s,null),p(s,he),se(ce,s,null),p(e,ne),p(e,q),p(q,Z),p(Z,ue),n[2](ue),Se=!0,ze||(ct=[O(ue,"click",n[3]),O(ue,"keydown",n[4]),O(e,"introstart",n[5])],ze=!0)},p:ie,i(de){Se||(F(o.$$.fragment,de),F(l.$$.fragment,de),F(c.$$.fragment,de),F(d.$$.fragment,de),F(_.$$.fragment,de),F(b.$$.fragment,de),F(w.$$.fragment,de),F(y.$$.fragment,de),F(D.$$.fragment,de),F(S.$$.fragment,de),F(B.$$.fragment,de),F(N.$$.fragment,de),F(T.$$.fragment,de),F(R.$$.fragment,de),F(M.$$.fragment,de),F(X.$$.fragment,de),F(ce.$$.fragment,de),de&&ye(()=>{Se&&(Ee||(Ee=me(e,Ze,{duration:250},!0)),Ee.run(1))}),Se=!0)},o(de){W(o.$$.fragment,de),W(l.$$.fragment,de),W(c.$$.fragment,de),W(d.$$.fragment,de),W(_.$$.fragment,de),W(b.$$.fragment,de),W(w.$$.fragment,de),W(y.$$.fragment,de),W(D.$$.fragment,de),W(S.$$.fragment,de),W(B.$$.fragment,de),W(N.$$.fragment,de),W(T.$$.fragment,de),W(R.$$.fragment,de),W(M.$$.fragment,de),W(X.$$.fragment,de),W(ce.$$.fragment,de),de&&(Ee||(Ee=me(e,Ze,{duration:250},!1)),Ee.run(0)),Se=!1},d(de){de&&P(e),oe(o),oe(l),oe(c),oe(d),oe(_),oe(b),oe(w),oe(y),oe(D),oe(S),oe(B),oe(N),oe(T),oe(R),oe(M),oe(X),oe(ce),n[2](null),de&&Ee&&Ee.end(),ze=!1,be(ct)}}}function Gg(n,e,t){let i;J(n,x,c=>t(1,i=c));let s;function o(c){re[c?"unshift":"push"](()=>{s=c,t(0,s)})}return[s,i,o,()=>G(x,i.changelog.ongoing=!1,i),c=>{vt(c),yt(c)},()=>s.focus()]}class Vg extends Ae{constructor(e){super(),Re(this,e,Gg,Ug,ge,{})}}function Kg(n){let e,t,i,s,o,r,l,a,c,u,d,f,_,h,b,v,w,k,y,I,D,z;return{c(){e=g("div"),t=g("span"),t.textContent="Resources",i=C(),s=g("ul"),o=g("li"),r=g("iconify-icon"),l=C(),a=g("a"),a.textContent="Fantastic Frontier Wiki",c=C(),u=g("li"),u.innerHTML='<iconify-icon icon="ic:baseline-discord" class="svelte-18cf37p"></iconify-icon> <a href="https://discord.gg/ff" target="_blank" class="svelte-18cf37p">Fantastic Frontier Discord Server</a>',d=C(),f=g("li"),f.innerHTML='<iconify-icon icon="simple-icons:googledocs" class="svelte-18cf37p"></iconify-icon> <a href="https://docs.google.com/document/d/1H9HXoExCDVfXx15LQ4Te-2tTjrLFB-XCbMmx44Ynld4/edit" target="_blank" class="svelte-18cf37p">Fantastic Frontier Build List</a>',_=C(),h=g("li"),h.innerHTML='<iconify-icon icon="simple-icons:googledocs" class="svelte-18cf37p"></iconify-icon> <a href="https://docs.google.com/document/d/15vwSRojTqZ8LI09Wq4dvGF1kSTPmH2_gECQvwlSFki8/edit" target="_blank" class="svelte-18cf37p">Fantastic Frontier Max Stat List</a>',b=C(),v=g("div"),w=g("div"),k=g("button"),k.textContent="OK",m(t,"id","title"),Pe(r,"icon","simple-icons:fandom"),Pe(r,"class","svelte-18cf37p"),m(a,"id","firstFocusable"),m(a,"href","https://fantastic-frontier-roblox.fandom.com/wiki/Fantastic_Frontier_-_Roblox_Wiki"),m(a,"target","_blank"),m(a,"class","svelte-18cf37p"),m(o,"class","svelte-18cf37p"),m(u,"class","svelte-18cf37p"),m(f,"class","svelte-18cf37p"),m(h,"class","svelte-18cf37p"),m(s,"class","svelte-18cf37p"),m(k,"id","lastFocusable"),m(v,"class","promptOptions"),m(e,"class","infoPrompt")},m(S,j){L(S,e,j),p(e,t),p(e,i),p(e,s),p(s,o),p(o,r),p(o,l),p(o,a),p(s,c),p(s,u),p(s,d),p(s,f),p(s,_),p(s,h),p(e,b),p(e,v),p(v,w),p(w,k),n[2](k),I=!0,D||(z=[O(a,"keydown",vt),O(k,"click",n[3]),O(k,"keydown",yt),O(e,"introstart",n[4])],D=!0)},p:ie,i(S){I||(S&&ye(()=>{I&&(y||(y=me(e,Ze,{duration:250},!0)),y.run(1))}),I=!0)},o(S){S&&(y||(y=me(e,Ze,{duration:250},!1)),y.run(0)),I=!1},d(S){S&&P(e),n[2](null),S&&y&&y.end(),D=!1,be(z)}}}function Yg(n,e,t){let i;J(n,x,a=>t(1,i=a));let s;function o(a){re[a?"unshift":"push"](()=>{s=a,t(0,s)})}return[s,i,o,()=>G(x,i.resources.ongoing=!1,i),()=>s.focus()]}class Qg extends Ae{constructor(e){super(),Re(this,e,Yg,Kg,ge,{})}}function Dl(n,e,t){const i=n.slice();return i[7]=e[t],i}function Rl(n,e,t){const i=n.slice();return i[10]=e[t],i}function Al(n){let e,t,i,s,o,r,l,a=n[1][n[7]][n[10]].toLocaleString()+" Gold",c,u;return{c(){e=g("div"),t=g("span"),t.textContent=`${n[10].charAt(0).toUpperCase()+n[10].slice(1)+":"}`,i=C(),s=g("img"),r=C(),l=g("span"),c=ae(a),u=C(),m(t,"id","costTypeName"),m(t,"class","svelte-sk567b"),$e(s.src,o="https://static.wikia.nocookie.net/fantastic-frontier-roblox/images/b/ba/GoldCoins.png")||m(s,"src",o),m(s,"alt",""),m(s,"class","svelte-sk567b"),m(e,"class","svelte-sk567b")},m(d,f){L(d,e,f),p(e,t),p(e,i),p(e,s),p(e,r),p(e,l),p(l,c),p(e,u)},p(d,f){f&2&&a!==(a=d[1][d[7]][d[10]].toLocaleString()+" Gold")&&Te(c,a)},d(d){d&&P(e)}}}function Pl(n){let e,t,i,s,o,r=De(["min","avg","max"]),l=[];for(let a=0;a<3;a+=1)l[a]=Al(Rl(n,r,a));return{c(){e=g("div"),t=g("span"),t.textContent=`${n[7].charAt(0).toUpperCase()+n[7].slice(1)+" Costs"}`,i=C(),s=g("div");for(let a=0;a<3;a+=1)l[a].c();o=C(),m(t,"id","subtitle"),m(t,"class","svelte-sk567b"),m(s,"class","costTypes svelte-sk567b"),m(e,"class","costs svelte-sk567b"),m(e,"id",n[7])},m(a,c){L(a,e,c),p(e,t),p(e,i),p(e,s);for(let u=0;u<3;u+=1)l[u]&&l[u].m(s,null);p(e,o)},p(a,c){if(c&2){r=De(["min","avg","max"]);let u;for(u=0;u<3;u+=1){const d=Rl(a,r,u);l[u]?l[u].p(d,c):(l[u]=Al(d),l[u].c(),l[u].m(s,null))}for(;u<3;u+=1)l[u].d(1)}},d(a){a&&P(e),ft(l,a)}}}function Xg(n){let e,t,i,s,o,r,l,a,c,u,d=De(["armor","gear","total"]),f=[];for(let _=0;_<3;_+=1)f[_]=Pl(Dl(n,d,_));return{c(){e=g("div"),t=g("div");for(let _=0;_<3;_+=1)f[_].c();i=C(),s=g("div"),o=g("div"),r=g("button"),r.textContent="OK",m(t,"class","costsInfo svelte-sk567b"),m(r,"id","firstFocusable lastFocusable"),m(s,"class","promptOptions svelte-sk567b"),m(e,"class","buildCosts svelte-sk567b")},m(_,h){L(_,e,h),p(e,t);for(let b=0;b<3;b+=1)f[b]&&f[b].m(t,null);p(e,i),p(e,s),p(s,o),p(o,r),n[3](r),a=!0,c||(u=[O(r,"click",n[4]),O(r,"keydown",n[5]),O(e,"introstart",n[6])],c=!0)},p(_,[h]){if(h&2){d=De(["armor","gear","total"]);let b;for(b=0;b<3;b+=1){const v=Dl(_,d,b);f[b]?f[b].p(v,h):(f[b]=Pl(v),f[b].c(),f[b].m(t,null))}for(;b<3;b+=1)f[b].d(1)}},i(_){a||(_&&ye(()=>{a&&(l||(l=me(e,Ze,{duration:250},!0)),l.run(1))}),a=!0)},o(_){_&&(l||(l=me(e,Ze,{duration:250},!1)),l.run(0)),a=!1},d(_){_&&P(e),ft(f,_),n[3](null),_&&l&&l.end(),c=!1,be(u)}}}function Jg(n,e,t){let i,s;J(n,It,u=>t(1,i=u)),J(n,x,u=>t(2,s=u));let o;function r(u){re[u?"unshift":"push"](()=>{o=u,t(0,o)})}return[o,i,s,r,()=>G(x,s.costs.ongoing=!1,s),u=>{vt(u),yt(u)},()=>o.focus()]}class Zg extends Ae{constructor(e){super(),Re(this,e,Jg,Xg,ge,{})}}function Ml(n,e,t){const i=n.slice();return i[19]=e[t][0],i[20]=e[t][1],i}function Ll(n,e,t){const i=n.slice();return i[11]=e[t],i}function Fl(n,e,t){const i=n.slice();return i[16]=e[t],i}function xg(n){const e=n.slice(),t=e[14]?e[5][e[2].name][e[11].name]:`${Math.round(e[11].mult*100*10)/10}<b>%</b> ${Lt[e[11].type]}`;return e[15]=t,e}function Bl(n){const e=n.slice(),t=e[5][e[2].name]!=null&&e[5][e[2].name][e[11].name]!=null;return e[14]=t,e}function $g(n){let e;return{c(){e=g("span"),e.textContent=`Slot: ${n[2].slot.charAt(0).toUpperCase()+n[2].slot.slice(1)}`},m(t,i){L(t,e,i)},p:ie,d(t){t&&P(e)}}}function eb(n){let e;return{c(){e=g("span"),e.textContent=`Type: ${n[2].tool?"Tool":n[2].info.type}`},m(t,i){L(t,e,i)},p:ie,d(t){t&&P(e)}}}function tb(n){let e,t,i,s,o=De(Object.entries(Lt)),r=[];for(let l=0;l<o.length;l+=1)r[l]=ql(Ml(n,o,l));return{c(){e=g("div"),t=g("span"),t.textContent=`${n[2].noStats?"No stats available":"Stats:"}`,i=C(),s=g("div");for(let l=0;l<r.length;l+=1)r[l].c();m(t,"id","subtitle"),m(t,"class","svelte-1d71l7d"),m(s,"class","svelte-1d71l7d"),m(e,"id","itemStats"),m(e,"class","svelte-1d71l7d")},m(l,a){L(l,e,a),p(e,t),p(e,i),p(e,s);for(let c=0;c<r.length;c+=1)r[c]&&r[c].m(s,null)},p(l,a){if(a&4){o=De(Object.entries(Lt));let c;for(c=0;c<o.length;c+=1){const u=Ml(l,o,c);r[c]?r[c].p(u,a):(r[c]=ql(u),r[c].c(),r[c].m(s,null))}for(;c<r.length;c+=1)r[c].d(1);r.length=o.length}},d(l){l&&P(e),ft(r,l)}}}function nb(n){let e;function t(o,r){return o[2].tool?ob:sb}let s=t(n)(n);return{c(){s.c(),e=_t()},m(o,r){s.m(o,r),L(o,e,r)},p(o,r){s.p(o,r)},d(o){o&&P(e),s.d(o)}}}function ib(n){let e,t,i,s,o,r=(n[19]=="endurance"?n[2].stats[n[19]].toFixed(2):n[2].stats[n[19]])+"",l,a;return{c(){e=g("div"),t=g("img"),s=C(),o=g("span"),l=ae(r),a=C(),$e(t.src,i="stats/"+n[19]+".svg")||m(t,"src",i),m(t,"alt",n[20]),m(t,"class","svelte-1d71l7d"),m(o,"class","statValue svelte-1d71l7d"),m(o,"id",n[19]),te(o,"negative",n[2].stats[n[19]]<0),m(e,"class","svelte-1d71l7d")},m(c,u){L(c,e,u),p(e,t),p(e,s),p(e,o),p(o,l),p(e,a)},p(c,u){u&4&&te(o,"negative",c[2].stats[c[19]]<0)},d(c){c&&P(e)}}}function ql(n){let e,t=n[2].stats[n[19]]!=0&&ib(n);return{c(){t&&t.c(),e=_t()},m(i,s){t&&t.m(i,s),L(i,e,s)},p(i,s){i[2].stats[i[19]]!=0&&t.p(i,s)},d(i){i&&P(e),t&&t.d(i)}}}function sb(n){let e,t,i,s,o,r=De(n[2].moves),l=[];for(let a=0;a<r.length;a+=1)l[a]=Wl(Ll(n,r,a));return{c(){e=g("div"),t=g("div"),i=g("div"),s=g("div"),s.innerHTML='<span class="svelte-1d71l7d">Move</span> <span class="svelte-1d71l7d">Base Value</span> <span class="svelte-1d71l7d">Scaling(s)</span>',o=C();for(let a=0;a<l.length;a+=1)l[a].c();m(s,"id","subtitle"),m(s,"class","svelte-1d71l7d"),m(i,"class","svelte-1d71l7d"),m(t,"id","itemMoves"),m(t,"class","svelte-1d71l7d"),m(e,"id","itemMovesCont"),m(e,"class","svelte-1d71l7d")},m(a,c){L(a,e,c),p(e,t),p(t,i),p(i,s),p(i,o);for(let u=0;u<l.length;u+=1)l[u]&&l[u].m(i,null)},p(a,c){if(c&52){r=De(a[2].moves);let u;for(u=0;u<r.length;u+=1){const d=Ll(a,r,u);l[u]?l[u].p(d,c):(l[u]=Wl(d),l[u].c(),l[u].m(i,null))}for(;u<l.length;u+=1)l[u].d(1);l.length=r.length}},d(a){a&&P(e),ft(l,a)}}}function ob(n){let e;return{c(){e=g("div"),e.innerHTML='<span id="subtitle" class="svelte-1d71l7d">No moves available</span>',m(e,"id","itemMovesCont"),m(e,"class","svelte-1d71l7d"),et(e,"text-align","center")},m(t,i){L(t,e,i)},p:ie,d(t){t&&P(e)}}}function rb(n){let e,t,i,s,o,r;function l(d,f){return!d[11].type||!d[11].type.includes("/")?zl:lb}function a(d,f){return f===zl?xg(d):d}let c=l(n),u=c(a(n,c));return{c(){e=g("div"),t=g("span"),t.textContent=`${n[11].name}`,i=C(),s=g("span"),s.textContent=`${(n[11].name.includes("Fantastic Beamstorm")?"~":"")+n[11].base}`,o=C(),u.c(),r=C(),m(t,"class","svelte-1d71l7d"),m(s,"class","svelte-1d71l7d"),m(e,"class","svelte-1d71l7d")},m(d,f){L(d,e,f),p(e,t),p(e,i),p(e,s),p(e,o),u.m(e,null),p(e,r)},p(d,f){u.p(a(d,c),f)},d(d){d&&P(e),u.d()}}}function lb(n){let e,t=De(n[11].type.split("/")),i=[];for(let s=0;s<t.length;s+=1)i[s]=jl(Fl(n,t,s));return{c(){e=g("span");for(let s=0;s<i.length;s+=1)i[s].c();m(e,"id","hybrid"),m(e,"class","svelte-1d71l7d")},m(s,o){L(s,e,o);for(let r=0;r<i.length;r+=1)i[r]&&i[r].m(e,null)},p(s,o){if(o&4){t=De(s[11].type.split("/"));let r;for(r=0;r<t.length;r+=1){const l=Fl(s,t,r);i[r]?i[r].p(l,o):(i[r]=jl(l),i[r].c(),i[r].m(e,null))}for(;r<i.length;r+=1)i[r].d(1);i.length=t.length}},d(s){s&&P(e),ft(i,s)}}}function zl(n){let e,t=n[15]+"";return{c(){e=g("span"),m(e,"class","svelte-1d71l7d"),et(e,"font-size",n[15].length>30?"calc(var(--u) * 2.5)":"")},m(i,s){L(i,e,s),e.innerHTML=t},p:ie,d(i){i&&P(e)}}}function jl(n){let e,t=Math.round(n[11][`${n[16]}Mult`]*100*10)/10+"",i,s,o,r=Lt[n[16]]+"",l,a;return{c(){e=g("span"),i=ae(t),s=g("b"),s.textContent="%",o=C(),l=ae(r),a=C()},m(c,u){L(c,e,u),p(e,i),p(e,s),p(e,o),p(e,l),p(e,a)},p:ie,d(c){c&&P(e)}}}function Wl(n){let e=!n[4].includes(n[11].name),t,i=e&&rb(Bl(n));return{c(){i&&i.c(),t=_t()},m(s,o){i&&i.m(s,o),L(s,t,o)},p(s,o){e&&i.p(Bl(s),o)},d(s){s&&P(t),i&&i.d(s)}}}function ab(n){let e,t,i,s,o,r,l,a,c,u,d,f,_,h,b,v,w,k,y,I,D,z,S,j,B,Q,N,E,T,$,R,A,M,H,X,he,ce,ne,q,Z;function ue(je,tt){return je[3]?eb:$g}let Se=ue(n)(n);function ze(je,tt){return je[3]?nb:tb}let de=ze(n)(n);return{c(){e=g("div"),t=g("div"),i=g("a"),s=g("img"),r=C(),l=g("div"),a=g("span"),a.textContent="Click the image in order to visit the wiki page",c=C(),u=g("span"),u.textContent=`Name: ${n[2].name}`,d=C(),Se.c(),f=C(),de.c(),_=C(),h=g("div"),b=g("span"),b.textContent="Costs:",v=C(),w=g("div"),k=g("div"),y=g("span"),y.textContent="Minimum:",I=C(),D=g("img"),S=C(),j=g("span"),j.textContent=`${n[2].cost.min==null?"Unpurchasable":n[2].cost.min.toLocaleString()+" Gold"}`,B=C(),Q=g("div"),N=g("span"),N.textContent="Maximum:",E=C(),T=g("img"),R=C(),A=g("span"),A.textContent=`${n[2].cost.max==null?"Unpurchasable":n[2].cost.max.toLocaleString()+" Gold"}`,M=C(),H=g("div"),X=g("div"),he=g("button"),he.textContent="OK",$e(s.src,o=n[2].image)||m(s,"src",o),m(s,"alt",""),m(s,"class","svelte-1d71l7d"),m(i,"href",n[2].link),m(i,"target","_blank"),m(i,"class","svelte-1d71l7d"),m(a,"id","tip"),m(a,"class","svelte-1d71l7d"),m(l,"class","svelte-1d71l7d"),m(t,"id","basicInfo"),m(t,"class","svelte-1d71l7d"),m(b,"id","subtitle"),m(b,"class","svelte-1d71l7d"),m(y,"class","svelte-1d71l7d"),$e(D.src,z="https://static.wikia.nocookie.net/fantastic-frontier-roblox/images/b/ba/GoldCoins.png")||m(D,"src",z),m(D,"alt",""),m(D,"class","svelte-1d71l7d"),m(j,"class","svelte-1d71l7d"),m(k,"class","svelte-1d71l7d"),m(N,"class","svelte-1d71l7d"),$e(T.src,$="https://static.wikia.nocookie.net/fantastic-frontier-roblox/images/b/ba/GoldCoins.png")||m(T,"src",$),m(T,"alt",""),m(T,"class","svelte-1d71l7d"),m(A,"class","svelte-1d71l7d"),m(Q,"class","svelte-1d71l7d"),m(w,"class","svelte-1d71l7d"),m(h,"id","itemCosts"),m(h,"class","svelte-1d71l7d"),m(he,"id","firstFocusable lastFocusable"),m(H,"class","promptOptions svelte-1d71l7d"),m(e,"class","itemInfo svelte-1d71l7d")},m(je,tt){L(je,e,tt),p(e,t),p(t,i),p(i,s),p(t,r),p(t,l),p(l,a),p(l,c),p(l,u),p(l,d),Se.m(l,null),p(e,f),de.m(e,null),p(e,_),p(e,h),p(h,b),p(h,v),p(h,w),p(w,k),p(k,y),p(k,I),p(k,D),p(k,S),p(k,j),p(w,B),p(w,Q),p(Q,N),p(Q,E),p(Q,T),p(Q,R),p(Q,A),p(e,M),p(e,H),p(H,X),p(X,he),n[6](he),ne=!0,q||(Z=[O(he,"click",n[7]),O(he,"keydown",n[8]),O(e,"introstart",n[9]),O(e,"outroend",n[10])],q=!0)},p(je,[tt]){Se.p(je,tt),de.p(je,tt)},i(je){ne||(je&&ye(()=>{ne&&(ce||(ce=me(e,Ze,{duration:250},!0)),ce.run(1))}),ne=!0)},o(je){je&&(ce||(ce=me(e,Ze,{duration:250},!1)),ce.run(0)),ne=!1},d(je){je&&P(e),Se.d(),de.d(),n[6](null),je&&ce&&ce.end(),q=!1,be(Z)}}}function cb(n,e,t){let i;J(n,x,h=>t(1,i=h));let s,o=i.item.data,r=o.type=="gear",l=["Charged Basic Attack","Charged Solar Beam"],a={"Void Spike Ultradagger":{"Void Needle":"100<b>%</b> Melee - 562.5<b>%</b> Armor"},"Pureblood Dagger":{"Basic Attack":"200<b>%</b> HighestBonus - 100<b>%</b> LowerBonuses","Blood Sap":"200<b>%</b> HighestBonus - 100<b>%</b> LowerBonuses","+ HP per Blood Sap":"(200<b>%</b> HighestBonus - 100<b>%</b> LowerBonuses) / 2"},"Gnome Rocket Launcher":{"Basic Attack":"None"}};function c(h){re[h?"unshift":"push"](()=>{s=h,t(0,s)})}return[s,i,o,r,l,a,c,()=>G(x,i.item.ongoing=!1,i),h=>{vt(h),yt(h)},()=>s.focus(),()=>{o.element&&o.element.querySelector("button").focus()}]}class ub extends Ae{constructor(e){super(),Re(this,e,cb,ab,ge,{})}}function db(n){let e,t,i,s,o,r,l,a,c,u,d,f;return{c(){e=g("div"),t=g("span"),t.textContent="Fantastic Calculator Policy",i=C(),s=g("div"),s.innerHTML=`<span id="subtitle" class="svelte-1fkv0qw">About</span> <p class="svelte-1fkv0qw">This tool is a passion project, one that is independent and is not
            affiliated with or sponsored by the creators of Fantastic Frontier.</p> <span id="subtitle" class="svelte-1fkv0qw">Privacy Policy</span> <p class="svelte-1fkv0qw">This policy explains what information Fantastic Calculator (&quot;we&quot;,
            &quot;us&quot; or &quot;our&quot;) collects, uses, and shares when you use our website.</p> <span id="subtitle" class="svelte-1fkv0qw">Information We Collect</span> <p class="svelte-1fkv0qw">We collect information provided by you; that is which is inputted
            directly into our tool. We also collect information about how you
            use and interact with our website, general demographic details, and
            information about your device or browser.</p> <span id="subtitle" class="svelte-1fkv0qw">How We Use This Information</span> <p class="svelte-1fkv0qw">Your information may be utilized to test and improve the tool, once
            the aggregated, non-identifying information provided has been
            collected and analyzed.</p> <span id="subtitle" class="svelte-1fkv0qw">Contact</span> <p class="svelte-1fkv0qw">For any questions or inquiries, feel free to contact us at <hl>@xt.ss</hl>.</p>`,o=C(),r=g("div"),l=g("div"),a=g("button"),a.textContent="OK",m(t,"id","title"),m(s,"id","contents"),m(a,"id","firstFocusable lastFocusable"),m(r,"class","promptOptions svelte-1fkv0qw"),m(e,"class","infoPrompt svelte-1fkv0qw")},m(_,h){L(_,e,h),p(e,t),p(e,i),p(e,s),p(e,o),p(e,r),p(r,l),p(l,a),n[2](a),u=!0,d||(f=[O(a,"click",n[3]),O(a,"keydown",n[4])],d=!0)},p:ie,i(_){u||(_&&ye(()=>{u&&(c||(c=me(e,Ze,{duration:250},!0)),c.run(1))}),u=!0)},o(_){_&&(c||(c=me(e,Ze,{duration:250},!1)),c.run(0)),u=!1},d(_){_&&P(e),n[2](null),_&&c&&c.end(),d=!1,be(f)}}}function fb(n,e,t){let i;J(n,x,a=>t(1,i=a));let s;function o(a){re[a?"unshift":"push"](()=>{s=a,t(0,s)})}return[s,i,o,()=>G(x,i.policy.ongoing=!1,i),a=>{vt(a),yt(a)}]}class hb extends Ae{constructor(e){super(),Re(this,e,fb,db,ge,{})}}const{document:Ft,window:fn}=mu;function Hl(n,e,t){const i=n.slice();return i[50]=e[t],i}function Ul(n,e,t){const i=n.slice();return i[50]=e[t],i}function Gl(n){let e;return{c(){e=g("style"),e.textContent=`* {\r
                pointer-events: none;\r
            }\r
        `},m(t,i){L(t,e,i)},d(t){t&&P(e)}}}function Vl(n){let e;return{c(){e=g("link"),m(e,"rel","preload"),m(e,"as","image"),m(e,"href",n[50])},m(t,i){L(t,e,i)},p:ie,d(t){t&&P(e)}}}function Kl(n){let e;return{c(){e=g("style"),e.textContent=`body > div:not(.backgrounds),\r
            main > :not(.promptCont),\r
            .backgrounds > img,\r
            #resources,\r
            #changelog,\r
            #policy {\r
                filter: blur(calc(var(--u) * 0.5));\r
                pointer-events: none;\r
            }\r
            .sideFeatures {\r
                z-index: 3;\r
            }\r
            .sideFeatures button:hover,\r
            .sideFeatures button:focus,\r
            .info:hover,\r
            .info:focus {\r
                background-color: var(--transparent);\r
            }\r
            .sideFeatures button > .tooltip,\r
            .info:not(#credits) > .tooltip {\r
                opacity: 0 !important;\r
                visibility: hidden !important;\r
            }\r
        `},m(t,i){L(t,e,i)},d(t){t&&P(e)}}}function Yl(n){let e;return{c(){e=g("style"),e.textContent=`body {\r
                overflow: hidden;\r
            }\r
        `},m(t,i){L(t,e,i)},d(t){t&&P(e)}}}function Ql(n){let e;return{c(){e=g("style"),e.textContent=`body {\r
                pointer-events: none;\r
            }\r
            #resources,\r
            #changelog,\r
            #policy,\r
            .mainFeatures,\r
            .sideFeatures,\r
            .statBox > .toggleCont,\r
            .ddButton > iconify-icon,\r
            .copyStatsButton {\r
                opacity: 0;\r
                visibility: hidden;\r
            }\r
            .gearBox .ddButton > iconify-icon {\r
                width: 15% !important;\r
            }\r
            .eqSlotIcon button > .tooltip,\r
            .gearSlotIcon button > .tooltip {\r
                opacity: 1;\r
                visibility: visible;\r
            }\r
            .calcBox {\r
                translate: -3%;\r
            }\r
            .currentBuild {\r
                left: 50% !important;\r
                padding: calc(var(--u) * 2) !important;\r
            }\r
            .currentBuild > button {\r
                min-width: 0 !important;\r
                width: 0;\r
                opacity: 0;\r
                visibility: hidden;\r
            }`},m(t,i){L(t,e,i)},d(t){t&&P(e)}}}function Xl(n){let e,t;return{c(){e=g("img"),m(e,"class","background svelte-13td2qe"),$e(e.src,t=n[50])||m(e,"src",t),m(e,"alt",""),te(e,"active",n[21].indexOf(n[50])==n[9])},m(i,s){L(i,e,s)},p(i,s){s[0]&2097664&&te(e,"active",i[21].indexOf(i[50])==i[9])},d(i){i&&P(e)}}}function Jl(n){let e,t,i=Math.floor(n[18][n[3]]*100)+"",s,o,r,l;return{c(){e=g("span"),t=ae("Zoom: "),s=ae(i),o=g("b"),o.textContent="%",m(e,"class","info svelte-13td2qe"),m(e,"id","zoomLevel")},m(a,c){L(a,e,c),p(e,t),p(e,s),p(e,o),l=!0},p(a,c){(!l||c[0]&8)&&i!==(i=Math.floor(a[18][a[3]]*100)+"")&&Te(s,i)},i(a){l||(a&&ye(()=>{l&&(r||(r=me(e,Je,{duration:150},!0)),r.run(1))}),l=!0)},o(a){a&&(r||(r=me(e,Je,{duration:150},!1)),r.run(0)),l=!1},d(a){a&&P(e),a&&r&&r.end()}}}function Zl(n){let e,t,i,s,o,r,l,a,c=n[17].armor.avg.toLocaleString()+" Gold",u,d,f,_,h,b,v,w,k,y=n[17].gear.avg.toLocaleString()+" Gold",I,D,z;return{c(){e=g("div"),t=g("div"),i=g("span"),i.textContent="Avg. armor cost:",s=C(),o=g("img"),l=C(),a=g("span"),u=ae(c),d=C(),f=g("div"),_=g("span"),_.textContent="Avg. gear cost:",h=C(),b=g("img"),w=C(),k=g("span"),I=ae(y),$e(o.src,r="https://static.wikia.nocookie.net/fantastic-frontier-roblox/images/b/ba/GoldCoins.png")||m(o,"src",r),m(o,"alt",""),m(o,"class","svelte-13td2qe"),m(t,"class","svelte-13td2qe"),$e(b.src,v="https://static.wikia.nocookie.net/fantastic-frontier-roblox/images/b/ba/GoldCoins.png")||m(b,"src",v),m(b,"alt",""),m(b,"class","svelte-13td2qe"),m(f,"class","svelte-13td2qe"),m(e,"class","costPreview svelte-13td2qe"),m(e,"id","specific")},m(S,j){L(S,e,j),p(e,t),p(t,i),p(t,s),p(t,o),p(t,l),p(t,a),p(a,u),p(e,d),p(e,f),p(f,_),p(f,h),p(f,b),p(f,w),p(f,k),p(k,I),z=!0},p(S,j){(!z||j[0]&131072)&&c!==(c=S[17].armor.avg.toLocaleString()+" Gold")&&Te(u,c),(!z||j[0]&131072)&&y!==(y=S[17].gear.avg.toLocaleString()+" Gold")&&Te(I,y)},i(S){z||(S&&ye(()=>{z&&(D||(D=me(e,Je,{duration:150},!0)),D.run(1))}),z=!0)},o(S){S&&(D||(D=me(e,Je,{duration:150},!1)),D.run(0)),z=!1},d(S){S&&P(e),S&&D&&D.end()}}}function xl(n){let e,t,i=n[4].name+"",s,o,r,l,a,c,u,d,f,_,h=n[4].desc+"",b,v,w,k,y;return{c(){e=g("div"),t=g("span"),s=ae(i),o=C(),r=g("button"),r.innerHTML='<iconify-icon icon="ri:share-fill"></iconify-icon> <span class="tooltip" id="right">Share build</span>',l=C(),a=g("span"),c=ae(`Description / Notes:\r
                `),u=g("br"),d=C(),f=g("br"),_=C(),b=ae(h),m(t,"id","buildName"),m(t,"class","svelte-13td2qe"),m(r,"class","svelte-13td2qe"),m(a,"class","tooltip"),m(a,"id","bottom"),m(e,"class","currentBuild svelte-13td2qe"),te(e,"no-tooltip",n[10])},m(I,D){L(I,e,D),p(e,t),p(t,s),p(e,o),p(e,r),p(e,l),p(e,a),p(a,c),p(a,u),p(a,d),p(a,f),p(a,_),p(a,b),w=!0,k||(y=[O(r,"click",n[31]),O(r,"mouseenter",n[32]),O(r,"mouseleave",n[33])],k=!0)},p(I,D){(!w||D[0]&16)&&i!==(i=I[4].name+"")&&Te(s,i),(!w||D[0]&16)&&h!==(h=I[4].desc+"")&&Te(b,h),(!w||D[0]&1024)&&te(e,"no-tooltip",I[10])},i(I){w||(I&&ye(()=>{w&&(v||(v=me(e,Je,{duration:100},!0)),v.run(1))}),w=!0)},o(I){I&&(v||(v=me(e,Je,{duration:100},!1)),v.run(0)),w=!1},d(I){I&&P(e),I&&v&&v.end(),k=!1,be(y)}}}function $l(n){let e,t,i,s,o,r,l,a,c=n[17].total.avg.toLocaleString()+" Gold",u,d,f;return{c(){e=g("div"),t=g("div"),i=g("span"),i.textContent="Avg. total cost:",s=C(),o=g("img"),l=C(),a=g("span"),u=ae(c),$e(o.src,r="https://static.wikia.nocookie.net/fantastic-frontier-roblox/images/b/ba/GoldCoins.png")||m(o,"src",r),m(o,"alt",""),m(o,"class","svelte-13td2qe"),m(t,"class","svelte-13td2qe"),m(e,"class","costPreview svelte-13td2qe"),m(e,"id","total")},m(_,h){L(_,e,h),p(e,t),p(t,i),p(t,s),p(t,o),p(t,l),p(t,a),p(a,u),f=!0},p(_,h){(!f||h[0]&131072)&&c!==(c=_[17].total.avg.toLocaleString()+" Gold")&&Te(u,c)},i(_){f||(_&&ye(()=>{f&&(d||(d=me(e,Je,{duration:150},!0)),d.run(1))}),f=!0)},o(_){_&&(d||(d=me(e,Je,{duration:150},!1)),d.run(0)),f=!1},d(_){_&&P(e),_&&d&&d.end()}}}function _b(n){let e,t,i;return t=new hb({}),{c(){e=g("div"),le(t.$$.fragment),m(e,"class","promptCont svelte-13td2qe")},m(s,o){L(s,e,o),se(t,e,null),i=!0},p:ie,i(s){i||(F(t.$$.fragment,s),i=!0)},o(s){W(t.$$.fragment,s),i=!1},d(s){s&&P(e),oe(t)}}}function pb(n){let e,t,i;return t=new Vg({}),{c(){e=g("div"),le(t.$$.fragment),m(e,"class","promptCont svelte-13td2qe")},m(s,o){L(s,e,o),se(t,e,null),i=!0},p:ie,i(s){i||(F(t.$$.fragment,s),i=!0)},o(s){W(t.$$.fragment,s),i=!1},d(s){s&&P(e),oe(t)}}}function mb(n){let e,t,i;return t=new Qg({}),t.$on("loadPending",n[19]),{c(){e=g("div"),le(t.$$.fragment),m(e,"class","promptCont svelte-13td2qe")},m(s,o){L(s,e,o),se(t,e,null),i=!0},p:ie,i(s){i||(F(t.$$.fragment,s),i=!0)},o(s){W(t.$$.fragment,s),i=!1},d(s){s&&P(e),oe(t)}}}function gb(n){let e,t,i;return t=new qg({}),{c(){e=g("div"),le(t.$$.fragment),m(e,"class","promptCont svelte-13td2qe")},m(s,o){L(s,e,o),se(t,e,null),i=!0},p:ie,i(s){i||(F(t.$$.fragment,s),i=!0)},o(s){W(t.$$.fragment,s),i=!1},d(s){s&&P(e),oe(t)}}}function bb(n){let e,t,i;return t=new Mg({}),{c(){e=g("div"),le(t.$$.fragment),m(e,"class","promptCont svelte-13td2qe")},m(s,o){L(s,e,o),se(t,e,null),i=!0},p:ie,i(s){i||(F(t.$$.fragment,s),i=!0)},o(s){W(t.$$.fragment,s),i=!1},d(s){s&&P(e),oe(t)}}}function vb(n){let e,t,i;return t=new Zg({}),{c(){e=g("div"),le(t.$$.fragment),m(e,"class","promptCont svelte-13td2qe")},m(s,o){L(s,e,o),se(t,e,null),i=!0},p:ie,i(s){i||(F(t.$$.fragment,s),i=!0)},o(s){W(t.$$.fragment,s),i=!1},d(s){s&&P(e),oe(t)}}}function yb(n){let e,t,i;return t=new Ng({}),{c(){e=g("div"),le(t.$$.fragment),m(e,"class","promptCont svelte-13td2qe")},m(s,o){L(s,e,o),se(t,e,null),i=!0},p:ie,i(s){i||(F(t.$$.fragment,s),i=!0)},o(s){W(t.$$.fragment,s),i=!1},d(s){s&&P(e),oe(t)}}}function wb(n){let e,t,i;return t=new Sg({}),t.$on("buildLoad",n[35]),{c(){e=g("div"),le(t.$$.fragment),m(e,"class","promptCont svelte-13td2qe")},m(s,o){L(s,e,o),se(t,e,null),i=!0},p:ie,i(s){i||(F(t.$$.fragment,s),i=!0)},o(s){W(t.$$.fragment,s),i=!1},d(s){s&&P(e),oe(t)}}}function kb(n){let e,t,i;return t=new yg({}),{c(){e=g("div"),le(t.$$.fragment),m(e,"class","promptCont svelte-13td2qe")},m(s,o){L(s,e,o),se(t,e,null),i=!0},p:ie,i(s){i||(F(t.$$.fragment,s),i=!0)},o(s){W(t.$$.fragment,s),i=!1},d(s){s&&P(e),oe(t)}}}function Cb(n){let e,t,i;return t=new Xm({}),{c(){e=g("div"),le(t.$$.fragment),m(e,"class","promptCont svelte-13td2qe")},m(s,o){L(s,e,o),se(t,e,null),i=!0},p:ie,i(s){i||(F(t.$$.fragment,s),i=!0)},o(s){W(t.$$.fragment,s),i=!1},d(s){s&&P(e),oe(t)}}}function Eb(n){let e,t,i,s;function o(l){n[34](l)}let r={};return n[8]!==void 0&&(r.loadID=n[8]),t=new fg({props:r}),re.push(()=>Le(t,"loadID",o)),t.$on("resetActions",n[23]),{c(){e=g("div"),le(t.$$.fragment),m(e,"class","promptCont svelte-13td2qe")},m(l,a){L(l,e,a),se(t,e,null),s=!0},p(l,a){const c={};!i&&a[0]&256&&(i=!0,c.loadID=l[8],Me(()=>i=!1)),t.$set(c)},i(l){s||(F(t.$$.fragment,l),s=!0)},o(l){W(t.$$.fragment,l),s=!1},d(l){l&&P(e),oe(t)}}}function Sb(n){let e,t,i;return t=new ub({}),{c(){e=g("div"),le(t.$$.fragment),m(e,"class","promptCont svelte-13td2qe")},m(s,o){L(s,e,o),se(t,e,null),i=!0},p:ie,i(s){i||(F(t.$$.fragment,s),i=!0)},o(s){W(t.$$.fragment,s),i=!1},d(s){s&&P(e),oe(t)}}}function ea(n){let e,t,i;return{c(){e=g("iconify-icon"),Pe(e,"icon","uil:exclamation"),Pe(e,"id","unseen"),Pe(e,"class","svelte-13td2qe")},m(s,o){L(s,e,o),i=!0},i(s){i||(s&&ye(()=>{i&&(t||(t=me(e,Je,{duration:150},!0)),t.run(1))}),i=!0)},o(s){s&&(t||(t=me(e,Je,{duration:150},!1)),t.run(0)),i=!1},d(s){s&&P(e),s&&t&&t.end()}}}function ta(n){let e;return{c(){e=g("div"),e.innerHTML='<iconify-icon icon="eos-icons:three-dots-loading" class="svelte-13td2qe"></iconify-icon>',m(e,"class","promptCont svelte-13td2qe")},m(t,i){L(t,e,i)},d(t){t&&P(e)}}}function Ib(n){let e,t,i,s,o,r,l,a,c,u,d,f,_,h,b,v,w,k,y,I,D,z,S,j,B,Q,N,E,T,$,R,A,M,H,X,he,ce,ne,q,Z,ue,Ee,Se,ze,ct,de,je,tt;ye(n[29]);let fe=!n[6]&&Gl(),Ue=De(n[21]),Ve=[];for(let K=0;K<Ue.length;K+=1)Ve[K]=Vl(Ul(n,Ue,K));let nt=(n[12]||!n[6])&&Kl(),V=n[5].screenshot.ongoing&&n[18][n[3]]<=1&&Yl(),Ne=n[5].screenshot.ongoing&&Ql(),ve=De(n[21]),U=[];for(let K=0;K<ve.length;K+=1)U[K]=Xl(Hl(n,ve,K));let pe=n[7]&&Jl(n),Oe=n[5].screenshot.ongoing&&Zl(n),qe=n[4]&&xl(n);w=new qm({}),y=new Rg({}),S=new hm({}),B=new Em({}),N=new Lm({}),T=new Km({});let Fe=n[5].screenshot.ongoing&&$l(n);const Tt=[Sb,Eb,Cb,kb,wb,yb,vb,bb,gb,mb,pb,_b],ht=[];function cn(K,ke){return K[5].item.ongoing?0:K[11]||K[5].share.ongoing?1:K[5].export.ongoing?2:K[5].save.ongoing?3:K[5].load.ongoing&&!K[8]?4:K[5].delete.ongoing?5:K[5].costs.ongoing?6:K[5].bonus.ongoing?7:K[5].randomize.ongoing?8:K[5].resources.ongoing?9:K[5].changelog.ongoing?10:K[5].policy.ongoing?11:-1}~(A=cn(n))&&(M=ht[A]=Tt[A](n));let Y=!n[13]&&ea(),ut=!n[6]&&ta();return{c(){fe&&fe.c(),e=_t();for(let K=0;K<Ve.length;K+=1)Ve[K].c();t=_t(),nt&&nt.c(),i=_t(),V&&V.c(),s=_t(),Ne&&Ne.c(),o=_t(),r=C(),l=g("div");for(let K=0;K<U.length;K+=1)U[K].c();a=C(),pe&&pe.c(),c=C(),u=g("span"),u.innerHTML=`<iconify-icon icon="ic:baseline-discord" class="svelte-13td2qe"></iconify-icon>
    xt.ss
    <span class="tooltip svelte-13td2qe" id="right">Contact me on Discord!</span>`,d=C(),f=g("button"),f.innerHTML='<iconify-icon icon="charm:stack"></iconify-icon> <span class="tooltip" id="left">Resources</span>',_=C(),h=g("main"),Oe&&Oe.c(),b=C(),qe&&qe.c(),v=C(),le(w.$$.fragment),k=C(),le(y.$$.fragment),I=C(),D=g("div"),z=g("div"),le(S.$$.fragment),j=C(),le(B.$$.fragment),Q=C(),le(N.$$.fragment),E=C(),le(T.$$.fragment),$=C(),Fe&&Fe.c(),R=C(),M&&M.c(),H=C(),X=g("button"),he=g("iconify-icon"),ce=C(),ne=g("span"),ne.textContent="Changelog",q=C(),Y&&Y.c(),Z=C(),ue=g("button"),ue.innerHTML='<iconify-icon icon="material-symbols:policy-outline-rounded"></iconify-icon> <span class="tooltip" id="left">Policy</span>',Ee=C(),Se=g("span"),Se.textContent=`${eo}`,ze=C(),ut&&ut.c(),ct=_t(),m(l,"class","backgrounds"),m(u,"class","info svelte-13td2qe"),m(u,"id","credits"),m(f,"class","info svelte-13td2qe"),m(f,"id","resources"),m(z,"class","eqCont svelte-13td2qe"),m(D,"class","calcBox svelte-13td2qe"),m(D,"id","calc"),m(h,"class","svelte-13td2qe"),te(h,"portrait",!n[2]),Pe(he,"icon","octicon:log-16"),m(ne,"class","tooltip"),m(ne,"id","right"),m(X,"class","info svelte-13td2qe"),m(X,"id","changelog"),m(ue,"class","info svelte-13td2qe"),m(ue,"id","policy"),m(Se,"class","info svelte-13td2qe"),m(Se,"id","version")},m(K,ke){fe&&fe.m(Ft.head,null),p(Ft.head,e);for(let St=0;St<Ve.length;St+=1)Ve[St]&&Ve[St].m(Ft.head,null);p(Ft.head,t),nt&&nt.m(Ft.head,null),p(Ft.head,i),V&&V.m(Ft.head,null),p(Ft.head,s),Ne&&Ne.m(Ft.head,null),p(Ft.head,o),L(K,r,ke),L(K,l,ke);for(let St=0;St<U.length;St+=1)U[St]&&U[St].m(l,null);L(K,a,ke),pe&&pe.m(K,ke),L(K,c,ke),L(K,u,ke),L(K,d,ke),L(K,f,ke),L(K,_,ke),L(K,h,ke),Oe&&Oe.m(h,null),p(h,b),qe&&qe.m(h,null),p(h,v),se(w,h,null),p(h,k),se(y,h,null),p(h,I),p(h,D),p(D,z),se(S,z,null),p(z,j),se(B,z,null),p(D,Q),se(N,D,null),p(h,E),se(T,h,null),p(h,$),Fe&&Fe.m(h,null),p(h,R),~A&&ht[A].m(h,null),L(K,H,ke),L(K,X,ke),p(X,he),p(X,ce),p(X,ne),p(X,q),Y&&Y.m(X,null),L(K,Z,ke),L(K,ue,ke),L(K,Ee,ke),L(K,Se,ke),L(K,ze,ke),ut&&ut.m(K,ke),L(K,ct,ke),de=!0,je||(tt=[O(fn,"beforeunload",n[25]),O(fn,"storage",n[26]),O(fn,"wheel",n[27],{passive:!1}),O(fn,"keydown",n[28]),O(fn,"resize",n[29]),O(f,"click",n[30]),O(X,"click",n[36]),O(ue,"click",n[37])],je=!0)},p(K,ke){if(K[6]?fe&&(fe.d(1),fe=null):fe||(fe=Gl(),fe.c(),fe.m(e.parentNode,e)),ke[0]&2097152){Ue=De(K[21]);let Qe;for(Qe=0;Qe<Ue.length;Qe+=1){const Qn=Ul(K,Ue,Qe);Ve[Qe]?Ve[Qe].p(Qn,ke):(Ve[Qe]=Vl(Qn),Ve[Qe].c(),Ve[Qe].m(t.parentNode,t))}for(;Qe<Ve.length;Qe+=1)Ve[Qe].d(1);Ve.length=Ue.length}if(K[12]||!K[6]?nt||(nt=Kl(),nt.c(),nt.m(i.parentNode,i)):nt&&(nt.d(1),nt=null),K[5].screenshot.ongoing&&K[18][K[3]]<=1?V||(V=Yl(),V.c(),V.m(s.parentNode,s)):V&&(V.d(1),V=null),K[5].screenshot.ongoing?Ne||(Ne=Ql(),Ne.c(),Ne.m(o.parentNode,o)):Ne&&(Ne.d(1),Ne=null),ke[0]&2097664){ve=De(K[21]);let Qe;for(Qe=0;Qe<ve.length;Qe+=1){const Qn=Hl(K,ve,Qe);U[Qe]?U[Qe].p(Qn,ke):(U[Qe]=Xl(Qn),U[Qe].c(),U[Qe].m(l,null))}for(;Qe<U.length;Qe+=1)U[Qe].d(1);U.length=ve.length}K[7]?pe?(pe.p(K,ke),ke[0]&128&&F(pe,1)):(pe=Jl(K),pe.c(),F(pe,1),pe.m(c.parentNode,c)):pe&&(We(),W(pe,1,1,()=>{pe=null}),He()),K[5].screenshot.ongoing?Oe?(Oe.p(K,ke),ke[0]&32&&F(Oe,1)):(Oe=Zl(K),Oe.c(),F(Oe,1),Oe.m(h,b)):Oe&&(We(),W(Oe,1,1,()=>{Oe=null}),He()),K[4]?qe?(qe.p(K,ke),ke[0]&16&&F(qe,1)):(qe=xl(K),qe.c(),F(qe,1),qe.m(h,v)):qe&&(We(),W(qe,1,1,()=>{qe=null}),He()),K[5].screenshot.ongoing?Fe?(Fe.p(K,ke),ke[0]&32&&F(Fe,1)):(Fe=$l(K),Fe.c(),F(Fe,1),Fe.m(h,R)):Fe&&(We(),W(Fe,1,1,()=>{Fe=null}),He());let St=A;A=cn(K),A===St?~A&&ht[A].p(K,ke):(M&&(We(),W(ht[St],1,1,()=>{ht[St]=null}),He()),~A?(M=ht[A],M?M.p(K,ke):(M=ht[A]=Tt[A](K),M.c()),F(M,1),M.m(h,null)):M=null),(!de||ke[0]&4)&&te(h,"portrait",!K[2]),K[13]?Y&&(We(),W(Y,1,1,()=>{Y=null}),He()):Y?ke[0]&8192&&F(Y,1):(Y=ea(),Y.c(),F(Y,1),Y.m(X,null)),K[6]?ut&&(ut.d(1),ut=null):ut||(ut=ta(),ut.c(),ut.m(ct.parentNode,ct))},i(K){de||(F(pe),F(Oe),F(qe),F(w.$$.fragment,K),F(y.$$.fragment,K),F(S.$$.fragment,K),F(B.$$.fragment,K),F(N.$$.fragment,K),F(T.$$.fragment,K),F(Fe),F(M),F(Y),de=!0)},o(K){W(pe),W(Oe),W(qe),W(w.$$.fragment,K),W(y.$$.fragment,K),W(S.$$.fragment,K),W(B.$$.fragment,K),W(N.$$.fragment,K),W(T.$$.fragment,K),W(Fe),W(M),W(Y),de=!1},d(K){K&&(P(r),P(l),P(a),P(c),P(u),P(d),P(f),P(_),P(h),P(H),P(X),P(Z),P(ue),P(Ee),P(Se),P(ze),P(ct)),fe&&fe.d(K),P(e),ft(Ve,K),P(t),nt&&nt.d(K),P(i),V&&V.d(K),P(s),Ne&&Ne.d(K),P(o),ft(U,K),pe&&pe.d(K),Oe&&Oe.d(),qe&&qe.d(),oe(w),oe(y),oe(S),oe(B),oe(N),oe(T),Fe&&Fe.d(),~A&&ht[A].d(),Y&&Y.d(),ut&&ut.d(K),je=!1,be(tt)}}}let eo="v3.26.5";function Tb(n,e,t){let i,s,o,r,l,a,c,u,d,f,_,h,b,v,w;J(n,wt,V=>t(4,s=V)),J(n,x,V=>t(5,o=V)),J(n,gn,V=>t(12,r=V)),J(n,ro,V=>t(24,l=V)),J(n,Fn,V=>t(41,a=V)),J(n,zt,V=>t(42,c=V)),J(n,Ln,V=>t(43,u=V)),J(n,Mt,V=>t(44,d=V)),J(n,Ri,V=>t(13,f=V)),J(n,Xt,V=>t(14,_=V)),J(n,Nt,V=>t(15,h=V)),J(n,Pt,V=>t(45,b=V)),J(n,lo,V=>t(16,v=V)),J(n,It,V=>t(17,w=V));let k=!1,y,I,D,z=7,S=[.2,.3,.45,.6,.75,.85,.95,1,1.1,1.25,1.5,1.75,2,2.5,3,4,5],j=!1,B,Q=new URLSearchParams(location.search).get("id");for(let V of Ap){let Ne=`https://raw.githubusercontent.com/XT8SS/fantastic-calculator/gh-pages/ff-data/${V}.json`;fetch(Ne).then(async ve=>{if(ve.status!=200){console.error(`Failed to fetch "${V}" data!
Status: ${ve.status}`);return}G(Pt,b[V]=await ve.json(),b)}).catch(ve=>console.error(`Failed to initiate "${V}" data fetch!
${ve}`))}Iu(()=>{t(6,k=!0),Q&&N(),t(2,D=I>y),h[Object.keys(h)[0]]&&G(Xt,_=!0,_),localStorage.getItem("version")!=eo&&(G(Ri,f=!1,f),localStorage.setItem("version",eo)),localStorage.getItem("changelogSeen")||localStorage.setItem("changelogSeen",!1)});function N(){if(G(x,o.load.ongoing=!0,o),!Q.startsWith("-N"))G(x,o.load.status=-1,o),G(x,o.message="invalid_id",o);else{G(x,o.load.status=0,o);let V=xc(jn(Hn,"builds"),Zc()),Ne=0;Jc(V).then(ve=>{for(let U in ve.val()){if(U==Q){E(ve.val()[U],U);break}else Ne==Object.keys(ve.val()).length-1&&(G(x,o.load.status=-1,o),G(x,o.message="invalid_id",o));Ne++}}).catch(()=>{G(x,o.load.status=-1,o),G(x,o.message="firebase_fail",o)})}}function E(V,Ne){for(let ve in V.eq){let U=d[ve]||gs;V.eq[ve]&&V.eq[ve]!=U.name?u[ve][V.eq[ve]].querySelector("button").click():!V.eq[ve]&&U.name&&u[ve][U.name].querySelector("button").click()}for(let ve of kn){let U=c[ve]||bs;U.name&&a[ve][U.name].querySelector("button").click()}setTimeout(()=>{for(let ve of kn)V.gear[ve]&&a[ve][V.gear[ve]].querySelector("button").click();G(x,o.load.ongoing=!1,o),G(x,o.load.status=null,o),Ne&&(G(wt,s=V,s),G(wt,s.id=Ne,s),t(8,Q=null))})}let T=[],$=[],R,A,M=9;for(let V=0;V<M;V++)T.push(`backgrounds/BG${V}.jpg`);function H(V){A=Math.floor(Math.random()*V.length)}H(T);function X(){t(9,R=A),$.push(A)}X(),function V(){setTimeout(()=>{if(H(T),!$.length)X();else if($.length>3&&($=$.slice(1)),!$.includes(A))X();else{let Ne=[...Array(M).keys()].filter(ve=>!$.includes(ve));H(Ne),X()}document.hasFocus&&V()},45e3)}();function he(){B=setTimeout(()=>{t(7,j=!1)},750)}function ce(){clearTimeout(B),t(7,j=!0),he()}function ne(){G(x,o.export.status=null,o),G(x,o.export.ongoing=!1,o),G(x,o.save.status=null,o),G(x,o.save.ongoing=!1,o),G(x,o.load.status=null,o),G(x,o.load.ongoing=!1,o),G(x,o.delete.status=null,o),G(x,o.delete.ongoing=!1,o),G(x,o.share.ongoing=!1,o),G(x,o.message="",o)}let q=!1;const Z=V=>{(v||r)&&V.preventDefault()},ue=V=>{if(V.key=="builds")if(V.url.includes("ls=true")){G(Nt,h=JSON.parse(V.newValue),h),G(Xt,_=Object.keys(JSON.parse(V.newValue)).length>0,_),ne();let Ne=Object.keys(JSON.parse(V.oldValue)).filter(ve=>!Object.keys(JSON.parse(V.newValue)).includes(ve))[0];Ne&&s&&Ne==s.name&&G(wt,s=null,s)}else window.localStorage.setItem("builds",JSON.stringify(h))},Ee=V=>{let Ne=V.wheelDeltaY;if(V.ctrlKey){if(V.preventDefault(),S[z]==.2&&Ne<0||S[z]==5&&Ne>0)return;Ne>0?t(3,z++,z):t(3,z--,z),ce()}},Se=V=>{V.ctrlKey&&(V.key=="-"||V.key=="+"||V.code=="Equal"||V.key=="0")&&(V.preventDefault(),(V.key=="+"||V.code=="Equal")&&S[z]!=5?t(3,z++,z):V.key=="-"&&S[z]!=.2?t(3,z--,z):V.key=="0"&&S[z]!=1&&t(3,z=7),ce()),r&&Lp(V)};function ze(){t(0,y=fn.outerHeight),t(1,I=fn.outerWidth)}const ct=V=>{tn(V),r||G(x,o.resources.ongoing=!0,o)},de=()=>{r||G(x,o.share.ongoing=!0,o)},je=()=>t(10,q=!0),tt=()=>t(10,q=!1);function fe(V){Q=V,t(8,Q)}const Ue=V=>E(V.detail.build,V.detail.id),Ve=V=>{tn(V),!r&&(G(x,o.changelog.ongoing=!0,o),G(Ri,f=!0,f))},nt=V=>{tn(V),r||G(x,o.policy.ongoing=!0,o)};return n.$$.update=()=>{if(n.$$.dirty[0]&16777231&&(I||y)&&(t(2,D=I>y),document.documentElement.style.setProperty("--u",`${(D?.75:window.outerWidth/window.outerHeight/2)*S[z]}${CSS.supports("height: 1lvh")?"l":""}vh`),l))for(let V of l)Ho(V.node,V.itemName);n.$$.dirty[0]&32&&t(11,i=o.export.status||o.save.status||o.load.status||o.delete.status),n.$$.dirty[0]&32&&G(gn,r=o.item.ongoing||o.export.ongoing||o.save.ongoing||o.load.ongoing||o.delete.ongoing||o.share.ongoing||o.costs.ongoing||o.bonus.ongoing||o.randomize.ongoing||o.resources.ongoing||o.changelog.ongoing||o.policy.ongoing,r),n.$$.dirty[0]&16&&(document.title=(s?s.name+" - ":"")+"Fantastic Calculator")},[y,I,D,z,s,o,k,j,Q,R,q,i,r,f,_,h,v,w,S,N,E,T,ce,ne,l,Z,ue,Ee,Se,ze,ct,de,je,tt,fe,Ue,Ve,nt]}class Nb extends Ae{constructor(e){super(),Re(this,e,Tb,Ib,ge,{},null,[-1,-1])}}new Nb({target:document.body});
