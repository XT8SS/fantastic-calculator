var pu=Object.defineProperty;var _u=(n,e,t)=>e in n?pu(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var Zt=(n,e,t)=>(_u(n,typeof e!="symbol"?e+"":e,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&i(r)}).observe(document,{childList:!0,subtree:!0});function t(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(s){if(s.ep)return;s.ep=!0;const o=t(s);fetch(s.href,o)}})();function se(){}const is=n=>n;function mu(n,e){for(const t in e)n[t]=e[t];return n}function ca(n){return n()}function Xo(){return Object.create(null)}function be(n){n.forEach(ca)}function Kn(n){return typeof n=="function"}function ge(n,e){return n!=n?e==e:n!==e||n&&typeof n=="object"||typeof n=="function"}let Oi;function $e(n,e){return n===e?!0:(Oi||(Oi=document.createElement("a")),Oi.href=e,n===Oi.href)}function gu(n){return Object.keys(n).length===0}function bu(n,...e){if(n==null){for(const i of e)i(void 0);return se}const t=n.subscribe(...e);return t.unsubscribe?()=>t.unsubscribe():t}function Q(n,e,t){n.$$.on_destroy.push(bu(e,t))}function vu(n,e,t,i){if(n){const s=ua(n,e,t,i);return n[0](s)}}function ua(n,e,t,i){return n[1]&&i?mu(t.ctx.slice(),n[1](i(e))):t.ctx}function yu(n,e,t,i){if(n[2]&&i){const s=n[2](i(t));if(e.dirty===void 0)return s;if(typeof s=="object"){const o=[],r=Math.max(e.dirty.length,s.length);for(let l=0;l<r;l+=1)o[l]=e.dirty[l]|s[l];return o}return e.dirty|s}return e.dirty}function wu(n,e,t,i,s,o){if(s){const r=ua(e,t,i,o);n.p(r,s)}}function ku(n){if(n.ctx.length>32){const e=[],t=n.ctx.length/32;for(let i=0;i<t;i++)e[i]=-1;return e}return-1}function U(n,e,t){return n.set(t),e}function da(n){return n&&Kn(n.destroy)?n.destroy:se}const fa=typeof window<"u";let so=fa?()=>window.performance.now():()=>Date.now(),oo=fa?n=>requestAnimationFrame(n):se;const An=new Set;function ha(n){An.forEach(e=>{e.c(n)||(An.delete(e),e.f())}),An.size!==0&&oo(ha)}function ro(n){let e;return An.size===0&&oo(ha),{promise:new Promise(t=>{An.add(e={c:n,f:t})}),abort(){An.delete(e)}}}const Cu=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function p(n,e){n.appendChild(e)}function pa(n){if(!n)return document;const e=n.getRootNode?n.getRootNode():n.ownerDocument;return e&&e.host?e:n.ownerDocument}function Eu(n){const e=g("style");return e.textContent="/* empty */",Su(pa(n),e),e.sheet}function Su(n,e){return p(n.head||n,e),e.sheet}function M(n,e,t){n.insertBefore(e,t||null)}function R(n){n.parentNode&&n.parentNode.removeChild(n)}function ht(n,e){for(let t=0;t<n.length;t+=1)n[t]&&n[t].d(e)}function g(n){return document.createElement(n)}function Iu(n){return document.createElementNS("http://www.w3.org/2000/svg",n)}function te(n){return document.createTextNode(n)}function E(){return te(" ")}function pt(){return te("")}function N(n,e,t,i){return n.addEventListener(e,t,i),()=>n.removeEventListener(e,t,i)}function m(n,e,t){t==null?n.removeAttribute(e):n.getAttribute(e)!==t&&n.setAttribute(e,t)}function Re(n,e,t){e in n?n[e]=typeof n[e]=="boolean"&&t===""?!0:t:m(n,e,t)}function _a(n){return n===""?null:+n}function Tu(n){return Array.from(n.childNodes)}function Ee(n,e){e=""+e,n.data!==e&&(n.data=e)}function jt(n,e){n.value=e??""}function tt(n,e,t,i){t==null?n.style.removeProperty(e):n.style.setProperty(e,t,i?"important":"")}let Di;function Nu(){if(Di===void 0){Di=!1;try{typeof window<"u"&&window.parent&&window.parent.document}catch{Di=!0}}return Di}function rn(n,e){getComputedStyle(n).position==="static"&&(n.style.position="relative");const i=g("iframe");i.setAttribute("style","display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;"),i.setAttribute("aria-hidden","true"),i.tabIndex=-1;const s=Nu();let o;return s?(i.src="data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}<\/script>",o=N(window,"message",r=>{r.source===i.contentWindow&&e()})):(i.src="about:blank",i.onload=()=>{o=N(i.contentWindow,"resize",e),e()}),p(n,i),()=>{(s||o&&i.contentWindow)&&o(),R(i)}}function re(n,e,t){n.classList.toggle(e,!!t)}function ma(n,e,{bubbles:t=!1,cancelable:i=!1}={}){return new CustomEvent(n,{detail:e,bubbles:t,cancelable:i})}class Ou{constructor(e=!1){Zt(this,"is_svg",!1);Zt(this,"e");Zt(this,"n");Zt(this,"t");Zt(this,"a");this.is_svg=e,this.e=this.n=null}c(e){this.h(e)}m(e,t,i=null){this.e||(this.is_svg?this.e=Iu(t.nodeName):this.e=g(t.nodeType===11?"TEMPLATE":t.nodeName),this.t=t.tagName!=="TEMPLATE"?t:t.content,this.c(e)),this.i(i)}h(e){this.e.innerHTML=e,this.n=Array.from(this.e.nodeName==="TEMPLATE"?this.e.content.childNodes:this.e.childNodes)}i(e){for(let t=0;t<this.n.length;t+=1)M(this.t,this.n[t],e)}p(e){this.d(),this.h(e),this.i(this.a)}d(){this.n.forEach(R)}}const Li=new Map;let Fi=0;function Du(n){let e=5381,t=n.length;for(;t--;)e=(e<<5)-e^n.charCodeAt(t);return e>>>0}function Ru(n,e){const t={stylesheet:Eu(e),rules:{}};return Li.set(n,t),t}function Bi(n,e,t,i,s,o,r,l=0){const a=16.666/i;let c=`{
`;for(let v=0;v<=1;v+=a){const y=e+(t-e)*o(v);c+=v*100+`%{${r(y,1-y)}}
`}const u=c+`100% {${r(t,1-t)}}
}`,d=`__svelte_${Du(u)}_${l}`,f=pa(n),{stylesheet:h,rules:_}=Li.get(f)||Ru(f,n);_[d]||(_[d]=!0,h.insertRule(`@keyframes ${d} ${u}`,h.cssRules.length));const b=n.style.animation||"";return n.style.animation=`${b?`${b}, `:""}${d} ${i}ms linear ${s}ms 1 both`,Fi+=1,d}function qi(n,e){const t=(n.style.animation||"").split(", "),i=t.filter(e?o=>o.indexOf(e)<0:o=>o.indexOf("__svelte")===-1),s=t.length-i.length;s&&(n.style.animation=i.join(", "),Fi-=s,Fi||Au())}function Au(){oo(()=>{Fi||(Li.forEach(n=>{const{ownerNode:e}=n.stylesheet;e&&R(e)}),Li.clear())})}let ci;function si(n){ci=n}function ga(){if(!ci)throw new Error("Function called outside component initialization");return ci}function Pu(n){ga().$$.on_mount.push(n)}function Gt(){const n=ga();return(e,t,{cancelable:i=!1}={})=>{const s=n.$$.callbacks[e];if(s){const o=ma(e,t,{cancelable:i});return s.slice().forEach(r=>{r.call(n,o)}),!o.defaultPrevented}return!0}}const Dn=[],le=[];let Pn=[];const Ls=[],Mu=Promise.resolve();let Fs=!1;function Lu(){Fs||(Fs=!0,Mu.then(ba))}function ve(n){Pn.push(n)}function Ae(n){Ls.push(n)}const ks=new Set;let Tn=0;function ba(){if(Tn!==0)return;const n=ci;do{try{for(;Tn<Dn.length;){const e=Dn[Tn];Tn++,si(e),Fu(e.$$)}}catch(e){throw Dn.length=0,Tn=0,e}for(si(null),Dn.length=0,Tn=0;le.length;)le.pop()();for(let e=0;e<Pn.length;e+=1){const t=Pn[e];ks.has(t)||(ks.add(t),t())}Pn.length=0}while(Dn.length);for(;Ls.length;)Ls.pop()();Fs=!1,ks.clear(),si(n)}function Fu(n){if(n.fragment!==null){n.update(),be(n.before_update);const e=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,e),n.after_update.forEach(ve)}}function Bu(n){const e=[],t=[];Pn.forEach(i=>n.indexOf(i)===-1?e.push(i):t.push(i)),t.forEach(i=>i()),Pn=e}let xn;function lo(){return xn||(xn=Promise.resolve(),xn.then(()=>{xn=null})),xn}function gn(n,e,t){n.dispatchEvent(ma(`${e?"intro":"outro"}${t}`))}const Pi=new Set;let Ht;function qe(){Ht={r:0,c:[],p:Ht}}function We(){Ht.r||be(Ht.c),Ht=Ht.p}function L(n,e){n&&n.i&&(Pi.delete(n),n.i(e))}function z(n,e,t,i){if(n&&n.o){if(Pi.has(n))return;Pi.add(n),Ht.c.push(()=>{Pi.delete(n),i&&(t&&n.d(1),i())}),n.o(e)}else i&&i()}const ao={duration:0};function va(n,e,t){const i={direction:"in"};let s=e(n,t,i),o=!1,r,l,a=0;function c(){r&&qi(n,r)}function u(){const{delay:f=0,duration:h=300,easing:_=is,tick:b=se,css:v}=s||ao;v&&(r=Bi(n,0,1,h,f,_,v,a++)),b(0,1);const y=so()+f,k=y+h;l&&l.abort(),o=!0,ve(()=>gn(n,!0,"start")),l=ro(w=>{if(o){if(w>=k)return b(1,0),gn(n,!0,"end"),c(),o=!1;if(w>=y){const I=_((w-y)/h);b(I,1-I)}}return o})}let d=!1;return{start(){d||(d=!0,qi(n),Kn(s)?(s=s(i),lo().then(u)):u())},invalidate(){d=!1},end(){o&&(c(),o=!1)}}}function ya(n,e,t){const i={direction:"out"};let s=e(n,t,i),o=!0,r;const l=Ht;l.r+=1;let a;function c(){const{delay:u=0,duration:d=300,easing:f=is,tick:h=se,css:_}=s||ao;_&&(r=Bi(n,1,0,d,u,f,_));const b=so()+u,v=b+d;ve(()=>gn(n,!1,"start")),"inert"in n&&(a=n.inert,n.inert=!0),ro(y=>{if(o){if(y>=v)return h(0,1),gn(n,!1,"end"),--l.r||be(l.c),!1;if(y>=b){const k=f((y-b)/d);h(1-k,k)}}return o})}return Kn(s)?lo().then(()=>{s=s(i),c()}):c(),{end(u){u&&"inert"in n&&(n.inert=a),u&&s.tick&&s.tick(1,0),o&&(r&&qi(n,r),o=!1)}}}function me(n,e,t,i){let o=e(n,t,{direction:"both"}),r=i?0:1,l=null,a=null,c=null,u;function d(){c&&qi(n,c)}function f(_,b){const v=_.b-r;return b*=Math.abs(v),{a:r,b:_.b,d:v,duration:b,start:_.start,end:_.start+b,group:_.group}}function h(_){const{delay:b=0,duration:v=300,easing:y=is,tick:k=se,css:w}=o||ao,I={start:so()+b,b:_};_||(I.group=Ht,Ht.r+=1),"inert"in n&&(_?u!==void 0&&(n.inert=u):(u=n.inert,n.inert=!0)),l||a?a=I:(w&&(d(),c=Bi(n,r,_,v,b,y,w)),_&&k(0,1),l=f(I,v),ve(()=>gn(n,_,"start")),ro(A=>{if(a&&A>a.start&&(l=f(a,v),a=null,gn(n,l.b,"start"),w&&(d(),c=Bi(n,r,l.b,l.duration,0,y,o.css))),l){if(A>=l.end)k(r=l.b,1-r),gn(n,l.b,"end"),a||(l.b?d():--l.group.r||be(l.group.c)),l=null;else if(A>=l.start){const q=A-l.start;r=l.a+l.d*y(q/l.duration),k(r,1-r)}}return!!(l||a)}))}return{run(_){Kn(o)?lo().then(()=>{o=o({direction:_?"in":"out"}),h(_)}):h(_)},end(){d(),l=a=null}}}function Ne(n){return(n==null?void 0:n.length)!==void 0?n:Array.from(n)}function Pe(n,e,t){const i=n.$$.props[e];i!==void 0&&(n.$$.bound[i]=t,t(n.$$.ctx[i]))}function oe(n){n&&n.c()}function ne(n,e,t){const{fragment:i,after_update:s}=n.$$;i&&i.m(e,t),ve(()=>{const o=n.$$.on_mount.map(ca).filter(Kn);n.$$.on_destroy?n.$$.on_destroy.push(...o):be(o),n.$$.on_mount=[]}),s.forEach(ve)}function ie(n,e){const t=n.$$;t.fragment!==null&&(Bu(t.after_update),be(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function qu(n,e){n.$$.dirty[0]===-1&&(Dn.push(n),Lu(),n.$$.dirty.fill(0)),n.$$.dirty[e/31|0]|=1<<e%31}function Ie(n,e,t,i,s,o,r=null,l=[-1]){const a=ci;si(n);const c=n.$$={fragment:null,ctx:[],props:o,update:se,not_equal:s,bound:Xo(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(a?a.$$.context:[])),callbacks:Xo(),dirty:l,skip_bound:!1,root:e.target||a.$$.root};r&&r(c.root);let u=!1;if(c.ctx=t?t(n,e.props||{},(d,f,...h)=>{const _=h.length?h[0]:f;return c.ctx&&s(c.ctx[d],c.ctx[d]=_)&&(!c.skip_bound&&c.bound[d]&&c.bound[d](_),u&&qu(n,d)),f}):[],c.update(),u=!0,be(c.before_update),c.fragment=i?i(c.ctx):!1,e.target){if(e.hydrate){const d=Tu(e.target);c.fragment&&c.fragment.l(d),d.forEach(R)}else c.fragment&&c.fragment.c();e.intro&&L(n.$$.fragment),ne(n,e.target,e.anchor),ba()}si(a)}class Te{constructor(){Zt(this,"$$");Zt(this,"$$set")}$destroy(){ie(this,1),this.$destroy=se}$on(e,t){if(!Kn(t))return se;const i=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return i.push(t),()=>{const s=i.indexOf(t);s!==-1&&i.splice(s,1)}}$set(e){this.$$set&&!gu(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Wu="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Wu);const Nn=[];function it(n,e=se){let t;const i=new Set;function s(l){if(ge(n,l)&&(n=l,t)){const a=!Nn.length;for(const c of i)c[1](),Nn.push(c,n);if(a){for(let c=0;c<Nn.length;c+=2)Nn[c][0](Nn[c+1]);Nn.length=0}}}function o(l){s(l(n))}function r(l,a=se){const c=[l,a];return i.add(c),i.size===1&&(t=e(s,o)||se),l(n),()=>{i.delete(c),i.size===0&&t&&(t(),t=null)}}return{set:s,update:o,subscribe:r}}let Zo=localStorage.getItem("builds"),xo=0,$o=localStorage.getItem("changelogSeen"),er=localStorage.getItem("supportMe"),Bt=it({}),qt=it({}),bt=it({armor:0,magicDmg:0,meleeDmg:0,rangedDmg:0,hpRegen:0,endurance:0,sightRange:0,walkSpeed:0,jumpPower:0,ammoReturn:0,height:0}),zt=it({}),co=it([]),Cs=it({}),kt=it(),uo=it(!1),Rt=it(Zo?JSON.parse(Zo):{}),xt=it(!1),Mi=it($o?JSON.parse($o):!1),bn=it(er?JSON.parse(er):{showAgain:!0,timesDenied:0,totalVisits:0,lastVisits:0}),yn=it(!1),qn=it({}),Wn=it({}),ju=it({}),Nt=it({armor:{min:0,avg:0,max:0},gear:{min:0,avg:0,max:0},total:{min:0,avg:0,max:0}}),Mn=it({}),$n=it({parasol:!0,armor:!0,gear:!0,basic:!0}),X=it({item:{ongoing:!1,data:null},export:{ongoing:!1,status:null},save:{ongoing:!1,status:null},load:{ongoing:!1,status:null},delete:{ongoing:!1,status:null},share:{ongoing:!1},costs:{ongoing:!1},bonus:{ongoing:!1},screenshot:{ongoing:!1},randomize:{ongoing:!1},resources:{ongoing:!1},changelog:{ongoing:!1},policy:{ongoing:!1},donate:{ongoing:!1},message:""});Rt.subscribe(n=>{xo++,setTimeout(()=>{window.localStorage.setItem("builds",JSON.stringify(n)),xo>1&&window.history.replaceState(null,null,location.origin+location.pathname)})});Mi.subscribe(n=>window.localStorage.setItem("changelogSeen",JSON.stringify(n)));bn.subscribe(n=>localStorage.setItem("supportMe",JSON.stringify(n)));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wa={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $=function(n,e){if(!n)throw Yn(e)},Yn=function(n){return new Error("Firebase Database ("+wa.SDK_VERSION+") INTERNAL ASSERT FAILED: "+n)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ka=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let s=n.charCodeAt(i);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},Hu=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const s=n[t++];if(s<128)e[i++]=String.fromCharCode(s);else if(s>191&&s<224){const o=n[t++];e[i++]=String.fromCharCode((s&31)<<6|o&63)}else if(s>239&&s<365){const o=n[t++],r=n[t++],l=n[t++],a=((s&7)<<18|(o&63)<<12|(r&63)<<6|l&63)-65536;e[i++]=String.fromCharCode(55296+(a>>10)),e[i++]=String.fromCharCode(56320+(a&1023))}else{const o=n[t++],r=n[t++];e[i++]=String.fromCharCode((s&15)<<12|(o&63)<<6|r&63)}}return e.join("")},fo={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let s=0;s<n.length;s+=3){const o=n[s],r=s+1<n.length,l=r?n[s+1]:0,a=s+2<n.length,c=a?n[s+2]:0,u=o>>2,d=(o&3)<<4|l>>4;let f=(l&15)<<2|c>>6,h=c&63;a||(h=64,r||(f=64)),i.push(t[u],t[d],t[f],t[h])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(ka(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):Hu(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let s=0;s<n.length;){const o=t[n.charAt(s++)],l=s<n.length?t[n.charAt(s)]:0;++s;const c=s<n.length?t[n.charAt(s)]:64;++s;const d=s<n.length?t[n.charAt(s)]:64;if(++s,o==null||l==null||c==null||d==null)throw new zu;const f=o<<2|l>>4;if(i.push(f),c!==64){const h=l<<4&240|c>>2;if(i.push(h),d!==64){const _=c<<6&192|d;i.push(_)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class zu extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Ca=function(n){const e=ka(n);return fo.encodeByteArray(e,!0)},Wi=function(n){return Ca(n).replace(/\./g,"")},Bs=function(n){try{return fo.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uu(n){return Ea(void 0,n)}function Ea(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!Gu(t)||(n[t]=Ea(n[t],e[t]));return n}function Gu(n){return n!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vu(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ku=()=>Vu().__FIREBASE_DEFAULTS__,Yu=()=>{if(typeof process>"u"||typeof process.env>"u")return;const n={}.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},Qu=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Bs(n[1]);return e&&JSON.parse(e)},Sa=()=>{try{return Ku()||Yu()||Qu()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Ju=n=>{var e,t;return(t=(e=Sa())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},Xu=n=>{const e=Ju(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},Ia=()=>{var n;return(n=Sa())===null||n===void 0?void 0:n.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ss{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zu(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",s=n.iat||0,o=n.sub||n.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const r=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:s,exp:s+3600,auth_time:s,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},n),l="";return[Wi(JSON.stringify(t)),Wi(JSON.stringify(r)),l].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xu(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Ta(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(xu())}function $u(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Na(){return wa.NODE_ADMIN===!0}function ed(){try{return typeof indexedDB=="object"}catch{return!1}}function td(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(i);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{var o;e(((o=s.error)===null||o===void 0?void 0:o.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nd="FirebaseError";class ki extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=nd,Object.setPrototypeOf(this,ki.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Oa.prototype.create)}}class Oa{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},s=`${this.service}/${e}`,o=this.errors[e],r=o?id(o,i):"Error",l=`${this.serviceName}: ${r} (${s}).`;return new ki(s,l,i)}}function id(n,e){return n.replace(sd,(t,i)=>{const s=e[i];return s!=null?String(s):`<${i}?>`})}const sd=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ui(n){return JSON.parse(n)}function lt(n){return JSON.stringify(n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Da=function(n){let e={},t={},i={},s="";try{const o=n.split(".");e=ui(Bs(o[0])||""),t=ui(Bs(o[1])||""),s=o[2],i=t.d||{},delete t.d}catch{}return{header:e,claims:t,data:i,signature:s}},od=function(n){const e=Da(n),t=e.claims;return!!t&&typeof t=="object"&&t.hasOwnProperty("iat")},rd=function(n){const e=Da(n).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vt(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function jn(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]}function tr(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function ji(n,e,t){const i={};for(const s in n)Object.prototype.hasOwnProperty.call(n,s)&&(i[s]=e.call(t,n[s],s,n));return i}function qs(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const s of t){if(!i.includes(s))return!1;const o=n[s],r=e[s];if(nr(o)&&nr(r)){if(!qs(o,r))return!1}else if(o!==r)return!1}for(const s of i)if(!t.includes(s))return!1;return!0}function nr(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ld(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ad{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const i=this.W_;if(typeof e=="string")for(let d=0;d<16;d++)i[d]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let d=0;d<16;d++)i[d]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let d=16;d<80;d++){const f=i[d-3]^i[d-8]^i[d-14]^i[d-16];i[d]=(f<<1|f>>>31)&4294967295}let s=this.chain_[0],o=this.chain_[1],r=this.chain_[2],l=this.chain_[3],a=this.chain_[4],c,u;for(let d=0;d<80;d++){d<40?d<20?(c=l^o&(r^l),u=1518500249):(c=o^r^l,u=1859775393):d<60?(c=o&r|l&(o|r),u=2400959708):(c=o^r^l,u=3395469782);const f=(s<<5|s>>>27)+c+a+u+i[d]&4294967295;a=l,l=r,r=(o<<30|o>>>2)&4294967295,o=s,s=f}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+o&4294967295,this.chain_[2]=this.chain_[2]+r&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+a&4294967295}update(e,t){if(e==null)return;t===void 0&&(t=e.length);const i=t-this.blockSize;let s=0;const o=this.buf_;let r=this.inbuf_;for(;s<t;){if(r===0)for(;s<=i;)this.compress_(e,s),s+=this.blockSize;if(typeof e=="string"){for(;s<t;)if(o[r]=e.charCodeAt(s),++r,++s,r===this.blockSize){this.compress_(o),r=0;break}}else for(;s<t;)if(o[r]=e[s],++r,++s,r===this.blockSize){this.compress_(o),r=0;break}}this.inbuf_=r,this.total_+=t}digest(){const e=[];let t=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let s=this.blockSize-1;s>=56;s--)this.buf_[s]=t&255,t/=256;this.compress_(this.buf_);let i=0;for(let s=0;s<5;s++)for(let o=24;o>=0;o-=8)e[i]=this.chain_[s]>>o&255,++i;return e}}function ho(n,e){return`${n} failed: ${e} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cd=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let s=n.charCodeAt(i);if(s>=55296&&s<=56319){const o=s-55296;i++,$(i<n.length,"Surrogate pair missing trail surrogate.");const r=n.charCodeAt(i)-56320;s=65536+(o<<10)+r}s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):s<65536?(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},os=function(n){let e=0;for(let t=0;t<n.length;t++){const i=n.charCodeAt(t);i<128?e++:i<2048?e+=2:i>=55296&&i<=56319?(e+=4,t++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dn(n){return n&&n._delegate?n._delegate:n}class di{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fn="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ud{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new ss;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&i.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const i=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(o){if(s)return null;throw o}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(fd(e))try{this.getOrInitializeService({instanceIdentifier:fn})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const o=this.getOrInitializeService({instanceIdentifier:s});i.resolve(o)}catch{}}}}clearInstance(e=fn){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=fn){return this.instances.has(e)}getOptions(e=fn){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[o,r]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(o);i===l&&r.resolve(s)}return s}onInit(e,t){var i;const s=this.normalizeInstanceIdentifier(t),o=(i=this.onInitCallbacks.get(s))!==null&&i!==void 0?i:new Set;o.add(e),this.onInitCallbacks.set(s,o);const r=this.instances.get(s);return r&&e(r,s),()=>{o.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const s of i)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:dd(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=fn){return this.component?this.component.multipleInstances?e:fn:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function dd(n){return n===fn?void 0:n}function fd(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hd{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new ud(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ve;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Ve||(Ve={}));const pd={debug:Ve.DEBUG,verbose:Ve.VERBOSE,info:Ve.INFO,warn:Ve.WARN,error:Ve.ERROR,silent:Ve.SILENT},_d=Ve.INFO,md={[Ve.DEBUG]:"log",[Ve.VERBOSE]:"log",[Ve.INFO]:"info",[Ve.WARN]:"warn",[Ve.ERROR]:"error"},gd=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),s=md[e];if(s)console[s](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Ra{constructor(e){this.name=e,this._logLevel=_d,this._logHandler=gd,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ve))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?pd[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ve.DEBUG,...e),this._logHandler(this,Ve.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ve.VERBOSE,...e),this._logHandler(this,Ve.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ve.INFO,...e),this._logHandler(this,Ve.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ve.WARN,...e),this._logHandler(this,Ve.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ve.ERROR,...e),this._logHandler(this,Ve.ERROR,...e)}}const bd=(n,e)=>e.some(t=>n instanceof t);let ir,sr;function vd(){return ir||(ir=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function yd(){return sr||(sr=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Aa=new WeakMap,Ws=new WeakMap,Pa=new WeakMap,Es=new WeakMap,po=new WeakMap;function wd(n){const e=new Promise((t,i)=>{const s=()=>{n.removeEventListener("success",o),n.removeEventListener("error",r)},o=()=>{t($t(n.result)),s()},r=()=>{i(n.error),s()};n.addEventListener("success",o),n.addEventListener("error",r)});return e.then(t=>{t instanceof IDBCursor&&Aa.set(t,n)}).catch(()=>{}),po.set(e,n),e}function kd(n){if(Ws.has(n))return;const e=new Promise((t,i)=>{const s=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",r),n.removeEventListener("abort",r)},o=()=>{t(),s()},r=()=>{i(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",o),n.addEventListener("error",r),n.addEventListener("abort",r)});Ws.set(n,e)}let js={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Ws.get(n);if(e==="objectStoreNames")return n.objectStoreNames||Pa.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return $t(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function Cd(n){js=n(js)}function Ed(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(Ss(this),e,...t);return Pa.set(i,e.sort?e.sort():[e]),$t(i)}:yd().includes(n)?function(...e){return n.apply(Ss(this),e),$t(Aa.get(this))}:function(...e){return $t(n.apply(Ss(this),e))}}function Sd(n){return typeof n=="function"?Ed(n):(n instanceof IDBTransaction&&kd(n),bd(n,vd())?new Proxy(n,js):n)}function $t(n){if(n instanceof IDBRequest)return wd(n);if(Es.has(n))return Es.get(n);const e=Sd(n);return e!==n&&(Es.set(n,e),po.set(e,n)),e}const Ss=n=>po.get(n);function Id(n,e,{blocked:t,upgrade:i,blocking:s,terminated:o}={}){const r=indexedDB.open(n,e),l=$t(r);return i&&r.addEventListener("upgradeneeded",a=>{i($t(r.result),a.oldVersion,a.newVersion,$t(r.transaction),a)}),t&&r.addEventListener("blocked",a=>t(a.oldVersion,a.newVersion,a)),l.then(a=>{o&&a.addEventListener("close",()=>o()),s&&a.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),l}const Td=["get","getKey","getAll","getAllKeys","count"],Nd=["put","add","delete","clear"],Is=new Map;function or(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Is.get(e))return Is.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,s=Nd.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(s||Td.includes(t)))return;const o=async function(r,...l){const a=this.transaction(r,s?"readwrite":"readonly");let c=a.store;return i&&(c=c.index(l.shift())),(await Promise.all([c[t](...l),s&&a.done]))[0]};return Is.set(e,o),o}Cd(n=>({...n,get:(e,t,i)=>or(e,t)||n.get(e,t,i),has:(e,t)=>!!or(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Od{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(Dd(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function Dd(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Hs="@firebase/app",rr="0.9.23";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wn=new Ra("@firebase/app"),Rd="@firebase/app-compat",Ad="@firebase/analytics-compat",Pd="@firebase/analytics",Md="@firebase/app-check-compat",Ld="@firebase/app-check",Fd="@firebase/auth",Bd="@firebase/auth-compat",qd="@firebase/database",Wd="@firebase/database-compat",jd="@firebase/functions",Hd="@firebase/functions-compat",zd="@firebase/installations",Ud="@firebase/installations-compat",Gd="@firebase/messaging",Vd="@firebase/messaging-compat",Kd="@firebase/performance",Yd="@firebase/performance-compat",Qd="@firebase/remote-config",Jd="@firebase/remote-config-compat",Xd="@firebase/storage",Zd="@firebase/storage-compat",xd="@firebase/firestore",$d="@firebase/firestore-compat",ef="firebase",tf="10.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zs="[DEFAULT]",nf={[Hs]:"fire-core",[Rd]:"fire-core-compat",[Pd]:"fire-analytics",[Ad]:"fire-analytics-compat",[Ld]:"fire-app-check",[Md]:"fire-app-check-compat",[Fd]:"fire-auth",[Bd]:"fire-auth-compat",[qd]:"fire-rtdb",[Wd]:"fire-rtdb-compat",[jd]:"fire-fn",[Hd]:"fire-fn-compat",[zd]:"fire-iid",[Ud]:"fire-iid-compat",[Gd]:"fire-fcm",[Vd]:"fire-fcm-compat",[Kd]:"fire-perf",[Yd]:"fire-perf-compat",[Qd]:"fire-rc",[Jd]:"fire-rc-compat",[Xd]:"fire-gcs",[Zd]:"fire-gcs-compat",[xd]:"fire-fst",[$d]:"fire-fst-compat","fire-js":"fire-js",[ef]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hi=new Map,Us=new Map;function sf(n,e){try{n.container.addComponent(e)}catch(t){wn.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function zi(n){const e=n.name;if(Us.has(e))return wn.debug(`There were multiple attempts to register component ${e}.`),!1;Us.set(e,n);for(const t of Hi.values())sf(t,n);return!0}function of(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rf={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},en=new Oa("app","Firebase",rf);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lf{constructor(e,t,i){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new di("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw en.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const af=tf;function Ma(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i=Object.assign({name:zs,automaticDataCollectionEnabled:!1},e),s=i.name;if(typeof s!="string"||!s)throw en.create("bad-app-name",{appName:String(s)});if(t||(t=Ia()),!t)throw en.create("no-options");const o=Hi.get(s);if(o){if(qs(t,o.options)&&qs(i,o.config))return o;throw en.create("duplicate-app",{appName:s})}const r=new hd(s);for(const a of Us.values())r.addComponent(a);const l=new lf(t,i,r);return Hi.set(s,l),l}function cf(n=zs){const e=Hi.get(n);if(!e&&n===zs&&Ia())return Ma();if(!e)throw en.create("no-app",{appName:n});return e}function Ln(n,e,t){var i;let s=(i=nf[n])!==null&&i!==void 0?i:n;t&&(s+=`-${t}`);const o=s.match(/\s|\//),r=e.match(/\s|\//);if(o||r){const l=[`Unable to register library "${s}" with version "${e}":`];o&&l.push(`library name "${s}" contains illegal characters (whitespace or "/")`),o&&r&&l.push("and"),r&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),wn.warn(l.join(" "));return}zi(new di(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uf="firebase-heartbeat-database",df=1,fi="firebase-heartbeat-store";let Ts=null;function La(){return Ts||(Ts=Id(uf,df,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(fi)}}}).catch(n=>{throw en.create("idb-open",{originalErrorMessage:n.message})})),Ts}async function ff(n){try{return await(await La()).transaction(fi).objectStore(fi).get(Fa(n))}catch(e){if(e instanceof ki)wn.warn(e.message);else{const t=en.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});wn.warn(t.message)}}}async function lr(n,e){try{const i=(await La()).transaction(fi,"readwrite");await i.objectStore(fi).put(e,Fa(n)),await i.done}catch(t){if(t instanceof ki)wn.warn(t.message);else{const i=en.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});wn.warn(i.message)}}}function Fa(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hf=1024,pf=30*24*60*60*1e3;class _f{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new gf(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var e;const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=ar();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)))return this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const r=new Date(o.date).valueOf();return Date.now()-r<=pf}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var e;if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=ar(),{heartbeatsToSend:i,unsentEntries:s}=mf(this._heartbeatsCache.heartbeats),o=Wi(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=t,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}}function ar(){return new Date().toISOString().substring(0,10)}function mf(n,e=hf){const t=[];let i=n.slice();for(const s of n){const o=t.find(r=>r.agent===s.agent);if(o){if(o.dates.push(s.date),cr(t)>e){o.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),cr(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class gf{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return ed()?td().then(()=>!0).catch(()=>!1):!1}async read(){return await this._canUseIndexedDBPromise?await ff(this.app)||{heartbeats:[]}:{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return lr(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return lr(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function cr(n){return Wi(JSON.stringify({version:2,heartbeats:n})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bf(n){zi(new di("platform-logger",e=>new Od(e),"PRIVATE")),zi(new di("heartbeat",e=>new _f(e),"PRIVATE")),Ln(Hs,rr,n),Ln(Hs,rr,"esm2017"),Ln("fire-js","")}bf("");var vf="firebase",yf="10.6.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ln(vf,yf,"app");const ur="@firebase/database",dr="1.0.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ba="";function wf(n){Ba=n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kf{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),lt(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:ui(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cf{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return Vt(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qa=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){const e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new kf(e)}}catch{}return new Cf},_n=qa("localStorage"),Gs=qa("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fn=new Ra("@firebase/database"),Ef=function(){let n=1;return function(){return n++}}(),Wa=function(n){const e=cd(n),t=new ad;t.update(e);const i=t.digest();return fo.encodeByteArray(i)},Ci=function(...n){let e="";for(let t=0;t<n.length;t++){const i=n[t];Array.isArray(i)||i&&typeof i=="object"&&typeof i.length=="number"?e+=Ci.apply(null,i):typeof i=="object"?e+=lt(i):e+=i,e+=" "}return e};let vn=null,fr=!0;const Sf=function(n,e){$(!e||n===!0||n===!1,"Can't turn on custom loggers persistently."),n===!0?(Fn.logLevel=Ve.VERBOSE,vn=Fn.log.bind(Fn),e&&Gs.set("logging_enabled",!0)):typeof n=="function"?vn=n:(vn=null,Gs.remove("logging_enabled"))},_t=function(...n){if(fr===!0&&(fr=!1,vn===null&&Gs.get("logging_enabled")===!0&&Sf(!0)),vn){const e=Ci.apply(null,n);vn(e)}},Ei=function(n){return function(...e){_t(n,...e)}},Vs=function(...n){const e="FIREBASE INTERNAL ERROR: "+Ci(...n);Fn.error(e)},Qt=function(...n){const e=`FIREBASE FATAL ERROR: ${Ci(...n)}`;throw Fn.error(e),new Error(e)},Et=function(...n){const e="FIREBASE WARNING: "+Ci(...n);Fn.warn(e)},If=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Et("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},_o=function(n){return typeof n=="number"&&(n!==n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},Tf=function(n){if(document.readyState==="complete")n();else{let e=!1;const t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,n())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},kn="[MIN_NAME]",ln="[MAX_NAME]",Qn=function(n,e){if(n===e)return 0;if(n===kn||e===ln)return-1;if(e===kn||n===ln)return 1;{const t=hr(n),i=hr(e);return t!==null?i!==null?t-i===0?n.length-e.length:t-i:-1:i!==null?1:n<e?-1:1}},Nf=function(n,e){return n===e?0:n<e?-1:1},ei=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+lt(e))},mo=function(n){if(typeof n!="object"||n===null)return lt(n);const e=[];for(const i in n)e.push(i);e.sort();let t="{";for(let i=0;i<e.length;i++)i!==0&&(t+=","),t+=lt(e[i]),t+=":",t+=mo(n[e[i]]);return t+="}",t},ja=function(n,e){const t=n.length;if(t<=e)return[n];const i=[];for(let s=0;s<t;s+=e)s+e>t?i.push(n.substring(s,t)):i.push(n.substring(s,s+e));return i};function St(n,e){for(const t in n)n.hasOwnProperty(t)&&e(t,n[t])}const Ha=function(n){$(!_o(n),"Invalid JSON number");const e=11,t=52,i=(1<<e-1)-1;let s,o,r,l,a;n===0?(o=0,r=0,s=1/n===-1/0?1:0):(s=n<0,n=Math.abs(n),n>=Math.pow(2,1-i)?(l=Math.min(Math.floor(Math.log(n)/Math.LN2),i),o=l+i,r=Math.round(n*Math.pow(2,t-l)-Math.pow(2,t))):(o=0,r=Math.round(n/Math.pow(2,1-i-t))));const c=[];for(a=t;a;a-=1)c.push(r%2?1:0),r=Math.floor(r/2);for(a=e;a;a-=1)c.push(o%2?1:0),o=Math.floor(o/2);c.push(s?1:0),c.reverse();const u=c.join("");let d="";for(a=0;a<64;a+=8){let f=parseInt(u.substr(a,8),2).toString(16);f.length===1&&(f="0"+f),d=d+f}return d.toLowerCase()},Of=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},Df=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function Rf(n,e){let t="Unknown Error";n==="too_big"?t="The data requested exceeds the maximum size that can be accessed with a single request.":n==="permission_denied"?t="Client doesn't have permission to access the desired data.":n==="unavailable"&&(t="The service is unavailable");const i=new Error(n+" at "+e._path.toString()+": "+t);return i.code=n.toUpperCase(),i}const Af=new RegExp("^-?(0*)\\d{1,10}$"),Pf=-2147483648,Mf=2147483647,hr=function(n){if(Af.test(n)){const e=Number(n);if(e>=Pf&&e<=Mf)return e}return null},Jn=function(n){try{n()}catch(e){setTimeout(()=>{const t=e.stack||"";throw Et("Exception was thrown by user callback.",t),e},Math.floor(0))}},Lf=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},oi=function(n,e){const t=setTimeout(n,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ff{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=t==null?void 0:t.getImmediate({optional:!0}),this.appCheck||t==null||t.get().then(i=>this.appCheck=i)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,i)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,i):t(null)},0)})}addTokenChangeListener(e){var t;(t=this.appCheckProvider)===null||t===void 0||t.get().then(i=>i.addTokenListener(e))}notifyForInvalidToken(){Et(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bf{constructor(e,t,i){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=i,this.auth_=null,this.auth_=i.getImmediate({optional:!0}),this.auth_||i.onInit(s=>this.auth_=s)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(_t("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,i)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,i):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Et(e)}}class Bn{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}Bn.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const go="5",za="v",Ua="s",Ga="r",Va="f",Ka=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,Ya="ls",Qa="p",Ks="ac",Ja="websocket",Xa="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Za{constructor(e,t,i,s,o=!1,r="",l=!1,a=!1){this.secure=t,this.namespace=i,this.webSocketOnly=s,this.nodeAdmin=o,this.persistenceKey=r,this.includeNamespaceInQueryParams=l,this.isUsingEmulator=a,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=_n.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&_n.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}}function qf(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams}function xa(n,e,t){$(typeof e=="string","typeof type must == string"),$(typeof t=="object","typeof params must == object");let i;if(e===Ja)i=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else if(e===Xa)i=(n.secure?"https://":"http://")+n.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);qf(n)&&(t.ns=n.namespace);const s=[];return St(t,(o,r)=>{s.push(o+"="+r)}),i+s.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wf{constructor(){this.counters_={}}incrementCounter(e,t=1){Vt(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return Uu(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ns={},Os={};function bo(n){const e=n.toString();return Ns[e]||(Ns[e]=new Wf),Ns[e]}function jf(n,e){const t=n.toString();return Os[t]||(Os[t]=e()),Os[t]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hf{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const i=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let s=0;s<i.length;++s)i[s]&&Jn(()=>{this.onMessage_(i[s])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pr="start",zf="close",Uf="pLPCommand",Gf="pRTLPCB",$a="id",ec="pw",tc="ser",Vf="cb",Kf="seg",Yf="ts",Qf="d",Jf="dframe",nc=1870,ic=30,Xf=nc-ic,Zf=25e3,xf=3e4;class Rn{constructor(e,t,i,s,o,r,l){this.connId=e,this.repoInfo=t,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.transportSessionId=r,this.lastSessionId=l,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Ei(e),this.stats_=bo(t),this.urlFn=a=>(this.appCheckToken&&(a[Ks]=this.appCheckToken),xa(t,Xa,a))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new Hf(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(xf)),Tf(()=>{if(this.isClosed_)return;this.scriptTagHolder=new vo((...o)=>{const[r,l,a,c,u]=o;if(this.incrementIncomingBytes_(o),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,r===pr)this.id=l,this.password=a;else if(r===zf)l?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(l,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+r)},(...o)=>{const[r,l]=o;this.incrementIncomingBytes_(o),this.myPacketOrderer.handleResponse(r,l)},()=>{this.onClosed_()},this.urlFn);const i={};i[pr]="t",i[tc]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(i[Vf]=this.scriptTagHolder.uniqueCallbackIdentifier),i[za]=go,this.transportSessionId&&(i[Ua]=this.transportSessionId),this.lastSessionId&&(i[Ya]=this.lastSessionId),this.applicationId&&(i[Qa]=this.applicationId),this.appCheckToken&&(i[Ks]=this.appCheckToken),typeof location<"u"&&location.hostname&&Ka.test(location.hostname)&&(i[Ga]=Va);const s=this.urlFn(i);this.log_("Connecting via long-poll to "+s),this.scriptTagHolder.addTag(s,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Rn.forceAllow_=!0}static forceDisallow(){Rn.forceDisallow_=!0}static isAvailable(){return Rn.forceAllow_?!0:!Rn.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!Of()&&!Df()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=lt(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const i=Ca(t),s=ja(i,Xf);for(let o=0;o<s.length;o++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,s.length,s[o]),this.curSegmentNum++}addDisconnectPingFrame(e,t){this.myDisconnFrame=document.createElement("iframe");const i={};i[Jf]="t",i[$a]=e,i[ec]=t,this.myDisconnFrame.src=this.urlFn(i),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=lt(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class vo{constructor(e,t,i,s){this.onDisconnect=i,this.urlFn=s,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=Ef(),window[Uf+this.uniqueCallbackIdentifier]=e,window[Gf+this.uniqueCallbackIdentifier]=t,this.myIFrame=vo.createIFrame_();let o="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(o='<script>document.domain="'+document.domain+'";<\/script>');const r="<html><body>"+o+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(r),this.myIFrame.doc.close()}catch(l){_t("frame writing exception"),l.stack&&_t(l.stack),_t(l)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||_t("No IE domain setting required")}catch{const i=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+i+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[$a]=this.myID,e[ec]=this.myPW,e[tc]=this.currentSerial;let t=this.urlFn(e),i="",s=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+ic+i.length<=nc;){const r=this.pendingSegs.shift();i=i+"&"+Kf+s+"="+r.seg+"&"+Yf+s+"="+r.ts+"&"+Qf+s+"="+r.d,s++}return t=t+i,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,i){this.pendingSegs.push({seg:e,ts:t,d:i}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const i=()=>{this.outstandingRequests.delete(t),this.newRequest_()},s=setTimeout(i,Math.floor(Zf)),o=()=>{clearTimeout(s),i()};this.addTag(e,o)}addTag(e,t){setTimeout(()=>{try{if(!this.sendNewPolls)return;const i=this.myIFrame.doc.createElement("script");i.type="text/javascript",i.async=!0,i.src=e,i.onload=i.onreadystatechange=function(){const s=i.readyState;(!s||s==="loaded"||s==="complete")&&(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),t())},i.onerror=()=>{_t("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(i)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $f=16384,eh=45e3;let Ui=null;typeof MozWebSocket<"u"?Ui=MozWebSocket:typeof WebSocket<"u"&&(Ui=WebSocket);class Pt{constructor(e,t,i,s,o,r,l){this.connId=e,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Ei(this.connId),this.stats_=bo(t),this.connURL=Pt.connectionURL_(t,r,l,s,i),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,i,s,o){const r={};return r[za]=go,typeof location<"u"&&location.hostname&&Ka.test(location.hostname)&&(r[Ga]=Va),t&&(r[Ua]=t),i&&(r[Ya]=i),s&&(r[Ks]=s),o&&(r[Qa]=o),xa(e,Ja,r)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,_n.set("previous_websocket_failure",!0);try{let i;Na(),this.mySock=new Ui(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");const s=i.message||i.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");const s=i.message||i.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){Pt.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(t);i&&i.length>1&&parseFloat(i[1])<4.4&&(e=!0)}return!e&&Ui!==null&&!Pt.forceDisallow_}static previouslyFailed(){return _n.isInMemoryStorage||_n.get("previous_websocket_failure")===!0}markConnectionHealthy(){_n.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const t=this.frames.join("");this.frames=null;const i=ui(t);this.onMessage(i)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if($(this.frames===null,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(t);else{const i=this.extractFrameCount_(t);i!==null&&this.appendFrame_(i)}}send(e){this.resetKeepAlive();const t=lt(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const i=ja(t,$f);i.length>1&&this.sendString_(String(i.length));for(let s=0;s<i.length;s++)this.sendString_(i[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(eh))}sendString_(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}Pt.responsesRequiredToBeHealthy=2;Pt.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hi{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[Rn,Pt]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const t=Pt&&Pt.isAvailable();let i=t&&!Pt.previouslyFailed();if(e.webSocketOnly&&(t||Et("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[Pt];else{const s=this.transports_=[];for(const o of hi.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);hi.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}hi.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const th=6e4,nh=5e3,ih=10*1024,sh=100*1024,Ds="t",_r="d",oh="s",mr="r",rh="e",gr="o",br="a",vr="n",yr="p",lh="h";class ah{constructor(e,t,i,s,o,r,l,a,c,u){this.id=e,this.repoInfo_=t,this.applicationId_=i,this.appCheckToken_=s,this.authToken_=o,this.onMessage_=r,this.onReady_=l,this.onDisconnect_=a,this.onKill_=c,this.lastSessionId=u,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Ei("c:"+this.id+":"),this.transportManager_=new hi(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),i=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,i)},Math.floor(0));const s=e.healthyTimeout||0;s>0&&(this.healthyTimeout_=oi(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>sh?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>ih?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(s)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(Ds in e){const t=e[Ds];t===br?this.upgradeIfSecondaryHealthy_():t===mr?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===gr&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=ei("t",e),i=ei("d",e);if(t==="c")this.onSecondaryControl_(i);else if(t==="d")this.pendingDataMessages.push(i);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:yr,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:br,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:vr,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=ei("t",e),i=ei("d",e);t==="c"?this.onControl_(i):t==="d"&&this.onDataMessage_(i)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=ei(Ds,e);if(_r in e){const i=e[_r];if(t===lh){const s=Object.assign({},i);this.repoInfo_.isUsingEmulator&&(s.h=this.repoInfo_.host),this.onHandshake_(s)}else if(t===vr){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let s=0;s<this.pendingDataMessages.length;++s)this.onDataMessage_(this.pendingDataMessages[s]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===oh?this.onConnectionShutdown_(i):t===mr?this.onReset_(i):t===rh?Vs("Server Error: "+i):t===gr?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Vs("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,i=e.v,s=e.h;this.sessionId=e.s,this.repoInfo_.host=s,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),go!==i&&Et("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),i=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,i),oi(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(th))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):oi(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(nh))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:yr,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(_n.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sc{put(e,t,i,s){}merge(e,t,i,s){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,i){}onDisconnectMerge(e,t,i){}onDisconnectCancel(e,t){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oc{constructor(e){this.allowedEvents_=e,this.listeners_={},$(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const i=[...this.listeners_[e]];for(let s=0;s<i.length;s++)i[s].callback.apply(i[s].context,t)}}on(e,t,i){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:i});const s=this.getInitialEvent(e);s&&t.apply(i,s)}off(e,t,i){this.validateEventType_(e);const s=this.listeners_[e]||[];for(let o=0;o<s.length;o++)if(s[o].callback===t&&(!i||i===s[o].context)){s.splice(o,1);return}}validateEventType_(e){$(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gi extends oc{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!Ta()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new Gi}getInitialEvent(e){return $(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wr=32,kr=768;class Ue{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let i=0;for(let s=0;s<this.pieces_.length;s++)this.pieces_[s].length>0&&(this.pieces_[i]=this.pieces_[s],i++);this.pieces_.length=i,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}}function Fe(){return new Ue("")}function Se(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function an(n){return n.pieces_.length-n.pieceNum_}function Ke(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new Ue(n.pieces_,e)}function rc(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function ch(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)n.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}function lc(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function ac(n){if(n.pieceNum_>=n.pieces_.length)return null;const e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new Ue(e,0)}function at(n,e){const t=[];for(let i=n.pieceNum_;i<n.pieces_.length;i++)t.push(n.pieces_[i]);if(e instanceof Ue)for(let i=e.pieceNum_;i<e.pieces_.length;i++)t.push(e.pieces_[i]);else{const i=e.split("/");for(let s=0;s<i.length;s++)i[s].length>0&&t.push(i[s])}return new Ue(t,0)}function Ce(n){return n.pieceNum_>=n.pieces_.length}function vt(n,e){const t=Se(n),i=Se(e);if(t===null)return e;if(t===i)return vt(Ke(n),Ke(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function cc(n,e){if(an(n)!==an(e))return!1;for(let t=n.pieceNum_,i=e.pieceNum_;t<=n.pieces_.length;t++,i++)if(n.pieces_[t]!==e.pieces_[i])return!1;return!0}function Mt(n,e){let t=n.pieceNum_,i=e.pieceNum_;if(an(n)>an(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[i])return!1;++t,++i}return!0}class uh{constructor(e,t){this.errorPrefix_=t,this.parts_=lc(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let i=0;i<this.parts_.length;i++)this.byteLength_+=os(this.parts_[i]);uc(this)}}function dh(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=os(e),uc(n)}function fh(n){const e=n.parts_.pop();n.byteLength_-=os(e),n.parts_.length>0&&(n.byteLength_-=1)}function uc(n){if(n.byteLength_>kr)throw new Error(n.errorPrefix_+"has a key path longer than "+kr+" bytes ("+n.byteLength_+").");if(n.parts_.length>wr)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+wr+") or object contains a cycle "+hn(n))}function hn(n){return n.parts_.length===0?"":"in property '"+n.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yo extends oc{constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const i=!document[e];i!==this.visible_&&(this.visible_=i,this.trigger("visible",i))},!1)}static getInstance(){return new yo}getInitialEvent(e){return $(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ti=1e3,hh=60*5*1e3,Cr=30*1e3,ph=1.3,_h=3e4,mh="server_kill",Er=3;class Yt extends sc{constructor(e,t,i,s,o,r,l,a){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=i,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=r,this.appCheckTokenProvider_=l,this.authOverride_=a,this.id=Yt.nextPersistentConnectionId_++,this.log_=Ei("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=ti,this.maxReconnectDelay_=hh,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,a&&!Na())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");yo.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&Gi.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,i){const s=++this.requestNumber_,o={r:s,a:e,b:t};this.log_(lt(o)),$(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),i&&(this.requestCBHash_[s]=i)}get(e){this.initConnection_();const t=new ss,s={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:r=>{const l=r.d;r.s==="ok"?t.resolve(l):t.reject(l)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;const o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),t.promise}listen(e,t,i,s){this.initConnection_();const o=e._queryIdentifier,r=e._path.toString();this.log_("Listen called for "+r+" "+o),this.listens.has(r)||this.listens.set(r,new Map),$(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),$(!this.listens.get(r).has(o),"listen() called twice for same path/queryId.");const l={onComplete:s,hashFn:t,query:e,tag:i};this.listens.get(r).set(o,l),this.connected_&&this.sendListen_(l)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,i=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(i)})}sendListen_(e){const t=e.query,i=t._path.toString(),s=t._queryIdentifier;this.log_("Listen on "+i+" for "+s);const o={p:i},r="q";e.tag&&(o.q=t._queryObject,o.t=e.tag),o.h=e.hashFn(),this.sendRequest(r,o,l=>{const a=l.d,c=l.s;Yt.warnOnListenWarnings_(a,t),(this.listens.get(i)&&this.listens.get(i).get(s))===e&&(this.log_("listen response",l),c!=="ok"&&this.removeListen_(i,s),e.onComplete&&e.onComplete(c,a))})}static warnOnListenWarnings_(e,t){if(e&&typeof e=="object"&&Vt(e,"w")){const i=jn(e,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){const s='".indexOn": "'+t._queryParams.getIndex().toString()+'"',o=t._path.toString();Et(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||rd(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=Cr)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=od(e)?"auth":"gauth",i={cred:e};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(t,i,s=>{const o=s.s,r=s.d||"error";this.authToken_===e&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,r))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const t=e.s,i=e.d||"error";t==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,i)})}unlisten(e,t){const i=e._path.toString(),s=e._queryIdentifier;this.log_("Unlisten called for "+i+" "+s),$(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,s)&&this.connected_&&this.sendUnlisten_(i,s,e._queryObject,t)}sendUnlisten_(e,t,i,s){this.log_("Unlisten on "+e+" for "+t);const o={p:e},r="n";s&&(o.q=i,o.t=s),this.sendRequest(r,o)}onDisconnectPut(e,t,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,i):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:i})}onDisconnectMerge(e,t,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,i):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:i})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,i,s){const o={p:t,d:i};this.log_("onDisconnect "+e,o),this.sendRequest(e,o,r=>{s&&setTimeout(()=>{s(r.s,r.d)},Math.floor(0))})}put(e,t,i,s){this.putInternal("p",e,t,i,s)}merge(e,t,i,s){this.putInternal("m",e,t,i,s)}putInternal(e,t,i,s,o){this.initConnection_();const r={p:t,d:i};o!==void 0&&(r.h=o),this.outstandingPuts_.push({action:e,request:r,onComplete:s}),this.outstandingPutCount_++;const l=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(l):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,i=this.outstandingPuts_[e].request,s=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,i,o=>{this.log_(t+" response",o),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,i=>{if(i.s!=="ok"){const o=i.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+lt(e));const t=e.r,i=this.requestCBHash_[t];i&&(delete this.requestCBHash_[t],i(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),e==="d"?this.onDataUpdate_(t.p,t.d,!1,t.t):e==="m"?this.onDataUpdate_(t.p,t.d,!0,t.t):e==="c"?this.onListenRevoked_(t.p,t.q):e==="ac"?this.onAuthRevoked_(t.s,t.d):e==="apc"?this.onAppCheckRevoked_(t.s,t.d):e==="sd"?this.onSecurityDebugPacket_(t):Vs("Unrecognized action received from server: "+lt(e)+`
Are you using the latest client?`)}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){$(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=ti,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=ti,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>_h&&(this.reconnectDelay_=ti),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=new Date().getTime()-this.lastConnectionAttemptTime_;let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*ph)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+Yt.nextConnectionId_++,o=this.lastSessionId;let r=!1,l=null;const a=function(){l?l.close():(r=!0,i())},c=function(d){$(l,"sendRequest call when we're not connected not allowed."),l.sendRequest(d)};this.realtime_={close:a,sendRequest:c};const u=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[d,f]=await Promise.all([this.authTokenProvider_.getToken(u),this.appCheckTokenProvider_.getToken(u)]);r?_t("getToken() completed but was canceled"):(_t("getToken() completed. Creating connection."),this.authToken_=d&&d.accessToken,this.appCheckToken_=f&&f.token,l=new ah(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,i,h=>{Et(h+" ("+this.repoInfo_.toString()+")"),this.interrupt(mh)},o))}catch(d){this.log_("Failed to get token: "+d),r||(this.repoInfo_.nodeAdmin&&Et(d),a())}}}interrupt(e){_t("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){_t("Resuming connection for reason: "+e),delete this.interruptReasons_[e],tr(this.interruptReasons_)&&(this.reconnectDelay_=ti,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let i;t?i=t.map(o=>mo(o)).join("$"):i="default";const s=this.removeListen_(e,i);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(e,t){const i=new Ue(e).toString();let s;if(this.listens.has(i)){const o=this.listens.get(i);s=o.get(t),o.delete(t),o.size===0&&this.listens.delete(i)}else s=void 0;return s}onAuthRevoked_(e,t){_t("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=Er&&(this.reconnectDelay_=Cr,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){_t("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=Er&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let t="js";e["sdk."+t+"."+Ba.replace(/\./g,"-")]=1,Ta()?e["framework.cordova"]=1:$u()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=Gi.getInstance().currentlyOnline();return tr(this.interruptReasons_)&&e}}Yt.nextPersistentConnectionId_=0;Yt.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ke{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new ke(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rs{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const i=new ke(kn,e),s=new ke(kn,t);return this.compare(i,s)!==0}minPost(){return ke.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ri;class dc extends rs{static get __EMPTY_NODE(){return Ri}static set __EMPTY_NODE(e){Ri=e}compare(e,t){return Qn(e.name,t.name)}isDefinedOn(e){throw Yn("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return ke.MIN}maxPost(){return new ke(ln,Ri)}makePost(e,t){return $(typeof e=="string","KeyIndex indexValue must always be a string."),new ke(e,Ri)}toString(){return".key"}}const tn=new dc;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ai{constructor(e,t,i,s,o=null){this.isReverse_=s,this.resultGenerator_=o,this.nodeStack_=[];let r=1;for(;!e.isEmpty();)if(e=e,r=t?i(e.key,t):1,s&&(r*=-1),r<0)this.isReverse_?e=e.left:e=e.right;else if(r===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class ut{constructor(e,t,i,s,o){this.key=e,this.value=t,this.color=i??ut.RED,this.left=s??Ct.EMPTY_NODE,this.right=o??Ct.EMPTY_NODE}copy(e,t,i,s,o){return new ut(e??this.key,t??this.value,i??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let s=this;const o=i(e,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(e,t,i),null):o===0?s=s.copy(null,t,null,null,null):s=s.copy(null,null,null,null,s.right.insert(e,t,i)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return Ct.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let i,s;if(i=this,t(e,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),t(e,i.key)===0){if(i.right.isEmpty())return Ct.EMPTY_NODE;s=i.right.min_(),i=i.copy(s.key,s.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,ut.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,ut.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}ut.RED=!0;ut.BLACK=!1;class gh{copy(e,t,i,s,o){return this}insert(e,t,i){return new ut(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class Ct{constructor(e,t=Ct.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new Ct(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,ut.BLACK,null,null))}remove(e){return new Ct(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,ut.BLACK,null,null))}get(e){let t,i=this.root_;for(;!i.isEmpty();){if(t=this.comparator_(e,i.key),t===0)return i.value;t<0?i=i.left:t>0&&(i=i.right)}return null}getPredecessorKey(e){let t,i=this.root_,s=null;for(;!i.isEmpty();)if(t=this.comparator_(e,i.key),t===0){if(i.left.isEmpty())return s?s.key:null;for(i=i.left;!i.right.isEmpty();)i=i.right;return i.key}else t<0?i=i.left:t>0&&(s=i,i=i.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Ai(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Ai(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Ai(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Ai(this.root_,null,this.comparator_,!0,e)}}Ct.EMPTY_NODE=new gh;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bh(n,e){return Qn(n.name,e.name)}function wo(n,e){return Qn(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ys;function vh(n){Ys=n}const fc=function(n){return typeof n=="number"?"number:"+Ha(n):"string:"+n},hc=function(n){if(n.isLeafNode()){const e=n.val();$(typeof e=="string"||typeof e=="number"||typeof e=="object"&&Vt(e,".sv"),"Priority must be a string or number.")}else $(n===Ys||n.isEmpty(),"priority of unexpected type.");$(n===Ys||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Sr;class ct{constructor(e,t=ct.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,$(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),hc(this.priorityNode_)}static set __childrenNodeConstructor(e){Sr=e}static get __childrenNodeConstructor(){return Sr}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new ct(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:ct.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return Ce(e)?this:Se(e)===".priority"?this.priorityNode_:ct.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return e===".priority"?this.updatePriority(t):t.isEmpty()&&e!==".priority"?this:ct.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const i=Se(e);return i===null?t:t.isEmpty()&&i!==".priority"?this:($(i!==".priority"||an(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,ct.__childrenNodeConstructor.EMPTY_NODE.updateChild(Ke(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+fc(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",t==="number"?e+=Ha(this.value_):e+=this.value_,this.lazyHash_=Wa(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===ct.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof ct.__childrenNodeConstructor?-1:($(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,i=typeof this.value_,s=ct.VALUE_TYPE_ORDER.indexOf(t),o=ct.VALUE_TYPE_ORDER.indexOf(i);return $(s>=0,"Unknown leaf type: "+t),$(o>=0,"Unknown leaf type: "+i),s===o?i==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}else return!1}}ct.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let pc,_c;function yh(n){pc=n}function wh(n){_c=n}class kh extends rs{compare(e,t){const i=e.node.getPriority(),s=t.node.getPriority(),o=i.compareTo(s);return o===0?Qn(e.name,t.name):o}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return ke.MIN}maxPost(){return new ke(ln,new ct("[PRIORITY-POST]",_c))}makePost(e,t){const i=pc(e);return new ke(t,new ct("[PRIORITY-POST]",i))}toString(){return".priority"}}const xe=new kh;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ch=Math.log(2);class Eh{constructor(e){const t=o=>parseInt(Math.log(o)/Ch,10),i=o=>parseInt(Array(o+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;const s=i(this.count);this.bits_=e+1&s}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const Vi=function(n,e,t,i){n.sort(e);const s=function(a,c){const u=c-a;let d,f;if(u===0)return null;if(u===1)return d=n[a],f=t?t(d):d,new ut(f,d.node,ut.BLACK,null,null);{const h=parseInt(u/2,10)+a,_=s(a,h),b=s(h+1,c);return d=n[h],f=t?t(d):d,new ut(f,d.node,ut.BLACK,_,b)}},o=function(a){let c=null,u=null,d=n.length;const f=function(_,b){const v=d-_,y=d;d-=_;const k=s(v+1,y),w=n[v],I=t?t(w):w;h(new ut(I,w.node,b,null,k))},h=function(_){c?(c.left=_,c=_):(u=_,c=_)};for(let _=0;_<a.count;++_){const b=a.nextBitIsOne(),v=Math.pow(2,a.count-(_+1));b?f(v,ut.BLACK):(f(v,ut.BLACK),f(v,ut.RED))}return u},r=new Eh(n.length),l=o(r);return new Ct(i||e,l)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Rs;const On={};class Kt{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return $(On&&xe,"ChildrenNode.ts has not been loaded"),Rs=Rs||new Kt({".priority":On},{".priority":xe}),Rs}get(e){const t=jn(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof Ct?t:null}hasIndex(e){return Vt(this.indexSet_,e.toString())}addIndex(e,t){$(e!==tn,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const i=[];let s=!1;const o=t.getIterator(ke.Wrap);let r=o.getNext();for(;r;)s=s||e.isDefinedOn(r.node),i.push(r),r=o.getNext();let l;s?l=Vi(i,e.getCompare()):l=On;const a=e.toString(),c=Object.assign({},this.indexSet_);c[a]=e;const u=Object.assign({},this.indexes_);return u[a]=l,new Kt(u,c)}addToIndexes(e,t){const i=ji(this.indexes_,(s,o)=>{const r=jn(this.indexSet_,o);if($(r,"Missing index implementation for "+o),s===On)if(r.isDefinedOn(e.node)){const l=[],a=t.getIterator(ke.Wrap);let c=a.getNext();for(;c;)c.name!==e.name&&l.push(c),c=a.getNext();return l.push(e),Vi(l,r.getCompare())}else return On;else{const l=t.get(e.name);let a=s;return l&&(a=a.remove(new ke(e.name,l))),a.insert(e,e.node)}});return new Kt(i,this.indexSet_)}removeFromIndexes(e,t){const i=ji(this.indexes_,s=>{if(s===On)return s;{const o=t.get(e.name);return o?s.remove(new ke(e.name,o)):s}});return new Kt(i,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ni;class pe{constructor(e,t,i){this.children_=e,this.priorityNode_=t,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&hc(this.priorityNode_),this.children_.isEmpty()&&$(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return ni||(ni=new pe(new Ct(wo),null,Kt.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||ni}updatePriority(e){return this.children_.isEmpty()?this:new pe(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const t=this.children_.get(e);return t===null?ni:t}}getChild(e){const t=Se(e);return t===null?this:this.getImmediateChild(t).getChild(Ke(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,t){if($(t,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(t);{const i=new ke(e,t);let s,o;t.isEmpty()?(s=this.children_.remove(e),o=this.indexMap_.removeFromIndexes(i,this.children_)):(s=this.children_.insert(e,t),o=this.indexMap_.addToIndexes(i,this.children_));const r=s.isEmpty()?ni:this.priorityNode_;return new pe(s,r,o)}}updateChild(e,t){const i=Se(e);if(i===null)return t;{$(Se(e)!==".priority"||an(e)===1,".priority must be the last token in a path");const s=this.getImmediateChild(i).updateChild(Ke(e),t);return this.updateImmediateChild(i,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let i=0,s=0,o=!0;if(this.forEachChild(xe,(r,l)=>{t[r]=l.val(e),i++,o&&pe.INTEGER_REGEXP_.test(r)?s=Math.max(s,Number(r)):o=!1}),!e&&o&&s<2*i){const r=[];for(const l in t)r[l]=t[l];return r}else return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+fc(this.getPriority().val())+":"),this.forEachChild(xe,(t,i)=>{const s=i.hash();s!==""&&(e+=":"+t+":"+s)}),this.lazyHash_=e===""?"":Wa(e)}return this.lazyHash_}getPredecessorChildName(e,t,i){const s=this.resolveIndex_(i);if(s){const o=s.getPredecessorKey(new ke(e,t));return o?o.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const i=t.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new ke(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const i=t.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new ke(t,this.children_.get(t)):null}forEachChild(e,t){const i=this.resolveIndex_(e);return i?i.inorderTraversal(s=>t(s.name,s.node)):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const i=this.resolveIndex_(t);if(i)return i.getIteratorFrom(e,s=>s);{const s=this.children_.getIteratorFrom(e.name,ke.Wrap);let o=s.peek();for(;o!=null&&t.compare(o,e)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const i=this.resolveIndex_(t);if(i)return i.getReverseIteratorFrom(e,s=>s);{const s=this.children_.getReverseIteratorFrom(e.name,ke.Wrap);let o=s.peek();for(;o!=null&&t.compare(o,e)>0;)s.getNext(),o=s.peek();return s}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Si?-1:0}withIndex(e){if(e===tn||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new pe(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===tn||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority()))if(this.children_.count()===t.children_.count()){const i=this.getIterator(xe),s=t.getIterator(xe);let o=i.getNext(),r=s.getNext();for(;o&&r;){if(o.name!==r.name||!o.node.equals(r.node))return!1;o=i.getNext(),r=s.getNext()}return o===null&&r===null}else return!1;else return!1}}resolveIndex_(e){return e===tn?null:this.indexMap_.get(e.toString())}}pe.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class Sh extends pe{constructor(){super(new Ct(wo),pe.EMPTY_NODE,Kt.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return pe.EMPTY_NODE}isEmpty(){return!1}}const Si=new Sh;Object.defineProperties(ke,{MIN:{value:new ke(kn,pe.EMPTY_NODE)},MAX:{value:new ke(ln,Si)}});dc.__EMPTY_NODE=pe.EMPTY_NODE;ct.__childrenNodeConstructor=pe;vh(Si);wh(Si);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ih=!0;function dt(n,e=null){if(n===null)return pe.EMPTY_NODE;if(typeof n=="object"&&".priority"in n&&(e=n[".priority"]),$(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof n=="object"&&".value"in n&&n[".value"]!==null&&(n=n[".value"]),typeof n!="object"||".sv"in n){const t=n;return new ct(t,dt(e))}if(!(n instanceof Array)&&Ih){const t=[];let i=!1;if(St(n,(r,l)=>{if(r.substring(0,1)!=="."){const a=dt(l);a.isEmpty()||(i=i||!a.getPriority().isEmpty(),t.push(new ke(r,a)))}}),t.length===0)return pe.EMPTY_NODE;const o=Vi(t,bh,r=>r.name,wo);if(i){const r=Vi(t,xe.getCompare());return new pe(o,dt(e),new Kt({".priority":r},{".priority":xe}))}else return new pe(o,dt(e),Kt.Default)}else{let t=pe.EMPTY_NODE;return St(n,(i,s)=>{if(Vt(n,i)&&i.substring(0,1)!=="."){const o=dt(s);(o.isLeafNode()||!o.isEmpty())&&(t=t.updateImmediateChild(i,o))}}),t.updatePriority(dt(e))}}yh(dt);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mc extends rs{constructor(e){super(),this.indexPath_=e,$(!Ce(e)&&Se(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const i=this.extractChild(e.node),s=this.extractChild(t.node),o=i.compareTo(s);return o===0?Qn(e.name,t.name):o}makePost(e,t){const i=dt(e),s=pe.EMPTY_NODE.updateChild(this.indexPath_,i);return new ke(t,s)}maxPost(){const e=pe.EMPTY_NODE.updateChild(this.indexPath_,Si);return new ke(ln,e)}toString(){return lc(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Th extends rs{compare(e,t){const i=e.node.compareTo(t.node);return i===0?Qn(e.name,t.name):i}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return ke.MIN}maxPost(){return ke.MAX}makePost(e,t){const i=dt(e);return new ke(t,i)}toString(){return".value"}}const gc=new Th;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bc(n){return{type:"value",snapshotNode:n}}function Hn(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function pi(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function _i(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}function Nh(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ko{constructor(e){this.index_=e}updateChild(e,t,i,s,o,r){$(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const l=e.getImmediateChild(t);return l.getChild(s).equals(i.getChild(s))&&l.isEmpty()===i.isEmpty()||(r!=null&&(i.isEmpty()?e.hasChild(t)?r.trackChildChange(pi(t,l)):$(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):l.isEmpty()?r.trackChildChange(Hn(t,i)):r.trackChildChange(_i(t,i,l))),e.isLeafNode()&&i.isEmpty())?e:e.updateImmediateChild(t,i).withIndex(this.index_)}updateFullNode(e,t,i){return i!=null&&(e.isLeafNode()||e.forEachChild(xe,(s,o)=>{t.hasChild(s)||i.trackChildChange(pi(s,o))}),t.isLeafNode()||t.forEachChild(xe,(s,o)=>{if(e.hasChild(s)){const r=e.getImmediateChild(s);r.equals(o)||i.trackChildChange(_i(s,o,r))}else i.trackChildChange(Hn(s,o))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?pe.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mi{constructor(e){this.indexedFilter_=new ko(e.getIndex()),this.index_=e.getIndex(),this.startPost_=mi.getStartPost_(e),this.endPost_=mi.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,i=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&i}updateChild(e,t,i,s,o,r){return this.matches(new ke(t,i))||(i=pe.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,i,s,o,r)}updateFullNode(e,t,i){t.isLeafNode()&&(t=pe.EMPTY_NODE);let s=t.withIndex(this.index_);s=s.updatePriority(pe.EMPTY_NODE);const o=this;return t.forEachChild(xe,(r,l)=>{o.matches(new ke(r,l))||(s=s.updateImmediateChild(r,pe.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,s,i)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oh{constructor(e){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{const i=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?i<=0:i<0},this.withinEndPost=t=>{const i=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?i<=0:i<0},this.rangedFilter_=new mi(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,i,s,o,r){return this.rangedFilter_.matches(new ke(t,i))||(i=pe.EMPTY_NODE),e.getImmediateChild(t).equals(i)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,i,s,o,r):this.fullLimitUpdateChild_(e,t,i,o,r)}updateFullNode(e,t,i){let s;if(t.isLeafNode()||t.isEmpty())s=pe.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<t.numChildren()&&t.isIndexed(this.index_)){s=pe.EMPTY_NODE.withIndex(this.index_);let o;this.reverse_?o=t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):o=t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let r=0;for(;o.hasNext()&&r<this.limit_;){const l=o.getNext();if(this.withinDirectionalStart(l))if(this.withinDirectionalEnd(l))s=s.updateImmediateChild(l.name,l.node),r++;else break;else continue}}else{s=t.withIndex(this.index_),s=s.updatePriority(pe.EMPTY_NODE);let o;this.reverse_?o=s.getReverseIterator(this.index_):o=s.getIterator(this.index_);let r=0;for(;o.hasNext();){const l=o.getNext();r<this.limit_&&this.withinDirectionalStart(l)&&this.withinDirectionalEnd(l)?r++:s=s.updateImmediateChild(l.name,pe.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,s,i)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,i,s,o){let r;if(this.reverse_){const d=this.index_.getCompare();r=(f,h)=>d(h,f)}else r=this.index_.getCompare();const l=e;$(l.numChildren()===this.limit_,"");const a=new ke(t,i),c=this.reverse_?l.getFirstChild(this.index_):l.getLastChild(this.index_),u=this.rangedFilter_.matches(a);if(l.hasChild(t)){const d=l.getImmediateChild(t);let f=s.getChildAfterChild(this.index_,c,this.reverse_);for(;f!=null&&(f.name===t||l.hasChild(f.name));)f=s.getChildAfterChild(this.index_,f,this.reverse_);const h=f==null?1:r(f,a);if(u&&!i.isEmpty()&&h>=0)return o!=null&&o.trackChildChange(_i(t,i,d)),l.updateImmediateChild(t,i);{o!=null&&o.trackChildChange(pi(t,d));const b=l.updateImmediateChild(t,pe.EMPTY_NODE);return f!=null&&this.rangedFilter_.matches(f)?(o!=null&&o.trackChildChange(Hn(f.name,f.node)),b.updateImmediateChild(f.name,f.node)):b}}else return i.isEmpty()?e:u&&r(c,a)>=0?(o!=null&&(o.trackChildChange(pi(c.name,c.node)),o.trackChildChange(Hn(t,i))),l.updateImmediateChild(t,i).updateImmediateChild(c.name,pe.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Co{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=xe}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return $(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return $(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:kn}hasEnd(){return this.endSet_}getIndexEndValue(){return $(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return $(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:ln}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return $(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===xe}copy(){const e=new Co;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function Dh(n){return n.loadsAllData()?new ko(n.getIndex()):n.hasLimit()?new Oh(n):new mi(n)}function Rh(n,e){const t=n.copy();return t.index_=e,t}function Ir(n){const e={};if(n.isDefault())return e;let t;if(n.index_===xe?t="$priority":n.index_===gc?t="$value":n.index_===tn?t="$key":($(n.index_ instanceof mc,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=lt(t),n.startSet_){const i=n.startAfterSet_?"startAfter":"startAt";e[i]=lt(n.indexStartValue_),n.startNameSet_&&(e[i]+=","+lt(n.indexStartName_))}if(n.endSet_){const i=n.endBeforeSet_?"endBefore":"endAt";e[i]=lt(n.indexEndValue_),n.endNameSet_&&(e[i]+=","+lt(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function Tr(n){const e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;t===""&&(n.isViewFromLeft()?t="l":t="r"),e.vf=t}return n.index_!==xe&&(e.i=n.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ki extends sc{constructor(e,t,i,s){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=i,this.appCheckTokenProvider_=s,this.log_=Ei("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:($(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,i,s){const o=e._path.toString();this.log_("Listen called for "+o+" "+e._queryIdentifier);const r=Ki.getListenId_(e,i),l={};this.listens_[r]=l;const a=Ir(e._queryParams);this.restRequest_(o+".json",a,(c,u)=>{let d=u;if(c===404&&(d=null,c=null),c===null&&this.onDataUpdate_(o,d,!1,i),jn(this.listens_,r)===l){let f;c?c===401?f="permission_denied":f="rest_error:"+c:f="ok",s(f,null)}})}unlisten(e,t){const i=Ki.getListenId_(e,t);delete this.listens_[i]}get(e){const t=Ir(e._queryParams),i=e._path.toString(),s=new ss;return this.restRequest_(i+".json",t,(o,r)=>{let l=r;o===404&&(l=null,o=null),o===null?(this.onDataUpdate_(i,l,!1,null),s.resolve(l)):s.reject(new Error(l))}),s.promise}refreshAuthToken(e){}restRequest_(e,t={},i){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([s,o])=>{s&&s.accessToken&&(t.auth=s.accessToken),o&&o.token&&(t.ac=o.token);const r=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+ld(t);this.log_("Sending REST request for "+r);const l=new XMLHttpRequest;l.onreadystatechange=()=>{if(i&&l.readyState===4){this.log_("REST Response for "+r+" received. status:",l.status,"response:",l.responseText);let a=null;if(l.status>=200&&l.status<300){try{a=ui(l.responseText)}catch{Et("Failed to parse JSON response for "+r+": "+l.responseText)}i(null,a)}else l.status!==401&&l.status!==404&&Et("Got unsuccessful REST response for "+r+" Status: "+l.status),i(l.status);i=null}},l.open("GET",r,!0),l.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ah{constructor(){this.rootNode_=pe.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yi(){return{value:null,children:new Map}}function vc(n,e,t){if(Ce(e))n.value=t,n.children.clear();else if(n.value!==null)n.value=n.value.updateChild(e,t);else{const i=Se(e);n.children.has(i)||n.children.set(i,Yi());const s=n.children.get(i);e=Ke(e),vc(s,e,t)}}function Qs(n,e,t){n.value!==null?t(e,n.value):Ph(n,(i,s)=>{const o=new Ue(e.toString()+"/"+i);Qs(s,o,t)})}function Ph(n,e){n.children.forEach((t,i)=>{e(i,t)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mh{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&St(this.last_,(i,s)=>{t[i]=t[i]-s}),this.last_=e,t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nr=10*1e3,Lh=30*1e3,Fh=5*60*1e3;class Bh{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new Mh(e);const i=Nr+(Lh-Nr)*Math.random();oi(this.reportStats_.bind(this),Math.floor(i))}reportStats_(){const e=this.statsListener_.get(),t={};let i=!1;St(e,(s,o)=>{o>0&&Vt(this.statsToReport_,s)&&(t[s]=o,i=!0)}),i&&this.server_.reportStats(t),oi(this.reportStats_.bind(this),Math.floor(Math.random()*2*Fh))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Lt;(function(n){n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(Lt||(Lt={}));function yc(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function Eo(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function So(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qi{constructor(e,t,i){this.path=e,this.affectedTree=t,this.revert=i,this.type=Lt.ACK_USER_WRITE,this.source=yc()}operationForChild(e){if(Ce(this.path)){if(this.affectedTree.value!=null)return $(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new Ue(e));return new Qi(Fe(),t,this.revert)}}else return $(Se(this.path)===e,"operationForChild called for unrelated child."),new Qi(Ke(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gi{constructor(e,t){this.source=e,this.path=t,this.type=Lt.LISTEN_COMPLETE}operationForChild(e){return Ce(this.path)?new gi(this.source,Fe()):new gi(this.source,Ke(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cn{constructor(e,t,i){this.source=e,this.path=t,this.snap=i,this.type=Lt.OVERWRITE}operationForChild(e){return Ce(this.path)?new Cn(this.source,Fe(),this.snap.getImmediateChild(e)):new Cn(this.source,Ke(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bi{constructor(e,t,i){this.source=e,this.path=t,this.children=i,this.type=Lt.MERGE}operationForChild(e){if(Ce(this.path)){const t=this.children.subtree(new Ue(e));return t.isEmpty()?null:t.value?new Cn(this.source,Fe(),t.value):new bi(this.source,Fe(),t)}else return $(Se(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new bi(this.source,Ke(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cn{constructor(e,t,i){this.node_=e,this.fullyInitialized_=t,this.filtered_=i}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(Ce(e))return this.isFullyInitialized()&&!this.filtered_;const t=Se(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qh{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function Wh(n,e,t,i){const s=[],o=[];return e.forEach(r=>{r.type==="child_changed"&&n.index_.indexedValueChanged(r.oldSnap,r.snapshotNode)&&o.push(Nh(r.childName,r.snapshotNode))}),ii(n,s,"child_removed",e,i,t),ii(n,s,"child_added",e,i,t),ii(n,s,"child_moved",o,i,t),ii(n,s,"child_changed",e,i,t),ii(n,s,"value",e,i,t),s}function ii(n,e,t,i,s,o){const r=i.filter(l=>l.type===t);r.sort((l,a)=>Hh(n,l,a)),r.forEach(l=>{const a=jh(n,l,o);s.forEach(c=>{c.respondsTo(l.type)&&e.push(c.createEvent(a,n.query_))})})}function jh(n,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}function Hh(n,e,t){if(e.childName==null||t.childName==null)throw Yn("Should only compare child_ events.");const i=new ke(e.childName,e.snapshotNode),s=new ke(t.childName,t.snapshotNode);return n.index_.compare(i,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ls(n,e){return{eventCache:n,serverCache:e}}function ri(n,e,t,i){return ls(new cn(e,t,i),n.serverCache)}function wc(n,e,t,i){return ls(n.eventCache,new cn(e,t,i))}function Ji(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function En(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let As;const zh=()=>(As||(As=new Ct(Nf)),As);class Je{constructor(e,t=zh()){this.value=e,this.children=t}static fromObject(e){let t=new Je(null);return St(e,(i,s)=>{t=t.set(new Ue(i),s)}),t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:Fe(),value:this.value};if(Ce(e))return null;{const i=Se(e),s=this.children.get(i);if(s!==null){const o=s.findRootMostMatchingPathAndValue(Ke(e),t);return o!=null?{path:at(new Ue(i),o.path),value:o.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(Ce(e))return this;{const t=Se(e),i=this.children.get(t);return i!==null?i.subtree(Ke(e)):new Je(null)}}set(e,t){if(Ce(e))return new Je(t,this.children);{const i=Se(e),o=(this.children.get(i)||new Je(null)).set(Ke(e),t),r=this.children.insert(i,o);return new Je(this.value,r)}}remove(e){if(Ce(e))return this.children.isEmpty()?new Je(null):new Je(null,this.children);{const t=Se(e),i=this.children.get(t);if(i){const s=i.remove(Ke(e));let o;return s.isEmpty()?o=this.children.remove(t):o=this.children.insert(t,s),this.value===null&&o.isEmpty()?new Je(null):new Je(this.value,o)}else return this}}get(e){if(Ce(e))return this.value;{const t=Se(e),i=this.children.get(t);return i?i.get(Ke(e)):null}}setTree(e,t){if(Ce(e))return t;{const i=Se(e),o=(this.children.get(i)||new Je(null)).setTree(Ke(e),t);let r;return o.isEmpty()?r=this.children.remove(i):r=this.children.insert(i,o),new Je(this.value,r)}}fold(e){return this.fold_(Fe(),e)}fold_(e,t){const i={};return this.children.inorderTraversal((s,o)=>{i[s]=o.fold_(at(e,s),t)}),t(e,this.value,i)}findOnPath(e,t){return this.findOnPath_(e,Fe(),t)}findOnPath_(e,t,i){const s=this.value?i(t,this.value):!1;if(s)return s;if(Ce(e))return null;{const o=Se(e),r=this.children.get(o);return r?r.findOnPath_(Ke(e),at(t,o),i):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,Fe(),t)}foreachOnPath_(e,t,i){if(Ce(e))return this;{this.value&&i(t,this.value);const s=Se(e),o=this.children.get(s);return o?o.foreachOnPath_(Ke(e),at(t,s),i):new Je(null)}}foreach(e){this.foreach_(Fe(),e)}foreach_(e,t){this.children.inorderTraversal((i,s)=>{s.foreach_(at(e,i),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,i)=>{i.value&&e(t,i.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ft{constructor(e){this.writeTree_=e}static empty(){return new Ft(new Je(null))}}function li(n,e,t){if(Ce(e))return new Ft(new Je(t));{const i=n.writeTree_.findRootMostValueAndPath(e);if(i!=null){const s=i.path;let o=i.value;const r=vt(s,e);return o=o.updateChild(r,t),new Ft(n.writeTree_.set(s,o))}else{const s=new Je(t),o=n.writeTree_.setTree(e,s);return new Ft(o)}}}function Or(n,e,t){let i=n;return St(t,(s,o)=>{i=li(i,at(e,s),o)}),i}function Dr(n,e){if(Ce(e))return Ft.empty();{const t=n.writeTree_.setTree(e,new Je(null));return new Ft(t)}}function Js(n,e){return In(n,e)!=null}function In(n,e){const t=n.writeTree_.findRootMostValueAndPath(e);return t!=null?n.writeTree_.get(t.path).getChild(vt(t.path,e)):null}function Rr(n){const e=[],t=n.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(xe,(i,s)=>{e.push(new ke(i,s))}):n.writeTree_.children.inorderTraversal((i,s)=>{s.value!=null&&e.push(new ke(i,s.value))}),e}function nn(n,e){if(Ce(e))return n;{const t=In(n,e);return t!=null?new Ft(new Je(t)):new Ft(n.writeTree_.subtree(e))}}function Xs(n){return n.writeTree_.isEmpty()}function zn(n,e){return kc(Fe(),n.writeTree_,e)}function kc(n,e,t){if(e.value!=null)return t.updateChild(n,e.value);{let i=null;return e.children.inorderTraversal((s,o)=>{s===".priority"?($(o.value!==null,"Priority writes must always be leaf nodes"),i=o.value):t=kc(at(n,s),o,t)}),!t.getChild(n).isEmpty()&&i!==null&&(t=t.updateChild(at(n,".priority"),i)),t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function as(n,e){return Ic(e,n)}function Uh(n,e,t,i,s){$(i>n.lastWriteId,"Stacking an older write on top of newer ones"),s===void 0&&(s=!0),n.allWrites.push({path:e,snap:t,writeId:i,visible:s}),s&&(n.visibleWrites=li(n.visibleWrites,e,t)),n.lastWriteId=i}function Gh(n,e){for(let t=0;t<n.allWrites.length;t++){const i=n.allWrites[t];if(i.writeId===e)return i}return null}function Vh(n,e){const t=n.allWrites.findIndex(l=>l.writeId===e);$(t>=0,"removeWrite called with nonexistent writeId.");const i=n.allWrites[t];n.allWrites.splice(t,1);let s=i.visible,o=!1,r=n.allWrites.length-1;for(;s&&r>=0;){const l=n.allWrites[r];l.visible&&(r>=t&&Kh(l,i.path)?s=!1:Mt(i.path,l.path)&&(o=!0)),r--}if(s){if(o)return Yh(n),!0;if(i.snap)n.visibleWrites=Dr(n.visibleWrites,i.path);else{const l=i.children;St(l,a=>{n.visibleWrites=Dr(n.visibleWrites,at(i.path,a))})}return!0}else return!1}function Kh(n,e){if(n.snap)return Mt(n.path,e);for(const t in n.children)if(n.children.hasOwnProperty(t)&&Mt(at(n.path,t),e))return!0;return!1}function Yh(n){n.visibleWrites=Cc(n.allWrites,Qh,Fe()),n.allWrites.length>0?n.lastWriteId=n.allWrites[n.allWrites.length-1].writeId:n.lastWriteId=-1}function Qh(n){return n.visible}function Cc(n,e,t){let i=Ft.empty();for(let s=0;s<n.length;++s){const o=n[s];if(e(o)){const r=o.path;let l;if(o.snap)Mt(t,r)?(l=vt(t,r),i=li(i,l,o.snap)):Mt(r,t)&&(l=vt(r,t),i=li(i,Fe(),o.snap.getChild(l)));else if(o.children){if(Mt(t,r))l=vt(t,r),i=Or(i,l,o.children);else if(Mt(r,t))if(l=vt(r,t),Ce(l))i=Or(i,Fe(),o.children);else{const a=jn(o.children,Se(l));if(a){const c=a.getChild(Ke(l));i=li(i,Fe(),c)}}}else throw Yn("WriteRecord should have .snap or .children")}}return i}function Ec(n,e,t,i,s){if(!i&&!s){const o=In(n.visibleWrites,e);if(o!=null)return o;{const r=nn(n.visibleWrites,e);if(Xs(r))return t;if(t==null&&!Js(r,Fe()))return null;{const l=t||pe.EMPTY_NODE;return zn(r,l)}}}else{const o=nn(n.visibleWrites,e);if(!s&&Xs(o))return t;if(!s&&t==null&&!Js(o,Fe()))return null;{const r=function(c){return(c.visible||s)&&(!i||!~i.indexOf(c.writeId))&&(Mt(c.path,e)||Mt(e,c.path))},l=Cc(n.allWrites,r,e),a=t||pe.EMPTY_NODE;return zn(l,a)}}}function Jh(n,e,t){let i=pe.EMPTY_NODE;const s=In(n.visibleWrites,e);if(s)return s.isLeafNode()||s.forEachChild(xe,(o,r)=>{i=i.updateImmediateChild(o,r)}),i;if(t){const o=nn(n.visibleWrites,e);return t.forEachChild(xe,(r,l)=>{const a=zn(nn(o,new Ue(r)),l);i=i.updateImmediateChild(r,a)}),Rr(o).forEach(r=>{i=i.updateImmediateChild(r.name,r.node)}),i}else{const o=nn(n.visibleWrites,e);return Rr(o).forEach(r=>{i=i.updateImmediateChild(r.name,r.node)}),i}}function Xh(n,e,t,i,s){$(i||s,"Either existingEventSnap or existingServerSnap must exist");const o=at(e,t);if(Js(n.visibleWrites,o))return null;{const r=nn(n.visibleWrites,o);return Xs(r)?s.getChild(t):zn(r,s.getChild(t))}}function Zh(n,e,t,i){const s=at(e,t),o=In(n.visibleWrites,s);if(o!=null)return o;if(i.isCompleteForChild(t)){const r=nn(n.visibleWrites,s);return zn(r,i.getNode().getImmediateChild(t))}else return null}function xh(n,e){return In(n.visibleWrites,e)}function $h(n,e,t,i,s,o,r){let l;const a=nn(n.visibleWrites,e),c=In(a,Fe());if(c!=null)l=c;else if(t!=null)l=zn(a,t);else return[];if(l=l.withIndex(r),!l.isEmpty()&&!l.isLeafNode()){const u=[],d=r.getCompare(),f=o?l.getReverseIteratorFrom(i,r):l.getIteratorFrom(i,r);let h=f.getNext();for(;h&&u.length<s;)d(h,i)!==0&&u.push(h),h=f.getNext();return u}else return[]}function ep(){return{visibleWrites:Ft.empty(),allWrites:[],lastWriteId:-1}}function Xi(n,e,t,i){return Ec(n.writeTree,n.treePath,e,t,i)}function Io(n,e){return Jh(n.writeTree,n.treePath,e)}function Ar(n,e,t,i){return Xh(n.writeTree,n.treePath,e,t,i)}function Zi(n,e){return xh(n.writeTree,at(n.treePath,e))}function tp(n,e,t,i,s,o){return $h(n.writeTree,n.treePath,e,t,i,s,o)}function To(n,e,t){return Zh(n.writeTree,n.treePath,e,t)}function Sc(n,e){return Ic(at(n.treePath,e),n.writeTree)}function Ic(n,e){return{treePath:n,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class np{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,i=e.childName;$(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),$(i!==".priority","Only non-priority child changes can be tracked.");const s=this.changeMap.get(i);if(s){const o=s.type;if(t==="child_added"&&o==="child_removed")this.changeMap.set(i,_i(i,e.snapshotNode,s.snapshotNode));else if(t==="child_removed"&&o==="child_added")this.changeMap.delete(i);else if(t==="child_removed"&&o==="child_changed")this.changeMap.set(i,pi(i,s.oldSnap));else if(t==="child_changed"&&o==="child_added")this.changeMap.set(i,Hn(i,e.snapshotNode));else if(t==="child_changed"&&o==="child_changed")this.changeMap.set(i,_i(i,e.snapshotNode,s.oldSnap));else throw Yn("Illegal combination of changes: "+e+" occurred after "+s)}else this.changeMap.set(i,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ip{getCompleteChild(e){return null}getChildAfterChild(e,t,i){return null}}const Tc=new ip;class No{constructor(e,t,i=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=i}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const i=this.optCompleteServerCache_!=null?new cn(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return To(this.writes_,e,i)}}getChildAfterChild(e,t,i){const s=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:En(this.viewCache_),o=tp(this.writes_,s,t,1,i,e);return o.length===0?null:o[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sp(n){return{filter:n}}function op(n,e){$(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),$(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}function rp(n,e,t,i,s){const o=new np;let r,l;if(t.type===Lt.OVERWRITE){const c=t;c.source.fromUser?r=Zs(n,e,c.path,c.snap,i,s,o):($(c.source.fromServer,"Unknown source."),l=c.source.tagged||e.serverCache.isFiltered()&&!Ce(c.path),r=xi(n,e,c.path,c.snap,i,s,l,o))}else if(t.type===Lt.MERGE){const c=t;c.source.fromUser?r=ap(n,e,c.path,c.children,i,s,o):($(c.source.fromServer,"Unknown source."),l=c.source.tagged||e.serverCache.isFiltered(),r=xs(n,e,c.path,c.children,i,s,l,o))}else if(t.type===Lt.ACK_USER_WRITE){const c=t;c.revert?r=dp(n,e,c.path,i,s,o):r=cp(n,e,c.path,c.affectedTree,i,s,o)}else if(t.type===Lt.LISTEN_COMPLETE)r=up(n,e,t.path,i,o);else throw Yn("Unknown operation type: "+t.type);const a=o.getChanges();return lp(e,r,a),{viewCache:r,changes:a}}function lp(n,e,t){const i=e.eventCache;if(i.isFullyInitialized()){const s=i.getNode().isLeafNode()||i.getNode().isEmpty(),o=Ji(n);(t.length>0||!n.eventCache.isFullyInitialized()||s&&!i.getNode().equals(o)||!i.getNode().getPriority().equals(o.getPriority()))&&t.push(bc(Ji(e)))}}function Nc(n,e,t,i,s,o){const r=e.eventCache;if(Zi(i,t)!=null)return e;{let l,a;if(Ce(t))if($(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const c=En(e),u=c instanceof pe?c:pe.EMPTY_NODE,d=Io(i,u);l=n.filter.updateFullNode(e.eventCache.getNode(),d,o)}else{const c=Xi(i,En(e));l=n.filter.updateFullNode(e.eventCache.getNode(),c,o)}else{const c=Se(t);if(c===".priority"){$(an(t)===1,"Can't have a priority with additional path components");const u=r.getNode();a=e.serverCache.getNode();const d=Ar(i,t,u,a);d!=null?l=n.filter.updatePriority(u,d):l=r.getNode()}else{const u=Ke(t);let d;if(r.isCompleteForChild(c)){a=e.serverCache.getNode();const f=Ar(i,t,r.getNode(),a);f!=null?d=r.getNode().getImmediateChild(c).updateChild(u,f):d=r.getNode().getImmediateChild(c)}else d=To(i,c,e.serverCache);d!=null?l=n.filter.updateChild(r.getNode(),c,d,u,s,o):l=r.getNode()}}return ri(e,l,r.isFullyInitialized()||Ce(t),n.filter.filtersNodes())}}function xi(n,e,t,i,s,o,r,l){const a=e.serverCache;let c;const u=r?n.filter:n.filter.getIndexedFilter();if(Ce(t))c=u.updateFullNode(a.getNode(),i,null);else if(u.filtersNodes()&&!a.isFiltered()){const h=a.getNode().updateChild(t,i);c=u.updateFullNode(a.getNode(),h,null)}else{const h=Se(t);if(!a.isCompleteForPath(t)&&an(t)>1)return e;const _=Ke(t),v=a.getNode().getImmediateChild(h).updateChild(_,i);h===".priority"?c=u.updatePriority(a.getNode(),v):c=u.updateChild(a.getNode(),h,v,_,Tc,null)}const d=wc(e,c,a.isFullyInitialized()||Ce(t),u.filtersNodes()),f=new No(s,d,o);return Nc(n,d,t,s,f,l)}function Zs(n,e,t,i,s,o,r){const l=e.eventCache;let a,c;const u=new No(s,e,o);if(Ce(t))c=n.filter.updateFullNode(e.eventCache.getNode(),i,r),a=ri(e,c,!0,n.filter.filtersNodes());else{const d=Se(t);if(d===".priority")c=n.filter.updatePriority(e.eventCache.getNode(),i),a=ri(e,c,l.isFullyInitialized(),l.isFiltered());else{const f=Ke(t),h=l.getNode().getImmediateChild(d);let _;if(Ce(f))_=i;else{const b=u.getCompleteChild(d);b!=null?rc(f)===".priority"&&b.getChild(ac(f)).isEmpty()?_=b:_=b.updateChild(f,i):_=pe.EMPTY_NODE}if(h.equals(_))a=e;else{const b=n.filter.updateChild(l.getNode(),d,_,f,u,r);a=ri(e,b,l.isFullyInitialized(),n.filter.filtersNodes())}}}return a}function Pr(n,e){return n.eventCache.isCompleteForChild(e)}function ap(n,e,t,i,s,o,r){let l=e;return i.foreach((a,c)=>{const u=at(t,a);Pr(e,Se(u))&&(l=Zs(n,l,u,c,s,o,r))}),i.foreach((a,c)=>{const u=at(t,a);Pr(e,Se(u))||(l=Zs(n,l,u,c,s,o,r))}),l}function Mr(n,e,t){return t.foreach((i,s)=>{e=e.updateChild(i,s)}),e}function xs(n,e,t,i,s,o,r,l){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let a=e,c;Ce(t)?c=i:c=new Je(null).setTree(t,i);const u=e.serverCache.getNode();return c.children.inorderTraversal((d,f)=>{if(u.hasChild(d)){const h=e.serverCache.getNode().getImmediateChild(d),_=Mr(n,h,f);a=xi(n,a,new Ue(d),_,s,o,r,l)}}),c.children.inorderTraversal((d,f)=>{const h=!e.serverCache.isCompleteForChild(d)&&f.value===null;if(!u.hasChild(d)&&!h){const _=e.serverCache.getNode().getImmediateChild(d),b=Mr(n,_,f);a=xi(n,a,new Ue(d),b,s,o,r,l)}}),a}function cp(n,e,t,i,s,o,r){if(Zi(s,t)!=null)return e;const l=e.serverCache.isFiltered(),a=e.serverCache;if(i.value!=null){if(Ce(t)&&a.isFullyInitialized()||a.isCompleteForPath(t))return xi(n,e,t,a.getNode().getChild(t),s,o,l,r);if(Ce(t)){let c=new Je(null);return a.getNode().forEachChild(tn,(u,d)=>{c=c.set(new Ue(u),d)}),xs(n,e,t,c,s,o,l,r)}else return e}else{let c=new Je(null);return i.foreach((u,d)=>{const f=at(t,u);a.isCompleteForPath(f)&&(c=c.set(u,a.getNode().getChild(f)))}),xs(n,e,t,c,s,o,l,r)}}function up(n,e,t,i,s){const o=e.serverCache,r=wc(e,o.getNode(),o.isFullyInitialized()||Ce(t),o.isFiltered());return Nc(n,r,t,i,Tc,s)}function dp(n,e,t,i,s,o){let r;if(Zi(i,t)!=null)return e;{const l=new No(i,e,s),a=e.eventCache.getNode();let c;if(Ce(t)||Se(t)===".priority"){let u;if(e.serverCache.isFullyInitialized())u=Xi(i,En(e));else{const d=e.serverCache.getNode();$(d instanceof pe,"serverChildren would be complete if leaf node"),u=Io(i,d)}u=u,c=n.filter.updateFullNode(a,u,o)}else{const u=Se(t);let d=To(i,u,e.serverCache);d==null&&e.serverCache.isCompleteForChild(u)&&(d=a.getImmediateChild(u)),d!=null?c=n.filter.updateChild(a,u,d,Ke(t),l,o):e.eventCache.getNode().hasChild(u)?c=n.filter.updateChild(a,u,pe.EMPTY_NODE,Ke(t),l,o):c=a,c.isEmpty()&&e.serverCache.isFullyInitialized()&&(r=Xi(i,En(e)),r.isLeafNode()&&(c=n.filter.updateFullNode(c,r,o)))}return r=e.serverCache.isFullyInitialized()||Zi(i,Fe())!=null,ri(e,c,r,n.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fp{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const i=this.query_._queryParams,s=new ko(i.getIndex()),o=Dh(i);this.processor_=sp(o);const r=t.serverCache,l=t.eventCache,a=s.updateFullNode(pe.EMPTY_NODE,r.getNode(),null),c=o.updateFullNode(pe.EMPTY_NODE,l.getNode(),null),u=new cn(a,r.isFullyInitialized(),s.filtersNodes()),d=new cn(c,l.isFullyInitialized(),o.filtersNodes());this.viewCache_=ls(d,u),this.eventGenerator_=new qh(this.query_)}get query(){return this.query_}}function hp(n){return n.viewCache_.serverCache.getNode()}function pp(n){return Ji(n.viewCache_)}function _p(n,e){const t=En(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!Ce(e)&&!t.getImmediateChild(Se(e)).isEmpty())?t.getChild(e):null}function Lr(n){return n.eventRegistrations_.length===0}function mp(n,e){n.eventRegistrations_.push(e)}function Fr(n,e,t){const i=[];if(t){$(e==null,"A cancel should cancel all event registrations.");const s=n.query._path;n.eventRegistrations_.forEach(o=>{const r=o.createCancelEvent(t,s);r&&i.push(r)})}if(e){let s=[];for(let o=0;o<n.eventRegistrations_.length;++o){const r=n.eventRegistrations_[o];if(!r.matches(e))s.push(r);else if(e.hasAnyCallback()){s=s.concat(n.eventRegistrations_.slice(o+1));break}}n.eventRegistrations_=s}else n.eventRegistrations_=[];return i}function Br(n,e,t,i){e.type===Lt.MERGE&&e.source.queryId!==null&&($(En(n.viewCache_),"We should always have a full cache before handling merges"),$(Ji(n.viewCache_),"Missing event cache, even though we have a server cache"));const s=n.viewCache_,o=rp(n.processor_,s,e,t,i);return op(n.processor_,o.viewCache),$(o.viewCache.serverCache.isFullyInitialized()||!s.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=o.viewCache,Oc(n,o.changes,o.viewCache.eventCache.getNode(),null)}function gp(n,e){const t=n.viewCache_.eventCache,i=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(xe,(o,r)=>{i.push(Hn(o,r))}),t.isFullyInitialized()&&i.push(bc(t.getNode())),Oc(n,i,t.getNode(),e)}function Oc(n,e,t,i){const s=i?[i]:n.eventRegistrations_;return Wh(n.eventGenerator_,e,t,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let $i;class Dc{constructor(){this.views=new Map}}function bp(n){$(!$i,"__referenceConstructor has already been defined"),$i=n}function vp(){return $($i,"Reference.ts has not been loaded"),$i}function yp(n){return n.views.size===0}function Oo(n,e,t,i){const s=e.source.queryId;if(s!==null){const o=n.views.get(s);return $(o!=null,"SyncTree gave us an op for an invalid query."),Br(o,e,t,i)}else{let o=[];for(const r of n.views.values())o=o.concat(Br(r,e,t,i));return o}}function Rc(n,e,t,i,s){const o=e._queryIdentifier,r=n.views.get(o);if(!r){let l=Xi(t,s?i:null),a=!1;l?a=!0:i instanceof pe?(l=Io(t,i),a=!1):(l=pe.EMPTY_NODE,a=!1);const c=ls(new cn(l,a,!1),new cn(i,s,!1));return new fp(e,c)}return r}function wp(n,e,t,i,s,o){const r=Rc(n,e,i,s,o);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,r),mp(r,t),gp(r,t)}function kp(n,e,t,i){const s=e._queryIdentifier,o=[];let r=[];const l=un(n);if(s==="default")for(const[a,c]of n.views.entries())r=r.concat(Fr(c,t,i)),Lr(c)&&(n.views.delete(a),c.query._queryParams.loadsAllData()||o.push(c.query));else{const a=n.views.get(s);a&&(r=r.concat(Fr(a,t,i)),Lr(a)&&(n.views.delete(s),a.query._queryParams.loadsAllData()||o.push(a.query)))}return l&&!un(n)&&o.push(new(vp())(e._repo,e._path)),{removed:o,events:r}}function Ac(n){const e=[];for(const t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function sn(n,e){let t=null;for(const i of n.views.values())t=t||_p(i,e);return t}function Pc(n,e){if(e._queryParams.loadsAllData())return cs(n);{const i=e._queryIdentifier;return n.views.get(i)}}function Mc(n,e){return Pc(n,e)!=null}function un(n){return cs(n)!=null}function cs(n){for(const e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let es;function Cp(n){$(!es,"__referenceConstructor has already been defined"),es=n}function Ep(){return $(es,"Reference.ts has not been loaded"),es}let Sp=1;class qr{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Je(null),this.pendingWriteTree_=ep(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function Lc(n,e,t,i,s){return Uh(n.pendingWriteTree_,e,t,i,s),s?Ti(n,new Cn(yc(),e,t)):[]}function mn(n,e,t=!1){const i=Gh(n.pendingWriteTree_,e);if(Vh(n.pendingWriteTree_,e)){let o=new Je(null);return i.snap!=null?o=o.set(Fe(),!0):St(i.children,r=>{o=o.set(new Ue(r),!0)}),Ti(n,new Qi(i.path,o,t))}else return[]}function Ii(n,e,t){return Ti(n,new Cn(Eo(),e,t))}function Ip(n,e,t){const i=Je.fromObject(t);return Ti(n,new bi(Eo(),e,i))}function Tp(n,e){return Ti(n,new gi(Eo(),e))}function Np(n,e,t){const i=Ro(n,t);if(i){const s=Ao(i),o=s.path,r=s.queryId,l=vt(o,e),a=new gi(So(r),l);return Po(n,o,a)}else return[]}function Fc(n,e,t,i,s=!1){const o=e._path,r=n.syncPointTree_.get(o);let l=[];if(r&&(e._queryIdentifier==="default"||Mc(r,e))){const a=kp(r,e,t,i);yp(r)&&(n.syncPointTree_=n.syncPointTree_.remove(o));const c=a.removed;if(l=a.events,!s){const u=c.findIndex(f=>f._queryParams.loadsAllData())!==-1,d=n.syncPointTree_.findOnPath(o,(f,h)=>un(h));if(u&&!d){const f=n.syncPointTree_.subtree(o);if(!f.isEmpty()){const h=Ap(f);for(let _=0;_<h.length;++_){const b=h[_],v=b.query,y=jc(n,b);n.listenProvider_.startListening(ai(v),vi(n,v),y.hashFn,y.onComplete)}}}!d&&c.length>0&&!i&&(u?n.listenProvider_.stopListening(ai(e),null):c.forEach(f=>{const h=n.queryToTagMap.get(us(f));n.listenProvider_.stopListening(ai(f),h)}))}Pp(n,c)}return l}function Bc(n,e,t,i){const s=Ro(n,i);if(s!=null){const o=Ao(s),r=o.path,l=o.queryId,a=vt(r,e),c=new Cn(So(l),a,t);return Po(n,r,c)}else return[]}function Op(n,e,t,i){const s=Ro(n,i);if(s){const o=Ao(s),r=o.path,l=o.queryId,a=vt(r,e),c=Je.fromObject(t),u=new bi(So(l),a,c);return Po(n,r,u)}else return[]}function Dp(n,e,t,i=!1){const s=e._path;let o=null,r=!1;n.syncPointTree_.foreachOnPath(s,(f,h)=>{const _=vt(f,s);o=o||sn(h,_),r=r||un(h)});let l=n.syncPointTree_.get(s);l?(r=r||un(l),o=o||sn(l,Fe())):(l=new Dc,n.syncPointTree_=n.syncPointTree_.set(s,l));let a;o!=null?a=!0:(a=!1,o=pe.EMPTY_NODE,n.syncPointTree_.subtree(s).foreachChild((h,_)=>{const b=sn(_,Fe());b&&(o=o.updateImmediateChild(h,b))}));const c=Mc(l,e);if(!c&&!e._queryParams.loadsAllData()){const f=us(e);$(!n.queryToTagMap.has(f),"View does not exist, but we have a tag");const h=Mp();n.queryToTagMap.set(f,h),n.tagToQueryMap.set(h,f)}const u=as(n.pendingWriteTree_,s);let d=wp(l,e,t,u,o,a);if(!c&&!r&&!i){const f=Pc(l,e);d=d.concat(Lp(n,e,f))}return d}function Do(n,e,t){const s=n.pendingWriteTree_,o=n.syncPointTree_.findOnPath(e,(r,l)=>{const a=vt(r,e),c=sn(l,a);if(c)return c});return Ec(s,e,o,t,!0)}function Rp(n,e){const t=e._path;let i=null;n.syncPointTree_.foreachOnPath(t,(c,u)=>{const d=vt(c,t);i=i||sn(u,d)});let s=n.syncPointTree_.get(t);s?i=i||sn(s,Fe()):(s=new Dc,n.syncPointTree_=n.syncPointTree_.set(t,s));const o=i!=null,r=o?new cn(i,!0,!1):null,l=as(n.pendingWriteTree_,e._path),a=Rc(s,e,l,o?r.getNode():pe.EMPTY_NODE,o);return pp(a)}function Ti(n,e){return qc(e,n.syncPointTree_,null,as(n.pendingWriteTree_,Fe()))}function qc(n,e,t,i){if(Ce(n.path))return Wc(n,e,t,i);{const s=e.get(Fe());t==null&&s!=null&&(t=sn(s,Fe()));let o=[];const r=Se(n.path),l=n.operationForChild(r),a=e.children.get(r);if(a&&l){const c=t?t.getImmediateChild(r):null,u=Sc(i,r);o=o.concat(qc(l,a,c,u))}return s&&(o=o.concat(Oo(s,n,i,t))),o}}function Wc(n,e,t,i){const s=e.get(Fe());t==null&&s!=null&&(t=sn(s,Fe()));let o=[];return e.children.inorderTraversal((r,l)=>{const a=t?t.getImmediateChild(r):null,c=Sc(i,r),u=n.operationForChild(r);u&&(o=o.concat(Wc(u,l,a,c)))}),s&&(o=o.concat(Oo(s,n,i,t))),o}function jc(n,e){const t=e.query,i=vi(n,t);return{hashFn:()=>(hp(e)||pe.EMPTY_NODE).hash(),onComplete:s=>{if(s==="ok")return i?Np(n,t._path,i):Tp(n,t._path);{const o=Rf(s,t);return Fc(n,t,null,o)}}}}function vi(n,e){const t=us(e);return n.queryToTagMap.get(t)}function us(n){return n._path.toString()+"$"+n._queryIdentifier}function Ro(n,e){return n.tagToQueryMap.get(e)}function Ao(n){const e=n.indexOf("$");return $(e!==-1&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new Ue(n.substr(0,e))}}function Po(n,e,t){const i=n.syncPointTree_.get(e);$(i,"Missing sync point for query tag that we're tracking");const s=as(n.pendingWriteTree_,e);return Oo(i,t,s,null)}function Ap(n){return n.fold((e,t,i)=>{if(t&&un(t))return[cs(t)];{let s=[];return t&&(s=Ac(t)),St(i,(o,r)=>{s=s.concat(r)}),s}})}function ai(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(Ep())(n._repo,n._path):n}function Pp(n,e){for(let t=0;t<e.length;++t){const i=e[t];if(!i._queryParams.loadsAllData()){const s=us(i),o=n.queryToTagMap.get(s);n.queryToTagMap.delete(s),n.tagToQueryMap.delete(o)}}}function Mp(){return Sp++}function Lp(n,e,t){const i=e._path,s=vi(n,e),o=jc(n,t),r=n.listenProvider_.startListening(ai(e),s,o.hashFn,o.onComplete),l=n.syncPointTree_.subtree(i);if(s)$(!un(l.value),"If we're adding a query, it shouldn't be shadowed");else{const a=l.fold((c,u,d)=>{if(!Ce(c)&&u&&un(u))return[cs(u).query];{let f=[];return u&&(f=f.concat(Ac(u).map(h=>h.query))),St(d,(h,_)=>{f=f.concat(_)}),f}});for(let c=0;c<a.length;++c){const u=a[c];n.listenProvider_.stopListening(ai(u),vi(n,u))}}return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mo{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new Mo(t)}node(){return this.node_}}class Lo{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=at(this.path_,e);return new Lo(this.syncTree_,t)}node(){return Do(this.syncTree_,this.path_)}}const Fp=function(n){return n=n||{},n.timestamp=n.timestamp||new Date().getTime(),n},Wr=function(n,e,t){if(!n||typeof n!="object")return n;if($(".sv"in n,"Unexpected leaf node or priority contents"),typeof n[".sv"]=="string")return Bp(n[".sv"],e,t);if(typeof n[".sv"]=="object")return qp(n[".sv"],e);$(!1,"Unexpected server value: "+JSON.stringify(n,null,2))},Bp=function(n,e,t){switch(n){case"timestamp":return t.timestamp;default:$(!1,"Unexpected server value: "+n)}},qp=function(n,e,t){n.hasOwnProperty("increment")||$(!1,"Unexpected server value: "+JSON.stringify(n,null,2));const i=n.increment;typeof i!="number"&&$(!1,"Unexpected increment value: "+i);const s=e.node();if($(s!==null&&typeof s<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!s.isLeafNode())return i;const r=s.getValue();return typeof r!="number"?i:r+i},Wp=function(n,e,t,i){return Fo(e,new Lo(t,n),i)},Hc=function(n,e,t){return Fo(n,new Mo(e),t)};function Fo(n,e,t){const i=n.getPriority().val(),s=Wr(i,e.getImmediateChild(".priority"),t);let o;if(n.isLeafNode()){const r=n,l=Wr(r.getValue(),e,t);return l!==r.getValue()||s!==r.getPriority().val()?new ct(l,dt(s)):n}else{const r=n;return o=r,s!==r.getPriority().val()&&(o=o.updatePriority(new ct(s))),r.forEachChild(xe,(l,a)=>{const c=Fo(a,e.getImmediateChild(l),t);c!==a&&(o=o.updateImmediateChild(l,c))}),o}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bo{constructor(e="",t=null,i={children:{},childCount:0}){this.name=e,this.parent=t,this.node=i}}function qo(n,e){let t=e instanceof Ue?e:new Ue(e),i=n,s=Se(t);for(;s!==null;){const o=jn(i.node.children,s)||{children:{},childCount:0};i=new Bo(s,i,o),t=Ke(t),s=Se(t)}return i}function Xn(n){return n.node.value}function zc(n,e){n.node.value=e,$s(n)}function Uc(n){return n.node.childCount>0}function jp(n){return Xn(n)===void 0&&!Uc(n)}function ds(n,e){St(n.node.children,(t,i)=>{e(new Bo(t,n,i))})}function Gc(n,e,t,i){t&&!i&&e(n),ds(n,s=>{Gc(s,e,!0,i)}),t&&i&&e(n)}function Hp(n,e,t){let i=t?n:n.parent;for(;i!==null;){if(e(i))return!0;i=i.parent}return!1}function Ni(n){return new Ue(n.parent===null?n.name:Ni(n.parent)+"/"+n.name)}function $s(n){n.parent!==null&&zp(n.parent,n.name,n)}function zp(n,e,t){const i=jp(t),s=Vt(n.node.children,e);i&&s?(delete n.node.children[e],n.node.childCount--,$s(n)):!i&&!s&&(n.node.children[e]=t.node,n.node.childCount++,$s(n))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Up=/[\[\].#$\/\u0000-\u001F\u007F]/,Gp=/[\[\].#$\u0000-\u001F\u007F]/,Ps=10*1024*1024,Vc=function(n){return typeof n=="string"&&n.length!==0&&!Up.test(n)},Kc=function(n){return typeof n=="string"&&n.length!==0&&!Gp.test(n)},Vp=function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Kc(n)},jr=function(n){return n===null||typeof n=="string"||typeof n=="number"&&!_o(n)||n&&typeof n=="object"&&Vt(n,".sv")},Yc=function(n,e,t,i){i&&e===void 0||Wo(ho(n,"value"),e,t)},Wo=function(n,e,t){const i=t instanceof Ue?new uh(t,n):t;if(e===void 0)throw new Error(n+"contains undefined "+hn(i));if(typeof e=="function")throw new Error(n+"contains a function "+hn(i)+" with contents = "+e.toString());if(_o(e))throw new Error(n+"contains "+e.toString()+" "+hn(i));if(typeof e=="string"&&e.length>Ps/3&&os(e)>Ps)throw new Error(n+"contains a string greater than "+Ps+" utf8 bytes "+hn(i)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let s=!1,o=!1;if(St(e,(r,l)=>{if(r===".value")s=!0;else if(r!==".priority"&&r!==".sv"&&(o=!0,!Vc(r)))throw new Error(n+" contains an invalid key ("+r+") "+hn(i)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);dh(i,r),Wo(n,l,i),fh(i)}),s&&o)throw new Error(n+' contains ".value" child '+hn(i)+" in addition to actual children.")}},Qc=function(n,e,t,i){if(!(i&&t===void 0)&&!Kc(t))throw new Error(ho(n,e)+'was an invalid path = "'+t+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},Kp=function(n,e,t,i){t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),Qc(n,e,t,i)},jo=function(n,e){if(Se(e)===".info")throw new Error(n+" failed = Can't modify data under /.info/")},Yp=function(n,e){const t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!Vc(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!Vp(t))throw new Error(ho(n,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qp{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function Jc(n,e){let t=null;for(let i=0;i<e.length;i++){const s=e[i],o=s.getPath();t!==null&&!cc(o,t.path)&&(n.eventLists_.push(t),t=null),t===null&&(t={events:[],path:o}),t.events.push(s)}t&&n.eventLists_.push(t)}function Ut(n,e,t){Jc(n,t),Jp(n,i=>Mt(i,e)||Mt(e,i))}function Jp(n,e){n.recursionDepth_++;let t=!0;for(let i=0;i<n.eventLists_.length;i++){const s=n.eventLists_[i];if(s){const o=s.path;e(o)?(Xp(n.eventLists_[i]),n.eventLists_[i]=null):t=!1}}t&&(n.eventLists_=[]),n.recursionDepth_--}function Xp(n){for(let e=0;e<n.events.length;e++){const t=n.events[e];if(t!==null){n.events[e]=null;const i=t.getEventRunner();vn&&_t("event: "+t.toString()),Jn(i)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zp="repo_interrupt",xp=25;class $p{constructor(e,t,i,s){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=i,this.appCheckProvider_=s,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Qp,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Yi(),this.transactionQueueTree_=new Bo,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function e_(n,e,t){if(n.stats_=bo(n.repoInfo_),n.forceRestClient_||Lf())n.server_=new Ki(n.repoInfo_,(i,s,o,r)=>{Hr(n,i,s,o,r)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>zr(n,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{lt(t)}catch(i){throw new Error("Invalid authOverride provided: "+i)}}n.persistentConnection_=new Yt(n.repoInfo_,e,(i,s,o,r)=>{Hr(n,i,s,o,r)},i=>{zr(n,i)},i=>{t_(n,i)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(i=>{n.server_.refreshAuthToken(i)}),n.appCheckProvider_.addTokenChangeListener(i=>{n.server_.refreshAppCheckToken(i.token)}),n.statsReporter_=jf(n.repoInfo_,()=>new Bh(n.stats_,n.server_)),n.infoData_=new Ah,n.infoSyncTree_=new qr({startListening:(i,s,o,r)=>{let l=[];const a=n.infoData_.getNode(i._path);return a.isEmpty()||(l=Ii(n.infoSyncTree_,i._path,a),setTimeout(()=>{r("ok")},0)),l},stopListening:()=>{}}),zo(n,"connected",!1),n.serverSyncTree_=new qr({startListening:(i,s,o,r)=>(n.server_.listen(i,o,s,(l,a)=>{const c=r(l,a);Ut(n.eventQueue_,i._path,c)}),[]),stopListening:(i,s)=>{n.server_.unlisten(i,s)}})}function Xc(n){const t=n.infoData_.getNode(new Ue(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function Ho(n){return Fp({timestamp:Xc(n)})}function Hr(n,e,t,i,s){n.dataUpdateCount++;const o=new Ue(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let r=[];if(s)if(i){const a=ji(t,c=>dt(c));r=Op(n.serverSyncTree_,o,a,s)}else{const a=dt(t);r=Bc(n.serverSyncTree_,o,a,s)}else if(i){const a=ji(t,c=>dt(c));r=Ip(n.serverSyncTree_,o,a)}else{const a=dt(t);r=Ii(n.serverSyncTree_,o,a)}let l=o;r.length>0&&(l=hs(n,o)),Ut(n.eventQueue_,l,r)}function zr(n,e){zo(n,"connected",e),e===!1&&s_(n)}function t_(n,e){St(e,(t,i)=>{zo(n,t,i)})}function zo(n,e,t){const i=new Ue("/.info/"+e),s=dt(t);n.infoData_.updateSnapshot(i,s);const o=Ii(n.infoSyncTree_,i,s);Ut(n.eventQueue_,i,o)}function Zc(n){return n.nextWriteId_++}function n_(n,e,t){const i=Rp(n.serverSyncTree_,e);return i!=null?Promise.resolve(i):n.server_.get(e).then(s=>{const o=dt(s).withIndex(e._queryParams.getIndex());Dp(n.serverSyncTree_,e,t,!0);let r;if(e._queryParams.loadsAllData())r=Ii(n.serverSyncTree_,e._path,o);else{const l=vi(n.serverSyncTree_,e);r=Bc(n.serverSyncTree_,e._path,o,l)}return Ut(n.eventQueue_,e._path,r),Fc(n.serverSyncTree_,e,t,null,!0),o},s=>(fs(n,"get for query "+lt(e)+" failed: "+s),Promise.reject(new Error(s))))}function i_(n,e,t,i,s){fs(n,"set",{path:e.toString(),value:t,priority:i});const o=Ho(n),r=dt(t,i),l=Do(n.serverSyncTree_,e),a=Hc(r,l,o),c=Zc(n),u=Lc(n.serverSyncTree_,e,a,c,!0);Jc(n.eventQueue_,u),n.server_.put(e.toString(),r.val(!0),(f,h)=>{const _=f==="ok";_||Et("set at "+e+" failed: "+f);const b=mn(n.serverSyncTree_,c,!_);Ut(n.eventQueue_,e,b),r_(n,s,f,h)});const d=nu(n,e);hs(n,d),Ut(n.eventQueue_,d,[])}function s_(n){fs(n,"onDisconnectEvents");const e=Ho(n),t=Yi();Qs(n.onDisconnect_,Fe(),(s,o)=>{const r=Wp(s,o,n.serverSyncTree_,e);vc(t,s,r)});let i=[];Qs(t,Fe(),(s,o)=>{i=i.concat(Ii(n.serverSyncTree_,s,o));const r=nu(n,s);hs(n,r)}),n.onDisconnect_=Yi(),Ut(n.eventQueue_,Fe(),i)}function o_(n){n.persistentConnection_&&n.persistentConnection_.interrupt(Zp)}function fs(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),_t(t,...e)}function r_(n,e,t,i){e&&Jn(()=>{if(t==="ok")e(null);else{const s=(t||"error").toUpperCase();let o=s;i&&(o+=": "+i);const r=new Error(o);r.code=s,e(r)}})}function xc(n,e,t){return Do(n.serverSyncTree_,e,t)||pe.EMPTY_NODE}function Uo(n,e=n.transactionQueueTree_){if(e||ps(n,e),Xn(e)){const t=eu(n,e);$(t.length>0,"Sending zero length transaction queue"),t.every(s=>s.status===0)&&l_(n,Ni(e),t)}else Uc(e)&&ds(e,t=>{Uo(n,t)})}function l_(n,e,t){const i=t.map(c=>c.currentWriteId),s=xc(n,e,i);let o=s;const r=s.hash();for(let c=0;c<t.length;c++){const u=t[c];$(u.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=1,u.retryCount++;const d=vt(e,u.path);o=o.updateChild(d,u.currentOutputSnapshotRaw)}const l=o.val(!0),a=e;n.server_.put(a.toString(),l,c=>{fs(n,"transaction put response",{path:a.toString(),status:c});let u=[];if(c==="ok"){const d=[];for(let f=0;f<t.length;f++)t[f].status=2,u=u.concat(mn(n.serverSyncTree_,t[f].currentWriteId)),t[f].onComplete&&d.push(()=>t[f].onComplete(null,!0,t[f].currentOutputSnapshotResolved)),t[f].unwatcher();ps(n,qo(n.transactionQueueTree_,e)),Uo(n,n.transactionQueueTree_),Ut(n.eventQueue_,e,u);for(let f=0;f<d.length;f++)Jn(d[f])}else{if(c==="datastale")for(let d=0;d<t.length;d++)t[d].status===3?t[d].status=4:t[d].status=0;else{Et("transaction at "+a.toString()+" failed: "+c);for(let d=0;d<t.length;d++)t[d].status=4,t[d].abortReason=c}hs(n,e)}},r)}function hs(n,e){const t=$c(n,e),i=Ni(t),s=eu(n,t);return a_(n,s,i),i}function a_(n,e,t){if(e.length===0)return;const i=[];let s=[];const r=e.filter(l=>l.status===0).map(l=>l.currentWriteId);for(let l=0;l<e.length;l++){const a=e[l],c=vt(t,a.path);let u=!1,d;if($(c!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),a.status===4)u=!0,d=a.abortReason,s=s.concat(mn(n.serverSyncTree_,a.currentWriteId,!0));else if(a.status===0)if(a.retryCount>=xp)u=!0,d="maxretry",s=s.concat(mn(n.serverSyncTree_,a.currentWriteId,!0));else{const f=xc(n,a.path,r);a.currentInputSnapshot=f;const h=e[l].update(f.val());if(h!==void 0){Wo("transaction failed: Data returned ",h,a.path);let _=dt(h);typeof h=="object"&&h!=null&&Vt(h,".priority")||(_=_.updatePriority(f.getPriority()));const v=a.currentWriteId,y=Ho(n),k=Hc(_,f,y);a.currentOutputSnapshotRaw=_,a.currentOutputSnapshotResolved=k,a.currentWriteId=Zc(n),r.splice(r.indexOf(v),1),s=s.concat(Lc(n.serverSyncTree_,a.path,k,a.currentWriteId,a.applyLocally)),s=s.concat(mn(n.serverSyncTree_,v,!0))}else u=!0,d="nodata",s=s.concat(mn(n.serverSyncTree_,a.currentWriteId,!0))}Ut(n.eventQueue_,t,s),s=[],u&&(e[l].status=2,function(f){setTimeout(f,Math.floor(0))}(e[l].unwatcher),e[l].onComplete&&(d==="nodata"?i.push(()=>e[l].onComplete(null,!1,e[l].currentInputSnapshot)):i.push(()=>e[l].onComplete(new Error(d),!1,null))))}ps(n,n.transactionQueueTree_);for(let l=0;l<i.length;l++)Jn(i[l]);Uo(n,n.transactionQueueTree_)}function $c(n,e){let t,i=n.transactionQueueTree_;for(t=Se(e);t!==null&&Xn(i)===void 0;)i=qo(i,t),e=Ke(e),t=Se(e);return i}function eu(n,e){const t=[];return tu(n,e,t),t.sort((i,s)=>i.order-s.order),t}function tu(n,e,t){const i=Xn(e);if(i)for(let s=0;s<i.length;s++)t.push(i[s]);ds(e,s=>{tu(n,s,t)})}function ps(n,e){const t=Xn(e);if(t){let i=0;for(let s=0;s<t.length;s++)t[s].status!==2&&(t[i]=t[s],i++);t.length=i,zc(e,t.length>0?t:void 0)}ds(e,i=>{ps(n,i)})}function nu(n,e){const t=Ni($c(n,e)),i=qo(n.transactionQueueTree_,e);return Hp(i,s=>{Ms(n,s)}),Ms(n,i),Gc(i,s=>{Ms(n,s)}),t}function Ms(n,e){const t=Xn(e);if(t){const i=[];let s=[],o=-1;for(let r=0;r<t.length;r++)t[r].status===3||(t[r].status===1?($(o===r-1,"All SENT items should be at beginning of queue."),o=r,t[r].status=3,t[r].abortReason="set"):($(t[r].status===0,"Unexpected transaction status in abort"),t[r].unwatcher(),s=s.concat(mn(n.serverSyncTree_,t[r].currentWriteId,!0)),t[r].onComplete&&i.push(t[r].onComplete.bind(null,new Error("set"),!1,null))));o===-1?zc(e,void 0):t.length=o+1,Ut(n.eventQueue_,Ni(e),s);for(let r=0;r<i.length;r++)Jn(i[r])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c_(n){let e="";const t=n.split("/");for(let i=0;i<t.length;i++)if(t[i].length>0){let s=t[i];try{s=decodeURIComponent(s.replace(/\+/g," "))}catch{}e+="/"+s}return e}function u_(n){const e={};n.charAt(0)==="?"&&(n=n.substring(1));for(const t of n.split("&")){if(t.length===0)continue;const i=t.split("=");i.length===2?e[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):Et(`Invalid query segment '${t}' in query '${n}'`)}return e}const Ur=function(n,e){const t=d_(n),i=t.namespace;t.domain==="firebase.com"&&Qt(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!i||i==="undefined")&&t.domain!=="localhost"&&Qt("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||If();const s=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new Za(t.host,t.secure,i,s,e,"",i!==t.subdomain),path:new Ue(t.pathString)}},d_=function(n){let e="",t="",i="",s="",o="",r=!0,l="https",a=443;if(typeof n=="string"){let c=n.indexOf("//");c>=0&&(l=n.substring(0,c-1),n=n.substring(c+2));let u=n.indexOf("/");u===-1&&(u=n.length);let d=n.indexOf("?");d===-1&&(d=n.length),e=n.substring(0,Math.min(u,d)),u<d&&(s=c_(n.substring(u,d)));const f=u_(n.substring(Math.min(n.length,d)));c=e.indexOf(":"),c>=0?(r=l==="https"||l==="wss",a=parseInt(e.substring(c+1),10)):c=e.length;const h=e.slice(0,c);if(h.toLowerCase()==="localhost")t="localhost";else if(h.split(".").length<=2)t=h;else{const _=e.indexOf(".");i=e.substring(0,_).toLowerCase(),t=e.substring(_+1),o=i}"ns"in f&&(o=f.ns)}return{host:e,port:a,domain:t,subdomain:i,secure:r,scheme:l,pathString:s,namespace:o}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gr="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",f_=function(){let n=0;const e=[];return function(t){const i=t===n;n=t;let s;const o=new Array(8);for(s=7;s>=0;s--)o[s]=Gr.charAt(t%64),t=Math.floor(t/64);$(t===0,"Cannot push at time == 0");let r=o.join("");if(i){for(s=11;s>=0&&e[s]===63;s--)e[s]=0;e[s]++}else for(s=0;s<12;s++)e[s]=Math.floor(Math.random()*64);for(s=0;s<12;s++)r+=Gr.charAt(e[s]);return $(r.length===20,"nextPushId: Length should be 20."),r}}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h_{constructor(e,t,i,s){this.eventType=e,this.eventRegistration=t,this.snapshot=i,this.prevName=s}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+lt(this.snapshot.exportVal())}}class p_{constructor(e,t,i){this.eventRegistration=e,this.error=t,this.path=i}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return $(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _s{constructor(e,t,i,s){this._repo=e,this._path=t,this._queryParams=i,this._orderByCalled=s}get key(){return Ce(this._path)?null:rc(this._path)}get ref(){return new Xt(this._repo,this._path)}get _queryIdentifier(){const e=Tr(this._queryParams),t=mo(e);return t==="{}"?"default":t}get _queryObject(){return Tr(this._queryParams)}isEqual(e){if(e=dn(e),!(e instanceof _s))return!1;const t=this._repo===e._repo,i=cc(this._path,e._path),s=this._queryIdentifier===e._queryIdentifier;return t&&i&&s}toJSON(){return this.toString()}toString(){return this._repo.toString()+ch(this._path)}}function m_(n,e){if(n._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function g_(n){let e=null,t=null;if(n.hasStart()&&(e=n.getIndexStartValue()),n.hasEnd()&&(t=n.getIndexEndValue()),n.getIndex()===tn){const i="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",s="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(n.hasStart()){if(n.getIndexStartName()!==kn)throw new Error(i);if(typeof e!="string")throw new Error(s)}if(n.hasEnd()){if(n.getIndexEndName()!==ln)throw new Error(i);if(typeof t!="string")throw new Error(s)}}else if(n.getIndex()===xe){if(e!=null&&!jr(e)||t!=null&&!jr(t))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if($(n.getIndex()instanceof mc||n.getIndex()===gc,"unknown index type."),e!=null&&typeof e=="object"||t!=null&&typeof t=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}class Xt extends _s{constructor(e,t){super(e,t,new Co,!1)}get parent(){const e=ac(this._path);return e===null?null:new Xt(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}class yi{constructor(e,t,i){this._node=e,this.ref=t,this._index=i}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new Ue(e),i=Jt(this.ref,e);return new yi(this._node.getChild(t),i,xe)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(i,s)=>e(new yi(s,Jt(this.ref,i),xe)))}hasChild(e){const t=new Ue(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function Un(n,e){return n=dn(n),n._checkNotDeleted("ref"),e!==void 0?Jt(n._root,e):n._root}function Jt(n,e){return n=dn(n),Se(n._path)===null?Kp("child","path",e,!1):Qc("child","path",e,!1),new Xt(n._repo,at(n._path,e))}function b_(n,e){n=dn(n),jo("push",n._path),Yc("push",e,n._path,!0);const t=Xc(n._repo),i=f_(t),s=Jt(n,i),o=Jt(n,i);let r;return e!=null?r=ms(o,e).then(()=>o):r=Promise.resolve(o),s.then=r.then.bind(r),s.catch=r.then.bind(r,void 0),s}function v_(n){return jo("remove",n._path),ms(n,null)}function ms(n,e){n=dn(n),jo("set",n._path),Yc("set",e,n._path,!1);const t=new ss;return i_(n._repo,n._path,e,null,t.wrapCallback(()=>{})),t.promise}function iu(n){n=dn(n);const e=new __(()=>{}),t=new Go(e);return n_(n._repo,n,t).then(i=>new yi(i,new Xt(n._repo,n._path),n._queryParams.getIndex()))}class Go{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,t){const i=t._queryParams.getIndex();return new h_("value",this,new yi(e.snapshotNode,new Xt(t._repo,t._path),i))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new p_(this,e,t):null}matches(e){return e instanceof Go?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}class y_{}class w_ extends y_{_apply(e){m_(e,"orderByKey");const t=Rh(e._queryParams,tn);return g_(t),new _s(e._repo,e._path,t,!0)}}function su(){return new w_}function ou(n,...e){let t=dn(n);for(const i of e)t=i._apply(t);return t}bp(Xt);Cp(Xt);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k_="FIREBASE_DATABASE_EMULATOR_HOST",eo={};let C_=!1;function E_(n,e,t,i){n.repoInfo_=new Za(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0),i&&(n.authTokenProvider_=i)}function S_(n,e,t,i,s){let o=i||n.options.databaseURL;o===void 0&&(n.options.projectId||Qt("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),_t("Using default host for project ",n.options.projectId),o=`${n.options.projectId}-default-rtdb.firebaseio.com`);let r=Ur(o,s),l=r.repoInfo,a,c;typeof process<"u"&&process.env&&(c=process.env[k_]),c?(a=!0,o=`http://${c}?ns=${l.namespace}`,r=Ur(o,s),l=r.repoInfo):a=!r.repoInfo.secure;const u=s&&a?new Bn(Bn.OWNER):new Bf(n.name,n.options,e);Yp("Invalid Firebase Database URL",r),Ce(r.path)||Qt("Database URL must point to the root of a Firebase Database (not including a child path).");const d=T_(l,n,u,new Ff(n.name,t));return new N_(d,n)}function I_(n,e){const t=eo[e];(!t||t[n.key]!==n)&&Qt(`Database ${e}(${n.repoInfo_}) has already been deleted.`),o_(n),delete t[n.key]}function T_(n,e,t,i){let s=eo[e.name];s||(s={},eo[e.name]=s);let o=s[n.toURLString()];return o&&Qt("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),o=new $p(n,C_,t,i),s[n.toURLString()]=o,o}class N_{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(e_(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Xt(this._repo,Fe())),this._rootInternal}_delete(){return this._rootInternal!==null&&(I_(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Qt("Cannot call "+e+" on a deleted database.")}}function O_(n=cf(),e){const t=of(n,"database").getImmediate({identifier:e});if(!t._instanceStarted){const i=Xu("database");i&&D_(t,...i)}return t}function D_(n,e,t,i={}){n=dn(n),n._checkNotDeleted("useEmulator"),n._instanceStarted&&Qt("Cannot call useEmulator() after instance has already been initialized.");const s=n._repoInternal;let o;if(s.repoInfo_.nodeAdmin)i.mockUserToken&&Qt('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),o=new Bn(Bn.OWNER);else if(i.mockUserToken){const r=typeof i.mockUserToken=="string"?i.mockUserToken:Zu(i.mockUserToken,n.app.options.projectId);o=new Bn(r)}E_(s,e,t,o)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R_(n){wf(af),zi(new di("database",(e,{instanceIdentifier:t})=>{const i=e.getProvider("app").getImmediate(),s=e.getProvider("auth-internal"),o=e.getProvider("app-check-internal");return S_(i,s,o,t)},"PUBLIC").setMultipleInstances(!0)),Ln(ur,dr,n),Ln(ur,dr,"esm2017")}Yt.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)};Yt.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)};R_();var to={},ru={},gs={};Object.defineProperty(gs,"__esModule",{value:!0});gs.rotx=void 0;function A_(n,e){return n.replace(/[a-zA-Z]/g,function(t){return String.fromCharCode((t<="Z"?90:122)>=(t=t.charCodeAt(0)+e)?t:t-26)})}gs.rotx=A_;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.rotx=void 0;var e=gs;Object.defineProperty(n,"rotx",{enumerable:!0,get:function(){return e.rotx}})})(ru);var lu={},bs={};Object.defineProperty(bs,"__esModule",{value:!0});bs.base64=void 0;class P_{encode(e){return typeof btoa>"u"?Buffer.from(e,"binary").toString("base64"):btoa(e)}decode(e){return typeof atob>"u"?Buffer.from(e,"base64").toString("binary"):atob(e)}}const M_=new P_;bs.base64=M_;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.base64=void 0;var e=bs;Object.defineProperty(n,"base64",{enumerable:!0,get:function(){return e.base64}})})(lu);var au={},vs={};Object.defineProperty(vs,"__esModule",{value:!0});vs.hex=void 0;class L_{encode(e){let t="",i="";for(let s=0;s<e.length;s++)t=e.charCodeAt(s).toString(16),i+=("000"+t).slice(-4);return i}decode(e){let t=e.match(/.{1,4}/g)||[],i="";for(let s=0;s<t.length;s++)i+=String.fromCharCode(parseInt(t[s],16));return i}}const F_=new L_;vs.hex=F_;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.hex=void 0;var e=vs;Object.defineProperty(n,"hex",{enumerable:!0,get:function(){return e.hex}})})(au);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.hex=n.base64=n.rotx=void 0;var e=ru;Object.defineProperty(n,"rotx",{enumerable:!0,get:function(){return e.rotx}});var t=lu;Object.defineProperty(n,"base64",{enumerable:!0,get:function(){return t.base64}});var i=au;Object.defineProperty(n,"hex",{enumerable:!0,get:function(){return i.hex}})})(to);let B_={ixqSmg:"IQhiAgIPDNBgKzMmPcWG9XWqEsxI2uQ70F5X1rY",icbpLwuiqv:"nk-d3-8j3n9.nqzmjiamixx.kwu",libijiamCZT:"pbbxa://nk-d3-8j3n9-lmnictb-zblj.mczwxm-emab1.nqzmjiamlibijiam.ixx",xzwrmkbQl:"nk-d3-8j3n9",abwziomJcksmb:"nk-d3-8j3n9.ixxaxwb.kwu",umaaioqvoAmvlmzQl:"31377888705",ixxQl:"1:31377888705:emj:3018l8nk0i07m867mk0j40"},cu={};for(let[n,e]of Object.entries(B_))cu[to.rotx(n,18)]=to.rotx(e,18);let Wt={armor:"Armor",magicDmg:"Magic",meleeDmg:"Melee",rangedDmg:"Ranged",hpRegen:"HP Regen",endurance:"Endurance",sightRange:"Sight Range",walkSpeed:"Walk Speed",jumpPower:"Jump Power",ammoReturn:"Ammo Return",height:"Height"},Gn=["head","body","legs","feet","neck","back","ring","misc"],ys={name:"",stats:{armor:0,magicDmg:0,meleeDmg:0,rangedDmg:0,hpRegen:0,endurance:0,sightRange:0,walkSpeed:0,jumpPower:0,ammoReturn:0,height:0},cost:{min:0,max:0},image:"",link:""},ws={name:"",info:{type:"",special:""},moves:[],cost:{min:0,max:0},image:"",link:""},q_={armor:{min:0,avg:0,max:0},gear:{min:0,avg:0,max:0},total:{min:0,avg:0,max:0}},Sn=[...Array(5).keys()].map(n=>++n),Vn=O_(Ma(cu)),W_=["head","body","legs","feet","neck","back","ring","misc","gear","sets","bonuses"],uu={0:"th",1:"st",2:"nd",3:"rd",4:"th",5:"th",6:"th",7:"th",8:"th",9:"th"};function du(n,e){let t=!1;for(let i of[n,e])for(let s in i)if(i[s].name){t=!0;break}uo.set(t),kt.set(null),window.history.replaceState(null,null,location.origin+location.pathname)}function Vo(n,e){let t=2.8,i=e.split(" ").length,s=n.querySelector("span");if(s.style.removeProperty("font-size"),i>2&&e.length/i>=5){for(;s.offsetHeight>n.offsetHeight*.75;)t-=.05,s.style.fontSize=`${t}rem`;return t<2.8}return null}function j_(n,e){let t=2.8,i=n.querySelector("span");for(i.style.removeProperty("font-size");i.offsetWidth>n.offsetWidth;)t-=.05,i.style.fontSize=`${t}rem`;for(;i.offsetHeight>n.offsetHeight*.75&&e;)t-=.05,i.style.fontSize=`${t}rem`;return t<2.8?t:null}function H_(n){let e=2.35,t=n.querySelector(".tooltip");for(t.style.removeProperty("font-size");t.offsetHeight>n.offsetHeight*1.125;)e-=.02,t.style.fontSize=`${e}rem`}function z_(n){document.activeElement==document.body&&n.key=="Tab"&&(n.preventDefault(),document.querySelector(`.promptCont [id*='${n.shiftKey?"last":"first"}Focusable']`).focus())}function fu(n,e){let t=n.toLowerCase();for(let i in e)i.toLowerCase().includes(t)&&!e[i].classList.contains("filtered")?e[i].classList.remove("hidden"):e[i].classList.add("hidden")}function ts(n,e){e&&setTimeout(()=>{n.focus(),n.click(),n.select()})}function yt(n){n.shiftKey&&n.key=="Tab"&&n.preventDefault()}function wt(n){n.key=="Tab"&&!n.shiftKey&&n.preventDefault()}function ns(n,e){let t=/[^a-zA-Z0-9~!#$%^&*()\-_+[\]{}\\|;:'",.<>/? ]/g;return n.replace(t,"").replaceAll(`
`,"").replace(/^ /,"").slice(0,e)}function no(n,e,t){(!n.maxLength||n.maxLength!=t)&&e.length>=t&&(n.maxLength=t)}function hu(n,e){n={...n},e={...e};for(let t of Gn)n[t]?n[t]=n[t].name:n[t]="";for(let t of Sn)e[t]?e[t]=e[t].name:e[t]="";return{eq:n,gear:e}}function Ko(){window.history.replaceState(null,null,location.origin+location.pathname+"?ls=true")}function on(n){n.target.closest("button").blur()}function U_(n){let e,t,i,s,o,r,l,a,c,u,d,f;return{c(){e=g("li"),t=g("button"),i=g("img"),o=E(),r=g("span"),r.textContent=`${n[5]}`,l=E(),a=g("iconify-icon"),c=E(),u=g("iconify-icon"),$e(i.src,s=n[0].image)||m(i,"src",s),m(i,"alt",""),Re(a,"icon","maki:cross"),Re(a,"id","cross"),Re(u,"icon","eva:info-outline"),Re(u,"id","info"),re(e,"selectedItem",n[2])},m(h,_){M(h,e,_),p(e,t),p(t,i),p(t,o),p(t,r),p(t,l),p(t,a),p(t,c),p(t,u),n[20](e),d||(f=[da(n[6].call(null,r)),N(t,"touchstart",n[9],{passive:!0}),N(t,"touchend",n[10],{passive:!0}),N(t,"mousedown",n[9]),N(t,"mouseup",n[10]),N(t,"click",n[15]),N(t,"mouseenter",n[16]),N(t,"focusin",n[17]),N(t,"mouseleave",n[18]),N(t,"focusout",n[19]),N(e,"contextmenu",G_)],d=!0)},p(h,[_]){_&1&&!$e(i.src,s=h[0].image)&&m(i,"src",s),_&4&&re(e,"selectedItem",h[2])},i:se,o:se,d(h){h&&R(e),n[20](null),d=!1,be(f)}}}const G_=n=>n.preventDefault();function V_(n,e,t){let i,s,o,r,l,a,c;Q(n,X,F=>t(4,i=F)),Q(n,bt,F=>t(22,s=F)),Q(n,Mn,F=>t(23,o=F)),Q(n,Bt,F=>t(24,r=F)),Q(n,qt,F=>t(25,l=F)),Q(n,zt,F=>t(26,a=F)),Q(n,co,F=>t(27,c=F));let{itemData:u,slotOpen:d,eqSlotName:f,scrolling:h}=e;const _=Gt();let b,v=!1,y=u.name,k,w=0,I;function A(F){setTimeout(()=>{Vo(b,y)&&c.push({node:b,itemName:y})})}function q(F){if(d||!d&&F.isTrusted==!1){_("itemSelect",{element:b,trusted:F.isTrusted}),b.classList.contains("selectedItem")||t(2,v=!1),t(2,v=!v),t(11,d=!1),U(qt,l[f]=v?u:ys,l),du(l,a);for(let B of Object.keys(Wt)){U(bt,s[B]=0,s);for(let G in l)l[G].noStats||(U(bt,s[B]+=l[G].stats[B],s),U(bt,s[B]=Math.round(s[B]*10)/10,s))}for(let B of r.bonuses)if(o[B.name])for(let G in s)U(bt,s[G]+=B.stats[G],s),U(bt,s[G]=Math.round(s[G]*10)/10,s)}}function T(){h||(U(X,i.item.ongoing=!0,i),U(X,i.item.data={...u,slot:f,type:"eq",element:b},i))}function W(){I=setInterval(()=>t(14,w+=50),50)}function H(){clearInterval(I),w>=750&&T(),t(14,w=0)}const K=F=>{F.shiftKey?T():i.item.ongoing||q(F)},D=()=>t(3,k=!0),S=()=>t(3,k=!0),O=()=>t(3,k=!1),Z=()=>t(3,k=!1);function P(F){le[F?"unshift":"push"](()=>{b=F,t(1,b)})}return n.$$set=F=>{"itemData"in F&&t(0,u=F.itemData),"slotOpen"in F&&t(11,d=F.slotOpen),"eqSlotName"in F&&t(12,f=F.eqSlotName),"scrolling"in F&&t(13,h=F.scrolling)},n.$$.update=()=>{n.$$.dirty&16384&&w==750&&_("displayInfo")},[u,b,v,k,i,y,A,q,T,W,H,d,f,h,w,K,D,S,O,Z,P]}class K_ extends Te{constructor(e){super(),Ie(this,e,V_,U_,ge,{itemData:0,slotOpen:11,eqSlotName:12,scrolling:13})}}function Y_(n){let e,t,i,s,o,r,l,a,c,u,d,f,h,_,b;return{c(){e=g("li"),t=g("button"),i=g("img"),o=E(),r=g("span"),r.textContent=`${n[6]}`,l=E(),a=g("iconify-icon"),d=E(),f=g("iconify-icon"),$e(i.src,s=n[0].image)||m(i,"src",s),m(i,"alt",""),Re(a,"icon",c=n[5]?"heroicons-solid:switch-vertical":"maki:cross"),Re(a,"id",u=n[5]?"switchable":"cross"),Re(f,"icon","eva:info-outline"),Re(f,"id","info"),t.disabled=h=!n[4]&&!n[5],re(e,"selectedItem",n[1]),re(e,"non-eligible",!n[4]&&!n[5]),re(e,"switchable",n[5])},m(v,y){M(v,e,y),p(e,t),p(t,i),p(t,o),p(t,r),p(t,l),p(t,a),p(t,d),p(t,f),n[19](e),_||(b=[da(n[7].call(null,r)),N(t,"touchstart",n[10],{passive:!0}),N(t,"touchend",n[11],{passive:!0}),N(t,"mousedown",n[10]),N(t,"mouseup",n[11]),N(t,"click",n[18]),N(e,"contextmenu",Q_)],_=!0)},p(v,[y]){y&1&&!$e(i.src,s=v[0].image)&&m(i,"src",s),y&32&&c!==(c=v[5]?"heroicons-solid:switch-vertical":"maki:cross")&&Re(a,"icon",c),y&32&&u!==(u=v[5]?"switchable":"cross")&&Re(a,"id",u),y&48&&h!==(h=!v[4]&&!v[5])&&(t.disabled=h),y&2&&re(e,"selectedItem",v[1]),y&48&&re(e,"non-eligible",!v[4]&&!v[5]),y&32&&re(e,"switchable",v[5])},i:se,o:se,d(v){v&&R(e),n[19](null),_=!1,be(b)}}}const Q_=n=>n.preventDefault();function J_(n,e,t){let i,s,o,r,l;Q(n,zt,O=>t(17,i=O)),Q(n,X,O=>t(2,s=O)),Q(n,qt,O=>t(21,o=O)),Q(n,Wn,O=>t(22,r=O)),Q(n,co,O=>t(23,l=O));let{itemData:a,slotOpen:c,index:u,weaponExpand:d,scrolling:f}=e;const h=Gt();let _,b=!1,v=!0,y=!1,k=a.name,w=0,I,A={"Orange Salamander":["Green Salamander","Purple Salamander"],"Green Salamander":["Orange Salamander","Purple Salamander"],"Purple Salamander":["Orange Salamander","Green Salamander"],"White Salamander":["Black Salamander","Gold Salamander"],"Black Salamander":["White Salamander","Gold Salamander"],"Gold Salamander":["White Salamander","Black Salamander"]};function q(O){setTimeout(()=>{Vo(_,k)&&l.push({node:_,itemName:k})})}function T(O){v&&(c||!c&&O.isTrusted==!1)&&(a.tool&&d&&h("toolSelect"),h("itemSelect",{element:_,trusted:O.isTrusted}),_.classList.contains("selectedItem")||t(1,b=!1),t(12,c=!1),y?setTimeout(()=>{r[u][k].querySelector("button").click(),r[Object.keys(i).find(Z=>i[Z].name==k)][i[u]&&i[u].name?i[u].name:k].querySelector("button").click(),t(4,v=!0),t(5,y=!1)},5):(t(1,b=!b),U(zt,i[u]=b?a:ws,i)),du(o,i))}function W(){f||(U(X,s.item.ongoing=!0,s),U(X,s.item.data={...a,type:"gear",element:_},s))}function H(){I=setInterval(()=>t(16,w+=50),50)}function K(){clearInterval(I),w>=750&&W(),t(16,w=0)}const D=O=>{O.shiftKey?W():s.item.ongoing||T(O)};function S(O){le[O?"unshift":"push"](()=>{_=O,t(3,_)})}return n.$$set=O=>{"itemData"in O&&t(0,a=O.itemData),"slotOpen"in O&&t(12,c=O.slotOpen),"index"in O&&t(13,u=O.index),"weaponExpand"in O&&t(14,d=O.weaponExpand),"scrolling"in O&&t(15,f=O.scrolling)},n.$$.update=()=>{if(n.$$.dirty&155650&&i)for(let O in i){if(!d&&O!=u&&i[O].name==k){t(5,y=!0);break}if(O!=u&&A[i[O].name]&&A[i[O].name].includes(k)){t(4,v=!1);break}else b||t(4,v=!0)}if(n.$$.dirty&139268)if(s.randomize.ongoing)t(5,y=!1);else for(let O in i)if(O!=u&&i[O].name==k){t(5,y=!0);break}else t(5,y=!1);n.$$.dirty&65536&&w==750&&h("displayInfo")},[a,b,s,_,v,y,k,q,T,W,H,K,c,u,d,f,w,i,D,S]}class X_ extends Te{constructor(e){super(),Ie(this,e,J_,Y_,ge,{itemData:0,slotOpen:12,index:13,weaponExpand:14,scrolling:15})}}function Z_(n){const e=n-1;return e*e*e+1}function Xe(n,{delay:e=0,duration:t=400,easing:i=is}={}){const s=+getComputedStyle(n).opacity;return{delay:e,duration:t,easing:i,css:o=>`opacity: ${o*s}`}}function Ye(n,{delay:e=0,duration:t=400,easing:i=Z_,start:s=0,opacity:o=0}={}){const r=getComputedStyle(n),l=+r.opacity,a=r.transform==="none"?"":r.transform,c=1-s,u=l*(1-o);return{delay:e,duration:t,easing:i,css:(d,f)=>`
			transform: ${a} scale(${1-c*f});
			opacity: ${l-u*f}
		`}}function Vr(n){let e,t,i,s;return{c(){e=g("img"),$e(e.src,t=n[5][n[3]])||m(e,"src",t),m(e,"alt","")},m(o,r){M(o,e,r),s=!0},p(o,r){(!s||r&8&&!$e(e.src,t=o[5][o[3]]))&&m(e,"src",t)},i(o){s||(o&&ve(()=>{s&&(i||(i=me(e,Xe,{duration:150},!0)),i.run(1))}),s=!0)},o(o){o&&(i||(i=me(e,Xe,{duration:150},!1)),i.run(0)),s=!1},d(o){o&&R(e),o&&i&&i.end()}}}function x_(n){let e,t,i=n[5][n[3]],s,o,r=n[0].name+"",l,a,c,u=Vr(n);return{c(){e=g("li"),t=g("button"),u.c(),s=E(),o=g("span"),l=te(r),re(e,"selectedItem",n[4])},m(d,f){M(d,e,f),p(e,t),u.m(t,null),p(t,s),p(t,o),p(o,l),n[8](e),a||(c=[N(t,"click",n[6]),N(e,"mouseenter",n[9]),N(e,"focusin",n[10]),N(e,"mouseleave",n[11]),N(e,"focusout",n[12])],a=!0)},p(d,[f]){f&8&&ge(i,i=d[5][d[3]])?(qe(),z(u,1,1,se),We(),u=Vr(d),u.c(),L(u,1),u.m(t,s)):u.p(d,f),f&1&&r!==(r=d[0].name+"")&&Ee(l,r)},i(d){L(u)},o(d){z(u)},d(d){d&&R(e),u.d(d),n[8](null),a=!1,be(c)}}}function $_(n,e,t){let i,s,o;Q(n,qn,W=>t(14,i=W)),Q(n,qt,W=>t(15,s=W)),Q(n,Bt,W=>t(16,o=W));let{itemData:r,ddOpen:l=!1}=e;const a=Gt();let c,u=!1,d=!1,f,h=0,_=r.pieces.length,b=[];for(let W of r.pieces)e:for(let H of Gn)for(let K of o[H])if(K.name==W){b.push(H);break e}let v=[];for(let W=0;W<_;W++)v.push(o[b[W]].find(H=>H.name==r.pieces[W]).image);function y(){d?f=setInterval(()=>{t(3,h++,h),h==_&&t(3,h=0)},750):(clearInterval(f),t(3,h=0))}function k(){a("setSelect");let W=0;for(let H=0;H<_;H++)!s[b[H]]||s[b[H]].name!=r.pieces[H]?i[b[H]][r.pieces[H]].querySelector("button").click():W++;W!=_&&t(7,l=!1)}function w(W){le[W?"unshift":"push"](()=>{c=W,t(2,c)})}const I=()=>t(1,d=!0),A=()=>t(1,d=!0),q=()=>t(1,d=!1),T=()=>t(1,d=!1);return n.$$set=W=>{"itemData"in W&&t(0,r=W.itemData),"ddOpen"in W&&t(7,l=W.ddOpen)},n.$$.update=()=>{n.$$.dirty&2&&(d||!d)&&y()},[r,d,c,h,u,v,k,l,w,I,A,q,T]}class em extends Te{constructor(e){super(),Ie(this,e,$_,x_,ge,{itemData:0,ddOpen:7})}}const tm=n=>({}),Kr=n=>({});function nm(n){let e,t,i,s,o,r,l,a,c;const u=n[8].tooltip,d=vu(u,n,n[7],Kr);return{c(){e=g("div"),t=g("span"),i=E(),s=g("input"),r=E(),d&&d.c(),m(s,"id",o=n[2]?"firstFocusable":n[3]?"lastFocusable":""),s.disabled=n[4],m(s,"type","checkbox"),s.checked=n[1],m(s,"class","svelte-i9pcgn"),m(e,"class","toggleCont svelte-i9pcgn"),re(e,"unavailable",n[4])},m(f,h){M(f,e,h),p(e,t),t.innerHTML=n[0],p(e,i),p(e,s),p(e,r),d&&d.m(e,null),l=!0,a||(c=[N(s,"change",n[9]),N(s,"keydown",n[10])],a=!0)},p(f,[h]){(!l||h&1)&&(t.innerHTML=f[0]),(!l||h&12&&o!==(o=f[2]?"firstFocusable":f[3]?"lastFocusable":""))&&m(s,"id",o),(!l||h&16)&&(s.disabled=f[4]),(!l||h&2)&&(s.checked=f[1]),d&&d.p&&(!l||h&128)&&wu(d,u,f,f[7],l?yu(u,f[7],h,tm):ku(f[7]),Kr),(!l||h&16)&&re(e,"unavailable",f[4])},i(f){l||(L(d,f),l=!0)},o(f){z(d,f),l=!1},d(f){f&&R(e),d&&d.d(f),a=!1,be(c)}}}function im(n,e,t){let{$$slots:i={},$$scope:s}=e,{text:o,checked:r=!1,first:l=!1,last:a=!1,disabled:c=!1,forced:u=!1}=e;const d=Gt(),f=_=>{_.target.blur(),u?_.target.checked=!0:d("toggle",_.target.checked)},h=_=>{l&&yt(_),a&&wt(_),_.key=="Enter"&&!u?(_.target.checked=!_.target.checked,d("toggle",_.target.checked)):u&&(_.target.checked=!0)};return n.$$set=_=>{"text"in _&&t(0,o=_.text),"checked"in _&&t(1,r=_.checked),"first"in _&&t(2,l=_.first),"last"in _&&t(3,a=_.last),"disabled"in _&&t(4,c=_.disabled),"forced"in _&&t(5,u=_.forced),"$$scope"in _&&t(7,s=_.$$scope)},[o,r,l,a,c,u,d,s,i,f,h]}class mt extends Te{constructor(e){super(),Ie(this,e,im,nm,ge,{text:0,checked:1,first:2,last:3,disabled:4,forced:5})}}function Yr(n,e,t){const i=n.slice();return i[28]=e[t][0],i[29]=e[t][1],i}function Qr(n,e,t){const i=n.slice();return i[28]=e[t][0],i[29]=e[t][1],i}function Jr(n){let e,t;function i(...s){return n[19](n[28],...s)}return e=new mt({props:{text:n[29],checked:n[6][n[28]]}}),e.$on("toggle",i),{c(){oe(e.$$.fragment)},m(s,o){ne(e,s,o),t=!0},p(s,o){n=s;const r={};o[0]&64&&(r.checked=n[6][n[28]]),e.$set(r)},i(s){t||(L(e.$$.fragment,s),t=!0)},o(s){z(e.$$.fragment,s),t=!1},d(s){ie(e,s)}}}function sm(n){let e,t,i,s,o,r,l,a,c;s=new mt({props:{text:"Descension",checked:n[4],forced:n[4]}}),s.$on("toggle",n[20]),r=new mt({props:{text:"Ascension",checked:n[5],forced:n[5]}}),r.$on("toggle",n[21]);let u=Ne(Object.entries(n[9])),d=[];for(let h=0;h<u.length;h+=1)d[h]=Xr(Yr(n,u,h));const f=h=>z(d[h],1,1,()=>{d[h]=null});return{c(){e=g("p"),e.textContent="Sort",t=E(),i=g("div"),oe(s.$$.fragment),o=E(),oe(r.$$.fragment),l=E(),a=g("div");for(let h=0;h<d.length;h+=1)d[h].c();m(e,"id","title"),m(e,"class","svelte-6kxnh3"),m(i,"class","radio ttFocus svelte-6kxnh3"),m(i,"id","sort"),m(a,"class","options svelte-6kxnh3")},m(h,_){M(h,e,_),M(h,t,_),M(h,i,_),ne(s,i,null),p(i,o),ne(r,i,null),M(h,l,_),M(h,a,_);for(let b=0;b<d.length;b+=1)d[b]&&d[b].m(a,null);c=!0},p(h,_){const b={};_[0]&16&&(b.checked=h[4]),_[0]&16&&(b.forced=h[4]),s.$set(b);const v={};if(_[0]&32&&(v.checked=h[5]),_[0]&32&&(v.forced=h[5]),r.$set(v),_[0]&1664){u=Ne(Object.entries(h[9]));let y;for(y=0;y<u.length;y+=1){const k=Yr(h,u,y);d[y]?(d[y].p(k,_),L(d[y],1)):(d[y]=Xr(k),d[y].c(),L(d[y],1),d[y].m(a,null))}for(qe(),y=u.length;y<d.length;y+=1)f(y);We()}},i(h){if(!c){L(s.$$.fragment,h),L(r.$$.fragment,h);for(let _=0;_<u.length;_+=1)L(d[_]);c=!0}},o(h){z(s.$$.fragment,h),z(r.$$.fragment,h),d=d.filter(Boolean);for(let _=0;_<d.length;_+=1)z(d[_]);c=!1},d(h){h&&(R(e),R(t),R(i),R(l),R(a)),ie(s),ie(r),ht(d,h)}}}function Xr(n){let e,t;function i(...s){return n[22](n[28],...s)}return e=new mt({props:{text:n[29],checked:n[7][n[28]],last:n[28]=="none"||n[28]=="tool"}}),e.$on("toggle",i),{c(){oe(e.$$.fragment)},m(s,o){ne(e,s,o),t=!0},p(s,o){n=s;const r={};o[0]&128&&(r.checked=n[7][n[28]]),e.$set(r)},i(s){t||(L(e.$$.fragment,s),t=!0)},o(s){z(e.$$.fragment,s),t=!1},d(s){ie(e,s)}}}function om(n){let e,t,i,s,o,r,l,a,c,u,d,f,h,_,b,v,y,k,w,I,A,q,T;r=new mt({props:{text:"Inclusive",checked:n[1],forced:n[1]}}),r.$on("toggle",n[14]),a=new mt({props:{text:"Exclusive",checked:n[2],forced:n[2]}}),a.$on("toggle",n[15]),u=new mt({props:{text:"Strict",checked:n[3],forced:n[3]}}),u.$on("toggle",n[16]);let W=Ne(Object.entries(n[9])),H=[];for(let S=0;S<W.length;S+=1)H[S]=Jr(Qr(n,W,S));const K=S=>z(H[S],1,1,()=>{H[S]=null});let D=!n[8]&&sm(n);return{c(){e=g("div"),t=g("div"),i=g("p"),i.innerHTML=`Filter
            <span class="tooltip svelte-6kxnh3" id="bottom">Inclusive: Equipment that includes the selected search types
                <br/> <br/>
                Exclusive: Equipment that does not include the selected search types
                <br/> <br/>
                Strict: Equipment that includes the selected search types and no
                others</span> <iconify-icon icon="eva:info-outline"></iconify-icon>`,s=E(),o=g("div"),oe(r.$$.fragment),l=E(),oe(a.$$.fragment),c=E(),oe(u.$$.fragment),d=E(),f=g("div"),h=g("div"),_=g("button"),_.textContent="Select all",b=E(),v=g("div"),y=g("button"),y.textContent="Clear all",k=E(),w=g("div");for(let S=0;S<H.length;S+=1)H[S].c();I=E(),D&&D.c(),m(i,"id","title"),m(i,"class","svelte-6kxnh3"),m(o,"class","radio ttFocus svelte-6kxnh3"),m(o,"id","filter"),m(_,"class","svelte-6kxnh3"),m(h,"class","svelte-6kxnh3"),m(y,"class","svelte-6kxnh3"),m(v,"class","svelte-6kxnh3"),m(f,"class","optionsAll svelte-6kxnh3"),m(w,"class","options svelte-6kxnh3"),m(t,"class","searchOptions svelte-6kxnh3"),m(e,"class","searchOptionsCont svelte-6kxnh3"),re(e,"optionsOpen",n[0])},m(S,O){M(S,e,O),p(e,t),p(t,i),p(t,s),p(t,o),ne(r,o,null),p(o,l),ne(a,o,null),p(o,c),ne(u,o,null),p(t,d),p(t,f),p(f,h),p(h,_),p(f,b),p(f,v),p(v,y),p(t,k),p(t,w);for(let Z=0;Z<H.length;Z+=1)H[Z]&&H[Z].m(w,null);p(t,I),D&&D.m(t,null),A=!0,q||(T=[N(_,"click",n[17]),N(y,"click",n[18])],q=!0)},p(S,O){const Z={};O[0]&2&&(Z.checked=S[1]),O[0]&2&&(Z.forced=S[1]),r.$set(Z);const P={};O[0]&4&&(P.checked=S[2]),O[0]&4&&(P.forced=S[2]),a.$set(P);const F={};if(O[0]&8&&(F.checked=S[3]),O[0]&8&&(F.forced=S[3]),u.$set(F),O[0]&1600){W=Ne(Object.entries(S[9]));let B;for(B=0;B<W.length;B+=1){const G=Qr(S,W,B);H[B]?(H[B].p(G,O),L(H[B],1)):(H[B]=Jr(G),H[B].c(),L(H[B],1),H[B].m(w,null))}for(qe(),B=W.length;B<H.length;B+=1)K(B);We()}S[8]||D.p(S,O),(!A||O[0]&1)&&re(e,"optionsOpen",S[0])},i(S){if(!A){L(r.$$.fragment,S),L(a.$$.fragment,S),L(u.$$.fragment,S);for(let O=0;O<W.length;O+=1)L(H[O]);L(D),A=!0}},o(S){z(r.$$.fragment,S),z(a.$$.fragment,S),z(u.$$.fragment,S),H=H.filter(Boolean);for(let O=0;O<H.length;O+=1)z(H[O]);z(D),A=!1},d(S){S&&R(e),ie(r),ie(a),ie(u),ht(H,S),D&&D.d(),q=!1,be(T)}}}function rm(n,e,t){let i;Q(n,Bt,P=>t(24,i=P));let{optionsOpen:s,slotName:o,elementData:r,list:l}=e;const a=Gt();let c=o=="gear",u=!0,d=!1,f=!1,h=!0,_=!1,b={},v={},y=c?{armor:"Armor",magicDmg:"Magic",meleeDmg:"Melee",rangedDmg:"Ranged",unique:"Unique",tool:"Tool"}:{...Wt,none:"No Stats"};for(let P of Object.keys(y))b[P]=!0;for(let P of Object.keys(y))v[P]=!1;let k=["Void Spike Ultradagger","Pureblood Dagger","Gnome Rocket Launcher"],w=[];function I(P){setTimeout(()=>{for(let F in r){let B=i[o].find(ee=>ee.name==F),G={...Wt},Y={armor:!1,magicDmg:!1,meleeDmg:!1,rangedDmg:!1,unique:!1,tool:!1},ue=c?Y:G,ce=!1;if(c)if(!B.tool&&!k.includes(B.name)){for(let ee in b)for(let j of B.moves)if(Y[ee]=j.type.includes(ee),Y[ee])break}else Y.tool=!!B.tool,Y.tool||(Y.unique=B.info.type=="Unique",B.name=="Void Spike Ultradagger"&&(Y.armor=!0,Y.meleeDmg=!0));else{for(let ee in b)G[ee]=B.stats[ee]!=0;G.none=!!B.noStats}if(u)for(let ee in ue)if(b[ee]&&ue[ee]){ce=!1;break}else ce=!0;else if(d)for(let ee in ue)if(b[ee]&&ue[ee]){ce=!0;break}else ce=!1;else if(f)for(let ee in ue)if(b[ee]&&ue[ee]||!b[ee]&&!ue[ee])ce=!1;else{ce=!0;break}ce?r[F].classList.add("hidden","filtered"):r[F].classList.remove("hidden","filtered")}if(P=="sort"){let F=Object.keys(v).find(G=>v[G]),B=0;for(F&&!(F=="none"||F=="tool")?(w.sort((G,Y)=>{let ue=A(G,Y,!0).stats[F]-A(G,Y,!1).stats[F];return B||(B=ue),ue}),B||(w=Object.values(r))):!F&&_&&(w=Object.values(r).toReversed()),F=="none"&&(w=[...Object.entries(r).filter(G=>i[o].find(Y=>Y.name==G[0]).noStats),...Object.entries(r).filter(G=>!i[o].find(Y=>Y.name==G[0]).noStats)],w=w.map(G=>G[1]),_&&w.reverse());l.lastElementChild;)l.removeChild(l.lastElementChild);if(F||!F&&_)for(let G of w)l.appendChild(G);else for(let G in r)l.appendChild(r[G])}a("listUpdate")})}function A(P,F,B){return i[o].find(G=>G.name==Object.keys(r).find(Y=>r[Y]===(h?B?F:P:B?P:F)))}const q=P=>{t(1,u=P.detail),P.detail&&(t(2,d=!1),t(3,f=!1)),I("filter")},T=P=>{t(2,d=P.detail),P.detail&&(t(1,u=!1),t(3,f=!1)),I("filter")},W=P=>{t(3,f=P.detail),P.detail&&(t(1,u=!1),t(2,d=!1)),I("filter")},H=P=>{P.target.blur();for(let F in b)t(6,b[F]=!0,b);I("filter")},K=P=>{P.target.blur();for(let F in b)t(6,b[F]=!1,b);I("filter")},D=(P,F)=>{t(6,b[P]=F.detail,b),I("filter")},S=P=>{t(4,h=P.detail),P.detail&&t(5,_=!1),I("sort")},O=P=>{t(5,_=P.detail),P.detail&&t(4,h=!1),I("sort")},Z=(P,F)=>{if(t(7,v[P]=F.detail,v),F.detail)for(let B in v)B!=P&&t(7,v[B]=!1,v);I("sort")};return n.$$set=P=>{"optionsOpen"in P&&t(0,s=P.optionsOpen),"slotName"in P&&t(11,o=P.slotName),"elementData"in P&&t(12,r=P.elementData),"list"in P&&t(13,l=P.list)},n.$$.update=()=>{n.$$.dirty[0]&8192&&l&&(w=[...l.children])},[s,u,d,f,h,_,b,v,c,y,I,o,r,l,q,T,W,H,K,D,S,O,Z]}class lm extends Te{constructor(e){super(),Ie(this,e,rm,om,ge,{optionsOpen:0,slotName:11,elementData:12,list:13},null,[-1,-1])}}function Zr(n,e,t){const i=n.slice();return i[61]=e[t],i}function am(n){let e;return{c(){e=g("span"),e.textContent="Loading items...",m(e,"class","svelte-3qe8b")},m(t,i){M(t,e,i)},p:se,i:se,o:se,d(t){t&&R(e)}}}function cm(n){let e,t,i,s,o,r,l,a=n[3]!="sets"&&xr(n),c=Ne(n[6]),u=[];for(let f=0;f<c.length;f+=1)u[f]=$r(Zr(n,c,f));const d=f=>z(u[f],1,1,()=>{u[f]=null});return{c(){e=g("input"),t=E(),a&&a.c(),i=E(),s=g("ul");for(let f=0;f<u.length;f+=1)u[f].c();m(e,"type","text"),m(e,"class","searchBarInput"),m(e,"placeholder","Search..."),m(s,"class","svelte-3qe8b"),re(s,"no-scrollbar",n[15].length<=4)},m(f,h){M(f,e,h),n[29](e),M(f,t,h),a&&a.m(f,h),M(f,i,h),M(f,s,h);for(let _=0;_<u.length;_+=1)u[_]&&u[_].m(s,null);n[42](s),o=!0,r||(l=[N(e,"keydown",n[18]),N(e,"input",n[19]),N(s,"mouseup",n[43]),N(s,"touchend",n[44],{passive:!0}),N(s,"scroll",n[45]),N(s,"scrollend",n[46])],r=!0)},p(f,h){if(f[3]!="sets"?a?a.p(f,h):(a=xr(f),a.c(),a.m(i.parentNode,i)):a&&(a.d(1),a=null),h[0]&1197019){c=Ne(f[6]);let _;for(_=0;_<c.length;_+=1){const b=Zr(f,c,_);u[_]?(u[_].p(b,h),L(u[_],1)):(u[_]=$r(b),u[_].c(),L(u[_],1),u[_].m(s,null))}for(qe(),_=c.length;_<u.length;_+=1)d(_);We()}(!o||h[0]&32768)&&re(s,"no-scrollbar",f[15].length<=4)},i(f){if(!o){for(let h=0;h<c.length;h+=1)L(u[h]);o=!0}},o(f){u=u.filter(Boolean);for(let h=0;h<u.length;h+=1)z(u[h]);o=!1},d(f){f&&(R(e),R(t),R(i),R(s)),n[29](null),a&&a.d(f),ht(u,f),n[42](null),r=!1,be(l)}}}function xr(n){let e,t,i;return{c(){e=g("button"),e.innerHTML='<iconify-icon icon="mi:filter"></iconify-icon>',m(e,"class","optionsButton svelte-3qe8b")},m(s,o){M(s,e,o),n[30](e),t||(i=N(e,"click",n[31]),t=!0)},p:se,d(s){s&&R(e),n[30](null),t=!1,i()}}}function um(n){let e,t,i,s;function o(a){n[39](a)}function r(a){n[40](a)}let l={itemData:n[61],eqSlotName:n[3]};return n[0]!==void 0&&(l.slotOpen=n[0]),n[9]!==void 0&&(l.scrolling=n[9]),e=new K_({props:l}),le.push(()=>Pe(e,"slotOpen",o)),le.push(()=>Pe(e,"scrolling",r)),e.$on("itemSelect",n[20]),e.$on("displayInfo",n[41]),{c(){oe(e.$$.fragment)},m(a,c){ne(e,a,c),s=!0},p(a,c){const u={};c[0]&64&&(u.itemData=a[61]),c[0]&8&&(u.eqSlotName=a[3]),!t&&c[0]&1&&(t=!0,u.slotOpen=a[0],Ae(()=>t=!1)),!i&&c[0]&512&&(i=!0,u.scrolling=a[9],Ae(()=>i=!1)),e.$set(u)},i(a){s||(L(e.$$.fragment,a),s=!0)},o(a){z(e.$$.fragment,a),s=!1},d(a){ie(e,a)}}}function dm(n){let e,t,i;function s(r){n[37](r)}let o={itemData:n[61]};return n[0]!==void 0&&(o.ddOpen=n[0]),e=new em({props:o}),le.push(()=>Pe(e,"ddOpen",s)),e.$on("setSelect",n[38]),{c(){oe(e.$$.fragment)},m(r,l){ne(e,r,l),i=!0},p(r,l){const a={};l[0]&64&&(a.itemData=r[61]),!t&&l[0]&1&&(t=!0,a.ddOpen=r[0],Ae(()=>t=!1)),e.$set(a)},i(r){i||(L(e.$$.fragment,r),i=!0)},o(r){z(e.$$.fragment,r),i=!1},d(r){ie(e,r)}}}function fm(n){let e,t,i,s,o;function r(u){n[32](u)}function l(u){n[33](u)}function a(u){n[34](u)}let c={itemData:n[61],index:n[4]};return n[0]!==void 0&&(c.slotOpen=n[0]),n[1]!==void 0&&(c.weaponExpand=n[1]),n[9]!==void 0&&(c.scrolling=n[9]),e=new X_({props:c}),le.push(()=>Pe(e,"slotOpen",r)),le.push(()=>Pe(e,"weaponExpand",l)),le.push(()=>Pe(e,"scrolling",a)),e.$on("itemSelect",n[20]),e.$on("toolSelect",n[35]),e.$on("displayInfo",n[36]),{c(){oe(e.$$.fragment)},m(u,d){ne(e,u,d),o=!0},p(u,d){const f={};d[0]&64&&(f.itemData=u[61]),d[0]&16&&(f.index=u[4]),!t&&d[0]&1&&(t=!0,f.slotOpen=u[0],Ae(()=>t=!1)),!i&&d[0]&2&&(i=!0,f.weaponExpand=u[1],Ae(()=>i=!1)),!s&&d[0]&512&&(s=!0,f.scrolling=u[9],Ae(()=>s=!1)),e.$set(f)},i(u){o||(L(e.$$.fragment,u),o=!0)},o(u){z(e.$$.fragment,u),o=!1},d(u){ie(e,u)}}}function $r(n){let e,t,i,s;const o=[fm,dm,um],r=[];function l(a,c){return a[4]?0:a[3]=="sets"?1:2}return e=l(n),t=r[e]=o[e](n),{c(){t.c(),i=pt()},m(a,c){r[e].m(a,c),M(a,i,c),s=!0},p(a,c){let u=e;e=l(a),e===u?r[e].p(a,c):(qe(),z(r[u],1,1,()=>{r[u]=null}),We(),t=r[e],t?t.p(a,c):(t=r[e]=o[e](a),t.c()),L(t,1),t.m(i.parentNode,i))},i(a){s||(L(t),s=!0)},o(a){z(t),s=!1},d(a){a&&R(i),r[e].d(a)}}}function el(n){let e,t,i,s;function o(a){n[47](a)}function r(a){n[48](a)}let l={slotName:n[3],elementData:n[16]};return n[2]!==void 0&&(l.optionsOpen=n[2]),n[5]!==void 0&&(l.list=n[5]),e=new lm({props:l}),le.push(()=>Pe(e,"optionsOpen",o)),le.push(()=>Pe(e,"list",r)),e.$on("listUpdate",n[19]),{c(){oe(e.$$.fragment)},m(a,c){ne(e,a,c),s=!0},p(a,c){const u={};c[0]&8&&(u.slotName=a[3]),c[0]&65536&&(u.elementData=a[16]),!t&&c[0]&4&&(t=!0,u.optionsOpen=a[2],Ae(()=>t=!1)),!i&&c[0]&32&&(i=!0,u.list=a[5],Ae(()=>i=!1)),e.$set(u)},i(a){s||(L(e.$$.fragment,a),s=!0)},o(a){z(e.$$.fragment,a),s=!1},d(a){ie(e,a)}}}function hm(n){let e,t,i,s,o,r,l;const a=[cm,am],c=[];function u(f,h){return f[6]?0:1}t=u(n),i=c[t]=a[t](n);let d=n[3]!="sets"&&el(n);return{c(){e=g("div"),i.c(),s=E(),d&&d.c(),m(e,"class","dropdown svelte-3qe8b"),re(e,"infoDisplay",n[7])},m(f,h){M(f,e,h),c[t].m(e,null),p(e,s),d&&d.m(e,null),n[49](e),o=!0,r||(l=[N(window,"keydown",n[26]),N(window,"keyup",n[27]),N(window,"mousedown",n[28]),N(e,"transitionend",n[50]),N(e,"transitioncancel",n[51])],r=!0)},p(f,h){let _=t;t=u(f),t===_?c[t].p(f,h):(qe(),z(c[_],1,1,()=>{c[_]=null}),We(),i=c[t],i?i.p(f,h):(i=c[t]=a[t](f),i.c()),L(i,1),i.m(e,s)),f[3]!="sets"?d?(d.p(f,h),h[0]&8&&L(d,1)):(d=el(f),d.c(),L(d,1),d.m(e,null)):d&&(qe(),z(d,1,1,()=>{d=null}),We()),(!o||h[0]&128)&&re(e,"infoDisplay",f[7])},i(f){o||(L(i),L(d),o=!0)},o(f){z(i),z(d),o=!1},d(f){f&&R(e),c[t].d(),d&&d.d(),n[49](null),r=!1,be(l)}}}function pm(n,e,t){let i,s,o,r,l,a,c,u,d;Q(n,Bt,x=>t(22,o=x)),Q(n,qn,x=>t(23,r=x)),Q(n,ju,x=>t(24,l=x)),Q(n,Wn,x=>t(25,a=x)),Q(n,Nt,x=>t(54,c=x)),Q(n,zt,x=>t(55,u=x)),Q(n,qt,x=>t(56,d=x));let{slotName:f,index:h=0,slotOpen:_,weaponExpand:b=null,optionsOpen:v=!1}=e;const y=Gt();h?U(Wn,a[h]={},a):U(qn,r[f]={},r);let k=!1,w=!1,I=!1,A,q,T,W,H,K=null,D=!1,S=!1,O=[];function Z(){H&&H.classList.remove("lastElement"),t(15,O=T.querySelectorAll("li:not(.hidden)")),H=O[O.length-1],H&&H.classList.add("lastElement"),(!H||H.classList.contains("non-eligible"))&&(H=W)}function P(x){!x.shiftKey&&x.key=="Tab"&&!v&&(x.preventDefault(),setTimeout(()=>q.focus()))}function F(){H&&H.removeEventListener("keydown",P),Z(),H&&H.addEventListener("keydown",P)}function B(x){x.shiftKey&&x.key=="Tab"&&(x.preventDefault(),setTimeout(()=>(H.querySelector("button")||H).focus()))}function G(){fu(q.value,i),F()}function Y(x){y("itemSelect",x.detail.element),t(13,K=x.detail.element),D=x.detail.trusted;let Dt=T.querySelector(".selectedItem");Dt&&Dt!=x.detail.element&&Dt.classList.remove("selectedItem"),t(14,S=!0),D||(ce(),T.scrollTo(0,K.offsetTop)),setTimeout(ue)}function ue(){U(Nt,c=structuredClone(q_),c);for(let x in d)d[x].cost.min!=null&&(U(Nt,c.armor.min+=d[x].cost.min,c),U(Nt,c.armor.max+=d[x].cost.max,c));U(Nt,c.armor.avg=Math.ceil((c.armor.min+c.armor.max)/2),c);for(let x in u)u[x].cost.min!=null&&(U(Nt,c.gear.min+=u[x].cost.min,c),U(Nt,c.gear.max+=u[x].cost.max,c));U(Nt,c.gear.avg=Math.ceil((c.gear.min+c.gear.max)/2),c),U(Nt,c.total.min=c.armor.min+c.gear.min,c),U(Nt,c.total.max=c.armor.max+c.gear.max,c),U(Nt,c.total.avg=Math.ceil((c.total.min+c.total.max)/2),c)}function ce(){t(14,S=!1),t(11,q.value="",q),G()}const ee=x=>{f!="sets"&&!k&&x.shiftKey&&t(7,k=!0)},j=x=>{f!="sets"&&x.key=="Shift"&&!w&&t(7,k=!1)},J=()=>(t(7,k=!1),t(8,w=!1));function de(x){le[x?"unshift":"push"](()=>{q=x,t(11,q)})}function Be(x){le[x?"unshift":"push"](()=>{W=x,t(12,W)})}const Me=()=>t(2,v=!v);function Oe(x){_=x,t(0,_)}function nt(x){b=x,t(1,b)}function je(x){I=x,t(9,I)}const De=()=>y("toolSelect"),ze=()=>(t(7,k=!0),t(8,w=!0));function _e(x){_=x,t(0,_)}const ae=()=>t(14,S=!0);function gt(x){_=x,t(0,_)}function st(x){I=x,t(9,I)}const Ot=()=>(t(7,k=!0),t(8,w=!0));function et(x){le[x?"unshift":"push"](()=>{T=x,t(5,T)})}const ot=()=>t(7,k=!1),C=()=>t(7,k=!1),fe=()=>t(9,I=!0),he=()=>t(9,I=!1);function ye(x){v=x,t(2,v)}function Le(x){T=x,t(5,T)}function He(x){le[x?"unshift":"push"](()=>{A=x,t(10,A)})}const Ge=x=>{x.propertyName=="visibility"&&x.target==A&&(S&&ce(),!_&&K&&setTimeout(()=>T.scrollTo(0,K.offsetTop)),ts(q,_))},Ze=x=>{x.propertyName=="visibility"&&x.target==A&&(t(14,S=!1),ts(q,_))};return n.$$set=x=>{"slotName"in x&&t(3,f=x.slotName),"index"in x&&t(4,h=x.index),"slotOpen"in x&&t(0,_=x.slotOpen),"weaponExpand"in x&&t(1,b=x.weaponExpand),"optionsOpen"in x&&t(2,v=x.optionsOpen)},n.$$.update=()=>{if(n.$$.dirty[0]&58720280&&t(16,i=h?a[h]:f=="sets"?l:r[f]),n.$$.dirty[0]&4194312&&t(6,s=o[f]),n.$$.dirty[0]&96&&T){t(15,O=T.querySelectorAll("li:not(.hidden)"));for(let x=0;x<T.childElementCount;x++)t(16,i[s[x].name]=T.children[x],i);Z(),F()}},[_,b,v,f,h,T,s,k,w,I,A,q,W,K,S,O,i,y,B,G,Y,ce,o,r,l,a,ee,j,J,de,Be,Me,Oe,nt,je,De,ze,_e,ae,gt,st,Ot,et,ot,C,fe,he,ye,Le,He,Ge,Ze]}class Yo extends Te{constructor(e){super(),Ie(this,e,pm,hm,ge,{slotName:3,index:4,slotOpen:0,weaponExpand:1,optionsOpen:2},null,[-1,-1,-1])}}function tl(n){let e,t,i,s,o,r,l=n[1].name+"",a,c,u,d,f;return{c(){e=g("button"),t=g("img"),o=E(),r=g("span"),a=te(l),$e(t.src,i=n[1].image)||m(t,"src",i),m(t,"alt",s=n[1].name),m(t,"draggable","false"),m(t,"class","svelte-1bgnkwv"),m(r,"class","tooltip"),m(r,"id","left"),m(e,"class","svelte-1bgnkwv"),tt(e,"display",n[1].link?"":"none")},m(h,_){M(h,e,_),p(e,t),p(e,o),p(e,r),p(r,a),u=!0,d||(f=[N(e,"click",n[13]),N(e,"focusin",n[14]),N(e,"outroend",n[15])],d=!0)},p(h,_){(!u||_&2&&!$e(t.src,i=h[1].image))&&m(t,"src",i),(!u||_&2&&s!==(s=h[1].name))&&m(t,"alt",s),(!u||_&2)&&l!==(l=h[1].name+"")&&Ee(a,l),_&2&&tt(e,"display",h[1].link?"":"none")},i(h){u||(h&&ve(()=>{u&&(c||(c=me(e,Xe,{duration:150},!0)),c.run(1))}),u=!0)},o(h){h&&(c||(c=me(e,Xe,{duration:150},!1)),c.run(0)),u=!1},d(h){h&&R(e),h&&c&&c.end(),d=!1,be(f)}}}function _m(n){let e,t,i=n[1],s,o,r=n[0].charAt(0).toUpperCase()+n[0].slice(1)+"",l,a,c,u,d,f,h,_,b,v,y,k,w=tl(n);function I(T){n[19](T)}function A(T){n[20](T)}let q={slotName:n[0]};return n[4]!==void 0&&(q.slotOpen=n[4]),n[6]!==void 0&&(q.optionsOpen=n[6]),h=new Yo({props:q}),le.push(()=>Pe(h,"slotOpen",I)),le.push(()=>Pe(h,"optionsOpen",A)),h.$on("itemSelect",n[21]),{c(){e=g("div"),t=g("div"),w.c(),s=E(),o=g("button"),l=te(r),a=E(),c=g("iconify-icon"),u=E(),d=g("button"),d.innerHTML='<iconify-icon icon="maki:cross" class="svelte-1bgnkwv"></iconify-icon> <span class="tooltip" id="top">Clear selection</span>',f=E(),oe(h.$$.fragment),m(t,"class","eqSlotIcon ff-border svelte-1bgnkwv"),Re(c,"icon","iconamoon:arrow-down-2-fill"),Re(c,"class","svelte-1bgnkwv"),m(o,"class","ddButton svelte-1bgnkwv"),m(d,"class","clearButton svelte-1bgnkwv"),m(e,"class","eqSlotCont svelte-1bgnkwv"),re(e,"slotOpen",n[4]),re(e,"clearAllowed",n[5]&&n[7])},m(T,W){M(T,e,W),p(e,t),w.m(t,null),n[16](t),p(e,s),p(e,o),p(o,l),p(o,a),p(o,c),p(e,u),p(e,d),p(e,f),ne(h,e,null),n[22](e),v=!0,y||(k=[N(window,"mousedown",n[11]),N(window,"keydown",n[12]),N(o,"click",n[17]),N(d,"click",n[18]),N(e,"mouseenter",n[23]),N(e,"mouseleave",n[24])],y=!0)},p(T,[W]){W&2&&ge(i,i=T[1])?(qe(),z(w,1,1,se),We(),w=tl(T),w.c(),L(w,1),w.m(t,null)):w.p(T,W),(!v||W&1)&&r!==(r=T[0].charAt(0).toUpperCase()+T[0].slice(1)+"")&&Ee(l,r);const H={};W&1&&(H.slotName=T[0]),!_&&W&16&&(_=!0,H.slotOpen=T[4],Ae(()=>_=!1)),!b&&W&64&&(b=!0,H.optionsOpen=T[6],Ae(()=>b=!1)),h.$set(H),(!v||W&16)&&re(e,"slotOpen",T[4]),(!v||W&160)&&re(e,"clearAllowed",T[5]&&T[7])},i(T){v||(L(w),L(h.$$.fragment,T),v=!0)},o(T){z(w),z(h.$$.fragment,T),v=!1},d(T){T&&R(e),w.d(T),n[16](null),ie(h),n[22](null),y=!1,be(k)}}}function mm(n,e,t){let i,s,o;Q(n,qt,S=>t(10,i=S)),Q(n,yn,S=>t(8,s=S)),Q(n,X,S=>t(9,o=S));let{eqSlotName:r}=e,l,a,c=ys,u,d,f,h;const _=S=>{(!l.contains(S.target)&&!s||S.target==l||S.target==a)&&(t(4,u=!1),t(6,f=!1),S.target!=l&&S.target!=a&&t(5,d=!1))},b=S=>{S.key=="Tab"?setTimeout(()=>{t(5,d=l.contains(document.activeElement))}):S.key=="Escape"&&(t(4,u=!1),t(6,f=!1))},v=()=>{s||(t(4,u=!1),U(X,o.item.ongoing=!0,o),U(X,o.item.data={...c,slot:r,type:"eq"},o))},y=S=>{S.relatedTarget==null&&t(5,d=!0)},k=()=>{setTimeout(()=>H_(a))};function w(S){le[S?"unshift":"push"](()=>{a=S,t(3,a)})}const I=()=>{o.screenshot.ongoing||t(4,u=!u)},A=()=>{t(5,d=!1),l.classList.contains("clearAllowed")&&h.querySelector("button").click()};function q(S){u=S,t(4,u)}function T(S){f=S,t(6,f)}const W=S=>{setTimeout(()=>{t(7,h=S.detail.classList.contains("selectedItem")?S.detail:null),t(6,f=!1)})};function H(S){le[S?"unshift":"push"](()=>{l=S,t(2,l)})}const K=()=>t(5,d=!0),D=()=>{l.contains(document.activeElement)||t(5,d=!1)};return n.$$set=S=>{"eqSlotName"in S&&t(0,r=S.eqSlotName)},n.$$.update=()=>{n.$$.dirty&1027&&i[r]&&i[r].name!=c.name&&t(1,c=i[r])},[r,c,l,a,u,d,f,h,s,o,i,_,b,v,y,k,w,I,A,q,T,W,H,K,D]}class gm extends Te{constructor(e){super(),Ie(this,e,mm,_m,ge,{eqSlotName:0})}}function nl(n,e,t){const i=n.slice();return i[1]=e[t],i[2]=e,i[3]=t,i}function il(n){let e,t,i;function s(r){n[0](r,n[1],n[2],n[3])}let o={};return n[1]!==void 0&&(o.eqSlotName=n[1]),e=new gm({props:o}),le.push(()=>Pe(e,"eqSlotName",s)),{c(){oe(e.$$.fragment)},m(r,l){ne(e,r,l),i=!0},p(r,l){n=r;const a={};!t&&l&0&&(t=!0,a.eqSlotName=n[1],Ae(()=>t=!1)),e.$set(a)},i(r){i||(L(e.$$.fragment,r),i=!0)},o(r){z(e.$$.fragment,r),i=!1},d(r){ie(e,r)}}}function bm(n){let e,t,i=Ne(Array(...Gn)),s=[];for(let r=0;r<i.length;r+=1)s[r]=il(nl(n,i,r));const o=r=>z(s[r],1,1,()=>{s[r]=null});return{c(){e=g("div");for(let r=0;r<s.length;r+=1)s[r].c();m(e,"class","armorBox svelte-16092aw")},m(r,l){M(r,e,l);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null);t=!0},p(r,[l]){if(l&0){i=Ne(Array(...Gn));let a;for(a=0;a<i.length;a+=1){const c=nl(r,i,a);s[a]?(s[a].p(c,l),L(s[a],1)):(s[a]=il(c),s[a].c(),L(s[a],1),s[a].m(e,null))}for(qe(),a=i.length;a<s.length;a+=1)o(a);We()}},i(r){if(!t){for(let l=0;l<i.length;l+=1)L(s[l]);t=!0}},o(r){s=s.filter(Boolean);for(let l=0;l<s.length;l+=1)z(s[l]);t=!1},d(r){r&&R(e),ht(s,r)}}}function vm(n,e,t){function i(s,o,r,l){r[l]=s}return[i]}class ym extends Te{constructor(e){super(),Ie(this,e,vm,bm,ge,{})}}function wm(n){let e,t=(n[3]?`${Math.floor(n[5]*.675+19.8)}% Reduction`:n[5])+"",i,s,o;return{c(){e=g("span"),i=te(t),m(e,"class","statValue svelte-78f402"),m(e,"tabindex","0"),re(e,"hidden",n[2]),re(e,"negative",n[5]<0),re(e,"zero",n[5]==0),re(e,"reduction",n[3])},m(r,l){M(r,e,l),p(e,i),s||(o=[N(e,"mouseenter",n[11]),N(e,"mouseleave",n[12]),N(e,"focusin",n[13]),N(e,"focusout",n[14])],s=!0)},p(r,l){l&40&&t!==(t=(r[3]?`${Math.floor(r[5]*.675+19.8)}% Reduction`:r[5])+"")&&Ee(i,t),l&4&&re(e,"hidden",r[2]),l&32&&re(e,"negative",r[5]<0),l&32&&re(e,"zero",r[5]==0),l&8&&re(e,"reduction",r[3])},d(r){r&&R(e),s=!1,be(o)}}}function km(n){let e,t=(n[0]!="endurance"?n[5]:n[5].toFixed(2))+"",i;return{c(){e=g("span"),i=te(t),m(e,"class","statValue svelte-78f402"),re(e,"hidden",n[2]),re(e,"negative",n[5]<0),re(e,"zero",n[5]==0)},m(s,o){M(s,e,o),p(e,i)},p(s,o){o&33&&t!==(t=(s[0]!="endurance"?s[5]:s[5].toFixed(2))+"")&&Ee(i,t),o&4&&re(e,"hidden",s[2]),o&32&&re(e,"negative",s[5]<0),o&32&&re(e,"zero",s[5]==0)},d(s){s&&R(e)}}}function Cm(n){let e;return{c(){e=g("iconify-icon"),Re(e,"icon","codicon:sparkle-filled"),Re(e,"class","svelte-78f402")},m(t,i){M(t,e,i)},p:se,d(t){t&&R(e)}}}function Em(n){let e,t=`${n[1]} Bonus`,i;return{c(){e=g("span"),i=te(t),m(e,"class","statName svelte-78f402")},m(s,o){M(s,e,o),p(e,i)},p(s,o){o&2&&t!==(t=`${s[1]} Bonus`)&&Ee(i,t)},d(s){s&&R(e)}}}function Sm(n){let e,t,i,s,o,r,l;function a(_,b){return _[0]!="armor"?km:wm}let c=a(n),u=c(n);function d(_,b){if(_[2])return Em;if(_[4])return Cm}let f=d(n),h=f&&f(n);return{c(){e=g("div"),t=g("img"),s=E(),u.c(),o=E(),h&&h.c(),$e(t.src,i="stats/"+n[0]+".svg")||m(t,"src",i),m(t,"alt",n[1]),m(t,"class","svelte-78f402"),m(e,"id",n[0]),m(e,"class","svelte-78f402"),re(e,"hidden",n[5]==0)},m(_,b){M(_,e,b),p(e,t),p(e,s),u.m(e,null),p(e,o),h&&h.m(e,null),r||(l=[N(t,"mouseenter",n[9]),N(t,"mouseleave",n[10])],r=!0)},p(_,[b]){b&1&&!$e(t.src,i="stats/"+_[0]+".svg")&&m(t,"src",i),b&2&&m(t,"alt",_[1]),c===(c=a(_))&&u?u.p(_,b):(u.d(1),u=c(_),u&&(u.c(),u.m(e,o))),f===(f=d(_))&&h?h.p(_,b):(h&&h.d(1),h=f&&f(_),h&&(h.c(),h.m(e,null))),b&1&&m(e,"id",_[0]),b&32&&re(e,"hidden",_[5]==0)},i:se,o:se,d(_){_&&R(e),u.d(),h&&h.d(),r=!1,be(l)}}}function Im(n,e,t){let i,s,o,r;Q(n,Bt,k=>t(6,s=k)),Q(n,Mn,k=>t(7,o=k)),Q(n,bt,k=>t(8,r=k));let{codeName:l,formalName:a}=e,c,u,d=!1;const f=()=>t(2,c=!0),h=()=>t(2,c=!1),_=()=>t(3,u=!0),b=()=>t(3,u=!1),v=()=>t(3,u=!0),y=()=>t(3,u=!1);return n.$$set=k=>{"codeName"in k&&t(0,l=k.codeName),"formalName"in k&&t(1,a=k.formalName)},n.$$.update=()=>{if(n.$$.dirty&257&&t(5,i=r[l]),n.$$.dirty&193)for(let k in o)if(o[k]&&s.bonuses.find(w=>w.name==k).stats[l]!=0){t(4,d=!0);break}else t(4,d=!1)},[l,a,c,u,d,i,s,o,r,f,h,_,b,v,y]}class Tm extends Te{constructor(e){super(),Ie(this,e,Im,Sm,ge,{codeName:0,formalName:1})}}function sl(n,e,t){const i=n.slice();return i[8]=e[t][0],i[9]=e[t][1],i[10]=e,i[11]=t,i}function ol(n){let e,t,i,s;function o(a){n[4](a,n[8],n[10],n[11])}function r(a){n[5](a,n[9],n[10],n[11])}let l={};return n[8]!==void 0&&(l.codeName=n[8]),n[9]!==void 0&&(l.formalName=n[9]),e=new Tm({props:l}),le.push(()=>Pe(e,"codeName",o)),le.push(()=>Pe(e,"formalName",r)),{c(){oe(e.$$.fragment)},m(a,c){ne(e,a,c),s=!0},p(a,c){n=a;const u={};!t&&c&0&&(t=!0,u.codeName=n[8],Ae(()=>t=!1)),!i&&c&0&&(i=!0,u.formalName=n[9],Ae(()=>i=!1)),e.$set(u)},i(a){s||(L(e.$$.fragment,a),s=!0)},o(a){z(e.$$.fragment,a),s=!1},d(a){ie(e,a)}}}function rl(n){let e,t,i,s,o=n[2]?"Copied!":`Copy ${n[1]?"all":""} as text`,r,l,a,c,u;return{c(){e=g("button"),t=g("iconify-icon"),i=E(),s=g("span"),r=te(o),Re(t,"icon","ic:round-content-copy"),Re(t,"class","svelte-cimkzy"),m(s,"class","tooltip"),m(s,"id","top"),m(e,"class","copyStatsButton svelte-cimkzy")},m(d,f){M(d,e,f),p(e,t),p(e,i),p(e,s),p(s,r),a=!0,c||(u=N(e,"click",n[6]),c=!0)},p(d,f){(!a||f&6)&&o!==(o=d[2]?"Copied!":`Copy ${d[1]?"all":""} as text`)&&Ee(r,o)},i(d){a||(d&&ve(()=>{a&&(l||(l=me(e,Xe,{duration:100},!0)),l.run(1))}),a=!0)},o(d){d&&(l||(l=me(e,Xe,{duration:100},!1)),l.run(0)),a=!1},d(d){d&&R(e),d&&l&&l.end(),c=!1,u()}}}function Nm(n){let e;return{c(){e=g("span"),e.textContent="Show all stats",m(e,"slot","tooltip"),m(e,"class","tooltip"),m(e,"id","top")},m(t,i){M(t,e,i)},p:se,d(t){t&&R(e)}}}function Om(n){let e,t,i,s,o,r=Ne(Object.entries(Wt)),l=[];for(let u=0;u<r.length;u+=1)l[u]=ol(sl(n,r,u));const a=u=>z(l[u],1,1,()=>{l[u]=null});let c=n[3]&&rl(n);return s=new mt({props:{text:"",$$slots:{tooltip:[Nm]},$$scope:{ctx:n}}}),s.$on("toggle",n[7]),{c(){e=g("div");for(let u=0;u<l.length;u+=1)l[u].c();t=E(),c&&c.c(),i=E(),oe(s.$$.fragment),m(e,"class","statBox svelte-cimkzy"),re(e,"showAll",n[1])},m(u,d){M(u,e,d);for(let f=0;f<l.length;f+=1)l[f]&&l[f].m(e,null);p(e,t),c&&c.m(e,null),p(e,i),ne(s,e,null),o=!0},p(u,[d]){if(d&0){r=Ne(Object.entries(Wt));let h;for(h=0;h<r.length;h+=1){const _=sl(u,r,h);l[h]?(l[h].p(_,d),L(l[h],1)):(l[h]=ol(_),l[h].c(),L(l[h],1),l[h].m(e,t))}for(qe(),h=r.length;h<l.length;h+=1)a(h);We()}u[3]?c?(c.p(u,d),d&8&&L(c,1)):(c=rl(u),c.c(),L(c,1),c.m(e,i)):c&&(qe(),z(c,1,1,()=>{c=null}),We());const f={};d&4096&&(f.$$scope={dirty:d,ctx:u}),s.$set(f),(!o||d&2)&&re(e,"showAll",u[1])},i(u){if(!o){for(let d=0;d<r.length;d+=1)L(l[d]);L(c),L(s.$$.fragment,u),o=!0}},o(u){l=l.filter(Boolean);for(let d=0;d<l.length;d+=1)z(l[d]);z(c),z(s.$$.fragment,u),o=!1},d(u){u&&R(e),ht(l,u),c&&c.d(),ie(s)}}}function Dm(n,e,t){let i;Q(n,bt,d=>t(0,i=d));let s=!1,o=!1,r=!1;function l(d,f,h,_){h[_][0]=d}function a(d,f,h,_){h[_][1]=d}const c=d=>{if(on(d),o)return;let f="";for(let[h,_]of Object.entries(Wt)){let b=h=="armor"?"":`
`,v=i[h];h=="armor"?v+=` (${Math.floor(v*.675+19.8)}% Reduction)`:h=="endurance"?v=v.toFixed(2)+"%":h=="ammoReturn"&&(v+="%"),(s||!s&&i[h])&&(f+=`${b}${_}: ${v}`)}navigator.clipboard.writeText(f),t(2,o=!0),setTimeout(()=>t(2,o=!1),1e3)},u=d=>t(1,s=d.detail);return n.$$.update=()=>{if(n.$$.dirty&1&&i){t(3,r=!1);for(let d in i)if(i[d]){t(3,r=!0);break}}},[i,s,o,r,l,a,c,u]}class Rm extends Te{constructor(e){super(),Ie(this,e,Dm,Om,ge,{})}}function Am(n){let e,t,i,s,o,r,l,a,c,u;return{c(){e=g("div"),t=g("button"),t.textContent="-",i=E(),s=g("input"),o=E(),r=g("b"),r.textContent="%",l=E(),a=g("button"),a.textContent="+",m(t,"id","decrease"),m(t,"class","svelte-f5qib2"),m(s,"type","number"),m(s,"placeholder","0"),m(s,"class","svelte-f5qib2"),m(r,"class","svelte-f5qib2"),m(a,"id","increase"),m(a,"class","svelte-f5qib2"),m(e,"class","svelte-f5qib2"),re(e,"non-percent",!n[1])},m(d,f){M(d,e,f),p(e,t),p(e,i),p(e,s),jt(s,n[0]),p(e,o),p(e,r),p(e,l),p(e,a),c||(u=[N(t,"click",n[4]),N(s,"input",n[5]),N(s,"input",n[2]),N(a,"click",n[6])],c=!0)},p(d,[f]){f&1&&_a(s.value)!==d[0]&&jt(s,d[0])},i:se,o:se,d(d){d&&R(e),c=!1,be(u)}}}function Pm(n,e,t){let{weaponName:i,value:s}=e,o=i!="Nature's Wrath Spellbook",r;o?(s=100,r=100):(s=4,r=4);function l(){s<0?t(0,s=0):s>r&&t(0,s=r),s%1!=0&&t(0,s=Math.floor(s))}const a=()=>{t(0,s--,s),l()};function c(){s=_a(this.value),t(0,s)}const u=()=>{t(0,s++,s),l()};return n.$$set=d=>{"weaponName"in d&&t(3,i=d.weaponName),"value"in d&&t(0,s=d.value)},[s,o,l,i,a,c,u]}class Mm extends Te{constructor(e){super(),Ie(this,e,Pm,Am,ge,{weaponName:3,value:0})}}function ll(n,e,t){const i=n.slice();i[53]=e[t];const s=i[53].name.includes("Fantastic Beamstorm")?"~":"";i[23]=s;const o=i[24].includes(i[53].name);return i[54]=o,i}function Lm(n){let e,t,i=n[2].description+"",s,o;return{c(){e=g("span"),t=te('"'),s=te(i),o=te('"'),m(e,"id","toolDesc"),m(e,"class","svelte-12jhw87")},m(r,l){M(r,e,l),p(e,t),p(e,s),p(e,o)},p(r,l){l[0]&4&&i!==(i=r[2].description+"")&&Ee(s,i)},d(r){r&&R(e)}}}function Fm(n){let e,t,i,s=`${n[5]?"Type":n[3].name}:`,o,r,l=n[20],a,c,u,d,f,h=n[5]?"Return":"Expand",_,b,v,y,k=cl(n),w=n[4]&&ul(n);return{c(){e=g("button"),t=g("div"),i=g("span"),o=te(s),r=E(),k.c(),c=E(),w&&w.c(),u=E(),d=g("span"),f=te("("),_=te(h),b=te(")"),m(i,"class","svelte-12jhw87"),tt(i,"font-size",Object.keys(n[21]).includes(n[3].name)?`calc(1rem * ${n[21][n[3].name]})`:""),m(t,"id",a=n[5]?"":"basic"),m(t,"class","svelte-12jhw87"),m(d,"class","tooltip svelte-12jhw87"),m(d,"id","top"),m(e,"class","gearPreview svelte-12jhw87"),tt(e,"line-height",`${n[10]/6.5}px`)},m(I,A){M(I,e,A),p(e,t),p(t,i),p(i,o),p(t,r),k.m(t,null),p(e,c),w&&w.m(e,null),p(e,u),p(e,d),p(d,f),p(d,_),p(d,b),n[36](e),v||(y=N(e,"click",n[37]),v=!0)},p(I,A){A[0]&40&&s!==(s=`${I[5]?"Type":I[3].name}:`)&&Ee(o,s),A[0]&2097160&&tt(i,"font-size",Object.keys(I[21]).includes(I[3].name)?`calc(1rem * ${I[21][I[3].name]})`:""),A[0]&1048576&&ge(l,l=I[20])?(k.d(1),k=cl(I),k.c(),k.m(t,null)):k.p(I,A),A[0]&32&&a!==(a=I[5]?"":"basic")&&m(t,"id",a),I[4]?w?w.p(I,A):(w=ul(I),w.c(),w.m(e,u)):w&&(w.d(1),w=null),A[0]&32&&h!==(h=I[5]?"Return":"Expand")&&Ee(_,h),A[0]&1024&&tt(e,"line-height",`${I[10]/6.5}px`)},d(I){I&&R(e),k.d(I),w&&w.d(),n[36](null),v=!1,y()}}}function al(n){let e;return{c(){e=g("iconify-icon"),Re(e,"icon","codicon:sparkle-filled"),Re(e,"class","svelte-12jhw87")},m(t,i){M(t,e,i)},d(t){t&&R(e)}}}function cl(n){let e,t,i=(n[5]?n[2].info.type.replace("/","<b>,</b><br/>"):n[26](n[3]))+"",s,o=!n[5]&&n[6].basic&&al();return{c(){e=g("span"),t=new Ou(!1),s=E(),o&&o.c(),t.a=s,m(e,"class","svelte-12jhw87")},m(r,l){M(r,e,l),t.m(i,e),p(e,s),o&&o.m(e,null)},p(r,l){l[0]&44&&i!==(i=(r[5]?r[2].info.type.replace("/","<b>,</b><br/>"):r[26](r[3]))+"")&&t.p(i),!r[5]&&r[6].basic?o||(o=al(),o.c(),o.m(e,null)):o&&(o.d(1),o=null)},d(r){r&&R(e),o&&o.d()}}}function ul(n){let e,t,i,s=`${n[5]?"Special":n[4].name.split(" (")[0]}:`,o,r,l,a=n[20],c,u=!n[5]&&dl(n),d=pl(n);return{c(){e=g("div"),t=g("span"),i=g("span"),o=te(s),r=E(),u&&u.c(),l=E(),d.c(),m(i,"class","svelte-12jhw87"),m(t,"class","svelte-12jhw87"),tt(t,"font-size",Object.keys(n[21]).includes(n[4].name)?`calc(1rem * ${n[21][n[4].name]})`:""),m(e,"id",c=n[5]?"":"special"),m(e,"class","svelte-12jhw87")},m(f,h){M(f,e,h),p(e,t),p(t,i),p(i,o),p(t,r),u&&u.m(t,null),p(e,l),d.m(e,null)},p(f,h){h[0]&48&&s!==(s=`${f[5]?"Special":f[4].name.split(" (")[0]}:`)&&Ee(o,s),f[5]?u&&(u.d(1),u=null):u?u.p(f,h):(u=dl(f),u.c(),u.m(t,null)),h[0]&2097168&&tt(t,"font-size",Object.keys(f[21]).includes(f[4].name)?`calc(1rem * ${f[21][f[4].name]})`:""),h[0]&1048576&&ge(a,a=f[20])?(d.d(1),d=pl(f),d.c(),d.m(e,null)):d.p(f,h),h[0]&32&&c!==(c=f[5]?"":"special")&&m(e,"id",c)},d(f){f&&R(e),u&&u.d(),d.d(f)}}}function dl(n){let e,t,i=n[4].cd+"",s,o;return{c(){e=g("span"),t=te("("),s=te(i),o=te("s cd.)"),m(e,"id","cd"),m(e,"class","svelte-12jhw87")},m(r,l){M(r,e,l),p(e,t),p(e,s),p(e,o)},p(r,l){l[0]&16&&i!==(i=r[4].cd+"")&&Ee(s,i)},d(r){r&&R(e)}}}function fl(n){let e,t;return{c(){e=g("span"),t=te(n[23]),m(e,"id","prefix"),m(e,"class","svelte-12jhw87")},m(i,s){M(i,e,s),p(e,t)},p(i,s){s[0]&8388608&&Ee(t,i[23])},d(i){i&&R(e)}}}function hl(n){let e;return{c(){e=g("iconify-icon"),Re(e,"icon","codicon:sparkle-filled"),Re(e,"class","svelte-12jhw87")},m(t,i){M(t,e,i)},d(t){t&&R(e)}}}function pl(n){let e,t,i=(n[5]?n[2].info.special:n[26](n[4]))+"",s,o,r=n[23]&&!n[5]&&fl(n),l=!n[5]&&n[6].special&&hl();return{c(){e=g("span"),r&&r.c(),t=E(),s=te(i),o=E(),l&&l.c(),m(e,"class","svelte-12jhw87")},m(a,c){M(a,e,c),r&&r.m(e,null),p(e,t),p(e,s),p(e,o),l&&l.m(e,null)},p(a,c){a[23]&&!a[5]?r?r.p(a,c):(r=fl(a),r.c(),r.m(e,t)):r&&(r.d(1),r=null),c[0]&52&&i!==(i=(a[5]?a[2].info.special:a[26](a[4]))+"")&&Ee(s,i),!a[5]&&a[6].special?l||(l=hl(),l.c(),l.m(e,null)):l&&(l.d(1),l=null)},d(a){a&&R(e),r&&r.d(),l&&l.d()}}}function _l(n){let e,t,i,s,o,r,l=n[2].name+"",a,c,u,d,f,h;return{c(){e=g("button"),t=g("img"),o=E(),r=g("span"),a=te(l),$e(t.src,i=n[2].image)||m(t,"src",i),m(t,"alt",s=n[2].name),m(t,"draggable","false"),m(t,"class","svelte-12jhw87"),m(r,"class","tooltip svelte-12jhw87"),m(r,"id",c=n[19].screenshot.ongoing?"right":"top"),m(e,"class","svelte-12jhw87"),tt(e,"display",n[2].link?"":"none"),tt(e,"border-radius",n[2].tool?"calc(1rem)":"")},m(_,b){M(_,e,b),p(e,t),p(e,o),p(e,r),p(r,a),d=!0,f||(h=N(e,"click",n[38]),f=!0)},p(_,b){(!d||b[0]&4&&!$e(t.src,i=_[2].image))&&m(t,"src",i),(!d||b[0]&4&&s!==(s=_[2].name))&&m(t,"alt",s),(!d||b[0]&4)&&l!==(l=_[2].name+"")&&Ee(a,l),(!d||b[0]&524288&&c!==(c=_[19].screenshot.ongoing?"right":"top"))&&m(r,"id",c),b[0]&4&&tt(e,"display",_[2].link?"":"none"),b[0]&4&&tt(e,"border-radius",_[2].tool?"calc(1rem)":"")},i(_){d||(_&&ve(()=>{d&&(u||(u=me(e,Xe,{duration:150},!0)),u.run(1))}),d=!0)},o(_){_&&(u||(u=me(e,Xe,{duration:150},!1)),u.run(0)),d=!1},d(_){_&&R(e),_&&u&&u.end(),f=!1,h()}}}function ml(n){let e,t,i,s,o,r,l,a,c,u;i=new mt({props:{text:"Toggle base values",checked:n[16]}}),i.$on("toggle",n[47]),o=new mt({props:{text:"Eyeball of Reckoning buff",checked:n[17]}}),o.$on("toggle",n[48]);let d=Ne(n[2].moves),f=[];for(let _=0;_<d.length;_+=1)f[_]=wl(ll(n,d,_));const h=_=>z(f[_],1,1,()=>{f[_]=null});return{c(){e=g("div"),t=g("div"),oe(i.$$.fragment),s=E(),oe(o.$$.fragment),r=E(),l=g("div");for(let _=0;_<f.length;_+=1)f[_].c();m(t,"class","weaponToggles svelte-12jhw87"),m(l,"class","weaponMoves svelte-12jhw87"),m(e,"class","fullWeaponView svelte-12jhw87")},m(_,b){M(_,e,b),p(e,t),ne(i,t,null),p(t,s),ne(o,t,null),p(e,r),p(e,l);for(let v=0;v<f.length;v+=1)f[v]&&f[v].m(l,null);u=!0},p(_,b){const v={};b[0]&65536&&(v.checked=_[16]),i.$set(v);const y={};if(b[0]&131072&&(y.checked=_[17]),o.$set(y),b[0]&219611268){d=Ne(_[2].moves);let k;for(k=0;k<d.length;k+=1){const w=ll(_,d,k);f[k]?(f[k].p(w,b),L(f[k],1)):(f[k]=wl(w),f[k].c(),L(f[k],1),f[k].m(l,null))}for(qe(),k=d.length;k<f.length;k+=1)h(k);We()}},i(_){if(!u){L(i.$$.fragment,_),L(o.$$.fragment,_);for(let b=0;b<d.length;b+=1)L(f[b]);_&&ve(()=>{u&&(c&&c.end(1),a=va(e,Xe,{duration:150,delay:300}),a.start())}),u=!0}},o(_){z(i.$$.fragment,_),z(o.$$.fragment,_),f=f.filter(Boolean);for(let b=0;b<f.length;b+=1)z(f[b]);a&&a.invalidate(),_&&(c=ya(e,Xe,{duration:150})),u=!1},d(_){_&&R(e),ie(i),ie(o),ht(f,_),_&&c&&c.end()}}}function gl(n){let e,t,i,s;function o(a){n[49](a)}function r(a){n[50](a)}let l={};return n[7]!==void 0&&(l.value=n[7]),n[2].name!==void 0&&(l.weaponName=n[2].name),e=new Mm({props:l}),le.push(()=>Pe(e,"value",o)),le.push(()=>Pe(e,"weaponName",r)),{c(){oe(e.$$.fragment)},m(a,c){ne(e,a,c),s=!0},p(a,c){const u={};!t&&c[0]&128&&(t=!0,u.value=a[7],Ae(()=>t=!1)),!i&&c[0]&4&&(i=!0,u.weaponName=a[2].name,Ae(()=>i=!1)),e.$set(u)},i(a){s||(L(e.$$.fragment,a),s=!0)},o(a){z(e.$$.fragment,a),s=!1},d(a){ie(e,a)}}}function bl(n){let e,t,i=n[53].cd+"",s,o;return{c(){e=g("span"),t=te("("),s=te(i),o=te("s cd.)"),m(e,"id","cd"),m(e,"class","svelte-12jhw87")},m(r,l){M(r,e,l),p(e,t),p(e,s),p(e,o)},p(r,l){l[0]&4&&i!==(i=r[53].cd+"")&&Ee(s,i)},d(r){r&&R(e)}}}function vl(n){let e;return{c(){e=g("iconify-icon"),Re(e,"icon","codicon:sparkle-filled"),Re(e,"class","svelte-12jhw87")},m(t,i){M(t,e,i)},d(t){t&&R(e)}}}function yl(n){let e,t=n[23]+(n[16]&&!n[54]?n[53].base:n[54]?n[27](n[53]):n[26](n[53]))+"",i,s,o=n[18][n[53].name]&&!n[16]&&vl();return{c(){e=g("span"),i=te(t),s=E(),o&&o.c(),m(e,"class","svelte-12jhw87")},m(r,l){M(r,e,l),p(e,i),p(e,s),o&&o.m(e,null)},p(r,l){l[0]&65540&&t!==(t=r[23]+(r[16]&&!r[54]?r[53].base:r[54]?r[27](r[53]):r[26](r[53]))+"")&&Ee(i,t),r[18][r[53].name]&&!r[16]?o||(o=vl(),o.c(),o.m(e,null)):o&&(o.d(1),o=null)},d(r){r&&R(e),o&&o.d()}}}function wl(n){let e,t,i,s,o,r=(n[54]&&n[2].name=="Nature's Wrath Spellbook"?n[53].name.replace("Charged","Charge(s)"):n[53].name)+":",l,a,c,u=n[54]?[n[20],n[7],n[17]]:[n[20],n[17]],d,f,h=n[54]&&gl(n),_=n[53].special&&bl(n),b=yl(n);return{c(){e=g("div"),t=g("div"),i=g("span"),s=g("span"),h&&h.c(),o=E(),l=te(r),a=E(),_&&_.c(),c=E(),b.c(),d=E(),m(s,"class","flex fd-col svelte-12jhw87"),m(i,"class","flex fd-col ai-center svelte-12jhw87"),m(t,"class","ff-border svelte-12jhw87"),m(e,"class","svelte-12jhw87")},m(v,y){M(v,e,y),p(e,t),p(t,i),p(i,s),h&&h.m(s,null),p(s,o),p(s,l),p(i,a),_&&_.m(i,null),p(t,c),b.m(t,null),p(e,d),f=!0},p(v,y){v[54]?h?(h.p(v,y),y[0]&4&&L(h,1)):(h=gl(v),h.c(),L(h,1),h.m(s,o)):h&&(qe(),z(h,1,1,()=>{h=null}),We()),(!f||y[0]&4)&&r!==(r=(v[54]&&v[2].name=="Nature's Wrath Spellbook"?v[53].name.replace("Charged","Charge(s)"):v[53].name)+":")&&Ee(l,r),v[53].special?_?_.p(v,y):(_=bl(v),_.c(),_.m(i,null)):_&&(_.d(1),_=null),y[0]&1179780&&ge(u,u=v[54]?[v[20],v[7],v[17]]:[v[20],v[17]])?(b.d(1),b=yl(v),b.c(),b.m(t,null)):b.p(v,y)},i(v){f||(L(h),f=!0)},o(v){z(h),f=!1},d(v){v&&R(e),h&&h.d(),_&&_.d(),b.d(v)}}}function Bm(n){let e,t,i,s,o="Gear"+(n[19].screenshot.ongoing?":":""),r,l,a,c,u,d=n[2],f,h,_,b,v,y,k,w,I,A,q,T;function W(B,G){if(B[2].name&&!B[2].tool)return Fm;if(B[2].tool)return Lm}let H=W(n),K=H&&H(n),D=_l(n);function S(B){n[42](B)}function O(B){n[43](B)}function Z(B){n[44](B)}let P={slotName:n[0],index:n[1]};n[14]!==void 0&&(P.slotOpen=n[14]),n[5]!==void 0&&(P.weaponExpand=n[5]),n[15]!==void 0&&(P.optionsOpen=n[15]),b=new Yo({props:P}),le.push(()=>Pe(b,"slotOpen",S)),le.push(()=>Pe(b,"weaponExpand",O)),le.push(()=>Pe(b,"optionsOpen",Z)),b.$on("itemSelect",n[45]),b.$on("toolSelect",n[28]);let F=n[5]&&ml(n);return{c(){e=g("div"),t=g("button"),i=g("iconify-icon"),s=E(),r=te(o),l=E(),a=g("div"),K&&K.c(),c=E(),u=g("div"),D.c(),_=E(),oe(b.$$.fragment),w=E(),F&&F.c(),I=pt(),Re(i,"icon","iconamoon:arrow-down-2-fill"),Re(i,"class","svelte-12jhw87"),m(t,"class","ddButton svelte-12jhw87"),m(u,"class","gearSlotIcon svelte-12jhw87"),ve(()=>n[39].call(u)),tt(u,"min-width",`${n[11]}px`),m(a,"class","gearInfoCont ff-border svelte-12jhw87"),ve(()=>n[41].call(a)),tt(a,"justify-content",n[2].name?"":"flex-end"),m(e,"class","gearSlot svelte-12jhw87"),re(e,"slotOpen",n[14]),re(e,"weapon-expand",n[5])},m(B,G){M(B,e,G),p(e,t),p(t,i),p(t,s),p(t,r),n[34](t),p(e,l),p(e,a),K&&K.m(a,null),p(a,c),p(a,u),D.m(u,null),f=rn(u,n[39].bind(u)),n[40](a),h=rn(a,n[41].bind(a)),p(e,_),ne(b,e,null),n[46](e),M(B,w,G),F&&F.m(B,G),M(B,I,G),A=!0,q||(T=[N(window,"mousedown",n[32]),N(window,"keydown",n[33]),N(t,"click",n[35])],q=!0)},p(B,G){(!A||G[0]&524288)&&o!==(o="Gear"+(B[19].screenshot.ongoing?":":""))&&Ee(r,o),H===(H=W(B))&&K?K.p(B,G):(K&&K.d(1),K=H&&H(B),K&&(K.c(),K.m(a,c))),G[0]&4&&ge(d,d=B[2])?(qe(),z(D,1,1,se),We(),D=_l(B),D.c(),L(D,1),D.m(u,null)):D.p(B,G),G[0]&2048&&tt(u,"min-width",`${B[11]}px`),G[0]&4&&tt(a,"justify-content",B[2].name?"":"flex-end");const Y={};G[0]&1&&(Y.slotName=B[0]),G[0]&2&&(Y.index=B[1]),!v&&G[0]&16384&&(v=!0,Y.slotOpen=B[14],Ae(()=>v=!1)),!y&&G[0]&32&&(y=!0,Y.weaponExpand=B[5],Ae(()=>y=!1)),!k&&G[0]&32768&&(k=!0,Y.optionsOpen=B[15],Ae(()=>k=!1)),b.$set(Y),(!A||G[0]&16384)&&re(e,"slotOpen",B[14]),(!A||G[0]&32)&&re(e,"weapon-expand",B[5]),B[5]?F?(F.p(B,G),G[0]&32&&L(F,1)):(F=ml(B),F.c(),L(F,1),F.m(I.parentNode,I)):F&&(qe(),z(F,1,1,()=>{F=null}),We())},i(B){A||(L(D),L(b.$$.fragment,B),L(F),A=!0)},o(B){z(D),z(b.$$.fragment,B),z(F),A=!1},d(B){B&&(R(e),R(w),R(I)),n[34](null),K&&K.d(),D.d(B),f(),n[40](null),h(),ie(b),n[46](null),F&&F.d(B),q=!1,be(T)}}}function qm(n,e,t){let i,s,o,r,l,a,c;Q(n,Mn,C=>t(30,i=C)),Q(n,zt,C=>t(31,s=C)),Q(n,Bt,C=>t(51,o=C)),Q(n,X,C=>t(19,r=C)),Q(n,bt,C=>t(20,l=C)),Q(n,Cs,C=>t(21,a=C)),Q(n,yn,C=>t(22,c=C));let{gearBox:u,slotName:d,index:f}=e,h,_,b,v,y,k,w,I=ws,A,q,T,W,H,K=!1,D=!1,S="",O=["Charged Basic Attack","Charged Solar Beam"],Z={basic:!1,special:!1},P={};function F(){if(w)for(let C of w.querySelectorAll(".gearPreview > div")){if(Object.keys(a).includes(C.id=="basic"?A.name:q?q.name:null))return;let fe=j_(C,c);fe&&(C.id=="basic"?U(Cs,a[A.name]=fe,a):U(Cs,a[q.name]=fe,a))}}function B(C){let fe;if(C.name=="Void Needle")fe=C.base+l[C.type]-l.armor*5.625;else if(I.name=="Pureblood Dagger"){let he,ye={magicDmg:l.magicDmg,meleeDmg:l.meleeDmg,rangedDmg:l.rangedDmg},Le=Object.keys(ye).reduce((Ge,Ze)=>ye[Ge]>ye[Ze]?Ge:Ze),He=0;for(let Ge in ye)Ge!=Le&&(He+=ye[Ge]);he=l[Le]*2-He,fe=C.base+(C.name.includes("HP")?he/2:he)}else if(C.type.includes("/")){let he=C.type.split("/"),ye=0;for(let Le of he)ye+=l[Le]*C[`${Le}Mult`];fe=C.base+ye}else fe=C.base+l[C.type]*C.mult;return D&&(!C.name.includes("HP")||C.name.includes("HP")&&I.name=="Pureblood Dagger")&&(fe+=fe*.08775),H?Math.floor(fe*10)/10:Math.floor(fe)}function G(C){let fe,he=K?0:l[C.type];return I.name=="Celestial Powers Spellbook"?fe=(80+he*1.1)*(.8+2.2*h/100):I.name=="Staff of Dreams"?fe=160+160*h/100+he*(.4+1.3*h/100):I.name=="Nature's Wrath Spellbook"&&(fe=260+400*h/4+he*(1+1.5*h/4)),D&&(fe+=fe*.08775),Math.floor(fe*10)/10}function Y(){r.screenshot.ongoing||(t(16,K=!1),t(17,D=!1),H?(t(5,H=!1),u.classList.remove("weapon-expand"),setTimeout(F)):(u.classList.add("weapon-expand"),t(5,H=!0)))}function ue(C,fe){e:for(let he in i){let ye=o.bonuses.find(He=>He.name==he).stats,Le=C?C.type:null;for(let He in Wt){if(Le===null)break e;if(I.name=="Void Spike Ultradagger"&&fe=="special"||C.name=="Void Needle"?Le="armor/meleeDmg":I.name=="Pureblood Dagger"?Le=he=="Fish of Rage"?"":"magicDmg/meleeDmg/rangedDmg":I.name=="Gnome Rocket Launcher"&&(Le=""),i[he]&&ye[He]!=0&&Le.includes(He)){t(18,P[C.name]=!0,P),fe&&t(6,Z[fe]=!0,Z);break e}else t(18,P[C.name]=!1,P),fe&&t(6,Z[fe]=!1,Z)}}}const ce=C=>{(!_.contains(C.target)&&!c||_.contains(C.target)&&b.contains(C.target))&&(t(14,T=!1),t(15,W=!1))},ee=C=>{C.key=="Escape"&&(t(14,T=!1),t(15,W=!1))};function j(C){le[C?"unshift":"push"](()=>{k=C,t(12,k)})}const J=()=>{r.screenshot.ongoing||t(14,T=!T)};function de(C){le[C?"unshift":"push"](()=>{w=C,t(13,w)})}const Be=C=>{on(C),Y()},Me=()=>{c||(U(X,r.item.ongoing=!0,r),U(X,r.item.data={...I,type:"gear"},r))};function Oe(){y=this.offsetHeight,t(11,y)}function nt(C){le[C?"unshift":"push"](()=>{b=C,t(9,b)})}function je(){v=this.offsetHeight,t(10,v)}function De(C){T=C,t(14,T)}function ze(C){H=C,t(5,H)}function _e(C){W=C,t(15,W)}const ae=()=>{setTimeout(()=>{F(),(!I.name||I.tool)&&H&&Y(),t(15,W=!1)})};function gt(C){le[C?"unshift":"push"](()=>{_=C,t(8,_)})}const st=C=>{t(16,K=C.detail),C.detail&&t(17,D=!1)},Ot=C=>{t(17,D=C.detail),C.detail&&t(16,K=!1)};function et(C){h=C,t(7,h)}function ot(C){n.$$.not_equal(I.name,C)&&(I.name=C,t(2,I),t(31,s),t(1,f),t(4,q))}return n.$$set=C=>{"gearBox"in C&&t(29,u=C.gearBox),"slotName"in C&&t(0,d=C.slotName),"index"in C&&t(1,f=C.index)},n.$$.update=()=>{if(n.$$.dirty[0]&22|n.$$.dirty[1]&1&&s[f]&&s[f].name!=I.name&&(t(2,I=s[f]),!I.tool&&I.name)){t(3,A=I.moves.filter(C=>C.basic)[0]),t(4,q=I.moves.filter(C=>C.special)[0]),t(18,P={});for(let C of I.moves)t(18,P[C.name]=!1,P),ue(C);q&&q.name.includes("Fantastic Beamstorm")?t(23,S="~"):t(23,S="")}if(n.$$.dirty[0]&1073741948&&(i||H)&&!I.tool&&I.name){for(let C in Z)ue(C=="basic"?A:q||null,C);for(let C of I.moves)ue(C)}},[d,f,I,A,q,H,Z,h,_,b,v,y,k,w,T,W,K,D,P,r,l,a,c,S,O,F,B,G,Y,u,i,s,ce,ee,j,J,de,Be,Me,Oe,nt,je,De,ze,_e,ae,gt,st,Ot,et,ot]}class Wm extends Te{constructor(e){super(),Ie(this,e,qm,Bm,ge,{gearBox:29,slotName:0,index:1},null,[-1,-1])}}function kl(n,e,t){const i=n.slice();return i[3]=e[t],i}function Cl(n){let e,t,i;function s(r){n[1](r)}let o={slotName:"gear",index:n[3]};return n[0]!==void 0&&(o.gearBox=n[0]),e=new Wm({props:o}),le.push(()=>Pe(e,"gearBox",s)),{c(){oe(e.$$.fragment)},m(r,l){ne(e,r,l),i=!0},p(r,l){const a={};!t&&l&1&&(t=!0,a.gearBox=r[0],Ae(()=>t=!1)),e.$set(a)},i(r){i||(L(e.$$.fragment,r),i=!0)},o(r){z(e.$$.fragment,r),i=!1},d(r){ie(e,r)}}}function jm(n){let e,t,i=Ne(Sn),s=[];for(let r=0;r<i.length;r+=1)s[r]=Cl(kl(n,i,r));const o=r=>z(s[r],1,1,()=>{s[r]=null});return{c(){e=g("div");for(let r=0;r<s.length;r+=1)s[r].c();m(e,"class","gearBox svelte-oyqozi")},m(r,l){M(r,e,l);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null);n[2](e),t=!0},p(r,[l]){if(l&1){i=Ne(Sn);let a;for(a=0;a<i.length;a+=1){const c=kl(r,i,a);s[a]?(s[a].p(c,l),L(s[a],1)):(s[a]=Cl(c),s[a].c(),L(s[a],1),s[a].m(e,null))}for(qe(),a=i.length;a<s.length;a+=1)o(a);We()}},i(r){if(!t){for(let l=0;l<i.length;l+=1)L(s[l]);t=!0}},o(r){s=s.filter(Boolean);for(let l=0;l<s.length;l+=1)z(s[l]);t=!1},d(r){r&&R(e),ht(s,r),n[2](null)}}}function Hm(n,e,t){let i;function s(r){i=r,t(0,i)}function o(r){le[r?"unshift":"push"](()=>{i=r,t(0,i)})}return[i,s,o]}class zm extends Te{constructor(e){super(),Ie(this,e,Hm,jm,ge,{})}}function Um(n){let e,t,i,s,o,r,l,a;return{c(){e=g("div"),t=g("div"),i=g("button"),i.textContent="Clear armor",s=E(),o=g("div"),r=g("button"),r.textContent="Clear gear",m(i,"class","svelte-5d0uid"),m(t,"class","buttonCont svelte-5d0uid"),m(r,"class","svelte-5d0uid"),m(o,"class","buttonCont svelte-5d0uid"),m(e,"class","mainFeatures svelte-5d0uid"),m(e,"id","box")},m(c,u){M(c,e,u),p(e,t),p(t,i),p(e,s),p(e,o),p(o,r),l||(a=[N(i,"click",n[3]),N(r,"click",n[4])],l=!0)},p:se,i:se,o:se,d(c){c&&R(e),l=!1,be(a)}}}function Gm(n,e,t){let i,s,o,r,l;Q(n,zt,f=>t(5,i=f)),Q(n,Wn,f=>t(6,s=f)),Q(n,qt,f=>t(7,o=f)),Q(n,qn,f=>t(8,r=f)),Q(n,yn,f=>t(0,l=f));function a(){for(let f in o)o[f].name&&r[f][o[f].name].querySelector("button").click()}function c(){for(let f in i)i[f].name&&s[f][i[f].name].querySelector("button").click()}return[l,a,c,f=>{f.target.blur(),l||a()},f=>{f.target.blur(),l||c()}]}class Vm extends Te{constructor(e){super(),Ie(this,e,Gm,Um,ge,{})}}function El(n){let e,t,i;function s(r){n[3](r)}let o={slotName:"sets"};return n[0]!==void 0&&(o.slotOpen=n[0]),e=new Yo({props:o}),le.push(()=>Pe(e,"slotOpen",s)),{c(){oe(e.$$.fragment)},m(r,l){ne(e,r,l),i=!0},p(r,l){const a={};!t&&l&1&&(t=!0,a.slotOpen=r[0],Ae(()=>t=!1)),e.$set(a)},i(r){i||(L(e.$$.fragment,r),i=!0)},o(r){z(e.$$.fragment,r),i=!1},d(r){ie(e,r)}}}function Km(n){let e,t,i,s,o,r,l=n[1].head&&n[1].body&&n[1].legs&&n[1].feet&&El(n);return{c(){e=g("button"),e.innerHTML=`Load armor set
    <iconify-icon icon="iconamoon:arrow-down-2-fill" rotate="180deg" class="svelte-l9dczq"></iconify-icon>`,t=E(),l&&l.c(),i=pt(),m(e,"class","svelte-l9dczq"),re(e,"ddOpen",n[0])},m(a,c){M(a,e,c),M(a,t,c),l&&l.m(a,c),M(a,i,c),s=!0,o||(r=N(e,"click",n[2]),o=!0)},p(a,[c]){(!s||c&1)&&re(e,"ddOpen",a[0]),a[1].head&&a[1].body&&a[1].legs&&a[1].feet?l?(l.p(a,c),c&2&&L(l,1)):(l=El(a),l.c(),L(l,1),l.m(i.parentNode,i)):l&&(qe(),z(l,1,1,()=>{l=null}),We())},i(a){s||(L(l),s=!0)},o(a){z(l),s=!1},d(a){a&&(R(e),R(t),R(i)),l&&l.d(a),o=!1,r()}}}function Ym(n,e,t){let i;Q(n,Bt,l=>t(1,i=l));let{ddOpen:s=!1}=e;const o=()=>t(0,s=!s);function r(l){s=l,t(0,s)}return n.$$set=l=>{"ddOpen"in l&&t(0,s=l.ddOpen)},[s,i,o,r]}class Qm extends Te{constructor(e){super(),Ie(this,e,Ym,Km,ge,{ddOpen:0})}}function Jm(n){let e;return{c(){e=g("span"),e.textContent="Create some builds to get started!",m(e,"class","tooltip svelte-1cwaghb"),m(e,"id","top"),tt(e,"left","70.5%")},m(t,i){M(t,e,i)},p:se,d(t){t&&R(e)}}}function Xm(n){let e;return{c(){e=g("span"),e.textContent="Select some gear or armor to get started!",m(e,"class","tooltip svelte-1cwaghb"),m(e,"id","top"),tt(e,"left",n[3]?"38%":"")},m(t,i){M(t,e,i)},p(t,i){i&8&&tt(e,"left",t[3]?"38%":"")},d(t){t&&R(e)}}}function Zm(n){let e,t,i,s,o,r,l,a,c,u,d,f,h,_,b,v,y,k,w,I,A,q,T,W,H,K,D,S;function O(G,Y){if(!G[4])return Xm;if(!G[3])return Jm}let Z=O(n),P=Z&&Z(n);function F(G){n[18](G)}let B={};return n[1]!==void 0&&(B.ddOpen=n[1]),W=new Qm({props:B}),le.push(()=>Pe(W,"ddOpen",F)),{c(){e=g("div"),t=g("div"),i=g("div"),s=g("button"),o=te("Export new build"),l=E(),a=g("div"),c=g("button"),u=te("Save to build"),f=E(),h=g("div"),_=g("button"),b=te("Delete build"),y=E(),P&&P.c(),k=E(),w=g("div"),I=g("div"),A=g("button"),A.textContent="Load build",q=E(),T=g("div"),oe(W.$$.fragment),s.disabled=r=!n[4],m(s,"class","svelte-1cwaghb"),m(i,"class","buttonCont svelte-1cwaghb"),c.disabled=d=!n[4]||!n[3],m(c,"class","svelte-1cwaghb"),m(a,"class","buttonCont svelte-1cwaghb"),m(a,"id","middle"),_.disabled=v=!n[3],m(_,"class","svelte-1cwaghb"),m(h,"class","buttonCont svelte-1cwaghb"),m(t,"id","modify"),m(t,"class","svelte-1cwaghb"),re(t,"no-tooltip",n[2]),m(A,"class","svelte-1cwaghb"),m(I,"class","buttonCont svelte-1cwaghb"),m(T,"class","buttonCont svelte-1cwaghb"),m(w,"id","load"),m(w,"class","svelte-1cwaghb"),m(e,"class","mainFeatures svelte-1cwaghb"),m(e,"id","build")},m(G,Y){M(G,e,Y),p(e,t),p(t,i),p(i,s),p(s,o),p(t,l),p(t,a),p(a,c),p(c,u),p(t,f),p(t,h),p(h,_),p(_,b),p(t,y),P&&P.m(t,null),p(e,k),p(e,w),p(w,I),p(I,A),p(w,q),p(w,T),ne(W,T,null),n[19](T),K=!0,D||(S=[N(window,"mousedown",n[8]),N(window,"keydown",n[9]),N(s,"click",n[10]),N(s,"mouseenter",n[11]),N(s,"mouseleave",n[12]),N(c,"click",n[13]),N(_,"click",n[14]),N(_,"mouseenter",n[15]),N(_,"mouseleave",n[16]),N(A,"click",n[17])],D=!0)},p(G,[Y]){(!K||Y&16&&r!==(r=!G[4]))&&(s.disabled=r),(!K||Y&24&&d!==(d=!G[4]||!G[3]))&&(c.disabled=d),(!K||Y&8&&v!==(v=!G[3]))&&(_.disabled=v),Z===(Z=O(G))&&P?P.p(G,Y):(P&&P.d(1),P=Z&&Z(G),P&&(P.c(),P.m(t,null))),(!K||Y&4)&&re(t,"no-tooltip",G[2]);const ue={};!H&&Y&2&&(H=!0,ue.ddOpen=G[1],Ae(()=>H=!1)),W.$set(ue)},i(G){K||(L(W.$$.fragment,G),K=!0)},o(G){z(W.$$.fragment,G),K=!1},d(G){G&&R(e),P&&P.d(),ie(W),n[19](null),D=!1,be(S)}}}function xm(n,e,t){let i,s,o,r,l;Q(n,Rt,T=>t(7,i=T)),Q(n,xt,T=>t(3,s=T)),Q(n,uo,T=>t(4,o=T)),Q(n,yn,T=>t(5,r=T)),Q(n,X,T=>t(6,l=T));let a,c=!1,u=!1;const d=T=>{a.contains(T.target)||t(1,c=!1)},f=T=>{T.key=="Escape"&&t(1,c=!1)},h=()=>{o&&!r&&U(X,l.export.ongoing=!0,l)},_=()=>t(2,u=!0),b=()=>t(2,u=!1),v=()=>{o&&s&&!r&&U(X,l.save.ongoing=!0,l)},y=()=>{s&&!r&&U(X,l.delete.ongoing=!0,l)},k=()=>t(2,u=!0),w=()=>t(2,u=!1),I=()=>{r||U(X,l.load.ongoing=!0,l)};function A(T){c=T,t(1,c)}function q(T){le[T?"unshift":"push"](()=>{a=T,t(0,a)})}return n.$$.update=()=>{n.$$.dirty&128&&U(xt,s=Object.keys(i).length>0,s)},[a,c,u,s,o,r,l,i,d,f,h,_,b,v,y,k,w,I,A,q]}class $m extends Te{constructor(e){super(),Ie(this,e,xm,Zm,ge,{})}}function Sl(n){let e;return{c(){e=g("span"),e.textContent="New changes! Exiting will erase them.",m(e,"id","alert")},m(t,i){M(t,e,i)},d(t){t&&R(e)}}}function eg(n){let e,t,i,s,o,r,l,a=25-n[3].length+"",c,u,d,f,h,_,b,v,y,k,w,I=275-n[4].length+"",A,q,T,W,H,K,D,S,O,Z,P,F,B,G,Y,ue,ce=(n[3]||n[4])&&Sl();return{c(){e=g("div"),t=g("div"),i=te(`Name:\r
        `),s=g("input"),r=E(),l=g("span"),c=te(a),u=E(),d=g("div"),f=g("div"),h=g("span"),h.textContent="Description / Notes:",_=E(),ce&&ce.c(),b=E(),v=g("textarea"),k=E(),w=g("span"),A=te(I),q=E(),T=g("div"),W=g("div"),H=g("button"),K=te("CANCEL"),S=E(),O=g("div"),Z=g("button"),P=te("EXPORT"),m(s,"class","buildNameInput"),m(s,"id","firstFocusable"),s.disabled=o=n[5].export.status==0,m(s,"type","text"),m(s,"placeholder",n[6]),m(s,"maxlength","25"),m(l,"class","charCounter svelte-9d2eec"),m(l,"id","buildName"),m(t,"class","buildNameCont svelte-9d2eec"),m(v,"class","buildDescInput"),v.disabled=y=n[5].export.status==0,m(v,"placeholder","[Empty]"),m(v,"maxlength","275"),m(v,"autocomplete","off"),m(w,"class","charCounter"),m(w,"id","buildDesc"),m(d,"class","buildDescCont"),H.disabled=D=n[5].export.status==0,m(Z,"id","lastFocusable"),Z.disabled=F=n[5].export.status==0,m(T,"class","promptOptions"),m(e,"class","buildExporter svelte-9d2eec")},m(ee,j){M(ee,e,j),p(e,t),p(t,i),p(t,s),n[8](s),jt(s,n[3]),p(t,r),p(t,l),p(l,c),p(e,u),p(e,d),p(d,f),p(f,h),p(f,_),ce&&ce.m(f,null),p(d,b),p(d,v),jt(v,n[4]),n[13](v),p(d,k),p(d,w),p(w,A),p(e,q),p(e,T),p(T,W),p(W,H),p(H,K),n[16](H),p(T,S),p(T,O),p(O,Z),p(Z,P),G=!0,Y||(ue=[N(s,"input",n[9]),N(s,"input",n[10]),N(s,"keydown",n[11]),N(v,"input",n[12]),N(v,"input",n[14]),N(v,"keydown",n[15]),N(H,"click",n[17]),N(Z,"click",n[18]),N(Z,"keydown",wt),N(e,"introstart",n[19])],Y=!0)},p(ee,[j]){(!G||j&32&&o!==(o=ee[5].export.status==0))&&(s.disabled=o),j&8&&s.value!==ee[3]&&jt(s,ee[3]),(!G||j&8)&&a!==(a=25-ee[3].length+"")&&Ee(c,a),ee[3]||ee[4]?ce||(ce=Sl(),ce.c(),ce.m(f,null)):ce&&(ce.d(1),ce=null),(!G||j&32&&y!==(y=ee[5].export.status==0))&&(v.disabled=y),j&16&&jt(v,ee[4]),(!G||j&16)&&I!==(I=275-ee[4].length+"")&&Ee(A,I),(!G||j&32&&D!==(D=ee[5].export.status==0))&&(H.disabled=D),(!G||j&32&&F!==(F=ee[5].export.status==0))&&(Z.disabled=F)},i(ee){G||(ee&&ve(()=>{G&&(B||(B=me(e,Ye,{duration:250},!0)),B.run(1))}),G=!0)},o(ee){ee&&(B||(B=me(e,Ye,{duration:250},!1)),B.run(0)),G=!1},d(ee){ee&&R(e),n[8](null),ce&&ce.d(),n[13](null),n[16](null),ee&&B&&B.end(),Y=!1,be(ue)}}}function tg(n,e,t){let i,s,o,r,l,a;Q(n,X,O=>t(5,i=O)),Q(n,kt,O=>t(20,s=O)),Q(n,xt,O=>t(21,o=O)),Q(n,zt,O=>t(22,r=O)),Q(n,qt,O=>t(23,l=O)),Q(n,Rt,O=>t(24,a=O));let c=Object.keys(a).length,u,d,f,h="",_="",b=`My ${c+1+uu[(c+1)%10]} build`;function v(){if(U(X,i.export.status=0,i),h.endsWith(" ")&&t(3,h=h.replace(/  +/g," ").replace(/ $/,"")),_.endsWith(" ")&&t(4,_=_.replace(/  +/g," ").replace(/ $/,"")),Object.keys(a).includes(h)){U(X,i.export.status=-1,i),U(X,i.message="duplicate_name",i);return}let O=b_(Jt(Un(Vn),"builds")).key,Z=hu(l,r);Z.name=h||b,Z.desc=_||"[Empty]",ms(Jt(Un(Vn),`builds/${O}`),Z).then(()=>{U(X,i.export.status=1,i),U(xt,o=!0,o),Ko(),Rt.update(P=>({...P,[Z.name]:{id:O,desc:Z.desc}})),U(kt,s=Z,s),U(kt,s.id=O,s),navigator.clipboard.writeText(`${location.origin+location.pathname}?id=${O}`)}).catch(()=>{U(X,i.export.status=-1,i),U(X,i.message="firebase_fail",i)})}function y(O){le[O?"unshift":"push"](()=>{u=O,t(0,u)})}function k(){h=this.value,t(3,h)}const w=O=>{t(3,h=ns(O.target.value,25))},I=O=>{i.export.status==0&&O.preventDefault(),yt(O),no(u,O.target.value,25)};function A(){_=this.value,t(4,_)}function q(O){le[O?"unshift":"push"](()=>{d=O,t(1,d)})}const T=O=>{t(4,_=ns(O.target.value,275))},W=O=>{i.export.status==0&&O.preventDefault(),no(d,O.target.value,275)};function H(O){le[O?"unshift":"push"](()=>{f=O,t(2,f)})}return[u,d,f,h,_,i,b,v,y,k,w,I,A,q,T,W,H,()=>{i.export.status!=0&&U(X,i.export.ongoing=!1,i)},()=>{i.export.status!=0&&v()},()=>f.focus()]}class ng extends Te{constructor(e){super(),Ie(this,e,tg,eg,ge,{})}}function ig(n){let e,t,i,s,o=n[2]?"Copied!":"Copy link",r,l,a;return{c(){e=g("button"),t=g("b"),t.textContent="Build link",i=E(),s=g("span"),r=te(o),m(s,"class","tooltip"),m(s,"id","top"),m(e,"class","copyButton svelte-1qz7uzx"),m(e,"id","firstFocusable")},m(c,u){M(c,e,u),p(e,t),p(e,i),p(e,s),p(s,r),l||(a=[N(e,"click",n[7]),N(e,"keydown",yt)],l=!0)},p(c,u){u&4&&o!==(o=c[2]?"Copied!":"Copy link")&&Ee(r,o)},d(c){c&&R(e),l=!1,be(a)}}}function sg(n){let e,t,i,s,o,r,l=n[2]?"Copied!":"Copy ID",a,c,u,d;return{c(){e=g("button"),t=g("b"),t.textContent="ID:",i=E(),s=te(n[4]),o=E(),r=g("span"),a=te(l),m(r,"class","tooltip"),m(r,"id","top"),m(e,"class","copyButton svelte-1qz7uzx"),m(e,"id",c=n[1]!="save"?"firstFocusable":"")},m(f,h){M(f,e,h),p(e,t),p(e,i),p(e,s),p(e,o),p(e,r),p(r,a),u||(d=[N(e,"click",n[5]),N(e,"keydown",n[6])],u=!0)},p(f,h){h&4&&l!==(l=f[2]?"Copied!":"Copy ID")&&Ee(a,l),h&2&&c!==(c=f[1]!="save"?"firstFocusable":"")&&m(e,"id",c)},d(f){f&&R(e),u=!1,be(d)}}}function og(n){let e;function t(o,r){if(o[0]=="id")return sg;if(o[0]=="link")return ig}let i=t(n),s=i&&i(n);return{c(){s&&s.c(),e=pt()},m(o,r){s&&s.m(o,r),M(o,e,r)},p(o,[r]){i===(i=t(o))&&s?s.p(o,r):(s&&s.d(1),s=i&&i(o),s&&(s.c(),s.m(e.parentNode,e)))},i:se,o:se,d(o){o&&R(e),s&&s.d(o)}}}function rg(n,e,t){let i;Q(n,kt,f=>t(8,i=f));let{type:s,source:o}=e,r=!1;function l(f){r||(navigator.clipboard.writeText(f),t(2,r=!0),setTimeout(()=>t(2,r=!1),1e3))}let a=i?i.id:null;const c=()=>l(a),u=()=>{o!="save"&&yt()},d=()=>l(`${location.origin+location.pathname}?id=${a}`);return n.$$set=f=>{"type"in f&&t(0,s=f.type),"source"in f&&t(1,o=f.source)},[s,o,r,l,a,c,u,d]}class wi extends Te{constructor(e){super(),Ie(this,e,rg,og,ge,{type:0,source:1})}}function lg(n){let e,t,i,s;return e=new wi({props:{type:"link",source:"share"}}),i=new wi({props:{type:"id",source:"share"}}),{c(){oe(e.$$.fragment),t=E(),oe(i.$$.fragment)},m(o,r){ne(e,o,r),M(o,t,r),ne(i,o,r),s=!0},p:se,i(o){s||(L(e.$$.fragment,o),L(i.$$.fragment,o),s=!0)},o(o){z(e.$$.fragment,o),z(i.$$.fragment,o),s=!1},d(o){o&&R(t),ie(e,o),ie(i,o)}}}function ag(n){let e;return{c(){e=g("span"),e.textContent="Your build has been erased from your local saves and the database."},m(t,i){M(t,e,i)},p:se,i:se,o:se,d(t){t&&R(e)}}}function cg(n){let e;function t(o,r){if(o[2].message=="not_found")return pg;if(o[2].message=="invalid_id")return hg}let i=t(n),s=i&&i(n);return{c(){s&&s.c(),e=pt()},m(o,r){s&&s.m(o,r),M(o,e,r)},p(o,r){i!==(i=t(o))&&(s&&s.d(1),s=i&&i(o),s&&(s.c(),s.m(e.parentNode,e)))},i:se,o:se,d(o){o&&R(e),s&&s.d(o)}}}function ug(n){let e,t,i,s,o,r;return i=new wi({props:{type:"link",source:"save"}}),o=new wi({props:{type:"id",source:"save"}}),{c(){e=g("span"),e.textContent="Your build has been overwritten.",t=E(),oe(i.$$.fragment),s=E(),oe(o.$$.fragment)},m(l,a){M(l,e,a),M(l,t,a),ne(i,l,a),M(l,s,a),ne(o,l,a),r=!0},p:se,i(l){r||(L(i.$$.fragment,l),L(o.$$.fragment,l),r=!0)},o(l){z(i.$$.fragment,l),z(o.$$.fragment,l),r=!1},d(l){l&&(R(e),R(t),R(s)),ie(i,l),ie(o,l)}}}function dg(n){let e,t,i,s;const o=[mg,_g],r=[];function l(a,c){return a[2].export.status==1?0:a[2].export.status==-1&&a[2].message=="duplicate_name"?1:-1}return~(e=l(n))&&(t=r[e]=o[e](n)),{c(){t&&t.c(),i=pt()},m(a,c){~e&&r[e].m(a,c),M(a,i,c),s=!0},p(a,c){let u=e;e=l(a),e!==u&&(t&&(qe(),z(r[u],1,1,()=>{r[u]=null}),We()),~e?(t=r[e],t||(t=r[e]=o[e](a),t.c()),L(t,1),t.m(i.parentNode,i)):t=null)},i(a){s||(L(t),s=!0)},o(a){z(t),s=!1},d(a){a&&R(i),~e&&r[e].d(a)}}}function fg(n){let e,t,i=n[2].export.status?"exporting":n[2].save.status?"saving":n[2].load.status?"loading":"deleting",s,o,r,l,a,c,u,d;return{c(){e=g("span"),t=te("A problem occurred while "),s=te(i),o=te(` your build.\r
            `),r=g("br"),l=te(`\r
            If needed`),a=g("b"),a.textContent=",",c=te(" you may contact "),u=g("hl"),u.textContent="xt.ss",d=te(` on Discord for more\r
            details.`)},m(f,h){M(f,e,h),p(e,t),p(e,s),p(e,o),p(e,r),p(e,l),p(e,a),p(e,c),p(e,u),p(e,d)},p(f,h){h&4&&i!==(i=f[2].export.status?"exporting":f[2].save.status?"saving":f[2].load.status?"loading":"deleting")&&Ee(s,i)},i:se,o:se,d(f){f&&R(e)}}}function hg(n){let e;return{c(){e=g("span"),e.textContent="The ID you have entered is invalid. Please check it again."},m(t,i){M(t,e,i)},d(t){t&&R(e)}}}function pg(n){let e;return{c(){e=g("span"),e.innerHTML=`Your build could not be found within the database.
                <br/>
                If needed<b>,</b> you may contact <hl>xt.ss</hl> on Discord for more
                details.`},m(t,i){M(t,e,i)},d(t){t&&R(e)}}}function _g(n){let e;return{c(){e=g("span"),e.innerHTML=`Another build of yours with the same name already exists.
                <br/>
                Please use a different one.`},m(t,i){M(t,e,i)},i:se,o:se,d(t){t&&R(e)}}}function mg(n){let e,t,i,s;return i=new wi({props:{type:"id",source:"export"}}),{c(){e=g("span"),e.textContent="Your build's link has been copied to your clipboard.",t=E(),oe(i.$$.fragment)},m(o,r){M(o,e,r),M(o,t,r),ne(i,o,r),s=!0},i(o){s||(L(i.$$.fragment,o),s=!0)},o(o){z(i.$$.fragment,o),s=!1},d(o){o&&(R(e),R(t)),ie(i,o)}}}function gg(n){let e,t,i,s,o,r,l,a,c,u,d,f,h,_,b,v,y;const k=[fg,dg,ug,cg,ag,lg],w=[];function I(A,q){return A[1]==-1&&A[2].message=="firebase_fail"?0:A[2].export.status?1:A[2].save.status==1?2:A[2].load.status==-1?3:A[2].delete.status==1?4:A[2].share.ongoing?5:-1}return~(o=I(n))&&(r=w[o]=k[o](n)),{c(){e=g("div"),t=g("span"),i=te(n[4]),s=E(),r&&r.c(),l=E(),a=g("div"),c=g("div"),u=g("button"),d=te("OK"),m(t,"id","messageTitle"),m(t,"class","svelte-8i8nbx"),m(u,"id",f=(n[1]==-1?"firstFocusable ":"")+"lastFocusable"),m(a,"class","promptOptions svelte-8i8nbx"),m(e,"class","promptMessage svelte-8i8nbx")},m(A,q){M(A,e,q),p(e,t),p(t,i),p(e,s),~o&&w[o].m(e,null),p(e,l),p(e,a),p(a,c),p(c,u),p(u,d),n[6](u),b=!0,v||(y=[N(u,"click",n[7]),N(u,"keydown",n[8]),N(e,"introstart",n[9])],v=!0)},p(A,[q]){(!b||q&16)&&Ee(i,A[4]);let T=o;o=I(A),o===T?~o&&w[o].p(A,q):(r&&(qe(),z(w[T],1,1,()=>{w[T]=null}),We()),~o?(r=w[o],r?r.p(A,q):(r=w[o]=k[o](A),r.c()),L(r,1),r.m(e,l)):r=null),(!b||q&2&&f!==(f=(A[1]==-1?"firstFocusable ":"")+"lastFocusable"))&&m(u,"id",f)},i(A){b||(L(r),A&&ve(()=>{b&&(_&&_.end(1),h=va(e,Ye,{duration:200,delay:75}),h.start())}),b=!0)},o(A){z(r),h&&h.invalidate(),A&&(_=ya(e,Ye,{duration:200})),b=!1},d(A){A&&R(e),~o&&w[o].d(),n[6](null),A&&_&&_.end(),v=!1,be(y)}}}function bg(n,e,t){let i,s,o;Q(n,X,h=>t(2,o=h));let{loadID:r}=e;const l=Gt();let a;function c(h){le[h?"unshift":"push"](()=>{a=h,t(3,a)})}const u=()=>{t(0,r=null),l("resetActions")},d=h=>{s==-1&&yt(h),wt(h)},f=()=>a.focus();return n.$$set=h=>{"loadID"in h&&t(0,r=h.loadID)},n.$$.update=()=>{n.$$.dirty&4&&t(1,s=o.export.status||o.save.status||o.load.status||o.delete.status),n.$$.dirty&6&&t(4,i=o.share.ongoing?"Share this build":`${o.export.status?"Export":o.save.status?"Save":o.load.status?"Load":"Delete"} ${s==1?"Success":"Failure"}!`)},[r,s,o,a,i,l,c,u,d,f]}class vg extends Te{constructor(e){super(),Ie(this,e,bg,gg,ge,{loadID:0})}}function yg(n){let e,t,i,s,o,r;return{c(){e=g("li"),t=g("button"),i=g("span"),s=te(n[0]),m(i,"class","svelte-1hzohsl"),m(e,"class","svelte-1hzohsl"),re(e,"selectedItem",n[2])},m(l,a){M(l,e,a),p(e,t),p(t,i),p(i,s),n[7](e),o||(r=N(t,"click",n[3]),o=!0)},p(l,[a]){a&1&&Ee(s,l[0]),a&4&&re(e,"selectedItem",l[2])},i:se,o:se,d(l){l&&R(e),n[7](null),o=!1,r()}}}function wg(n,e,t){let{chosenBuild:i,buildData:s,buildName:o,ddOpen:r}=e;const l=Gt();let a,c=i[0]==o;function u(){if(r){if(a.classList.contains("selectedItem")||t(2,c=!1),c)return;l("buildSelect",a),t(2,c=!0),t(5,r=!1),t(4,i=[o,s])}}function d(f){le[f?"unshift":"push"](()=>{a=f,t(1,a)})}return n.$$set=f=>{"chosenBuild"in f&&t(4,i=f.chosenBuild),"buildData"in f&&t(6,s=f.buildData),"buildName"in f&&t(0,o=f.buildName),"ddOpen"in f&&t(5,r=f.ddOpen)},[o,a,c,u,i,r,s,d]}class kg extends Te{constructor(e){super(),Ie(this,e,wg,yg,ge,{chosenBuild:4,buildData:6,buildName:0,ddOpen:5})}}function Il(n,e,t){const i=n.slice();return i[25]=e[t][0],i[26]=e[t][1],i}function Tl(n){let e,t,i,s;function o(a){n[13](a)}function r(a){n[14](a)}let l={buildData:n[26],buildName:n[25]};return n[0]!==void 0&&(l.chosenBuild=n[0]),n[1]!==void 0&&(l.ddOpen=n[1]),e=new kg({props:l}),le.push(()=>Pe(e,"chosenBuild",o)),le.push(()=>Pe(e,"ddOpen",r)),e.$on("buildSelect",n[11]),{c(){oe(e.$$.fragment)},m(a,c){ne(e,a,c),s=!0},p(a,c){const u={};c&16&&(u.buildData=a[26]),c&16&&(u.buildName=a[25]),!t&&c&1&&(t=!0,u.chosenBuild=a[0],Ae(()=>t=!1)),!i&&c&2&&(i=!0,u.ddOpen=a[1],Ae(()=>i=!1)),e.$set(u)},i(a){s||(L(e.$$.fragment,a),s=!0)},o(a){z(e.$$.fragment,a),s=!1},d(a){ie(e,a)}}}function Cg(n){let e,t,i,s,o,r,l,a=Ne(Object.entries(n[4])),c=[];for(let d=0;d<a.length;d+=1)c[d]=Tl(Il(n,a,d));const u=d=>z(c[d],1,1,()=>{c[d]=null});return{c(){e=g("div"),t=g("input"),i=E(),s=g("ul");for(let d=0;d<c.length;d+=1)c[d].c();m(t,"type","text"),m(t,"class","searchBarInput svelte-nka60b"),m(t,"placeholder","Search..."),m(s,"class","svelte-nka60b"),re(s,"no-scrollbar",n[8].length<=4),m(e,"class","dropdown svelte-nka60b"),re(e,"ddOpen",n[1])},m(d,f){M(d,e,f),p(e,t),n[12](t),p(e,i),p(e,s);for(let h=0;h<c.length;h+=1)c[h]&&c[h].m(s,null);n[15](s),n[16](e),o=!0,r||(l=[N(t,"input",n[10]),N(t,"keydown",n[9]),N(e,"transitionend",n[17]),N(e,"transitioncancel",n[18])],r=!0)},p(d,[f]){if(f&2067){a=Ne(Object.entries(d[4]));let h;for(h=0;h<a.length;h+=1){const _=Il(d,a,h);c[h]?(c[h].p(_,f),L(c[h],1)):(c[h]=Tl(_),c[h].c(),L(c[h],1),c[h].m(s,null))}for(qe(),h=a.length;h<c.length;h+=1)u(h);We()}(!o||f&256)&&re(s,"no-scrollbar",d[8].length<=4),(!o||f&2)&&re(e,"ddOpen",d[1])},i(d){if(!o){for(let f=0;f<a.length;f+=1)L(c[f]);o=!0}},o(d){c=c.filter(Boolean);for(let f=0;f<c.length;f+=1)z(c[f]);o=!1},d(d){d&&R(e),n[12](null),ht(c,d),n[15](null),n[16](null),r=!1,be(l)}}}function Eg(n,e,t){let i;Q(n,Rt,S=>t(4,i=S));let{chosenBuild:s,ddOpen:o=!1,dropdown:r}=e;const l=Gt();let a,c,u,d,f={},h=!1,_=[];function b(S){!S.shiftKey&&S.key=="Tab"&&(S.preventDefault(),setTimeout(()=>a.focus()))}function v(){c&&c.removeEventListener("keydown",b),w(),c&&c.addEventListener("keydown",b)}function y(S){S.shiftKey&&S.key=="Tab"&&(S.preventDefault(),setTimeout(()=>(c.querySelector("button")||c).focus()))}function k(){fu(a.value,f),v()}function w(){c&&c.classList.remove("lastElement"),t(8,_=u.querySelectorAll("li:not(.hidden)")),c=_[_.length-1],c?c.classList.add("lastElement"):c=a}function I(S){l("buildSelect"),t(6,d=S.detail);let O=u.querySelector(".selectedItem");O&&O!=S.detail&&O.classList.remove("selectedItem"),t(7,h=!0)}function A(S){le[S?"unshift":"push"](()=>{a=S,t(5,a)})}function q(S){s=S,t(0,s)}function T(S){o=S,t(1,o)}function W(S){le[S?"unshift":"push"](()=>{u=S,t(3,u)})}function H(S){le[S?"unshift":"push"](()=>{r=S,t(2,r)})}const K=S=>{S.propertyName=="visibility"&&(h&&(t(7,h=!1),t(5,a.value="",a),k()),!o&&d&&u.scrollTo(0,d.offsetTop),ts(a,o))},D=S=>{S.propertyName=="visibility"&&(t(7,h=!1),ts(a,o))};return n.$$set=S=>{"chosenBuild"in S&&t(0,s=S.chosenBuild),"ddOpen"in S&&t(1,o=S.ddOpen),"dropdown"in S&&t(2,r=S.dropdown)},n.$$.update=()=>{if(n.$$.dirty&24&&u){t(8,_=u.querySelectorAll("li:not(.hidden)"));for(let S=0;S<u.childElementCount;S++)f[Object.keys(i)[S]]=u.children[S];w(),v()}},[s,o,r,u,i,a,d,h,_,y,k,I,A,q,T,W,H,K,D]}class Qo extends Te{constructor(e){super(),Ie(this,e,Eg,Cg,ge,{chosenBuild:0,ddOpen:1,dropdown:2})}}function Nl(n){let e,t=(n[6]>n[5]*.8?n[11].slice(0,20)+"<b>...</b>":n[11])+"",i;return{c(){e=g("span"),ve(()=>n[15].call(e))},m(s,o){M(s,e,o),e.innerHTML=t,i=rn(e,n[15].bind(e))},p(s,o){o[0]&2144&&t!==(t=(s[6]>s[5]*.8?s[11].slice(0,20)+"<b>...</b>":s[11])+"")&&(e.innerHTML=t)},d(s){s&&R(e),i()}}}function Ol(n){let e;return{c(){e=g("span"),e.textContent="New changes! Exiting will erase them.",m(e,"id","alert")},m(t,i){M(t,e,i)},d(t){t&&R(e)}}}function Sg(n){let e,t,i,s,o,r=n[11],l,a,c,u,d,f,h,_,b,v,y,k,w,I,A=275-n[2].length+"",q,T,W,H,K,D,S,O,Z,P,F,B,G,Y,ue,ce,ee,j,J,de,Be,Me=Nl(n),Oe=n[1]!=null&&n[1]!=n[2]&&Ol();function nt(_e){n[26](_e)}function je(_e){n[27](_e)}function De(_e){n[28](_e)}let ze={};return n[0]!==void 0&&(ze.chosenBuild=n[0]),n[3]!==void 0&&(ze.ddOpen=n[3]),n[9]!==void 0&&(ze.dropdown=n[9]),Y=new Qo({props:ze}),le.push(()=>Pe(Y,"chosenBuild",nt)),le.push(()=>Pe(Y,"ddOpen",je)),le.push(()=>Pe(Y,"dropdown",De)),Y.$on("buildSelect",n[29]),{c(){e=g("div"),t=g("div"),i=g("span"),i.textContent="Save to:",s=E(),o=g("button"),Me.c(),l=E(),a=g("iconify-icon"),d=E(),f=g("div"),h=g("div"),_=g("span"),_.textContent="Description / Notes:",b=E(),Oe&&Oe.c(),v=E(),y=g("textarea"),w=E(),I=g("span"),q=te(A),T=E(),W=g("div"),H=g("div"),K=g("button"),D=te("CANCEL"),O=E(),Z=g("div"),P=g("button"),F=te("SAVE"),G=E(),oe(Y.$$.fragment),Re(a,"icon","iconamoon:arrow-down-2-fill"),m(o,"id","firstFocusable"),o.disabled=c=n[12].save.status==0,m(o,"class","promptDDButton svelte-106wt5q"),ve(()=>n[17].call(o)),re(o,"ddOpen",n[3]),m(t,"class","chosenBuildCont"),m(y,"class","buildDescInput"),y.disabled=k=n[12].save.status==0,m(y,"placeholder","[Empty]"),m(y,"maxlength","275"),m(y,"autocomplete","off"),m(I,"class","charCounter"),m(I,"id","buildDesc"),m(f,"class","buildDescCont"),K.disabled=S=n[12].save.status==0,m(P,"id","lastFocusable"),P.disabled=B=n[12].save.status==0,m(W,"class","promptOptions"),m(e,"class","buildSaver")},m(_e,ae){M(_e,e,ae),p(e,t),p(t,i),p(t,s),p(t,o),Me.m(o,null),p(o,l),p(o,a),n[16](o),u=rn(o,n[17].bind(o)),p(e,d),p(e,f),p(f,h),p(h,_),p(h,b),Oe&&Oe.m(h,null),p(f,v),p(f,y),n[19](y),jt(y,n[10]),p(f,w),p(f,I),p(I,q),p(e,T),p(e,W),p(W,H),p(H,K),p(K,D),n[23](K),p(W,O),p(W,Z),p(Z,P),p(P,F),p(e,G),ne(Y,e,null),J=!0,de||(Be=[N(window,"mousedown",n[14]),N(o,"click",n[18]),N(o,"keydown",yt),N(y,"input",n[20]),N(y,"input",n[21]),N(y,"keydown",n[22]),N(K,"click",n[24]),N(P,"click",n[25]),N(P,"keydown",wt),N(e,"introstart",n[30]),N(e,"keydown",n[31])],de=!0)},p(_e,ae){ae[0]&2048&&ge(r,r=_e[11])?(Me.d(1),Me=Nl(_e),Me.c(),Me.m(o,l)):Me.p(_e,ae),(!J||ae[0]&4096&&c!==(c=_e[12].save.status==0))&&(o.disabled=c),(!J||ae[0]&8)&&re(o,"ddOpen",_e[3]),_e[1]!=null&&_e[1]!=_e[2]?Oe||(Oe=Ol(),Oe.c(),Oe.m(h,null)):Oe&&(Oe.d(1),Oe=null),(!J||ae[0]&4096&&k!==(k=_e[12].save.status==0))&&(y.disabled=k),ae[0]&1024&&jt(y,_e[10]),(!J||ae[0]&4)&&A!==(A=275-_e[2].length+"")&&Ee(q,A),(!J||ae[0]&4096&&S!==(S=_e[12].save.status==0))&&(K.disabled=S),(!J||ae[0]&4096&&B!==(B=_e[12].save.status==0))&&(P.disabled=B);const gt={};!ue&&ae[0]&1&&(ue=!0,gt.chosenBuild=_e[0],Ae(()=>ue=!1)),!ce&&ae[0]&8&&(ce=!0,gt.ddOpen=_e[3],Ae(()=>ce=!1)),!ee&&ae[0]&512&&(ee=!0,gt.dropdown=_e[9],Ae(()=>ee=!1)),Y.$set(gt)},i(_e){J||(L(Y.$$.fragment,_e),_e&&ve(()=>{J&&(j||(j=me(e,Ye,{duration:250},!0)),j.run(1))}),J=!0)},o(_e){z(Y.$$.fragment,_e),_e&&(j||(j=me(e,Ye,{duration:250},!1)),j.run(0)),J=!1},d(_e){_e&&R(e),Me.d(_e),n[16](null),u(),Oe&&Oe.d(),n[19](null),n[23](null),ie(Y),_e&&j&&j.end(),de=!1,be(Be)}}}function Ig(n,e,t){let i,s,o,r,l,a,c,u;Q(n,X,j=>t(12,r=j)),Q(n,kt,j=>t(32,l=j)),Q(n,Rt,j=>t(33,a=j)),Q(n,zt,j=>t(34,c=j)),Q(n,qt,j=>t(35,u=j));let d=!1,f,h,_,b,v,y,k=Object.entries(a)[0],w=null;function I(){U(X,r.save.status=0,r);let j=hu(u,c),J=w==null?s:w==""?"[Empty]":w,de=k[1].id;j.name=i,j.desc=J,ms(Jt(Un(Vn),`builds/${de}`),j).then(()=>{U(X,r.save.status=1,r);let Be={...a};Be[i].desc=J,Ko(),Rt.update(()=>Be),U(kt,l=j,l),U(kt,l.id=de,l)}).catch(()=>{U(X,r.save.status=-1,r),U(X,r.message="firebase_fail",r)})}const A=j=>{!f.contains(j.target)&&!y.contains(j.target)&&t(3,d=!1)};function q(){_=this.offsetWidth,t(6,_)}function T(j){le[j?"unshift":"push"](()=>{f=j,t(4,f)})}function W(){h=this.offsetWidth,t(5,h)}const H=()=>{r.save.status!=0&&t(3,d=!d)};function K(j){le[j?"unshift":"push"](()=>{b=j,t(7,b)})}function D(){o=this.value,t(10,o),t(1,w),t(2,s),t(0,k)}const S=j=>{t(1,w=ns(j.target.value,275))},O=j=>{r.save.status==0&&j.preventDefault(),no(b,j.target.value,275)};function Z(j){le[j?"unshift":"push"](()=>{v=j,t(8,v)})}const P=()=>{r.save.status!=0&&U(X,r.save.ongoing=!1,r)},F=()=>{r.save.status!=0&&I()};function B(j){k=j,t(0,k)}function G(j){d=j,t(3,d)}function Y(j){y=j,t(9,y)}const ue=()=>t(1,w=null),ce=()=>v.focus(),ee=j=>{j.key=="Escape"&&(t(3,d=!1),f.focus())};return n.$$.update=()=>{n.$$.dirty[0]&1&&t(11,i=k[0]),n.$$.dirty[0]&1&&t(2,s=k[1].desc),n.$$.dirty[0]&6&&t(10,o=w??s)},[k,w,s,d,f,h,_,b,v,y,o,i,r,I,A,q,T,W,H,K,D,S,O,Z,P,F,B,G,Y,ue,ce,ee]}class Tg extends Te{constructor(e){super(),Ie(this,e,Ig,Sg,ge,{},null,[-1,-1])}}function Ng(n){let e,t,i,s,o,r,l,a,c;return{c(){e=g("div"),t=g("span"),t.textContent="ID:",i=E(),s=g("input"),m(s,"class","buildIDInput svelte-1ort6ez"),s.disabled=o=n[11].load.status==0,m(s,"type","text"),m(s,"placeholder","Example ID: -NDqeA1Scn0EAJcYWN3b"),m(s,"maxlength","25"),m(e,"class","buildIDCont svelte-1ort6ez")},m(u,d){M(u,e,d),p(e,t),p(e,i),p(e,s),n[23](s),jt(s,n[10]),l=!0,a||(c=[N(s,"input",n[24]),N(s,"input",n[25]),N(s,"keydown",n[26])],a=!0)},p(u,d){(!l||d[0]&2048&&o!==(o=u[11].load.status==0))&&(s.disabled=o),d[0]&1024&&s.value!==u[10]&&jt(s,u[10])},i(u){l||(u&&ve(()=>{l&&(r||(r=me(e,Xe,{duration:150},!0)),r.run(1))}),l=!0)},o(u){u&&(r||(r=me(e,Xe,{duration:150},!1)),r.run(0)),l=!1},d(u){u&&R(e),n[23](null),u&&r&&r.end(),a=!1,be(c)}}}function Og(n){let e,t,i,s,o=n[9],r,l,a,c,u,d,f,h,_=Dl(n);return{c(){e=g("div"),t=g("span"),t.textContent="Load:",i=E(),s=g("button"),_.c(),r=E(),l=g("iconify-icon"),Re(l,"icon","iconamoon:arrow-down-2-fill"),s.disabled=a=n[11].load.status==0,m(s,"class","promptDDButton svelte-1ort6ez"),ve(()=>n[21].call(s)),re(s,"ddOpen",n[8]),m(e,"class","chosenBuildCont svelte-1ort6ez")},m(b,v){M(b,e,v),p(e,t),p(e,i),p(e,s),_.m(s,null),p(s,r),p(s,l),n[20](s),c=rn(s,n[21].bind(s)),d=!0,f||(h=N(s,"click",n[22]),f=!0)},p(b,v){v[0]&512&&ge(o,o=b[9])?(_.d(1),_=Dl(b),_.c(),_.m(s,r)):_.p(b,v),(!d||v[0]&2048&&a!==(a=b[11].load.status==0))&&(s.disabled=a),(!d||v[0]&256)&&re(s,"ddOpen",b[8])},i(b){d||(b&&ve(()=>{d&&(u||(u=me(e,Xe,{duration:150},!0)),u.run(1))}),d=!0)},o(b){b&&(u||(u=me(e,Xe,{duration:150},!1)),u.run(0)),d=!1},d(b){b&&R(e),_.d(b),n[20](null),c(),b&&u&&u.end(),f=!1,h()}}}function Dl(n){let e,t=(n[6]>n[5]*.7?n[9].slice(0,20)+"<b>...</b>":n[9])+"",i;return{c(){e=g("span"),ve(()=>n[19].call(e))},m(s,o){M(s,e,o),e.innerHTML=t,i=rn(e,n[19].bind(e))},p(s,o){o[0]&608&&t!==(t=(s[6]>s[5]*.7?s[9].slice(0,20)+"<b>...</b>":s[9])+"")&&(e.innerHTML=t)},d(s){s&&R(e),i()}}}function Rl(n){let e,t,i,s,o;function r(u){n[29](u)}function l(u){n[30](u)}function a(u){n[31](u)}let c={};return n[3]!==void 0&&(c.chosenBuild=n[3]),n[8]!==void 0&&(c.ddOpen=n[8]),n[7]!==void 0&&(c.dropdown=n[7]),e=new Qo({props:c}),le.push(()=>Pe(e,"chosenBuild",r)),le.push(()=>Pe(e,"ddOpen",l)),le.push(()=>Pe(e,"dropdown",a)),{c(){oe(e.$$.fragment)},m(u,d){ne(e,u,d),o=!0},p(u,d){const f={};!t&&d[0]&8&&(t=!0,f.chosenBuild=u[3],Ae(()=>t=!1)),!i&&d[0]&256&&(i=!0,f.ddOpen=u[8],Ae(()=>i=!1)),!s&&d[0]&128&&(s=!0,f.dropdown=u[7],Ae(()=>s=!1)),e.$set(f)},i(u){o||(L(e.$$.fragment,u),o=!0)},o(u){z(e.$$.fragment,u),o=!1},d(u){ie(e,u)}}}function Dg(n){let e,t,i,s,o,r,l,a,c,u,d,f,h,_,b,v,y,k,w,I,A,q,T,W,H,K,D,S,O,Z,P,F,B,G,Y;const ue=[Og,Ng],ce=[];function ee(J,de){return J[2]?0:1}k=ee(n),w=ce[k]=ue[k](n);let j=n[2]&&Rl(n);return{c(){e=g("div"),t=g("span"),t.textContent="Load build via:",i=E(),s=g("div"),o=g("div"),r=g("button"),l=te("Local saves"),u=E(),d=g("div"),f=g("button"),h=te("Exported ID"),v=E(),y=g("div"),w.c(),I=E(),A=g("div"),q=g("div"),T=g("button"),W=te("CANCEL"),K=E(),D=g("div"),S=g("button"),O=te("LOAD"),P=E(),j&&j.c(),m(t,"class","svelte-1ort6ez"),m(r,"id",a=n[2]?"firstFocusable":""),r.disabled=c=n[11].load.status==0||!n[12],m(r,"class","svelte-1ort6ez"),re(r,"chosen",n[2]),re(r,"unavailable",!n[12]),m(o,"class","svelte-1ort6ez"),m(f,"id",_=n[2]?"":"firstFocusable"),f.disabled=b=n[11].load.status==0,m(f,"class","svelte-1ort6ez"),re(f,"chosen",!n[2]),m(d,"class","svelte-1ort6ez"),m(s,"class","loadMethodRadio svelte-1ort6ez"),m(y,"class","loadMethodCont svelte-1ort6ez"),T.disabled=H=n[11].load.status==0,m(S,"id","lastFocusable"),S.disabled=Z=n[11].load.status==0,m(A,"class","promptOptions svelte-1ort6ez"),m(e,"class","buildLoader svelte-1ort6ez")},m(J,de){M(J,e,de),p(e,t),p(e,i),p(e,s),p(s,o),p(o,r),p(r,l),p(s,u),p(s,d),p(d,f),p(f,h),p(e,v),p(e,y),ce[k].m(y,null),p(e,I),p(e,A),p(A,q),p(q,T),p(T,W),n[27](T),p(A,K),p(A,D),p(D,S),p(S,O),p(e,P),j&&j.m(e,null),B=!0,G||(Y=[N(window,"mousedown",n[14]),N(r,"click",n[15]),N(r,"keydown",n[16]),N(f,"click",n[17]),N(f,"keydown",n[18]),N(T,"click",n[28]),N(S,"keydown",wt),N(S,"click",n[13]),N(e,"introstart",n[32]),N(e,"keydown",n[33])],G=!0)},p(J,de){(!B||de[0]&4&&a!==(a=J[2]?"firstFocusable":""))&&m(r,"id",a),(!B||de[0]&6144&&c!==(c=J[11].load.status==0||!J[12]))&&(r.disabled=c),(!B||de[0]&4)&&re(r,"chosen",J[2]),(!B||de[0]&4096)&&re(r,"unavailable",!J[12]),(!B||de[0]&4&&_!==(_=J[2]?"":"firstFocusable"))&&m(f,"id",_),(!B||de[0]&2048&&b!==(b=J[11].load.status==0))&&(f.disabled=b),(!B||de[0]&4)&&re(f,"chosen",!J[2]);let Be=k;k=ee(J),k===Be?ce[k].p(J,de):(qe(),z(ce[Be],1,1,()=>{ce[Be]=null}),We(),w=ce[k],w?w.p(J,de):(w=ce[k]=ue[k](J),w.c()),L(w,1),w.m(y,null)),(!B||de[0]&2048&&H!==(H=J[11].load.status==0))&&(T.disabled=H),(!B||de[0]&2048&&Z!==(Z=J[11].load.status==0))&&(S.disabled=Z),J[2]?j?(j.p(J,de),de[0]&4&&L(j,1)):(j=Rl(J),j.c(),L(j,1),j.m(e,null)):j&&(qe(),z(j,1,1,()=>{j=null}),We())},i(J){B||(L(w),L(j),J&&ve(()=>{B&&(F||(F=me(e,Ye,{duration:250},!0)),F.run(1))}),B=!0)},o(J){z(w),z(j),J&&(F||(F=me(e,Ye,{duration:250},!1)),F.run(0)),B=!1},d(J){J&&R(e),ce[k].d(),n[27](null),j&&j.d(),J&&F&&F.end(),G=!1,be(Y)}}}function Rg(n,e,t){let i,s,o;Q(n,X,j=>t(11,i=j)),Q(n,Rt,j=>t(34,s=j)),Q(n,xt,j=>t(12,o=j));const r=Gt();let l,a,c,u,d,f,h=o,_=!1,b=o?Object.entries(s)[0]:null,v,y="";function k(){if(!h&&!y.startsWith("-")){U(X,i.load.status=-1,i),U(X,i.message="invalid_id",i);return}let j=ou(Un(Vn,"builds"),su()),J=0;U(X,i.load.status=0,i),iu(j).then(de=>{let Be=h?b[1].id:y;for(let Me in de.val()){if(Me==Be){r("buildLoad",{build:de.val()[Me],id:Me});break}else J==Object.keys(de.val()).length-1&&(U(X,i.load.status=-1,i),U(X,i.message=h?"not_found":"invalid_id",i));J++}}).catch(()=>{U(X,i.load.status=-1,i),U(X,i.message="firebase_fail",i)})}const w=j=>{l&&!l.contains(j.target)&&!f.contains(j.target)&&t(8,_=!1)},I=()=>{i.load.status!=0&&o&&t(2,h=!0)},A=j=>{h&&yt(j)},q=()=>{i.load.status!=0&&t(2,h=!1)},T=j=>{h||yt(j)};function W(){d=this.offsetWidth,t(6,d)}function H(j){le[j?"unshift":"push"](()=>{l=j,t(0,l)})}function K(){u=this.offsetWidth,t(5,u)}const D=()=>{i.load.status!=0&&t(8,_=!_)};function S(j){le[j?"unshift":"push"](()=>{c=j,t(1,c)})}function O(){y=this.value,t(10,y)}const Z=j=>{t(10,y=ns(j.target.value,25))},P=j=>{i.load.status==0&&j.preventDefault()};function F(j){le[j?"unshift":"push"](()=>{a=j,t(4,a)})}const B=()=>{i.load.status!=0&&U(X,i.load.ongoing=!1,i)};function G(j){b=j,t(3,b)}function Y(j){_=j,t(8,_)}function ue(j){f=j,t(7,f)}const ce=()=>a.focus(),ee=j=>{j.key=="Escape"&&(t(8,_=!1),l.focus())};return n.$$.update=()=>{n.$$.dirty[0]&8&&t(9,v=b!=null?b[0]:null),n.$$.dirty[0]&7&&setTimeout(h?()=>l.focus():()=>c.focus())},[l,c,h,b,a,u,d,f,_,v,y,i,o,k,w,I,A,q,T,W,H,K,D,S,O,Z,P,F,B,G,Y,ue,ce,ee]}class Ag extends Te{constructor(e){super(),Ie(this,e,Rg,Dg,ge,{},null,[-1,-1])}}function Al(n){let e,t=(n[3]>n[4]*.8?n[8].slice(0,20)+"<b>...</b>":n[8])+"",i;return{c(){e=g("span"),ve(()=>n[12].call(e))},m(s,o){M(s,e,o),e.innerHTML=t,i=rn(e,n[12].bind(e))},p(s,o){o&280&&t!==(t=(s[3]>s[4]*.8?s[8].slice(0,20)+"<b>...</b>":s[8])+"")&&(e.innerHTML=t)},d(s){s&&R(e),i()}}}function Pg(n){let e,t,i,s,o,r=n[8],l,a,c,u,d,f,h,_,b,v,y,k,w,I,A,q,T,W,H,K,D,S,O,Z,P,F,B,G,Y=Al(n);f=new mt({props:{text:"I'm aware that this action is irreversible and want to erase this build from the database."}}),f.$on("toggle",n[16]);function ue(J){n[21](J)}function ce(J){n[22](J)}function ee(J){n[23](J)}let j={};return n[0]!==void 0&&(j.chosenBuild=n[0]),n[6]!==void 0&&(j.ddOpen=n[6]),n[5]!==void 0&&(j.dropdown=n[5]),D=new Qo({props:j}),le.push(()=>Pe(D,"chosenBuild",ue)),le.push(()=>Pe(D,"ddOpen",ce)),le.push(()=>Pe(D,"dropdown",ee)),{c(){e=g("div"),t=g("div"),i=g("span"),i.textContent="Delete:",s=E(),o=g("button"),Y.c(),l=E(),a=g("iconify-icon"),d=E(),oe(f.$$.fragment),h=E(),_=g("div"),b=g("div"),v=g("button"),y=te("CANCEL"),I=E(),A=g("div"),q=g("button"),T=te("DELETE"),K=E(),oe(D.$$.fragment),Re(a,"icon","iconamoon:arrow-down-2-fill"),m(o,"class","promptDDButton svelte-1nywh"),m(o,"id","firstFocusable"),o.disabled=c=n[9].delete.status==0,ve(()=>n[14].call(o)),re(o,"ddOpen",n[6]),m(t,"class","chosenBuildCont"),m(v,"id",k=n[7]?"":"lastFocusable"),v.disabled=w=n[9].delete.status==0,q.disabled=W=!n[7]||n[9].delete.status==0,m(q,"id",H=n[7]?"lastFocusable":""),re(q,"unavailable",!n[7]),m(_,"class","promptOptions svelte-1nywh"),m(e,"class","buildDeleter svelte-1nywh")},m(J,de){M(J,e,de),p(e,t),p(t,i),p(t,s),p(t,o),Y.m(o,null),p(o,l),p(o,a),n[13](o),u=rn(o,n[14].bind(o)),p(e,d),ne(f,e,null),p(e,h),p(e,_),p(_,b),p(b,v),p(v,y),n[17](v),p(_,I),p(_,A),p(A,q),p(q,T),p(e,K),ne(D,e,null),F=!0,B||(G=[N(window,"mousedown",n[11]),N(o,"click",n[15]),N(o,"keydown",yt),N(v,"click",n[18]),N(v,"keydown",n[19]),N(q,"click",n[20]),N(q,"keydown",wt),N(e,"introstart",n[24]),N(e,"keydown",n[25])],B=!0)},p(J,[de]){de&256&&ge(r,r=J[8])?(Y.d(1),Y=Al(J),Y.c(),Y.m(o,l)):Y.p(J,de),(!F||de&512&&c!==(c=J[9].delete.status==0))&&(o.disabled=c),(!F||de&64)&&re(o,"ddOpen",J[6]),(!F||de&128&&k!==(k=J[7]?"":"lastFocusable"))&&m(v,"id",k),(!F||de&512&&w!==(w=J[9].delete.status==0))&&(v.disabled=w),(!F||de&640&&W!==(W=!J[7]||J[9].delete.status==0))&&(q.disabled=W),(!F||de&128&&H!==(H=J[7]?"lastFocusable":""))&&m(q,"id",H),(!F||de&128)&&re(q,"unavailable",!J[7]);const Be={};!S&&de&1&&(S=!0,Be.chosenBuild=J[0],Ae(()=>S=!1)),!O&&de&64&&(O=!0,Be.ddOpen=J[6],Ae(()=>O=!1)),!Z&&de&32&&(Z=!0,Be.dropdown=J[5],Ae(()=>Z=!1)),D.$set(Be)},i(J){F||(L(f.$$.fragment,J),L(D.$$.fragment,J),J&&ve(()=>{F&&(P||(P=me(e,Ye,{duration:250},!0)),P.run(1))}),F=!0)},o(J){z(f.$$.fragment,J),z(D.$$.fragment,J),J&&(P||(P=me(e,Ye,{duration:250},!1)),P.run(0)),F=!1},d(J){J&&R(e),Y.d(J),n[13](null),u(),ie(f),n[17](null),ie(D),J&&P&&P.end(),B=!1,be(G)}}}function Mg(n,e,t){let i,s,o,r;Q(n,X,P=>t(9,s=P)),Q(n,Rt,P=>t(26,o=P)),Q(n,kt,P=>t(27,r=P));let l,a,c,u,d,f=!1,h=Object.entries(o)[0],_=!1;function b(){U(X,s.delete.status=0,s);let P=h[1].id;v_(Jt(Un(Vn),`builds/${P}`)).then(()=>{U(X,s.delete.status=1,s),r&&P==r.id&&U(kt,r=null,r);let F={...o};delete F[i],Ko(),Rt.update(()=>F)}).catch(F=>{U(X,s.delete.status=-1,s),U(X,s.message="firebase_fail",s)})}const v=P=>{!a.contains(P.target)&&!d.contains(P.target)&&t(6,f=!1)};function y(){c=this.offsetWidth,t(3,c)}function k(P){le[P?"unshift":"push"](()=>{a=P,t(2,a)})}function w(){u=this.offsetWidth,t(4,u)}const I=()=>{s.delete.status!=0&&t(6,f=!f)},A=P=>t(7,_=P.detail);function q(P){le[P?"unshift":"push"](()=>{l=P,t(1,l)})}const T=()=>{s.delete.status!=0&&U(X,s.delete.ongoing=!1,s)},W=P=>{_||wt(P)},H=()=>{_&&s.delete.status!=0&&b()};function K(P){h=P,t(0,h)}function D(P){f=P,t(6,f)}function S(P){d=P,t(5,d)}const O=()=>l.focus(),Z=P=>{P.key=="Escape"&&(t(6,f=!1),a.focus())};return n.$$.update=()=>{n.$$.dirty&1&&t(8,i=h[0])},[h,l,a,c,u,d,f,_,i,s,b,v,y,k,w,I,A,q,T,W,H,K,D,S,O,Z]}class Lg extends Te{constructor(e){super(),Ie(this,e,Mg,Pg,ge,{})}}function Fg(n){let e,t,i,s,o,r,l,a,c,u,d,f,h,_;return{c(){e=g("div"),t=g("div"),i=g("button"),i.innerHTML='<iconify-icon icon="tabler:coins" class="svelte-1o20s8w"></iconify-icon> <span class="tooltip" id="right">Build costs</span>',s=E(),o=g("div"),r=g("button"),r.innerHTML='<iconify-icon icon="codicon:sparkle-filled" class="svelte-1o20s8w"></iconify-icon> <span class="tooltip" id="right">Add bonuses</span>',l=E(),a=g("div"),c=g("button"),c.innerHTML='<iconify-icon icon="fa-solid:random" class="svelte-1o20s8w"></iconify-icon> <span class="tooltip" id="right">Randomize build</span>',u=E(),d=g("div"),f=g("button"),f.innerHTML='<iconify-icon icon="fe:picture" class="svelte-1o20s8w"></iconify-icon> <span class="tooltip" id="right">Screenshot mode</span>',m(i,"class","svelte-1o20s8w"),m(t,"class","svelte-1o20s8w"),m(r,"class","svelte-1o20s8w"),m(o,"class","svelte-1o20s8w"),m(c,"class","svelte-1o20s8w"),m(a,"id","randomize"),m(a,"class","svelte-1o20s8w"),m(f,"class","svelte-1o20s8w"),m(d,"id","screenshot"),m(d,"class","svelte-1o20s8w"),m(e,"class","sideFeatures svelte-1o20s8w")},m(b,v){M(b,e,v),p(e,t),p(t,i),p(e,s),p(e,o),p(o,r),p(e,l),p(e,a),p(a,c),p(e,u),p(e,d),p(d,f),h||(_=[N(i,"click",n[2]),N(r,"click",n[3]),N(c,"click",n[4]),N(f,"click",n[5])],h=!0)},p:se,i:se,o:se,d(b){b&&R(e),h=!1,be(_)}}}function Bg(n,e,t){let i,s;return Q(n,yn,c=>t(0,i=c)),Q(n,X,c=>t(1,s=c)),[i,s,c=>{on(c),i||U(X,s.costs.ongoing=!0,s)},c=>{on(c),i||U(X,s.bonus.ongoing=!0,s)},c=>{on(c),i||U(X,s.randomize.ongoing=!0,s)},()=>{i||(U(X,s.screenshot.ongoing=!0,s),setTimeout(()=>U(X,s.screenshot.ongoing=!1,s),3500))}]}class qg extends Te{constructor(e){super(),Ie(this,e,Bg,Fg,ge,{})}}function Pl(n,e,t){const i=n.slice();i[11]=e[t];const s=i[1].bonuses[0].name==i[11].name;return i[12]=s,i}function Ml(n){let e,t,i,s,o,r,l,a,c,u,d,f;function h(...b){return n[5](n[12],...b)}function _(...b){return n[6](n[11],...b)}return a=new mt({props:{text:n[11].name,checked:n[2][n[11].name]}}),a.$on("toggle",_),{c(){e=g("div"),t=g("a"),i=g("img"),l=E(),oe(a.$$.fragment),c=E(),$e(i.src,s=n[11].image)||m(i,"src",s),m(i,"alt",""),m(i,"class","svelte-1i20pwb"),m(t,"id",o=n[12]?"firstFocusable":""),m(t,"href",r=n[11].link),m(t,"target","_blank"),m(t,"class","svelte-1i20pwb"),m(e,"class","svelte-1i20pwb")},m(b,v){M(b,e,v),p(e,t),p(t,i),p(e,l),ne(a,e,null),p(e,c),u=!0,d||(f=N(t,"keydown",h),d=!0)},p(b,v){n=b,(!u||v&2&&!$e(i.src,s=n[11].image))&&m(i,"src",s),(!u||v&2&&o!==(o=n[12]?"firstFocusable":""))&&m(t,"id",o),(!u||v&2&&r!==(r=n[11].link))&&m(t,"href",r);const y={};v&2&&(y.text=n[11].name),v&6&&(y.checked=n[2][n[11].name]),a.$set(y)},i(b){u||(L(a.$$.fragment,b),u=!0)},o(b){z(a.$$.fragment,b),u=!1},d(b){b&&R(e),ie(a),d=!1,f()}}}function Wg(n){let e,t,i,s,o,r,l,a,c,u,d,f,h,_=Ne(n[1].bonuses),b=[];for(let y=0;y<_.length;y+=1)b[y]=Ml(Pl(n,_,y));const v=y=>z(b[y],1,1,()=>{b[y]=null});return{c(){e=g("div"),t=g("div");for(let y=0;y<b.length;y+=1)b[y].c();i=E(),s=g("div"),o=g("div"),r=g("button"),r.textContent="CLEAR",l=E(),a=g("div"),c=g("button"),c.textContent="OK",m(t,"class","bonusesCont svelte-1i20pwb"),m(c,"id","lastFocusable"),m(s,"class","promptOptions svelte-1i20pwb"),m(e,"class","bonusChooser svelte-1i20pwb")},m(y,k){M(y,e,k),p(e,t);for(let w=0;w<b.length;w+=1)b[w]&&b[w].m(t,null);p(e,i),p(e,s),p(s,o),p(o,r),p(s,l),p(s,a),p(a,c),n[8](c),d=!0,f||(h=[N(r,"click",n[7]),N(c,"click",n[9]),N(c,"keydown",wt),N(e,"introstart",n[10])],f=!0)},p(y,[k]){if(k&14){_=Ne(y[1].bonuses);let w;for(w=0;w<_.length;w+=1){const I=Pl(y,_,w);b[w]?(b[w].p(I,k),L(b[w],1)):(b[w]=Ml(I),b[w].c(),L(b[w],1),b[w].m(t,null))}for(qe(),w=_.length;w<b.length;w+=1)v(w);We()}},i(y){if(!d){for(let k=0;k<_.length;k+=1)L(b[k]);y&&ve(()=>{d&&(u||(u=me(e,Ye,{duration:250},!0)),u.run(1))}),d=!0}},o(y){b=b.filter(Boolean);for(let k=0;k<b.length;k+=1)z(b[k]);y&&(u||(u=me(e,Ye,{duration:250},!1)),u.run(0)),d=!1},d(y){y&&R(e),ht(b,y),n[8](null),y&&u&&u.end(),f=!1,be(h)}}}function jg(n,e,t){let i,s,o,r;Q(n,Bt,_=>t(1,i=_)),Q(n,Mn,_=>t(2,s=_)),Q(n,bt,_=>t(3,o=_)),Q(n,X,_=>t(4,r=_));let l;const a=(_,b)=>{_&&yt(b)},c=(_,b)=>{U(Mn,s[_.name]=b.detail,s);for(let v in o)b.detail?U(bt,o[v]+=_.stats[v],o):U(bt,o[v]-=_.stats[v],o),U(bt,o[v]=Math.round(o[v]*10)/10,o)},u=()=>{for(let _ in s){if(!s[_])continue;let b=i.bonuses.find(v=>v.name==_);U(Mn,s[_]=!1,s);for(let v in o)U(bt,o[v]-=b.stats[v],o),U(bt,o[v]=Math.round(o[v]*10)/10,o)}};function d(_){le[_?"unshift":"push"](()=>{l=_,t(0,l)})}return[l,i,s,o,r,a,c,u,d,()=>U(X,r.bonus.ongoing=!1,r),()=>l.focus()]}class Hg extends Te{constructor(e){super(),Ie(this,e,jg,Wg,ge,{})}}function zg(n){let e;return{c(){e=g("span"),e.textContent=`Includes equipment such as ore-based armor and their variants,\r
            ore-based weapons, and shoes with no special stats`,m(e,"slot","tooltip"),m(e,"class","tooltip svelte-21yikp"),m(e,"id","right")},m(t,i){M(t,e,i)},p:se,d(t){t&&R(e)}}}function Ug(n){let e,t,i,s,o,r,l,a,c,u,d,f,h,_,b,v,y,k,w,I,A,q,T,W,H,K;return s=new mt({props:{text:"Force Mushroom Parasol",checked:n[0].parasol,first:!0}}),s.$on("toggle",n[5]),r=new mt({props:{text:"Randomize armor",checked:n[0].armor}}),r.$on("toggle",n[6]),a=new mt({props:{text:"Randomize gear",checked:n[0].gear}}),a.$on("toggle",n[7]),u=new mt({props:{text:"Allow 'basic' equipment",checked:n[0].basic,$$slots:{tooltip:[zg]},$$scope:{ctx:n}}}),u.$on("toggle",n[8]),{c(){e=g("div"),t=g("span"),t.textContent="Randomize your build",i=E(),oe(s.$$.fragment),o=E(),oe(r.$$.fragment),l=E(),oe(a.$$.fragment),c=E(),oe(u.$$.fragment),d=E(),f=g("div"),h=g("div"),_=g("button"),b=te("CANCEL"),y=E(),k=g("div"),w=g("button"),I=te("ROLL THE DICE"),m(t,"class","svelte-21yikp"),m(_,"id",v=n[2]?"":"lastFocusable"),m(w,"id",A=n[2]?"lastFocusable":""),w.disabled=q=!n[2],m(f,"class","promptOptions"),m(e,"class","buildRandomizer svelte-21yikp")},m(D,S){M(D,e,S),p(e,t),p(e,i),ne(s,e,null),p(e,o),ne(r,e,null),p(e,l),ne(a,e,null),p(e,c),ne(u,e,null),p(e,d),p(e,f),p(f,h),p(h,_),p(_,b),n[9](_),p(f,y),p(f,k),p(k,w),p(w,I),W=!0,H||(K=[N(_,"click",n[10]),N(_,"keydown",n[11]),N(w,"click",n[12]),N(w,"keydown",n[13]),N(e,"introstart",n[14])],H=!0)},p(D,[S]){const O={};S&1&&(O.checked=D[0].parasol),s.$set(O);const Z={};S&1&&(Z.checked=D[0].armor),r.$set(Z);const P={};S&1&&(P.checked=D[0].gear),a.$set(P);const F={};S&1&&(F.checked=D[0].basic),S&16777216&&(F.$$scope={dirty:S,ctx:D}),u.$set(F),(!W||S&4&&v!==(v=D[2]?"":"lastFocusable"))&&m(_,"id",v),(!W||S&4&&A!==(A=D[2]?"lastFocusable":""))&&m(w,"id",A),(!W||S&4&&q!==(q=!D[2]))&&(w.disabled=q)},i(D){W||(L(s.$$.fragment,D),L(r.$$.fragment,D),L(a.$$.fragment,D),L(u.$$.fragment,D),D&&ve(()=>{W&&(T||(T=me(e,Ye,{duration:250},!0)),T.run(1))}),W=!0)},o(D){z(s.$$.fragment,D),z(r.$$.fragment,D),z(a.$$.fragment,D),z(u.$$.fragment,D),D&&(T||(T=me(e,Ye,{duration:250},!1)),T.run(0)),W=!1},d(D){D&&R(e),ie(s),ie(r),ie(a),ie(u),n[9](null),D&&T&&T.end(),H=!1,be(K)}}}function Gg(n,e,t){let i,s,o,r,l,a,c,u;Q(n,$n,D=>t(0,s=D)),Q(n,X,D=>t(3,o=D)),Q(n,Bt,D=>t(15,r=D)),Q(n,Wn,D=>t(16,l=D)),Q(n,zt,D=>t(17,a=D)),Q(n,qn,D=>t(18,c=D)),Q(n,qt,D=>t(19,u=D));let d,f=["Bronze","Iron","Cobalt","Titanium","Gold","Onyx"],h=["Hardened","Royal"],_=["Black","Brown","Green","Red","White","Dark","Golden","Grey","Phantom"];function b(){if(s.armor){for(let D of Gn){let S=u[D]||ys;S.name&&c[D][S.name].querySelector("button").click()}setTimeout(()=>{for(let D of Gn)(function S(){let O=Math.floor(Math.random()*r[D].length);!c[D][r[D][O].name].classList.contains("selectedItem")&&(s.basic||!s.basic&&!v(r[D][O].name))?c[D][r[D][O].name].querySelector("button").click():S()})()})}if(s.gear){for(let D in a){let S=a[D]||ws;S.name&&l[D][S.name].querySelector("button").click()}setTimeout(()=>{let D=!1,S=Sn.length,O=Sn.length,Z=[];for(let P in a)Z.push(a[P].name);(function P(){setTimeout(()=>{let F=Math.floor(Math.random()*S);(function B(){let G=Math.floor(Math.random()*r.gear.length);!Z.includes(r.gear[G].name)&&!l[O][r.gear[G].name].classList.contains("switchable")&&(!D||D&&G!=0)&&(s.basic||!s.basic&&!v(r.gear[G].name))?(l[O][r.gear[!D&&s.parasol&&!F?0:G].name].querySelector("button").click(),!D&&!F?D=!0:D||S--):B()})(),--O&&P()},25)})()},50)}U(X,o.randomize.ongoing=!1,o)}function v(D){let S=!1,O=D.split(" ");return S=f.includes(O[0])||h.includes(O[0])||D=="Mining Helmet"||_.includes(O[0]),S}const y=D=>U($n,s.parasol=D.detail,s),k=D=>U($n,s.armor=D.detail,s),w=D=>U($n,s.gear=D.detail,s),I=D=>U($n,s.basic=D.detail,s);function A(D){le[D?"unshift":"push"](()=>{d=D,t(1,d)})}const q=()=>U(X,o.randomize.ongoing=!1,o),T=D=>{i||wt(D)},W=()=>{i&&b()},H=D=>{i&&wt(D)},K=()=>d.focus();return n.$$.update=()=>{n.$$.dirty&1&&t(2,i=s.armor||s.gear)},[s,d,i,o,b,y,k,w,I,A,q,T,W,H,K]}class Vg extends Te{constructor(e){super(),Ie(this,e,Gg,Ug,ge,{})}}function Ll(n,e,t){const i=n.slice();return i[5]=e[t],i}function Kg(n){let e,t=Ne(n[1]),i=[];for(let s=0;s<t.length;s+=1)i[s]=Fl(Ll(n,t,s));return{c(){for(let s=0;s<i.length;s+=1)i[s].c();e=pt()},m(s,o){for(let r=0;r<i.length;r+=1)i[r]&&i[r].m(s,o);M(s,e,o)},p(s,o){if(o&2){t=Ne(s[1]);let r;for(r=0;r<t.length;r+=1){const l=Ll(s,t,r);i[r]?i[r].p(l,o):(i[r]=Fl(l),i[r].c(),i[r].m(e.parentNode,e))}for(;r<i.length;r+=1)i[r].d(1);i.length=t.length}},d(s){s&&R(e),ht(i,s)}}}function Yg(n){let e,t,i;return{c(){e=g("span"),t=te("— "),i=te(n[1]),m(e,"id","info"),m(e,"class","svelte-155nax9")},m(s,o){M(s,e,o),p(e,t),p(e,i)},p(s,o){o&2&&Ee(i,s[1])},d(s){s&&R(e)}}}function Fl(n){let e,t,i=n[5]+"",s;return{c(){e=g("span"),t=te("— "),s=te(i),m(e,"id","info"),m(e,"class","svelte-155nax9")},m(o,r){M(o,e,r),p(e,t),p(e,s)},p(o,r){r&2&&i!==(i=o[5]+"")&&Ee(s,i)},d(o){o&&R(e)}}}function Qg(n){let e,t,i,s,o,r,l;function a(d,f){return typeof d[1]=="string"?Yg:Kg}let c=a(n),u=c(n);return{c(){e=g("li"),t=g("span"),i=te("v"),s=te(n[0]),o=E(),r=g("i"),r.textContent=`${n[3][n[2][1]-1]+" "+n[2][0]+(Math.floor(n[2][0]/10)===1?"th":uu[n[2][0]%10])+", 20"+n[2][2]}`,l=E(),u.c(),m(t,"id","version"),m(t,"class","svelte-155nax9"),m(r,"id","date"),m(r,"class","svelte-155nax9"),m(e,"class","svelte-155nax9")},m(d,f){M(d,e,f),p(e,t),p(t,i),p(t,s),p(e,o),p(e,r),p(e,l),u.m(e,null)},p(d,[f]){f&1&&Ee(s,d[0]),c===(c=a(d))&&u?u.p(d,f):(u.d(1),u=c(d),u&&(u.c(),u.m(e,null)))},i:se,o:se,d(d){d&&R(e),u.d()}}}function Jg(n,e,t){let{version:i,date:s,text:o}=e,r=s.split("/"),l=["January","February","March","April","May","June","July","August","Semptember","October","November","December"];return n.$$set=a=>{"version"in a&&t(0,i=a.version),"date"in a&&t(4,s=a.date),"text"in a&&t(1,o=a.text)},[i,o,r,l,s]}class rt extends Te{constructor(e){super(),Ie(this,e,Jg,Qg,ge,{version:0,date:4,text:1})}}function Xg(n){let e,t,i,s,o,r,l,a,c,u,d,f,h,_,b,v,y,k,w,I,A,q,T,W,H,K,D,S,O,Z,P,F,B,G,Y,ue,ce,ee,j,J,de,Be,Me,Oe,nt,je,De,ze,_e;return o=new rt({props:{version:"3.26.7",date:"5/4/24",text:["Added special ability cooldown stat to gears","Fixed page size and zoom occasionally breaking"]}}),l=new rt({props:{version:"3.26.6",date:"28/3/24",text:"Added 'support me' link in the case of any kind act"}}),c=new rt({props:{version:"3.26.5",date:"22/3/24",text:"Added policy information"}}),d=new rt({props:{version:"3.26.4",date:"21/3/24",text:["Added feature to copy stats as text","Fixed detailed view prompt activating while scrolling"]}}),h=new rt({props:{version:"3.26.3",date:"24/2/24",text:"Reimplemented 'Strict' filter type in search options"}}),b=new rt({props:{version:"3.26.2",date:"22/2/24",text:"Fixed build randomizer not working properly"}}),y=new rt({props:{version:"3.26.1",date:"22/2/24",text:"Holding Shift and interacting with a dropdown item or simply holding down on it activates detailed view prompt"}}),w=new rt({props:{version:"3.26.0",date:"21/2/24",text:"Added detailed view prompt to armor and gear whenever the selected item's icon is clicked"}}),A=new rt({props:{version:"3.25.9",date:"14/1/24",text:"Added build costs visibility while 'screenshot mode' is active"}}),T=new rt({props:{version:"3.25.8",date:"11/1/24",text:"Fixed mutually exclusive gear staying disabled when deselecting the selected item"}}),H=new rt({props:{version:"3.25.7",date:"9/1/24",text:["Enabled 'unsaved changes' prompt to appear before leaving site when certain conditions are met","Fixed dropdowns blocking interactions behind them for a short period after being closed","Fixed dropdown sort incorrectly defaulting to the last sorted list in some cases"]}}),D=new rt({props:{version:"3.25.6",date:"7/1/24",text:"Fixed armor filter not working properly when 'Exclusive' filter type and 'No Stats' option were selected"}}),O=new rt({props:{version:"3.25.5",date:"6/1/24",text:["Fixed issue with switching gear slots while full weapon view was on","Tools are now selectable even if full weapon view is on"]}}),P=new rt({props:{version:"3.25.4",date:"5/1/24",text:'Fixed crash caused by using the build randomizer while "Force Mushroom Parasol" option was on'}}),B=new rt({props:{version:"3.25.3",date:"5/1/24",text:["Added feature to swap gear slots when clicking on an already selected gear item","Added visual cues to both deselecting and swapping options for dropdown items"]}}),Y=new rt({props:{version:"3.25.2",date:"3/1/24",text:["Replaced 'Strict' filter type with 'Exclusive' filter type in search options of dropdowns","Added icons to resource links and credits"]}}),ce=new rt({props:{version:"3.25.1",date:"2/1/24",text:`"Allow 'basic' equipment" option is no longer restricted when "Randomize gear" option isn't selected in the build randomizer`}}),j=new rt({props:{version:"3.25.0",date:"2/1/24",text:["Added 'Build Costs' feature","Removed spectacles from 'basic' equipment pool in the build randomizer"]}}),de=new rt({props:{version:"3.24.5",date:"31/12/23",text:"v3 Release"}}),{c(){e=g("div"),t=g("span"),t.textContent="Changelog",i=E(),s=g("ul"),oe(o.$$.fragment),r=E(),oe(l.$$.fragment),a=E(),oe(c.$$.fragment),u=E(),oe(d.$$.fragment),f=E(),oe(h.$$.fragment),_=E(),oe(b.$$.fragment),v=E(),oe(y.$$.fragment),k=E(),oe(w.$$.fragment),I=E(),oe(A.$$.fragment),q=E(),oe(T.$$.fragment),W=E(),oe(H.$$.fragment),K=E(),oe(D.$$.fragment),S=E(),oe(O.$$.fragment),Z=E(),oe(P.$$.fragment),F=E(),oe(B.$$.fragment),G=E(),oe(Y.$$.fragment),ue=E(),oe(ce.$$.fragment),ee=E(),oe(j.$$.fragment),J=E(),oe(de.$$.fragment),Be=E(),Me=g("div"),Oe=g("div"),nt=g("button"),nt.textContent="OK",m(t,"id","title"),m(s,"id","contents"),m(s,"class","svelte-15kc2i1"),m(nt,"id","firstFocusable lastFocusable"),m(Me,"class","promptOptions svelte-15kc2i1"),m(e,"class","infoPrompt svelte-15kc2i1")},m(ae,gt){M(ae,e,gt),p(e,t),p(e,i),p(e,s),ne(o,s,null),p(s,r),ne(l,s,null),p(s,a),ne(c,s,null),p(s,u),ne(d,s,null),p(s,f),ne(h,s,null),p(s,_),ne(b,s,null),p(s,v),ne(y,s,null),p(s,k),ne(w,s,null),p(s,I),ne(A,s,null),p(s,q),ne(T,s,null),p(s,W),ne(H,s,null),p(s,K),ne(D,s,null),p(s,S),ne(O,s,null),p(s,Z),ne(P,s,null),p(s,F),ne(B,s,null),p(s,G),ne(Y,s,null),p(s,ue),ne(ce,s,null),p(s,ee),ne(j,s,null),p(s,J),ne(de,s,null),p(e,Be),p(e,Me),p(Me,Oe),p(Oe,nt),n[2](nt),De=!0,ze||(_e=[N(nt,"click",n[3]),N(nt,"keydown",n[4]),N(e,"introstart",n[5])],ze=!0)},p:se,i(ae){De||(L(o.$$.fragment,ae),L(l.$$.fragment,ae),L(c.$$.fragment,ae),L(d.$$.fragment,ae),L(h.$$.fragment,ae),L(b.$$.fragment,ae),L(y.$$.fragment,ae),L(w.$$.fragment,ae),L(A.$$.fragment,ae),L(T.$$.fragment,ae),L(H.$$.fragment,ae),L(D.$$.fragment,ae),L(O.$$.fragment,ae),L(P.$$.fragment,ae),L(B.$$.fragment,ae),L(Y.$$.fragment,ae),L(ce.$$.fragment,ae),L(j.$$.fragment,ae),L(de.$$.fragment,ae),ae&&ve(()=>{De&&(je||(je=me(e,Ye,{duration:250},!0)),je.run(1))}),De=!0)},o(ae){z(o.$$.fragment,ae),z(l.$$.fragment,ae),z(c.$$.fragment,ae),z(d.$$.fragment,ae),z(h.$$.fragment,ae),z(b.$$.fragment,ae),z(y.$$.fragment,ae),z(w.$$.fragment,ae),z(A.$$.fragment,ae),z(T.$$.fragment,ae),z(H.$$.fragment,ae),z(D.$$.fragment,ae),z(O.$$.fragment,ae),z(P.$$.fragment,ae),z(B.$$.fragment,ae),z(Y.$$.fragment,ae),z(ce.$$.fragment,ae),z(j.$$.fragment,ae),z(de.$$.fragment,ae),ae&&(je||(je=me(e,Ye,{duration:250},!1)),je.run(0)),De=!1},d(ae){ae&&R(e),ie(o),ie(l),ie(c),ie(d),ie(h),ie(b),ie(y),ie(w),ie(A),ie(T),ie(H),ie(D),ie(O),ie(P),ie(B),ie(Y),ie(ce),ie(j),ie(de),n[2](null),ae&&je&&je.end(),ze=!1,be(_e)}}}function Zg(n,e,t){let i;Q(n,X,c=>t(1,i=c));let s;function o(c){le[c?"unshift":"push"](()=>{s=c,t(0,s)})}return[s,i,o,()=>U(X,i.changelog.ongoing=!1,i),c=>{yt(c),wt(c)},()=>s.focus()]}class xg extends Te{constructor(e){super(),Ie(this,e,Zg,Xg,ge,{})}}function $g(n){let e,t,i,s,o,r,l,a,c,u,d,f,h,_,b,v,y,k,w,I,A,q;return{c(){e=g("div"),t=g("span"),t.textContent="Resources",i=E(),s=g("ul"),o=g("li"),r=g("iconify-icon"),l=E(),a=g("a"),a.textContent="Fantastic Frontier Wiki",c=E(),u=g("li"),u.innerHTML='<iconify-icon icon="ic:baseline-discord" class="svelte-1d9mkog"></iconify-icon> <a href="https://discord.gg/ff" target="_blank" class="svelte-1d9mkog">Fantastic Frontier Discord Server</a>',d=E(),f=g("li"),f.innerHTML='<iconify-icon icon="simple-icons:googledocs" class="svelte-1d9mkog"></iconify-icon> <a href="https://docs.google.com/document/d/1H9HXoExCDVfXx15LQ4Te-2tTjrLFB-XCbMmx44Ynld4/edit" target="_blank" class="svelte-1d9mkog">Fantastic Frontier Build List</a>',h=E(),_=g("li"),_.innerHTML='<iconify-icon icon="simple-icons:googledocs" class="svelte-1d9mkog"></iconify-icon> <a href="https://docs.google.com/document/d/15vwSRojTqZ8LI09Wq4dvGF1kSTPmH2_gECQvwlSFki8/edit" target="_blank" class="svelte-1d9mkog">Fantastic Frontier Max Stat List</a>',b=E(),v=g("div"),y=g("div"),k=g("button"),k.textContent="OK",m(t,"id","title"),Re(r,"icon","simple-icons:fandom"),Re(r,"class","svelte-1d9mkog"),m(a,"id","firstFocusable"),m(a,"href","https://fantastic-frontier-roblox.fandom.com/wiki/Fantastic_Frontier_-_Roblox_Wiki"),m(a,"target","_blank"),m(a,"class","svelte-1d9mkog"),m(o,"class","svelte-1d9mkog"),m(u,"class","svelte-1d9mkog"),m(f,"class","svelte-1d9mkog"),m(_,"class","svelte-1d9mkog"),m(s,"class","svelte-1d9mkog"),m(k,"id","lastFocusable"),m(v,"class","promptOptions"),m(e,"class","infoPrompt")},m(T,W){M(T,e,W),p(e,t),p(e,i),p(e,s),p(s,o),p(o,r),p(o,l),p(o,a),p(s,c),p(s,u),p(s,d),p(s,f),p(s,h),p(s,_),p(e,b),p(e,v),p(v,y),p(y,k),n[2](k),I=!0,A||(q=[N(a,"keydown",yt),N(k,"click",n[3]),N(k,"keydown",wt),N(e,"introstart",n[4])],A=!0)},p:se,i(T){I||(T&&ve(()=>{I&&(w||(w=me(e,Ye,{duration:250},!0)),w.run(1))}),I=!0)},o(T){T&&(w||(w=me(e,Ye,{duration:250},!1)),w.run(0)),I=!1},d(T){T&&R(e),n[2](null),T&&w&&w.end(),A=!1,be(q)}}}function eb(n,e,t){let i;Q(n,X,a=>t(1,i=a));let s;function o(a){le[a?"unshift":"push"](()=>{s=a,t(0,s)})}return[s,i,o,()=>U(X,i.resources.ongoing=!1,i),()=>s.focus()]}class tb extends Te{constructor(e){super(),Ie(this,e,eb,$g,ge,{})}}function Bl(n,e,t){const i=n.slice();return i[7]=e[t],i}function ql(n,e,t){const i=n.slice();return i[10]=e[t],i}function Wl(n){let e,t,i,s,o,r,l,a=n[1][n[7]][n[10]].toLocaleString()+" Gold",c,u;return{c(){e=g("div"),t=g("span"),t.textContent=`${n[10].charAt(0).toUpperCase()+n[10].slice(1)+":"}`,i=E(),s=g("img"),r=E(),l=g("span"),c=te(a),u=E(),m(t,"id","costTypeName"),m(t,"class","svelte-1u2pv9q"),$e(s.src,o="https://static.wikia.nocookie.net/fantastic-frontier-roblox/images/b/ba/GoldCoins.png")||m(s,"src",o),m(s,"alt",""),m(s,"class","svelte-1u2pv9q"),m(e,"class","svelte-1u2pv9q")},m(d,f){M(d,e,f),p(e,t),p(e,i),p(e,s),p(e,r),p(e,l),p(l,c),p(e,u)},p(d,f){f&2&&a!==(a=d[1][d[7]][d[10]].toLocaleString()+" Gold")&&Ee(c,a)},d(d){d&&R(e)}}}function jl(n){let e,t,i,s,o,r=Ne(["min","avg","max"]),l=[];for(let a=0;a<3;a+=1)l[a]=Wl(ql(n,r,a));return{c(){e=g("div"),t=g("span"),t.textContent=`${n[7].charAt(0).toUpperCase()+n[7].slice(1)+" Costs"}`,i=E(),s=g("div");for(let a=0;a<3;a+=1)l[a].c();o=E(),m(t,"id","subtitle"),m(t,"class","svelte-1u2pv9q"),m(s,"class","costTypes svelte-1u2pv9q"),m(e,"class","costs svelte-1u2pv9q"),m(e,"id",n[7])},m(a,c){M(a,e,c),p(e,t),p(e,i),p(e,s);for(let u=0;u<3;u+=1)l[u]&&l[u].m(s,null);p(e,o)},p(a,c){if(c&2){r=Ne(["min","avg","max"]);let u;for(u=0;u<3;u+=1){const d=ql(a,r,u);l[u]?l[u].p(d,c):(l[u]=Wl(d),l[u].c(),l[u].m(s,null))}for(;u<3;u+=1)l[u].d(1)}},d(a){a&&R(e),ht(l,a)}}}function nb(n){let e,t,i,s,o,r,l,a,c,u,d=Ne(["armor","gear","total"]),f=[];for(let h=0;h<3;h+=1)f[h]=jl(Bl(n,d,h));return{c(){e=g("div"),t=g("div");for(let h=0;h<3;h+=1)f[h].c();i=E(),s=g("div"),o=g("div"),r=g("button"),r.textContent="OK",m(t,"class","costsInfo svelte-1u2pv9q"),m(r,"id","firstFocusable lastFocusable"),m(s,"class","promptOptions svelte-1u2pv9q"),m(e,"class","buildCosts svelte-1u2pv9q")},m(h,_){M(h,e,_),p(e,t);for(let b=0;b<3;b+=1)f[b]&&f[b].m(t,null);p(e,i),p(e,s),p(s,o),p(o,r),n[3](r),a=!0,c||(u=[N(r,"click",n[4]),N(r,"keydown",n[5]),N(e,"introstart",n[6])],c=!0)},p(h,[_]){if(_&2){d=Ne(["armor","gear","total"]);let b;for(b=0;b<3;b+=1){const v=Bl(h,d,b);f[b]?f[b].p(v,_):(f[b]=jl(v),f[b].c(),f[b].m(t,null))}for(;b<3;b+=1)f[b].d(1)}},i(h){a||(h&&ve(()=>{a&&(l||(l=me(e,Ye,{duration:250},!0)),l.run(1))}),a=!0)},o(h){h&&(l||(l=me(e,Ye,{duration:250},!1)),l.run(0)),a=!1},d(h){h&&R(e),ht(f,h),n[3](null),h&&l&&l.end(),c=!1,be(u)}}}function ib(n,e,t){let i,s;Q(n,Nt,u=>t(1,i=u)),Q(n,X,u=>t(2,s=u));let o;function r(u){le[u?"unshift":"push"](()=>{o=u,t(0,o)})}return[o,i,s,r,()=>U(X,s.costs.ongoing=!1,s),u=>{yt(u),wt(u)},()=>o.focus()]}class sb extends Te{constructor(e){super(),Ie(this,e,ib,nb,ge,{})}}function Hl(n,e,t){const i=n.slice();return i[19]=e[t][0],i[20]=e[t][1],i}function zl(n,e,t){const i=n.slice();return i[11]=e[t],i}function Ul(n,e,t){const i=n.slice();return i[16]=e[t],i}function ob(n){const e=n.slice(),t=e[14]?e[5][e[2].name][e[11].name]:`${Math.round(e[11].mult*100*10)/10}<b>%</b> ${Wt[e[11].type]}`;return e[15]=t,e}function Gl(n){const e=n.slice(),t=e[5][e[2].name]!=null&&e[5][e[2].name][e[11].name]!=null;return e[14]=t,e}function rb(n){let e;return{c(){e=g("span"),e.textContent=`Slot: ${n[2].slot.charAt(0).toUpperCase()+n[2].slot.slice(1)}`},m(t,i){M(t,e,i)},p:se,d(t){t&&R(e)}}}function lb(n){let e;return{c(){e=g("span"),e.textContent=`Type: ${n[2].tool?"Tool":n[2].info.type}`},m(t,i){M(t,e,i)},p:se,d(t){t&&R(e)}}}function ab(n){let e,t,i,s,o=Ne(Object.entries(Wt)),r=[];for(let l=0;l<o.length;l+=1)r[l]=Vl(Hl(n,o,l));return{c(){e=g("div"),t=g("span"),t.textContent=`${n[2].noStats?"No stats available":"Stats:"}`,i=E(),s=g("div");for(let l=0;l<r.length;l+=1)r[l].c();m(t,"id","subtitle"),m(t,"class","svelte-1c4y2ce"),m(s,"class","svelte-1c4y2ce"),m(e,"id","itemStats"),m(e,"class","svelte-1c4y2ce")},m(l,a){M(l,e,a),p(e,t),p(e,i),p(e,s);for(let c=0;c<r.length;c+=1)r[c]&&r[c].m(s,null)},p(l,a){if(a&4){o=Ne(Object.entries(Wt));let c;for(c=0;c<o.length;c+=1){const u=Hl(l,o,c);r[c]?r[c].p(u,a):(r[c]=Vl(u),r[c].c(),r[c].m(s,null))}for(;c<r.length;c+=1)r[c].d(1);r.length=o.length}},d(l){l&&R(e),ht(r,l)}}}function cb(n){let e;function t(o,r){return o[2].tool?fb:db}let s=t(n)(n);return{c(){s.c(),e=pt()},m(o,r){s.m(o,r),M(o,e,r)},p(o,r){s.p(o,r)},d(o){o&&R(e),s.d(o)}}}function ub(n){let e,t,i,s,o,r=(n[19]=="endurance"?n[2].stats[n[19]].toFixed(2):n[2].stats[n[19]])+"",l,a;return{c(){e=g("div"),t=g("img"),s=E(),o=g("span"),l=te(r),a=E(),$e(t.src,i="stats/"+n[19]+".svg")||m(t,"src",i),m(t,"alt",n[20]),m(t,"class","svelte-1c4y2ce"),m(o,"class","statValue svelte-1c4y2ce"),m(o,"id",n[19]),re(o,"negative",n[2].stats[n[19]]<0),m(e,"class","svelte-1c4y2ce")},m(c,u){M(c,e,u),p(e,t),p(e,s),p(e,o),p(o,l),p(e,a)},p(c,u){u&4&&re(o,"negative",c[2].stats[c[19]]<0)},d(c){c&&R(e)}}}function Vl(n){let e,t=n[2].stats[n[19]]!=0&&ub(n);return{c(){t&&t.c(),e=pt()},m(i,s){t&&t.m(i,s),M(i,e,s)},p(i,s){i[2].stats[i[19]]!=0&&t.p(i,s)},d(i){i&&R(e),t&&t.d(i)}}}function db(n){let e,t,i,s,o,r=Ne(n[2].moves),l=[];for(let a=0;a<r.length;a+=1)l[a]=Ql(zl(n,r,a));return{c(){e=g("div"),t=g("div"),i=g("div"),s=g("div"),s.innerHTML='<span class="svelte-1c4y2ce">Move</span> <span class="svelte-1c4y2ce">Base Value</span> <span class="svelte-1c4y2ce">Scaling(s)</span>',o=E();for(let a=0;a<l.length;a+=1)l[a].c();m(s,"id","subtitle"),m(s,"class","svelte-1c4y2ce"),m(i,"class","svelte-1c4y2ce"),m(t,"id","itemMoves"),m(t,"class","svelte-1c4y2ce"),m(e,"id","itemMovesCont"),m(e,"class","svelte-1c4y2ce")},m(a,c){M(a,e,c),p(e,t),p(t,i),p(i,s),p(i,o);for(let u=0;u<l.length;u+=1)l[u]&&l[u].m(i,null)},p(a,c){if(c&52){r=Ne(a[2].moves);let u;for(u=0;u<r.length;u+=1){const d=zl(a,r,u);l[u]?l[u].p(d,c):(l[u]=Ql(d),l[u].c(),l[u].m(i,null))}for(;u<l.length;u+=1)l[u].d(1);l.length=r.length}},d(a){a&&R(e),ht(l,a)}}}function fb(n){let e;return{c(){e=g("div"),e.innerHTML='<span id="subtitle" class="svelte-1c4y2ce">No moves available</span>',m(e,"id","itemMovesCont"),m(e,"class","svelte-1c4y2ce"),tt(e,"text-align","center")},m(t,i){M(t,e,i)},p:se,d(t){t&&R(e)}}}function hb(n){let e,t,i,s,o,r;function l(d,f){return!d[11].type||!d[11].type.includes("/")?Kl:pb}function a(d,f){return f===Kl?ob(d):d}let c=l(n),u=c(a(n,c));return{c(){e=g("div"),t=g("span"),t.textContent=`${n[11].name}`,i=E(),s=g("span"),s.textContent=`${(n[11].name.includes("Fantastic Beamstorm")?"~":"")+n[11].base}`,o=E(),u.c(),r=E(),m(t,"class","svelte-1c4y2ce"),m(s,"class","svelte-1c4y2ce"),m(e,"class","svelte-1c4y2ce")},m(d,f){M(d,e,f),p(e,t),p(e,i),p(e,s),p(e,o),u.m(e,null),p(e,r)},p(d,f){u.p(a(d,c),f)},d(d){d&&R(e),u.d()}}}function pb(n){let e,t=Ne(n[11].type.split("/")),i=[];for(let s=0;s<t.length;s+=1)i[s]=Yl(Ul(n,t,s));return{c(){e=g("span");for(let s=0;s<i.length;s+=1)i[s].c();m(e,"id","hybrid"),m(e,"class","svelte-1c4y2ce")},m(s,o){M(s,e,o);for(let r=0;r<i.length;r+=1)i[r]&&i[r].m(e,null)},p(s,o){if(o&4){t=Ne(s[11].type.split("/"));let r;for(r=0;r<t.length;r+=1){const l=Ul(s,t,r);i[r]?i[r].p(l,o):(i[r]=Yl(l),i[r].c(),i[r].m(e,null))}for(;r<i.length;r+=1)i[r].d(1);i.length=t.length}},d(s){s&&R(e),ht(i,s)}}}function Kl(n){let e,t=n[15]+"";return{c(){e=g("span"),m(e,"class","svelte-1c4y2ce"),tt(e,"font-size",n[15].length>30?"2.5rem":"")},m(i,s){M(i,e,s),e.innerHTML=t},p:se,d(i){i&&R(e)}}}function Yl(n){let e,t=Math.round(n[11][`${n[16]}Mult`]*100*10)/10+"",i,s,o,r=Wt[n[16]]+"",l,a;return{c(){e=g("span"),i=te(t),s=g("b"),s.textContent="%",o=E(),l=te(r),a=E()},m(c,u){M(c,e,u),p(e,i),p(e,s),p(e,o),p(e,l),p(e,a)},p:se,d(c){c&&R(e)}}}function Ql(n){let e=!n[4].includes(n[11].name),t,i=e&&hb(Gl(n));return{c(){i&&i.c(),t=pt()},m(s,o){i&&i.m(s,o),M(s,t,o)},p(s,o){e&&i.p(Gl(s),o)},d(s){s&&R(t),i&&i.d(s)}}}function _b(n){let e,t,i,s,o,r,l,a,c,u,d,f,h,_,b,v,y,k,w,I,A,q,T,W,H,K,D,S,O,Z,P,F,B,G,Y,ue,ce,ee,j,J;function de(De,ze){return De[3]?lb:rb}let Me=de(n)(n);function Oe(De,ze){return De[3]?cb:ab}let je=Oe(n)(n);return{c(){e=g("div"),t=g("div"),i=g("a"),s=g("img"),r=E(),l=g("div"),a=g("span"),a.textContent="Click the image in order to visit the wiki page",c=E(),u=g("span"),u.textContent=`Name: ${n[2].name}`,d=E(),Me.c(),f=E(),je.c(),h=E(),_=g("div"),b=g("span"),b.textContent="Costs:",v=E(),y=g("div"),k=g("div"),w=g("span"),w.textContent="Minimum:",I=E(),A=g("img"),T=E(),W=g("span"),W.textContent=`${n[2].cost.min==null?"Unpurchasable":n[2].cost.min.toLocaleString()+" Gold"}`,H=E(),K=g("div"),D=g("span"),D.textContent="Maximum:",S=E(),O=g("img"),P=E(),F=g("span"),F.textContent=`${n[2].cost.max==null?"Unpurchasable":n[2].cost.max.toLocaleString()+" Gold"}`,B=E(),G=g("div"),Y=g("div"),ue=g("button"),ue.textContent="OK",$e(s.src,o=n[2].image)||m(s,"src",o),m(s,"alt",""),m(s,"class","svelte-1c4y2ce"),m(i,"href",n[2].link),m(i,"target","_blank"),m(i,"class","svelte-1c4y2ce"),m(a,"id","tip"),m(a,"class","svelte-1c4y2ce"),m(l,"class","svelte-1c4y2ce"),m(t,"id","basicInfo"),m(t,"class","svelte-1c4y2ce"),m(b,"id","subtitle"),m(b,"class","svelte-1c4y2ce"),m(w,"class","svelte-1c4y2ce"),$e(A.src,q="https://static.wikia.nocookie.net/fantastic-frontier-roblox/images/b/ba/GoldCoins.png")||m(A,"src",q),m(A,"alt",""),m(A,"class","svelte-1c4y2ce"),m(W,"class","svelte-1c4y2ce"),m(k,"class","svelte-1c4y2ce"),m(D,"class","svelte-1c4y2ce"),$e(O.src,Z="https://static.wikia.nocookie.net/fantastic-frontier-roblox/images/b/ba/GoldCoins.png")||m(O,"src",Z),m(O,"alt",""),m(O,"class","svelte-1c4y2ce"),m(F,"class","svelte-1c4y2ce"),m(K,"class","svelte-1c4y2ce"),m(y,"class","svelte-1c4y2ce"),m(_,"id","itemCosts"),m(_,"class","svelte-1c4y2ce"),m(ue,"id","firstFocusable lastFocusable"),m(G,"class","promptOptions svelte-1c4y2ce"),m(e,"class","itemInfo svelte-1c4y2ce")},m(De,ze){M(De,e,ze),p(e,t),p(t,i),p(i,s),p(t,r),p(t,l),p(l,a),p(l,c),p(l,u),p(l,d),Me.m(l,null),p(e,f),je.m(e,null),p(e,h),p(e,_),p(_,b),p(_,v),p(_,y),p(y,k),p(k,w),p(k,I),p(k,A),p(k,T),p(k,W),p(y,H),p(y,K),p(K,D),p(K,S),p(K,O),p(K,P),p(K,F),p(e,B),p(e,G),p(G,Y),p(Y,ue),n[6](ue),ee=!0,j||(J=[N(ue,"click",n[7]),N(ue,"keydown",n[8]),N(e,"introstart",n[9]),N(e,"outroend",n[10])],j=!0)},p(De,[ze]){Me.p(De,ze),je.p(De,ze)},i(De){ee||(De&&ve(()=>{ee&&(ce||(ce=me(e,Ye,{duration:250},!0)),ce.run(1))}),ee=!0)},o(De){De&&(ce||(ce=me(e,Ye,{duration:250},!1)),ce.run(0)),ee=!1},d(De){De&&R(e),Me.d(),je.d(),n[6](null),De&&ce&&ce.end(),j=!1,be(J)}}}function mb(n,e,t){let i;Q(n,X,_=>t(1,i=_));let s,o=i.item.data,r=o.type=="gear",l=["Charged Basic Attack","Charged Solar Beam"],a={"Void Spike Ultradagger":{"Void Needle":"100<b>%</b> Melee - 562.5<b>%</b> Armor"},"Pureblood Dagger":{"Basic Attack":"200<b>%</b> HighestBonus - 100<b>%</b> LowerBonuses","Blood Sap":"200<b>%</b> HighestBonus - 100<b>%</b> LowerBonuses","+ HP per Blood Sap":"(200<b>%</b> HighestBonus - 100<b>%</b> LowerBonuses) / 2"},"Gnome Rocket Launcher":{"Basic Attack":"None"}};function c(_){le[_?"unshift":"push"](()=>{s=_,t(0,s)})}return[s,i,o,r,l,a,c,()=>U(X,i.item.ongoing=!1,i),_=>{yt(_),wt(_)},()=>s.focus(),()=>{o.element&&o.element.querySelector("button").focus()}]}class gb extends Te{constructor(e){super(),Ie(this,e,mb,_b,ge,{})}}function bb(n){let e,t,i,s,o,r,l,a,c,u,d,f;return{c(){e=g("div"),t=g("span"),t.textContent="Fantastic Calculator Policy",i=E(),s=g("div"),s.innerHTML=`<span id="subtitle" class="svelte-1fj0tys">About</span> <p class="svelte-1fj0tys">This tool is a passion project, one that is independent and is not
            affiliated with or sponsored by the creators of Fantastic Frontier.</p> <span id="subtitle" class="svelte-1fj0tys">Privacy Policy</span> <p class="svelte-1fj0tys">This policy explains what information Fantastic Calculator (&quot;we&quot;,
            &quot;us&quot; or &quot;our&quot;) collects, uses, and shares when you use our website.</p> <span id="subtitle" class="svelte-1fj0tys">Information We Collect</span> <p class="svelte-1fj0tys">We collect information provided by you; that is which is inputted
            directly into our tool. We also collect information about how you
            use and interact with our website, general demographic details, and
            information about your device or browser.</p> <span id="subtitle" class="svelte-1fj0tys">How We Use This Information</span> <p class="svelte-1fj0tys">Your information may be utilized to test and improve the tool, once
            the aggregated, non-identifying information provided has been
            collected and analyzed.</p> <span id="subtitle" class="svelte-1fj0tys">Contact</span> <p class="svelte-1fj0tys">For any questions or inquiries, feel free to contact us at <hl>@xt.ss</hl>.</p>`,o=E(),r=g("div"),l=g("div"),a=g("button"),a.textContent="OK",m(t,"id","title"),m(s,"id","contents"),m(a,"id","firstFocusable lastFocusable"),m(r,"class","promptOptions svelte-1fj0tys"),m(e,"class","infoPrompt svelte-1fj0tys")},m(h,_){M(h,e,_),p(e,t),p(e,i),p(e,s),p(e,o),p(e,r),p(r,l),p(l,a),n[2](a),u=!0,d||(f=[N(a,"click",n[3]),N(a,"keydown",n[4])],d=!0)},p:se,i(h){u||(h&&ve(()=>{u&&(c||(c=me(e,Ye,{duration:250},!0)),c.run(1))}),u=!0)},o(h){h&&(c||(c=me(e,Ye,{duration:250},!1)),c.run(0)),u=!1},d(h){h&&R(e),n[2](null),h&&c&&c.end(),d=!1,be(f)}}}function vb(n,e,t){let i;Q(n,X,a=>t(1,i=a));let s;function o(a){le[a?"unshift":"push"](()=>{s=a,t(0,s)})}return[s,i,o,()=>U(X,i.policy.ongoing=!1,i),a=>{yt(a),wt(a)}]}class yb extends Te{constructor(e){super(),Ie(this,e,vb,bb,ge,{})}}function wb(n){let e,t,i,s,o,r,l,a,c,u,d,f,h,_,b,v,y,k,w,I,A;return{c(){e=g("div"),t=g("span"),t.textContent="Support Me",i=E(),s=g("p"),s.textContent="Thank you for your continuous use of my site!",o=E(),r=g("p"),r.textContent=`If you would like to help improve it, as well as my other projects, you\r
        can do so through my Ko-fi, down below.`,l=E(),a=g("p"),a.textContent=`Hundreds of combined hours go into the making of these - and any\r
        donation, as small as it is, helps me continue creating more cool stuff\r
        for the community. No pressure!`,c=E(),u=g("a"),u.innerHTML='<img src="kofi-badge.png" alt="Ko-fi" class="svelte-ywc66p"/>',d=E(),f=g("div"),h=g("div"),_=g("button"),_.textContent="DON'T SHOW AGAIN",b=E(),v=g("div"),y=g("button"),y.textContent="MAYBE LATER",m(t,"id","title"),m(u,"class","flex br-1 light-hover svelte-ywc66p"),m(u,"href","https://ko-fi.com/xt8ss"),m(u,"target","_blank"),m(f,"class","promptOptions"),m(e,"class","supportCont infoPrompt svelte-ywc66p")},m(q,T){M(q,e,T),p(e,t),p(e,i),p(e,s),p(e,o),p(e,r),p(e,l),p(e,a),p(e,c),p(e,u),p(e,d),p(e,f),p(f,h),p(h,_),p(f,b),p(f,v),p(v,y),n[4](y),w=!0,I||(A=[N(_,"click",n[3]),N(y,"click",n[5]),N(e,"introstart",n[6])],I=!0)},p:se,i(q){w||(q&&ve(()=>{w&&(k||(k=me(e,Ye,{duration:250},!0)),k.run(1))}),w=!0)},o(q){q&&(k||(k=me(e,Ye,{duration:250},!1)),k.run(0)),w=!1},d(q){q&&R(e),n[4](null),q&&k&&k.end(),I=!1,be(A)}}}function kb(n,e,t){let i,s;Q(n,bn,u=>t(1,i=u)),Q(n,X,u=>t(2,s=u));let o;const r=()=>{U(bn,i.showAgain=!1,i),U(X,s.donate.ongoing=!1,s)};function l(u){le[u?"unshift":"push"](()=>{o=u,t(0,o)})}return[o,i,s,r,l,()=>{U(bn,i.timesDenied++,i),U(X,s.donate.ongoing=!1,s)},()=>o.focus()]}class Cb extends Te{constructor(e){super(),Ie(this,e,kb,wb,ge,{})}}const{document:At,window:pn}=Cu;function Jl(n,e,t){const i=n.slice();return i[53]=e[t],i}function Xl(n,e,t){const i=n.slice();return i[53]=e[t],i}function Zl(n){let e;return{c(){e=g("style"),e.textContent=`* {\r
                pointer-events: none;\r
            }\r
        `},m(t,i){M(t,e,i)},d(t){t&&R(e)}}}function xl(n){let e;return{c(){e=g("link"),m(e,"rel","preload"),m(e,"as","image"),m(e,"href",n[53])},m(t,i){M(t,e,i)},p:se,d(t){t&&R(e)}}}function $l(n){let e;return{c(){e=g("style"),e.textContent=`body > div:not(.backgrounds),\r
            main > :not(.promptCont),\r
            .backgrounds > img,\r
            #donate,\r
            #resources,\r
            #changelog,\r
            #policy {\r
                filter: blur(0.5rem);\r
                pointer-events: none;\r
            }\r
            .sideFeatures {\r
                z-index: 3;\r
            }\r
            .sideFeatures button:hover,\r
            .sideFeatures button:focus,\r
            .info:hover,\r
            .info:focus {\r
                background-color: var(--transparent);\r
            }\r
            .sideFeatures button > .tooltip,\r
            .info:not(#credits) > .tooltip {\r
                opacity: 0 !important;\r
                visibility: hidden !important;\r
            }\r
        `},m(t,i){M(t,e,i)},d(t){t&&R(e)}}}function ea(n){let e;return{c(){e=g("style"),e.textContent=`body {\r
                overflow: hidden;\r
            }\r
        `},m(t,i){M(t,e,i)},d(t){t&&R(e)}}}function ta(n){let e;return{c(){e=g("style"),e.textContent=`body {\r
                pointer-events: none;\r
            }\r
            #donate,\r
            #resources,\r
            #changelog,\r
            #policy,\r
            .mainFeatures,\r
            .sideFeatures,\r
            .statBox > .toggleCont,\r
            .ddButton > iconify-icon,\r
            .copyStatsButton {\r
                opacity: 0;\r
                visibility: hidden;\r
            }\r
            .gearBox .ddButton > iconify-icon {\r
                width: 15% !important;\r
            }\r
            .eqSlotIcon button > .tooltip,\r
            .gearSlotIcon button > .tooltip {\r
                opacity: 1;\r
                visibility: visible;\r
            }\r
            .calcBox {\r
                translate: -3%;\r
            }\r
            .currentBuild {\r
                left: 50% !important;\r
                padding: 2rem !important;\r
            }\r
            .currentBuild > button {\r
                min-width: 0 !important;\r
                width: 0;\r
                opacity: 0;\r
                visibility: hidden;\r
            }`},m(t,i){M(t,e,i)},d(t){t&&R(e)}}}function na(n){let e,t;return{c(){e=g("img"),m(e,"class","background svelte-v3bd1x"),$e(e.src,t=n[53])||m(e,"src",t),m(e,"alt",""),re(e,"active",n[20].indexOf(n[53])==n[8])},m(i,s){M(i,e,s)},p(i,s){s[0]&1048832&&re(e,"active",i[20].indexOf(i[53])==i[8])},d(i){i&&R(e)}}}function ia(n){let e,t,i=Math.floor(n[17][n[2]]*100)+"",s,o,r,l;return{c(){e=g("span"),t=te("Zoom: "),s=te(i),o=g("b"),o.textContent="%",m(e,"class","info svelte-v3bd1x"),m(e,"id","zoomLevel")},m(a,c){M(a,e,c),p(e,t),p(e,s),p(e,o),l=!0},p(a,c){(!l||c[0]&4)&&i!==(i=Math.floor(a[17][a[2]]*100)+"")&&Ee(s,i)},i(a){l||(a&&ve(()=>{l&&(r||(r=me(e,Xe,{duration:150},!0)),r.run(1))}),l=!0)},o(a){a&&(r||(r=me(e,Xe,{duration:150},!1)),r.run(0)),l=!1},d(a){a&&R(e),a&&r&&r.end()}}}function sa(n){let e,t,i,s,o,r,l,a,c=n[16].armor.avg.toLocaleString()+" Gold",u,d,f,h,_,b,v,y,k,w=n[16].gear.avg.toLocaleString()+" Gold",I,A,q;return{c(){e=g("div"),t=g("div"),i=g("span"),i.textContent="Avg. armor cost:",s=E(),o=g("img"),l=E(),a=g("span"),u=te(c),d=E(),f=g("div"),h=g("span"),h.textContent="Avg. gear cost:",_=E(),b=g("img"),y=E(),k=g("span"),I=te(w),$e(o.src,r="https://static.wikia.nocookie.net/fantastic-frontier-roblox/images/b/ba/GoldCoins.png")||m(o,"src",r),m(o,"alt",""),m(o,"class","svelte-v3bd1x"),m(t,"class","svelte-v3bd1x"),$e(b.src,v="https://static.wikia.nocookie.net/fantastic-frontier-roblox/images/b/ba/GoldCoins.png")||m(b,"src",v),m(b,"alt",""),m(b,"class","svelte-v3bd1x"),m(f,"class","svelte-v3bd1x"),m(e,"class","costPreview svelte-v3bd1x"),m(e,"id","specific")},m(T,W){M(T,e,W),p(e,t),p(t,i),p(t,s),p(t,o),p(t,l),p(t,a),p(a,u),p(e,d),p(e,f),p(f,h),p(f,_),p(f,b),p(f,y),p(f,k),p(k,I),q=!0},p(T,W){(!q||W[0]&65536)&&c!==(c=T[16].armor.avg.toLocaleString()+" Gold")&&Ee(u,c),(!q||W[0]&65536)&&w!==(w=T[16].gear.avg.toLocaleString()+" Gold")&&Ee(I,w)},i(T){q||(T&&ve(()=>{q&&(A||(A=me(e,Xe,{duration:150},!0)),A.run(1))}),q=!0)},o(T){T&&(A||(A=me(e,Xe,{duration:150},!1)),A.run(0)),q=!1},d(T){T&&R(e),T&&A&&A.end()}}}function oa(n){let e,t,i=n[3].name+"",s,o,r,l,a,c,u,d,f,h,_=n[3].desc+"",b,v,y,k,w;return{c(){e=g("div"),t=g("span"),s=te(i),o=E(),r=g("button"),r.innerHTML='<iconify-icon icon="ri:share-fill"></iconify-icon> <span class="tooltip" id="right">Share build</span>',l=E(),a=g("span"),c=te(`Description / Notes:\r
                `),u=g("br"),d=E(),f=g("br"),h=E(),b=te(_),m(t,"id","buildName"),m(t,"class","svelte-v3bd1x"),m(r,"class","svelte-v3bd1x"),m(a,"class","tooltip"),m(a,"id","bottom"),m(e,"class","currentBuild svelte-v3bd1x"),re(e,"no-tooltip",n[9])},m(I,A){M(I,e,A),p(e,t),p(t,s),p(e,o),p(e,r),p(e,l),p(e,a),p(a,c),p(a,u),p(a,d),p(a,f),p(a,h),p(a,b),y=!0,k||(w=[N(r,"click",n[32]),N(r,"mouseenter",n[33]),N(r,"mouseleave",n[34])],k=!0)},p(I,A){(!y||A[0]&8)&&i!==(i=I[3].name+"")&&Ee(s,i),(!y||A[0]&8)&&_!==(_=I[3].desc+"")&&Ee(b,_),(!y||A[0]&512)&&re(e,"no-tooltip",I[9])},i(I){y||(I&&ve(()=>{y&&(v||(v=me(e,Xe,{duration:100},!0)),v.run(1))}),y=!0)},o(I){I&&(v||(v=me(e,Xe,{duration:100},!1)),v.run(0)),y=!1},d(I){I&&R(e),I&&v&&v.end(),k=!1,be(w)}}}function ra(n){let e,t,i,s,o,r,l,a,c=n[16].total.avg.toLocaleString()+" Gold",u,d,f;return{c(){e=g("div"),t=g("div"),i=g("span"),i.textContent="Avg. total cost:",s=E(),o=g("img"),l=E(),a=g("span"),u=te(c),$e(o.src,r="https://static.wikia.nocookie.net/fantastic-frontier-roblox/images/b/ba/GoldCoins.png")||m(o,"src",r),m(o,"alt",""),m(o,"class","svelte-v3bd1x"),m(t,"class","svelte-v3bd1x"),m(e,"class","costPreview svelte-v3bd1x"),m(e,"id","total")},m(h,_){M(h,e,_),p(e,t),p(t,i),p(t,s),p(t,o),p(t,l),p(t,a),p(a,u),f=!0},p(h,_){(!f||_[0]&65536)&&c!==(c=h[16].total.avg.toLocaleString()+" Gold")&&Ee(u,c)},i(h){f||(h&&ve(()=>{f&&(d||(d=me(e,Xe,{duration:150},!0)),d.run(1))}),f=!0)},o(h){h&&(d||(d=me(e,Xe,{duration:150},!1)),d.run(0)),f=!1},d(h){h&&R(e),h&&d&&d.end()}}}function Eb(n){let e,t,i;return t=new Cb({}),{c(){e=g("div"),oe(t.$$.fragment),m(e,"class","promptCont svelte-v3bd1x")},m(s,o){M(s,e,o),ne(t,e,null),i=!0},p:se,i(s){i||(L(t.$$.fragment,s),i=!0)},o(s){z(t.$$.fragment,s),i=!1},d(s){s&&R(e),ie(t)}}}function Sb(n){let e,t,i;return t=new yb({}),{c(){e=g("div"),oe(t.$$.fragment),m(e,"class","promptCont svelte-v3bd1x")},m(s,o){M(s,e,o),ne(t,e,null),i=!0},p:se,i(s){i||(L(t.$$.fragment,s),i=!0)},o(s){z(t.$$.fragment,s),i=!1},d(s){s&&R(e),ie(t)}}}function Ib(n){let e,t,i;return t=new xg({}),{c(){e=g("div"),oe(t.$$.fragment),m(e,"class","promptCont svelte-v3bd1x")},m(s,o){M(s,e,o),ne(t,e,null),i=!0},p:se,i(s){i||(L(t.$$.fragment,s),i=!0)},o(s){z(t.$$.fragment,s),i=!1},d(s){s&&R(e),ie(t)}}}function Tb(n){let e,t,i;return t=new tb({}),t.$on("loadPending",n[18]),{c(){e=g("div"),oe(t.$$.fragment),m(e,"class","promptCont svelte-v3bd1x")},m(s,o){M(s,e,o),ne(t,e,null),i=!0},p:se,i(s){i||(L(t.$$.fragment,s),i=!0)},o(s){z(t.$$.fragment,s),i=!1},d(s){s&&R(e),ie(t)}}}function Nb(n){let e,t,i;return t=new Vg({}),{c(){e=g("div"),oe(t.$$.fragment),m(e,"class","promptCont svelte-v3bd1x")},m(s,o){M(s,e,o),ne(t,e,null),i=!0},p:se,i(s){i||(L(t.$$.fragment,s),i=!0)},o(s){z(t.$$.fragment,s),i=!1},d(s){s&&R(e),ie(t)}}}function Ob(n){let e,t,i;return t=new Hg({}),{c(){e=g("div"),oe(t.$$.fragment),m(e,"class","promptCont svelte-v3bd1x")},m(s,o){M(s,e,o),ne(t,e,null),i=!0},p:se,i(s){i||(L(t.$$.fragment,s),i=!0)},o(s){z(t.$$.fragment,s),i=!1},d(s){s&&R(e),ie(t)}}}function Db(n){let e,t,i;return t=new sb({}),{c(){e=g("div"),oe(t.$$.fragment),m(e,"class","promptCont svelte-v3bd1x")},m(s,o){M(s,e,o),ne(t,e,null),i=!0},p:se,i(s){i||(L(t.$$.fragment,s),i=!0)},o(s){z(t.$$.fragment,s),i=!1},d(s){s&&R(e),ie(t)}}}function Rb(n){let e,t,i;return t=new Lg({}),{c(){e=g("div"),oe(t.$$.fragment),m(e,"class","promptCont svelte-v3bd1x")},m(s,o){M(s,e,o),ne(t,e,null),i=!0},p:se,i(s){i||(L(t.$$.fragment,s),i=!0)},o(s){z(t.$$.fragment,s),i=!1},d(s){s&&R(e),ie(t)}}}function Ab(n){let e,t,i;return t=new Ag({}),t.$on("buildLoad",n[36]),{c(){e=g("div"),oe(t.$$.fragment),m(e,"class","promptCont svelte-v3bd1x")},m(s,o){M(s,e,o),ne(t,e,null),i=!0},p:se,i(s){i||(L(t.$$.fragment,s),i=!0)},o(s){z(t.$$.fragment,s),i=!1},d(s){s&&R(e),ie(t)}}}function Pb(n){let e,t,i;return t=new Tg({}),{c(){e=g("div"),oe(t.$$.fragment),m(e,"class","promptCont svelte-v3bd1x")},m(s,o){M(s,e,o),ne(t,e,null),i=!0},p:se,i(s){i||(L(t.$$.fragment,s),i=!0)},o(s){z(t.$$.fragment,s),i=!1},d(s){s&&R(e),ie(t)}}}function Mb(n){let e,t,i;return t=new ng({}),{c(){e=g("div"),oe(t.$$.fragment),m(e,"class","promptCont svelte-v3bd1x")},m(s,o){M(s,e,o),ne(t,e,null),i=!0},p:se,i(s){i||(L(t.$$.fragment,s),i=!0)},o(s){z(t.$$.fragment,s),i=!1},d(s){s&&R(e),ie(t)}}}function Lb(n){let e,t,i,s;function o(l){n[35](l)}let r={};return n[7]!==void 0&&(r.loadID=n[7]),t=new vg({props:r}),le.push(()=>Pe(t,"loadID",o)),t.$on("resetActions",n[22]),{c(){e=g("div"),oe(t.$$.fragment),m(e,"class","promptCont svelte-v3bd1x")},m(l,a){M(l,e,a),ne(t,e,null),s=!0},p(l,a){const c={};!i&&a[0]&128&&(i=!0,c.loadID=l[7],Ae(()=>i=!1)),t.$set(c)},i(l){s||(L(t.$$.fragment,l),s=!0)},o(l){z(t.$$.fragment,l),s=!1},d(l){l&&R(e),ie(t)}}}function Fb(n){let e,t,i;return t=new gb({}),{c(){e=g("div"),oe(t.$$.fragment),m(e,"class","promptCont svelte-v3bd1x")},m(s,o){M(s,e,o),ne(t,e,null),i=!0},p:se,i(s){i||(L(t.$$.fragment,s),i=!0)},o(s){z(t.$$.fragment,s),i=!1},d(s){s&&R(e),ie(t)}}}function la(n){let e,t,i;return{c(){e=g("iconify-icon"),Re(e,"icon","uil:exclamation"),Re(e,"id","unseen"),Re(e,"class","svelte-v3bd1x")},m(s,o){M(s,e,o),i=!0},i(s){i||(s&&ve(()=>{i&&(t||(t=me(e,Xe,{duration:150},!0)),t.run(1))}),i=!0)},o(s){s&&(t||(t=me(e,Xe,{duration:150},!1)),t.run(0)),i=!1},d(s){s&&R(e),s&&t&&t.end()}}}function aa(n){let e;return{c(){e=g("div"),e.innerHTML='<iconify-icon icon="eos-icons:three-dots-loading" class="svelte-v3bd1x"></iconify-icon>',m(e,"class","promptCont svelte-v3bd1x")},m(t,i){M(t,e,i)},d(t){t&&R(e)}}}function Bb(n){let e,t,i,s,o,r,l,a,c,u,d,f,h,_,b,v,y,k,w,I,A,q,T,W,H,K,D,S,O,Z,P,F,B,G,Y,ue,ce,ee,j,J,de,Be,Me,Oe,nt,je,De,ze,_e,ae,gt;ve(n[29]);let st=!n[5]&&Zl(),Ot=Ne(n[20]),et=[];for(let V=0;V<Ot.length;V+=1)et[V]=xl(Xl(n,Ot,V));let ot=(n[11]||!n[5])&&$l(),C=n[4].screenshot.ongoing&&n[17][n[2]]<=1&&ea(),fe=n[4].screenshot.ongoing&&ta(),he=Ne(n[20]),ye=[];for(let V=0;V<he.length;V+=1)ye[V]=na(Jl(n,he,V));let Le=n[6]&&ia(n),He=n[4].screenshot.ongoing&&sa(n),Ge=n[3]&&oa(n);I=new Vm({}),q=new qg({}),K=new ym({}),S=new Rm({}),Z=new zm({}),F=new $m({});let Ze=n[4].screenshot.ongoing&&ra(n);const x=[Fb,Lb,Mb,Pb,Ab,Rb,Db,Ob,Nb,Tb,Ib,Sb,Eb],Dt=[];function Jo(V,we){return V[4].item.ongoing?0:V[10]||V[4].share.ongoing?1:V[4].export.ongoing?2:V[4].save.ongoing?3:V[4].load.ongoing&&!V[7]?4:V[4].delete.ongoing?5:V[4].costs.ongoing?6:V[4].bonus.ongoing?7:V[4].randomize.ongoing?8:V[4].resources.ongoing?9:V[4].changelog.ongoing?10:V[4].policy.ongoing?11:V[4].donate.ongoing?12:-1}~(Y=Jo(n))&&(ue=Dt[Y]=x[Y](n));let ft=!n[12]&&la(),It=!n[5]&&aa();return{c(){e=E(),st&&st.c(),t=pt();for(let V=0;V<et.length;V+=1)et[V].c();i=pt(),ot&&ot.c(),s=pt(),C&&C.c(),o=pt(),fe&&fe.c(),r=pt(),l=E(),a=g("div");for(let V=0;V<ye.length;V+=1)ye[V].c();c=E(),Le&&Le.c(),u=E(),d=g("span"),d.innerHTML=`<iconify-icon icon="ic:baseline-discord" class="svelte-v3bd1x"></iconify-icon>
    xt.ss
    <span class="tooltip svelte-v3bd1x" id="right">Contact me on Discord!</span>`,f=E(),h=g("button"),h.innerHTML=`<a href="https://ko-fi.com/xt8ss" target="_blank" class="svelte-v3bd1x">Support me
        <img src="kofi-badge.png" alt="" class="svelte-v3bd1x"/></a>`,_=E(),b=g("button"),b.innerHTML='<iconify-icon icon="charm:stack"></iconify-icon> <span class="tooltip" id="left">Resources</span>',v=E(),y=g("main"),He&&He.c(),k=E(),Ge&&Ge.c(),w=E(),oe(I.$$.fragment),A=E(),oe(q.$$.fragment),T=E(),W=g("div"),H=g("div"),oe(K.$$.fragment),D=E(),oe(S.$$.fragment),O=E(),oe(Z.$$.fragment),P=E(),oe(F.$$.fragment),B=E(),Ze&&Ze.c(),G=E(),ue&&ue.c(),ce=E(),ee=g("button"),j=g("iconify-icon"),J=E(),de=g("span"),de.textContent="Changelog",Be=E(),ft&&ft.c(),Me=E(),Oe=g("button"),Oe.innerHTML='<iconify-icon icon="material-symbols:policy-outline-rounded"></iconify-icon> <span class="tooltip" id="left">Policy</span>',nt=E(),je=g("span"),je.textContent=`${io}`,De=E(),It&&It.c(),ze=pt(),m(a,"class","backgrounds"),m(d,"class","info svelte-v3bd1x"),m(d,"id","credits"),m(h,"class","info svelte-v3bd1x"),m(h,"id","donate"),m(b,"class","info svelte-v3bd1x"),m(b,"id","resources"),m(H,"class","eqCont svelte-v3bd1x"),m(W,"class","calcBox svelte-v3bd1x"),m(W,"id","calc"),m(y,"class","svelte-v3bd1x"),Re(j,"icon","octicon:log-16"),m(de,"class","tooltip"),m(de,"id","right"),m(ee,"class","info svelte-v3bd1x"),m(ee,"id","changelog"),m(Oe,"class","info svelte-v3bd1x"),m(Oe,"id","policy"),m(je,"class","info svelte-v3bd1x"),m(je,"id","version")},m(V,we){M(V,e,we),st&&st.m(At.head,null),p(At.head,t);for(let Tt=0;Tt<et.length;Tt+=1)et[Tt]&&et[Tt].m(At.head,null);p(At.head,i),ot&&ot.m(At.head,null),p(At.head,s),C&&C.m(At.head,null),p(At.head,o),fe&&fe.m(At.head,null),p(At.head,r),M(V,l,we),M(V,a,we);for(let Tt=0;Tt<ye.length;Tt+=1)ye[Tt]&&ye[Tt].m(a,null);M(V,c,we),Le&&Le.m(V,we),M(V,u,we),M(V,d,we),M(V,f,we),M(V,h,we),M(V,_,we),M(V,b,we),M(V,v,we),M(V,y,we),He&&He.m(y,null),p(y,k),Ge&&Ge.m(y,null),p(y,w),ne(I,y,null),p(y,A),ne(q,y,null),p(y,T),p(y,W),p(W,H),ne(K,H,null),p(H,D),ne(S,H,null),p(W,O),ne(Z,W,null),p(y,P),ne(F,y,null),p(y,B),Ze&&Ze.m(y,null),p(y,G),~Y&&Dt[Y].m(y,null),M(V,ce,we),M(V,ee,we),p(ee,j),p(ee,J),p(ee,de),p(ee,Be),ft&&ft.m(ee,null),M(V,Me,we),M(V,Oe,we),M(V,nt,we),M(V,je,we),M(V,De,we),It&&It.m(V,we),M(V,ze,we),_e=!0,ae||(gt=[N(pn,"beforeunload",n[25]),N(pn,"storage",n[26]),N(pn,"wheel",n[27],{passive:!1}),N(pn,"keydown",n[28]),N(pn,"resize",n[29]),N(At,"visibilitychange",n[30]),N(b,"click",n[31]),N(ee,"click",n[37]),N(Oe,"click",n[38])],ae=!0)},p(V,we){if(V[5]?st&&(st.d(1),st=null):st||(st=Zl(),st.c(),st.m(t.parentNode,t)),we[0]&1048576){Ot=Ne(V[20]);let Qe;for(Qe=0;Qe<Ot.length;Qe+=1){const Zn=Xl(V,Ot,Qe);et[Qe]?et[Qe].p(Zn,we):(et[Qe]=xl(Zn),et[Qe].c(),et[Qe].m(i.parentNode,i))}for(;Qe<et.length;Qe+=1)et[Qe].d(1);et.length=Ot.length}if(V[11]||!V[5]?ot||(ot=$l(),ot.c(),ot.m(s.parentNode,s)):ot&&(ot.d(1),ot=null),V[4].screenshot.ongoing&&V[17][V[2]]<=1?C||(C=ea(),C.c(),C.m(o.parentNode,o)):C&&(C.d(1),C=null),V[4].screenshot.ongoing?fe||(fe=ta(),fe.c(),fe.m(r.parentNode,r)):fe&&(fe.d(1),fe=null),we[0]&1048832){he=Ne(V[20]);let Qe;for(Qe=0;Qe<he.length;Qe+=1){const Zn=Jl(V,he,Qe);ye[Qe]?ye[Qe].p(Zn,we):(ye[Qe]=na(Zn),ye[Qe].c(),ye[Qe].m(a,null))}for(;Qe<ye.length;Qe+=1)ye[Qe].d(1);ye.length=he.length}V[6]?Le?(Le.p(V,we),we[0]&64&&L(Le,1)):(Le=ia(V),Le.c(),L(Le,1),Le.m(u.parentNode,u)):Le&&(qe(),z(Le,1,1,()=>{Le=null}),We()),V[4].screenshot.ongoing?He?(He.p(V,we),we[0]&16&&L(He,1)):(He=sa(V),He.c(),L(He,1),He.m(y,k)):He&&(qe(),z(He,1,1,()=>{He=null}),We()),V[3]?Ge?(Ge.p(V,we),we[0]&8&&L(Ge,1)):(Ge=oa(V),Ge.c(),L(Ge,1),Ge.m(y,w)):Ge&&(qe(),z(Ge,1,1,()=>{Ge=null}),We()),V[4].screenshot.ongoing?Ze?(Ze.p(V,we),we[0]&16&&L(Ze,1)):(Ze=ra(V),Ze.c(),L(Ze,1),Ze.m(y,G)):Ze&&(qe(),z(Ze,1,1,()=>{Ze=null}),We());let Tt=Y;Y=Jo(V),Y===Tt?~Y&&Dt[Y].p(V,we):(ue&&(qe(),z(Dt[Tt],1,1,()=>{Dt[Tt]=null}),We()),~Y?(ue=Dt[Y],ue?ue.p(V,we):(ue=Dt[Y]=x[Y](V),ue.c()),L(ue,1),ue.m(y,null)):ue=null),V[12]?ft&&(qe(),z(ft,1,1,()=>{ft=null}),We()):ft?we[0]&4096&&L(ft,1):(ft=la(),ft.c(),L(ft,1),ft.m(ee,null)),V[5]?It&&(It.d(1),It=null):It||(It=aa(),It.c(),It.m(ze.parentNode,ze))},i(V){_e||(L(Le),L(He),L(Ge),L(I.$$.fragment,V),L(q.$$.fragment,V),L(K.$$.fragment,V),L(S.$$.fragment,V),L(Z.$$.fragment,V),L(F.$$.fragment,V),L(Ze),L(ue),L(ft),_e=!0)},o(V){z(Le),z(He),z(Ge),z(I.$$.fragment,V),z(q.$$.fragment,V),z(K.$$.fragment,V),z(S.$$.fragment,V),z(Z.$$.fragment,V),z(F.$$.fragment,V),z(Ze),z(ue),z(ft),_e=!1},d(V){V&&(R(e),R(l),R(a),R(c),R(u),R(d),R(f),R(h),R(_),R(b),R(v),R(y),R(ce),R(ee),R(Me),R(Oe),R(nt),R(je),R(De),R(ze)),st&&st.d(V),R(t),ht(et,V),R(i),ot&&ot.d(V),R(s),C&&C.d(V),R(o),fe&&fe.d(V),R(r),ht(ye,V),Le&&Le.d(V),He&&He.d(),Ge&&Ge.d(),ie(I),ie(q),ie(K),ie(S),ie(Z),ie(F),Ze&&Ze.d(),~Y&&Dt[Y].d(),ft&&ft.d(),It&&It.d(V),ae=!1,be(gt)}}}let io="v3.26.7";function qb(n,e,t){let i,s,o,r,l,a,c,u,d,f,h,_,b,v,y,k;Q(n,kt,C=>t(3,s=C)),Q(n,X,C=>t(4,o=C)),Q(n,yn,C=>t(11,r=C)),Q(n,co,C=>t(24,l=C)),Q(n,Wn,C=>t(42,a=C)),Q(n,zt,C=>t(43,c=C)),Q(n,qn,C=>t(44,u=C)),Q(n,qt,C=>t(45,d=C)),Q(n,Mi,C=>t(12,f=C)),Q(n,bn,C=>t(46,h=C)),Q(n,xt,C=>t(13,_=C)),Q(n,Rt,C=>t(14,b=C)),Q(n,Bt,C=>t(47,v=C)),Q(n,uo,C=>t(15,y=C)),Q(n,Nt,C=>t(16,k=C));let w=!1,I,A,q=7,T=[.2,.3,.45,.6,.75,.85,.95,1,1.1,1.25,1.5,1.75,2,2.5,3,4,5],W=!1,H,K=new URLSearchParams(location.search).get("id"),D=location.href.includes("ls=true");for(let C of W_){let fe=`https://raw.githubusercontent.com/XT8SS/fantastic-calculator/gh-pages/ff-data/${C}.json`;fetch(fe).then(async he=>{if(he.status!=200){console.error(`Failed to fetch "${C}" data!
Status: ${he.status}`);return}U(Bt,v[C]=await he.json(),v)}).catch(he=>console.error(`Failed to initiate "${C}" data fetch!
${he}`))}Pu(()=>{if(t(5,w=!0),K?(D&&window.history.replaceState(null,null,location.origin+location.pathname+`?id=${K}`),S()):D&&window.history.replaceState(null,null,location.origin+location.pathname),b[Object.keys(b)[0]]&&U(xt,_=!0,_),U(bn,h.totalVisits++,h),h.showAgain){let C=Math.floor((h.totalVisits-h.lastVisits)/3);C&&C>=h.timesDenied&&(U(bn,h.lastVisits=h.totalVisits,h),U(X,o.donate.ongoing=!0,o))}localStorage.getItem("version")!=io&&(U(Mi,f=!1,f),localStorage.setItem("version",io)),localStorage.getItem("changelogSeen")||localStorage.setItem("changelogSeen",!1)});function S(){if(U(X,o.load.ongoing=!0,o),!K.startsWith("-"))U(X,o.load.status=-1,o),U(X,o.message="invalid_id",o);else{U(X,o.load.status=0,o);let C=ou(Un(Vn,"builds"),su()),fe=0;iu(C).then(he=>{for(let ye in he.val()){if(ye==K){O(he.val()[ye],ye);break}else fe==Object.keys(he.val()).length-1&&(U(X,o.load.status=-1,o),U(X,o.message="invalid_id",o));fe++}}).catch(()=>{U(X,o.load.status=-1,o),U(X,o.message="firebase_fail",o)})}}function O(C,fe){for(let he in C.eq){let ye=d[he]||ys;C.eq[he]&&C.eq[he]!=ye.name?u[he][C.eq[he]].querySelector("button").click():!C.eq[he]&&ye.name&&u[he][ye.name].querySelector("button").click()}for(let he of Sn){let ye=c[he]||ws;ye.name&&a[he][ye.name].querySelector("button").click()}setTimeout(()=>{for(let he of Sn)C.gear[he]&&a[he][C.gear[he]].querySelector("button").click();U(X,o.load.ongoing=!1,o),U(X,o.load.status=null,o),fe&&(U(kt,s=C,s),U(kt,s.id=fe,s),t(7,K=null))})}let Z=[],P=[],F,B,G=9;for(let C=0;C<G;C++)Z.push(`backgrounds/BG${C}.jpg`);function Y(C){B=Math.floor(Math.random()*C.length)}Y(Z);function ue(){t(8,F=B),P.push(B)}ue(),function C(){setTimeout(()=>{if(Y(Z),!P.length)ue();else if(P.length>3&&(P=P.slice(1)),!P.includes(B))ue();else{let fe=[...Array(G).keys()].filter(he=>!P.includes(he));Y(fe),ue()}document.hasFocus&&C()},45e3)}();function ce(){H=setTimeout(()=>{t(6,W=!1)},750)}function ee(){clearTimeout(H),t(6,W=!0),ce()}function j(){U(X,o.export.status=null,o),U(X,o.export.ongoing=!1,o),U(X,o.save.status=null,o),U(X,o.save.ongoing=!1,o),U(X,o.load.status=null,o),U(X,o.load.ongoing=!1,o),U(X,o.delete.status=null,o),U(X,o.delete.ongoing=!1,o),U(X,o.share.ongoing=!1,o),U(X,o.message="",o)}function J(){let C=A>I;document.documentElement.style.fontSize=`${(C?.75:window.outerWidth/window.outerHeight/2)*T[q]}vh`}let de=!1;const Be=C=>{(y||r)&&C.preventDefault()},Me=C=>{if(C.key=="builds")if(C.url.includes("ls=true")){U(Rt,b=JSON.parse(C.newValue),b),U(xt,_=Object.keys(JSON.parse(C.newValue)).length>0,_),j();let fe=Object.keys(JSON.parse(C.oldValue)).filter(he=>!Object.keys(JSON.parse(C.newValue)).includes(he))[0];fe&&s&&fe==s.name&&U(kt,s=null,s)}else window.localStorage.setItem("builds",JSON.stringify(b));else C.url==location.href&&localStorage.setItem(C.key,C.oldValue)},Oe=C=>{let fe=C.wheelDeltaY;if(C.ctrlKey){if(C.preventDefault(),T[q]==.2&&fe<0||T[q]==5&&fe>0)return;fe>0?t(2,q++,q):t(2,q--,q),ee()}},nt=C=>{C.ctrlKey&&(C.key=="-"||C.key=="+"||C.code=="Equal"||C.key=="0")&&(C.preventDefault(),(C.key=="+"||C.code=="Equal")&&T[q]!=5?t(2,q++,q):C.key=="-"&&T[q]!=.2?t(2,q--,q):C.key=="0"&&T[q]!=1&&t(2,q=7),ee()),r&&z_(C)};function je(){t(0,I=pn.outerHeight),t(1,A=pn.outerWidth)}const De=()=>{document.visibilityState=="visible"&&setTimeout(()=>{t(0,I=window.outerHeight),t(1,A=window.outerWidth),J()})},ze=C=>{on(C),r||U(X,o.resources.ongoing=!0,o)},_e=()=>{r||U(X,o.share.ongoing=!0,o)},ae=()=>t(9,de=!0),gt=()=>t(9,de=!1);function st(C){K=C,t(7,K)}const Ot=C=>O(C.detail.build,C.detail.id),et=C=>{on(C),!r&&(U(X,o.changelog.ongoing=!0,o),U(Mi,f=!0,f))},ot=C=>{on(C),r||U(X,o.policy.ongoing=!0,o)};return n.$$.update=()=>{if(n.$$.dirty[0]&16777219&&(A||I)&&l)for(let C of l)Vo(C.node,C.itemName);n.$$.dirty[0]&7&&(A||I||q)&&J(),n.$$.dirty[0]&16&&t(10,i=o.export.status||o.save.status||o.load.status||o.delete.status),n.$$.dirty[0]&16&&U(yn,r=o.item.ongoing||o.export.ongoing||o.save.ongoing||o.load.ongoing||o.delete.ongoing||o.share.ongoing||o.costs.ongoing||o.bonus.ongoing||o.randomize.ongoing||o.resources.ongoing||o.changelog.ongoing||o.policy.ongoing||o.donate.ongoing,r),n.$$.dirty[0]&8&&(document.title=(s?s.name+" - ":"")+"Fantastic Calculator")},[I,A,q,s,o,w,W,K,F,de,i,r,f,_,b,y,k,T,S,O,Z,ee,j,J,l,Be,Me,Oe,nt,je,De,ze,_e,ae,gt,st,Ot,et,ot]}class Wb extends Te{constructor(e){super(),Ie(this,e,qb,Bb,ge,{},null,[-1,-1])}}new Wb({target:document.body});
