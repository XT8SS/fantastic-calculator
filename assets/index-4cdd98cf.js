var cu=Object.defineProperty;var uu=(n,e,t)=>e in n?cu(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var Xt=(n,e,t)=>(uu(n,typeof e!="symbol"?e+"":e,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&i(r)}).observe(document,{childList:!0,subtree:!0});function t(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(s){if(s.ep)return;s.ep=!0;const o=t(s);fetch(s.href,o)}})();function oe(){}const ns=n=>n;function du(n,e){for(const t in e)n[t]=e[t];return n}function sa(n){return n()}function Qo(){return Object.create(null)}function be(n){n.forEach(sa)}function Vn(n){return typeof n=="function"}function ge(n,e){return n!=n?e==e:n!==e||n&&typeof n=="object"||typeof n=="function"}let Ni;function tt(n,e){return n===e?!0:(Ni||(Ni=document.createElement("a")),Ni.href=e,n===Ni.href)}function fu(n){return Object.keys(n).length===0}function hu(n,...e){if(n==null){for(const i of e)i(void 0);return oe}const t=n.subscribe(...e);return t.unsubscribe?()=>t.unsubscribe():t}function X(n,e,t){n.$$.on_destroy.push(hu(e,t))}function pu(n,e,t,i){if(n){const s=oa(n,e,t,i);return n[0](s)}}function oa(n,e,t,i){return n[1]&&i?du(t.ctx.slice(),n[1](i(e))):t.ctx}function _u(n,e,t,i){if(n[2]&&i){const s=n[2](i(t));if(e.dirty===void 0)return s;if(typeof s=="object"){const o=[],r=Math.max(e.dirty.length,s.length);for(let l=0;l<r;l+=1)o[l]=e.dirty[l]|s[l];return o}return e.dirty|s}return e.dirty}function mu(n,e,t,i,s,o){if(s){const r=oa(e,t,i,o);n.p(r,s)}}function gu(n){if(n.ctx.length>32){const e=[],t=n.ctx.length/32;for(let i=0;i<t;i++)e[i]=-1;return e}return-1}function G(n,e,t){return n.set(t),e}function ra(n){return n&&Vn(n.destroy)?n.destroy:oe}const la=typeof window<"u";let io=la?()=>window.performance.now():()=>Date.now(),so=la?n=>requestAnimationFrame(n):oe;const Rn=new Set;function aa(n){Rn.forEach(e=>{e.c(n)||(Rn.delete(e),e.f())}),Rn.size!==0&&so(aa)}function oo(n){let e;return Rn.size===0&&so(aa),{promise:new Promise(t=>{Rn.add(e={c:n,f:t})}),abort(){Rn.delete(e)}}}const bu=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function _(n,e){n.appendChild(e)}function ca(n){if(!n)return document;const e=n.getRootNode?n.getRootNode():n.ownerDocument;return e&&e.host?e:n.ownerDocument}function vu(n){const e=g("style");return e.textContent="/* empty */",yu(ca(n),e),e.sheet}function yu(n,e){return _(n.head||n,e),e.sheet}function P(n,e,t){n.insertBefore(e,t||null)}function A(n){n.parentNode&&n.parentNode.removeChild(n)}function ht(n,e){for(let t=0;t<n.length;t+=1)n[t]&&n[t].d(e)}function g(n){return document.createElement(n)}function wu(n){return document.createElementNS("http://www.w3.org/2000/svg",n)}function ce(n){return document.createTextNode(n)}function C(){return ce(" ")}function pt(){return ce("")}function O(n,e,t,i){return n.addEventListener(e,t,i),()=>n.removeEventListener(e,t,i)}function m(n,e,t){t==null?n.removeAttribute(e):n.getAttribute(e)!==t&&n.setAttribute(e,t)}function Ae(n,e,t){e in n?n[e]=typeof n[e]=="boolean"&&t===""?!0:t:m(n,e,t)}function ua(n){return n===""?null:+n}function ku(n){return Array.from(n.childNodes)}function Se(n,e){e=""+e,n.data!==e&&(n.data=e)}function qt(n,e){n.value=e??""}function it(n,e,t,i){t==null?n.style.removeProperty(e):n.style.setProperty(e,t,i?"important":"")}let Oi;function Cu(){if(Oi===void 0){Oi=!1;try{typeof window<"u"&&window.parent&&window.parent.document}catch{Oi=!0}}return Oi}function sn(n,e){getComputedStyle(n).position==="static"&&(n.style.position="relative");const i=g("iframe");i.setAttribute("style","display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;"),i.setAttribute("aria-hidden","true"),i.tabIndex=-1;const s=Cu();let o;return s?(i.src="data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}<\/script>",o=O(window,"message",r=>{r.source===i.contentWindow&&e()})):(i.src="about:blank",i.onload=()=>{o=O(i.contentWindow,"resize",e),e()}),_(n,i),()=>{(s||o&&i.contentWindow)&&o(),A(i)}}function ne(n,e,t){n.classList.toggle(e,!!t)}function da(n,e,{bubbles:t=!1,cancelable:i=!1}={}){return new CustomEvent(n,{detail:e,bubbles:t,cancelable:i})}class Eu{constructor(e=!1){Xt(this,"is_svg",!1);Xt(this,"e");Xt(this,"n");Xt(this,"t");Xt(this,"a");this.is_svg=e,this.e=this.n=null}c(e){this.h(e)}m(e,t,i=null){this.e||(this.is_svg?this.e=wu(t.nodeName):this.e=g(t.nodeType===11?"TEMPLATE":t.nodeName),this.t=t.tagName!=="TEMPLATE"?t:t.content,this.c(e)),this.i(i)}h(e){this.e.innerHTML=e,this.n=Array.from(this.e.nodeName==="TEMPLATE"?this.e.content.childNodes:this.e.childNodes)}i(e){for(let t=0;t<this.n.length;t+=1)P(this.t,this.n[t],e)}p(e){this.d(),this.h(e),this.i(this.a)}d(){this.n.forEach(A)}}const Mi=new Map;let Li=0;function Su(n){let e=5381,t=n.length;for(;t--;)e=(e<<5)-e^n.charCodeAt(t);return e>>>0}function Iu(n,e){const t={stylesheet:vu(e),rules:{}};return Mi.set(n,t),t}function Fi(n,e,t,i,s,o,r,l=0){const a=16.666/i;let c=`{
`;for(let v=0;v<=1;v+=a){const w=e+(t-e)*o(v);c+=v*100+`%{${r(w,1-w)}}
`}const u=c+`100% {${r(t,1-t)}}
}`,d=`__svelte_${Su(u)}_${l}`,f=ca(n),{stylesheet:h,rules:p}=Mi.get(f)||Iu(f,n);p[d]||(p[d]=!0,h.insertRule(`@keyframes ${d} ${u}`,h.cssRules.length));const b=n.style.animation||"";return n.style.animation=`${b?`${b}, `:""}${d} ${i}ms linear ${s}ms 1 both`,Li+=1,d}function Bi(n,e){const t=(n.style.animation||"").split(", "),i=t.filter(e?o=>o.indexOf(e)<0:o=>o.indexOf("__svelte")===-1),s=t.length-i.length;s&&(n.style.animation=i.join(", "),Li-=s,Li||Tu())}function Tu(){so(()=>{Li||(Mi.forEach(n=>{const{ownerNode:e}=n.stylesheet;e&&A(e)}),Mi.clear())})}let ai;function ii(n){ai=n}function fa(){if(!ai)throw new Error("Function called outside component initialization");return ai}function Nu(n){fa().$$.on_mount.push(n)}function Ht(){const n=fa();return(e,t,{cancelable:i=!1}={})=>{const s=n.$$.callbacks[e];if(s){const o=da(e,t,{cancelable:i});return s.slice().forEach(r=>{r.call(n,o)}),!o.defaultPrevented}return!0}}const On=[],ae=[];let An=[];const Ms=[],Ou=Promise.resolve();let Ls=!1;function Du(){Ls||(Ls=!0,Ou.then(ha))}function we(n){An.push(n)}function Pe(n){Ms.push(n)}const ws=new Set;let In=0;function ha(){if(In!==0)return;const n=ai;do{try{for(;In<On.length;){const e=On[In];In++,ii(e),Ru(e.$$)}}catch(e){throw On.length=0,In=0,e}for(ii(null),On.length=0,In=0;ae.length;)ae.pop()();for(let e=0;e<An.length;e+=1){const t=An[e];ws.has(t)||(ws.add(t),t())}An.length=0}while(On.length);for(;Ms.length;)Ms.pop()();Ls=!1,ws.clear(),ii(n)}function Ru(n){if(n.fragment!==null){n.update(),be(n.before_update);const e=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,e),n.after_update.forEach(we)}}function Au(n){const e=[],t=[];An.forEach(i=>n.indexOf(i)===-1?e.push(i):t.push(i)),t.forEach(i=>i()),An=e}let Zn;function ro(){return Zn||(Zn=Promise.resolve(),Zn.then(()=>{Zn=null})),Zn}function mn(n,e,t){n.dispatchEvent(da(`${e?"intro":"outro"}${t}`))}const Ai=new Set;let zt;function We(){zt={r:0,c:[],p:zt}}function He(){zt.r||be(zt.c),zt=zt.p}function M(n,e){n&&n.i&&(Ai.delete(n),n.i(e))}function H(n,e,t,i){if(n&&n.o){if(Ai.has(n))return;Ai.add(n),zt.c.push(()=>{Ai.delete(n),i&&(t&&n.d(1),i())}),n.o(e)}else i&&i()}const lo={duration:0};function pa(n,e,t){const i={direction:"in"};let s=e(n,t,i),o=!1,r,l,a=0;function c(){r&&Bi(n,r)}function u(){const{delay:f=0,duration:h=300,easing:p=ns,tick:b=oe,css:v}=s||lo;v&&(r=Fi(n,0,1,h,f,p,v,a++)),b(0,1);const w=io()+f,k=w+h;l&&l.abort(),o=!0,we(()=>mn(n,!0,"start")),l=oo(y=>{if(o){if(y>=k)return b(1,0),mn(n,!0,"end"),c(),o=!1;if(y>=w){const I=p((y-w)/h);b(I,1-I)}}return o})}let d=!1;return{start(){d||(d=!0,Bi(n),Vn(s)?(s=s(i),ro().then(u)):u())},invalidate(){d=!1},end(){o&&(c(),o=!1)}}}function _a(n,e,t){const i={direction:"out"};let s=e(n,t,i),o=!0,r;const l=zt;l.r+=1;let a;function c(){const{delay:u=0,duration:d=300,easing:f=ns,tick:h=oe,css:p}=s||lo;p&&(r=Fi(n,1,0,d,u,f,p));const b=io()+u,v=b+d;we(()=>mn(n,!1,"start")),"inert"in n&&(a=n.inert,n.inert=!0),oo(w=>{if(o){if(w>=v)return h(0,1),mn(n,!1,"end"),--l.r||be(l.c),!1;if(w>=b){const k=f((w-b)/d);h(1-k,k)}}return o})}return Vn(s)?ro().then(()=>{s=s(i),c()}):c(),{end(u){u&&"inert"in n&&(n.inert=a),u&&s.tick&&s.tick(1,0),o&&(r&&Bi(n,r),o=!1)}}}function me(n,e,t,i){let o=e(n,t,{direction:"both"}),r=i?0:1,l=null,a=null,c=null,u;function d(){c&&Bi(n,c)}function f(p,b){const v=p.b-r;return b*=Math.abs(v),{a:r,b:p.b,d:v,duration:b,start:p.start,end:p.start+b,group:p.group}}function h(p){const{delay:b=0,duration:v=300,easing:w=ns,tick:k=oe,css:y}=o||lo,I={start:io()+b,b:p};p||(I.group=zt,zt.r+=1),"inert"in n&&(p?u!==void 0&&(n.inert=u):(u=n.inert,n.inert=!0)),l||a?a=I:(y&&(d(),c=Fi(n,r,p,v,b,w,y)),p&&k(0,1),l=f(I,v),we(()=>mn(n,p,"start")),oo(D=>{if(a&&D>a.start&&(l=f(a,v),a=null,mn(n,l.b,"start"),y&&(d(),c=Fi(n,r,l.b,l.duration,0,w,o.css))),l){if(D>=l.end)k(r=l.b,1-r),mn(n,l.b,"end"),a||(l.b?d():--l.group.r||be(l.group.c)),l=null;else if(D>=l.start){const W=D-l.start;r=l.a+l.d*w(W/l.duration),k(r,1-r)}}return!!(l||a)}))}return{run(p){Vn(o)?ro().then(()=>{o=o({direction:p?"in":"out"}),h(p)}):h(p)},end(){d(),l=a=null}}}function Oe(n){return(n==null?void 0:n.length)!==void 0?n:Array.from(n)}function Me(n,e,t){const i=n.$$.props[e];i!==void 0&&(n.$$.bound[i]=t,t(n.$$.ctx[i]))}function le(n){n&&n.c()}function ie(n,e,t){const{fragment:i,after_update:s}=n.$$;i&&i.m(e,t),we(()=>{const o=n.$$.on_mount.map(sa).filter(Vn);n.$$.on_destroy?n.$$.on_destroy.push(...o):be(o),n.$$.on_mount=[]}),s.forEach(we)}function se(n,e){const t=n.$$;t.fragment!==null&&(Au(t.after_update),be(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function Pu(n,e){n.$$.dirty[0]===-1&&(On.push(n),Du(),n.$$.dirty.fill(0)),n.$$.dirty[e/31|0]|=1<<e%31}function De(n,e,t,i,s,o,r=null,l=[-1]){const a=ai;ii(n);const c=n.$$={fragment:null,ctx:[],props:o,update:oe,not_equal:s,bound:Qo(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(a?a.$$.context:[])),callbacks:Qo(),dirty:l,skip_bound:!1,root:e.target||a.$$.root};r&&r(c.root);let u=!1;if(c.ctx=t?t(n,e.props||{},(d,f,...h)=>{const p=h.length?h[0]:f;return c.ctx&&s(c.ctx[d],c.ctx[d]=p)&&(!c.skip_bound&&c.bound[d]&&c.bound[d](p),u&&Pu(n,d)),f}):[],c.update(),u=!0,be(c.before_update),c.fragment=i?i(c.ctx):!1,e.target){if(e.hydrate){const d=ku(e.target);c.fragment&&c.fragment.l(d),d.forEach(A)}else c.fragment&&c.fragment.c();e.intro&&M(n.$$.fragment),ie(n,e.target,e.anchor),ha()}ii(a)}class Re{constructor(){Xt(this,"$$");Xt(this,"$$set")}$destroy(){se(this,1),this.$destroy=oe}$on(e,t){if(!Vn(t))return oe;const i=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return i.push(t),()=>{const s=i.indexOf(t);s!==-1&&i.splice(s,1)}}$set(e){this.$$set&&!fu(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Mu="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Mu);const Tn=[];function lt(n,e=oe){let t;const i=new Set;function s(l){if(ge(n,l)&&(n=l,t)){const a=!Tn.length;for(const c of i)c[1](),Tn.push(c,n);if(a){for(let c=0;c<Tn.length;c+=2)Tn[c][0](Tn[c+1]);Tn.length=0}}}function o(l){s(l(n))}function r(l,a=oe){const c=[l,a];return i.add(c),i.size===1&&(t=e(s,o)||oe),l(n),()=>{i.delete(c),i.size===0&&t&&(t(),t=null)}}return{set:s,update:o,subscribe:r}}let Xo=localStorage.getItem("builds"),Jo=0,Zo=localStorage.getItem("changelogSeen"),Mt=lt({}),Lt=lt({}),gt=lt({armor:0,magicDmg:0,meleeDmg:0,rangedDmg:0,hpRegen:0,endurance:0,sightRange:0,walkSpeed:0,jumpPower:0,ammoReturn:0,height:0}),jt=lt({}),ao=lt([]),ks=lt({}),wt=lt(),co=lt(!1),Ot=lt(Xo?JSON.parse(Xo):{}),Jt=lt(!1),Pi=lt(Zo?JSON.parse(Zo):!1),bn=lt(!1),Bn=lt({}),qn=lt({}),Lu=lt({}),Tt=lt({armor:{min:0,avg:0,max:0},gear:{min:0,avg:0,max:0},total:{min:0,avg:0,max:0}}),Pn=lt({}),xn=lt({parasol:!0,armor:!0,gear:!0,basic:!0}),x=lt({item:{ongoing:!1,data:null},export:{ongoing:!1,status:null},save:{ongoing:!1,status:null},load:{ongoing:!1,status:null},delete:{ongoing:!1,status:null},share:{ongoing:!1},costs:{ongoing:!1},bonus:{ongoing:!1},screenshot:{ongoing:!1},randomize:{ongoing:!1},resources:{ongoing:!1},changelog:{ongoing:!1},policy:{ongoing:!1},message:""});Ot.subscribe(n=>{Jo++,setTimeout(()=>{window.localStorage.setItem("builds",JSON.stringify(n)),Jo>1&&window.history.replaceState(null,null,location.origin+location.pathname)})});Pi.subscribe(n=>window.localStorage.setItem("changelogSeen",n));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ma={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ee=function(n,e){if(!n)throw Kn(e)},Kn=function(n){return new Error("Firebase Database ("+ma.SDK_VERSION+") INTERNAL ASSERT FAILED: "+n)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ga=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let s=n.charCodeAt(i);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},Fu=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const s=n[t++];if(s<128)e[i++]=String.fromCharCode(s);else if(s>191&&s<224){const o=n[t++];e[i++]=String.fromCharCode((s&31)<<6|o&63)}else if(s>239&&s<365){const o=n[t++],r=n[t++],l=n[t++],a=((s&7)<<18|(o&63)<<12|(r&63)<<6|l&63)-65536;e[i++]=String.fromCharCode(55296+(a>>10)),e[i++]=String.fromCharCode(56320+(a&1023))}else{const o=n[t++],r=n[t++];e[i++]=String.fromCharCode((s&15)<<12|(o&63)<<6|r&63)}}return e.join("")},uo={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let s=0;s<n.length;s+=3){const o=n[s],r=s+1<n.length,l=r?n[s+1]:0,a=s+2<n.length,c=a?n[s+2]:0,u=o>>2,d=(o&3)<<4|l>>4;let f=(l&15)<<2|c>>6,h=c&63;a||(h=64,r||(f=64)),i.push(t[u],t[d],t[f],t[h])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(ga(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):Fu(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let s=0;s<n.length;){const o=t[n.charAt(s++)],l=s<n.length?t[n.charAt(s)]:0;++s;const c=s<n.length?t[n.charAt(s)]:64;++s;const d=s<n.length?t[n.charAt(s)]:64;if(++s,o==null||l==null||c==null||d==null)throw new Bu;const f=o<<2|l>>4;if(i.push(f),c!==64){const h=l<<4&240|c>>2;if(i.push(h),d!==64){const p=c<<6&192|d;i.push(p)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class Bu extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const ba=function(n){const e=ga(n);return uo.encodeByteArray(e,!0)},qi=function(n){return ba(n).replace(/\./g,"")},Fs=function(n){try{return uo.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qu(n){return va(void 0,n)}function va(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!zu(t)||(n[t]=va(n[t],e[t]));return n}function zu(n){return n!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ju(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wu=()=>ju().__FIREBASE_DEFAULTS__,Hu=()=>{if(typeof process>"u"||typeof process.env>"u")return;const n={}.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},Uu=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Fs(n[1]);return e&&JSON.parse(e)},ya=()=>{try{return Wu()||Hu()||Uu()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Gu=n=>{var e,t;return(t=(e=ya())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},Vu=n=>{const e=Gu(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},wa=()=>{var n;return(n=ya())===null||n===void 0?void 0:n.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class is{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ku(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",s=n.iat||0,o=n.sub||n.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const r=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:s,exp:s+3600,auth_time:s,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},n),l="";return[qi(JSON.stringify(t)),qi(JSON.stringify(r)),l].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yu(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function ka(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Yu())}function Qu(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Ca(){return ma.NODE_ADMIN===!0}function Xu(){try{return typeof indexedDB=="object"}catch{return!1}}function Ju(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(i);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{var o;e(((o=s.error)===null||o===void 0?void 0:o.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zu="FirebaseError";class wi extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=Zu,Object.setPrototypeOf(this,wi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ea.prototype.create)}}class Ea{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},s=`${this.service}/${e}`,o=this.errors[e],r=o?xu(o,i):"Error",l=`${this.serviceName}: ${r} (${s}).`;return new wi(s,l,i)}}function xu(n,e){return n.replace($u,(t,i)=>{const s=e[i];return s!=null?String(s):`<${i}?>`})}const $u=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ci(n){return JSON.parse(n)}function ot(n){return JSON.stringify(n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sa=function(n){let e={},t={},i={},s="";try{const o=n.split(".");e=ci(Fs(o[0])||""),t=ci(Fs(o[1])||""),s=o[2],i=t.d||{},delete t.d}catch{}return{header:e,claims:t,data:i,signature:s}},ed=function(n){const e=Sa(n),t=e.claims;return!!t&&typeof t=="object"&&t.hasOwnProperty("iat")},td=function(n){const e=Sa(n).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ut(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function zn(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]}function xo(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function zi(n,e,t){const i={};for(const s in n)Object.prototype.hasOwnProperty.call(n,s)&&(i[s]=e.call(t,n[s],s,n));return i}function Bs(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const s of t){if(!i.includes(s))return!1;const o=n[s],r=e[s];if($o(o)&&$o(r)){if(!Bs(o,r))return!1}else if(o!==r)return!1}for(const s of i)if(!t.includes(s))return!1;return!0}function $o(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nd(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class id{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const i=this.W_;if(typeof e=="string")for(let d=0;d<16;d++)i[d]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let d=0;d<16;d++)i[d]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let d=16;d<80;d++){const f=i[d-3]^i[d-8]^i[d-14]^i[d-16];i[d]=(f<<1|f>>>31)&4294967295}let s=this.chain_[0],o=this.chain_[1],r=this.chain_[2],l=this.chain_[3],a=this.chain_[4],c,u;for(let d=0;d<80;d++){d<40?d<20?(c=l^o&(r^l),u=1518500249):(c=o^r^l,u=1859775393):d<60?(c=o&r|l&(o|r),u=2400959708):(c=o^r^l,u=3395469782);const f=(s<<5|s>>>27)+c+a+u+i[d]&4294967295;a=l,l=r,r=(o<<30|o>>>2)&4294967295,o=s,s=f}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+o&4294967295,this.chain_[2]=this.chain_[2]+r&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+a&4294967295}update(e,t){if(e==null)return;t===void 0&&(t=e.length);const i=t-this.blockSize;let s=0;const o=this.buf_;let r=this.inbuf_;for(;s<t;){if(r===0)for(;s<=i;)this.compress_(e,s),s+=this.blockSize;if(typeof e=="string"){for(;s<t;)if(o[r]=e.charCodeAt(s),++r,++s,r===this.blockSize){this.compress_(o),r=0;break}}else for(;s<t;)if(o[r]=e[s],++r,++s,r===this.blockSize){this.compress_(o),r=0;break}}this.inbuf_=r,this.total_+=t}digest(){const e=[];let t=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let s=this.blockSize-1;s>=56;s--)this.buf_[s]=t&255,t/=256;this.compress_(this.buf_);let i=0;for(let s=0;s<5;s++)for(let o=24;o>=0;o-=8)e[i]=this.chain_[s]>>o&255,++i;return e}}function fo(n,e){return`${n} failed: ${e} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sd=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let s=n.charCodeAt(i);if(s>=55296&&s<=56319){const o=s-55296;i++,ee(i<n.length,"Surrogate pair missing trail surrogate.");const r=n.charCodeAt(i)-56320;s=65536+(o<<10)+r}s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):s<65536?(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},ss=function(n){let e=0;for(let t=0;t<n.length;t++){const i=n.charCodeAt(t);i<128?e++:i<2048?e+=2:i>=55296&&i<=56319?(e+=4,t++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cn(n){return n&&n._delegate?n._delegate:n}class ui{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dn="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class od{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new is;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&i.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const i=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(o){if(s)return null;throw o}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(ld(e))try{this.getOrInitializeService({instanceIdentifier:dn})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const o=this.getOrInitializeService({instanceIdentifier:s});i.resolve(o)}catch{}}}}clearInstance(e=dn){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=dn){return this.instances.has(e)}getOptions(e=dn){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[o,r]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(o);i===l&&r.resolve(s)}return s}onInit(e,t){var i;const s=this.normalizeInstanceIdentifier(t),o=(i=this.onInitCallbacks.get(s))!==null&&i!==void 0?i:new Set;o.add(e),this.onInitCallbacks.set(s,o);const r=this.instances.get(s);return r&&e(r,s),()=>{o.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const s of i)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:rd(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=dn){return this.component?this.component.multipleInstances?e:dn:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function rd(n){return n===dn?void 0:n}function ld(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ad{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new od(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ke;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Ke||(Ke={}));const cd={debug:Ke.DEBUG,verbose:Ke.VERBOSE,info:Ke.INFO,warn:Ke.WARN,error:Ke.ERROR,silent:Ke.SILENT},ud=Ke.INFO,dd={[Ke.DEBUG]:"log",[Ke.VERBOSE]:"log",[Ke.INFO]:"info",[Ke.WARN]:"warn",[Ke.ERROR]:"error"},fd=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),s=dd[e];if(s)console[s](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Ia{constructor(e){this.name=e,this._logLevel=ud,this._logHandler=fd,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ke))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?cd[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ke.DEBUG,...e),this._logHandler(this,Ke.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ke.VERBOSE,...e),this._logHandler(this,Ke.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ke.INFO,...e),this._logHandler(this,Ke.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ke.WARN,...e),this._logHandler(this,Ke.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ke.ERROR,...e),this._logHandler(this,Ke.ERROR,...e)}}const hd=(n,e)=>e.some(t=>n instanceof t);let er,tr;function pd(){return er||(er=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function _d(){return tr||(tr=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Ta=new WeakMap,qs=new WeakMap,Na=new WeakMap,Cs=new WeakMap,ho=new WeakMap;function md(n){const e=new Promise((t,i)=>{const s=()=>{n.removeEventListener("success",o),n.removeEventListener("error",r)},o=()=>{t(Zt(n.result)),s()},r=()=>{i(n.error),s()};n.addEventListener("success",o),n.addEventListener("error",r)});return e.then(t=>{t instanceof IDBCursor&&Ta.set(t,n)}).catch(()=>{}),ho.set(e,n),e}function gd(n){if(qs.has(n))return;const e=new Promise((t,i)=>{const s=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",r),n.removeEventListener("abort",r)},o=()=>{t(),s()},r=()=>{i(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",o),n.addEventListener("error",r),n.addEventListener("abort",r)});qs.set(n,e)}let zs={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return qs.get(n);if(e==="objectStoreNames")return n.objectStoreNames||Na.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Zt(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function bd(n){zs=n(zs)}function vd(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(Es(this),e,...t);return Na.set(i,e.sort?e.sort():[e]),Zt(i)}:_d().includes(n)?function(...e){return n.apply(Es(this),e),Zt(Ta.get(this))}:function(...e){return Zt(n.apply(Es(this),e))}}function yd(n){return typeof n=="function"?vd(n):(n instanceof IDBTransaction&&gd(n),hd(n,pd())?new Proxy(n,zs):n)}function Zt(n){if(n instanceof IDBRequest)return md(n);if(Cs.has(n))return Cs.get(n);const e=yd(n);return e!==n&&(Cs.set(n,e),ho.set(e,n)),e}const Es=n=>ho.get(n);function wd(n,e,{blocked:t,upgrade:i,blocking:s,terminated:o}={}){const r=indexedDB.open(n,e),l=Zt(r);return i&&r.addEventListener("upgradeneeded",a=>{i(Zt(r.result),a.oldVersion,a.newVersion,Zt(r.transaction),a)}),t&&r.addEventListener("blocked",a=>t(a.oldVersion,a.newVersion,a)),l.then(a=>{o&&a.addEventListener("close",()=>o()),s&&a.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),l}const kd=["get","getKey","getAll","getAllKeys","count"],Cd=["put","add","delete","clear"],Ss=new Map;function nr(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Ss.get(e))return Ss.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,s=Cd.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(s||kd.includes(t)))return;const o=async function(r,...l){const a=this.transaction(r,s?"readwrite":"readonly");let c=a.store;return i&&(c=c.index(l.shift())),(await Promise.all([c[t](...l),s&&a.done]))[0]};return Ss.set(e,o),o}bd(n=>({...n,get:(e,t,i)=>nr(e,t)||n.get(e,t,i),has:(e,t)=>!!nr(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ed{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(Sd(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function Sd(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const js="@firebase/app",ir="0.9.23";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vn=new Ia("@firebase/app"),Id="@firebase/app-compat",Td="@firebase/analytics-compat",Nd="@firebase/analytics",Od="@firebase/app-check-compat",Dd="@firebase/app-check",Rd="@firebase/auth",Ad="@firebase/auth-compat",Pd="@firebase/database",Md="@firebase/database-compat",Ld="@firebase/functions",Fd="@firebase/functions-compat",Bd="@firebase/installations",qd="@firebase/installations-compat",zd="@firebase/messaging",jd="@firebase/messaging-compat",Wd="@firebase/performance",Hd="@firebase/performance-compat",Ud="@firebase/remote-config",Gd="@firebase/remote-config-compat",Vd="@firebase/storage",Kd="@firebase/storage-compat",Yd="@firebase/firestore",Qd="@firebase/firestore-compat",Xd="firebase",Jd="10.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ws="[DEFAULT]",Zd={[js]:"fire-core",[Id]:"fire-core-compat",[Nd]:"fire-analytics",[Td]:"fire-analytics-compat",[Dd]:"fire-app-check",[Od]:"fire-app-check-compat",[Rd]:"fire-auth",[Ad]:"fire-auth-compat",[Pd]:"fire-rtdb",[Md]:"fire-rtdb-compat",[Ld]:"fire-fn",[Fd]:"fire-fn-compat",[Bd]:"fire-iid",[qd]:"fire-iid-compat",[zd]:"fire-fcm",[jd]:"fire-fcm-compat",[Wd]:"fire-perf",[Hd]:"fire-perf-compat",[Ud]:"fire-rc",[Gd]:"fire-rc-compat",[Vd]:"fire-gcs",[Kd]:"fire-gcs-compat",[Yd]:"fire-fst",[Qd]:"fire-fst-compat","fire-js":"fire-js",[Xd]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ji=new Map,Hs=new Map;function xd(n,e){try{n.container.addComponent(e)}catch(t){vn.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Wi(n){const e=n.name;if(Hs.has(e))return vn.debug(`There were multiple attempts to register component ${e}.`),!1;Hs.set(e,n);for(const t of ji.values())xd(t,n);return!0}function $d(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ef={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},xt=new Ea("app","Firebase",ef);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tf{constructor(e,t,i){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new ui("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw xt.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nf=Jd;function Oa(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i=Object.assign({name:Ws,automaticDataCollectionEnabled:!1},e),s=i.name;if(typeof s!="string"||!s)throw xt.create("bad-app-name",{appName:String(s)});if(t||(t=wa()),!t)throw xt.create("no-options");const o=ji.get(s);if(o){if(Bs(t,o.options)&&Bs(i,o.config))return o;throw xt.create("duplicate-app",{appName:s})}const r=new ad(s);for(const a of Hs.values())r.addComponent(a);const l=new tf(t,i,r);return ji.set(s,l),l}function sf(n=Ws){const e=ji.get(n);if(!e&&n===Ws&&wa())return Oa();if(!e)throw xt.create("no-app",{appName:n});return e}function Mn(n,e,t){var i;let s=(i=Zd[n])!==null&&i!==void 0?i:n;t&&(s+=`-${t}`);const o=s.match(/\s|\//),r=e.match(/\s|\//);if(o||r){const l=[`Unable to register library "${s}" with version "${e}":`];o&&l.push(`library name "${s}" contains illegal characters (whitespace or "/")`),o&&r&&l.push("and"),r&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),vn.warn(l.join(" "));return}Wi(new ui(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const of="firebase-heartbeat-database",rf=1,di="firebase-heartbeat-store";let Is=null;function Da(){return Is||(Is=wd(of,rf,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(di)}}}).catch(n=>{throw xt.create("idb-open",{originalErrorMessage:n.message})})),Is}async function lf(n){try{return await(await Da()).transaction(di).objectStore(di).get(Ra(n))}catch(e){if(e instanceof wi)vn.warn(e.message);else{const t=xt.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});vn.warn(t.message)}}}async function sr(n,e){try{const i=(await Da()).transaction(di,"readwrite");await i.objectStore(di).put(e,Ra(n)),await i.done}catch(t){if(t instanceof wi)vn.warn(t.message);else{const i=xt.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});vn.warn(i.message)}}}function Ra(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const af=1024,cf=30*24*60*60*1e3;class uf{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new ff(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var e;const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=or();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)))return this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const r=new Date(o.date).valueOf();return Date.now()-r<=cf}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var e;if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=or(),{heartbeatsToSend:i,unsentEntries:s}=df(this._heartbeatsCache.heartbeats),o=qi(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=t,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}}function or(){return new Date().toISOString().substring(0,10)}function df(n,e=af){const t=[];let i=n.slice();for(const s of n){const o=t.find(r=>r.agent===s.agent);if(o){if(o.dates.push(s.date),rr(t)>e){o.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),rr(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class ff{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Xu()?Ju().then(()=>!0).catch(()=>!1):!1}async read(){return await this._canUseIndexedDBPromise?await lf(this.app)||{heartbeats:[]}:{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return sr(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return sr(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function rr(n){return qi(JSON.stringify({version:2,heartbeats:n})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hf(n){Wi(new ui("platform-logger",e=>new Ed(e),"PRIVATE")),Wi(new ui("heartbeat",e=>new uf(e),"PRIVATE")),Mn(js,ir,n),Mn(js,ir,"esm2017"),Mn("fire-js","")}hf("");var pf="firebase",_f="10.6.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Mn(pf,_f,"app");const lr="@firebase/database",ar="1.0.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Aa="";function mf(n){Aa=n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gf{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),ot(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:ci(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bf{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return Ut(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pa=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){const e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new gf(e)}}catch{}return new bf},pn=Pa("localStorage"),Us=Pa("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ln=new Ia("@firebase/database"),vf=function(){let n=1;return function(){return n++}}(),Ma=function(n){const e=sd(n),t=new id;t.update(e);const i=t.digest();return uo.encodeByteArray(i)},ki=function(...n){let e="";for(let t=0;t<n.length;t++){const i=n[t];Array.isArray(i)||i&&typeof i=="object"&&typeof i.length=="number"?e+=ki.apply(null,i):typeof i=="object"?e+=ot(i):e+=i,e+=" "}return e};let gn=null,cr=!0;const yf=function(n,e){ee(!e||n===!0||n===!1,"Can't turn on custom loggers persistently."),n===!0?(Ln.logLevel=Ke.VERBOSE,gn=Ln.log.bind(Ln),e&&Us.set("logging_enabled",!0)):typeof n=="function"?gn=n:(gn=null,Us.remove("logging_enabled"))},_t=function(...n){if(cr===!0&&(cr=!1,gn===null&&Us.get("logging_enabled")===!0&&yf(!0)),gn){const e=ki.apply(null,n);gn(e)}},Ci=function(n){return function(...e){_t(n,...e)}},Gs=function(...n){const e="FIREBASE INTERNAL ERROR: "+ki(...n);Ln.error(e)},Kt=function(...n){const e=`FIREBASE FATAL ERROR: ${ki(...n)}`;throw Ln.error(e),new Error(e)},Ct=function(...n){const e="FIREBASE WARNING: "+ki(...n);Ln.warn(e)},wf=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Ct("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},po=function(n){return typeof n=="number"&&(n!==n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},kf=function(n){if(document.readyState==="complete")n();else{let e=!1;const t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,n())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},yn="[MIN_NAME]",on="[MAX_NAME]",Yn=function(n,e){if(n===e)return 0;if(n===yn||e===on)return-1;if(e===yn||n===on)return 1;{const t=ur(n),i=ur(e);return t!==null?i!==null?t-i===0?n.length-e.length:t-i:-1:i!==null?1:n<e?-1:1}},Cf=function(n,e){return n===e?0:n<e?-1:1},$n=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+ot(e))},_o=function(n){if(typeof n!="object"||n===null)return ot(n);const e=[];for(const i in n)e.push(i);e.sort();let t="{";for(let i=0;i<e.length;i++)i!==0&&(t+=","),t+=ot(e[i]),t+=":",t+=_o(n[e[i]]);return t+="}",t},La=function(n,e){const t=n.length;if(t<=e)return[n];const i=[];for(let s=0;s<t;s+=e)s+e>t?i.push(n.substring(s,t)):i.push(n.substring(s,s+e));return i};function Et(n,e){for(const t in n)n.hasOwnProperty(t)&&e(t,n[t])}const Fa=function(n){ee(!po(n),"Invalid JSON number");const e=11,t=52,i=(1<<e-1)-1;let s,o,r,l,a;n===0?(o=0,r=0,s=1/n===-1/0?1:0):(s=n<0,n=Math.abs(n),n>=Math.pow(2,1-i)?(l=Math.min(Math.floor(Math.log(n)/Math.LN2),i),o=l+i,r=Math.round(n*Math.pow(2,t-l)-Math.pow(2,t))):(o=0,r=Math.round(n/Math.pow(2,1-i-t))));const c=[];for(a=t;a;a-=1)c.push(r%2?1:0),r=Math.floor(r/2);for(a=e;a;a-=1)c.push(o%2?1:0),o=Math.floor(o/2);c.push(s?1:0),c.reverse();const u=c.join("");let d="";for(a=0;a<64;a+=8){let f=parseInt(u.substr(a,8),2).toString(16);f.length===1&&(f="0"+f),d=d+f}return d.toLowerCase()},Ef=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},Sf=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function If(n,e){let t="Unknown Error";n==="too_big"?t="The data requested exceeds the maximum size that can be accessed with a single request.":n==="permission_denied"?t="Client doesn't have permission to access the desired data.":n==="unavailable"&&(t="The service is unavailable");const i=new Error(n+" at "+e._path.toString()+": "+t);return i.code=n.toUpperCase(),i}const Tf=new RegExp("^-?(0*)\\d{1,10}$"),Nf=-2147483648,Of=2147483647,ur=function(n){if(Tf.test(n)){const e=Number(n);if(e>=Nf&&e<=Of)return e}return null},Qn=function(n){try{n()}catch(e){setTimeout(()=>{const t=e.stack||"";throw Ct("Exception was thrown by user callback.",t),e},Math.floor(0))}},Df=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},si=function(n,e){const t=setTimeout(n,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rf{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=t==null?void 0:t.getImmediate({optional:!0}),this.appCheck||t==null||t.get().then(i=>this.appCheck=i)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,i)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,i):t(null)},0)})}addTokenChangeListener(e){var t;(t=this.appCheckProvider)===null||t===void 0||t.get().then(i=>i.addTokenListener(e))}notifyForInvalidToken(){Ct(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Af{constructor(e,t,i){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=i,this.auth_=null,this.auth_=i.getImmediate({optional:!0}),this.auth_||i.onInit(s=>this.auth_=s)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(_t("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,i)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,i):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Ct(e)}}class Fn{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}Fn.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mo="5",Ba="v",qa="s",za="r",ja="f",Wa=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,Ha="ls",Ua="p",Vs="ac",Ga="websocket",Va="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ka{constructor(e,t,i,s,o=!1,r="",l=!1,a=!1){this.secure=t,this.namespace=i,this.webSocketOnly=s,this.nodeAdmin=o,this.persistenceKey=r,this.includeNamespaceInQueryParams=l,this.isUsingEmulator=a,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=pn.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&pn.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}}function Pf(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams}function Ya(n,e,t){ee(typeof e=="string","typeof type must == string"),ee(typeof t=="object","typeof params must == object");let i;if(e===Ga)i=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else if(e===Va)i=(n.secure?"https://":"http://")+n.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);Pf(n)&&(t.ns=n.namespace);const s=[];return Et(t,(o,r)=>{s.push(o+"="+r)}),i+s.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mf{constructor(){this.counters_={}}incrementCounter(e,t=1){Ut(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return qu(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ts={},Ns={};function go(n){const e=n.toString();return Ts[e]||(Ts[e]=new Mf),Ts[e]}function Lf(n,e){const t=n.toString();return Ns[t]||(Ns[t]=e()),Ns[t]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ff{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const i=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let s=0;s<i.length;++s)i[s]&&Qn(()=>{this.onMessage_(i[s])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dr="start",Bf="close",qf="pLPCommand",zf="pRTLPCB",Qa="id",Xa="pw",Ja="ser",jf="cb",Wf="seg",Hf="ts",Uf="d",Gf="dframe",Za=1870,xa=30,Vf=Za-xa,Kf=25e3,Yf=3e4;class Dn{constructor(e,t,i,s,o,r,l){this.connId=e,this.repoInfo=t,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.transportSessionId=r,this.lastSessionId=l,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Ci(e),this.stats_=go(t),this.urlFn=a=>(this.appCheckToken&&(a[Vs]=this.appCheckToken),Ya(t,Va,a))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new Ff(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(Yf)),kf(()=>{if(this.isClosed_)return;this.scriptTagHolder=new bo((...o)=>{const[r,l,a,c,u]=o;if(this.incrementIncomingBytes_(o),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,r===dr)this.id=l,this.password=a;else if(r===Bf)l?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(l,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+r)},(...o)=>{const[r,l]=o;this.incrementIncomingBytes_(o),this.myPacketOrderer.handleResponse(r,l)},()=>{this.onClosed_()},this.urlFn);const i={};i[dr]="t",i[Ja]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(i[jf]=this.scriptTagHolder.uniqueCallbackIdentifier),i[Ba]=mo,this.transportSessionId&&(i[qa]=this.transportSessionId),this.lastSessionId&&(i[Ha]=this.lastSessionId),this.applicationId&&(i[Ua]=this.applicationId),this.appCheckToken&&(i[Vs]=this.appCheckToken),typeof location<"u"&&location.hostname&&Wa.test(location.hostname)&&(i[za]=ja);const s=this.urlFn(i);this.log_("Connecting via long-poll to "+s),this.scriptTagHolder.addTag(s,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Dn.forceAllow_=!0}static forceDisallow(){Dn.forceDisallow_=!0}static isAvailable(){return Dn.forceAllow_?!0:!Dn.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!Ef()&&!Sf()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=ot(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const i=ba(t),s=La(i,Vf);for(let o=0;o<s.length;o++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,s.length,s[o]),this.curSegmentNum++}addDisconnectPingFrame(e,t){this.myDisconnFrame=document.createElement("iframe");const i={};i[Gf]="t",i[Qa]=e,i[Xa]=t,this.myDisconnFrame.src=this.urlFn(i),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=ot(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class bo{constructor(e,t,i,s){this.onDisconnect=i,this.urlFn=s,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=vf(),window[qf+this.uniqueCallbackIdentifier]=e,window[zf+this.uniqueCallbackIdentifier]=t,this.myIFrame=bo.createIFrame_();let o="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(o='<script>document.domain="'+document.domain+'";<\/script>');const r="<html><body>"+o+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(r),this.myIFrame.doc.close()}catch(l){_t("frame writing exception"),l.stack&&_t(l.stack),_t(l)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||_t("No IE domain setting required")}catch{const i=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+i+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[Qa]=this.myID,e[Xa]=this.myPW,e[Ja]=this.currentSerial;let t=this.urlFn(e),i="",s=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+xa+i.length<=Za;){const r=this.pendingSegs.shift();i=i+"&"+Wf+s+"="+r.seg+"&"+Hf+s+"="+r.ts+"&"+Uf+s+"="+r.d,s++}return t=t+i,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,i){this.pendingSegs.push({seg:e,ts:t,d:i}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const i=()=>{this.outstandingRequests.delete(t),this.newRequest_()},s=setTimeout(i,Math.floor(Kf)),o=()=>{clearTimeout(s),i()};this.addTag(e,o)}addTag(e,t){setTimeout(()=>{try{if(!this.sendNewPolls)return;const i=this.myIFrame.doc.createElement("script");i.type="text/javascript",i.async=!0,i.src=e,i.onload=i.onreadystatechange=function(){const s=i.readyState;(!s||s==="loaded"||s==="complete")&&(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),t())},i.onerror=()=>{_t("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(i)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qf=16384,Xf=45e3;let Hi=null;typeof MozWebSocket<"u"?Hi=MozWebSocket:typeof WebSocket<"u"&&(Hi=WebSocket);class Dt{constructor(e,t,i,s,o,r,l){this.connId=e,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Ci(this.connId),this.stats_=go(t),this.connURL=Dt.connectionURL_(t,r,l,s,i),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,i,s,o){const r={};return r[Ba]=mo,typeof location<"u"&&location.hostname&&Wa.test(location.hostname)&&(r[za]=ja),t&&(r[qa]=t),i&&(r[Ha]=i),s&&(r[Vs]=s),o&&(r[Ua]=o),Ya(e,Ga,r)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,pn.set("previous_websocket_failure",!0);try{let i;Ca(),this.mySock=new Hi(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");const s=i.message||i.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");const s=i.message||i.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){Dt.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(t);i&&i.length>1&&parseFloat(i[1])<4.4&&(e=!0)}return!e&&Hi!==null&&!Dt.forceDisallow_}static previouslyFailed(){return pn.isInMemoryStorage||pn.get("previous_websocket_failure")===!0}markConnectionHealthy(){pn.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const t=this.frames.join("");this.frames=null;const i=ci(t);this.onMessage(i)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(ee(this.frames===null,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(t);else{const i=this.extractFrameCount_(t);i!==null&&this.appendFrame_(i)}}send(e){this.resetKeepAlive();const t=ot(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const i=La(t,Qf);i.length>1&&this.sendString_(String(i.length));for(let s=0;s<i.length;s++)this.sendString_(i[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(Xf))}sendString_(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}Dt.responsesRequiredToBeHealthy=2;Dt.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fi{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[Dn,Dt]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const t=Dt&&Dt.isAvailable();let i=t&&!Dt.previouslyFailed();if(e.webSocketOnly&&(t||Ct("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[Dt];else{const s=this.transports_=[];for(const o of fi.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);fi.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}fi.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jf=6e4,Zf=5e3,xf=10*1024,$f=100*1024,Os="t",fr="d",eh="s",hr="r",th="e",pr="o",_r="a",mr="n",gr="p",nh="h";class ih{constructor(e,t,i,s,o,r,l,a,c,u){this.id=e,this.repoInfo_=t,this.applicationId_=i,this.appCheckToken_=s,this.authToken_=o,this.onMessage_=r,this.onReady_=l,this.onDisconnect_=a,this.onKill_=c,this.lastSessionId=u,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Ci("c:"+this.id+":"),this.transportManager_=new fi(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),i=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,i)},Math.floor(0));const s=e.healthyTimeout||0;s>0&&(this.healthyTimeout_=si(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>$f?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>xf?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(s)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(Os in e){const t=e[Os];t===_r?this.upgradeIfSecondaryHealthy_():t===hr?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===pr&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=$n("t",e),i=$n("d",e);if(t==="c")this.onSecondaryControl_(i);else if(t==="d")this.pendingDataMessages.push(i);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:gr,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:_r,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:mr,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=$n("t",e),i=$n("d",e);t==="c"?this.onControl_(i):t==="d"&&this.onDataMessage_(i)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=$n(Os,e);if(fr in e){const i=e[fr];if(t===nh){const s=Object.assign({},i);this.repoInfo_.isUsingEmulator&&(s.h=this.repoInfo_.host),this.onHandshake_(s)}else if(t===mr){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let s=0;s<this.pendingDataMessages.length;++s)this.onDataMessage_(this.pendingDataMessages[s]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===eh?this.onConnectionShutdown_(i):t===hr?this.onReset_(i):t===th?Gs("Server Error: "+i):t===pr?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Gs("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,i=e.v,s=e.h;this.sessionId=e.s,this.repoInfo_.host=s,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),mo!==i&&Ct("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),i=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,i),si(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(Jf))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):si(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(Zf))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:gr,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(pn.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $a{put(e,t,i,s){}merge(e,t,i,s){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,i){}onDisconnectMerge(e,t,i){}onDisconnectCancel(e,t){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ec{constructor(e){this.allowedEvents_=e,this.listeners_={},ee(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const i=[...this.listeners_[e]];for(let s=0;s<i.length;s++)i[s].callback.apply(i[s].context,t)}}on(e,t,i){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:i});const s=this.getInitialEvent(e);s&&t.apply(i,s)}off(e,t,i){this.validateEventType_(e);const s=this.listeners_[e]||[];for(let o=0;o<s.length;o++)if(s[o].callback===t&&(!i||i===s[o].context)){s.splice(o,1);return}}validateEventType_(e){ee(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ui extends ec{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!ka()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new Ui}getInitialEvent(e){return ee(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const br=32,vr=768;class Ge{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let i=0;for(let s=0;s<this.pieces_.length;s++)this.pieces_[s].length>0&&(this.pieces_[i]=this.pieces_[s],i++);this.pieces_.length=i,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}}function Be(){return new Ge("")}function Ee(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function rn(n){return n.pieces_.length-n.pieceNum_}function Ye(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new Ge(n.pieces_,e)}function tc(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function sh(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)n.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}function nc(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function ic(n){if(n.pieceNum_>=n.pieces_.length)return null;const e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new Ge(e,0)}function rt(n,e){const t=[];for(let i=n.pieceNum_;i<n.pieces_.length;i++)t.push(n.pieces_[i]);if(e instanceof Ge)for(let i=e.pieceNum_;i<e.pieces_.length;i++)t.push(e.pieces_[i]);else{const i=e.split("/");for(let s=0;s<i.length;s++)i[s].length>0&&t.push(i[s])}return new Ge(t,0)}function Ce(n){return n.pieceNum_>=n.pieces_.length}function bt(n,e){const t=Ee(n),i=Ee(e);if(t===null)return e;if(t===i)return bt(Ye(n),Ye(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function sc(n,e){if(rn(n)!==rn(e))return!1;for(let t=n.pieceNum_,i=e.pieceNum_;t<=n.pieces_.length;t++,i++)if(n.pieces_[t]!==e.pieces_[i])return!1;return!0}function Rt(n,e){let t=n.pieceNum_,i=e.pieceNum_;if(rn(n)>rn(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[i])return!1;++t,++i}return!0}class oh{constructor(e,t){this.errorPrefix_=t,this.parts_=nc(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let i=0;i<this.parts_.length;i++)this.byteLength_+=ss(this.parts_[i]);oc(this)}}function rh(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=ss(e),oc(n)}function lh(n){const e=n.parts_.pop();n.byteLength_-=ss(e),n.parts_.length>0&&(n.byteLength_-=1)}function oc(n){if(n.byteLength_>vr)throw new Error(n.errorPrefix_+"has a key path longer than "+vr+" bytes ("+n.byteLength_+").");if(n.parts_.length>br)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+br+") or object contains a cycle "+fn(n))}function fn(n){return n.parts_.length===0?"":"in property '"+n.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vo extends ec{constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const i=!document[e];i!==this.visible_&&(this.visible_=i,this.trigger("visible",i))},!1)}static getInstance(){return new vo}getInitialEvent(e){return ee(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ei=1e3,ah=60*5*1e3,yr=30*1e3,ch=1.3,uh=3e4,dh="server_kill",wr=3;class Vt extends $a{constructor(e,t,i,s,o,r,l,a){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=i,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=r,this.appCheckTokenProvider_=l,this.authOverride_=a,this.id=Vt.nextPersistentConnectionId_++,this.log_=Ci("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=ei,this.maxReconnectDelay_=ah,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,a&&!Ca())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");vo.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&Ui.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,i){const s=++this.requestNumber_,o={r:s,a:e,b:t};this.log_(ot(o)),ee(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),i&&(this.requestCBHash_[s]=i)}get(e){this.initConnection_();const t=new is,s={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:r=>{const l=r.d;r.s==="ok"?t.resolve(l):t.reject(l)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;const o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),t.promise}listen(e,t,i,s){this.initConnection_();const o=e._queryIdentifier,r=e._path.toString();this.log_("Listen called for "+r+" "+o),this.listens.has(r)||this.listens.set(r,new Map),ee(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),ee(!this.listens.get(r).has(o),"listen() called twice for same path/queryId.");const l={onComplete:s,hashFn:t,query:e,tag:i};this.listens.get(r).set(o,l),this.connected_&&this.sendListen_(l)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,i=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(i)})}sendListen_(e){const t=e.query,i=t._path.toString(),s=t._queryIdentifier;this.log_("Listen on "+i+" for "+s);const o={p:i},r="q";e.tag&&(o.q=t._queryObject,o.t=e.tag),o.h=e.hashFn(),this.sendRequest(r,o,l=>{const a=l.d,c=l.s;Vt.warnOnListenWarnings_(a,t),(this.listens.get(i)&&this.listens.get(i).get(s))===e&&(this.log_("listen response",l),c!=="ok"&&this.removeListen_(i,s),e.onComplete&&e.onComplete(c,a))})}static warnOnListenWarnings_(e,t){if(e&&typeof e=="object"&&Ut(e,"w")){const i=zn(e,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){const s='".indexOn": "'+t._queryParams.getIndex().toString()+'"',o=t._path.toString();Ct(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||td(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=yr)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=ed(e)?"auth":"gauth",i={cred:e};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(t,i,s=>{const o=s.s,r=s.d||"error";this.authToken_===e&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,r))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const t=e.s,i=e.d||"error";t==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,i)})}unlisten(e,t){const i=e._path.toString(),s=e._queryIdentifier;this.log_("Unlisten called for "+i+" "+s),ee(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,s)&&this.connected_&&this.sendUnlisten_(i,s,e._queryObject,t)}sendUnlisten_(e,t,i,s){this.log_("Unlisten on "+e+" for "+t);const o={p:e},r="n";s&&(o.q=i,o.t=s),this.sendRequest(r,o)}onDisconnectPut(e,t,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,i):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:i})}onDisconnectMerge(e,t,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,i):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:i})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,i,s){const o={p:t,d:i};this.log_("onDisconnect "+e,o),this.sendRequest(e,o,r=>{s&&setTimeout(()=>{s(r.s,r.d)},Math.floor(0))})}put(e,t,i,s){this.putInternal("p",e,t,i,s)}merge(e,t,i,s){this.putInternal("m",e,t,i,s)}putInternal(e,t,i,s,o){this.initConnection_();const r={p:t,d:i};o!==void 0&&(r.h=o),this.outstandingPuts_.push({action:e,request:r,onComplete:s}),this.outstandingPutCount_++;const l=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(l):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,i=this.outstandingPuts_[e].request,s=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,i,o=>{this.log_(t+" response",o),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,i=>{if(i.s!=="ok"){const o=i.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+ot(e));const t=e.r,i=this.requestCBHash_[t];i&&(delete this.requestCBHash_[t],i(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),e==="d"?this.onDataUpdate_(t.p,t.d,!1,t.t):e==="m"?this.onDataUpdate_(t.p,t.d,!0,t.t):e==="c"?this.onListenRevoked_(t.p,t.q):e==="ac"?this.onAuthRevoked_(t.s,t.d):e==="apc"?this.onAppCheckRevoked_(t.s,t.d):e==="sd"?this.onSecurityDebugPacket_(t):Gs("Unrecognized action received from server: "+ot(e)+`
Are you using the latest client?`)}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){ee(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=ei,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=ei,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>uh&&(this.reconnectDelay_=ei),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=new Date().getTime()-this.lastConnectionAttemptTime_;let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*ch)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+Vt.nextConnectionId_++,o=this.lastSessionId;let r=!1,l=null;const a=function(){l?l.close():(r=!0,i())},c=function(d){ee(l,"sendRequest call when we're not connected not allowed."),l.sendRequest(d)};this.realtime_={close:a,sendRequest:c};const u=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[d,f]=await Promise.all([this.authTokenProvider_.getToken(u),this.appCheckTokenProvider_.getToken(u)]);r?_t("getToken() completed but was canceled"):(_t("getToken() completed. Creating connection."),this.authToken_=d&&d.accessToken,this.appCheckToken_=f&&f.token,l=new ih(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,i,h=>{Ct(h+" ("+this.repoInfo_.toString()+")"),this.interrupt(dh)},o))}catch(d){this.log_("Failed to get token: "+d),r||(this.repoInfo_.nodeAdmin&&Ct(d),a())}}}interrupt(e){_t("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){_t("Resuming connection for reason: "+e),delete this.interruptReasons_[e],xo(this.interruptReasons_)&&(this.reconnectDelay_=ei,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let i;t?i=t.map(o=>_o(o)).join("$"):i="default";const s=this.removeListen_(e,i);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(e,t){const i=new Ge(e).toString();let s;if(this.listens.has(i)){const o=this.listens.get(i);s=o.get(t),o.delete(t),o.size===0&&this.listens.delete(i)}else s=void 0;return s}onAuthRevoked_(e,t){_t("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=wr&&(this.reconnectDelay_=yr,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){_t("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=wr&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let t="js";e["sdk."+t+"."+Aa.replace(/\./g,"-")]=1,ka()?e["framework.cordova"]=1:Qu()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=Ui.getInstance().currentlyOnline();return xo(this.interruptReasons_)&&e}}Vt.nextPersistentConnectionId_=0;Vt.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ke{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new ke(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class os{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const i=new ke(yn,e),s=new ke(yn,t);return this.compare(i,s)!==0}minPost(){return ke.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Di;class rc extends os{static get __EMPTY_NODE(){return Di}static set __EMPTY_NODE(e){Di=e}compare(e,t){return Yn(e.name,t.name)}isDefinedOn(e){throw Kn("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return ke.MIN}maxPost(){return new ke(on,Di)}makePost(e,t){return ee(typeof e=="string","KeyIndex indexValue must always be a string."),new ke(e,Di)}toString(){return".key"}}const $t=new rc;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ri{constructor(e,t,i,s,o=null){this.isReverse_=s,this.resultGenerator_=o,this.nodeStack_=[];let r=1;for(;!e.isEmpty();)if(e=e,r=t?i(e.key,t):1,s&&(r*=-1),r<0)this.isReverse_?e=e.left:e=e.right;else if(r===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class ut{constructor(e,t,i,s,o){this.key=e,this.value=t,this.color=i??ut.RED,this.left=s??kt.EMPTY_NODE,this.right=o??kt.EMPTY_NODE}copy(e,t,i,s,o){return new ut(e??this.key,t??this.value,i??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let s=this;const o=i(e,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(e,t,i),null):o===0?s=s.copy(null,t,null,null,null):s=s.copy(null,null,null,null,s.right.insert(e,t,i)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return kt.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let i,s;if(i=this,t(e,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),t(e,i.key)===0){if(i.right.isEmpty())return kt.EMPTY_NODE;s=i.right.min_(),i=i.copy(s.key,s.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,ut.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,ut.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}ut.RED=!0;ut.BLACK=!1;class fh{copy(e,t,i,s,o){return this}insert(e,t,i){return new ut(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class kt{constructor(e,t=kt.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new kt(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,ut.BLACK,null,null))}remove(e){return new kt(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,ut.BLACK,null,null))}get(e){let t,i=this.root_;for(;!i.isEmpty();){if(t=this.comparator_(e,i.key),t===0)return i.value;t<0?i=i.left:t>0&&(i=i.right)}return null}getPredecessorKey(e){let t,i=this.root_,s=null;for(;!i.isEmpty();)if(t=this.comparator_(e,i.key),t===0){if(i.left.isEmpty())return s?s.key:null;for(i=i.left;!i.right.isEmpty();)i=i.right;return i.key}else t<0?i=i.left:t>0&&(s=i,i=i.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Ri(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Ri(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Ri(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Ri(this.root_,null,this.comparator_,!0,e)}}kt.EMPTY_NODE=new fh;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hh(n,e){return Yn(n.name,e.name)}function yo(n,e){return Yn(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ks;function ph(n){Ks=n}const lc=function(n){return typeof n=="number"?"number:"+Fa(n):"string:"+n},ac=function(n){if(n.isLeafNode()){const e=n.val();ee(typeof e=="string"||typeof e=="number"||typeof e=="object"&&Ut(e,".sv"),"Priority must be a string or number.")}else ee(n===Ks||n.isEmpty(),"priority of unexpected type.");ee(n===Ks||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let kr;class ct{constructor(e,t=ct.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,ee(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),ac(this.priorityNode_)}static set __childrenNodeConstructor(e){kr=e}static get __childrenNodeConstructor(){return kr}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new ct(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:ct.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return Ce(e)?this:Ee(e)===".priority"?this.priorityNode_:ct.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return e===".priority"?this.updatePriority(t):t.isEmpty()&&e!==".priority"?this:ct.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const i=Ee(e);return i===null?t:t.isEmpty()&&i!==".priority"?this:(ee(i!==".priority"||rn(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,ct.__childrenNodeConstructor.EMPTY_NODE.updateChild(Ye(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+lc(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",t==="number"?e+=Fa(this.value_):e+=this.value_,this.lazyHash_=Ma(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===ct.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof ct.__childrenNodeConstructor?-1:(ee(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,i=typeof this.value_,s=ct.VALUE_TYPE_ORDER.indexOf(t),o=ct.VALUE_TYPE_ORDER.indexOf(i);return ee(s>=0,"Unknown leaf type: "+t),ee(o>=0,"Unknown leaf type: "+i),s===o?i==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}else return!1}}ct.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let cc,uc;function _h(n){cc=n}function mh(n){uc=n}class gh extends os{compare(e,t){const i=e.node.getPriority(),s=t.node.getPriority(),o=i.compareTo(s);return o===0?Yn(e.name,t.name):o}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return ke.MIN}maxPost(){return new ke(on,new ct("[PRIORITY-POST]",uc))}makePost(e,t){const i=cc(e);return new ke(t,new ct("[PRIORITY-POST]",i))}toString(){return".priority"}}const et=new gh;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bh=Math.log(2);class vh{constructor(e){const t=o=>parseInt(Math.log(o)/bh,10),i=o=>parseInt(Array(o+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;const s=i(this.count);this.bits_=e+1&s}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const Gi=function(n,e,t,i){n.sort(e);const s=function(a,c){const u=c-a;let d,f;if(u===0)return null;if(u===1)return d=n[a],f=t?t(d):d,new ut(f,d.node,ut.BLACK,null,null);{const h=parseInt(u/2,10)+a,p=s(a,h),b=s(h+1,c);return d=n[h],f=t?t(d):d,new ut(f,d.node,ut.BLACK,p,b)}},o=function(a){let c=null,u=null,d=n.length;const f=function(p,b){const v=d-p,w=d;d-=p;const k=s(v+1,w),y=n[v],I=t?t(y):y;h(new ut(I,y.node,b,null,k))},h=function(p){c?(c.left=p,c=p):(u=p,c=p)};for(let p=0;p<a.count;++p){const b=a.nextBitIsOne(),v=Math.pow(2,a.count-(p+1));b?f(v,ut.BLACK):(f(v,ut.BLACK),f(v,ut.RED))}return u},r=new vh(n.length),l=o(r);return new kt(i||e,l)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ds;const Nn={};class Gt{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return ee(Nn&&et,"ChildrenNode.ts has not been loaded"),Ds=Ds||new Gt({".priority":Nn},{".priority":et}),Ds}get(e){const t=zn(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof kt?t:null}hasIndex(e){return Ut(this.indexSet_,e.toString())}addIndex(e,t){ee(e!==$t,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const i=[];let s=!1;const o=t.getIterator(ke.Wrap);let r=o.getNext();for(;r;)s=s||e.isDefinedOn(r.node),i.push(r),r=o.getNext();let l;s?l=Gi(i,e.getCompare()):l=Nn;const a=e.toString(),c=Object.assign({},this.indexSet_);c[a]=e;const u=Object.assign({},this.indexes_);return u[a]=l,new Gt(u,c)}addToIndexes(e,t){const i=zi(this.indexes_,(s,o)=>{const r=zn(this.indexSet_,o);if(ee(r,"Missing index implementation for "+o),s===Nn)if(r.isDefinedOn(e.node)){const l=[],a=t.getIterator(ke.Wrap);let c=a.getNext();for(;c;)c.name!==e.name&&l.push(c),c=a.getNext();return l.push(e),Gi(l,r.getCompare())}else return Nn;else{const l=t.get(e.name);let a=s;return l&&(a=a.remove(new ke(e.name,l))),a.insert(e,e.node)}});return new Gt(i,this.indexSet_)}removeFromIndexes(e,t){const i=zi(this.indexes_,s=>{if(s===Nn)return s;{const o=t.get(e.name);return o?s.remove(new ke(e.name,o)):s}});return new Gt(i,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ti;class he{constructor(e,t,i){this.children_=e,this.priorityNode_=t,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&ac(this.priorityNode_),this.children_.isEmpty()&&ee(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return ti||(ti=new he(new kt(yo),null,Gt.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||ti}updatePriority(e){return this.children_.isEmpty()?this:new he(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const t=this.children_.get(e);return t===null?ti:t}}getChild(e){const t=Ee(e);return t===null?this:this.getImmediateChild(t).getChild(Ye(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,t){if(ee(t,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(t);{const i=new ke(e,t);let s,o;t.isEmpty()?(s=this.children_.remove(e),o=this.indexMap_.removeFromIndexes(i,this.children_)):(s=this.children_.insert(e,t),o=this.indexMap_.addToIndexes(i,this.children_));const r=s.isEmpty()?ti:this.priorityNode_;return new he(s,r,o)}}updateChild(e,t){const i=Ee(e);if(i===null)return t;{ee(Ee(e)!==".priority"||rn(e)===1,".priority must be the last token in a path");const s=this.getImmediateChild(i).updateChild(Ye(e),t);return this.updateImmediateChild(i,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let i=0,s=0,o=!0;if(this.forEachChild(et,(r,l)=>{t[r]=l.val(e),i++,o&&he.INTEGER_REGEXP_.test(r)?s=Math.max(s,Number(r)):o=!1}),!e&&o&&s<2*i){const r=[];for(const l in t)r[l]=t[l];return r}else return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+lc(this.getPriority().val())+":"),this.forEachChild(et,(t,i)=>{const s=i.hash();s!==""&&(e+=":"+t+":"+s)}),this.lazyHash_=e===""?"":Ma(e)}return this.lazyHash_}getPredecessorChildName(e,t,i){const s=this.resolveIndex_(i);if(s){const o=s.getPredecessorKey(new ke(e,t));return o?o.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const i=t.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new ke(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const i=t.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new ke(t,this.children_.get(t)):null}forEachChild(e,t){const i=this.resolveIndex_(e);return i?i.inorderTraversal(s=>t(s.name,s.node)):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const i=this.resolveIndex_(t);if(i)return i.getIteratorFrom(e,s=>s);{const s=this.children_.getIteratorFrom(e.name,ke.Wrap);let o=s.peek();for(;o!=null&&t.compare(o,e)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const i=this.resolveIndex_(t);if(i)return i.getReverseIteratorFrom(e,s=>s);{const s=this.children_.getReverseIteratorFrom(e.name,ke.Wrap);let o=s.peek();for(;o!=null&&t.compare(o,e)>0;)s.getNext(),o=s.peek();return s}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Ei?-1:0}withIndex(e){if(e===$t||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new he(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===$t||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority()))if(this.children_.count()===t.children_.count()){const i=this.getIterator(et),s=t.getIterator(et);let o=i.getNext(),r=s.getNext();for(;o&&r;){if(o.name!==r.name||!o.node.equals(r.node))return!1;o=i.getNext(),r=s.getNext()}return o===null&&r===null}else return!1;else return!1}}resolveIndex_(e){return e===$t?null:this.indexMap_.get(e.toString())}}he.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class yh extends he{constructor(){super(new kt(yo),he.EMPTY_NODE,Gt.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return he.EMPTY_NODE}isEmpty(){return!1}}const Ei=new yh;Object.defineProperties(ke,{MIN:{value:new ke(yn,he.EMPTY_NODE)},MAX:{value:new ke(on,Ei)}});rc.__EMPTY_NODE=he.EMPTY_NODE;ct.__childrenNodeConstructor=he;ph(Ei);mh(Ei);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wh=!0;function dt(n,e=null){if(n===null)return he.EMPTY_NODE;if(typeof n=="object"&&".priority"in n&&(e=n[".priority"]),ee(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof n=="object"&&".value"in n&&n[".value"]!==null&&(n=n[".value"]),typeof n!="object"||".sv"in n){const t=n;return new ct(t,dt(e))}if(!(n instanceof Array)&&wh){const t=[];let i=!1;if(Et(n,(r,l)=>{if(r.substring(0,1)!=="."){const a=dt(l);a.isEmpty()||(i=i||!a.getPriority().isEmpty(),t.push(new ke(r,a)))}}),t.length===0)return he.EMPTY_NODE;const o=Gi(t,hh,r=>r.name,yo);if(i){const r=Gi(t,et.getCompare());return new he(o,dt(e),new Gt({".priority":r},{".priority":et}))}else return new he(o,dt(e),Gt.Default)}else{let t=he.EMPTY_NODE;return Et(n,(i,s)=>{if(Ut(n,i)&&i.substring(0,1)!=="."){const o=dt(s);(o.isLeafNode()||!o.isEmpty())&&(t=t.updateImmediateChild(i,o))}}),t.updatePriority(dt(e))}}_h(dt);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dc extends os{constructor(e){super(),this.indexPath_=e,ee(!Ce(e)&&Ee(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const i=this.extractChild(e.node),s=this.extractChild(t.node),o=i.compareTo(s);return o===0?Yn(e.name,t.name):o}makePost(e,t){const i=dt(e),s=he.EMPTY_NODE.updateChild(this.indexPath_,i);return new ke(t,s)}maxPost(){const e=he.EMPTY_NODE.updateChild(this.indexPath_,Ei);return new ke(on,e)}toString(){return nc(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kh extends os{compare(e,t){const i=e.node.compareTo(t.node);return i===0?Yn(e.name,t.name):i}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return ke.MIN}maxPost(){return ke.MAX}makePost(e,t){const i=dt(e);return new ke(t,i)}toString(){return".value"}}const fc=new kh;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hc(n){return{type:"value",snapshotNode:n}}function jn(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function hi(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function pi(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}function Ch(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wo{constructor(e){this.index_=e}updateChild(e,t,i,s,o,r){ee(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const l=e.getImmediateChild(t);return l.getChild(s).equals(i.getChild(s))&&l.isEmpty()===i.isEmpty()||(r!=null&&(i.isEmpty()?e.hasChild(t)?r.trackChildChange(hi(t,l)):ee(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):l.isEmpty()?r.trackChildChange(jn(t,i)):r.trackChildChange(pi(t,i,l))),e.isLeafNode()&&i.isEmpty())?e:e.updateImmediateChild(t,i).withIndex(this.index_)}updateFullNode(e,t,i){return i!=null&&(e.isLeafNode()||e.forEachChild(et,(s,o)=>{t.hasChild(s)||i.trackChildChange(hi(s,o))}),t.isLeafNode()||t.forEachChild(et,(s,o)=>{if(e.hasChild(s)){const r=e.getImmediateChild(s);r.equals(o)||i.trackChildChange(pi(s,o,r))}else i.trackChildChange(jn(s,o))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?he.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _i{constructor(e){this.indexedFilter_=new wo(e.getIndex()),this.index_=e.getIndex(),this.startPost_=_i.getStartPost_(e),this.endPost_=_i.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,i=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&i}updateChild(e,t,i,s,o,r){return this.matches(new ke(t,i))||(i=he.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,i,s,o,r)}updateFullNode(e,t,i){t.isLeafNode()&&(t=he.EMPTY_NODE);let s=t.withIndex(this.index_);s=s.updatePriority(he.EMPTY_NODE);const o=this;return t.forEachChild(et,(r,l)=>{o.matches(new ke(r,l))||(s=s.updateImmediateChild(r,he.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,s,i)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eh{constructor(e){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{const i=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?i<=0:i<0},this.withinEndPost=t=>{const i=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?i<=0:i<0},this.rangedFilter_=new _i(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,i,s,o,r){return this.rangedFilter_.matches(new ke(t,i))||(i=he.EMPTY_NODE),e.getImmediateChild(t).equals(i)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,i,s,o,r):this.fullLimitUpdateChild_(e,t,i,o,r)}updateFullNode(e,t,i){let s;if(t.isLeafNode()||t.isEmpty())s=he.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<t.numChildren()&&t.isIndexed(this.index_)){s=he.EMPTY_NODE.withIndex(this.index_);let o;this.reverse_?o=t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):o=t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let r=0;for(;o.hasNext()&&r<this.limit_;){const l=o.getNext();if(this.withinDirectionalStart(l))if(this.withinDirectionalEnd(l))s=s.updateImmediateChild(l.name,l.node),r++;else break;else continue}}else{s=t.withIndex(this.index_),s=s.updatePriority(he.EMPTY_NODE);let o;this.reverse_?o=s.getReverseIterator(this.index_):o=s.getIterator(this.index_);let r=0;for(;o.hasNext();){const l=o.getNext();r<this.limit_&&this.withinDirectionalStart(l)&&this.withinDirectionalEnd(l)?r++:s=s.updateImmediateChild(l.name,he.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,s,i)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,i,s,o){let r;if(this.reverse_){const d=this.index_.getCompare();r=(f,h)=>d(h,f)}else r=this.index_.getCompare();const l=e;ee(l.numChildren()===this.limit_,"");const a=new ke(t,i),c=this.reverse_?l.getFirstChild(this.index_):l.getLastChild(this.index_),u=this.rangedFilter_.matches(a);if(l.hasChild(t)){const d=l.getImmediateChild(t);let f=s.getChildAfterChild(this.index_,c,this.reverse_);for(;f!=null&&(f.name===t||l.hasChild(f.name));)f=s.getChildAfterChild(this.index_,f,this.reverse_);const h=f==null?1:r(f,a);if(u&&!i.isEmpty()&&h>=0)return o!=null&&o.trackChildChange(pi(t,i,d)),l.updateImmediateChild(t,i);{o!=null&&o.trackChildChange(hi(t,d));const b=l.updateImmediateChild(t,he.EMPTY_NODE);return f!=null&&this.rangedFilter_.matches(f)?(o!=null&&o.trackChildChange(jn(f.name,f.node)),b.updateImmediateChild(f.name,f.node)):b}}else return i.isEmpty()?e:u&&r(c,a)>=0?(o!=null&&(o.trackChildChange(hi(c.name,c.node)),o.trackChildChange(jn(t,i))),l.updateImmediateChild(t,i).updateImmediateChild(c.name,he.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ko{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=et}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return ee(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return ee(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:yn}hasEnd(){return this.endSet_}getIndexEndValue(){return ee(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return ee(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:on}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return ee(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===et}copy(){const e=new ko;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function Sh(n){return n.loadsAllData()?new wo(n.getIndex()):n.hasLimit()?new Eh(n):new _i(n)}function Ih(n,e){const t=n.copy();return t.index_=e,t}function Cr(n){const e={};if(n.isDefault())return e;let t;if(n.index_===et?t="$priority":n.index_===fc?t="$value":n.index_===$t?t="$key":(ee(n.index_ instanceof dc,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=ot(t),n.startSet_){const i=n.startAfterSet_?"startAfter":"startAt";e[i]=ot(n.indexStartValue_),n.startNameSet_&&(e[i]+=","+ot(n.indexStartName_))}if(n.endSet_){const i=n.endBeforeSet_?"endBefore":"endAt";e[i]=ot(n.indexEndValue_),n.endNameSet_&&(e[i]+=","+ot(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function Er(n){const e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;t===""&&(n.isViewFromLeft()?t="l":t="r"),e.vf=t}return n.index_!==et&&(e.i=n.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vi extends $a{constructor(e,t,i,s){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=i,this.appCheckTokenProvider_=s,this.log_=Ci("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:(ee(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,i,s){const o=e._path.toString();this.log_("Listen called for "+o+" "+e._queryIdentifier);const r=Vi.getListenId_(e,i),l={};this.listens_[r]=l;const a=Cr(e._queryParams);this.restRequest_(o+".json",a,(c,u)=>{let d=u;if(c===404&&(d=null,c=null),c===null&&this.onDataUpdate_(o,d,!1,i),zn(this.listens_,r)===l){let f;c?c===401?f="permission_denied":f="rest_error:"+c:f="ok",s(f,null)}})}unlisten(e,t){const i=Vi.getListenId_(e,t);delete this.listens_[i]}get(e){const t=Cr(e._queryParams),i=e._path.toString(),s=new is;return this.restRequest_(i+".json",t,(o,r)=>{let l=r;o===404&&(l=null,o=null),o===null?(this.onDataUpdate_(i,l,!1,null),s.resolve(l)):s.reject(new Error(l))}),s.promise}refreshAuthToken(e){}restRequest_(e,t={},i){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([s,o])=>{s&&s.accessToken&&(t.auth=s.accessToken),o&&o.token&&(t.ac=o.token);const r=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+nd(t);this.log_("Sending REST request for "+r);const l=new XMLHttpRequest;l.onreadystatechange=()=>{if(i&&l.readyState===4){this.log_("REST Response for "+r+" received. status:",l.status,"response:",l.responseText);let a=null;if(l.status>=200&&l.status<300){try{a=ci(l.responseText)}catch{Ct("Failed to parse JSON response for "+r+": "+l.responseText)}i(null,a)}else l.status!==401&&l.status!==404&&Ct("Got unsuccessful REST response for "+r+" Status: "+l.status),i(l.status);i=null}},l.open("GET",r,!0),l.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Th{constructor(){this.rootNode_=he.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ki(){return{value:null,children:new Map}}function pc(n,e,t){if(Ce(e))n.value=t,n.children.clear();else if(n.value!==null)n.value=n.value.updateChild(e,t);else{const i=Ee(e);n.children.has(i)||n.children.set(i,Ki());const s=n.children.get(i);e=Ye(e),pc(s,e,t)}}function Ys(n,e,t){n.value!==null?t(e,n.value):Nh(n,(i,s)=>{const o=new Ge(e.toString()+"/"+i);Ys(s,o,t)})}function Nh(n,e){n.children.forEach((t,i)=>{e(i,t)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oh{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&Et(this.last_,(i,s)=>{t[i]=t[i]-s}),this.last_=e,t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sr=10*1e3,Dh=30*1e3,Rh=5*60*1e3;class Ah{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new Oh(e);const i=Sr+(Dh-Sr)*Math.random();si(this.reportStats_.bind(this),Math.floor(i))}reportStats_(){const e=this.statsListener_.get(),t={};let i=!1;Et(e,(s,o)=>{o>0&&Ut(this.statsToReport_,s)&&(t[s]=o,i=!0)}),i&&this.server_.reportStats(t),si(this.reportStats_.bind(this),Math.floor(Math.random()*2*Rh))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var At;(function(n){n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(At||(At={}));function _c(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function Co(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function Eo(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yi{constructor(e,t,i){this.path=e,this.affectedTree=t,this.revert=i,this.type=At.ACK_USER_WRITE,this.source=_c()}operationForChild(e){if(Ce(this.path)){if(this.affectedTree.value!=null)return ee(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new Ge(e));return new Yi(Be(),t,this.revert)}}else return ee(Ee(this.path)===e,"operationForChild called for unrelated child."),new Yi(Ye(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mi{constructor(e,t){this.source=e,this.path=t,this.type=At.LISTEN_COMPLETE}operationForChild(e){return Ce(this.path)?new mi(this.source,Be()):new mi(this.source,Ye(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wn{constructor(e,t,i){this.source=e,this.path=t,this.snap=i,this.type=At.OVERWRITE}operationForChild(e){return Ce(this.path)?new wn(this.source,Be(),this.snap.getImmediateChild(e)):new wn(this.source,Ye(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gi{constructor(e,t,i){this.source=e,this.path=t,this.children=i,this.type=At.MERGE}operationForChild(e){if(Ce(this.path)){const t=this.children.subtree(new Ge(e));return t.isEmpty()?null:t.value?new wn(this.source,Be(),t.value):new gi(this.source,Be(),t)}else return ee(Ee(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new gi(this.source,Ye(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ln{constructor(e,t,i){this.node_=e,this.fullyInitialized_=t,this.filtered_=i}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(Ce(e))return this.isFullyInitialized()&&!this.filtered_;const t=Ee(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ph{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function Mh(n,e,t,i){const s=[],o=[];return e.forEach(r=>{r.type==="child_changed"&&n.index_.indexedValueChanged(r.oldSnap,r.snapshotNode)&&o.push(Ch(r.childName,r.snapshotNode))}),ni(n,s,"child_removed",e,i,t),ni(n,s,"child_added",e,i,t),ni(n,s,"child_moved",o,i,t),ni(n,s,"child_changed",e,i,t),ni(n,s,"value",e,i,t),s}function ni(n,e,t,i,s,o){const r=i.filter(l=>l.type===t);r.sort((l,a)=>Fh(n,l,a)),r.forEach(l=>{const a=Lh(n,l,o);s.forEach(c=>{c.respondsTo(l.type)&&e.push(c.createEvent(a,n.query_))})})}function Lh(n,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}function Fh(n,e,t){if(e.childName==null||t.childName==null)throw Kn("Should only compare child_ events.");const i=new ke(e.childName,e.snapshotNode),s=new ke(t.childName,t.snapshotNode);return n.index_.compare(i,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rs(n,e){return{eventCache:n,serverCache:e}}function oi(n,e,t,i){return rs(new ln(e,t,i),n.serverCache)}function mc(n,e,t,i){return rs(n.eventCache,new ln(e,t,i))}function Qi(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function kn(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Rs;const Bh=()=>(Rs||(Rs=new kt(Cf)),Rs);class Xe{constructor(e,t=Bh()){this.value=e,this.children=t}static fromObject(e){let t=new Xe(null);return Et(e,(i,s)=>{t=t.set(new Ge(i),s)}),t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:Be(),value:this.value};if(Ce(e))return null;{const i=Ee(e),s=this.children.get(i);if(s!==null){const o=s.findRootMostMatchingPathAndValue(Ye(e),t);return o!=null?{path:rt(new Ge(i),o.path),value:o.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(Ce(e))return this;{const t=Ee(e),i=this.children.get(t);return i!==null?i.subtree(Ye(e)):new Xe(null)}}set(e,t){if(Ce(e))return new Xe(t,this.children);{const i=Ee(e),o=(this.children.get(i)||new Xe(null)).set(Ye(e),t),r=this.children.insert(i,o);return new Xe(this.value,r)}}remove(e){if(Ce(e))return this.children.isEmpty()?new Xe(null):new Xe(null,this.children);{const t=Ee(e),i=this.children.get(t);if(i){const s=i.remove(Ye(e));let o;return s.isEmpty()?o=this.children.remove(t):o=this.children.insert(t,s),this.value===null&&o.isEmpty()?new Xe(null):new Xe(this.value,o)}else return this}}get(e){if(Ce(e))return this.value;{const t=Ee(e),i=this.children.get(t);return i?i.get(Ye(e)):null}}setTree(e,t){if(Ce(e))return t;{const i=Ee(e),o=(this.children.get(i)||new Xe(null)).setTree(Ye(e),t);let r;return o.isEmpty()?r=this.children.remove(i):r=this.children.insert(i,o),new Xe(this.value,r)}}fold(e){return this.fold_(Be(),e)}fold_(e,t){const i={};return this.children.inorderTraversal((s,o)=>{i[s]=o.fold_(rt(e,s),t)}),t(e,this.value,i)}findOnPath(e,t){return this.findOnPath_(e,Be(),t)}findOnPath_(e,t,i){const s=this.value?i(t,this.value):!1;if(s)return s;if(Ce(e))return null;{const o=Ee(e),r=this.children.get(o);return r?r.findOnPath_(Ye(e),rt(t,o),i):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,Be(),t)}foreachOnPath_(e,t,i){if(Ce(e))return this;{this.value&&i(t,this.value);const s=Ee(e),o=this.children.get(s);return o?o.foreachOnPath_(Ye(e),rt(t,s),i):new Xe(null)}}foreach(e){this.foreach_(Be(),e)}foreach_(e,t){this.children.inorderTraversal((i,s)=>{s.foreach_(rt(e,i),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,i)=>{i.value&&e(t,i.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pt{constructor(e){this.writeTree_=e}static empty(){return new Pt(new Xe(null))}}function ri(n,e,t){if(Ce(e))return new Pt(new Xe(t));{const i=n.writeTree_.findRootMostValueAndPath(e);if(i!=null){const s=i.path;let o=i.value;const r=bt(s,e);return o=o.updateChild(r,t),new Pt(n.writeTree_.set(s,o))}else{const s=new Xe(t),o=n.writeTree_.setTree(e,s);return new Pt(o)}}}function Ir(n,e,t){let i=n;return Et(t,(s,o)=>{i=ri(i,rt(e,s),o)}),i}function Tr(n,e){if(Ce(e))return Pt.empty();{const t=n.writeTree_.setTree(e,new Xe(null));return new Pt(t)}}function Qs(n,e){return En(n,e)!=null}function En(n,e){const t=n.writeTree_.findRootMostValueAndPath(e);return t!=null?n.writeTree_.get(t.path).getChild(bt(t.path,e)):null}function Nr(n){const e=[],t=n.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(et,(i,s)=>{e.push(new ke(i,s))}):n.writeTree_.children.inorderTraversal((i,s)=>{s.value!=null&&e.push(new ke(i,s.value))}),e}function en(n,e){if(Ce(e))return n;{const t=En(n,e);return t!=null?new Pt(new Xe(t)):new Pt(n.writeTree_.subtree(e))}}function Xs(n){return n.writeTree_.isEmpty()}function Wn(n,e){return gc(Be(),n.writeTree_,e)}function gc(n,e,t){if(e.value!=null)return t.updateChild(n,e.value);{let i=null;return e.children.inorderTraversal((s,o)=>{s===".priority"?(ee(o.value!==null,"Priority writes must always be leaf nodes"),i=o.value):t=gc(rt(n,s),o,t)}),!t.getChild(n).isEmpty()&&i!==null&&(t=t.updateChild(rt(n,".priority"),i)),t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ls(n,e){return wc(e,n)}function qh(n,e,t,i,s){ee(i>n.lastWriteId,"Stacking an older write on top of newer ones"),s===void 0&&(s=!0),n.allWrites.push({path:e,snap:t,writeId:i,visible:s}),s&&(n.visibleWrites=ri(n.visibleWrites,e,t)),n.lastWriteId=i}function zh(n,e){for(let t=0;t<n.allWrites.length;t++){const i=n.allWrites[t];if(i.writeId===e)return i}return null}function jh(n,e){const t=n.allWrites.findIndex(l=>l.writeId===e);ee(t>=0,"removeWrite called with nonexistent writeId.");const i=n.allWrites[t];n.allWrites.splice(t,1);let s=i.visible,o=!1,r=n.allWrites.length-1;for(;s&&r>=0;){const l=n.allWrites[r];l.visible&&(r>=t&&Wh(l,i.path)?s=!1:Rt(i.path,l.path)&&(o=!0)),r--}if(s){if(o)return Hh(n),!0;if(i.snap)n.visibleWrites=Tr(n.visibleWrites,i.path);else{const l=i.children;Et(l,a=>{n.visibleWrites=Tr(n.visibleWrites,rt(i.path,a))})}return!0}else return!1}function Wh(n,e){if(n.snap)return Rt(n.path,e);for(const t in n.children)if(n.children.hasOwnProperty(t)&&Rt(rt(n.path,t),e))return!0;return!1}function Hh(n){n.visibleWrites=bc(n.allWrites,Uh,Be()),n.allWrites.length>0?n.lastWriteId=n.allWrites[n.allWrites.length-1].writeId:n.lastWriteId=-1}function Uh(n){return n.visible}function bc(n,e,t){let i=Pt.empty();for(let s=0;s<n.length;++s){const o=n[s];if(e(o)){const r=o.path;let l;if(o.snap)Rt(t,r)?(l=bt(t,r),i=ri(i,l,o.snap)):Rt(r,t)&&(l=bt(r,t),i=ri(i,Be(),o.snap.getChild(l)));else if(o.children){if(Rt(t,r))l=bt(t,r),i=Ir(i,l,o.children);else if(Rt(r,t))if(l=bt(r,t),Ce(l))i=Ir(i,Be(),o.children);else{const a=zn(o.children,Ee(l));if(a){const c=a.getChild(Ye(l));i=ri(i,Be(),c)}}}else throw Kn("WriteRecord should have .snap or .children")}}return i}function vc(n,e,t,i,s){if(!i&&!s){const o=En(n.visibleWrites,e);if(o!=null)return o;{const r=en(n.visibleWrites,e);if(Xs(r))return t;if(t==null&&!Qs(r,Be()))return null;{const l=t||he.EMPTY_NODE;return Wn(r,l)}}}else{const o=en(n.visibleWrites,e);if(!s&&Xs(o))return t;if(!s&&t==null&&!Qs(o,Be()))return null;{const r=function(c){return(c.visible||s)&&(!i||!~i.indexOf(c.writeId))&&(Rt(c.path,e)||Rt(e,c.path))},l=bc(n.allWrites,r,e),a=t||he.EMPTY_NODE;return Wn(l,a)}}}function Gh(n,e,t){let i=he.EMPTY_NODE;const s=En(n.visibleWrites,e);if(s)return s.isLeafNode()||s.forEachChild(et,(o,r)=>{i=i.updateImmediateChild(o,r)}),i;if(t){const o=en(n.visibleWrites,e);return t.forEachChild(et,(r,l)=>{const a=Wn(en(o,new Ge(r)),l);i=i.updateImmediateChild(r,a)}),Nr(o).forEach(r=>{i=i.updateImmediateChild(r.name,r.node)}),i}else{const o=en(n.visibleWrites,e);return Nr(o).forEach(r=>{i=i.updateImmediateChild(r.name,r.node)}),i}}function Vh(n,e,t,i,s){ee(i||s,"Either existingEventSnap or existingServerSnap must exist");const o=rt(e,t);if(Qs(n.visibleWrites,o))return null;{const r=en(n.visibleWrites,o);return Xs(r)?s.getChild(t):Wn(r,s.getChild(t))}}function Kh(n,e,t,i){const s=rt(e,t),o=En(n.visibleWrites,s);if(o!=null)return o;if(i.isCompleteForChild(t)){const r=en(n.visibleWrites,s);return Wn(r,i.getNode().getImmediateChild(t))}else return null}function Yh(n,e){return En(n.visibleWrites,e)}function Qh(n,e,t,i,s,o,r){let l;const a=en(n.visibleWrites,e),c=En(a,Be());if(c!=null)l=c;else if(t!=null)l=Wn(a,t);else return[];if(l=l.withIndex(r),!l.isEmpty()&&!l.isLeafNode()){const u=[],d=r.getCompare(),f=o?l.getReverseIteratorFrom(i,r):l.getIteratorFrom(i,r);let h=f.getNext();for(;h&&u.length<s;)d(h,i)!==0&&u.push(h),h=f.getNext();return u}else return[]}function Xh(){return{visibleWrites:Pt.empty(),allWrites:[],lastWriteId:-1}}function Xi(n,e,t,i){return vc(n.writeTree,n.treePath,e,t,i)}function So(n,e){return Gh(n.writeTree,n.treePath,e)}function Or(n,e,t,i){return Vh(n.writeTree,n.treePath,e,t,i)}function Ji(n,e){return Yh(n.writeTree,rt(n.treePath,e))}function Jh(n,e,t,i,s,o){return Qh(n.writeTree,n.treePath,e,t,i,s,o)}function Io(n,e,t){return Kh(n.writeTree,n.treePath,e,t)}function yc(n,e){return wc(rt(n.treePath,e),n.writeTree)}function wc(n,e){return{treePath:n,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zh{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,i=e.childName;ee(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),ee(i!==".priority","Only non-priority child changes can be tracked.");const s=this.changeMap.get(i);if(s){const o=s.type;if(t==="child_added"&&o==="child_removed")this.changeMap.set(i,pi(i,e.snapshotNode,s.snapshotNode));else if(t==="child_removed"&&o==="child_added")this.changeMap.delete(i);else if(t==="child_removed"&&o==="child_changed")this.changeMap.set(i,hi(i,s.oldSnap));else if(t==="child_changed"&&o==="child_added")this.changeMap.set(i,jn(i,e.snapshotNode));else if(t==="child_changed"&&o==="child_changed")this.changeMap.set(i,pi(i,e.snapshotNode,s.oldSnap));else throw Kn("Illegal combination of changes: "+e+" occurred after "+s)}else this.changeMap.set(i,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xh{getCompleteChild(e){return null}getChildAfterChild(e,t,i){return null}}const kc=new xh;class To{constructor(e,t,i=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=i}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const i=this.optCompleteServerCache_!=null?new ln(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Io(this.writes_,e,i)}}getChildAfterChild(e,t,i){const s=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:kn(this.viewCache_),o=Jh(this.writes_,s,t,1,i,e);return o.length===0?null:o[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $h(n){return{filter:n}}function ep(n,e){ee(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),ee(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}function tp(n,e,t,i,s){const o=new Zh;let r,l;if(t.type===At.OVERWRITE){const c=t;c.source.fromUser?r=Js(n,e,c.path,c.snap,i,s,o):(ee(c.source.fromServer,"Unknown source."),l=c.source.tagged||e.serverCache.isFiltered()&&!Ce(c.path),r=Zi(n,e,c.path,c.snap,i,s,l,o))}else if(t.type===At.MERGE){const c=t;c.source.fromUser?r=ip(n,e,c.path,c.children,i,s,o):(ee(c.source.fromServer,"Unknown source."),l=c.source.tagged||e.serverCache.isFiltered(),r=Zs(n,e,c.path,c.children,i,s,l,o))}else if(t.type===At.ACK_USER_WRITE){const c=t;c.revert?r=rp(n,e,c.path,i,s,o):r=sp(n,e,c.path,c.affectedTree,i,s,o)}else if(t.type===At.LISTEN_COMPLETE)r=op(n,e,t.path,i,o);else throw Kn("Unknown operation type: "+t.type);const a=o.getChanges();return np(e,r,a),{viewCache:r,changes:a}}function np(n,e,t){const i=e.eventCache;if(i.isFullyInitialized()){const s=i.getNode().isLeafNode()||i.getNode().isEmpty(),o=Qi(n);(t.length>0||!n.eventCache.isFullyInitialized()||s&&!i.getNode().equals(o)||!i.getNode().getPriority().equals(o.getPriority()))&&t.push(hc(Qi(e)))}}function Cc(n,e,t,i,s,o){const r=e.eventCache;if(Ji(i,t)!=null)return e;{let l,a;if(Ce(t))if(ee(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const c=kn(e),u=c instanceof he?c:he.EMPTY_NODE,d=So(i,u);l=n.filter.updateFullNode(e.eventCache.getNode(),d,o)}else{const c=Xi(i,kn(e));l=n.filter.updateFullNode(e.eventCache.getNode(),c,o)}else{const c=Ee(t);if(c===".priority"){ee(rn(t)===1,"Can't have a priority with additional path components");const u=r.getNode();a=e.serverCache.getNode();const d=Or(i,t,u,a);d!=null?l=n.filter.updatePriority(u,d):l=r.getNode()}else{const u=Ye(t);let d;if(r.isCompleteForChild(c)){a=e.serverCache.getNode();const f=Or(i,t,r.getNode(),a);f!=null?d=r.getNode().getImmediateChild(c).updateChild(u,f):d=r.getNode().getImmediateChild(c)}else d=Io(i,c,e.serverCache);d!=null?l=n.filter.updateChild(r.getNode(),c,d,u,s,o):l=r.getNode()}}return oi(e,l,r.isFullyInitialized()||Ce(t),n.filter.filtersNodes())}}function Zi(n,e,t,i,s,o,r,l){const a=e.serverCache;let c;const u=r?n.filter:n.filter.getIndexedFilter();if(Ce(t))c=u.updateFullNode(a.getNode(),i,null);else if(u.filtersNodes()&&!a.isFiltered()){const h=a.getNode().updateChild(t,i);c=u.updateFullNode(a.getNode(),h,null)}else{const h=Ee(t);if(!a.isCompleteForPath(t)&&rn(t)>1)return e;const p=Ye(t),v=a.getNode().getImmediateChild(h).updateChild(p,i);h===".priority"?c=u.updatePriority(a.getNode(),v):c=u.updateChild(a.getNode(),h,v,p,kc,null)}const d=mc(e,c,a.isFullyInitialized()||Ce(t),u.filtersNodes()),f=new To(s,d,o);return Cc(n,d,t,s,f,l)}function Js(n,e,t,i,s,o,r){const l=e.eventCache;let a,c;const u=new To(s,e,o);if(Ce(t))c=n.filter.updateFullNode(e.eventCache.getNode(),i,r),a=oi(e,c,!0,n.filter.filtersNodes());else{const d=Ee(t);if(d===".priority")c=n.filter.updatePriority(e.eventCache.getNode(),i),a=oi(e,c,l.isFullyInitialized(),l.isFiltered());else{const f=Ye(t),h=l.getNode().getImmediateChild(d);let p;if(Ce(f))p=i;else{const b=u.getCompleteChild(d);b!=null?tc(f)===".priority"&&b.getChild(ic(f)).isEmpty()?p=b:p=b.updateChild(f,i):p=he.EMPTY_NODE}if(h.equals(p))a=e;else{const b=n.filter.updateChild(l.getNode(),d,p,f,u,r);a=oi(e,b,l.isFullyInitialized(),n.filter.filtersNodes())}}}return a}function Dr(n,e){return n.eventCache.isCompleteForChild(e)}function ip(n,e,t,i,s,o,r){let l=e;return i.foreach((a,c)=>{const u=rt(t,a);Dr(e,Ee(u))&&(l=Js(n,l,u,c,s,o,r))}),i.foreach((a,c)=>{const u=rt(t,a);Dr(e,Ee(u))||(l=Js(n,l,u,c,s,o,r))}),l}function Rr(n,e,t){return t.foreach((i,s)=>{e=e.updateChild(i,s)}),e}function Zs(n,e,t,i,s,o,r,l){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let a=e,c;Ce(t)?c=i:c=new Xe(null).setTree(t,i);const u=e.serverCache.getNode();return c.children.inorderTraversal((d,f)=>{if(u.hasChild(d)){const h=e.serverCache.getNode().getImmediateChild(d),p=Rr(n,h,f);a=Zi(n,a,new Ge(d),p,s,o,r,l)}}),c.children.inorderTraversal((d,f)=>{const h=!e.serverCache.isCompleteForChild(d)&&f.value===null;if(!u.hasChild(d)&&!h){const p=e.serverCache.getNode().getImmediateChild(d),b=Rr(n,p,f);a=Zi(n,a,new Ge(d),b,s,o,r,l)}}),a}function sp(n,e,t,i,s,o,r){if(Ji(s,t)!=null)return e;const l=e.serverCache.isFiltered(),a=e.serverCache;if(i.value!=null){if(Ce(t)&&a.isFullyInitialized()||a.isCompleteForPath(t))return Zi(n,e,t,a.getNode().getChild(t),s,o,l,r);if(Ce(t)){let c=new Xe(null);return a.getNode().forEachChild($t,(u,d)=>{c=c.set(new Ge(u),d)}),Zs(n,e,t,c,s,o,l,r)}else return e}else{let c=new Xe(null);return i.foreach((u,d)=>{const f=rt(t,u);a.isCompleteForPath(f)&&(c=c.set(u,a.getNode().getChild(f)))}),Zs(n,e,t,c,s,o,l,r)}}function op(n,e,t,i,s){const o=e.serverCache,r=mc(e,o.getNode(),o.isFullyInitialized()||Ce(t),o.isFiltered());return Cc(n,r,t,i,kc,s)}function rp(n,e,t,i,s,o){let r;if(Ji(i,t)!=null)return e;{const l=new To(i,e,s),a=e.eventCache.getNode();let c;if(Ce(t)||Ee(t)===".priority"){let u;if(e.serverCache.isFullyInitialized())u=Xi(i,kn(e));else{const d=e.serverCache.getNode();ee(d instanceof he,"serverChildren would be complete if leaf node"),u=So(i,d)}u=u,c=n.filter.updateFullNode(a,u,o)}else{const u=Ee(t);let d=Io(i,u,e.serverCache);d==null&&e.serverCache.isCompleteForChild(u)&&(d=a.getImmediateChild(u)),d!=null?c=n.filter.updateChild(a,u,d,Ye(t),l,o):e.eventCache.getNode().hasChild(u)?c=n.filter.updateChild(a,u,he.EMPTY_NODE,Ye(t),l,o):c=a,c.isEmpty()&&e.serverCache.isFullyInitialized()&&(r=Xi(i,kn(e)),r.isLeafNode()&&(c=n.filter.updateFullNode(c,r,o)))}return r=e.serverCache.isFullyInitialized()||Ji(i,Be())!=null,oi(e,c,r,n.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lp{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const i=this.query_._queryParams,s=new wo(i.getIndex()),o=Sh(i);this.processor_=$h(o);const r=t.serverCache,l=t.eventCache,a=s.updateFullNode(he.EMPTY_NODE,r.getNode(),null),c=o.updateFullNode(he.EMPTY_NODE,l.getNode(),null),u=new ln(a,r.isFullyInitialized(),s.filtersNodes()),d=new ln(c,l.isFullyInitialized(),o.filtersNodes());this.viewCache_=rs(d,u),this.eventGenerator_=new Ph(this.query_)}get query(){return this.query_}}function ap(n){return n.viewCache_.serverCache.getNode()}function cp(n){return Qi(n.viewCache_)}function up(n,e){const t=kn(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!Ce(e)&&!t.getImmediateChild(Ee(e)).isEmpty())?t.getChild(e):null}function Ar(n){return n.eventRegistrations_.length===0}function dp(n,e){n.eventRegistrations_.push(e)}function Pr(n,e,t){const i=[];if(t){ee(e==null,"A cancel should cancel all event registrations.");const s=n.query._path;n.eventRegistrations_.forEach(o=>{const r=o.createCancelEvent(t,s);r&&i.push(r)})}if(e){let s=[];for(let o=0;o<n.eventRegistrations_.length;++o){const r=n.eventRegistrations_[o];if(!r.matches(e))s.push(r);else if(e.hasAnyCallback()){s=s.concat(n.eventRegistrations_.slice(o+1));break}}n.eventRegistrations_=s}else n.eventRegistrations_=[];return i}function Mr(n,e,t,i){e.type===At.MERGE&&e.source.queryId!==null&&(ee(kn(n.viewCache_),"We should always have a full cache before handling merges"),ee(Qi(n.viewCache_),"Missing event cache, even though we have a server cache"));const s=n.viewCache_,o=tp(n.processor_,s,e,t,i);return ep(n.processor_,o.viewCache),ee(o.viewCache.serverCache.isFullyInitialized()||!s.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=o.viewCache,Ec(n,o.changes,o.viewCache.eventCache.getNode(),null)}function fp(n,e){const t=n.viewCache_.eventCache,i=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(et,(o,r)=>{i.push(jn(o,r))}),t.isFullyInitialized()&&i.push(hc(t.getNode())),Ec(n,i,t.getNode(),e)}function Ec(n,e,t,i){const s=i?[i]:n.eventRegistrations_;return Mh(n.eventGenerator_,e,t,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xi;class Sc{constructor(){this.views=new Map}}function hp(n){ee(!xi,"__referenceConstructor has already been defined"),xi=n}function pp(){return ee(xi,"Reference.ts has not been loaded"),xi}function _p(n){return n.views.size===0}function No(n,e,t,i){const s=e.source.queryId;if(s!==null){const o=n.views.get(s);return ee(o!=null,"SyncTree gave us an op for an invalid query."),Mr(o,e,t,i)}else{let o=[];for(const r of n.views.values())o=o.concat(Mr(r,e,t,i));return o}}function Ic(n,e,t,i,s){const o=e._queryIdentifier,r=n.views.get(o);if(!r){let l=Xi(t,s?i:null),a=!1;l?a=!0:i instanceof he?(l=So(t,i),a=!1):(l=he.EMPTY_NODE,a=!1);const c=rs(new ln(l,a,!1),new ln(i,s,!1));return new lp(e,c)}return r}function mp(n,e,t,i,s,o){const r=Ic(n,e,i,s,o);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,r),dp(r,t),fp(r,t)}function gp(n,e,t,i){const s=e._queryIdentifier,o=[];let r=[];const l=an(n);if(s==="default")for(const[a,c]of n.views.entries())r=r.concat(Pr(c,t,i)),Ar(c)&&(n.views.delete(a),c.query._queryParams.loadsAllData()||o.push(c.query));else{const a=n.views.get(s);a&&(r=r.concat(Pr(a,t,i)),Ar(a)&&(n.views.delete(s),a.query._queryParams.loadsAllData()||o.push(a.query)))}return l&&!an(n)&&o.push(new(pp())(e._repo,e._path)),{removed:o,events:r}}function Tc(n){const e=[];for(const t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function tn(n,e){let t=null;for(const i of n.views.values())t=t||up(i,e);return t}function Nc(n,e){if(e._queryParams.loadsAllData())return as(n);{const i=e._queryIdentifier;return n.views.get(i)}}function Oc(n,e){return Nc(n,e)!=null}function an(n){return as(n)!=null}function as(n){for(const e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let $i;function bp(n){ee(!$i,"__referenceConstructor has already been defined"),$i=n}function vp(){return ee($i,"Reference.ts has not been loaded"),$i}let yp=1;class Lr{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Xe(null),this.pendingWriteTree_=Xh(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function Dc(n,e,t,i,s){return qh(n.pendingWriteTree_,e,t,i,s),s?Ii(n,new wn(_c(),e,t)):[]}function _n(n,e,t=!1){const i=zh(n.pendingWriteTree_,e);if(jh(n.pendingWriteTree_,e)){let o=new Xe(null);return i.snap!=null?o=o.set(Be(),!0):Et(i.children,r=>{o=o.set(new Ge(r),!0)}),Ii(n,new Yi(i.path,o,t))}else return[]}function Si(n,e,t){return Ii(n,new wn(Co(),e,t))}function wp(n,e,t){const i=Xe.fromObject(t);return Ii(n,new gi(Co(),e,i))}function kp(n,e){return Ii(n,new mi(Co(),e))}function Cp(n,e,t){const i=Do(n,t);if(i){const s=Ro(i),o=s.path,r=s.queryId,l=bt(o,e),a=new mi(Eo(r),l);return Ao(n,o,a)}else return[]}function Rc(n,e,t,i,s=!1){const o=e._path,r=n.syncPointTree_.get(o);let l=[];if(r&&(e._queryIdentifier==="default"||Oc(r,e))){const a=gp(r,e,t,i);_p(r)&&(n.syncPointTree_=n.syncPointTree_.remove(o));const c=a.removed;if(l=a.events,!s){const u=c.findIndex(f=>f._queryParams.loadsAllData())!==-1,d=n.syncPointTree_.findOnPath(o,(f,h)=>an(h));if(u&&!d){const f=n.syncPointTree_.subtree(o);if(!f.isEmpty()){const h=Tp(f);for(let p=0;p<h.length;++p){const b=h[p],v=b.query,w=Lc(n,b);n.listenProvider_.startListening(li(v),bi(n,v),w.hashFn,w.onComplete)}}}!d&&c.length>0&&!i&&(u?n.listenProvider_.stopListening(li(e),null):c.forEach(f=>{const h=n.queryToTagMap.get(cs(f));n.listenProvider_.stopListening(li(f),h)}))}Np(n,c)}return l}function Ac(n,e,t,i){const s=Do(n,i);if(s!=null){const o=Ro(s),r=o.path,l=o.queryId,a=bt(r,e),c=new wn(Eo(l),a,t);return Ao(n,r,c)}else return[]}function Ep(n,e,t,i){const s=Do(n,i);if(s){const o=Ro(s),r=o.path,l=o.queryId,a=bt(r,e),c=Xe.fromObject(t),u=new gi(Eo(l),a,c);return Ao(n,r,u)}else return[]}function Sp(n,e,t,i=!1){const s=e._path;let o=null,r=!1;n.syncPointTree_.foreachOnPath(s,(f,h)=>{const p=bt(f,s);o=o||tn(h,p),r=r||an(h)});let l=n.syncPointTree_.get(s);l?(r=r||an(l),o=o||tn(l,Be())):(l=new Sc,n.syncPointTree_=n.syncPointTree_.set(s,l));let a;o!=null?a=!0:(a=!1,o=he.EMPTY_NODE,n.syncPointTree_.subtree(s).foreachChild((h,p)=>{const b=tn(p,Be());b&&(o=o.updateImmediateChild(h,b))}));const c=Oc(l,e);if(!c&&!e._queryParams.loadsAllData()){const f=cs(e);ee(!n.queryToTagMap.has(f),"View does not exist, but we have a tag");const h=Op();n.queryToTagMap.set(f,h),n.tagToQueryMap.set(h,f)}const u=ls(n.pendingWriteTree_,s);let d=mp(l,e,t,u,o,a);if(!c&&!r&&!i){const f=Nc(l,e);d=d.concat(Dp(n,e,f))}return d}function Oo(n,e,t){const s=n.pendingWriteTree_,o=n.syncPointTree_.findOnPath(e,(r,l)=>{const a=bt(r,e),c=tn(l,a);if(c)return c});return vc(s,e,o,t,!0)}function Ip(n,e){const t=e._path;let i=null;n.syncPointTree_.foreachOnPath(t,(c,u)=>{const d=bt(c,t);i=i||tn(u,d)});let s=n.syncPointTree_.get(t);s?i=i||tn(s,Be()):(s=new Sc,n.syncPointTree_=n.syncPointTree_.set(t,s));const o=i!=null,r=o?new ln(i,!0,!1):null,l=ls(n.pendingWriteTree_,e._path),a=Ic(s,e,l,o?r.getNode():he.EMPTY_NODE,o);return cp(a)}function Ii(n,e){return Pc(e,n.syncPointTree_,null,ls(n.pendingWriteTree_,Be()))}function Pc(n,e,t,i){if(Ce(n.path))return Mc(n,e,t,i);{const s=e.get(Be());t==null&&s!=null&&(t=tn(s,Be()));let o=[];const r=Ee(n.path),l=n.operationForChild(r),a=e.children.get(r);if(a&&l){const c=t?t.getImmediateChild(r):null,u=yc(i,r);o=o.concat(Pc(l,a,c,u))}return s&&(o=o.concat(No(s,n,i,t))),o}}function Mc(n,e,t,i){const s=e.get(Be());t==null&&s!=null&&(t=tn(s,Be()));let o=[];return e.children.inorderTraversal((r,l)=>{const a=t?t.getImmediateChild(r):null,c=yc(i,r),u=n.operationForChild(r);u&&(o=o.concat(Mc(u,l,a,c)))}),s&&(o=o.concat(No(s,n,i,t))),o}function Lc(n,e){const t=e.query,i=bi(n,t);return{hashFn:()=>(ap(e)||he.EMPTY_NODE).hash(),onComplete:s=>{if(s==="ok")return i?Cp(n,t._path,i):kp(n,t._path);{const o=If(s,t);return Rc(n,t,null,o)}}}}function bi(n,e){const t=cs(e);return n.queryToTagMap.get(t)}function cs(n){return n._path.toString()+"$"+n._queryIdentifier}function Do(n,e){return n.tagToQueryMap.get(e)}function Ro(n){const e=n.indexOf("$");return ee(e!==-1&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new Ge(n.substr(0,e))}}function Ao(n,e,t){const i=n.syncPointTree_.get(e);ee(i,"Missing sync point for query tag that we're tracking");const s=ls(n.pendingWriteTree_,e);return No(i,t,s,null)}function Tp(n){return n.fold((e,t,i)=>{if(t&&an(t))return[as(t)];{let s=[];return t&&(s=Tc(t)),Et(i,(o,r)=>{s=s.concat(r)}),s}})}function li(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(vp())(n._repo,n._path):n}function Np(n,e){for(let t=0;t<e.length;++t){const i=e[t];if(!i._queryParams.loadsAllData()){const s=cs(i),o=n.queryToTagMap.get(s);n.queryToTagMap.delete(s),n.tagToQueryMap.delete(o)}}}function Op(){return yp++}function Dp(n,e,t){const i=e._path,s=bi(n,e),o=Lc(n,t),r=n.listenProvider_.startListening(li(e),s,o.hashFn,o.onComplete),l=n.syncPointTree_.subtree(i);if(s)ee(!an(l.value),"If we're adding a query, it shouldn't be shadowed");else{const a=l.fold((c,u,d)=>{if(!Ce(c)&&u&&an(u))return[as(u).query];{let f=[];return u&&(f=f.concat(Tc(u).map(h=>h.query))),Et(d,(h,p)=>{f=f.concat(p)}),f}});for(let c=0;c<a.length;++c){const u=a[c];n.listenProvider_.stopListening(li(u),bi(n,u))}}return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Po{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new Po(t)}node(){return this.node_}}class Mo{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=rt(this.path_,e);return new Mo(this.syncTree_,t)}node(){return Oo(this.syncTree_,this.path_)}}const Rp=function(n){return n=n||{},n.timestamp=n.timestamp||new Date().getTime(),n},Fr=function(n,e,t){if(!n||typeof n!="object")return n;if(ee(".sv"in n,"Unexpected leaf node or priority contents"),typeof n[".sv"]=="string")return Ap(n[".sv"],e,t);if(typeof n[".sv"]=="object")return Pp(n[".sv"],e);ee(!1,"Unexpected server value: "+JSON.stringify(n,null,2))},Ap=function(n,e,t){switch(n){case"timestamp":return t.timestamp;default:ee(!1,"Unexpected server value: "+n)}},Pp=function(n,e,t){n.hasOwnProperty("increment")||ee(!1,"Unexpected server value: "+JSON.stringify(n,null,2));const i=n.increment;typeof i!="number"&&ee(!1,"Unexpected increment value: "+i);const s=e.node();if(ee(s!==null&&typeof s<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!s.isLeafNode())return i;const r=s.getValue();return typeof r!="number"?i:r+i},Mp=function(n,e,t,i){return Lo(e,new Mo(t,n),i)},Fc=function(n,e,t){return Lo(n,new Po(e),t)};function Lo(n,e,t){const i=n.getPriority().val(),s=Fr(i,e.getImmediateChild(".priority"),t);let o;if(n.isLeafNode()){const r=n,l=Fr(r.getValue(),e,t);return l!==r.getValue()||s!==r.getPriority().val()?new ct(l,dt(s)):n}else{const r=n;return o=r,s!==r.getPriority().val()&&(o=o.updatePriority(new ct(s))),r.forEachChild(et,(l,a)=>{const c=Lo(a,e.getImmediateChild(l),t);c!==a&&(o=o.updateImmediateChild(l,c))}),o}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fo{constructor(e="",t=null,i={children:{},childCount:0}){this.name=e,this.parent=t,this.node=i}}function Bo(n,e){let t=e instanceof Ge?e:new Ge(e),i=n,s=Ee(t);for(;s!==null;){const o=zn(i.node.children,s)||{children:{},childCount:0};i=new Fo(s,i,o),t=Ye(t),s=Ee(t)}return i}function Xn(n){return n.node.value}function Bc(n,e){n.node.value=e,xs(n)}function qc(n){return n.node.childCount>0}function Lp(n){return Xn(n)===void 0&&!qc(n)}function us(n,e){Et(n.node.children,(t,i)=>{e(new Fo(t,n,i))})}function zc(n,e,t,i){t&&!i&&e(n),us(n,s=>{zc(s,e,!0,i)}),t&&i&&e(n)}function Fp(n,e,t){let i=t?n:n.parent;for(;i!==null;){if(e(i))return!0;i=i.parent}return!1}function Ti(n){return new Ge(n.parent===null?n.name:Ti(n.parent)+"/"+n.name)}function xs(n){n.parent!==null&&Bp(n.parent,n.name,n)}function Bp(n,e,t){const i=Lp(t),s=Ut(n.node.children,e);i&&s?(delete n.node.children[e],n.node.childCount--,xs(n)):!i&&!s&&(n.node.children[e]=t.node,n.node.childCount++,xs(n))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qp=/[\[\].#$\/\u0000-\u001F\u007F]/,zp=/[\[\].#$\u0000-\u001F\u007F]/,As=10*1024*1024,jc=function(n){return typeof n=="string"&&n.length!==0&&!qp.test(n)},Wc=function(n){return typeof n=="string"&&n.length!==0&&!zp.test(n)},jp=function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Wc(n)},Br=function(n){return n===null||typeof n=="string"||typeof n=="number"&&!po(n)||n&&typeof n=="object"&&Ut(n,".sv")},Hc=function(n,e,t,i){i&&e===void 0||qo(fo(n,"value"),e,t)},qo=function(n,e,t){const i=t instanceof Ge?new oh(t,n):t;if(e===void 0)throw new Error(n+"contains undefined "+fn(i));if(typeof e=="function")throw new Error(n+"contains a function "+fn(i)+" with contents = "+e.toString());if(po(e))throw new Error(n+"contains "+e.toString()+" "+fn(i));if(typeof e=="string"&&e.length>As/3&&ss(e)>As)throw new Error(n+"contains a string greater than "+As+" utf8 bytes "+fn(i)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let s=!1,o=!1;if(Et(e,(r,l)=>{if(r===".value")s=!0;else if(r!==".priority"&&r!==".sv"&&(o=!0,!jc(r)))throw new Error(n+" contains an invalid key ("+r+") "+fn(i)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);rh(i,r),qo(n,l,i),lh(i)}),s&&o)throw new Error(n+' contains ".value" child '+fn(i)+" in addition to actual children.")}},Uc=function(n,e,t,i){if(!(i&&t===void 0)&&!Wc(t))throw new Error(fo(n,e)+'was an invalid path = "'+t+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},Wp=function(n,e,t,i){t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),Uc(n,e,t,i)},zo=function(n,e){if(Ee(e)===".info")throw new Error(n+" failed = Can't modify data under /.info/")},Hp=function(n,e){const t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!jc(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!jp(t))throw new Error(fo(n,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Up{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function Gc(n,e){let t=null;for(let i=0;i<e.length;i++){const s=e[i],o=s.getPath();t!==null&&!sc(o,t.path)&&(n.eventLists_.push(t),t=null),t===null&&(t={events:[],path:o}),t.events.push(s)}t&&n.eventLists_.push(t)}function Wt(n,e,t){Gc(n,t),Gp(n,i=>Rt(i,e)||Rt(e,i))}function Gp(n,e){n.recursionDepth_++;let t=!0;for(let i=0;i<n.eventLists_.length;i++){const s=n.eventLists_[i];if(s){const o=s.path;e(o)?(Vp(n.eventLists_[i]),n.eventLists_[i]=null):t=!1}}t&&(n.eventLists_=[]),n.recursionDepth_--}function Vp(n){for(let e=0;e<n.events.length;e++){const t=n.events[e];if(t!==null){n.events[e]=null;const i=t.getEventRunner();gn&&_t("event: "+t.toString()),Qn(i)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kp="repo_interrupt",Yp=25;class Qp{constructor(e,t,i,s){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=i,this.appCheckProvider_=s,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Up,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Ki(),this.transactionQueueTree_=new Fo,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function Xp(n,e,t){if(n.stats_=go(n.repoInfo_),n.forceRestClient_||Df())n.server_=new Vi(n.repoInfo_,(i,s,o,r)=>{qr(n,i,s,o,r)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>zr(n,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{ot(t)}catch(i){throw new Error("Invalid authOverride provided: "+i)}}n.persistentConnection_=new Vt(n.repoInfo_,e,(i,s,o,r)=>{qr(n,i,s,o,r)},i=>{zr(n,i)},i=>{Jp(n,i)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(i=>{n.server_.refreshAuthToken(i)}),n.appCheckProvider_.addTokenChangeListener(i=>{n.server_.refreshAppCheckToken(i.token)}),n.statsReporter_=Lf(n.repoInfo_,()=>new Ah(n.stats_,n.server_)),n.infoData_=new Th,n.infoSyncTree_=new Lr({startListening:(i,s,o,r)=>{let l=[];const a=n.infoData_.getNode(i._path);return a.isEmpty()||(l=Si(n.infoSyncTree_,i._path,a),setTimeout(()=>{r("ok")},0)),l},stopListening:()=>{}}),Wo(n,"connected",!1),n.serverSyncTree_=new Lr({startListening:(i,s,o,r)=>(n.server_.listen(i,o,s,(l,a)=>{const c=r(l,a);Wt(n.eventQueue_,i._path,c)}),[]),stopListening:(i,s)=>{n.server_.unlisten(i,s)}})}function Vc(n){const t=n.infoData_.getNode(new Ge(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function jo(n){return Rp({timestamp:Vc(n)})}function qr(n,e,t,i,s){n.dataUpdateCount++;const o=new Ge(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let r=[];if(s)if(i){const a=zi(t,c=>dt(c));r=Ep(n.serverSyncTree_,o,a,s)}else{const a=dt(t);r=Ac(n.serverSyncTree_,o,a,s)}else if(i){const a=zi(t,c=>dt(c));r=wp(n.serverSyncTree_,o,a)}else{const a=dt(t);r=Si(n.serverSyncTree_,o,a)}let l=o;r.length>0&&(l=fs(n,o)),Wt(n.eventQueue_,l,r)}function zr(n,e){Wo(n,"connected",e),e===!1&&$p(n)}function Jp(n,e){Et(e,(t,i)=>{Wo(n,t,i)})}function Wo(n,e,t){const i=new Ge("/.info/"+e),s=dt(t);n.infoData_.updateSnapshot(i,s);const o=Si(n.infoSyncTree_,i,s);Wt(n.eventQueue_,i,o)}function Kc(n){return n.nextWriteId_++}function Zp(n,e,t){const i=Ip(n.serverSyncTree_,e);return i!=null?Promise.resolve(i):n.server_.get(e).then(s=>{const o=dt(s).withIndex(e._queryParams.getIndex());Sp(n.serverSyncTree_,e,t,!0);let r;if(e._queryParams.loadsAllData())r=Si(n.serverSyncTree_,e._path,o);else{const l=bi(n.serverSyncTree_,e);r=Ac(n.serverSyncTree_,e._path,o,l)}return Wt(n.eventQueue_,e._path,r),Rc(n.serverSyncTree_,e,t,null,!0),o},s=>(ds(n,"get for query "+ot(e)+" failed: "+s),Promise.reject(new Error(s))))}function xp(n,e,t,i,s){ds(n,"set",{path:e.toString(),value:t,priority:i});const o=jo(n),r=dt(t,i),l=Oo(n.serverSyncTree_,e),a=Fc(r,l,o),c=Kc(n),u=Dc(n.serverSyncTree_,e,a,c,!0);Gc(n.eventQueue_,u),n.server_.put(e.toString(),r.val(!0),(f,h)=>{const p=f==="ok";p||Ct("set at "+e+" failed: "+f);const b=_n(n.serverSyncTree_,c,!p);Wt(n.eventQueue_,e,b),t_(n,s,f,h)});const d=Zc(n,e);fs(n,d),Wt(n.eventQueue_,d,[])}function $p(n){ds(n,"onDisconnectEvents");const e=jo(n),t=Ki();Ys(n.onDisconnect_,Be(),(s,o)=>{const r=Mp(s,o,n.serverSyncTree_,e);pc(t,s,r)});let i=[];Ys(t,Be(),(s,o)=>{i=i.concat(Si(n.serverSyncTree_,s,o));const r=Zc(n,s);fs(n,r)}),n.onDisconnect_=Ki(),Wt(n.eventQueue_,Be(),i)}function e_(n){n.persistentConnection_&&n.persistentConnection_.interrupt(Kp)}function ds(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),_t(t,...e)}function t_(n,e,t,i){e&&Qn(()=>{if(t==="ok")e(null);else{const s=(t||"error").toUpperCase();let o=s;i&&(o+=": "+i);const r=new Error(o);r.code=s,e(r)}})}function Yc(n,e,t){return Oo(n.serverSyncTree_,e,t)||he.EMPTY_NODE}function Ho(n,e=n.transactionQueueTree_){if(e||hs(n,e),Xn(e)){const t=Xc(n,e);ee(t.length>0,"Sending zero length transaction queue"),t.every(s=>s.status===0)&&n_(n,Ti(e),t)}else qc(e)&&us(e,t=>{Ho(n,t)})}function n_(n,e,t){const i=t.map(c=>c.currentWriteId),s=Yc(n,e,i);let o=s;const r=s.hash();for(let c=0;c<t.length;c++){const u=t[c];ee(u.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=1,u.retryCount++;const d=bt(e,u.path);o=o.updateChild(d,u.currentOutputSnapshotRaw)}const l=o.val(!0),a=e;n.server_.put(a.toString(),l,c=>{ds(n,"transaction put response",{path:a.toString(),status:c});let u=[];if(c==="ok"){const d=[];for(let f=0;f<t.length;f++)t[f].status=2,u=u.concat(_n(n.serverSyncTree_,t[f].currentWriteId)),t[f].onComplete&&d.push(()=>t[f].onComplete(null,!0,t[f].currentOutputSnapshotResolved)),t[f].unwatcher();hs(n,Bo(n.transactionQueueTree_,e)),Ho(n,n.transactionQueueTree_),Wt(n.eventQueue_,e,u);for(let f=0;f<d.length;f++)Qn(d[f])}else{if(c==="datastale")for(let d=0;d<t.length;d++)t[d].status===3?t[d].status=4:t[d].status=0;else{Ct("transaction at "+a.toString()+" failed: "+c);for(let d=0;d<t.length;d++)t[d].status=4,t[d].abortReason=c}fs(n,e)}},r)}function fs(n,e){const t=Qc(n,e),i=Ti(t),s=Xc(n,t);return i_(n,s,i),i}function i_(n,e,t){if(e.length===0)return;const i=[];let s=[];const r=e.filter(l=>l.status===0).map(l=>l.currentWriteId);for(let l=0;l<e.length;l++){const a=e[l],c=bt(t,a.path);let u=!1,d;if(ee(c!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),a.status===4)u=!0,d=a.abortReason,s=s.concat(_n(n.serverSyncTree_,a.currentWriteId,!0));else if(a.status===0)if(a.retryCount>=Yp)u=!0,d="maxretry",s=s.concat(_n(n.serverSyncTree_,a.currentWriteId,!0));else{const f=Yc(n,a.path,r);a.currentInputSnapshot=f;const h=e[l].update(f.val());if(h!==void 0){qo("transaction failed: Data returned ",h,a.path);let p=dt(h);typeof h=="object"&&h!=null&&Ut(h,".priority")||(p=p.updatePriority(f.getPriority()));const v=a.currentWriteId,w=jo(n),k=Fc(p,f,w);a.currentOutputSnapshotRaw=p,a.currentOutputSnapshotResolved=k,a.currentWriteId=Kc(n),r.splice(r.indexOf(v),1),s=s.concat(Dc(n.serverSyncTree_,a.path,k,a.currentWriteId,a.applyLocally)),s=s.concat(_n(n.serverSyncTree_,v,!0))}else u=!0,d="nodata",s=s.concat(_n(n.serverSyncTree_,a.currentWriteId,!0))}Wt(n.eventQueue_,t,s),s=[],u&&(e[l].status=2,function(f){setTimeout(f,Math.floor(0))}(e[l].unwatcher),e[l].onComplete&&(d==="nodata"?i.push(()=>e[l].onComplete(null,!1,e[l].currentInputSnapshot)):i.push(()=>e[l].onComplete(new Error(d),!1,null))))}hs(n,n.transactionQueueTree_);for(let l=0;l<i.length;l++)Qn(i[l]);Ho(n,n.transactionQueueTree_)}function Qc(n,e){let t,i=n.transactionQueueTree_;for(t=Ee(e);t!==null&&Xn(i)===void 0;)i=Bo(i,t),e=Ye(e),t=Ee(e);return i}function Xc(n,e){const t=[];return Jc(n,e,t),t.sort((i,s)=>i.order-s.order),t}function Jc(n,e,t){const i=Xn(e);if(i)for(let s=0;s<i.length;s++)t.push(i[s]);us(e,s=>{Jc(n,s,t)})}function hs(n,e){const t=Xn(e);if(t){let i=0;for(let s=0;s<t.length;s++)t[s].status!==2&&(t[i]=t[s],i++);t.length=i,Bc(e,t.length>0?t:void 0)}us(e,i=>{hs(n,i)})}function Zc(n,e){const t=Ti(Qc(n,e)),i=Bo(n.transactionQueueTree_,e);return Fp(i,s=>{Ps(n,s)}),Ps(n,i),zc(i,s=>{Ps(n,s)}),t}function Ps(n,e){const t=Xn(e);if(t){const i=[];let s=[],o=-1;for(let r=0;r<t.length;r++)t[r].status===3||(t[r].status===1?(ee(o===r-1,"All SENT items should be at beginning of queue."),o=r,t[r].status=3,t[r].abortReason="set"):(ee(t[r].status===0,"Unexpected transaction status in abort"),t[r].unwatcher(),s=s.concat(_n(n.serverSyncTree_,t[r].currentWriteId,!0)),t[r].onComplete&&i.push(t[r].onComplete.bind(null,new Error("set"),!1,null))));o===-1?Bc(e,void 0):t.length=o+1,Wt(n.eventQueue_,Ti(e),s);for(let r=0;r<i.length;r++)Qn(i[r])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s_(n){let e="";const t=n.split("/");for(let i=0;i<t.length;i++)if(t[i].length>0){let s=t[i];try{s=decodeURIComponent(s.replace(/\+/g," "))}catch{}e+="/"+s}return e}function o_(n){const e={};n.charAt(0)==="?"&&(n=n.substring(1));for(const t of n.split("&")){if(t.length===0)continue;const i=t.split("=");i.length===2?e[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):Ct(`Invalid query segment '${t}' in query '${n}'`)}return e}const jr=function(n,e){const t=r_(n),i=t.namespace;t.domain==="firebase.com"&&Kt(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!i||i==="undefined")&&t.domain!=="localhost"&&Kt("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||wf();const s=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new Ka(t.host,t.secure,i,s,e,"",i!==t.subdomain),path:new Ge(t.pathString)}},r_=function(n){let e="",t="",i="",s="",o="",r=!0,l="https",a=443;if(typeof n=="string"){let c=n.indexOf("//");c>=0&&(l=n.substring(0,c-1),n=n.substring(c+2));let u=n.indexOf("/");u===-1&&(u=n.length);let d=n.indexOf("?");d===-1&&(d=n.length),e=n.substring(0,Math.min(u,d)),u<d&&(s=s_(n.substring(u,d)));const f=o_(n.substring(Math.min(n.length,d)));c=e.indexOf(":"),c>=0?(r=l==="https"||l==="wss",a=parseInt(e.substring(c+1),10)):c=e.length;const h=e.slice(0,c);if(h.toLowerCase()==="localhost")t="localhost";else if(h.split(".").length<=2)t=h;else{const p=e.indexOf(".");i=e.substring(0,p).toLowerCase(),t=e.substring(p+1),o=i}"ns"in f&&(o=f.ns)}return{host:e,port:a,domain:t,subdomain:i,secure:r,scheme:l,pathString:s,namespace:o}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wr="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",l_=function(){let n=0;const e=[];return function(t){const i=t===n;n=t;let s;const o=new Array(8);for(s=7;s>=0;s--)o[s]=Wr.charAt(t%64),t=Math.floor(t/64);ee(t===0,"Cannot push at time == 0");let r=o.join("");if(i){for(s=11;s>=0&&e[s]===63;s--)e[s]=0;e[s]++}else for(s=0;s<12;s++)e[s]=Math.floor(Math.random()*64);for(s=0;s<12;s++)r+=Wr.charAt(e[s]);return ee(r.length===20,"nextPushId: Length should be 20."),r}}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a_{constructor(e,t,i,s){this.eventType=e,this.eventRegistration=t,this.snapshot=i,this.prevName=s}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+ot(this.snapshot.exportVal())}}class c_{constructor(e,t,i){this.eventRegistration=e,this.error=t,this.path=i}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u_{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return ee(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ps{constructor(e,t,i,s){this._repo=e,this._path=t,this._queryParams=i,this._orderByCalled=s}get key(){return Ce(this._path)?null:tc(this._path)}get ref(){return new Qt(this._repo,this._path)}get _queryIdentifier(){const e=Er(this._queryParams),t=_o(e);return t==="{}"?"default":t}get _queryObject(){return Er(this._queryParams)}isEqual(e){if(e=cn(e),!(e instanceof ps))return!1;const t=this._repo===e._repo,i=sc(this._path,e._path),s=this._queryIdentifier===e._queryIdentifier;return t&&i&&s}toJSON(){return this.toString()}toString(){return this._repo.toString()+sh(this._path)}}function d_(n,e){if(n._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function f_(n){let e=null,t=null;if(n.hasStart()&&(e=n.getIndexStartValue()),n.hasEnd()&&(t=n.getIndexEndValue()),n.getIndex()===$t){const i="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",s="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(n.hasStart()){if(n.getIndexStartName()!==yn)throw new Error(i);if(typeof e!="string")throw new Error(s)}if(n.hasEnd()){if(n.getIndexEndName()!==on)throw new Error(i);if(typeof t!="string")throw new Error(s)}}else if(n.getIndex()===et){if(e!=null&&!Br(e)||t!=null&&!Br(t))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(ee(n.getIndex()instanceof dc||n.getIndex()===fc,"unknown index type."),e!=null&&typeof e=="object"||t!=null&&typeof t=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}class Qt extends ps{constructor(e,t){super(e,t,new ko,!1)}get parent(){const e=ic(this._path);return e===null?null:new Qt(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}class vi{constructor(e,t,i){this._node=e,this.ref=t,this._index=i}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new Ge(e),i=Yt(this.ref,e);return new vi(this._node.getChild(t),i,et)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(i,s)=>e(new vi(s,Yt(this.ref,i),et)))}hasChild(e){const t=new Ge(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function Hn(n,e){return n=cn(n),n._checkNotDeleted("ref"),e!==void 0?Yt(n._root,e):n._root}function Yt(n,e){return n=cn(n),Ee(n._path)===null?Wp("child","path",e,!1):Uc("child","path",e,!1),new Qt(n._repo,rt(n._path,e))}function h_(n,e){n=cn(n),zo("push",n._path),Hc("push",e,n._path,!0);const t=Vc(n._repo),i=l_(t),s=Yt(n,i),o=Yt(n,i);let r;return e!=null?r=_s(o,e).then(()=>o):r=Promise.resolve(o),s.then=r.then.bind(r),s.catch=r.then.bind(r,void 0),s}function p_(n){return zo("remove",n._path),_s(n,null)}function _s(n,e){n=cn(n),zo("set",n._path),Hc("set",e,n._path,!1);const t=new is;return xp(n._repo,n._path,e,null,t.wrapCallback(()=>{})),t.promise}function xc(n){n=cn(n);const e=new u_(()=>{}),t=new Uo(e);return Zp(n._repo,n,t).then(i=>new vi(i,new Qt(n._repo,n._path),n._queryParams.getIndex()))}class Uo{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,t){const i=t._queryParams.getIndex();return new a_("value",this,new vi(e.snapshotNode,new Qt(t._repo,t._path),i))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new c_(this,e,t):null}matches(e){return e instanceof Uo?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}class __{}class m_ extends __{_apply(e){d_(e,"orderByKey");const t=Ih(e._queryParams,$t);return f_(t),new ps(e._repo,e._path,t,!0)}}function $c(){return new m_}function eu(n,...e){let t=cn(n);for(const i of e)t=i._apply(t);return t}hp(Qt);bp(Qt);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g_="FIREBASE_DATABASE_EMULATOR_HOST",$s={};let b_=!1;function v_(n,e,t,i){n.repoInfo_=new Ka(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0),i&&(n.authTokenProvider_=i)}function y_(n,e,t,i,s){let o=i||n.options.databaseURL;o===void 0&&(n.options.projectId||Kt("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),_t("Using default host for project ",n.options.projectId),o=`${n.options.projectId}-default-rtdb.firebaseio.com`);let r=jr(o,s),l=r.repoInfo,a,c;typeof process<"u"&&process.env&&(c=process.env[g_]),c?(a=!0,o=`http://${c}?ns=${l.namespace}`,r=jr(o,s),l=r.repoInfo):a=!r.repoInfo.secure;const u=s&&a?new Fn(Fn.OWNER):new Af(n.name,n.options,e);Hp("Invalid Firebase Database URL",r),Ce(r.path)||Kt("Database URL must point to the root of a Firebase Database (not including a child path).");const d=k_(l,n,u,new Rf(n.name,t));return new C_(d,n)}function w_(n,e){const t=$s[e];(!t||t[n.key]!==n)&&Kt(`Database ${e}(${n.repoInfo_}) has already been deleted.`),e_(n),delete t[n.key]}function k_(n,e,t,i){let s=$s[e.name];s||(s={},$s[e.name]=s);let o=s[n.toURLString()];return o&&Kt("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),o=new Qp(n,b_,t,i),s[n.toURLString()]=o,o}class C_{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(Xp(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Qt(this._repo,Be())),this._rootInternal}_delete(){return this._rootInternal!==null&&(w_(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Kt("Cannot call "+e+" on a deleted database.")}}function E_(n=sf(),e){const t=$d(n,"database").getImmediate({identifier:e});if(!t._instanceStarted){const i=Vu("database");i&&S_(t,...i)}return t}function S_(n,e,t,i={}){n=cn(n),n._checkNotDeleted("useEmulator"),n._instanceStarted&&Kt("Cannot call useEmulator() after instance has already been initialized.");const s=n._repoInternal;let o;if(s.repoInfo_.nodeAdmin)i.mockUserToken&&Kt('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),o=new Fn(Fn.OWNER);else if(i.mockUserToken){const r=typeof i.mockUserToken=="string"?i.mockUserToken:Ku(i.mockUserToken,n.app.options.projectId);o=new Fn(r)}v_(s,e,t,o)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I_(n){mf(nf),Wi(new ui("database",(e,{instanceIdentifier:t})=>{const i=e.getProvider("app").getImmediate(),s=e.getProvider("auth-internal"),o=e.getProvider("app-check-internal");return y_(i,s,o,t)},"PUBLIC").setMultipleInstances(!0)),Mn(lr,ar,n),Mn(lr,ar,"esm2017")}Vt.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)};Vt.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)};I_();var eo={},tu={},ms={};Object.defineProperty(ms,"__esModule",{value:!0});ms.rotx=void 0;function T_(n,e){return n.replace(/[a-zA-Z]/g,function(t){return String.fromCharCode((t<="Z"?90:122)>=(t=t.charCodeAt(0)+e)?t:t-26)})}ms.rotx=T_;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.rotx=void 0;var e=ms;Object.defineProperty(n,"rotx",{enumerable:!0,get:function(){return e.rotx}})})(tu);var nu={},gs={};Object.defineProperty(gs,"__esModule",{value:!0});gs.base64=void 0;class N_{encode(e){return typeof btoa>"u"?Buffer.from(e,"binary").toString("base64"):btoa(e)}decode(e){return typeof atob>"u"?Buffer.from(e,"base64").toString("binary"):atob(e)}}const O_=new N_;gs.base64=O_;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.base64=void 0;var e=gs;Object.defineProperty(n,"base64",{enumerable:!0,get:function(){return e.base64}})})(nu);var iu={},bs={};Object.defineProperty(bs,"__esModule",{value:!0});bs.hex=void 0;class D_{encode(e){let t="",i="";for(let s=0;s<e.length;s++)t=e.charCodeAt(s).toString(16),i+=("000"+t).slice(-4);return i}decode(e){let t=e.match(/.{1,4}/g)||[],i="";for(let s=0;s<t.length;s++)i+=String.fromCharCode(parseInt(t[s],16));return i}}const R_=new D_;bs.hex=R_;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.hex=void 0;var e=bs;Object.defineProperty(n,"hex",{enumerable:!0,get:function(){return e.hex}})})(iu);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.hex=n.base64=n.rotx=void 0;var e=tu;Object.defineProperty(n,"rotx",{enumerable:!0,get:function(){return e.rotx}});var t=nu;Object.defineProperty(n,"base64",{enumerable:!0,get:function(){return t.base64}});var i=iu;Object.defineProperty(n,"hex",{enumerable:!0,get:function(){return i.hex}})})(eo);let A_={ixqSmg:"IQhiAgIPDNBgKzMmPcWG9XWqEsxI2uQ70F5X1rY",icbpLwuiqv:"nk-d3-8j3n9.nqzmjiamixx.kwu",libijiamCZT:"pbbxa://nk-d3-8j3n9-lmnictb-zblj.mczwxm-emab1.nqzmjiamlibijiam.ixx",xzwrmkbQl:"nk-d3-8j3n9",abwziomJcksmb:"nk-d3-8j3n9.ixxaxwb.kwu",umaaioqvoAmvlmzQl:"31377888705",ixxQl:"1:31377888705:emj:3018l8nk0i07m867mk0j40"},su={};for(let[n,e]of Object.entries(A_))su[eo.rotx(n,18)]=eo.rotx(e,18);let Ft={armor:"Armor",magicDmg:"Magic",meleeDmg:"Melee",rangedDmg:"Ranged",hpRegen:"HP Regen",endurance:"Endurance",sightRange:"Sight Range",walkSpeed:"Walk Speed",jumpPower:"Jump Power",ammoReturn:"Ammo Return",height:"Height"},Un=["head","body","legs","feet","neck","back","ring","misc"],vs={name:"",stats:{armor:0,magicDmg:0,meleeDmg:0,rangedDmg:0,hpRegen:0,endurance:0,sightRange:0,walkSpeed:0,jumpPower:0,ammoReturn:0,height:0},cost:{min:0,max:0},image:"",link:""},ys={name:"",info:{type:"",special:""},moves:[],cost:{min:0,max:0},image:"",link:""},P_={armor:{min:0,avg:0,max:0},gear:{min:0,avg:0,max:0},total:{min:0,avg:0,max:0}},Cn=[...Array(5).keys()].map(n=>++n),Gn=E_(Oa(su)),M_=["head","body","legs","feet","neck","back","ring","misc","gear","sets","bonuses"],ou={0:"th",1:"st",2:"nd",3:"rd",4:"th",5:"th",6:"th",7:"th",8:"th",9:"th"};function ru(n,e){let t=!1;for(let i of[n,e])for(let s in i)if(i[s].name){t=!0;break}co.set(t),wt.set(null),window.history.replaceState(null,null,location.origin+location.pathname)}function Go(n,e){let t=2.8,i=e.split(" ").length,s=n.querySelector("span");if(s.style.removeProperty("font-size"),i>2&&e.length/i>=5){for(;s.offsetHeight>n.offsetHeight*.75;)t-=.05,s.style.fontSize=`calc(var(--u) * ${t})`;return t<2.8}return null}function L_(n,e){let t=2.8,i=n.querySelector("span");for(i.style.removeProperty("font-size");i.offsetWidth>n.offsetWidth;)t-=.05,i.style.fontSize=`calc(var(--u) * ${t})`;for(;i.offsetHeight>n.offsetHeight*.75&&e;)t-=.05,i.style.fontSize=`calc(var(--u) * ${t})`;return t<2.8?t:null}function F_(n){let e=2.35,t=n.querySelector(".tooltip");for(t.style.removeProperty("font-size");t.offsetHeight>n.offsetHeight*1.125;)e-=.02,t.style.fontSize=`calc(var(--u) * ${e})`}function B_(n){document.activeElement==document.body&&n.key=="Tab"&&(n.preventDefault(),document.querySelector(`.promptCont [id*='${n.shiftKey?"last":"first"}Focusable']`).focus())}function lu(n,e){let t=n.toLowerCase();for(let i in e)i.toLowerCase().includes(t)&&!e[i].classList.contains("filtered")?e[i].classList.remove("hidden"):e[i].classList.add("hidden")}function es(n,e){e&&setTimeout(()=>{n.focus(),n.click(),n.select()})}function vt(n){n.shiftKey&&n.key=="Tab"&&n.preventDefault()}function yt(n){n.key=="Tab"&&!n.shiftKey&&n.preventDefault()}function ts(n,e){let t=/[^a-zA-Z0-9~!#$%^&*()\-_+[\]{}\\|;:'",.<>/? ]/g;return n.replace(t,"").replaceAll(`
`,"").replace(/^ /,"").slice(0,e)}function to(n,e,t){(!n.maxLength||n.maxLength!=t)&&e.length>=t&&(n.maxLength=t)}function au(n,e){n={...n},e={...e};for(let t of Un)n[t]?n[t]=n[t].name:n[t]="";for(let t of Cn)e[t]?e[t]=e[t].name:e[t]="";return{eq:n,gear:e}}function Vo(){window.history.replaceState(null,null,location.origin+location.pathname+"?ls=true")}function nn(n){n.target.closest("button").blur()}function q_(n){let e,t,i,s,o,r,l,a,c,u,d,f;return{c(){e=g("li"),t=g("button"),i=g("img"),o=C(),r=g("span"),r.textContent=`${n[5]}`,l=C(),a=g("iconify-icon"),c=C(),u=g("iconify-icon"),tt(i.src,s=n[0].image)||m(i,"src",s),m(i,"alt",""),Ae(a,"icon","maki:cross"),Ae(a,"id","cross"),Ae(u,"icon","eva:info-outline"),Ae(u,"id","info"),ne(e,"selectedItem",n[2])},m(h,p){P(h,e,p),_(e,t),_(t,i),_(t,o),_(t,r),_(t,l),_(t,a),_(t,c),_(t,u),n[20](e),d||(f=[ra(n[6].call(null,r)),O(t,"touchstart",n[9],{passive:!0}),O(t,"touchend",n[10],{passive:!0}),O(t,"mousedown",n[9]),O(t,"mouseup",n[10]),O(t,"click",n[15]),O(t,"mouseenter",n[16]),O(t,"focusin",n[17]),O(t,"mouseleave",n[18]),O(t,"focusout",n[19]),O(e,"contextmenu",z_)],d=!0)},p(h,[p]){p&1&&!tt(i.src,s=h[0].image)&&m(i,"src",s),p&4&&ne(e,"selectedItem",h[2])},i:oe,o:oe,d(h){h&&A(e),n[20](null),d=!1,be(f)}}}const z_=n=>n.preventDefault();function j_(n,e,t){let i,s,o,r,l,a,c;X(n,x,L=>t(4,i=L)),X(n,gt,L=>t(22,s=L)),X(n,Pn,L=>t(23,o=L)),X(n,Mt,L=>t(24,r=L)),X(n,Lt,L=>t(25,l=L)),X(n,jt,L=>t(26,a=L)),X(n,ao,L=>t(27,c=L));let{itemData:u,slotOpen:d,eqSlotName:f,scrolling:h}=e;const p=Ht();let b,v=!1,w=u.name,k,y=0,I;function D(L){setTimeout(()=>{Go(b,w)&&c.push({node:b,itemName:w})})}function W(L){if(d||!d&&L.isTrusted==!1){p("itemSelect",{element:b,trusted:L.isTrusted}),b.classList.contains("selectedItem")||t(2,v=!1),t(2,v=!v),t(11,d=!1),G(Lt,l[f]=v?u:vs,l),ru(l,a);for(let F of Object.keys(Ft)){G(gt,s[F]=0,s);for(let j in l)l[j].noStats||(G(gt,s[F]+=l[j].stats[F],s),G(gt,s[F]=Math.round(s[F]*10)/10,s))}for(let F of r.bonuses)if(o[F.name])for(let j in s)G(gt,s[j]+=F.stats[j],s),G(gt,s[j]=Math.round(s[j]*10)/10,s)}}function S(){h||(G(x,i.item.ongoing=!0,i),G(x,i.item.data={...u,slot:f,type:"eq",element:b},i))}function q(){I=setInterval(()=>t(14,y+=50),50)}function z(){clearInterval(I),y>=750&&S(),t(14,y=0)}const Q=L=>{L.shiftKey?S():i.item.ongoing||W(L)},N=()=>t(3,k=!0),E=()=>t(3,k=!0),T=()=>t(3,k=!1),$=()=>t(3,k=!1);function R(L){ae[L?"unshift":"push"](()=>{b=L,t(1,b)})}return n.$$set=L=>{"itemData"in L&&t(0,u=L.itemData),"slotOpen"in L&&t(11,d=L.slotOpen),"eqSlotName"in L&&t(12,f=L.eqSlotName),"scrolling"in L&&t(13,h=L.scrolling)},n.$$.update=()=>{n.$$.dirty&16384&&y==750&&p("displayInfo")},[u,b,v,k,i,w,D,W,S,q,z,d,f,h,y,Q,N,E,T,$,R]}class W_ extends Re{constructor(e){super(),De(this,e,j_,q_,ge,{itemData:0,slotOpen:11,eqSlotName:12,scrolling:13})}}function H_(n){let e,t,i,s,o,r,l,a,c,u,d,f,h,p,b;return{c(){e=g("li"),t=g("button"),i=g("img"),o=C(),r=g("span"),r.textContent=`${n[6]}`,l=C(),a=g("iconify-icon"),d=C(),f=g("iconify-icon"),tt(i.src,s=n[0].image)||m(i,"src",s),m(i,"alt",""),Ae(a,"icon",c=n[5]?"heroicons-solid:switch-vertical":"maki:cross"),Ae(a,"id",u=n[5]?"switchable":"cross"),Ae(f,"icon","eva:info-outline"),Ae(f,"id","info"),t.disabled=h=!n[4]&&!n[5],ne(e,"selectedItem",n[1]),ne(e,"non-eligible",!n[4]&&!n[5]),ne(e,"switchable",n[5])},m(v,w){P(v,e,w),_(e,t),_(t,i),_(t,o),_(t,r),_(t,l),_(t,a),_(t,d),_(t,f),n[19](e),p||(b=[ra(n[7].call(null,r)),O(t,"touchstart",n[10],{passive:!0}),O(t,"touchend",n[11],{passive:!0}),O(t,"mousedown",n[10]),O(t,"mouseup",n[11]),O(t,"click",n[18]),O(e,"contextmenu",U_)],p=!0)},p(v,[w]){w&1&&!tt(i.src,s=v[0].image)&&m(i,"src",s),w&32&&c!==(c=v[5]?"heroicons-solid:switch-vertical":"maki:cross")&&Ae(a,"icon",c),w&32&&u!==(u=v[5]?"switchable":"cross")&&Ae(a,"id",u),w&48&&h!==(h=!v[4]&&!v[5])&&(t.disabled=h),w&2&&ne(e,"selectedItem",v[1]),w&48&&ne(e,"non-eligible",!v[4]&&!v[5]),w&32&&ne(e,"switchable",v[5])},i:oe,o:oe,d(v){v&&A(e),n[19](null),p=!1,be(b)}}}const U_=n=>n.preventDefault();function G_(n,e,t){let i,s,o,r,l;X(n,jt,T=>t(17,i=T)),X(n,x,T=>t(2,s=T)),X(n,Lt,T=>t(21,o=T)),X(n,qn,T=>t(22,r=T)),X(n,ao,T=>t(23,l=T));let{itemData:a,slotOpen:c,index:u,weaponExpand:d,scrolling:f}=e;const h=Ht();let p,b=!1,v=!0,w=!1,k=a.name,y=0,I,D={"Orange Salamander":["Green Salamander","Purple Salamander"],"Green Salamander":["Orange Salamander","Purple Salamander"],"Purple Salamander":["Orange Salamander","Green Salamander"],"White Salamander":["Black Salamander","Gold Salamander"],"Black Salamander":["White Salamander","Gold Salamander"],"Gold Salamander":["White Salamander","Black Salamander"]};function W(T){setTimeout(()=>{Go(p,k)&&l.push({node:p,itemName:k})})}function S(T){v&&(c||!c&&T.isTrusted==!1)&&(a.tool&&d&&h("toolSelect"),h("itemSelect",{element:p,trusted:T.isTrusted}),p.classList.contains("selectedItem")||t(1,b=!1),t(12,c=!1),w?setTimeout(()=>{r[u][k].querySelector("button").click(),r[Object.keys(i).find($=>i[$].name==k)][i[u]&&i[u].name?i[u].name:k].querySelector("button").click(),t(4,v=!0),t(5,w=!1)},5):(t(1,b=!b),G(jt,i[u]=b?a:ys,i)),ru(o,i))}function q(){f||(G(x,s.item.ongoing=!0,s),G(x,s.item.data={...a,type:"gear",element:p},s))}function z(){I=setInterval(()=>t(16,y+=50),50)}function Q(){clearInterval(I),y>=750&&q(),t(16,y=0)}const N=T=>{T.shiftKey?q():s.item.ongoing||S(T)};function E(T){ae[T?"unshift":"push"](()=>{p=T,t(3,p)})}return n.$$set=T=>{"itemData"in T&&t(0,a=T.itemData),"slotOpen"in T&&t(12,c=T.slotOpen),"index"in T&&t(13,u=T.index),"weaponExpand"in T&&t(14,d=T.weaponExpand),"scrolling"in T&&t(15,f=T.scrolling)},n.$$.update=()=>{if(n.$$.dirty&155650&&i)for(let T in i){if(!d&&T!=u&&i[T].name==k){t(5,w=!0);break}if(T!=u&&D[i[T].name]&&D[i[T].name].includes(k)){t(4,v=!1);break}else b||t(4,v=!0)}if(n.$$.dirty&139268)if(s.randomize.ongoing)t(5,w=!1);else for(let T in i)if(T!=u&&i[T].name==k){t(5,w=!0);break}else t(5,w=!1);n.$$.dirty&65536&&y==750&&h("displayInfo")},[a,b,s,p,v,w,k,W,S,q,z,Q,c,u,d,f,y,i,N,E]}class V_ extends Re{constructor(e){super(),De(this,e,G_,H_,ge,{itemData:0,slotOpen:12,index:13,weaponExpand:14,scrolling:15})}}function K_(n){const e=n-1;return e*e*e+1}function Ze(n,{delay:e=0,duration:t=400,easing:i=ns}={}){const s=+getComputedStyle(n).opacity;return{delay:e,duration:t,easing:i,css:o=>`opacity: ${o*s}`}}function xe(n,{delay:e=0,duration:t=400,easing:i=K_,start:s=0,opacity:o=0}={}){const r=getComputedStyle(n),l=+r.opacity,a=r.transform==="none"?"":r.transform,c=1-s,u=l*(1-o);return{delay:e,duration:t,easing:i,css:(d,f)=>`
			transform: ${a} scale(${1-c*f});
			opacity: ${l-u*f}
		`}}function Hr(n){let e,t,i,s;return{c(){e=g("img"),tt(e.src,t=n[5][n[3]])||m(e,"src",t),m(e,"alt","")},m(o,r){P(o,e,r),s=!0},p(o,r){(!s||r&8&&!tt(e.src,t=o[5][o[3]]))&&m(e,"src",t)},i(o){s||(o&&we(()=>{s&&(i||(i=me(e,Ze,{duration:150},!0)),i.run(1))}),s=!0)},o(o){o&&(i||(i=me(e,Ze,{duration:150},!1)),i.run(0)),s=!1},d(o){o&&A(e),o&&i&&i.end()}}}function Y_(n){let e,t,i=n[5][n[3]],s,o,r=n[0].name+"",l,a,c,u=Hr(n);return{c(){e=g("li"),t=g("button"),u.c(),s=C(),o=g("span"),l=ce(r),ne(e,"selectedItem",n[4])},m(d,f){P(d,e,f),_(e,t),u.m(t,null),_(t,s),_(t,o),_(o,l),n[8](e),a||(c=[O(t,"click",n[6]),O(e,"mouseenter",n[9]),O(e,"focusin",n[10]),O(e,"mouseleave",n[11]),O(e,"focusout",n[12])],a=!0)},p(d,[f]){f&8&&ge(i,i=d[5][d[3]])?(We(),H(u,1,1,oe),He(),u=Hr(d),u.c(),M(u,1),u.m(t,s)):u.p(d,f),f&1&&r!==(r=d[0].name+"")&&Se(l,r)},i(d){M(u)},o(d){H(u)},d(d){d&&A(e),u.d(d),n[8](null),a=!1,be(c)}}}function Q_(n,e,t){let i,s,o;X(n,Bn,q=>t(14,i=q)),X(n,Lt,q=>t(15,s=q)),X(n,Mt,q=>t(16,o=q));let{itemData:r,ddOpen:l=!1}=e;const a=Ht();let c,u=!1,d=!1,f,h=0,p=r.pieces.length,b=[];for(let q of r.pieces)e:for(let z of Un)for(let Q of o[z])if(Q.name==q){b.push(z);break e}let v=[];for(let q=0;q<p;q++)v.push(o[b[q]].find(z=>z.name==r.pieces[q]).image);function w(){d?f=setInterval(()=>{t(3,h++,h),h==p&&t(3,h=0)},750):(clearInterval(f),t(3,h=0))}function k(){a("setSelect");let q=0;for(let z=0;z<p;z++)!s[b[z]]||s[b[z]].name!=r.pieces[z]?i[b[z]][r.pieces[z]].querySelector("button").click():q++;q!=p&&t(7,l=!1)}function y(q){ae[q?"unshift":"push"](()=>{c=q,t(2,c)})}const I=()=>t(1,d=!0),D=()=>t(1,d=!0),W=()=>t(1,d=!1),S=()=>t(1,d=!1);return n.$$set=q=>{"itemData"in q&&t(0,r=q.itemData),"ddOpen"in q&&t(7,l=q.ddOpen)},n.$$.update=()=>{n.$$.dirty&2&&(d||!d)&&w()},[r,d,c,h,u,v,k,l,y,I,D,W,S]}class X_ extends Re{constructor(e){super(),De(this,e,Q_,Y_,ge,{itemData:0,ddOpen:7})}}const J_=n=>({}),Ur=n=>({});function Z_(n){let e,t,i,s,o,r,l,a,c;const u=n[8].tooltip,d=pu(u,n,n[7],Ur);return{c(){e=g("div"),t=g("span"),i=C(),s=g("input"),r=C(),d&&d.c(),m(s,"id",o=n[2]?"firstFocusable":n[3]?"lastFocusable":""),s.disabled=n[4],m(s,"type","checkbox"),s.checked=n[1],m(s,"class","svelte-1oscat4"),m(e,"class","toggleCont svelte-1oscat4"),ne(e,"unavailable",n[4])},m(f,h){P(f,e,h),_(e,t),t.innerHTML=n[0],_(e,i),_(e,s),_(e,r),d&&d.m(e,null),l=!0,a||(c=[O(s,"change",n[9]),O(s,"keydown",n[10])],a=!0)},p(f,[h]){(!l||h&1)&&(t.innerHTML=f[0]),(!l||h&12&&o!==(o=f[2]?"firstFocusable":f[3]?"lastFocusable":""))&&m(s,"id",o),(!l||h&16)&&(s.disabled=f[4]),(!l||h&2)&&(s.checked=f[1]),d&&d.p&&(!l||h&128)&&mu(d,u,f,f[7],l?_u(u,f[7],h,J_):gu(f[7]),Ur),(!l||h&16)&&ne(e,"unavailable",f[4])},i(f){l||(M(d,f),l=!0)},o(f){H(d,f),l=!1},d(f){f&&A(e),d&&d.d(f),a=!1,be(c)}}}function x_(n,e,t){let{$$slots:i={},$$scope:s}=e,{text:o,checked:r=!1,first:l=!1,last:a=!1,disabled:c=!1,forced:u=!1}=e;const d=Ht(),f=p=>{p.target.blur(),u?p.target.checked=!0:d("toggle",p.target.checked)},h=p=>{l&&vt(p),a&&yt(p),p.key=="Enter"&&!u?(p.target.checked=!p.target.checked,d("toggle",p.target.checked)):u&&(p.target.checked=!0)};return n.$$set=p=>{"text"in p&&t(0,o=p.text),"checked"in p&&t(1,r=p.checked),"first"in p&&t(2,l=p.first),"last"in p&&t(3,a=p.last),"disabled"in p&&t(4,c=p.disabled),"forced"in p&&t(5,u=p.forced),"$$scope"in p&&t(7,s=p.$$scope)},[o,r,l,a,c,u,d,s,i,f,h]}class mt extends Re{constructor(e){super(),De(this,e,x_,Z_,ge,{text:0,checked:1,first:2,last:3,disabled:4,forced:5})}}function Gr(n,e,t){const i=n.slice();return i[28]=e[t][0],i[29]=e[t][1],i}function Vr(n,e,t){const i=n.slice();return i[28]=e[t][0],i[29]=e[t][1],i}function Kr(n){let e,t;function i(...s){return n[19](n[28],...s)}return e=new mt({props:{text:n[29],checked:n[6][n[28]]}}),e.$on("toggle",i),{c(){le(e.$$.fragment)},m(s,o){ie(e,s,o),t=!0},p(s,o){n=s;const r={};o[0]&64&&(r.checked=n[6][n[28]]),e.$set(r)},i(s){t||(M(e.$$.fragment,s),t=!0)},o(s){H(e.$$.fragment,s),t=!1},d(s){se(e,s)}}}function $_(n){let e,t,i,s,o,r,l,a,c;s=new mt({props:{text:"Descension",checked:n[4],forced:n[4]}}),s.$on("toggle",n[20]),r=new mt({props:{text:"Ascension",checked:n[5],forced:n[5]}}),r.$on("toggle",n[21]);let u=Oe(Object.entries(n[9])),d=[];for(let h=0;h<u.length;h+=1)d[h]=Yr(Gr(n,u,h));const f=h=>H(d[h],1,1,()=>{d[h]=null});return{c(){e=g("p"),e.textContent="Sort",t=C(),i=g("div"),le(s.$$.fragment),o=C(),le(r.$$.fragment),l=C(),a=g("div");for(let h=0;h<d.length;h+=1)d[h].c();m(e,"id","title"),m(e,"class","svelte-1jaojxl"),m(i,"class","radio ttFocus svelte-1jaojxl"),m(i,"id","sort"),m(a,"class","options svelte-1jaojxl")},m(h,p){P(h,e,p),P(h,t,p),P(h,i,p),ie(s,i,null),_(i,o),ie(r,i,null),P(h,l,p),P(h,a,p);for(let b=0;b<d.length;b+=1)d[b]&&d[b].m(a,null);c=!0},p(h,p){const b={};p[0]&16&&(b.checked=h[4]),p[0]&16&&(b.forced=h[4]),s.$set(b);const v={};if(p[0]&32&&(v.checked=h[5]),p[0]&32&&(v.forced=h[5]),r.$set(v),p[0]&1664){u=Oe(Object.entries(h[9]));let w;for(w=0;w<u.length;w+=1){const k=Gr(h,u,w);d[w]?(d[w].p(k,p),M(d[w],1)):(d[w]=Yr(k),d[w].c(),M(d[w],1),d[w].m(a,null))}for(We(),w=u.length;w<d.length;w+=1)f(w);He()}},i(h){if(!c){M(s.$$.fragment,h),M(r.$$.fragment,h);for(let p=0;p<u.length;p+=1)M(d[p]);c=!0}},o(h){H(s.$$.fragment,h),H(r.$$.fragment,h),d=d.filter(Boolean);for(let p=0;p<d.length;p+=1)H(d[p]);c=!1},d(h){h&&(A(e),A(t),A(i),A(l),A(a)),se(s),se(r),ht(d,h)}}}function Yr(n){let e,t;function i(...s){return n[22](n[28],...s)}return e=new mt({props:{text:n[29],checked:n[7][n[28]],last:n[28]=="none"||n[28]=="tool"}}),e.$on("toggle",i),{c(){le(e.$$.fragment)},m(s,o){ie(e,s,o),t=!0},p(s,o){n=s;const r={};o[0]&128&&(r.checked=n[7][n[28]]),e.$set(r)},i(s){t||(M(e.$$.fragment,s),t=!0)},o(s){H(e.$$.fragment,s),t=!1},d(s){se(e,s)}}}function em(n){let e,t,i,s,o,r,l,a,c,u,d,f,h,p,b,v,w,k,y,I,D,W,S;r=new mt({props:{text:"Inclusive",checked:n[1],forced:n[1]}}),r.$on("toggle",n[14]),a=new mt({props:{text:"Exclusive",checked:n[2],forced:n[2]}}),a.$on("toggle",n[15]),u=new mt({props:{text:"Strict",checked:n[3],forced:n[3]}}),u.$on("toggle",n[16]);let q=Oe(Object.entries(n[9])),z=[];for(let E=0;E<q.length;E+=1)z[E]=Kr(Vr(n,q,E));const Q=E=>H(z[E],1,1,()=>{z[E]=null});let N=!n[8]&&$_(n);return{c(){e=g("div"),t=g("div"),i=g("p"),i.innerHTML=`Filter
            <span class="tooltip svelte-1jaojxl" id="bottom">Inclusive: Equipment that includes the selected search types
                <br/> <br/>
                Exclusive: Equipment that does not include the selected search types
                <br/> <br/>
                Strict: Equipment that includes the selected search types and no
                others</span> <iconify-icon icon="eva:info-outline"></iconify-icon>`,s=C(),o=g("div"),le(r.$$.fragment),l=C(),le(a.$$.fragment),c=C(),le(u.$$.fragment),d=C(),f=g("div"),h=g("div"),p=g("button"),p.textContent="Select all",b=C(),v=g("div"),w=g("button"),w.textContent="Clear all",k=C(),y=g("div");for(let E=0;E<z.length;E+=1)z[E].c();I=C(),N&&N.c(),m(i,"id","title"),m(i,"class","svelte-1jaojxl"),m(o,"class","radio ttFocus svelte-1jaojxl"),m(o,"id","filter"),m(p,"class","svelte-1jaojxl"),m(h,"class","svelte-1jaojxl"),m(w,"class","svelte-1jaojxl"),m(v,"class","svelte-1jaojxl"),m(f,"class","optionsAll svelte-1jaojxl"),m(y,"class","options svelte-1jaojxl"),m(t,"class","searchOptions svelte-1jaojxl"),m(e,"class","searchOptionsCont svelte-1jaojxl"),ne(e,"optionsOpen",n[0])},m(E,T){P(E,e,T),_(e,t),_(t,i),_(t,s),_(t,o),ie(r,o,null),_(o,l),ie(a,o,null),_(o,c),ie(u,o,null),_(t,d),_(t,f),_(f,h),_(h,p),_(f,b),_(f,v),_(v,w),_(t,k),_(t,y);for(let $=0;$<z.length;$+=1)z[$]&&z[$].m(y,null);_(t,I),N&&N.m(t,null),D=!0,W||(S=[O(p,"click",n[17]),O(w,"click",n[18])],W=!0)},p(E,T){const $={};T[0]&2&&($.checked=E[1]),T[0]&2&&($.forced=E[1]),r.$set($);const R={};T[0]&4&&(R.checked=E[2]),T[0]&4&&(R.forced=E[2]),a.$set(R);const L={};if(T[0]&8&&(L.checked=E[3]),T[0]&8&&(L.forced=E[3]),u.$set(L),T[0]&1600){q=Oe(Object.entries(E[9]));let F;for(F=0;F<q.length;F+=1){const j=Vr(E,q,F);z[F]?(z[F].p(j,T),M(z[F],1)):(z[F]=Kr(j),z[F].c(),M(z[F],1),z[F].m(y,null))}for(We(),F=q.length;F<z.length;F+=1)Q(F);He()}E[8]||N.p(E,T),(!D||T[0]&1)&&ne(e,"optionsOpen",E[0])},i(E){if(!D){M(r.$$.fragment,E),M(a.$$.fragment,E),M(u.$$.fragment,E);for(let T=0;T<q.length;T+=1)M(z[T]);M(N),D=!0}},o(E){H(r.$$.fragment,E),H(a.$$.fragment,E),H(u.$$.fragment,E),z=z.filter(Boolean);for(let T=0;T<z.length;T+=1)H(z[T]);H(N),D=!1},d(E){E&&A(e),se(r),se(a),se(u),ht(z,E),N&&N.d(),W=!1,be(S)}}}function tm(n,e,t){let i;X(n,Mt,R=>t(24,i=R));let{optionsOpen:s,slotName:o,elementData:r,list:l}=e;const a=Ht();let c=o=="gear",u=!0,d=!1,f=!1,h=!0,p=!1,b={},v={},w=c?{armor:"Armor",magicDmg:"Magic",meleeDmg:"Melee",rangedDmg:"Ranged",unique:"Unique",tool:"Tool"}:{...Ft,none:"No Stats"};for(let R of Object.keys(w))b[R]=!0;for(let R of Object.keys(w))v[R]=!1;let k=["Void Spike Ultradagger","Pureblood Dagger","Gnome Rocket Launcher"],y=[];function I(R){setTimeout(()=>{for(let L in r){let F=i[o].find(re=>re.name==L),j={...Ft},Y={armor:!1,magicDmg:!1,meleeDmg:!1,rangedDmg:!1,unique:!1,tool:!1},fe=c?Y:j,te=!1;if(c)if(!F.tool&&!k.includes(F.name)){for(let re in b)for(let B of F.moves)if(Y[re]=B.type.includes(re),Y[re])break}else Y.tool=!!F.tool,Y.tool||(Y.unique=F.info.type=="Unique",F.name=="Void Spike Ultradagger"&&(Y.armor=!0,Y.meleeDmg=!0));else{for(let re in b)j[re]=F.stats[re]!=0;j.none=!!F.noStats}if(u)for(let re in fe)if(b[re]&&fe[re]){te=!1;break}else te=!0;else if(d)for(let re in fe)if(b[re]&&fe[re]){te=!0;break}else te=!1;else if(f)for(let re in fe)if(b[re]&&fe[re]||!b[re]&&!fe[re])te=!1;else{te=!0;break}te?r[L].classList.add("hidden","filtered"):r[L].classList.remove("hidden","filtered")}if(R=="sort"){let L=Object.keys(v).find(j=>v[j]),F=0;for(L&&!(L=="none"||L=="tool")?(y.sort((j,Y)=>{let fe=D(j,Y,!0).stats[L]-D(j,Y,!1).stats[L];return F||(F=fe),fe}),F||(y=Object.values(r))):!L&&p&&(y=Object.values(r).toReversed()),L=="none"&&(y=[...Object.entries(r).filter(j=>i[o].find(Y=>Y.name==j[0]).noStats),...Object.entries(r).filter(j=>!i[o].find(Y=>Y.name==j[0]).noStats)],y=y.map(j=>j[1]),p&&y.reverse());l.lastElementChild;)l.removeChild(l.lastElementChild);if(L||!L&&p)for(let j of y)l.appendChild(j);else for(let j in r)l.appendChild(r[j])}a("listUpdate")})}function D(R,L,F){return i[o].find(j=>j.name==Object.keys(r).find(Y=>r[Y]===(h?F?L:R:F?R:L)))}const W=R=>{t(1,u=R.detail),R.detail&&(t(2,d=!1),t(3,f=!1)),I("filter")},S=R=>{t(2,d=R.detail),R.detail&&(t(1,u=!1),t(3,f=!1)),I("filter")},q=R=>{t(3,f=R.detail),R.detail&&(t(1,u=!1),t(2,d=!1)),I("filter")},z=R=>{R.target.blur();for(let L in b)t(6,b[L]=!0,b);I("filter")},Q=R=>{R.target.blur();for(let L in b)t(6,b[L]=!1,b);I("filter")},N=(R,L)=>{t(6,b[R]=L.detail,b),I("filter")},E=R=>{t(4,h=R.detail),R.detail&&t(5,p=!1),I("sort")},T=R=>{t(5,p=R.detail),R.detail&&t(4,h=!1),I("sort")},$=(R,L)=>{if(t(7,v[R]=L.detail,v),L.detail)for(let F in v)F!=R&&t(7,v[F]=!1,v);I("sort")};return n.$$set=R=>{"optionsOpen"in R&&t(0,s=R.optionsOpen),"slotName"in R&&t(11,o=R.slotName),"elementData"in R&&t(12,r=R.elementData),"list"in R&&t(13,l=R.list)},n.$$.update=()=>{n.$$.dirty[0]&8192&&l&&(y=[...l.children])},[s,u,d,f,h,p,b,v,c,w,I,o,r,l,W,S,q,z,Q,N,E,T,$]}class nm extends Re{constructor(e){super(),De(this,e,tm,em,ge,{optionsOpen:0,slotName:11,elementData:12,list:13},null,[-1,-1])}}function Qr(n,e,t){const i=n.slice();return i[61]=e[t],i}function im(n){let e;return{c(){e=g("span"),e.textContent="Loading items...",m(e,"class","svelte-suojz2")},m(t,i){P(t,e,i)},p:oe,i:oe,o:oe,d(t){t&&A(e)}}}function sm(n){let e,t,i,s,o,r,l,a=n[3]!="sets"&&Xr(n),c=Oe(n[6]),u=[];for(let f=0;f<c.length;f+=1)u[f]=Jr(Qr(n,c,f));const d=f=>H(u[f],1,1,()=>{u[f]=null});return{c(){e=g("input"),t=C(),a&&a.c(),i=C(),s=g("ul");for(let f=0;f<u.length;f+=1)u[f].c();m(e,"type","text"),m(e,"class","searchBarInput"),m(e,"placeholder","Search..."),m(s,"class","svelte-suojz2"),ne(s,"no-scrollbar",n[15].length<=4)},m(f,h){P(f,e,h),n[29](e),P(f,t,h),a&&a.m(f,h),P(f,i,h),P(f,s,h);for(let p=0;p<u.length;p+=1)u[p]&&u[p].m(s,null);n[42](s),o=!0,r||(l=[O(e,"keydown",n[18]),O(e,"input",n[19]),O(s,"mouseup",n[43]),O(s,"touchend",n[44],{passive:!0}),O(s,"scroll",n[45]),O(s,"scrollend",n[46])],r=!0)},p(f,h){if(f[3]!="sets"?a?a.p(f,h):(a=Xr(f),a.c(),a.m(i.parentNode,i)):a&&(a.d(1),a=null),h[0]&1197019){c=Oe(f[6]);let p;for(p=0;p<c.length;p+=1){const b=Qr(f,c,p);u[p]?(u[p].p(b,h),M(u[p],1)):(u[p]=Jr(b),u[p].c(),M(u[p],1),u[p].m(s,null))}for(We(),p=c.length;p<u.length;p+=1)d(p);He()}(!o||h[0]&32768)&&ne(s,"no-scrollbar",f[15].length<=4)},i(f){if(!o){for(let h=0;h<c.length;h+=1)M(u[h]);o=!0}},o(f){u=u.filter(Boolean);for(let h=0;h<u.length;h+=1)H(u[h]);o=!1},d(f){f&&(A(e),A(t),A(i),A(s)),n[29](null),a&&a.d(f),ht(u,f),n[42](null),r=!1,be(l)}}}function Xr(n){let e,t,i;return{c(){e=g("button"),e.innerHTML='<iconify-icon icon="mi:filter"></iconify-icon>',m(e,"class","optionsButton svelte-suojz2")},m(s,o){P(s,e,o),n[30](e),t||(i=O(e,"click",n[31]),t=!0)},p:oe,d(s){s&&A(e),n[30](null),t=!1,i()}}}function om(n){let e,t,i,s;function o(a){n[39](a)}function r(a){n[40](a)}let l={itemData:n[61],eqSlotName:n[3]};return n[0]!==void 0&&(l.slotOpen=n[0]),n[9]!==void 0&&(l.scrolling=n[9]),e=new W_({props:l}),ae.push(()=>Me(e,"slotOpen",o)),ae.push(()=>Me(e,"scrolling",r)),e.$on("itemSelect",n[20]),e.$on("displayInfo",n[41]),{c(){le(e.$$.fragment)},m(a,c){ie(e,a,c),s=!0},p(a,c){const u={};c[0]&64&&(u.itemData=a[61]),c[0]&8&&(u.eqSlotName=a[3]),!t&&c[0]&1&&(t=!0,u.slotOpen=a[0],Pe(()=>t=!1)),!i&&c[0]&512&&(i=!0,u.scrolling=a[9],Pe(()=>i=!1)),e.$set(u)},i(a){s||(M(e.$$.fragment,a),s=!0)},o(a){H(e.$$.fragment,a),s=!1},d(a){se(e,a)}}}function rm(n){let e,t,i;function s(r){n[37](r)}let o={itemData:n[61]};return n[0]!==void 0&&(o.ddOpen=n[0]),e=new X_({props:o}),ae.push(()=>Me(e,"ddOpen",s)),e.$on("setSelect",n[38]),{c(){le(e.$$.fragment)},m(r,l){ie(e,r,l),i=!0},p(r,l){const a={};l[0]&64&&(a.itemData=r[61]),!t&&l[0]&1&&(t=!0,a.ddOpen=r[0],Pe(()=>t=!1)),e.$set(a)},i(r){i||(M(e.$$.fragment,r),i=!0)},o(r){H(e.$$.fragment,r),i=!1},d(r){se(e,r)}}}function lm(n){let e,t,i,s,o;function r(u){n[32](u)}function l(u){n[33](u)}function a(u){n[34](u)}let c={itemData:n[61],index:n[4]};return n[0]!==void 0&&(c.slotOpen=n[0]),n[1]!==void 0&&(c.weaponExpand=n[1]),n[9]!==void 0&&(c.scrolling=n[9]),e=new V_({props:c}),ae.push(()=>Me(e,"slotOpen",r)),ae.push(()=>Me(e,"weaponExpand",l)),ae.push(()=>Me(e,"scrolling",a)),e.$on("itemSelect",n[20]),e.$on("toolSelect",n[35]),e.$on("displayInfo",n[36]),{c(){le(e.$$.fragment)},m(u,d){ie(e,u,d),o=!0},p(u,d){const f={};d[0]&64&&(f.itemData=u[61]),d[0]&16&&(f.index=u[4]),!t&&d[0]&1&&(t=!0,f.slotOpen=u[0],Pe(()=>t=!1)),!i&&d[0]&2&&(i=!0,f.weaponExpand=u[1],Pe(()=>i=!1)),!s&&d[0]&512&&(s=!0,f.scrolling=u[9],Pe(()=>s=!1)),e.$set(f)},i(u){o||(M(e.$$.fragment,u),o=!0)},o(u){H(e.$$.fragment,u),o=!1},d(u){se(e,u)}}}function Jr(n){let e,t,i,s;const o=[lm,rm,om],r=[];function l(a,c){return a[4]?0:a[3]=="sets"?1:2}return e=l(n),t=r[e]=o[e](n),{c(){t.c(),i=pt()},m(a,c){r[e].m(a,c),P(a,i,c),s=!0},p(a,c){let u=e;e=l(a),e===u?r[e].p(a,c):(We(),H(r[u],1,1,()=>{r[u]=null}),He(),t=r[e],t?t.p(a,c):(t=r[e]=o[e](a),t.c()),M(t,1),t.m(i.parentNode,i))},i(a){s||(M(t),s=!0)},o(a){H(t),s=!1},d(a){a&&A(i),r[e].d(a)}}}function Zr(n){let e,t,i,s;function o(a){n[47](a)}function r(a){n[48](a)}let l={slotName:n[3],elementData:n[16]};return n[2]!==void 0&&(l.optionsOpen=n[2]),n[5]!==void 0&&(l.list=n[5]),e=new nm({props:l}),ae.push(()=>Me(e,"optionsOpen",o)),ae.push(()=>Me(e,"list",r)),e.$on("listUpdate",n[19]),{c(){le(e.$$.fragment)},m(a,c){ie(e,a,c),s=!0},p(a,c){const u={};c[0]&8&&(u.slotName=a[3]),c[0]&65536&&(u.elementData=a[16]),!t&&c[0]&4&&(t=!0,u.optionsOpen=a[2],Pe(()=>t=!1)),!i&&c[0]&32&&(i=!0,u.list=a[5],Pe(()=>i=!1)),e.$set(u)},i(a){s||(M(e.$$.fragment,a),s=!0)},o(a){H(e.$$.fragment,a),s=!1},d(a){se(e,a)}}}function am(n){let e,t,i,s,o,r,l;const a=[sm,im],c=[];function u(f,h){return f[6]?0:1}t=u(n),i=c[t]=a[t](n);let d=n[3]!="sets"&&Zr(n);return{c(){e=g("div"),i.c(),s=C(),d&&d.c(),m(e,"class","dropdown svelte-suojz2"),ne(e,"infoDisplay",n[7])},m(f,h){P(f,e,h),c[t].m(e,null),_(e,s),d&&d.m(e,null),n[49](e),o=!0,r||(l=[O(window,"keydown",n[26]),O(window,"keyup",n[27]),O(window,"mousedown",n[28]),O(e,"transitionend",n[50]),O(e,"transitioncancel",n[51])],r=!0)},p(f,h){let p=t;t=u(f),t===p?c[t].p(f,h):(We(),H(c[p],1,1,()=>{c[p]=null}),He(),i=c[t],i?i.p(f,h):(i=c[t]=a[t](f),i.c()),M(i,1),i.m(e,s)),f[3]!="sets"?d?(d.p(f,h),h[0]&8&&M(d,1)):(d=Zr(f),d.c(),M(d,1),d.m(e,null)):d&&(We(),H(d,1,1,()=>{d=null}),He()),(!o||h[0]&128)&&ne(e,"infoDisplay",f[7])},i(f){o||(M(i),M(d),o=!0)},o(f){H(i),H(d),o=!1},d(f){f&&A(e),c[t].d(),d&&d.d(),n[49](null),r=!1,be(l)}}}function cm(n,e,t){let i,s,o,r,l,a,c,u,d;X(n,Mt,Z=>t(22,o=Z)),X(n,Bn,Z=>t(23,r=Z)),X(n,Lu,Z=>t(24,l=Z)),X(n,qn,Z=>t(25,a=Z)),X(n,Tt,Z=>t(54,c=Z)),X(n,jt,Z=>t(55,u=Z)),X(n,Lt,Z=>t(56,d=Z));let{slotName:f,index:h=0,slotOpen:p,weaponExpand:b=null,optionsOpen:v=!1}=e;const w=Ht();h?G(qn,a[h]={},a):G(Bn,r[f]={},r);let k=!1,y=!1,I=!1,D,W,S,q,z,Q=null,N=!1,E=!1,T=[];function $(){z&&z.classList.remove("lastElement"),t(15,T=S.querySelectorAll("li:not(.hidden)")),z=T[T.length-1],z&&z.classList.add("lastElement"),(!z||z.classList.contains("non-eligible"))&&(z=q)}function R(Z){!Z.shiftKey&&Z.key=="Tab"&&!v&&(Z.preventDefault(),setTimeout(()=>W.focus()))}function L(){z&&z.removeEventListener("keydown",R),$(),z&&z.addEventListener("keydown",R)}function F(Z){Z.shiftKey&&Z.key=="Tab"&&(Z.preventDefault(),setTimeout(()=>(z.querySelector("button")||z).focus()))}function j(){lu(W.value,i),L()}function Y(Z){w("itemSelect",Z.detail.element),t(13,Q=Z.detail.element),N=Z.detail.trusted;let Sn=S.querySelector(".selectedItem");Sn&&Sn!=Z.detail.element&&Sn.classList.remove("selectedItem"),t(14,E=!0),N||(te(),S.scrollTo(0,Q.offsetTop)),setTimeout(fe)}function fe(){G(Tt,c=structuredClone(P_),c);for(let Z in d)d[Z].cost.min!=null&&(G(Tt,c.armor.min+=d[Z].cost.min,c),G(Tt,c.armor.max+=d[Z].cost.max,c));G(Tt,c.armor.avg=Math.ceil((c.armor.min+c.armor.max)/2),c);for(let Z in u)u[Z].cost.min!=null&&(G(Tt,c.gear.min+=u[Z].cost.min,c),G(Tt,c.gear.max+=u[Z].cost.max,c));G(Tt,c.gear.avg=Math.ceil((c.gear.min+c.gear.max)/2),c),G(Tt,c.total.min=c.armor.min+c.gear.min,c),G(Tt,c.total.max=c.armor.max+c.gear.max,c),G(Tt,c.total.avg=Math.ceil((c.total.min+c.total.max)/2),c)}function te(){t(14,E=!1),t(11,W.value="",W),j()}const re=Z=>{f!="sets"&&!k&&Z.shiftKey&&t(7,k=!0)},B=Z=>{f!="sets"&&Z.key=="Shift"&&!y&&t(7,k=!1)},J=()=>(t(7,k=!1),t(8,y=!1));function de(Z){ae[Z?"unshift":"push"](()=>{W=Z,t(11,W)})}function qe(Z){ae[Z?"unshift":"push"](()=>{q=Z,t(12,q)})}const ve=()=>t(2,v=!v);function Ie(Z){p=Z,t(0,p)}function nt(Z){b=Z,t(1,b)}function st(Z){I=Z,t(9,I)}const Le=()=>w("toolSelect"),ue=()=>(t(7,k=!0),t(8,y=!0));function pe(Z){p=Z,t(0,p)}const $e=()=>t(14,E=!0);function Je(Z){p=Z,t(0,p)}function Nt(Z){I=Z,t(9,I)}const V=()=>(t(7,k=!0),t(8,y=!0));function Te(Z){ae[Z?"unshift":"push"](()=>{S=Z,t(5,S)})}const _e=()=>t(7,k=!1),U=()=>t(7,k=!1),Ne=()=>t(9,I=!0),ze=()=>t(9,I=!1);function je(Z){v=Z,t(2,v)}function Fe(Z){S=Z,t(5,S)}function Ue(Z){ae[Z?"unshift":"push"](()=>{D=Z,t(10,D)})}const Ve=Z=>{Z.propertyName=="visibility"&&Z.target==D&&(E&&te(),!p&&Q&&setTimeout(()=>S.scrollTo(0,Q.offsetTop)),es(W,p))},un=Z=>{Z.propertyName=="visibility"&&Z.target==D&&(t(14,E=!1),es(W,p))};return n.$$set=Z=>{"slotName"in Z&&t(3,f=Z.slotName),"index"in Z&&t(4,h=Z.index),"slotOpen"in Z&&t(0,p=Z.slotOpen),"weaponExpand"in Z&&t(1,b=Z.weaponExpand),"optionsOpen"in Z&&t(2,v=Z.optionsOpen)},n.$$.update=()=>{if(n.$$.dirty[0]&58720280&&t(16,i=h?a[h]:f=="sets"?l:r[f]),n.$$.dirty[0]&4194312&&t(6,s=o[f]),n.$$.dirty[0]&96&&S){t(15,T=S.querySelectorAll("li:not(.hidden)"));for(let Z=0;Z<S.childElementCount;Z++)t(16,i[s[Z].name]=S.children[Z],i);$(),L()}},[p,b,v,f,h,S,s,k,y,I,D,W,q,Q,E,T,i,w,F,j,Y,te,o,r,l,a,re,B,J,de,qe,ve,Ie,nt,st,Le,ue,pe,$e,Je,Nt,V,Te,_e,U,Ne,ze,je,Fe,Ue,Ve,un]}class Ko extends Re{constructor(e){super(),De(this,e,cm,am,ge,{slotName:3,index:4,slotOpen:0,weaponExpand:1,optionsOpen:2},null,[-1,-1,-1])}}function xr(n){let e,t,i,s,o,r,l=n[1].name+"",a,c,u,d,f;return{c(){e=g("button"),t=g("img"),o=C(),r=g("span"),a=ce(l),tt(t.src,i=n[1].image)||m(t,"src",i),m(t,"alt",s=n[1].name),m(t,"draggable","false"),m(t,"class","svelte-nknpqm"),m(r,"class","tooltip"),m(r,"id","left"),m(e,"class","svelte-nknpqm"),it(e,"display",n[1].link?"":"none")},m(h,p){P(h,e,p),_(e,t),_(e,o),_(e,r),_(r,a),u=!0,d||(f=[O(e,"click",n[13]),O(e,"focusin",n[14]),O(e,"outroend",n[15])],d=!0)},p(h,p){(!u||p&2&&!tt(t.src,i=h[1].image))&&m(t,"src",i),(!u||p&2&&s!==(s=h[1].name))&&m(t,"alt",s),(!u||p&2)&&l!==(l=h[1].name+"")&&Se(a,l),p&2&&it(e,"display",h[1].link?"":"none")},i(h){u||(h&&we(()=>{u&&(c||(c=me(e,Ze,{duration:150},!0)),c.run(1))}),u=!0)},o(h){h&&(c||(c=me(e,Ze,{duration:150},!1)),c.run(0)),u=!1},d(h){h&&A(e),h&&c&&c.end(),d=!1,be(f)}}}function um(n){let e,t,i=n[1],s,o,r=n[0].charAt(0).toUpperCase()+n[0].slice(1)+"",l,a,c,u,d,f,h,p,b,v,w,k,y=xr(n);function I(S){n[19](S)}function D(S){n[20](S)}let W={slotName:n[0]};return n[4]!==void 0&&(W.slotOpen=n[4]),n[6]!==void 0&&(W.optionsOpen=n[6]),h=new Ko({props:W}),ae.push(()=>Me(h,"slotOpen",I)),ae.push(()=>Me(h,"optionsOpen",D)),h.$on("itemSelect",n[21]),{c(){e=g("div"),t=g("div"),y.c(),s=C(),o=g("button"),l=ce(r),a=C(),c=g("iconify-icon"),u=C(),d=g("button"),d.innerHTML='<iconify-icon icon="maki:cross" class="svelte-nknpqm"></iconify-icon> <span class="tooltip" id="top">Clear selection</span>',f=C(),le(h.$$.fragment),m(t,"class","eqSlotIcon ff-border svelte-nknpqm"),Ae(c,"icon","iconamoon:arrow-down-2-fill"),Ae(c,"class","svelte-nknpqm"),m(o,"class","ddButton svelte-nknpqm"),m(d,"class","clearButton svelte-nknpqm"),m(e,"class","eqSlotCont svelte-nknpqm"),ne(e,"slotOpen",n[4]),ne(e,"clearAllowed",n[5]&&n[7])},m(S,q){P(S,e,q),_(e,t),y.m(t,null),n[16](t),_(e,s),_(e,o),_(o,l),_(o,a),_(o,c),_(e,u),_(e,d),_(e,f),ie(h,e,null),n[22](e),v=!0,w||(k=[O(window,"mousedown",n[11]),O(window,"keydown",n[12]),O(o,"click",n[17]),O(d,"click",n[18]),O(e,"mouseenter",n[23]),O(e,"mouseleave",n[24])],w=!0)},p(S,[q]){q&2&&ge(i,i=S[1])?(We(),H(y,1,1,oe),He(),y=xr(S),y.c(),M(y,1),y.m(t,null)):y.p(S,q),(!v||q&1)&&r!==(r=S[0].charAt(0).toUpperCase()+S[0].slice(1)+"")&&Se(l,r);const z={};q&1&&(z.slotName=S[0]),!p&&q&16&&(p=!0,z.slotOpen=S[4],Pe(()=>p=!1)),!b&&q&64&&(b=!0,z.optionsOpen=S[6],Pe(()=>b=!1)),h.$set(z),(!v||q&16)&&ne(e,"slotOpen",S[4]),(!v||q&160)&&ne(e,"clearAllowed",S[5]&&S[7])},i(S){v||(M(y),M(h.$$.fragment,S),v=!0)},o(S){H(y),H(h.$$.fragment,S),v=!1},d(S){S&&A(e),y.d(S),n[16](null),se(h),n[22](null),w=!1,be(k)}}}function dm(n,e,t){let i,s,o;X(n,Lt,E=>t(10,i=E)),X(n,bn,E=>t(8,s=E)),X(n,x,E=>t(9,o=E));let{eqSlotName:r}=e,l,a,c=vs,u,d,f,h;const p=E=>{(!l.contains(E.target)&&!s||E.target==l||E.target==a)&&(t(4,u=!1),t(6,f=!1),E.target!=l&&E.target!=a&&t(5,d=!1))},b=E=>{E.key=="Tab"?setTimeout(()=>{t(5,d=l.contains(document.activeElement))}):E.key=="Escape"&&(t(4,u=!1),t(6,f=!1))},v=()=>{s||(t(4,u=!1),G(x,o.item.ongoing=!0,o),G(x,o.item.data={...c,slot:r,type:"eq"},o))},w=E=>{E.relatedTarget==null&&t(5,d=!0)},k=()=>{setTimeout(()=>F_(a))};function y(E){ae[E?"unshift":"push"](()=>{a=E,t(3,a)})}const I=()=>{o.screenshot.ongoing||t(4,u=!u)},D=()=>{t(5,d=!1),l.classList.contains("clearAllowed")&&h.querySelector("button").click()};function W(E){u=E,t(4,u)}function S(E){f=E,t(6,f)}const q=E=>{setTimeout(()=>{t(7,h=E.detail.classList.contains("selectedItem")?E.detail:null),t(6,f=!1)})};function z(E){ae[E?"unshift":"push"](()=>{l=E,t(2,l)})}const Q=()=>t(5,d=!0),N=()=>{l.contains(document.activeElement)||t(5,d=!1)};return n.$$set=E=>{"eqSlotName"in E&&t(0,r=E.eqSlotName)},n.$$.update=()=>{n.$$.dirty&1027&&i[r]&&i[r].name!=c.name&&t(1,c=i[r])},[r,c,l,a,u,d,f,h,s,o,i,p,b,v,w,k,y,I,D,W,S,q,z,Q,N]}class fm extends Re{constructor(e){super(),De(this,e,dm,um,ge,{eqSlotName:0})}}function $r(n,e,t){const i=n.slice();return i[1]=e[t],i[2]=e,i[3]=t,i}function el(n){let e,t,i;function s(r){n[0](r,n[1],n[2],n[3])}let o={};return n[1]!==void 0&&(o.eqSlotName=n[1]),e=new fm({props:o}),ae.push(()=>Me(e,"eqSlotName",s)),{c(){le(e.$$.fragment)},m(r,l){ie(e,r,l),i=!0},p(r,l){n=r;const a={};!t&&l&0&&(t=!0,a.eqSlotName=n[1],Pe(()=>t=!1)),e.$set(a)},i(r){i||(M(e.$$.fragment,r),i=!0)},o(r){H(e.$$.fragment,r),i=!1},d(r){se(e,r)}}}function hm(n){let e,t,i=Oe(Array(...Un)),s=[];for(let r=0;r<i.length;r+=1)s[r]=el($r(n,i,r));const o=r=>H(s[r],1,1,()=>{s[r]=null});return{c(){e=g("div");for(let r=0;r<s.length;r+=1)s[r].c();m(e,"class","armorBox svelte-35g1a3")},m(r,l){P(r,e,l);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null);t=!0},p(r,[l]){if(l&0){i=Oe(Array(...Un));let a;for(a=0;a<i.length;a+=1){const c=$r(r,i,a);s[a]?(s[a].p(c,l),M(s[a],1)):(s[a]=el(c),s[a].c(),M(s[a],1),s[a].m(e,null))}for(We(),a=i.length;a<s.length;a+=1)o(a);He()}},i(r){if(!t){for(let l=0;l<i.length;l+=1)M(s[l]);t=!0}},o(r){s=s.filter(Boolean);for(let l=0;l<s.length;l+=1)H(s[l]);t=!1},d(r){r&&A(e),ht(s,r)}}}function pm(n,e,t){function i(s,o,r,l){r[l]=s}return[i]}class _m extends Re{constructor(e){super(),De(this,e,pm,hm,ge,{})}}function mm(n){let e,t=(n[3]?`${Math.floor(n[5]*.675+19.8)}% Reduction`:n[5])+"",i,s,o;return{c(){e=g("span"),i=ce(t),m(e,"class","statValue svelte-gx367h"),m(e,"tabindex","0"),ne(e,"hidden",n[2]),ne(e,"negative",n[5]<0),ne(e,"zero",n[5]==0),ne(e,"reduction",n[3])},m(r,l){P(r,e,l),_(e,i),s||(o=[O(e,"mouseenter",n[11]),O(e,"mouseleave",n[12]),O(e,"focusin",n[13]),O(e,"focusout",n[14])],s=!0)},p(r,l){l&40&&t!==(t=(r[3]?`${Math.floor(r[5]*.675+19.8)}% Reduction`:r[5])+"")&&Se(i,t),l&4&&ne(e,"hidden",r[2]),l&32&&ne(e,"negative",r[5]<0),l&32&&ne(e,"zero",r[5]==0),l&8&&ne(e,"reduction",r[3])},d(r){r&&A(e),s=!1,be(o)}}}function gm(n){let e,t=(n[0]!="endurance"?n[5]:n[5].toFixed(2))+"",i;return{c(){e=g("span"),i=ce(t),m(e,"class","statValue svelte-gx367h"),ne(e,"hidden",n[2]),ne(e,"negative",n[5]<0),ne(e,"zero",n[5]==0)},m(s,o){P(s,e,o),_(e,i)},p(s,o){o&33&&t!==(t=(s[0]!="endurance"?s[5]:s[5].toFixed(2))+"")&&Se(i,t),o&4&&ne(e,"hidden",s[2]),o&32&&ne(e,"negative",s[5]<0),o&32&&ne(e,"zero",s[5]==0)},d(s){s&&A(e)}}}function bm(n){let e;return{c(){e=g("iconify-icon"),Ae(e,"icon","codicon:sparkle-filled"),Ae(e,"class","svelte-gx367h")},m(t,i){P(t,e,i)},p:oe,d(t){t&&A(e)}}}function vm(n){let e,t=`${n[1]} Bonus`,i;return{c(){e=g("span"),i=ce(t),m(e,"class","statName svelte-gx367h")},m(s,o){P(s,e,o),_(e,i)},p(s,o){o&2&&t!==(t=`${s[1]} Bonus`)&&Se(i,t)},d(s){s&&A(e)}}}function ym(n){let e,t,i,s,o,r,l;function a(p,b){return p[0]!="armor"?gm:mm}let c=a(n),u=c(n);function d(p,b){if(p[2])return vm;if(p[4])return bm}let f=d(n),h=f&&f(n);return{c(){e=g("div"),t=g("img"),s=C(),u.c(),o=C(),h&&h.c(),tt(t.src,i="stats/"+n[0]+".svg")||m(t,"src",i),m(t,"alt",n[1]),m(t,"class","svelte-gx367h"),m(e,"id",n[0]),m(e,"class","svelte-gx367h"),ne(e,"hidden",n[5]==0)},m(p,b){P(p,e,b),_(e,t),_(e,s),u.m(e,null),_(e,o),h&&h.m(e,null),r||(l=[O(t,"mouseenter",n[9]),O(t,"mouseleave",n[10])],r=!0)},p(p,[b]){b&1&&!tt(t.src,i="stats/"+p[0]+".svg")&&m(t,"src",i),b&2&&m(t,"alt",p[1]),c===(c=a(p))&&u?u.p(p,b):(u.d(1),u=c(p),u&&(u.c(),u.m(e,o))),f===(f=d(p))&&h?h.p(p,b):(h&&h.d(1),h=f&&f(p),h&&(h.c(),h.m(e,null))),b&1&&m(e,"id",p[0]),b&32&&ne(e,"hidden",p[5]==0)},i:oe,o:oe,d(p){p&&A(e),u.d(),h&&h.d(),r=!1,be(l)}}}function wm(n,e,t){let i,s,o,r;X(n,Mt,k=>t(6,s=k)),X(n,Pn,k=>t(7,o=k)),X(n,gt,k=>t(8,r=k));let{codeName:l,formalName:a}=e,c,u,d=!1;const f=()=>t(2,c=!0),h=()=>t(2,c=!1),p=()=>t(3,u=!0),b=()=>t(3,u=!1),v=()=>t(3,u=!0),w=()=>t(3,u=!1);return n.$$set=k=>{"codeName"in k&&t(0,l=k.codeName),"formalName"in k&&t(1,a=k.formalName)},n.$$.update=()=>{if(n.$$.dirty&257&&t(5,i=r[l]),n.$$.dirty&193)for(let k in o)if(o[k]&&s.bonuses.find(y=>y.name==k).stats[l]!=0){t(4,d=!0);break}else t(4,d=!1)},[l,a,c,u,d,i,s,o,r,f,h,p,b,v,w]}class km extends Re{constructor(e){super(),De(this,e,wm,ym,ge,{codeName:0,formalName:1})}}function tl(n,e,t){const i=n.slice();return i[8]=e[t][0],i[9]=e[t][1],i[10]=e,i[11]=t,i}function nl(n){let e,t,i,s;function o(a){n[4](a,n[8],n[10],n[11])}function r(a){n[5](a,n[9],n[10],n[11])}let l={};return n[8]!==void 0&&(l.codeName=n[8]),n[9]!==void 0&&(l.formalName=n[9]),e=new km({props:l}),ae.push(()=>Me(e,"codeName",o)),ae.push(()=>Me(e,"formalName",r)),{c(){le(e.$$.fragment)},m(a,c){ie(e,a,c),s=!0},p(a,c){n=a;const u={};!t&&c&0&&(t=!0,u.codeName=n[8],Pe(()=>t=!1)),!i&&c&0&&(i=!0,u.formalName=n[9],Pe(()=>i=!1)),e.$set(u)},i(a){s||(M(e.$$.fragment,a),s=!0)},o(a){H(e.$$.fragment,a),s=!1},d(a){se(e,a)}}}function il(n){let e,t,i,s,o=n[2]?"Copied!":`Copy ${n[1]?"all":""} as text`,r,l,a,c,u;return{c(){e=g("button"),t=g("iconify-icon"),i=C(),s=g("span"),r=ce(o),Ae(t,"icon","ic:round-content-copy"),Ae(t,"class","svelte-hth2ds"),m(s,"class","tooltip"),m(s,"id","top"),m(e,"class","copyStatsButton svelte-hth2ds")},m(d,f){P(d,e,f),_(e,t),_(e,i),_(e,s),_(s,r),a=!0,c||(u=O(e,"click",n[6]),c=!0)},p(d,f){(!a||f&6)&&o!==(o=d[2]?"Copied!":`Copy ${d[1]?"all":""} as text`)&&Se(r,o)},i(d){a||(d&&we(()=>{a&&(l||(l=me(e,Ze,{duration:100},!0)),l.run(1))}),a=!0)},o(d){d&&(l||(l=me(e,Ze,{duration:100},!1)),l.run(0)),a=!1},d(d){d&&A(e),d&&l&&l.end(),c=!1,u()}}}function Cm(n){let e;return{c(){e=g("span"),e.textContent="Show all stats",m(e,"slot","tooltip"),m(e,"class","tooltip"),m(e,"id","top")},m(t,i){P(t,e,i)},p:oe,d(t){t&&A(e)}}}function Em(n){let e,t,i,s,o,r=Oe(Object.entries(Ft)),l=[];for(let u=0;u<r.length;u+=1)l[u]=nl(tl(n,r,u));const a=u=>H(l[u],1,1,()=>{l[u]=null});let c=n[3]&&il(n);return s=new mt({props:{text:"",$$slots:{tooltip:[Cm]},$$scope:{ctx:n}}}),s.$on("toggle",n[7]),{c(){e=g("div");for(let u=0;u<l.length;u+=1)l[u].c();t=C(),c&&c.c(),i=C(),le(s.$$.fragment),m(e,"class","statBox svelte-hth2ds"),ne(e,"showAll",n[1])},m(u,d){P(u,e,d);for(let f=0;f<l.length;f+=1)l[f]&&l[f].m(e,null);_(e,t),c&&c.m(e,null),_(e,i),ie(s,e,null),o=!0},p(u,[d]){if(d&0){r=Oe(Object.entries(Ft));let h;for(h=0;h<r.length;h+=1){const p=tl(u,r,h);l[h]?(l[h].p(p,d),M(l[h],1)):(l[h]=nl(p),l[h].c(),M(l[h],1),l[h].m(e,t))}for(We(),h=r.length;h<l.length;h+=1)a(h);He()}u[3]?c?(c.p(u,d),d&8&&M(c,1)):(c=il(u),c.c(),M(c,1),c.m(e,i)):c&&(We(),H(c,1,1,()=>{c=null}),He());const f={};d&4096&&(f.$$scope={dirty:d,ctx:u}),s.$set(f),(!o||d&2)&&ne(e,"showAll",u[1])},i(u){if(!o){for(let d=0;d<r.length;d+=1)M(l[d]);M(c),M(s.$$.fragment,u),o=!0}},o(u){l=l.filter(Boolean);for(let d=0;d<l.length;d+=1)H(l[d]);H(c),H(s.$$.fragment,u),o=!1},d(u){u&&A(e),ht(l,u),c&&c.d(),se(s)}}}function Sm(n,e,t){let i;X(n,gt,d=>t(0,i=d));let s=!1,o=!1,r=!1;function l(d,f,h,p){h[p][0]=d}function a(d,f,h,p){h[p][1]=d}const c=d=>{if(nn(d),o)return;let f="";for(let[h,p]of Object.entries(Ft)){let b=h=="armor"?"":`
`,v=i[h];h=="armor"?v+=` (${Math.floor(v*.675+19.8)}% Reduction)`:h=="endurance"?v=v.toFixed(2)+"%":h=="ammoReturn"&&(v+="%"),(s||!s&&i[h])&&(f+=`${b}${p}: ${v}`)}navigator.clipboard.writeText(f),t(2,o=!0),setTimeout(()=>t(2,o=!1),1e3)},u=d=>t(1,s=d.detail);return n.$$.update=()=>{if(n.$$.dirty&1&&i){t(3,r=!1);for(let d in i)if(i[d]){t(3,r=!0);break}}},[i,s,o,r,l,a,c,u]}class Im extends Re{constructor(e){super(),De(this,e,Sm,Em,ge,{})}}function Tm(n){let e,t,i,s,o,r,l,a,c,u;return{c(){e=g("div"),t=g("button"),t.textContent="-",i=C(),s=g("input"),o=C(),r=g("b"),r.textContent="%",l=C(),a=g("button"),a.textContent="+",m(t,"id","decrease"),m(t,"class","svelte-1m4n74o"),m(s,"type","number"),m(s,"placeholder","0"),m(s,"class","svelte-1m4n74o"),m(r,"class","svelte-1m4n74o"),m(a,"id","increase"),m(a,"class","svelte-1m4n74o"),m(e,"class","svelte-1m4n74o"),ne(e,"non-percent",!n[1])},m(d,f){P(d,e,f),_(e,t),_(e,i),_(e,s),qt(s,n[0]),_(e,o),_(e,r),_(e,l),_(e,a),c||(u=[O(t,"click",n[4]),O(s,"input",n[5]),O(s,"input",n[2]),O(a,"click",n[6])],c=!0)},p(d,[f]){f&1&&ua(s.value)!==d[0]&&qt(s,d[0])},i:oe,o:oe,d(d){d&&A(e),c=!1,be(u)}}}function Nm(n,e,t){let{weaponName:i,value:s}=e,o=i!="Nature's Wrath Spellbook",r;o?(s=100,r=100):(s=4,r=4);function l(){s<0?t(0,s=0):s>r&&t(0,s=r),s%1!=0&&t(0,s=Math.floor(s))}const a=()=>{t(0,s--,s),l()};function c(){s=ua(this.value),t(0,s)}const u=()=>{t(0,s++,s),l()};return n.$$set=d=>{"weaponName"in d&&t(3,i=d.weaponName),"value"in d&&t(0,s=d.value)},[s,o,l,i,a,c,u]}class Om extends Re{constructor(e){super(),De(this,e,Nm,Tm,ge,{weaponName:3,value:0})}}function sl(n,e,t){const i=n.slice();i[53]=e[t];const s=i[53].name.includes("Fantastic Beamstorm")?"~":"";i[23]=s;const o=i[24].includes(i[53].name);return i[54]=o,i}function Dm(n){let e,t,i=n[2].description+"",s,o;return{c(){e=g("span"),t=ce('"'),s=ce(i),o=ce('"'),m(e,"id","toolDesc"),m(e,"class","svelte-1tlszo6")},m(r,l){P(r,e,l),_(e,t),_(e,s),_(e,o)},p(r,l){l[0]&4&&i!==(i=r[2].description+"")&&Se(s,i)},d(r){r&&A(e)}}}function Rm(n){let e,t,i,s=`${n[5]?"Type":n[3].name}:`,o,r,l=n[20],a,c,u,d,f,h=n[5]?"Return":"Expand",p,b,v,w,k=rl(n),y=n[4]&&ll(n);return{c(){e=g("button"),t=g("div"),i=g("span"),o=ce(s),r=C(),k.c(),c=C(),y&&y.c(),u=C(),d=g("span"),f=ce("("),p=ce(h),b=ce(")"),m(i,"class","svelte-1tlszo6"),it(i,"font-size",Object.keys(n[21]).includes(n[3].name)?`calc(var(--u) * ${n[21][n[3].name]})`:""),m(t,"id",a=n[5]?"":"basic"),m(t,"class","svelte-1tlszo6"),m(d,"class","tooltip svelte-1tlszo6"),m(d,"id","top"),m(e,"class","gearPreview svelte-1tlszo6"),it(e,"line-height",`${n[10]/6.5}px`)},m(I,D){P(I,e,D),_(e,t),_(t,i),_(i,o),_(t,r),k.m(t,null),_(e,c),y&&y.m(e,null),_(e,u),_(e,d),_(d,f),_(d,p),_(d,b),n[36](e),v||(w=O(e,"click",n[37]),v=!0)},p(I,D){D[0]&40&&s!==(s=`${I[5]?"Type":I[3].name}:`)&&Se(o,s),D[0]&2097160&&it(i,"font-size",Object.keys(I[21]).includes(I[3].name)?`calc(var(--u) * ${I[21][I[3].name]})`:""),D[0]&1048576&&ge(l,l=I[20])?(k.d(1),k=rl(I),k.c(),k.m(t,null)):k.p(I,D),D[0]&32&&a!==(a=I[5]?"":"basic")&&m(t,"id",a),I[4]?y?y.p(I,D):(y=ll(I),y.c(),y.m(e,u)):y&&(y.d(1),y=null),D[0]&32&&h!==(h=I[5]?"Return":"Expand")&&Se(p,h),D[0]&1024&&it(e,"line-height",`${I[10]/6.5}px`)},d(I){I&&A(e),k.d(I),y&&y.d(),n[36](null),v=!1,w()}}}function ol(n){let e;return{c(){e=g("iconify-icon"),Ae(e,"icon","codicon:sparkle-filled"),Ae(e,"class","svelte-1tlszo6")},m(t,i){P(t,e,i)},d(t){t&&A(e)}}}function rl(n){let e,t,i=(n[5]?n[2].info.type.replace("/","<b>,</b><br/>"):n[26](n[3]))+"",s,o=!n[5]&&n[6].basic&&ol();return{c(){e=g("span"),t=new Eu(!1),s=C(),o&&o.c(),t.a=s,m(e,"class","svelte-1tlszo6")},m(r,l){P(r,e,l),t.m(i,e),_(e,s),o&&o.m(e,null)},p(r,l){l[0]&44&&i!==(i=(r[5]?r[2].info.type.replace("/","<b>,</b><br/>"):r[26](r[3]))+"")&&t.p(i),!r[5]&&r[6].basic?o||(o=ol(),o.c(),o.m(e,null)):o&&(o.d(1),o=null)},d(r){r&&A(e),o&&o.d()}}}function ll(n){let e,t,i=`${n[5]?"Special":n[4].name.split(" (")[0]}:`,s,o,r=n[20],l,a=ul(n);return{c(){e=g("div"),t=g("span"),s=ce(i),o=C(),a.c(),m(t,"class","svelte-1tlszo6"),it(t,"font-size",Object.keys(n[21]).includes(n[4].name)?`calc(var(--u) * ${n[21][n[4].name]})`:""),m(e,"id",l=n[5]?"":"special"),m(e,"class","svelte-1tlszo6")},m(c,u){P(c,e,u),_(e,t),_(t,s),_(e,o),a.m(e,null)},p(c,u){u[0]&48&&i!==(i=`${c[5]?"Special":c[4].name.split(" (")[0]}:`)&&Se(s,i),u[0]&2097168&&it(t,"font-size",Object.keys(c[21]).includes(c[4].name)?`calc(var(--u) * ${c[21][c[4].name]})`:""),u[0]&1048576&&ge(r,r=c[20])?(a.d(1),a=ul(c),a.c(),a.m(e,null)):a.p(c,u),u[0]&32&&l!==(l=c[5]?"":"special")&&m(e,"id",l)},d(c){c&&A(e),a.d(c)}}}function al(n){let e,t;return{c(){e=g("span"),t=ce(n[23]),m(e,"id","prefix"),m(e,"class","svelte-1tlszo6")},m(i,s){P(i,e,s),_(e,t)},p(i,s){s[0]&8388608&&Se(t,i[23])},d(i){i&&A(e)}}}function cl(n){let e;return{c(){e=g("iconify-icon"),Ae(e,"icon","codicon:sparkle-filled"),Ae(e,"class","svelte-1tlszo6")},m(t,i){P(t,e,i)},d(t){t&&A(e)}}}function ul(n){let e,t,i=(n[5]?n[2].info.special:n[26](n[4]))+"",s,o,r=n[23]&&!n[5]&&al(n),l=!n[5]&&n[6].special&&cl();return{c(){e=g("span"),r&&r.c(),t=C(),s=ce(i),o=C(),l&&l.c(),m(e,"class","svelte-1tlszo6")},m(a,c){P(a,e,c),r&&r.m(e,null),_(e,t),_(e,s),_(e,o),l&&l.m(e,null)},p(a,c){a[23]&&!a[5]?r?r.p(a,c):(r=al(a),r.c(),r.m(e,t)):r&&(r.d(1),r=null),c[0]&52&&i!==(i=(a[5]?a[2].info.special:a[26](a[4]))+"")&&Se(s,i),!a[5]&&a[6].special?l||(l=cl(),l.c(),l.m(e,null)):l&&(l.d(1),l=null)},d(a){a&&A(e),r&&r.d(),l&&l.d()}}}function dl(n){let e,t,i,s,o,r,l=n[2].name+"",a,c,u,d,f,h;return{c(){e=g("button"),t=g("img"),o=C(),r=g("span"),a=ce(l),tt(t.src,i=n[2].image)||m(t,"src",i),m(t,"alt",s=n[2].name),m(t,"draggable","false"),m(t,"class","svelte-1tlszo6"),m(r,"class","tooltip svelte-1tlszo6"),m(r,"id",c=n[19].screenshot.ongoing?"right":"top"),m(e,"class","svelte-1tlszo6"),it(e,"display",n[2].link?"":"none"),it(e,"border-radius",n[2].tool?"calc(var(--u))":"")},m(p,b){P(p,e,b),_(e,t),_(e,o),_(e,r),_(r,a),d=!0,f||(h=O(e,"click",n[38]),f=!0)},p(p,b){(!d||b[0]&4&&!tt(t.src,i=p[2].image))&&m(t,"src",i),(!d||b[0]&4&&s!==(s=p[2].name))&&m(t,"alt",s),(!d||b[0]&4)&&l!==(l=p[2].name+"")&&Se(a,l),(!d||b[0]&524288&&c!==(c=p[19].screenshot.ongoing?"right":"top"))&&m(r,"id",c),b[0]&4&&it(e,"display",p[2].link?"":"none"),b[0]&4&&it(e,"border-radius",p[2].tool?"calc(var(--u))":"")},i(p){d||(p&&we(()=>{d&&(u||(u=me(e,Ze,{duration:150},!0)),u.run(1))}),d=!0)},o(p){p&&(u||(u=me(e,Ze,{duration:150},!1)),u.run(0)),d=!1},d(p){p&&A(e),p&&u&&u.end(),f=!1,h()}}}function fl(n){let e,t,i,s,o,r,l,a,c,u;i=new mt({props:{text:"Toggle base values",checked:n[16]}}),i.$on("toggle",n[47]),o=new mt({props:{text:"Eyeball of Reckoning buff",checked:n[17]}}),o.$on("toggle",n[48]);let d=Oe(n[2].moves),f=[];for(let p=0;p<d.length;p+=1)f[p]=ml(sl(n,d,p));const h=p=>H(f[p],1,1,()=>{f[p]=null});return{c(){e=g("div"),t=g("div"),le(i.$$.fragment),s=C(),le(o.$$.fragment),r=C(),l=g("div");for(let p=0;p<f.length;p+=1)f[p].c();m(t,"class","weaponToggles svelte-1tlszo6"),m(l,"class","weaponMoves svelte-1tlszo6"),m(e,"class","fullWeaponView svelte-1tlszo6")},m(p,b){P(p,e,b),_(e,t),ie(i,t,null),_(t,s),ie(o,t,null),_(e,r),_(e,l);for(let v=0;v<f.length;v+=1)f[v]&&f[v].m(l,null);u=!0},p(p,b){const v={};b[0]&65536&&(v.checked=p[16]),i.$set(v);const w={};if(b[0]&131072&&(w.checked=p[17]),o.$set(w),b[0]&219611268){d=Oe(p[2].moves);let k;for(k=0;k<d.length;k+=1){const y=sl(p,d,k);f[k]?(f[k].p(y,b),M(f[k],1)):(f[k]=ml(y),f[k].c(),M(f[k],1),f[k].m(l,null))}for(We(),k=d.length;k<f.length;k+=1)h(k);He()}},i(p){if(!u){M(i.$$.fragment,p),M(o.$$.fragment,p);for(let b=0;b<d.length;b+=1)M(f[b]);p&&we(()=>{u&&(c&&c.end(1),a=pa(e,Ze,{duration:150,delay:300}),a.start())}),u=!0}},o(p){H(i.$$.fragment,p),H(o.$$.fragment,p),f=f.filter(Boolean);for(let b=0;b<f.length;b+=1)H(f[b]);a&&a.invalidate(),p&&(c=_a(e,Ze,{duration:150})),u=!1},d(p){p&&A(e),se(i),se(o),ht(f,p),p&&c&&c.end()}}}function hl(n){let e,t,i,s;function o(a){n[49](a)}function r(a){n[50](a)}let l={};return n[7]!==void 0&&(l.value=n[7]),n[2].name!==void 0&&(l.weaponName=n[2].name),e=new Om({props:l}),ae.push(()=>Me(e,"value",o)),ae.push(()=>Me(e,"weaponName",r)),{c(){le(e.$$.fragment)},m(a,c){ie(e,a,c),s=!0},p(a,c){const u={};!t&&c[0]&128&&(t=!0,u.value=a[7],Pe(()=>t=!1)),!i&&c[0]&4&&(i=!0,u.weaponName=a[2].name,Pe(()=>i=!1)),e.$set(u)},i(a){s||(M(e.$$.fragment,a),s=!0)},o(a){H(e.$$.fragment,a),s=!1},d(a){se(e,a)}}}function pl(n){let e;return{c(){e=g("iconify-icon"),Ae(e,"icon","codicon:sparkle-filled"),Ae(e,"class","svelte-1tlszo6")},m(t,i){P(t,e,i)},d(t){t&&A(e)}}}function _l(n){let e,t=n[23]+(n[16]&&!n[54]?n[53].base:n[54]?n[27](n[53]):n[26](n[53]))+"",i,s,o=n[18][n[53].name]&&!n[16]&&pl();return{c(){e=g("span"),i=ce(t),s=C(),o&&o.c(),m(e,"class","svelte-1tlszo6")},m(r,l){P(r,e,l),_(e,i),_(e,s),o&&o.m(e,null)},p(r,l){l[0]&65540&&t!==(t=r[23]+(r[16]&&!r[54]?r[53].base:r[54]?r[27](r[53]):r[26](r[53]))+"")&&Se(i,t),r[18][r[53].name]&&!r[16]?o||(o=pl(),o.c(),o.m(e,null)):o&&(o.d(1),o=null)},d(r){r&&A(e),o&&o.d()}}}function ml(n){let e,t,i,s,o=(n[54]&&n[2].name=="Nature's Wrath Spellbook"?n[53].name.replace("Charged","Charge(s)"):n[53].name)+":",r,l,a=n[54]?[n[20],n[7],n[17]]:[n[20],n[17]],c,u,d=n[54]&&hl(n),f=_l(n);return{c(){e=g("div"),t=g("div"),i=g("span"),d&&d.c(),s=C(),r=ce(o),l=C(),f.c(),c=C(),m(i,"class","svelte-1tlszo6"),m(t,"class","ff-border svelte-1tlszo6"),m(e,"class","svelte-1tlszo6")},m(h,p){P(h,e,p),_(e,t),_(t,i),d&&d.m(i,null),_(i,s),_(i,r),_(t,l),f.m(t,null),_(e,c),u=!0},p(h,p){h[54]?d?(d.p(h,p),p[0]&4&&M(d,1)):(d=hl(h),d.c(),M(d,1),d.m(i,s)):d&&(We(),H(d,1,1,()=>{d=null}),He()),(!u||p[0]&4)&&o!==(o=(h[54]&&h[2].name=="Nature's Wrath Spellbook"?h[53].name.replace("Charged","Charge(s)"):h[53].name)+":")&&Se(r,o),p[0]&1179780&&ge(a,a=h[54]?[h[20],h[7],h[17]]:[h[20],h[17]])?(f.d(1),f=_l(h),f.c(),f.m(t,null)):f.p(h,p)},i(h){u||(M(d),u=!0)},o(h){H(d),u=!1},d(h){h&&A(e),d&&d.d(),f.d(h)}}}function Am(n){let e,t,i,s,o="Gear"+(n[19].screenshot.ongoing?":":""),r,l,a,c,u,d=n[2],f,h,p,b,v,w,k,y,I,D,W,S;function q(F,j){if(F[2].name&&!F[2].tool)return Rm;if(F[2].tool)return Dm}let z=q(n),Q=z&&z(n),N=dl(n);function E(F){n[42](F)}function T(F){n[43](F)}function $(F){n[44](F)}let R={slotName:n[0],index:n[1]};n[14]!==void 0&&(R.slotOpen=n[14]),n[5]!==void 0&&(R.weaponExpand=n[5]),n[15]!==void 0&&(R.optionsOpen=n[15]),b=new Ko({props:R}),ae.push(()=>Me(b,"slotOpen",E)),ae.push(()=>Me(b,"weaponExpand",T)),ae.push(()=>Me(b,"optionsOpen",$)),b.$on("itemSelect",n[45]),b.$on("toolSelect",n[28]);let L=n[5]&&fl(n);return{c(){e=g("div"),t=g("button"),i=g("iconify-icon"),s=C(),r=ce(o),l=C(),a=g("div"),Q&&Q.c(),c=C(),u=g("div"),N.c(),p=C(),le(b.$$.fragment),y=C(),L&&L.c(),I=pt(),Ae(i,"icon","iconamoon:arrow-down-2-fill"),Ae(i,"class","svelte-1tlszo6"),m(t,"class","ddButton svelte-1tlszo6"),m(u,"class","gearSlotIcon svelte-1tlszo6"),we(()=>n[39].call(u)),it(u,"min-width",`${n[11]}px`),m(a,"class","gearInfoCont ff-border svelte-1tlszo6"),we(()=>n[41].call(a)),it(a,"justify-content",n[2].name?"":"flex-end"),m(e,"class","gearSlot svelte-1tlszo6"),ne(e,"slotOpen",n[14]),ne(e,"weapon-expand",n[5])},m(F,j){P(F,e,j),_(e,t),_(t,i),_(t,s),_(t,r),n[34](t),_(e,l),_(e,a),Q&&Q.m(a,null),_(a,c),_(a,u),N.m(u,null),f=sn(u,n[39].bind(u)),n[40](a),h=sn(a,n[41].bind(a)),_(e,p),ie(b,e,null),n[46](e),P(F,y,j),L&&L.m(F,j),P(F,I,j),D=!0,W||(S=[O(window,"mousedown",n[32]),O(window,"keydown",n[33]),O(t,"click",n[35])],W=!0)},p(F,j){(!D||j[0]&524288)&&o!==(o="Gear"+(F[19].screenshot.ongoing?":":""))&&Se(r,o),z===(z=q(F))&&Q?Q.p(F,j):(Q&&Q.d(1),Q=z&&z(F),Q&&(Q.c(),Q.m(a,c))),j[0]&4&&ge(d,d=F[2])?(We(),H(N,1,1,oe),He(),N=dl(F),N.c(),M(N,1),N.m(u,null)):N.p(F,j),j[0]&2048&&it(u,"min-width",`${F[11]}px`),j[0]&4&&it(a,"justify-content",F[2].name?"":"flex-end");const Y={};j[0]&1&&(Y.slotName=F[0]),j[0]&2&&(Y.index=F[1]),!v&&j[0]&16384&&(v=!0,Y.slotOpen=F[14],Pe(()=>v=!1)),!w&&j[0]&32&&(w=!0,Y.weaponExpand=F[5],Pe(()=>w=!1)),!k&&j[0]&32768&&(k=!0,Y.optionsOpen=F[15],Pe(()=>k=!1)),b.$set(Y),(!D||j[0]&16384)&&ne(e,"slotOpen",F[14]),(!D||j[0]&32)&&ne(e,"weapon-expand",F[5]),F[5]?L?(L.p(F,j),j[0]&32&&M(L,1)):(L=fl(F),L.c(),M(L,1),L.m(I.parentNode,I)):L&&(We(),H(L,1,1,()=>{L=null}),He())},i(F){D||(M(N),M(b.$$.fragment,F),M(L),D=!0)},o(F){H(N),H(b.$$.fragment,F),H(L),D=!1},d(F){F&&(A(e),A(y),A(I)),n[34](null),Q&&Q.d(),N.d(F),f(),n[40](null),h(),se(b),n[46](null),L&&L.d(F),W=!1,be(S)}}}function Pm(n,e,t){let i,s,o,r,l,a,c;X(n,Pn,U=>t(30,i=U)),X(n,jt,U=>t(31,s=U)),X(n,Mt,U=>t(51,o=U)),X(n,x,U=>t(19,r=U)),X(n,gt,U=>t(20,l=U)),X(n,ks,U=>t(21,a=U)),X(n,bn,U=>t(22,c=U));let{gearBox:u,slotName:d,index:f}=e,h,p,b,v,w,k,y,I=ys,D,W,S,q,z,Q=!1,N=!1,E="",T=["Charged Basic Attack","Charged Solar Beam"],$={basic:!1,special:!1},R={};function L(){if(y)for(let U of y.querySelectorAll(".gearPreview > div")){if(Object.keys(a).includes(U.id=="basic"?D.name:W?W.name:null))return;let Ne=L_(U,c);Ne&&(U.id=="basic"?G(ks,a[D.name]=Ne,a):G(ks,a[W.name]=Ne,a))}}function F(U){let Ne;if(U.name=="Void Needle")Ne=U.base+l[U.type]-l.armor*5.625;else if(I.name=="Pureblood Dagger"){let ze,je={magicDmg:l.magicDmg,meleeDmg:l.meleeDmg,rangedDmg:l.rangedDmg},Fe=Object.keys(je).reduce((Ve,un)=>je[Ve]>je[un]?Ve:un),Ue=0;for(let Ve in je)Ve!=Fe&&(Ue+=je[Ve]);ze=l[Fe]*2-Ue,Ne=U.base+(U.name.includes("HP")?ze/2:ze)}else if(U.type.includes("/")){let ze=U.type.split("/"),je=0;for(let Fe of ze)je+=l[Fe]*U[`${Fe}Mult`];Ne=U.base+je}else Ne=U.base+l[U.type]*U.mult;return N&&(!U.name.includes("HP")||U.name.includes("HP")&&I.name=="Pureblood Dagger")&&(Ne+=Ne*.08775),z?Math.floor(Ne*10)/10:Math.floor(Ne)}function j(U){let Ne,ze=Q?0:l[U.type];return I.name=="Celestial Powers Spellbook"?Ne=(80+ze*1.1)*(.8+2.2*h/100):I.name=="Staff of Dreams"?Ne=160+160*h/100+ze*(.4+1.3*h/100):I.name=="Nature's Wrath Spellbook"&&(Ne=260+400*h/4+ze*(1+1.5*h/4)),N&&(Ne+=Ne*.08775),Math.floor(Ne*10)/10}function Y(){r.screenshot.ongoing||(t(16,Q=!1),t(17,N=!1),z?(t(5,z=!1),u.classList.remove("weapon-expand"),setTimeout(L)):(u.classList.add("weapon-expand"),t(5,z=!0)))}function fe(U,Ne){e:for(let ze in i){let je=o.bonuses.find(Ue=>Ue.name==ze).stats,Fe=U?U.type:null;for(let Ue in Ft){if(Fe===null)break e;if(I.name=="Void Spike Ultradagger"&&Ne=="special"||U.name=="Void Needle"?Fe="armor/meleeDmg":I.name=="Pureblood Dagger"?Fe=ze=="Fish of Rage"?"":"magicDmg/meleeDmg/rangedDmg":I.name=="Gnome Rocket Launcher"&&(Fe=""),i[ze]&&je[Ue]!=0&&Fe.includes(Ue)){t(18,R[U.name]=!0,R),Ne&&t(6,$[Ne]=!0,$);break e}else t(18,R[U.name]=!1,R),Ne&&t(6,$[Ne]=!1,$)}}}const te=U=>{(!p.contains(U.target)&&!c||p.contains(U.target)&&b.contains(U.target))&&(t(14,S=!1),t(15,q=!1))},re=U=>{U.key=="Escape"&&(t(14,S=!1),t(15,q=!1))};function B(U){ae[U?"unshift":"push"](()=>{k=U,t(12,k)})}const J=()=>{r.screenshot.ongoing||t(14,S=!S)};function de(U){ae[U?"unshift":"push"](()=>{y=U,t(13,y)})}const qe=U=>{nn(U),Y()},ve=()=>{c||(G(x,r.item.ongoing=!0,r),G(x,r.item.data={...I,type:"gear"},r))};function Ie(){w=this.offsetHeight,t(11,w)}function nt(U){ae[U?"unshift":"push"](()=>{b=U,t(9,b)})}function st(){v=this.offsetHeight,t(10,v)}function Le(U){S=U,t(14,S)}function ue(U){z=U,t(5,z)}function pe(U){q=U,t(15,q)}const $e=()=>{setTimeout(()=>{L(),(!I.name||I.tool)&&z&&Y(),t(15,q=!1)})};function Je(U){ae[U?"unshift":"push"](()=>{p=U,t(8,p)})}const Nt=U=>{t(16,Q=U.detail),U.detail&&t(17,N=!1)},V=U=>{t(17,N=U.detail),U.detail&&t(16,Q=!1)};function Te(U){h=U,t(7,h)}function _e(U){n.$$.not_equal(I.name,U)&&(I.name=U,t(2,I),t(31,s),t(1,f),t(4,W))}return n.$$set=U=>{"gearBox"in U&&t(29,u=U.gearBox),"slotName"in U&&t(0,d=U.slotName),"index"in U&&t(1,f=U.index)},n.$$.update=()=>{if(n.$$.dirty[0]&22|n.$$.dirty[1]&1&&s[f]&&s[f].name!=I.name&&(t(2,I=s[f]),!I.tool&&I.name)){t(3,D=I.moves.filter(U=>U.basic)[0]),t(4,W=I.moves.filter(U=>U.special)[0]),t(18,R={});for(let U of I.moves)t(18,R[U.name]=!1,R),fe(U);W&&W.name.includes("Fantastic Beamstorm")?t(23,E="~"):t(23,E="")}if(n.$$.dirty[0]&1073741948&&(i||z)&&!I.tool&&I.name){for(let U in $)fe(U=="basic"?D:W||null,U);for(let U of I.moves)fe(U)}},[d,f,I,D,W,z,$,h,p,b,v,w,k,y,S,q,Q,N,R,r,l,a,c,E,T,L,F,j,Y,u,i,s,te,re,B,J,de,qe,ve,Ie,nt,st,Le,ue,pe,$e,Je,Nt,V,Te,_e]}class Mm extends Re{constructor(e){super(),De(this,e,Pm,Am,ge,{gearBox:29,slotName:0,index:1},null,[-1,-1])}}function gl(n,e,t){const i=n.slice();return i[3]=e[t],i}function bl(n){let e,t,i;function s(r){n[1](r)}let o={slotName:"gear",index:n[3]};return n[0]!==void 0&&(o.gearBox=n[0]),e=new Mm({props:o}),ae.push(()=>Me(e,"gearBox",s)),{c(){le(e.$$.fragment)},m(r,l){ie(e,r,l),i=!0},p(r,l){const a={};!t&&l&1&&(t=!0,a.gearBox=r[0],Pe(()=>t=!1)),e.$set(a)},i(r){i||(M(e.$$.fragment,r),i=!0)},o(r){H(e.$$.fragment,r),i=!1},d(r){se(e,r)}}}function Lm(n){let e,t,i=Oe(Cn),s=[];for(let r=0;r<i.length;r+=1)s[r]=bl(gl(n,i,r));const o=r=>H(s[r],1,1,()=>{s[r]=null});return{c(){e=g("div");for(let r=0;r<s.length;r+=1)s[r].c();m(e,"class","gearBox svelte-1lv6xba")},m(r,l){P(r,e,l);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null);n[2](e),t=!0},p(r,[l]){if(l&1){i=Oe(Cn);let a;for(a=0;a<i.length;a+=1){const c=gl(r,i,a);s[a]?(s[a].p(c,l),M(s[a],1)):(s[a]=bl(c),s[a].c(),M(s[a],1),s[a].m(e,null))}for(We(),a=i.length;a<s.length;a+=1)o(a);He()}},i(r){if(!t){for(let l=0;l<i.length;l+=1)M(s[l]);t=!0}},o(r){s=s.filter(Boolean);for(let l=0;l<s.length;l+=1)H(s[l]);t=!1},d(r){r&&A(e),ht(s,r),n[2](null)}}}function Fm(n,e,t){let i;function s(r){i=r,t(0,i)}function o(r){ae[r?"unshift":"push"](()=>{i=r,t(0,i)})}return[i,s,o]}class Bm extends Re{constructor(e){super(),De(this,e,Fm,Lm,ge,{})}}function qm(n){let e,t,i,s,o,r,l,a;return{c(){e=g("div"),t=g("div"),i=g("button"),i.textContent="Clear armor",s=C(),o=g("div"),r=g("button"),r.textContent="Clear gear",m(i,"class","svelte-e94uvj"),m(t,"class","buttonCont svelte-e94uvj"),m(r,"class","svelte-e94uvj"),m(o,"class","buttonCont svelte-e94uvj"),m(e,"class","mainFeatures svelte-e94uvj"),m(e,"id","box")},m(c,u){P(c,e,u),_(e,t),_(t,i),_(e,s),_(e,o),_(o,r),l||(a=[O(i,"click",n[3]),O(r,"click",n[4])],l=!0)},p:oe,i:oe,o:oe,d(c){c&&A(e),l=!1,be(a)}}}function zm(n,e,t){let i,s,o,r,l;X(n,jt,f=>t(5,i=f)),X(n,qn,f=>t(6,s=f)),X(n,Lt,f=>t(7,o=f)),X(n,Bn,f=>t(8,r=f)),X(n,bn,f=>t(0,l=f));function a(){for(let f in o)o[f].name&&r[f][o[f].name].querySelector("button").click()}function c(){for(let f in i)i[f].name&&s[f][i[f].name].querySelector("button").click()}return[l,a,c,f=>{f.target.blur(),l||a()},f=>{f.target.blur(),l||c()}]}class jm extends Re{constructor(e){super(),De(this,e,zm,qm,ge,{})}}function vl(n){let e,t,i;function s(r){n[3](r)}let o={slotName:"sets"};return n[0]!==void 0&&(o.slotOpen=n[0]),e=new Ko({props:o}),ae.push(()=>Me(e,"slotOpen",s)),{c(){le(e.$$.fragment)},m(r,l){ie(e,r,l),i=!0},p(r,l){const a={};!t&&l&1&&(t=!0,a.slotOpen=r[0],Pe(()=>t=!1)),e.$set(a)},i(r){i||(M(e.$$.fragment,r),i=!0)},o(r){H(e.$$.fragment,r),i=!1},d(r){se(e,r)}}}function Wm(n){let e,t,i,s,o,r,l=n[1].head&&n[1].body&&n[1].legs&&n[1].feet&&vl(n);return{c(){e=g("button"),e.innerHTML=`Load armor set
    <iconify-icon icon="iconamoon:arrow-down-2-fill" rotate="180deg" class="svelte-l9dczq"></iconify-icon>`,t=C(),l&&l.c(),i=pt(),m(e,"class","svelte-l9dczq"),ne(e,"ddOpen",n[0])},m(a,c){P(a,e,c),P(a,t,c),l&&l.m(a,c),P(a,i,c),s=!0,o||(r=O(e,"click",n[2]),o=!0)},p(a,[c]){(!s||c&1)&&ne(e,"ddOpen",a[0]),a[1].head&&a[1].body&&a[1].legs&&a[1].feet?l?(l.p(a,c),c&2&&M(l,1)):(l=vl(a),l.c(),M(l,1),l.m(i.parentNode,i)):l&&(We(),H(l,1,1,()=>{l=null}),He())},i(a){s||(M(l),s=!0)},o(a){H(l),s=!1},d(a){a&&(A(e),A(t),A(i)),l&&l.d(a),o=!1,r()}}}function Hm(n,e,t){let i;X(n,Mt,l=>t(1,i=l));let{ddOpen:s=!1}=e;const o=()=>t(0,s=!s);function r(l){s=l,t(0,s)}return n.$$set=l=>{"ddOpen"in l&&t(0,s=l.ddOpen)},[s,i,o,r]}class Um extends Re{constructor(e){super(),De(this,e,Hm,Wm,ge,{ddOpen:0})}}function Gm(n){let e;return{c(){e=g("span"),e.textContent="Create some builds to get started!",m(e,"class","tooltip svelte-lhwdnk"),m(e,"id","top"),it(e,"left","70.5%")},m(t,i){P(t,e,i)},p:oe,d(t){t&&A(e)}}}function Vm(n){let e;return{c(){e=g("span"),e.textContent="Select some gear or armor to get started!",m(e,"class","tooltip svelte-lhwdnk"),m(e,"id","top"),it(e,"left",n[3]?"38%":"")},m(t,i){P(t,e,i)},p(t,i){i&8&&it(e,"left",t[3]?"38%":"")},d(t){t&&A(e)}}}function Km(n){let e,t,i,s,o,r,l,a,c,u,d,f,h,p,b,v,w,k,y,I,D,W,S,q,z,Q,N,E;function T(j,Y){if(!j[4])return Vm;if(!j[3])return Gm}let $=T(n),R=$&&$(n);function L(j){n[18](j)}let F={};return n[1]!==void 0&&(F.ddOpen=n[1]),q=new Um({props:F}),ae.push(()=>Me(q,"ddOpen",L)),{c(){e=g("div"),t=g("div"),i=g("div"),s=g("button"),o=ce("Export new build"),l=C(),a=g("div"),c=g("button"),u=ce("Save to build"),f=C(),h=g("div"),p=g("button"),b=ce("Delete build"),w=C(),R&&R.c(),k=C(),y=g("div"),I=g("div"),D=g("button"),D.textContent="Load build",W=C(),S=g("div"),le(q.$$.fragment),s.disabled=r=!n[4],m(s,"class","svelte-lhwdnk"),m(i,"class","buttonCont svelte-lhwdnk"),c.disabled=d=!n[4]||!n[3],m(c,"class","svelte-lhwdnk"),m(a,"class","buttonCont svelte-lhwdnk"),m(a,"id","middle"),p.disabled=v=!n[3],m(p,"class","svelte-lhwdnk"),m(h,"class","buttonCont svelte-lhwdnk"),m(t,"id","modify"),m(t,"class","svelte-lhwdnk"),ne(t,"no-tooltip",n[2]),m(D,"class","svelte-lhwdnk"),m(I,"class","buttonCont svelte-lhwdnk"),m(S,"class","buttonCont svelte-lhwdnk"),m(y,"id","load"),m(y,"class","svelte-lhwdnk"),m(e,"class","mainFeatures svelte-lhwdnk"),m(e,"id","build")},m(j,Y){P(j,e,Y),_(e,t),_(t,i),_(i,s),_(s,o),_(t,l),_(t,a),_(a,c),_(c,u),_(t,f),_(t,h),_(h,p),_(p,b),_(t,w),R&&R.m(t,null),_(e,k),_(e,y),_(y,I),_(I,D),_(y,W),_(y,S),ie(q,S,null),n[19](S),Q=!0,N||(E=[O(window,"mousedown",n[8]),O(window,"keydown",n[9]),O(s,"click",n[10]),O(s,"mouseenter",n[11]),O(s,"mouseleave",n[12]),O(c,"click",n[13]),O(p,"click",n[14]),O(p,"mouseenter",n[15]),O(p,"mouseleave",n[16]),O(D,"click",n[17])],N=!0)},p(j,[Y]){(!Q||Y&16&&r!==(r=!j[4]))&&(s.disabled=r),(!Q||Y&24&&d!==(d=!j[4]||!j[3]))&&(c.disabled=d),(!Q||Y&8&&v!==(v=!j[3]))&&(p.disabled=v),$===($=T(j))&&R?R.p(j,Y):(R&&R.d(1),R=$&&$(j),R&&(R.c(),R.m(t,null))),(!Q||Y&4)&&ne(t,"no-tooltip",j[2]);const fe={};!z&&Y&2&&(z=!0,fe.ddOpen=j[1],Pe(()=>z=!1)),q.$set(fe)},i(j){Q||(M(q.$$.fragment,j),Q=!0)},o(j){H(q.$$.fragment,j),Q=!1},d(j){j&&A(e),R&&R.d(),se(q),n[19](null),N=!1,be(E)}}}function Ym(n,e,t){let i,s,o,r,l;X(n,Ot,S=>t(7,i=S)),X(n,Jt,S=>t(3,s=S)),X(n,co,S=>t(4,o=S)),X(n,bn,S=>t(5,r=S)),X(n,x,S=>t(6,l=S));let a,c=!1,u=!1;const d=S=>{a.contains(S.target)||t(1,c=!1)},f=S=>{S.key=="Escape"&&t(1,c=!1)},h=()=>{o&&!r&&G(x,l.export.ongoing=!0,l)},p=()=>t(2,u=!0),b=()=>t(2,u=!1),v=()=>{o&&s&&!r&&G(x,l.save.ongoing=!0,l)},w=()=>{s&&!r&&G(x,l.delete.ongoing=!0,l)},k=()=>t(2,u=!0),y=()=>t(2,u=!1),I=()=>{r||G(x,l.load.ongoing=!0,l)};function D(S){c=S,t(1,c)}function W(S){ae[S?"unshift":"push"](()=>{a=S,t(0,a)})}return n.$$.update=()=>{n.$$.dirty&128&&G(Jt,s=Object.keys(i).length>0,s)},[a,c,u,s,o,r,l,i,d,f,h,p,b,v,w,k,y,I,D,W]}class Qm extends Re{constructor(e){super(),De(this,e,Ym,Km,ge,{})}}function yl(n){let e;return{c(){e=g("span"),e.textContent="New changes! Exiting will erase them.",m(e,"id","alert")},m(t,i){P(t,e,i)},d(t){t&&A(e)}}}function Xm(n){let e,t,i,s,o,r,l,a=25-n[3].length+"",c,u,d,f,h,p,b,v,w,k,y,I=275-n[4].length+"",D,W,S,q,z,Q,N,E,T,$,R,L,F,j,Y,fe,te=(n[3]||n[4])&&yl();return{c(){e=g("div"),t=g("div"),i=ce(`Name:\r
        `),s=g("input"),r=C(),l=g("span"),c=ce(a),u=C(),d=g("div"),f=g("div"),h=g("span"),h.textContent="Description / Notes:",p=C(),te&&te.c(),b=C(),v=g("textarea"),k=C(),y=g("span"),D=ce(I),W=C(),S=g("div"),q=g("div"),z=g("button"),Q=ce("CANCEL"),E=C(),T=g("div"),$=g("button"),R=ce("EXPORT"),m(s,"class","buildNameInput"),m(s,"id","firstFocusable"),s.disabled=o=n[5].export.status==0,m(s,"type","text"),m(s,"placeholder",n[6]),m(s,"maxlength","25"),m(l,"class","charCounter svelte-1vypdkl"),m(l,"id","buildName"),m(t,"class","buildNameCont svelte-1vypdkl"),m(v,"class","buildDescInput"),v.disabled=w=n[5].export.status==0,m(v,"placeholder","[Empty]"),m(v,"maxlength","275"),m(v,"autocomplete","off"),m(y,"class","charCounter"),m(y,"id","buildDesc"),m(d,"class","buildDescCont"),z.disabled=N=n[5].export.status==0,m($,"id","lastFocusable"),$.disabled=L=n[5].export.status==0,m(S,"class","promptOptions"),m(e,"class","buildExporter svelte-1vypdkl")},m(re,B){P(re,e,B),_(e,t),_(t,i),_(t,s),n[8](s),qt(s,n[3]),_(t,r),_(t,l),_(l,c),_(e,u),_(e,d),_(d,f),_(f,h),_(f,p),te&&te.m(f,null),_(d,b),_(d,v),qt(v,n[4]),n[13](v),_(d,k),_(d,y),_(y,D),_(e,W),_(e,S),_(S,q),_(q,z),_(z,Q),n[16](z),_(S,E),_(S,T),_(T,$),_($,R),j=!0,Y||(fe=[O(s,"input",n[9]),O(s,"input",n[10]),O(s,"keydown",n[11]),O(v,"input",n[12]),O(v,"input",n[14]),O(v,"keydown",n[15]),O(z,"click",n[17]),O($,"click",n[18]),O($,"keydown",yt),O(e,"introstart",n[19])],Y=!0)},p(re,[B]){(!j||B&32&&o!==(o=re[5].export.status==0))&&(s.disabled=o),B&8&&s.value!==re[3]&&qt(s,re[3]),(!j||B&8)&&a!==(a=25-re[3].length+"")&&Se(c,a),re[3]||re[4]?te||(te=yl(),te.c(),te.m(f,null)):te&&(te.d(1),te=null),(!j||B&32&&w!==(w=re[5].export.status==0))&&(v.disabled=w),B&16&&qt(v,re[4]),(!j||B&16)&&I!==(I=275-re[4].length+"")&&Se(D,I),(!j||B&32&&N!==(N=re[5].export.status==0))&&(z.disabled=N),(!j||B&32&&L!==(L=re[5].export.status==0))&&($.disabled=L)},i(re){j||(re&&we(()=>{j&&(F||(F=me(e,xe,{duration:250},!0)),F.run(1))}),j=!0)},o(re){re&&(F||(F=me(e,xe,{duration:250},!1)),F.run(0)),j=!1},d(re){re&&A(e),n[8](null),te&&te.d(),n[13](null),n[16](null),re&&F&&F.end(),Y=!1,be(fe)}}}function Jm(n,e,t){let i,s,o,r,l,a;X(n,x,T=>t(5,i=T)),X(n,wt,T=>t(20,s=T)),X(n,Jt,T=>t(21,o=T)),X(n,jt,T=>t(22,r=T)),X(n,Lt,T=>t(23,l=T)),X(n,Ot,T=>t(24,a=T));let c=Object.keys(a).length,u,d,f,h="",p="",b=`My ${c+1+ou[(c+1)%10]} build`;function v(){if(G(x,i.export.status=0,i),h.endsWith(" ")&&t(3,h=h.replace(/  +/g," ").replace(/ $/,"")),p.endsWith(" ")&&t(4,p=p.replace(/  +/g," ").replace(/ $/,"")),Object.keys(a).includes(h)){G(x,i.export.status=-1,i),G(x,i.message="duplicate_name",i);return}let T=h_(Yt(Hn(Gn),"builds")).key,$=au(l,r);$.name=h||b,$.desc=p||"[Empty]",_s(Yt(Hn(Gn),`builds/${T}`),$).then(()=>{G(x,i.export.status=1,i),G(Jt,o=!0,o),Vo(),Ot.update(R=>({...R,[$.name]:{id:T,desc:$.desc}})),G(wt,s=$,s),G(wt,s.id=T,s),navigator.clipboard.writeText(`${location.origin+location.pathname}?id=${T}`)}).catch(()=>{G(x,i.export.status=-1,i),G(x,i.message="firebase_fail",i)})}function w(T){ae[T?"unshift":"push"](()=>{u=T,t(0,u)})}function k(){h=this.value,t(3,h)}const y=T=>{t(3,h=ts(T.target.value,25))},I=T=>{i.export.status==0&&T.preventDefault(),vt(T),to(u,T.target.value,25)};function D(){p=this.value,t(4,p)}function W(T){ae[T?"unshift":"push"](()=>{d=T,t(1,d)})}const S=T=>{t(4,p=ts(T.target.value,275))},q=T=>{i.export.status==0&&T.preventDefault(),to(d,T.target.value,275)};function z(T){ae[T?"unshift":"push"](()=>{f=T,t(2,f)})}return[u,d,f,h,p,i,b,v,w,k,y,I,D,W,S,q,z,()=>{i.export.status!=0&&G(x,i.export.ongoing=!1,i)},()=>{i.export.status!=0&&v()},()=>f.focus()]}class Zm extends Re{constructor(e){super(),De(this,e,Jm,Xm,ge,{})}}function xm(n){let e,t,i,s,o=n[2]?"Copied!":"Copy link",r,l,a;return{c(){e=g("button"),t=g("b"),t.textContent="Build link",i=C(),s=g("span"),r=ce(o),m(s,"class","tooltip"),m(s,"id","top"),m(e,"class","copyButton svelte-1e8zrsj"),m(e,"id","firstFocusable")},m(c,u){P(c,e,u),_(e,t),_(e,i),_(e,s),_(s,r),l||(a=[O(e,"click",n[7]),O(e,"keydown",vt)],l=!0)},p(c,u){u&4&&o!==(o=c[2]?"Copied!":"Copy link")&&Se(r,o)},d(c){c&&A(e),l=!1,be(a)}}}function $m(n){let e,t,i,s,o,r,l=n[2]?"Copied!":"Copy ID",a,c,u,d;return{c(){e=g("button"),t=g("b"),t.textContent="ID:",i=C(),s=ce(n[4]),o=C(),r=g("span"),a=ce(l),m(r,"class","tooltip"),m(r,"id","top"),m(e,"class","copyButton svelte-1e8zrsj"),m(e,"id",c=n[1]!="save"?"firstFocusable":"")},m(f,h){P(f,e,h),_(e,t),_(e,i),_(e,s),_(e,o),_(e,r),_(r,a),u||(d=[O(e,"click",n[5]),O(e,"keydown",n[6])],u=!0)},p(f,h){h&4&&l!==(l=f[2]?"Copied!":"Copy ID")&&Se(a,l),h&2&&c!==(c=f[1]!="save"?"firstFocusable":"")&&m(e,"id",c)},d(f){f&&A(e),u=!1,be(d)}}}function eg(n){let e;function t(o,r){if(o[0]=="id")return $m;if(o[0]=="link")return xm}let i=t(n),s=i&&i(n);return{c(){s&&s.c(),e=pt()},m(o,r){s&&s.m(o,r),P(o,e,r)},p(o,[r]){i===(i=t(o))&&s?s.p(o,r):(s&&s.d(1),s=i&&i(o),s&&(s.c(),s.m(e.parentNode,e)))},i:oe,o:oe,d(o){o&&A(e),s&&s.d(o)}}}function tg(n,e,t){let i;X(n,wt,f=>t(8,i=f));let{type:s,source:o}=e,r=!1;function l(f){r||(navigator.clipboard.writeText(f),t(2,r=!0),setTimeout(()=>t(2,r=!1),1e3))}let a=i?i.id:null;const c=()=>l(a),u=()=>{o!="save"&&vt()},d=()=>l(`${location.origin+location.pathname}?id=${a}`);return n.$$set=f=>{"type"in f&&t(0,s=f.type),"source"in f&&t(1,o=f.source)},[s,o,r,l,a,c,u,d]}class yi extends Re{constructor(e){super(),De(this,e,tg,eg,ge,{type:0,source:1})}}function ng(n){let e,t,i,s;return e=new yi({props:{type:"link",source:"share"}}),i=new yi({props:{type:"id",source:"share"}}),{c(){le(e.$$.fragment),t=C(),le(i.$$.fragment)},m(o,r){ie(e,o,r),P(o,t,r),ie(i,o,r),s=!0},p:oe,i(o){s||(M(e.$$.fragment,o),M(i.$$.fragment,o),s=!0)},o(o){H(e.$$.fragment,o),H(i.$$.fragment,o),s=!1},d(o){o&&A(t),se(e,o),se(i,o)}}}function ig(n){let e;return{c(){e=g("span"),e.textContent="Your build has been erased from your local saves and the database."},m(t,i){P(t,e,i)},p:oe,i:oe,o:oe,d(t){t&&A(e)}}}function sg(n){let e;function t(o,r){if(o[2].message=="not_found")return cg;if(o[2].message=="invalid_id")return ag}let i=t(n),s=i&&i(n);return{c(){s&&s.c(),e=pt()},m(o,r){s&&s.m(o,r),P(o,e,r)},p(o,r){i!==(i=t(o))&&(s&&s.d(1),s=i&&i(o),s&&(s.c(),s.m(e.parentNode,e)))},i:oe,o:oe,d(o){o&&A(e),s&&s.d(o)}}}function og(n){let e,t,i,s,o,r;return i=new yi({props:{type:"link",source:"save"}}),o=new yi({props:{type:"id",source:"save"}}),{c(){e=g("span"),e.textContent="Your build has been overwritten.",t=C(),le(i.$$.fragment),s=C(),le(o.$$.fragment)},m(l,a){P(l,e,a),P(l,t,a),ie(i,l,a),P(l,s,a),ie(o,l,a),r=!0},p:oe,i(l){r||(M(i.$$.fragment,l),M(o.$$.fragment,l),r=!0)},o(l){H(i.$$.fragment,l),H(o.$$.fragment,l),r=!1},d(l){l&&(A(e),A(t),A(s)),se(i,l),se(o,l)}}}function rg(n){let e,t,i,s;const o=[dg,ug],r=[];function l(a,c){return a[2].export.status==1?0:a[2].export.status==-1&&a[2].message=="duplicate_name"?1:-1}return~(e=l(n))&&(t=r[e]=o[e](n)),{c(){t&&t.c(),i=pt()},m(a,c){~e&&r[e].m(a,c),P(a,i,c),s=!0},p(a,c){let u=e;e=l(a),e!==u&&(t&&(We(),H(r[u],1,1,()=>{r[u]=null}),He()),~e?(t=r[e],t||(t=r[e]=o[e](a),t.c()),M(t,1),t.m(i.parentNode,i)):t=null)},i(a){s||(M(t),s=!0)},o(a){H(t),s=!1},d(a){a&&A(i),~e&&r[e].d(a)}}}function lg(n){let e,t,i=n[2].export.status?"exporting":n[2].save.status?"saving":n[2].load.status?"loading":"deleting",s,o,r,l,a,c,u,d;return{c(){e=g("span"),t=ce("A problem occurred while "),s=ce(i),o=ce(` your build.\r
            `),r=g("br"),l=ce(`\r
            If needed`),a=g("b"),a.textContent=",",c=ce(" you may contact "),u=g("hl"),u.textContent="xt.ss",d=ce(` on Discord for more\r
            details.`)},m(f,h){P(f,e,h),_(e,t),_(e,s),_(e,o),_(e,r),_(e,l),_(e,a),_(e,c),_(e,u),_(e,d)},p(f,h){h&4&&i!==(i=f[2].export.status?"exporting":f[2].save.status?"saving":f[2].load.status?"loading":"deleting")&&Se(s,i)},i:oe,o:oe,d(f){f&&A(e)}}}function ag(n){let e;return{c(){e=g("span"),e.textContent="The ID you have entered is invalid. Please check it again."},m(t,i){P(t,e,i)},d(t){t&&A(e)}}}function cg(n){let e;return{c(){e=g("span"),e.innerHTML=`Your build could not be found within the database.
                <br/>
                If needed<b>,</b> you may contact <hl>xt.ss</hl> on Discord for more
                details.`},m(t,i){P(t,e,i)},d(t){t&&A(e)}}}function ug(n){let e;return{c(){e=g("span"),e.innerHTML=`Another build of yours with the same name already exists.
                <br/>
                Please use a different one.`},m(t,i){P(t,e,i)},i:oe,o:oe,d(t){t&&A(e)}}}function dg(n){let e,t,i,s;return i=new yi({props:{type:"id",source:"export"}}),{c(){e=g("span"),e.textContent="Your build's link has been copied to your clipboard.",t=C(),le(i.$$.fragment)},m(o,r){P(o,e,r),P(o,t,r),ie(i,o,r),s=!0},i(o){s||(M(i.$$.fragment,o),s=!0)},o(o){H(i.$$.fragment,o),s=!1},d(o){o&&(A(e),A(t)),se(i,o)}}}function fg(n){let e,t,i,s,o,r,l,a,c,u,d,f,h,p,b,v,w;const k=[lg,rg,og,sg,ig,ng],y=[];function I(D,W){return D[1]==-1&&D[2].message=="firebase_fail"?0:D[2].export.status?1:D[2].save.status==1?2:D[2].load.status==-1?3:D[2].delete.status==1?4:D[2].share.ongoing?5:-1}return~(o=I(n))&&(r=y[o]=k[o](n)),{c(){e=g("div"),t=g("span"),i=ce(n[4]),s=C(),r&&r.c(),l=C(),a=g("div"),c=g("div"),u=g("button"),d=ce("OK"),m(t,"id","messageTitle"),m(t,"class","svelte-nfbx2w"),m(u,"id",f=(n[1]==-1?"firstFocusable ":"")+"lastFocusable"),m(a,"class","promptOptions svelte-nfbx2w"),m(e,"class","promptMessage svelte-nfbx2w")},m(D,W){P(D,e,W),_(e,t),_(t,i),_(e,s),~o&&y[o].m(e,null),_(e,l),_(e,a),_(a,c),_(c,u),_(u,d),n[6](u),b=!0,v||(w=[O(u,"click",n[7]),O(u,"keydown",n[8]),O(e,"introstart",n[9])],v=!0)},p(D,[W]){(!b||W&16)&&Se(i,D[4]);let S=o;o=I(D),o===S?~o&&y[o].p(D,W):(r&&(We(),H(y[S],1,1,()=>{y[S]=null}),He()),~o?(r=y[o],r?r.p(D,W):(r=y[o]=k[o](D),r.c()),M(r,1),r.m(e,l)):r=null),(!b||W&2&&f!==(f=(D[1]==-1?"firstFocusable ":"")+"lastFocusable"))&&m(u,"id",f)},i(D){b||(M(r),D&&we(()=>{b&&(p&&p.end(1),h=pa(e,xe,{duration:200,delay:75}),h.start())}),b=!0)},o(D){H(r),h&&h.invalidate(),D&&(p=_a(e,xe,{duration:200})),b=!1},d(D){D&&A(e),~o&&y[o].d(),n[6](null),D&&p&&p.end(),v=!1,be(w)}}}function hg(n,e,t){let i,s,o;X(n,x,h=>t(2,o=h));let{loadID:r}=e;const l=Ht();let a;function c(h){ae[h?"unshift":"push"](()=>{a=h,t(3,a)})}const u=()=>{t(0,r=null),l("resetActions")},d=h=>{s==-1&&vt(h),yt(h)},f=()=>a.focus();return n.$$set=h=>{"loadID"in h&&t(0,r=h.loadID)},n.$$.update=()=>{n.$$.dirty&4&&t(1,s=o.export.status||o.save.status||o.load.status||o.delete.status),n.$$.dirty&6&&t(4,i=o.share.ongoing?"Share this build":`${o.export.status?"Export":o.save.status?"Save":o.load.status?"Load":"Delete"} ${s==1?"Success":"Failure"}!`)},[r,s,o,a,i,l,c,u,d,f]}class pg extends Re{constructor(e){super(),De(this,e,hg,fg,ge,{loadID:0})}}function _g(n){let e,t,i,s,o,r;return{c(){e=g("li"),t=g("button"),i=g("span"),s=ce(n[0]),m(i,"class","svelte-1opo0ke"),m(e,"class","svelte-1opo0ke"),ne(e,"selectedItem",n[2])},m(l,a){P(l,e,a),_(e,t),_(t,i),_(i,s),n[7](e),o||(r=O(t,"click",n[3]),o=!0)},p(l,[a]){a&1&&Se(s,l[0]),a&4&&ne(e,"selectedItem",l[2])},i:oe,o:oe,d(l){l&&A(e),n[7](null),o=!1,r()}}}function mg(n,e,t){let{chosenBuild:i,buildData:s,buildName:o,ddOpen:r}=e;const l=Ht();let a,c=i[0]==o;function u(){if(r){if(a.classList.contains("selectedItem")||t(2,c=!1),c)return;l("buildSelect",a),t(2,c=!0),t(5,r=!1),t(4,i=[o,s])}}function d(f){ae[f?"unshift":"push"](()=>{a=f,t(1,a)})}return n.$$set=f=>{"chosenBuild"in f&&t(4,i=f.chosenBuild),"buildData"in f&&t(6,s=f.buildData),"buildName"in f&&t(0,o=f.buildName),"ddOpen"in f&&t(5,r=f.ddOpen)},[o,a,c,u,i,r,s,d]}class gg extends Re{constructor(e){super(),De(this,e,mg,_g,ge,{chosenBuild:4,buildData:6,buildName:0,ddOpen:5})}}function wl(n,e,t){const i=n.slice();return i[25]=e[t][0],i[26]=e[t][1],i}function kl(n){let e,t,i,s;function o(a){n[13](a)}function r(a){n[14](a)}let l={buildData:n[26],buildName:n[25]};return n[0]!==void 0&&(l.chosenBuild=n[0]),n[1]!==void 0&&(l.ddOpen=n[1]),e=new gg({props:l}),ae.push(()=>Me(e,"chosenBuild",o)),ae.push(()=>Me(e,"ddOpen",r)),e.$on("buildSelect",n[11]),{c(){le(e.$$.fragment)},m(a,c){ie(e,a,c),s=!0},p(a,c){const u={};c&16&&(u.buildData=a[26]),c&16&&(u.buildName=a[25]),!t&&c&1&&(t=!0,u.chosenBuild=a[0],Pe(()=>t=!1)),!i&&c&2&&(i=!0,u.ddOpen=a[1],Pe(()=>i=!1)),e.$set(u)},i(a){s||(M(e.$$.fragment,a),s=!0)},o(a){H(e.$$.fragment,a),s=!1},d(a){se(e,a)}}}function bg(n){let e,t,i,s,o,r,l,a=Oe(Object.entries(n[4])),c=[];for(let d=0;d<a.length;d+=1)c[d]=kl(wl(n,a,d));const u=d=>H(c[d],1,1,()=>{c[d]=null});return{c(){e=g("div"),t=g("input"),i=C(),s=g("ul");for(let d=0;d<c.length;d+=1)c[d].c();m(t,"type","text"),m(t,"class","searchBarInput svelte-p20blu"),m(t,"placeholder","Search..."),m(s,"class","svelte-p20blu"),ne(s,"no-scrollbar",n[8].length<=4),m(e,"class","dropdown svelte-p20blu"),ne(e,"ddOpen",n[1])},m(d,f){P(d,e,f),_(e,t),n[12](t),_(e,i),_(e,s);for(let h=0;h<c.length;h+=1)c[h]&&c[h].m(s,null);n[15](s),n[16](e),o=!0,r||(l=[O(t,"input",n[10]),O(t,"keydown",n[9]),O(e,"transitionend",n[17]),O(e,"transitioncancel",n[18])],r=!0)},p(d,[f]){if(f&2067){a=Oe(Object.entries(d[4]));let h;for(h=0;h<a.length;h+=1){const p=wl(d,a,h);c[h]?(c[h].p(p,f),M(c[h],1)):(c[h]=kl(p),c[h].c(),M(c[h],1),c[h].m(s,null))}for(We(),h=a.length;h<c.length;h+=1)u(h);He()}(!o||f&256)&&ne(s,"no-scrollbar",d[8].length<=4),(!o||f&2)&&ne(e,"ddOpen",d[1])},i(d){if(!o){for(let f=0;f<a.length;f+=1)M(c[f]);o=!0}},o(d){c=c.filter(Boolean);for(let f=0;f<c.length;f+=1)H(c[f]);o=!1},d(d){d&&A(e),n[12](null),ht(c,d),n[15](null),n[16](null),r=!1,be(l)}}}function vg(n,e,t){let i;X(n,Ot,E=>t(4,i=E));let{chosenBuild:s,ddOpen:o=!1,dropdown:r}=e;const l=Ht();let a,c,u,d,f={},h=!1,p=[];function b(E){!E.shiftKey&&E.key=="Tab"&&(E.preventDefault(),setTimeout(()=>a.focus()))}function v(){c&&c.removeEventListener("keydown",b),y(),c&&c.addEventListener("keydown",b)}function w(E){E.shiftKey&&E.key=="Tab"&&(E.preventDefault(),setTimeout(()=>(c.querySelector("button")||c).focus()))}function k(){lu(a.value,f),v()}function y(){c&&c.classList.remove("lastElement"),t(8,p=u.querySelectorAll("li:not(.hidden)")),c=p[p.length-1],c?c.classList.add("lastElement"):c=a}function I(E){l("buildSelect"),t(6,d=E.detail);let T=u.querySelector(".selectedItem");T&&T!=E.detail&&T.classList.remove("selectedItem"),t(7,h=!0)}function D(E){ae[E?"unshift":"push"](()=>{a=E,t(5,a)})}function W(E){s=E,t(0,s)}function S(E){o=E,t(1,o)}function q(E){ae[E?"unshift":"push"](()=>{u=E,t(3,u)})}function z(E){ae[E?"unshift":"push"](()=>{r=E,t(2,r)})}const Q=E=>{E.propertyName=="visibility"&&(h&&(t(7,h=!1),t(5,a.value="",a),k()),!o&&d&&u.scrollTo(0,d.offsetTop),es(a,o))},N=E=>{E.propertyName=="visibility"&&(t(7,h=!1),es(a,o))};return n.$$set=E=>{"chosenBuild"in E&&t(0,s=E.chosenBuild),"ddOpen"in E&&t(1,o=E.ddOpen),"dropdown"in E&&t(2,r=E.dropdown)},n.$$.update=()=>{if(n.$$.dirty&24&&u){t(8,p=u.querySelectorAll("li:not(.hidden)"));for(let E=0;E<u.childElementCount;E++)f[Object.keys(i)[E]]=u.children[E];y(),v()}},[s,o,r,u,i,a,d,h,p,w,k,I,D,W,S,q,z,Q,N]}class Yo extends Re{constructor(e){super(),De(this,e,vg,bg,ge,{chosenBuild:0,ddOpen:1,dropdown:2})}}function Cl(n){let e,t=(n[6]>n[5]*.8?n[11].slice(0,20)+"<b>...</b>":n[11])+"",i;return{c(){e=g("span"),we(()=>n[15].call(e))},m(s,o){P(s,e,o),e.innerHTML=t,i=sn(e,n[15].bind(e))},p(s,o){o[0]&2144&&t!==(t=(s[6]>s[5]*.8?s[11].slice(0,20)+"<b>...</b>":s[11])+"")&&(e.innerHTML=t)},d(s){s&&A(e),i()}}}function El(n){let e;return{c(){e=g("span"),e.textContent="New changes! Exiting will erase them.",m(e,"id","alert")},m(t,i){P(t,e,i)},d(t){t&&A(e)}}}function yg(n){let e,t,i,s,o,r=n[11],l,a,c,u,d,f,h,p,b,v,w,k,y,I,D=275-n[2].length+"",W,S,q,z,Q,N,E,T,$,R,L,F,j,Y,fe,te,re,B,J,de,qe,ve=Cl(n),Ie=n[1]!=null&&n[1]!=n[2]&&El();function nt(pe){n[26](pe)}function st(pe){n[27](pe)}function Le(pe){n[28](pe)}let ue={};return n[0]!==void 0&&(ue.chosenBuild=n[0]),n[3]!==void 0&&(ue.ddOpen=n[3]),n[9]!==void 0&&(ue.dropdown=n[9]),Y=new Yo({props:ue}),ae.push(()=>Me(Y,"chosenBuild",nt)),ae.push(()=>Me(Y,"ddOpen",st)),ae.push(()=>Me(Y,"dropdown",Le)),Y.$on("buildSelect",n[29]),{c(){e=g("div"),t=g("div"),i=g("span"),i.textContent="Save to:",s=C(),o=g("button"),ve.c(),l=C(),a=g("iconify-icon"),d=C(),f=g("div"),h=g("div"),p=g("span"),p.textContent="Description / Notes:",b=C(),Ie&&Ie.c(),v=C(),w=g("textarea"),y=C(),I=g("span"),W=ce(D),S=C(),q=g("div"),z=g("div"),Q=g("button"),N=ce("CANCEL"),T=C(),$=g("div"),R=g("button"),L=ce("SAVE"),j=C(),le(Y.$$.fragment),Ae(a,"icon","iconamoon:arrow-down-2-fill"),m(o,"id","firstFocusable"),o.disabled=c=n[12].save.status==0,m(o,"class","promptDDButton svelte-106wt5q"),we(()=>n[17].call(o)),ne(o,"ddOpen",n[3]),m(t,"class","chosenBuildCont"),m(w,"class","buildDescInput"),w.disabled=k=n[12].save.status==0,m(w,"placeholder","[Empty]"),m(w,"maxlength","275"),m(w,"autocomplete","off"),m(I,"class","charCounter"),m(I,"id","buildDesc"),m(f,"class","buildDescCont"),Q.disabled=E=n[12].save.status==0,m(R,"id","lastFocusable"),R.disabled=F=n[12].save.status==0,m(q,"class","promptOptions"),m(e,"class","buildSaver")},m(pe,$e){P(pe,e,$e),_(e,t),_(t,i),_(t,s),_(t,o),ve.m(o,null),_(o,l),_(o,a),n[16](o),u=sn(o,n[17].bind(o)),_(e,d),_(e,f),_(f,h),_(h,p),_(h,b),Ie&&Ie.m(h,null),_(f,v),_(f,w),n[19](w),qt(w,n[10]),_(f,y),_(f,I),_(I,W),_(e,S),_(e,q),_(q,z),_(z,Q),_(Q,N),n[23](Q),_(q,T),_(q,$),_($,R),_(R,L),_(e,j),ie(Y,e,null),J=!0,de||(qe=[O(window,"mousedown",n[14]),O(o,"click",n[18]),O(o,"keydown",vt),O(w,"input",n[20]),O(w,"input",n[21]),O(w,"keydown",n[22]),O(Q,"click",n[24]),O(R,"click",n[25]),O(R,"keydown",yt),O(e,"introstart",n[30]),O(e,"keydown",n[31])],de=!0)},p(pe,$e){$e[0]&2048&&ge(r,r=pe[11])?(ve.d(1),ve=Cl(pe),ve.c(),ve.m(o,l)):ve.p(pe,$e),(!J||$e[0]&4096&&c!==(c=pe[12].save.status==0))&&(o.disabled=c),(!J||$e[0]&8)&&ne(o,"ddOpen",pe[3]),pe[1]!=null&&pe[1]!=pe[2]?Ie||(Ie=El(),Ie.c(),Ie.m(h,null)):Ie&&(Ie.d(1),Ie=null),(!J||$e[0]&4096&&k!==(k=pe[12].save.status==0))&&(w.disabled=k),$e[0]&1024&&qt(w,pe[10]),(!J||$e[0]&4)&&D!==(D=275-pe[2].length+"")&&Se(W,D),(!J||$e[0]&4096&&E!==(E=pe[12].save.status==0))&&(Q.disabled=E),(!J||$e[0]&4096&&F!==(F=pe[12].save.status==0))&&(R.disabled=F);const Je={};!fe&&$e[0]&1&&(fe=!0,Je.chosenBuild=pe[0],Pe(()=>fe=!1)),!te&&$e[0]&8&&(te=!0,Je.ddOpen=pe[3],Pe(()=>te=!1)),!re&&$e[0]&512&&(re=!0,Je.dropdown=pe[9],Pe(()=>re=!1)),Y.$set(Je)},i(pe){J||(M(Y.$$.fragment,pe),pe&&we(()=>{J&&(B||(B=me(e,xe,{duration:250},!0)),B.run(1))}),J=!0)},o(pe){H(Y.$$.fragment,pe),pe&&(B||(B=me(e,xe,{duration:250},!1)),B.run(0)),J=!1},d(pe){pe&&A(e),ve.d(pe),n[16](null),u(),Ie&&Ie.d(),n[19](null),n[23](null),se(Y),pe&&B&&B.end(),de=!1,be(qe)}}}function wg(n,e,t){let i,s,o,r,l,a,c,u;X(n,x,B=>t(12,r=B)),X(n,wt,B=>t(32,l=B)),X(n,Ot,B=>t(33,a=B)),X(n,jt,B=>t(34,c=B)),X(n,Lt,B=>t(35,u=B));let d=!1,f,h,p,b,v,w,k=Object.entries(a)[0],y=null;function I(){G(x,r.save.status=0,r);let B=au(u,c),J=y==null?s:y==""?"[Empty]":y,de=k[1].id;B.name=i,B.desc=J,_s(Yt(Hn(Gn),`builds/${de}`),B).then(()=>{G(x,r.save.status=1,r);let qe={...a};qe[i].desc=J,Vo(),Ot.update(()=>qe),G(wt,l=B,l),G(wt,l.id=de,l)}).catch(()=>{G(x,r.save.status=-1,r),G(x,r.message="firebase_fail",r)})}const D=B=>{!f.contains(B.target)&&!w.contains(B.target)&&t(3,d=!1)};function W(){p=this.offsetWidth,t(6,p)}function S(B){ae[B?"unshift":"push"](()=>{f=B,t(4,f)})}function q(){h=this.offsetWidth,t(5,h)}const z=()=>{r.save.status!=0&&t(3,d=!d)};function Q(B){ae[B?"unshift":"push"](()=>{b=B,t(7,b)})}function N(){o=this.value,t(10,o),t(1,y),t(2,s),t(0,k)}const E=B=>{t(1,y=ts(B.target.value,275))},T=B=>{r.save.status==0&&B.preventDefault(),to(b,B.target.value,275)};function $(B){ae[B?"unshift":"push"](()=>{v=B,t(8,v)})}const R=()=>{r.save.status!=0&&G(x,r.save.ongoing=!1,r)},L=()=>{r.save.status!=0&&I()};function F(B){k=B,t(0,k)}function j(B){d=B,t(3,d)}function Y(B){w=B,t(9,w)}const fe=()=>t(1,y=null),te=()=>v.focus(),re=B=>{B.key=="Escape"&&(t(3,d=!1),f.focus())};return n.$$.update=()=>{n.$$.dirty[0]&1&&t(11,i=k[0]),n.$$.dirty[0]&1&&t(2,s=k[1].desc),n.$$.dirty[0]&6&&t(10,o=y??s)},[k,y,s,d,f,h,p,b,v,w,o,i,r,I,D,W,S,q,z,Q,N,E,T,$,R,L,F,j,Y,fe,te,re]}class kg extends Re{constructor(e){super(),De(this,e,wg,yg,ge,{},null,[-1,-1])}}function Cg(n){let e,t,i,s,o,r,l,a,c;return{c(){e=g("div"),t=g("span"),t.textContent="ID:",i=C(),s=g("input"),m(s,"class","buildIDInput svelte-w8elgk"),s.disabled=o=n[11].load.status==0,m(s,"type","text"),m(s,"placeholder","Example ID: -NDqeA1Scn0EAJcYWN3b"),m(s,"maxlength","25"),m(e,"class","buildIDCont svelte-w8elgk")},m(u,d){P(u,e,d),_(e,t),_(e,i),_(e,s),n[23](s),qt(s,n[10]),l=!0,a||(c=[O(s,"input",n[24]),O(s,"input",n[25]),O(s,"keydown",n[26])],a=!0)},p(u,d){(!l||d[0]&2048&&o!==(o=u[11].load.status==0))&&(s.disabled=o),d[0]&1024&&s.value!==u[10]&&qt(s,u[10])},i(u){l||(u&&we(()=>{l&&(r||(r=me(e,Ze,{duration:150},!0)),r.run(1))}),l=!0)},o(u){u&&(r||(r=me(e,Ze,{duration:150},!1)),r.run(0)),l=!1},d(u){u&&A(e),n[23](null),u&&r&&r.end(),a=!1,be(c)}}}function Eg(n){let e,t,i,s,o=n[9],r,l,a,c,u,d,f,h,p=Sl(n);return{c(){e=g("div"),t=g("span"),t.textContent="Load:",i=C(),s=g("button"),p.c(),r=C(),l=g("iconify-icon"),Ae(l,"icon","iconamoon:arrow-down-2-fill"),s.disabled=a=n[11].load.status==0,m(s,"class","promptDDButton svelte-w8elgk"),we(()=>n[21].call(s)),ne(s,"ddOpen",n[8]),m(e,"class","chosenBuildCont svelte-w8elgk")},m(b,v){P(b,e,v),_(e,t),_(e,i),_(e,s),p.m(s,null),_(s,r),_(s,l),n[20](s),c=sn(s,n[21].bind(s)),d=!0,f||(h=O(s,"click",n[22]),f=!0)},p(b,v){v[0]&512&&ge(o,o=b[9])?(p.d(1),p=Sl(b),p.c(),p.m(s,r)):p.p(b,v),(!d||v[0]&2048&&a!==(a=b[11].load.status==0))&&(s.disabled=a),(!d||v[0]&256)&&ne(s,"ddOpen",b[8])},i(b){d||(b&&we(()=>{d&&(u||(u=me(e,Ze,{duration:150},!0)),u.run(1))}),d=!0)},o(b){b&&(u||(u=me(e,Ze,{duration:150},!1)),u.run(0)),d=!1},d(b){b&&A(e),p.d(b),n[20](null),c(),b&&u&&u.end(),f=!1,h()}}}function Sl(n){let e,t=(n[6]>n[5]*.7?n[9].slice(0,20)+"<b>...</b>":n[9])+"",i;return{c(){e=g("span"),we(()=>n[19].call(e))},m(s,o){P(s,e,o),e.innerHTML=t,i=sn(e,n[19].bind(e))},p(s,o){o[0]&608&&t!==(t=(s[6]>s[5]*.7?s[9].slice(0,20)+"<b>...</b>":s[9])+"")&&(e.innerHTML=t)},d(s){s&&A(e),i()}}}function Il(n){let e,t,i,s,o;function r(u){n[29](u)}function l(u){n[30](u)}function a(u){n[31](u)}let c={};return n[3]!==void 0&&(c.chosenBuild=n[3]),n[8]!==void 0&&(c.ddOpen=n[8]),n[7]!==void 0&&(c.dropdown=n[7]),e=new Yo({props:c}),ae.push(()=>Me(e,"chosenBuild",r)),ae.push(()=>Me(e,"ddOpen",l)),ae.push(()=>Me(e,"dropdown",a)),{c(){le(e.$$.fragment)},m(u,d){ie(e,u,d),o=!0},p(u,d){const f={};!t&&d[0]&8&&(t=!0,f.chosenBuild=u[3],Pe(()=>t=!1)),!i&&d[0]&256&&(i=!0,f.ddOpen=u[8],Pe(()=>i=!1)),!s&&d[0]&128&&(s=!0,f.dropdown=u[7],Pe(()=>s=!1)),e.$set(f)},i(u){o||(M(e.$$.fragment,u),o=!0)},o(u){H(e.$$.fragment,u),o=!1},d(u){se(e,u)}}}function Sg(n){let e,t,i,s,o,r,l,a,c,u,d,f,h,p,b,v,w,k,y,I,D,W,S,q,z,Q,N,E,T,$,R,L,F,j,Y;const fe=[Eg,Cg],te=[];function re(J,de){return J[2]?0:1}k=re(n),y=te[k]=fe[k](n);let B=n[2]&&Il(n);return{c(){e=g("div"),t=g("span"),t.textContent="Load build via:",i=C(),s=g("div"),o=g("div"),r=g("button"),l=ce("Local saves"),u=C(),d=g("div"),f=g("button"),h=ce("Exported ID"),v=C(),w=g("div"),y.c(),I=C(),D=g("div"),W=g("div"),S=g("button"),q=ce("CANCEL"),Q=C(),N=g("div"),E=g("button"),T=ce("LOAD"),R=C(),B&&B.c(),m(t,"class","svelte-w8elgk"),m(r,"id",a=n[2]?"firstFocusable":""),r.disabled=c=n[11].load.status==0||!n[12],m(r,"class","svelte-w8elgk"),ne(r,"chosen",n[2]),ne(r,"unavailable",!n[12]),m(o,"class","svelte-w8elgk"),m(f,"id",p=n[2]?"":"firstFocusable"),f.disabled=b=n[11].load.status==0,m(f,"class","svelte-w8elgk"),ne(f,"chosen",!n[2]),m(d,"class","svelte-w8elgk"),m(s,"class","loadMethodRadio svelte-w8elgk"),m(w,"class","loadMethodCont svelte-w8elgk"),S.disabled=z=n[11].load.status==0,m(E,"id","lastFocusable"),E.disabled=$=n[11].load.status==0,m(D,"class","promptOptions svelte-w8elgk"),m(e,"class","buildLoader svelte-w8elgk")},m(J,de){P(J,e,de),_(e,t),_(e,i),_(e,s),_(s,o),_(o,r),_(r,l),_(s,u),_(s,d),_(d,f),_(f,h),_(e,v),_(e,w),te[k].m(w,null),_(e,I),_(e,D),_(D,W),_(W,S),_(S,q),n[27](S),_(D,Q),_(D,N),_(N,E),_(E,T),_(e,R),B&&B.m(e,null),F=!0,j||(Y=[O(window,"mousedown",n[14]),O(r,"click",n[15]),O(r,"keydown",n[16]),O(f,"click",n[17]),O(f,"keydown",n[18]),O(S,"click",n[28]),O(E,"keydown",yt),O(E,"click",n[13]),O(e,"introstart",n[32]),O(e,"keydown",n[33])],j=!0)},p(J,de){(!F||de[0]&4&&a!==(a=J[2]?"firstFocusable":""))&&m(r,"id",a),(!F||de[0]&6144&&c!==(c=J[11].load.status==0||!J[12]))&&(r.disabled=c),(!F||de[0]&4)&&ne(r,"chosen",J[2]),(!F||de[0]&4096)&&ne(r,"unavailable",!J[12]),(!F||de[0]&4&&p!==(p=J[2]?"":"firstFocusable"))&&m(f,"id",p),(!F||de[0]&2048&&b!==(b=J[11].load.status==0))&&(f.disabled=b),(!F||de[0]&4)&&ne(f,"chosen",!J[2]);let qe=k;k=re(J),k===qe?te[k].p(J,de):(We(),H(te[qe],1,1,()=>{te[qe]=null}),He(),y=te[k],y?y.p(J,de):(y=te[k]=fe[k](J),y.c()),M(y,1),y.m(w,null)),(!F||de[0]&2048&&z!==(z=J[11].load.status==0))&&(S.disabled=z),(!F||de[0]&2048&&$!==($=J[11].load.status==0))&&(E.disabled=$),J[2]?B?(B.p(J,de),de[0]&4&&M(B,1)):(B=Il(J),B.c(),M(B,1),B.m(e,null)):B&&(We(),H(B,1,1,()=>{B=null}),He())},i(J){F||(M(y),M(B),J&&we(()=>{F&&(L||(L=me(e,xe,{duration:250},!0)),L.run(1))}),F=!0)},o(J){H(y),H(B),J&&(L||(L=me(e,xe,{duration:250},!1)),L.run(0)),F=!1},d(J){J&&A(e),te[k].d(),n[27](null),B&&B.d(),J&&L&&L.end(),j=!1,be(Y)}}}function Ig(n,e,t){let i,s,o;X(n,x,B=>t(11,i=B)),X(n,Ot,B=>t(34,s=B)),X(n,Jt,B=>t(12,o=B));const r=Ht();let l,a,c,u,d,f,h=o,p=!1,b=o?Object.entries(s)[0]:null,v,w="";function k(){if(!h&&!w.startsWith("-N")){G(x,i.load.status=-1,i),G(x,i.message="invalid_id",i);return}let B=eu(Hn(Gn,"builds"),$c()),J=0;G(x,i.load.status=0,i),xc(B).then(de=>{let qe=h?b[1].id:w;for(let ve in de.val()){if(ve==qe){r("buildLoad",{build:de.val()[ve],id:ve});break}else J==Object.keys(de.val()).length-1&&(G(x,i.load.status=-1,i),G(x,i.message=h?"not_found":"invalid_id",i));J++}}).catch(()=>{G(x,i.load.status=-1,i),G(x,i.message="firebase_fail",i)})}const y=B=>{l&&!l.contains(B.target)&&!f.contains(B.target)&&t(8,p=!1)},I=()=>{i.load.status!=0&&o&&t(2,h=!0)},D=B=>{h&&vt(B)},W=()=>{i.load.status!=0&&t(2,h=!1)},S=B=>{h||vt(B)};function q(){d=this.offsetWidth,t(6,d)}function z(B){ae[B?"unshift":"push"](()=>{l=B,t(0,l)})}function Q(){u=this.offsetWidth,t(5,u)}const N=()=>{i.load.status!=0&&t(8,p=!p)};function E(B){ae[B?"unshift":"push"](()=>{c=B,t(1,c)})}function T(){w=this.value,t(10,w)}const $=B=>{t(10,w=ts(B.target.value,25))},R=B=>{i.load.status==0&&B.preventDefault()};function L(B){ae[B?"unshift":"push"](()=>{a=B,t(4,a)})}const F=()=>{i.load.status!=0&&G(x,i.load.ongoing=!1,i)};function j(B){b=B,t(3,b)}function Y(B){p=B,t(8,p)}function fe(B){f=B,t(7,f)}const te=()=>a.focus(),re=B=>{B.key=="Escape"&&(t(8,p=!1),l.focus())};return n.$$.update=()=>{n.$$.dirty[0]&8&&t(9,v=b!=null?b[0]:null),n.$$.dirty[0]&7&&setTimeout(h?()=>l.focus():()=>c.focus())},[l,c,h,b,a,u,d,f,p,v,w,i,o,k,y,I,D,W,S,q,z,Q,N,E,T,$,R,L,F,j,Y,fe,te,re]}class Tg extends Re{constructor(e){super(),De(this,e,Ig,Sg,ge,{},null,[-1,-1])}}function Tl(n){let e,t=(n[3]>n[4]*.8?n[8].slice(0,20)+"<b>...</b>":n[8])+"",i;return{c(){e=g("span"),we(()=>n[12].call(e))},m(s,o){P(s,e,o),e.innerHTML=t,i=sn(e,n[12].bind(e))},p(s,o){o&280&&t!==(t=(s[3]>s[4]*.8?s[8].slice(0,20)+"<b>...</b>":s[8])+"")&&(e.innerHTML=t)},d(s){s&&A(e),i()}}}function Ng(n){let e,t,i,s,o,r=n[8],l,a,c,u,d,f,h,p,b,v,w,k,y,I,D,W,S,q,z,Q,N,E,T,$,R,L,F,j,Y=Tl(n);f=new mt({props:{text:"I'm aware that this action is irreversible and want to erase this build from the database."}}),f.$on("toggle",n[16]);function fe(J){n[21](J)}function te(J){n[22](J)}function re(J){n[23](J)}let B={};return n[0]!==void 0&&(B.chosenBuild=n[0]),n[6]!==void 0&&(B.ddOpen=n[6]),n[5]!==void 0&&(B.dropdown=n[5]),N=new Yo({props:B}),ae.push(()=>Me(N,"chosenBuild",fe)),ae.push(()=>Me(N,"ddOpen",te)),ae.push(()=>Me(N,"dropdown",re)),{c(){e=g("div"),t=g("div"),i=g("span"),i.textContent="Delete:",s=C(),o=g("button"),Y.c(),l=C(),a=g("iconify-icon"),d=C(),le(f.$$.fragment),h=C(),p=g("div"),b=g("div"),v=g("button"),w=ce("CANCEL"),I=C(),D=g("div"),W=g("button"),S=ce("DELETE"),Q=C(),le(N.$$.fragment),Ae(a,"icon","iconamoon:arrow-down-2-fill"),m(o,"class","promptDDButton svelte-1t9ajmz"),m(o,"id","firstFocusable"),o.disabled=c=n[9].delete.status==0,we(()=>n[14].call(o)),ne(o,"ddOpen",n[6]),m(t,"class","chosenBuildCont"),m(v,"id",k=n[7]?"":"lastFocusable"),v.disabled=y=n[9].delete.status==0,W.disabled=q=!n[7]||n[9].delete.status==0,m(W,"id",z=n[7]?"lastFocusable":""),ne(W,"unavailable",!n[7]),m(p,"class","promptOptions svelte-1t9ajmz"),m(e,"class","buildDeleter svelte-1t9ajmz")},m(J,de){P(J,e,de),_(e,t),_(t,i),_(t,s),_(t,o),Y.m(o,null),_(o,l),_(o,a),n[13](o),u=sn(o,n[14].bind(o)),_(e,d),ie(f,e,null),_(e,h),_(e,p),_(p,b),_(b,v),_(v,w),n[17](v),_(p,I),_(p,D),_(D,W),_(W,S),_(e,Q),ie(N,e,null),L=!0,F||(j=[O(window,"mousedown",n[11]),O(o,"click",n[15]),O(o,"keydown",vt),O(v,"click",n[18]),O(v,"keydown",n[19]),O(W,"click",n[20]),O(W,"keydown",yt),O(e,"introstart",n[24]),O(e,"keydown",n[25])],F=!0)},p(J,[de]){de&256&&ge(r,r=J[8])?(Y.d(1),Y=Tl(J),Y.c(),Y.m(o,l)):Y.p(J,de),(!L||de&512&&c!==(c=J[9].delete.status==0))&&(o.disabled=c),(!L||de&64)&&ne(o,"ddOpen",J[6]),(!L||de&128&&k!==(k=J[7]?"":"lastFocusable"))&&m(v,"id",k),(!L||de&512&&y!==(y=J[9].delete.status==0))&&(v.disabled=y),(!L||de&640&&q!==(q=!J[7]||J[9].delete.status==0))&&(W.disabled=q),(!L||de&128&&z!==(z=J[7]?"lastFocusable":""))&&m(W,"id",z),(!L||de&128)&&ne(W,"unavailable",!J[7]);const qe={};!E&&de&1&&(E=!0,qe.chosenBuild=J[0],Pe(()=>E=!1)),!T&&de&64&&(T=!0,qe.ddOpen=J[6],Pe(()=>T=!1)),!$&&de&32&&($=!0,qe.dropdown=J[5],Pe(()=>$=!1)),N.$set(qe)},i(J){L||(M(f.$$.fragment,J),M(N.$$.fragment,J),J&&we(()=>{L&&(R||(R=me(e,xe,{duration:250},!0)),R.run(1))}),L=!0)},o(J){H(f.$$.fragment,J),H(N.$$.fragment,J),J&&(R||(R=me(e,xe,{duration:250},!1)),R.run(0)),L=!1},d(J){J&&A(e),Y.d(J),n[13](null),u(),se(f),n[17](null),se(N),J&&R&&R.end(),F=!1,be(j)}}}function Og(n,e,t){let i,s,o,r;X(n,x,R=>t(9,s=R)),X(n,Ot,R=>t(26,o=R)),X(n,wt,R=>t(27,r=R));let l,a,c,u,d,f=!1,h=Object.entries(o)[0],p=!1;function b(){G(x,s.delete.status=0,s);let R=h[1].id;p_(Yt(Hn(Gn),`builds/${R}`)).then(()=>{G(x,s.delete.status=1,s),r&&R==r.id&&G(wt,r=null,r);let L={...o};delete L[i],Vo(),Ot.update(()=>L)}).catch(L=>{G(x,s.delete.status=-1,s),G(x,s.message="firebase_fail",s)})}const v=R=>{!a.contains(R.target)&&!d.contains(R.target)&&t(6,f=!1)};function w(){c=this.offsetWidth,t(3,c)}function k(R){ae[R?"unshift":"push"](()=>{a=R,t(2,a)})}function y(){u=this.offsetWidth,t(4,u)}const I=()=>{s.delete.status!=0&&t(6,f=!f)},D=R=>t(7,p=R.detail);function W(R){ae[R?"unshift":"push"](()=>{l=R,t(1,l)})}const S=()=>{s.delete.status!=0&&G(x,s.delete.ongoing=!1,s)},q=R=>{p||yt(R)},z=()=>{p&&s.delete.status!=0&&b()};function Q(R){h=R,t(0,h)}function N(R){f=R,t(6,f)}function E(R){d=R,t(5,d)}const T=()=>l.focus(),$=R=>{R.key=="Escape"&&(t(6,f=!1),a.focus())};return n.$$.update=()=>{n.$$.dirty&1&&t(8,i=h[0])},[h,l,a,c,u,d,f,p,i,s,b,v,w,k,y,I,D,W,S,q,z,Q,N,E,T,$]}class Dg extends Re{constructor(e){super(),De(this,e,Og,Ng,ge,{})}}function Rg(n){let e,t,i,s,o,r,l,a,c,u,d,f,h,p;return{c(){e=g("div"),t=g("div"),i=g("button"),i.innerHTML='<iconify-icon icon="tabler:coins" class="svelte-czj12i"></iconify-icon> <span class="tooltip" id="right">Build costs</span>',s=C(),o=g("div"),r=g("button"),r.innerHTML='<iconify-icon icon="codicon:sparkle-filled" class="svelte-czj12i"></iconify-icon> <span class="tooltip" id="right">Add bonuses</span>',l=C(),a=g("div"),c=g("button"),c.innerHTML='<iconify-icon icon="fa-solid:random" class="svelte-czj12i"></iconify-icon> <span class="tooltip" id="right">Randomize build</span>',u=C(),d=g("div"),f=g("button"),f.innerHTML='<iconify-icon icon="fe:picture" class="svelte-czj12i"></iconify-icon> <span class="tooltip" id="right">Screenshot mode</span>',m(i,"class","svelte-czj12i"),m(t,"class","svelte-czj12i"),m(r,"class","svelte-czj12i"),m(o,"class","svelte-czj12i"),m(c,"class","svelte-czj12i"),m(a,"id","randomize"),m(a,"class","svelte-czj12i"),m(f,"class","svelte-czj12i"),m(d,"id","screenshot"),m(d,"class","svelte-czj12i"),m(e,"class","sideFeatures svelte-czj12i")},m(b,v){P(b,e,v),_(e,t),_(t,i),_(e,s),_(e,o),_(o,r),_(e,l),_(e,a),_(a,c),_(e,u),_(e,d),_(d,f),h||(p=[O(i,"click",n[2]),O(r,"click",n[3]),O(c,"click",n[4]),O(f,"click",n[5])],h=!0)},p:oe,i:oe,o:oe,d(b){b&&A(e),h=!1,be(p)}}}function Ag(n,e,t){let i,s;return X(n,bn,c=>t(0,i=c)),X(n,x,c=>t(1,s=c)),[i,s,c=>{nn(c),i||G(x,s.costs.ongoing=!0,s)},c=>{nn(c),i||G(x,s.bonus.ongoing=!0,s)},c=>{nn(c),i||G(x,s.randomize.ongoing=!0,s)},()=>{i||(G(x,s.screenshot.ongoing=!0,s),setTimeout(()=>G(x,s.screenshot.ongoing=!1,s),3500))}]}class Pg extends Re{constructor(e){super(),De(this,e,Ag,Rg,ge,{})}}function Nl(n,e,t){const i=n.slice();i[11]=e[t];const s=i[1].bonuses[0].name==i[11].name;return i[12]=s,i}function Ol(n){let e,t,i,s,o,r,l,a,c,u,d,f;function h(...b){return n[5](n[12],...b)}function p(...b){return n[6](n[11],...b)}return a=new mt({props:{text:n[11].name,checked:n[2][n[11].name]}}),a.$on("toggle",p),{c(){e=g("div"),t=g("a"),i=g("img"),l=C(),le(a.$$.fragment),c=C(),tt(i.src,s=n[11].image)||m(i,"src",s),m(i,"alt",""),m(i,"class","svelte-1xnyxhr"),m(t,"id",o=n[12]?"firstFocusable":""),m(t,"href",r=n[11].link),m(t,"target","_blank"),m(t,"class","svelte-1xnyxhr"),m(e,"class","svelte-1xnyxhr")},m(b,v){P(b,e,v),_(e,t),_(t,i),_(e,l),ie(a,e,null),_(e,c),u=!0,d||(f=O(t,"keydown",h),d=!0)},p(b,v){n=b,(!u||v&2&&!tt(i.src,s=n[11].image))&&m(i,"src",s),(!u||v&2&&o!==(o=n[12]?"firstFocusable":""))&&m(t,"id",o),(!u||v&2&&r!==(r=n[11].link))&&m(t,"href",r);const w={};v&2&&(w.text=n[11].name),v&6&&(w.checked=n[2][n[11].name]),a.$set(w)},i(b){u||(M(a.$$.fragment,b),u=!0)},o(b){H(a.$$.fragment,b),u=!1},d(b){b&&A(e),se(a),d=!1,f()}}}function Mg(n){let e,t,i,s,o,r,l,a,c,u,d,f,h,p=Oe(n[1].bonuses),b=[];for(let w=0;w<p.length;w+=1)b[w]=Ol(Nl(n,p,w));const v=w=>H(b[w],1,1,()=>{b[w]=null});return{c(){e=g("div"),t=g("div");for(let w=0;w<b.length;w+=1)b[w].c();i=C(),s=g("div"),o=g("div"),r=g("button"),r.textContent="CLEAR",l=C(),a=g("div"),c=g("button"),c.textContent="OK",m(t,"class","bonusesCont svelte-1xnyxhr"),m(c,"id","lastFocusable"),m(s,"class","promptOptions svelte-1xnyxhr"),m(e,"class","bonusChooser svelte-1xnyxhr")},m(w,k){P(w,e,k),_(e,t);for(let y=0;y<b.length;y+=1)b[y]&&b[y].m(t,null);_(e,i),_(e,s),_(s,o),_(o,r),_(s,l),_(s,a),_(a,c),n[8](c),d=!0,f||(h=[O(r,"click",n[7]),O(c,"click",n[9]),O(c,"keydown",yt),O(e,"introstart",n[10])],f=!0)},p(w,[k]){if(k&14){p=Oe(w[1].bonuses);let y;for(y=0;y<p.length;y+=1){const I=Nl(w,p,y);b[y]?(b[y].p(I,k),M(b[y],1)):(b[y]=Ol(I),b[y].c(),M(b[y],1),b[y].m(t,null))}for(We(),y=p.length;y<b.length;y+=1)v(y);He()}},i(w){if(!d){for(let k=0;k<p.length;k+=1)M(b[k]);w&&we(()=>{d&&(u||(u=me(e,xe,{duration:250},!0)),u.run(1))}),d=!0}},o(w){b=b.filter(Boolean);for(let k=0;k<b.length;k+=1)H(b[k]);w&&(u||(u=me(e,xe,{duration:250},!1)),u.run(0)),d=!1},d(w){w&&A(e),ht(b,w),n[8](null),w&&u&&u.end(),f=!1,be(h)}}}function Lg(n,e,t){let i,s,o,r;X(n,Mt,p=>t(1,i=p)),X(n,Pn,p=>t(2,s=p)),X(n,gt,p=>t(3,o=p)),X(n,x,p=>t(4,r=p));let l;const a=(p,b)=>{p&&vt(b)},c=(p,b)=>{G(Pn,s[p.name]=b.detail,s);for(let v in o)b.detail?G(gt,o[v]+=p.stats[v],o):G(gt,o[v]-=p.stats[v],o),G(gt,o[v]=Math.round(o[v]*10)/10,o)},u=()=>{for(let p in s){if(!s[p])continue;let b=i.bonuses.find(v=>v.name==p);G(Pn,s[p]=!1,s);for(let v in o)G(gt,o[v]-=b.stats[v],o),G(gt,o[v]=Math.round(o[v]*10)/10,o)}};function d(p){ae[p?"unshift":"push"](()=>{l=p,t(0,l)})}return[l,i,s,o,r,a,c,u,d,()=>G(x,r.bonus.ongoing=!1,r),()=>l.focus()]}class Fg extends Re{constructor(e){super(),De(this,e,Lg,Mg,ge,{})}}function Bg(n){let e;return{c(){e=g("span"),e.textContent=`Includes equipment such as ore-based armor and their variants,\r
            ore-based weapons, and shoes with no special stats`,m(e,"slot","tooltip"),m(e,"class","tooltip svelte-19uqsbs"),m(e,"id","right")},m(t,i){P(t,e,i)},p:oe,d(t){t&&A(e)}}}function qg(n){let e,t,i,s,o,r,l,a,c,u,d,f,h,p,b,v,w,k,y,I,D,W,S,q,z,Q;return s=new mt({props:{text:"Force Mushroom Parasol",checked:n[0].parasol,first:!0}}),s.$on("toggle",n[5]),r=new mt({props:{text:"Randomize armor",checked:n[0].armor}}),r.$on("toggle",n[6]),a=new mt({props:{text:"Randomize gear",checked:n[0].gear}}),a.$on("toggle",n[7]),u=new mt({props:{text:"Allow 'basic' equipment",checked:n[0].basic,$$slots:{tooltip:[Bg]},$$scope:{ctx:n}}}),u.$on("toggle",n[8]),{c(){e=g("div"),t=g("span"),t.textContent="Randomize your build",i=C(),le(s.$$.fragment),o=C(),le(r.$$.fragment),l=C(),le(a.$$.fragment),c=C(),le(u.$$.fragment),d=C(),f=g("div"),h=g("div"),p=g("button"),b=ce("CANCEL"),w=C(),k=g("div"),y=g("button"),I=ce("ROLL THE DICE"),m(t,"class","svelte-19uqsbs"),m(p,"id",v=n[2]?"":"lastFocusable"),m(y,"id",D=n[2]?"lastFocusable":""),y.disabled=W=!n[2],m(f,"class","promptOptions"),m(e,"class","buildRandomizer svelte-19uqsbs")},m(N,E){P(N,e,E),_(e,t),_(e,i),ie(s,e,null),_(e,o),ie(r,e,null),_(e,l),ie(a,e,null),_(e,c),ie(u,e,null),_(e,d),_(e,f),_(f,h),_(h,p),_(p,b),n[9](p),_(f,w),_(f,k),_(k,y),_(y,I),q=!0,z||(Q=[O(p,"click",n[10]),O(p,"keydown",n[11]),O(y,"click",n[12]),O(y,"keydown",n[13]),O(e,"introstart",n[14])],z=!0)},p(N,[E]){const T={};E&1&&(T.checked=N[0].parasol),s.$set(T);const $={};E&1&&($.checked=N[0].armor),r.$set($);const R={};E&1&&(R.checked=N[0].gear),a.$set(R);const L={};E&1&&(L.checked=N[0].basic),E&16777216&&(L.$$scope={dirty:E,ctx:N}),u.$set(L),(!q||E&4&&v!==(v=N[2]?"":"lastFocusable"))&&m(p,"id",v),(!q||E&4&&D!==(D=N[2]?"lastFocusable":""))&&m(y,"id",D),(!q||E&4&&W!==(W=!N[2]))&&(y.disabled=W)},i(N){q||(M(s.$$.fragment,N),M(r.$$.fragment,N),M(a.$$.fragment,N),M(u.$$.fragment,N),N&&we(()=>{q&&(S||(S=me(e,xe,{duration:250},!0)),S.run(1))}),q=!0)},o(N){H(s.$$.fragment,N),H(r.$$.fragment,N),H(a.$$.fragment,N),H(u.$$.fragment,N),N&&(S||(S=me(e,xe,{duration:250},!1)),S.run(0)),q=!1},d(N){N&&A(e),se(s),se(r),se(a),se(u),n[9](null),N&&S&&S.end(),z=!1,be(Q)}}}function zg(n,e,t){let i,s,o,r,l,a,c,u;X(n,xn,N=>t(0,s=N)),X(n,x,N=>t(3,o=N)),X(n,Mt,N=>t(15,r=N)),X(n,qn,N=>t(16,l=N)),X(n,jt,N=>t(17,a=N)),X(n,Bn,N=>t(18,c=N)),X(n,Lt,N=>t(19,u=N));let d,f=["Bronze","Iron","Cobalt","Titanium","Gold","Onyx"],h=["Hardened","Royal"],p=["Black","Brown","Green","Red","White","Dark","Golden","Grey","Phantom"];function b(){if(s.armor){for(let N of Un){let E=u[N]||vs;E.name&&c[N][E.name].querySelector("button").click()}setTimeout(()=>{for(let N of Un)(function E(){let T=Math.floor(Math.random()*r[N].length);!c[N][r[N][T].name].classList.contains("selectedItem")&&(s.basic||!s.basic&&!v(r[N][T].name))?c[N][r[N][T].name].querySelector("button").click():E()})()})}if(s.gear){for(let N in a){let E=a[N]||ys;E.name&&l[N][E.name].querySelector("button").click()}setTimeout(()=>{let N=!1,E=Cn.length,T=Cn.length,$=[];for(let R in a)$.push(a[R].name);(function R(){setTimeout(()=>{let L=Math.floor(Math.random()*E);(function F(){let j=Math.floor(Math.random()*r.gear.length);!$.includes(r.gear[j].name)&&!l[T][r.gear[j].name].classList.contains("switchable")&&(!N||N&&j!=0)&&(s.basic||!s.basic&&!v(r.gear[j].name))?(l[T][r.gear[!N&&s.parasol&&!L?0:j].name].querySelector("button").click(),!N&&!L?N=!0:N||E--):F()})(),--T&&R()},25)})()},50)}G(x,o.randomize.ongoing=!1,o)}function v(N){let E=!1,T=N.split(" ");return E=f.includes(T[0])||h.includes(T[0])||N=="Mining Helmet"||p.includes(T[0]),E}const w=N=>G(xn,s.parasol=N.detail,s),k=N=>G(xn,s.armor=N.detail,s),y=N=>G(xn,s.gear=N.detail,s),I=N=>G(xn,s.basic=N.detail,s);function D(N){ae[N?"unshift":"push"](()=>{d=N,t(1,d)})}const W=()=>G(x,o.randomize.ongoing=!1,o),S=N=>{i||yt(N)},q=()=>{i&&b()},z=N=>{i&&yt(N)},Q=()=>d.focus();return n.$$.update=()=>{n.$$.dirty&1&&t(2,i=s.armor||s.gear)},[s,d,i,o,b,w,k,y,I,D,W,S,q,z,Q]}class jg extends Re{constructor(e){super(),De(this,e,zg,qg,ge,{})}}function Dl(n,e,t){const i=n.slice();return i[5]=e[t],i}function Wg(n){let e,t=Oe(n[1]),i=[];for(let s=0;s<t.length;s+=1)i[s]=Rl(Dl(n,t,s));return{c(){for(let s=0;s<i.length;s+=1)i[s].c();e=pt()},m(s,o){for(let r=0;r<i.length;r+=1)i[r]&&i[r].m(s,o);P(s,e,o)},p(s,o){if(o&2){t=Oe(s[1]);let r;for(r=0;r<t.length;r+=1){const l=Dl(s,t,r);i[r]?i[r].p(l,o):(i[r]=Rl(l),i[r].c(),i[r].m(e.parentNode,e))}for(;r<i.length;r+=1)i[r].d(1);i.length=t.length}},d(s){s&&A(e),ht(i,s)}}}function Hg(n){let e,t,i;return{c(){e=g("span"),t=ce("— "),i=ce(n[1]),m(e,"id","info"),m(e,"class","svelte-ipufpe")},m(s,o){P(s,e,o),_(e,t),_(e,i)},p(s,o){o&2&&Se(i,s[1])},d(s){s&&A(e)}}}function Rl(n){let e,t,i=n[5]+"",s;return{c(){e=g("span"),t=ce("— "),s=ce(i),m(e,"id","info"),m(e,"class","svelte-ipufpe")},m(o,r){P(o,e,r),_(e,t),_(e,s)},p(o,r){r&2&&i!==(i=o[5]+"")&&Se(s,i)},d(o){o&&A(e)}}}function Ug(n){let e,t,i,s,o,r,l;function a(d,f){return typeof d[1]=="string"?Hg:Wg}let c=a(n),u=c(n);return{c(){e=g("li"),t=g("span"),i=ce("v"),s=ce(n[0]),o=C(),r=g("i"),r.textContent=`${n[3][n[2][1]-1]+" "+n[2][0]+(Math.floor(n[2][0]/10)===1?"th":ou[n[2][0]%10])+", 20"+n[2][2]}`,l=C(),u.c(),m(t,"id","version"),m(t,"class","svelte-ipufpe"),m(r,"id","date"),m(r,"class","svelte-ipufpe"),m(e,"class","svelte-ipufpe")},m(d,f){P(d,e,f),_(e,t),_(t,i),_(t,s),_(e,o),_(e,r),_(e,l),u.m(e,null)},p(d,[f]){f&1&&Se(s,d[0]),c===(c=a(d))&&u?u.p(d,f):(u.d(1),u=c(d),u&&(u.c(),u.m(e,null)))},i:oe,o:oe,d(d){d&&A(e),u.d()}}}function Gg(n,e,t){let{version:i,date:s,text:o}=e,r=s.split("/"),l=["January","February","March","April","May","June","July","August","Semptember","October","November","December"];return n.$$set=a=>{"version"in a&&t(0,i=a.version),"date"in a&&t(4,s=a.date),"text"in a&&t(1,o=a.text)},[i,o,r,l,s]}class at extends Re{constructor(e){super(),De(this,e,Gg,Ug,ge,{version:0,date:4,text:1})}}function Vg(n){let e,t,i,s,o,r,l,a,c,u,d,f,h,p,b,v,w,k,y,I,D,W,S,q,z,Q,N,E,T,$,R,L,F,j,Y,fe,te,re,B,J,de,qe,ve,Ie,nt,st,Le;return o=new at({props:{version:"3.26.6",date:"28/3/24",text:"Added 'support me' link in the case of any kind act"}}),l=new at({props:{version:"3.26.5",date:"22/3/24",text:"Added policy information"}}),c=new at({props:{version:"3.26.4",date:"21/3/24",text:["Added feature to copy stats as text","Fixed detailed view prompt activating while scrolling"]}}),d=new at({props:{version:"3.26.3",date:"24/2/24",text:"Reimplemented 'Strict' filter type in search options"}}),h=new at({props:{version:"3.26.2",date:"22/2/24",text:"Fixed build randomizer not working properly"}}),b=new at({props:{version:"3.26.1",date:"22/2/24",text:"Holding Shift and interacting with a dropdown item or simply holding down on it activates detailed view prompt"}}),w=new at({props:{version:"3.26.0",date:"21/2/24",text:"Added detailed view prompt to armor and gear whenever the selected item's icon is clicked"}}),y=new at({props:{version:"3.25.9",date:"14/1/24",text:"Added build costs visibility while 'screenshot mode' is active"}}),D=new at({props:{version:"3.25.8",date:"11/1/24",text:"Fixed mutually exclusive gear staying disabled when deselecting the selected item"}}),S=new at({props:{version:"3.25.7",date:"9/1/24",text:["Enabled 'unsaved changes' prompt to appear before leaving site when certain conditions are met","Fixed dropdowns blocking interactions behind them for a short period after being closed","Fixed dropdown sort incorrectly defaulting to the last sorted list in some cases"]}}),z=new at({props:{version:"3.25.6",date:"7/1/24",text:"Fixed armor filter not working properly when 'Exclusive' filter type and 'No Stats' option were selected"}}),N=new at({props:{version:"3.25.5",date:"6/1/24",text:["Fixed issue with switching gear slots while full weapon view was on","Tools are now selectable even if full weapon view is on"]}}),T=new at({props:{version:"3.25.4",date:"5/1/24",text:'Fixed crash caused by using the build randomizer while "Force Mushroom Parasol" option was on'}}),R=new at({props:{version:"3.25.3",date:"5/1/24",text:["Added feature to swap gear slots when clicking on an already selected gear item","Added visual cues to both deselecting and swapping options for dropdown items"]}}),F=new at({props:{version:"3.25.2",date:"3/1/24",text:["Replaced 'Strict' filter type with 'Exclusive' filter type in search options of dropdowns","Added icons to resource links and credits"]}}),Y=new at({props:{version:"3.25.1",date:"2/1/24",text:`"Allow 'basic' equipment" option is no longer restricted when "Randomize gear" option isn't selected in the build randomizer`}}),te=new at({props:{version:"3.25.0",date:"2/1/24",text:["Added 'Build Costs' feature","Removed spectacles from 'basic' equipment pool in the build randomizer"]}}),B=new at({props:{version:"3.24.5",date:"31/12/23",text:"v3 Release"}}),{c(){e=g("div"),t=g("span"),t.textContent="Changelog",i=C(),s=g("ul"),le(o.$$.fragment),r=C(),le(l.$$.fragment),a=C(),le(c.$$.fragment),u=C(),le(d.$$.fragment),f=C(),le(h.$$.fragment),p=C(),le(b.$$.fragment),v=C(),le(w.$$.fragment),k=C(),le(y.$$.fragment),I=C(),le(D.$$.fragment),W=C(),le(S.$$.fragment),q=C(),le(z.$$.fragment),Q=C(),le(N.$$.fragment),E=C(),le(T.$$.fragment),$=C(),le(R.$$.fragment),L=C(),le(F.$$.fragment),j=C(),le(Y.$$.fragment),fe=C(),le(te.$$.fragment),re=C(),le(B.$$.fragment),J=C(),de=g("div"),qe=g("div"),ve=g("button"),ve.textContent="OK",m(t,"id","title"),m(s,"id","contents"),m(s,"class","svelte-1k91i9r"),m(ve,"id","firstFocusable lastFocusable"),m(de,"class","promptOptions svelte-1k91i9r"),m(e,"class","infoPrompt svelte-1k91i9r")},m(ue,pe){P(ue,e,pe),_(e,t),_(e,i),_(e,s),ie(o,s,null),_(s,r),ie(l,s,null),_(s,a),ie(c,s,null),_(s,u),ie(d,s,null),_(s,f),ie(h,s,null),_(s,p),ie(b,s,null),_(s,v),ie(w,s,null),_(s,k),ie(y,s,null),_(s,I),ie(D,s,null),_(s,W),ie(S,s,null),_(s,q),ie(z,s,null),_(s,Q),ie(N,s,null),_(s,E),ie(T,s,null),_(s,$),ie(R,s,null),_(s,L),ie(F,s,null),_(s,j),ie(Y,s,null),_(s,fe),ie(te,s,null),_(s,re),ie(B,s,null),_(e,J),_(e,de),_(de,qe),_(qe,ve),n[2](ve),nt=!0,st||(Le=[O(ve,"click",n[3]),O(ve,"keydown",n[4]),O(e,"introstart",n[5])],st=!0)},p:oe,i(ue){nt||(M(o.$$.fragment,ue),M(l.$$.fragment,ue),M(c.$$.fragment,ue),M(d.$$.fragment,ue),M(h.$$.fragment,ue),M(b.$$.fragment,ue),M(w.$$.fragment,ue),M(y.$$.fragment,ue),M(D.$$.fragment,ue),M(S.$$.fragment,ue),M(z.$$.fragment,ue),M(N.$$.fragment,ue),M(T.$$.fragment,ue),M(R.$$.fragment,ue),M(F.$$.fragment,ue),M(Y.$$.fragment,ue),M(te.$$.fragment,ue),M(B.$$.fragment,ue),ue&&we(()=>{nt&&(Ie||(Ie=me(e,xe,{duration:250},!0)),Ie.run(1))}),nt=!0)},o(ue){H(o.$$.fragment,ue),H(l.$$.fragment,ue),H(c.$$.fragment,ue),H(d.$$.fragment,ue),H(h.$$.fragment,ue),H(b.$$.fragment,ue),H(w.$$.fragment,ue),H(y.$$.fragment,ue),H(D.$$.fragment,ue),H(S.$$.fragment,ue),H(z.$$.fragment,ue),H(N.$$.fragment,ue),H(T.$$.fragment,ue),H(R.$$.fragment,ue),H(F.$$.fragment,ue),H(Y.$$.fragment,ue),H(te.$$.fragment,ue),H(B.$$.fragment,ue),ue&&(Ie||(Ie=me(e,xe,{duration:250},!1)),Ie.run(0)),nt=!1},d(ue){ue&&A(e),se(o),se(l),se(c),se(d),se(h),se(b),se(w),se(y),se(D),se(S),se(z),se(N),se(T),se(R),se(F),se(Y),se(te),se(B),n[2](null),ue&&Ie&&Ie.end(),st=!1,be(Le)}}}function Kg(n,e,t){let i;X(n,x,c=>t(1,i=c));let s;function o(c){ae[c?"unshift":"push"](()=>{s=c,t(0,s)})}return[s,i,o,()=>G(x,i.changelog.ongoing=!1,i),c=>{vt(c),yt(c)},()=>s.focus()]}class Yg extends Re{constructor(e){super(),De(this,e,Kg,Vg,ge,{})}}function Qg(n){let e,t,i,s,o,r,l,a,c,u,d,f,h,p,b,v,w,k,y,I,D,W;return{c(){e=g("div"),t=g("span"),t.textContent="Resources",i=C(),s=g("ul"),o=g("li"),r=g("iconify-icon"),l=C(),a=g("a"),a.textContent="Fantastic Frontier Wiki",c=C(),u=g("li"),u.innerHTML='<iconify-icon icon="ic:baseline-discord" class="svelte-18cf37p"></iconify-icon> <a href="https://discord.gg/ff" target="_blank" class="svelte-18cf37p">Fantastic Frontier Discord Server</a>',d=C(),f=g("li"),f.innerHTML='<iconify-icon icon="simple-icons:googledocs" class="svelte-18cf37p"></iconify-icon> <a href="https://docs.google.com/document/d/1H9HXoExCDVfXx15LQ4Te-2tTjrLFB-XCbMmx44Ynld4/edit" target="_blank" class="svelte-18cf37p">Fantastic Frontier Build List</a>',h=C(),p=g("li"),p.innerHTML='<iconify-icon icon="simple-icons:googledocs" class="svelte-18cf37p"></iconify-icon> <a href="https://docs.google.com/document/d/15vwSRojTqZ8LI09Wq4dvGF1kSTPmH2_gECQvwlSFki8/edit" target="_blank" class="svelte-18cf37p">Fantastic Frontier Max Stat List</a>',b=C(),v=g("div"),w=g("div"),k=g("button"),k.textContent="OK",m(t,"id","title"),Ae(r,"icon","simple-icons:fandom"),Ae(r,"class","svelte-18cf37p"),m(a,"id","firstFocusable"),m(a,"href","https://fantastic-frontier-roblox.fandom.com/wiki/Fantastic_Frontier_-_Roblox_Wiki"),m(a,"target","_blank"),m(a,"class","svelte-18cf37p"),m(o,"class","svelte-18cf37p"),m(u,"class","svelte-18cf37p"),m(f,"class","svelte-18cf37p"),m(p,"class","svelte-18cf37p"),m(s,"class","svelte-18cf37p"),m(k,"id","lastFocusable"),m(v,"class","promptOptions"),m(e,"class","infoPrompt")},m(S,q){P(S,e,q),_(e,t),_(e,i),_(e,s),_(s,o),_(o,r),_(o,l),_(o,a),_(s,c),_(s,u),_(s,d),_(s,f),_(s,h),_(s,p),_(e,b),_(e,v),_(v,w),_(w,k),n[2](k),I=!0,D||(W=[O(a,"keydown",vt),O(k,"click",n[3]),O(k,"keydown",yt),O(e,"introstart",n[4])],D=!0)},p:oe,i(S){I||(S&&we(()=>{I&&(y||(y=me(e,xe,{duration:250},!0)),y.run(1))}),I=!0)},o(S){S&&(y||(y=me(e,xe,{duration:250},!1)),y.run(0)),I=!1},d(S){S&&A(e),n[2](null),S&&y&&y.end(),D=!1,be(W)}}}function Xg(n,e,t){let i;X(n,x,a=>t(1,i=a));let s;function o(a){ae[a?"unshift":"push"](()=>{s=a,t(0,s)})}return[s,i,o,()=>G(x,i.resources.ongoing=!1,i),()=>s.focus()]}class Jg extends Re{constructor(e){super(),De(this,e,Xg,Qg,ge,{})}}function Al(n,e,t){const i=n.slice();return i[7]=e[t],i}function Pl(n,e,t){const i=n.slice();return i[10]=e[t],i}function Ml(n){let e,t,i,s,o,r,l,a=n[1][n[7]][n[10]].toLocaleString()+" Gold",c,u;return{c(){e=g("div"),t=g("span"),t.textContent=`${n[10].charAt(0).toUpperCase()+n[10].slice(1)+":"}`,i=C(),s=g("img"),r=C(),l=g("span"),c=ce(a),u=C(),m(t,"id","costTypeName"),m(t,"class","svelte-sk567b"),tt(s.src,o="https://static.wikia.nocookie.net/fantastic-frontier-roblox/images/b/ba/GoldCoins.png")||m(s,"src",o),m(s,"alt",""),m(s,"class","svelte-sk567b"),m(e,"class","svelte-sk567b")},m(d,f){P(d,e,f),_(e,t),_(e,i),_(e,s),_(e,r),_(e,l),_(l,c),_(e,u)},p(d,f){f&2&&a!==(a=d[1][d[7]][d[10]].toLocaleString()+" Gold")&&Se(c,a)},d(d){d&&A(e)}}}function Ll(n){let e,t,i,s,o,r=Oe(["min","avg","max"]),l=[];for(let a=0;a<3;a+=1)l[a]=Ml(Pl(n,r,a));return{c(){e=g("div"),t=g("span"),t.textContent=`${n[7].charAt(0).toUpperCase()+n[7].slice(1)+" Costs"}`,i=C(),s=g("div");for(let a=0;a<3;a+=1)l[a].c();o=C(),m(t,"id","subtitle"),m(t,"class","svelte-sk567b"),m(s,"class","costTypes svelte-sk567b"),m(e,"class","costs svelte-sk567b"),m(e,"id",n[7])},m(a,c){P(a,e,c),_(e,t),_(e,i),_(e,s);for(let u=0;u<3;u+=1)l[u]&&l[u].m(s,null);_(e,o)},p(a,c){if(c&2){r=Oe(["min","avg","max"]);let u;for(u=0;u<3;u+=1){const d=Pl(a,r,u);l[u]?l[u].p(d,c):(l[u]=Ml(d),l[u].c(),l[u].m(s,null))}for(;u<3;u+=1)l[u].d(1)}},d(a){a&&A(e),ht(l,a)}}}function Zg(n){let e,t,i,s,o,r,l,a,c,u,d=Oe(["armor","gear","total"]),f=[];for(let h=0;h<3;h+=1)f[h]=Ll(Al(n,d,h));return{c(){e=g("div"),t=g("div");for(let h=0;h<3;h+=1)f[h].c();i=C(),s=g("div"),o=g("div"),r=g("button"),r.textContent="OK",m(t,"class","costsInfo svelte-sk567b"),m(r,"id","firstFocusable lastFocusable"),m(s,"class","promptOptions svelte-sk567b"),m(e,"class","buildCosts svelte-sk567b")},m(h,p){P(h,e,p),_(e,t);for(let b=0;b<3;b+=1)f[b]&&f[b].m(t,null);_(e,i),_(e,s),_(s,o),_(o,r),n[3](r),a=!0,c||(u=[O(r,"click",n[4]),O(r,"keydown",n[5]),O(e,"introstart",n[6])],c=!0)},p(h,[p]){if(p&2){d=Oe(["armor","gear","total"]);let b;for(b=0;b<3;b+=1){const v=Al(h,d,b);f[b]?f[b].p(v,p):(f[b]=Ll(v),f[b].c(),f[b].m(t,null))}for(;b<3;b+=1)f[b].d(1)}},i(h){a||(h&&we(()=>{a&&(l||(l=me(e,xe,{duration:250},!0)),l.run(1))}),a=!0)},o(h){h&&(l||(l=me(e,xe,{duration:250},!1)),l.run(0)),a=!1},d(h){h&&A(e),ht(f,h),n[3](null),h&&l&&l.end(),c=!1,be(u)}}}function xg(n,e,t){let i,s;X(n,Tt,u=>t(1,i=u)),X(n,x,u=>t(2,s=u));let o;function r(u){ae[u?"unshift":"push"](()=>{o=u,t(0,o)})}return[o,i,s,r,()=>G(x,s.costs.ongoing=!1,s),u=>{vt(u),yt(u)},()=>o.focus()]}class $g extends Re{constructor(e){super(),De(this,e,xg,Zg,ge,{})}}function Fl(n,e,t){const i=n.slice();return i[19]=e[t][0],i[20]=e[t][1],i}function Bl(n,e,t){const i=n.slice();return i[11]=e[t],i}function ql(n,e,t){const i=n.slice();return i[16]=e[t],i}function e1(n){const e=n.slice(),t=e[14]?e[5][e[2].name][e[11].name]:`${Math.round(e[11].mult*100*10)/10}<b>%</b> ${Ft[e[11].type]}`;return e[15]=t,e}function zl(n){const e=n.slice(),t=e[5][e[2].name]!=null&&e[5][e[2].name][e[11].name]!=null;return e[14]=t,e}function t1(n){let e;return{c(){e=g("span"),e.textContent=`Slot: ${n[2].slot.charAt(0).toUpperCase()+n[2].slot.slice(1)}`},m(t,i){P(t,e,i)},p:oe,d(t){t&&A(e)}}}function n1(n){let e;return{c(){e=g("span"),e.textContent=`Type: ${n[2].tool?"Tool":n[2].info.type}`},m(t,i){P(t,e,i)},p:oe,d(t){t&&A(e)}}}function i1(n){let e,t,i,s,o=Oe(Object.entries(Ft)),r=[];for(let l=0;l<o.length;l+=1)r[l]=jl(Fl(n,o,l));return{c(){e=g("div"),t=g("span"),t.textContent=`${n[2].noStats?"No stats available":"Stats:"}`,i=C(),s=g("div");for(let l=0;l<r.length;l+=1)r[l].c();m(t,"id","subtitle"),m(t,"class","svelte-1d71l7d"),m(s,"class","svelte-1d71l7d"),m(e,"id","itemStats"),m(e,"class","svelte-1d71l7d")},m(l,a){P(l,e,a),_(e,t),_(e,i),_(e,s);for(let c=0;c<r.length;c+=1)r[c]&&r[c].m(s,null)},p(l,a){if(a&4){o=Oe(Object.entries(Ft));let c;for(c=0;c<o.length;c+=1){const u=Fl(l,o,c);r[c]?r[c].p(u,a):(r[c]=jl(u),r[c].c(),r[c].m(s,null))}for(;c<r.length;c+=1)r[c].d(1);r.length=o.length}},d(l){l&&A(e),ht(r,l)}}}function s1(n){let e;function t(o,r){return o[2].tool?l1:r1}let s=t(n)(n);return{c(){s.c(),e=pt()},m(o,r){s.m(o,r),P(o,e,r)},p(o,r){s.p(o,r)},d(o){o&&A(e),s.d(o)}}}function o1(n){let e,t,i,s,o,r=(n[19]=="endurance"?n[2].stats[n[19]].toFixed(2):n[2].stats[n[19]])+"",l,a;return{c(){e=g("div"),t=g("img"),s=C(),o=g("span"),l=ce(r),a=C(),tt(t.src,i="stats/"+n[19]+".svg")||m(t,"src",i),m(t,"alt",n[20]),m(t,"class","svelte-1d71l7d"),m(o,"class","statValue svelte-1d71l7d"),m(o,"id",n[19]),ne(o,"negative",n[2].stats[n[19]]<0),m(e,"class","svelte-1d71l7d")},m(c,u){P(c,e,u),_(e,t),_(e,s),_(e,o),_(o,l),_(e,a)},p(c,u){u&4&&ne(o,"negative",c[2].stats[c[19]]<0)},d(c){c&&A(e)}}}function jl(n){let e,t=n[2].stats[n[19]]!=0&&o1(n);return{c(){t&&t.c(),e=pt()},m(i,s){t&&t.m(i,s),P(i,e,s)},p(i,s){i[2].stats[i[19]]!=0&&t.p(i,s)},d(i){i&&A(e),t&&t.d(i)}}}function r1(n){let e,t,i,s,o,r=Oe(n[2].moves),l=[];for(let a=0;a<r.length;a+=1)l[a]=Ul(Bl(n,r,a));return{c(){e=g("div"),t=g("div"),i=g("div"),s=g("div"),s.innerHTML='<span class="svelte-1d71l7d">Move</span> <span class="svelte-1d71l7d">Base Value</span> <span class="svelte-1d71l7d">Scaling(s)</span>',o=C();for(let a=0;a<l.length;a+=1)l[a].c();m(s,"id","subtitle"),m(s,"class","svelte-1d71l7d"),m(i,"class","svelte-1d71l7d"),m(t,"id","itemMoves"),m(t,"class","svelte-1d71l7d"),m(e,"id","itemMovesCont"),m(e,"class","svelte-1d71l7d")},m(a,c){P(a,e,c),_(e,t),_(t,i),_(i,s),_(i,o);for(let u=0;u<l.length;u+=1)l[u]&&l[u].m(i,null)},p(a,c){if(c&52){r=Oe(a[2].moves);let u;for(u=0;u<r.length;u+=1){const d=Bl(a,r,u);l[u]?l[u].p(d,c):(l[u]=Ul(d),l[u].c(),l[u].m(i,null))}for(;u<l.length;u+=1)l[u].d(1);l.length=r.length}},d(a){a&&A(e),ht(l,a)}}}function l1(n){let e;return{c(){e=g("div"),e.innerHTML='<span id="subtitle" class="svelte-1d71l7d">No moves available</span>',m(e,"id","itemMovesCont"),m(e,"class","svelte-1d71l7d"),it(e,"text-align","center")},m(t,i){P(t,e,i)},p:oe,d(t){t&&A(e)}}}function a1(n){let e,t,i,s,o,r;function l(d,f){return!d[11].type||!d[11].type.includes("/")?Wl:c1}function a(d,f){return f===Wl?e1(d):d}let c=l(n),u=c(a(n,c));return{c(){e=g("div"),t=g("span"),t.textContent=`${n[11].name}`,i=C(),s=g("span"),s.textContent=`${(n[11].name.includes("Fantastic Beamstorm")?"~":"")+n[11].base}`,o=C(),u.c(),r=C(),m(t,"class","svelte-1d71l7d"),m(s,"class","svelte-1d71l7d"),m(e,"class","svelte-1d71l7d")},m(d,f){P(d,e,f),_(e,t),_(e,i),_(e,s),_(e,o),u.m(e,null),_(e,r)},p(d,f){u.p(a(d,c),f)},d(d){d&&A(e),u.d()}}}function c1(n){let e,t=Oe(n[11].type.split("/")),i=[];for(let s=0;s<t.length;s+=1)i[s]=Hl(ql(n,t,s));return{c(){e=g("span");for(let s=0;s<i.length;s+=1)i[s].c();m(e,"id","hybrid"),m(e,"class","svelte-1d71l7d")},m(s,o){P(s,e,o);for(let r=0;r<i.length;r+=1)i[r]&&i[r].m(e,null)},p(s,o){if(o&4){t=Oe(s[11].type.split("/"));let r;for(r=0;r<t.length;r+=1){const l=ql(s,t,r);i[r]?i[r].p(l,o):(i[r]=Hl(l),i[r].c(),i[r].m(e,null))}for(;r<i.length;r+=1)i[r].d(1);i.length=t.length}},d(s){s&&A(e),ht(i,s)}}}function Wl(n){let e,t=n[15]+"";return{c(){e=g("span"),m(e,"class","svelte-1d71l7d"),it(e,"font-size",n[15].length>30?"calc(var(--u) * 2.5)":"")},m(i,s){P(i,e,s),e.innerHTML=t},p:oe,d(i){i&&A(e)}}}function Hl(n){let e,t=Math.round(n[11][`${n[16]}Mult`]*100*10)/10+"",i,s,o,r=Ft[n[16]]+"",l,a;return{c(){e=g("span"),i=ce(t),s=g("b"),s.textContent="%",o=C(),l=ce(r),a=C()},m(c,u){P(c,e,u),_(e,i),_(e,s),_(e,o),_(e,l),_(e,a)},p:oe,d(c){c&&A(e)}}}function Ul(n){let e=!n[4].includes(n[11].name),t,i=e&&a1(zl(n));return{c(){i&&i.c(),t=pt()},m(s,o){i&&i.m(s,o),P(s,t,o)},p(s,o){e&&i.p(zl(s),o)},d(s){s&&A(t),i&&i.d(s)}}}function u1(n){let e,t,i,s,o,r,l,a,c,u,d,f,h,p,b,v,w,k,y,I,D,W,S,q,z,Q,N,E,T,$,R,L,F,j,Y,fe,te,re,B,J;function de(Le,ue){return Le[3]?n1:t1}let ve=de(n)(n);function Ie(Le,ue){return Le[3]?s1:i1}let st=Ie(n)(n);return{c(){e=g("div"),t=g("div"),i=g("a"),s=g("img"),r=C(),l=g("div"),a=g("span"),a.textContent="Click the image in order to visit the wiki page",c=C(),u=g("span"),u.textContent=`Name: ${n[2].name}`,d=C(),ve.c(),f=C(),st.c(),h=C(),p=g("div"),b=g("span"),b.textContent="Costs:",v=C(),w=g("div"),k=g("div"),y=g("span"),y.textContent="Minimum:",I=C(),D=g("img"),S=C(),q=g("span"),q.textContent=`${n[2].cost.min==null?"Unpurchasable":n[2].cost.min.toLocaleString()+" Gold"}`,z=C(),Q=g("div"),N=g("span"),N.textContent="Maximum:",E=C(),T=g("img"),R=C(),L=g("span"),L.textContent=`${n[2].cost.max==null?"Unpurchasable":n[2].cost.max.toLocaleString()+" Gold"}`,F=C(),j=g("div"),Y=g("div"),fe=g("button"),fe.textContent="OK",tt(s.src,o=n[2].image)||m(s,"src",o),m(s,"alt",""),m(s,"class","svelte-1d71l7d"),m(i,"href",n[2].link),m(i,"target","_blank"),m(i,"class","svelte-1d71l7d"),m(a,"id","tip"),m(a,"class","svelte-1d71l7d"),m(l,"class","svelte-1d71l7d"),m(t,"id","basicInfo"),m(t,"class","svelte-1d71l7d"),m(b,"id","subtitle"),m(b,"class","svelte-1d71l7d"),m(y,"class","svelte-1d71l7d"),tt(D.src,W="https://static.wikia.nocookie.net/fantastic-frontier-roblox/images/b/ba/GoldCoins.png")||m(D,"src",W),m(D,"alt",""),m(D,"class","svelte-1d71l7d"),m(q,"class","svelte-1d71l7d"),m(k,"class","svelte-1d71l7d"),m(N,"class","svelte-1d71l7d"),tt(T.src,$="https://static.wikia.nocookie.net/fantastic-frontier-roblox/images/b/ba/GoldCoins.png")||m(T,"src",$),m(T,"alt",""),m(T,"class","svelte-1d71l7d"),m(L,"class","svelte-1d71l7d"),m(Q,"class","svelte-1d71l7d"),m(w,"class","svelte-1d71l7d"),m(p,"id","itemCosts"),m(p,"class","svelte-1d71l7d"),m(fe,"id","firstFocusable lastFocusable"),m(j,"class","promptOptions svelte-1d71l7d"),m(e,"class","itemInfo svelte-1d71l7d")},m(Le,ue){P(Le,e,ue),_(e,t),_(t,i),_(i,s),_(t,r),_(t,l),_(l,a),_(l,c),_(l,u),_(l,d),ve.m(l,null),_(e,f),st.m(e,null),_(e,h),_(e,p),_(p,b),_(p,v),_(p,w),_(w,k),_(k,y),_(k,I),_(k,D),_(k,S),_(k,q),_(w,z),_(w,Q),_(Q,N),_(Q,E),_(Q,T),_(Q,R),_(Q,L),_(e,F),_(e,j),_(j,Y),_(Y,fe),n[6](fe),re=!0,B||(J=[O(fe,"click",n[7]),O(fe,"keydown",n[8]),O(e,"introstart",n[9]),O(e,"outroend",n[10])],B=!0)},p(Le,[ue]){ve.p(Le,ue),st.p(Le,ue)},i(Le){re||(Le&&we(()=>{re&&(te||(te=me(e,xe,{duration:250},!0)),te.run(1))}),re=!0)},o(Le){Le&&(te||(te=me(e,xe,{duration:250},!1)),te.run(0)),re=!1},d(Le){Le&&A(e),ve.d(),st.d(),n[6](null),Le&&te&&te.end(),B=!1,be(J)}}}function d1(n,e,t){let i;X(n,x,p=>t(1,i=p));let s,o=i.item.data,r=o.type=="gear",l=["Charged Basic Attack","Charged Solar Beam"],a={"Void Spike Ultradagger":{"Void Needle":"100<b>%</b> Melee - 562.5<b>%</b> Armor"},"Pureblood Dagger":{"Basic Attack":"200<b>%</b> HighestBonus - 100<b>%</b> LowerBonuses","Blood Sap":"200<b>%</b> HighestBonus - 100<b>%</b> LowerBonuses","+ HP per Blood Sap":"(200<b>%</b> HighestBonus - 100<b>%</b> LowerBonuses) / 2"},"Gnome Rocket Launcher":{"Basic Attack":"None"}};function c(p){ae[p?"unshift":"push"](()=>{s=p,t(0,s)})}return[s,i,o,r,l,a,c,()=>G(x,i.item.ongoing=!1,i),p=>{vt(p),yt(p)},()=>s.focus(),()=>{o.element&&o.element.querySelector("button").focus()}]}class f1 extends Re{constructor(e){super(),De(this,e,d1,u1,ge,{})}}function h1(n){let e,t,i,s,o,r,l,a,c,u,d,f;return{c(){e=g("div"),t=g("span"),t.textContent="Fantastic Calculator Policy",i=C(),s=g("div"),s.innerHTML=`<span id="subtitle" class="svelte-1fkv0qw">About</span> <p class="svelte-1fkv0qw">This tool is a passion project, one that is independent and is not
            affiliated with or sponsored by the creators of Fantastic Frontier.</p> <span id="subtitle" class="svelte-1fkv0qw">Privacy Policy</span> <p class="svelte-1fkv0qw">This policy explains what information Fantastic Calculator (&quot;we&quot;,
            &quot;us&quot; or &quot;our&quot;) collects, uses, and shares when you use our website.</p> <span id="subtitle" class="svelte-1fkv0qw">Information We Collect</span> <p class="svelte-1fkv0qw">We collect information provided by you; that is which is inputted
            directly into our tool. We also collect information about how you
            use and interact with our website, general demographic details, and
            information about your device or browser.</p> <span id="subtitle" class="svelte-1fkv0qw">How We Use This Information</span> <p class="svelte-1fkv0qw">Your information may be utilized to test and improve the tool, once
            the aggregated, non-identifying information provided has been
            collected and analyzed.</p> <span id="subtitle" class="svelte-1fkv0qw">Contact</span> <p class="svelte-1fkv0qw">For any questions or inquiries, feel free to contact us at <hl>@xt.ss</hl>.</p>`,o=C(),r=g("div"),l=g("div"),a=g("button"),a.textContent="OK",m(t,"id","title"),m(s,"id","contents"),m(a,"id","firstFocusable lastFocusable"),m(r,"class","promptOptions svelte-1fkv0qw"),m(e,"class","infoPrompt svelte-1fkv0qw")},m(h,p){P(h,e,p),_(e,t),_(e,i),_(e,s),_(e,o),_(e,r),_(r,l),_(l,a),n[2](a),u=!0,d||(f=[O(a,"click",n[3]),O(a,"keydown",n[4])],d=!0)},p:oe,i(h){u||(h&&we(()=>{u&&(c||(c=me(e,xe,{duration:250},!0)),c.run(1))}),u=!0)},o(h){h&&(c||(c=me(e,xe,{duration:250},!1)),c.run(0)),u=!1},d(h){h&&A(e),n[2](null),h&&c&&c.end(),d=!1,be(f)}}}function p1(n,e,t){let i;X(n,x,a=>t(1,i=a));let s;function o(a){ae[a?"unshift":"push"](()=>{s=a,t(0,s)})}return[s,i,o,()=>G(x,i.policy.ongoing=!1,i),a=>{vt(a),yt(a)}]}class _1 extends Re{constructor(e){super(),De(this,e,p1,h1,ge,{})}}const{document:Bt,window:hn}=bu;function Gl(n,e,t){const i=n.slice();return i[50]=e[t],i}function Vl(n,e,t){const i=n.slice();return i[50]=e[t],i}function Kl(n){let e;return{c(){e=g("style"),e.textContent=`* {\r
                pointer-events: none;\r
            }\r
        `},m(t,i){P(t,e,i)},d(t){t&&A(e)}}}function Yl(n){let e;return{c(){e=g("link"),m(e,"rel","preload"),m(e,"as","image"),m(e,"href",n[50])},m(t,i){P(t,e,i)},p:oe,d(t){t&&A(e)}}}function Ql(n){let e;return{c(){e=g("style"),e.textContent=`body > div:not(.backgrounds),\r
            main > :not(.promptCont),\r
            .backgrounds > img,\r
            #donate,\r
            #resources,\r
            #changelog,\r
            #policy {\r
                filter: blur(calc(var(--u) * 0.5));\r
                pointer-events: none;\r
            }\r
            .sideFeatures {\r
                z-index: 3;\r
            }\r
            .sideFeatures button:hover,\r
            .sideFeatures button:focus,\r
            .info:hover,\r
            .info:focus {\r
                background-color: var(--transparent);\r
            }\r
            .sideFeatures button > .tooltip,\r
            .info:not(#credits) > .tooltip {\r
                opacity: 0 !important;\r
                visibility: hidden !important;\r
            }\r
        `},m(t,i){P(t,e,i)},d(t){t&&A(e)}}}function Xl(n){let e;return{c(){e=g("style"),e.textContent=`body {\r
                overflow: hidden;\r
            }\r
        `},m(t,i){P(t,e,i)},d(t){t&&A(e)}}}function Jl(n){let e;return{c(){e=g("style"),e.textContent=`body {\r
                pointer-events: none;\r
            }\r
            #donate,\r
            #resources,\r
            #changelog,\r
            #policy,\r
            .mainFeatures,\r
            .sideFeatures,\r
            .statBox > .toggleCont,\r
            .ddButton > iconify-icon,\r
            .copyStatsButton {\r
                opacity: 0;\r
                visibility: hidden;\r
            }\r
            .gearBox .ddButton > iconify-icon {\r
                width: 15% !important;\r
            }\r
            .eqSlotIcon button > .tooltip,\r
            .gearSlotIcon button > .tooltip {\r
                opacity: 1;\r
                visibility: visible;\r
            }\r
            .calcBox {\r
                translate: -3%;\r
            }\r
            .currentBuild {\r
                left: 50% !important;\r
                padding: calc(var(--u) * 2) !important;\r
            }\r
            .currentBuild > button {\r
                min-width: 0 !important;\r
                width: 0;\r
                opacity: 0;\r
                visibility: hidden;\r
            }`},m(t,i){P(t,e,i)},d(t){t&&A(e)}}}function Zl(n){let e,t;return{c(){e=g("img"),m(e,"class","background svelte-1rv5rt4"),tt(e.src,t=n[50])||m(e,"src",t),m(e,"alt",""),ne(e,"active",n[21].indexOf(n[50])==n[9])},m(i,s){P(i,e,s)},p(i,s){s[0]&2097664&&ne(e,"active",i[21].indexOf(i[50])==i[9])},d(i){i&&A(e)}}}function xl(n){let e,t,i=Math.floor(n[18][n[3]]*100)+"",s,o,r,l;return{c(){e=g("span"),t=ce("Zoom: "),s=ce(i),o=g("b"),o.textContent="%",m(e,"class","info svelte-1rv5rt4"),m(e,"id","zoomLevel")},m(a,c){P(a,e,c),_(e,t),_(e,s),_(e,o),l=!0},p(a,c){(!l||c[0]&8)&&i!==(i=Math.floor(a[18][a[3]]*100)+"")&&Se(s,i)},i(a){l||(a&&we(()=>{l&&(r||(r=me(e,Ze,{duration:150},!0)),r.run(1))}),l=!0)},o(a){a&&(r||(r=me(e,Ze,{duration:150},!1)),r.run(0)),l=!1},d(a){a&&A(e),a&&r&&r.end()}}}function $l(n){let e,t,i,s,o,r,l,a,c=n[17].armor.avg.toLocaleString()+" Gold",u,d,f,h,p,b,v,w,k,y=n[17].gear.avg.toLocaleString()+" Gold",I,D,W;return{c(){e=g("div"),t=g("div"),i=g("span"),i.textContent="Avg. armor cost:",s=C(),o=g("img"),l=C(),a=g("span"),u=ce(c),d=C(),f=g("div"),h=g("span"),h.textContent="Avg. gear cost:",p=C(),b=g("img"),w=C(),k=g("span"),I=ce(y),tt(o.src,r="https://static.wikia.nocookie.net/fantastic-frontier-roblox/images/b/ba/GoldCoins.png")||m(o,"src",r),m(o,"alt",""),m(o,"class","svelte-1rv5rt4"),m(t,"class","svelte-1rv5rt4"),tt(b.src,v="https://static.wikia.nocookie.net/fantastic-frontier-roblox/images/b/ba/GoldCoins.png")||m(b,"src",v),m(b,"alt",""),m(b,"class","svelte-1rv5rt4"),m(f,"class","svelte-1rv5rt4"),m(e,"class","costPreview svelte-1rv5rt4"),m(e,"id","specific")},m(S,q){P(S,e,q),_(e,t),_(t,i),_(t,s),_(t,o),_(t,l),_(t,a),_(a,u),_(e,d),_(e,f),_(f,h),_(f,p),_(f,b),_(f,w),_(f,k),_(k,I),W=!0},p(S,q){(!W||q[0]&131072)&&c!==(c=S[17].armor.avg.toLocaleString()+" Gold")&&Se(u,c),(!W||q[0]&131072)&&y!==(y=S[17].gear.avg.toLocaleString()+" Gold")&&Se(I,y)},i(S){W||(S&&we(()=>{W&&(D||(D=me(e,Ze,{duration:150},!0)),D.run(1))}),W=!0)},o(S){S&&(D||(D=me(e,Ze,{duration:150},!1)),D.run(0)),W=!1},d(S){S&&A(e),S&&D&&D.end()}}}function ea(n){let e,t,i=n[4].name+"",s,o,r,l,a,c,u,d,f,h,p=n[4].desc+"",b,v,w,k,y;return{c(){e=g("div"),t=g("span"),s=ce(i),o=C(),r=g("button"),r.innerHTML='<iconify-icon icon="ri:share-fill"></iconify-icon> <span class="tooltip" id="right">Share build</span>',l=C(),a=g("span"),c=ce(`Description / Notes:\r
                `),u=g("br"),d=C(),f=g("br"),h=C(),b=ce(p),m(t,"id","buildName"),m(t,"class","svelte-1rv5rt4"),m(r,"class","svelte-1rv5rt4"),m(a,"class","tooltip"),m(a,"id","bottom"),m(e,"class","currentBuild svelte-1rv5rt4"),ne(e,"no-tooltip",n[10])},m(I,D){P(I,e,D),_(e,t),_(t,s),_(e,o),_(e,r),_(e,l),_(e,a),_(a,c),_(a,u),_(a,d),_(a,f),_(a,h),_(a,b),w=!0,k||(y=[O(r,"click",n[31]),O(r,"mouseenter",n[32]),O(r,"mouseleave",n[33])],k=!0)},p(I,D){(!w||D[0]&16)&&i!==(i=I[4].name+"")&&Se(s,i),(!w||D[0]&16)&&p!==(p=I[4].desc+"")&&Se(b,p),(!w||D[0]&1024)&&ne(e,"no-tooltip",I[10])},i(I){w||(I&&we(()=>{w&&(v||(v=me(e,Ze,{duration:100},!0)),v.run(1))}),w=!0)},o(I){I&&(v||(v=me(e,Ze,{duration:100},!1)),v.run(0)),w=!1},d(I){I&&A(e),I&&v&&v.end(),k=!1,be(y)}}}function ta(n){let e,t,i,s,o,r,l,a,c=n[17].total.avg.toLocaleString()+" Gold",u,d,f;return{c(){e=g("div"),t=g("div"),i=g("span"),i.textContent="Avg. total cost:",s=C(),o=g("img"),l=C(),a=g("span"),u=ce(c),tt(o.src,r="https://static.wikia.nocookie.net/fantastic-frontier-roblox/images/b/ba/GoldCoins.png")||m(o,"src",r),m(o,"alt",""),m(o,"class","svelte-1rv5rt4"),m(t,"class","svelte-1rv5rt4"),m(e,"class","costPreview svelte-1rv5rt4"),m(e,"id","total")},m(h,p){P(h,e,p),_(e,t),_(t,i),_(t,s),_(t,o),_(t,l),_(t,a),_(a,u),f=!0},p(h,p){(!f||p[0]&131072)&&c!==(c=h[17].total.avg.toLocaleString()+" Gold")&&Se(u,c)},i(h){f||(h&&we(()=>{f&&(d||(d=me(e,Ze,{duration:150},!0)),d.run(1))}),f=!0)},o(h){h&&(d||(d=me(e,Ze,{duration:150},!1)),d.run(0)),f=!1},d(h){h&&A(e),h&&d&&d.end()}}}function m1(n){let e,t,i;return t=new _1({}),{c(){e=g("div"),le(t.$$.fragment),m(e,"class","promptCont svelte-1rv5rt4")},m(s,o){P(s,e,o),ie(t,e,null),i=!0},p:oe,i(s){i||(M(t.$$.fragment,s),i=!0)},o(s){H(t.$$.fragment,s),i=!1},d(s){s&&A(e),se(t)}}}function g1(n){let e,t,i;return t=new Yg({}),{c(){e=g("div"),le(t.$$.fragment),m(e,"class","promptCont svelte-1rv5rt4")},m(s,o){P(s,e,o),ie(t,e,null),i=!0},p:oe,i(s){i||(M(t.$$.fragment,s),i=!0)},o(s){H(t.$$.fragment,s),i=!1},d(s){s&&A(e),se(t)}}}function b1(n){let e,t,i;return t=new Jg({}),t.$on("loadPending",n[19]),{c(){e=g("div"),le(t.$$.fragment),m(e,"class","promptCont svelte-1rv5rt4")},m(s,o){P(s,e,o),ie(t,e,null),i=!0},p:oe,i(s){i||(M(t.$$.fragment,s),i=!0)},o(s){H(t.$$.fragment,s),i=!1},d(s){s&&A(e),se(t)}}}function v1(n){let e,t,i;return t=new jg({}),{c(){e=g("div"),le(t.$$.fragment),m(e,"class","promptCont svelte-1rv5rt4")},m(s,o){P(s,e,o),ie(t,e,null),i=!0},p:oe,i(s){i||(M(t.$$.fragment,s),i=!0)},o(s){H(t.$$.fragment,s),i=!1},d(s){s&&A(e),se(t)}}}function y1(n){let e,t,i;return t=new Fg({}),{c(){e=g("div"),le(t.$$.fragment),m(e,"class","promptCont svelte-1rv5rt4")},m(s,o){P(s,e,o),ie(t,e,null),i=!0},p:oe,i(s){i||(M(t.$$.fragment,s),i=!0)},o(s){H(t.$$.fragment,s),i=!1},d(s){s&&A(e),se(t)}}}function w1(n){let e,t,i;return t=new $g({}),{c(){e=g("div"),le(t.$$.fragment),m(e,"class","promptCont svelte-1rv5rt4")},m(s,o){P(s,e,o),ie(t,e,null),i=!0},p:oe,i(s){i||(M(t.$$.fragment,s),i=!0)},o(s){H(t.$$.fragment,s),i=!1},d(s){s&&A(e),se(t)}}}function k1(n){let e,t,i;return t=new Dg({}),{c(){e=g("div"),le(t.$$.fragment),m(e,"class","promptCont svelte-1rv5rt4")},m(s,o){P(s,e,o),ie(t,e,null),i=!0},p:oe,i(s){i||(M(t.$$.fragment,s),i=!0)},o(s){H(t.$$.fragment,s),i=!1},d(s){s&&A(e),se(t)}}}function C1(n){let e,t,i;return t=new Tg({}),t.$on("buildLoad",n[35]),{c(){e=g("div"),le(t.$$.fragment),m(e,"class","promptCont svelte-1rv5rt4")},m(s,o){P(s,e,o),ie(t,e,null),i=!0},p:oe,i(s){i||(M(t.$$.fragment,s),i=!0)},o(s){H(t.$$.fragment,s),i=!1},d(s){s&&A(e),se(t)}}}function E1(n){let e,t,i;return t=new kg({}),{c(){e=g("div"),le(t.$$.fragment),m(e,"class","promptCont svelte-1rv5rt4")},m(s,o){P(s,e,o),ie(t,e,null),i=!0},p:oe,i(s){i||(M(t.$$.fragment,s),i=!0)},o(s){H(t.$$.fragment,s),i=!1},d(s){s&&A(e),se(t)}}}function S1(n){let e,t,i;return t=new Zm({}),{c(){e=g("div"),le(t.$$.fragment),m(e,"class","promptCont svelte-1rv5rt4")},m(s,o){P(s,e,o),ie(t,e,null),i=!0},p:oe,i(s){i||(M(t.$$.fragment,s),i=!0)},o(s){H(t.$$.fragment,s),i=!1},d(s){s&&A(e),se(t)}}}function I1(n){let e,t,i,s;function o(l){n[34](l)}let r={};return n[8]!==void 0&&(r.loadID=n[8]),t=new pg({props:r}),ae.push(()=>Me(t,"loadID",o)),t.$on("resetActions",n[23]),{c(){e=g("div"),le(t.$$.fragment),m(e,"class","promptCont svelte-1rv5rt4")},m(l,a){P(l,e,a),ie(t,e,null),s=!0},p(l,a){const c={};!i&&a[0]&256&&(i=!0,c.loadID=l[8],Pe(()=>i=!1)),t.$set(c)},i(l){s||(M(t.$$.fragment,l),s=!0)},o(l){H(t.$$.fragment,l),s=!1},d(l){l&&A(e),se(t)}}}function T1(n){let e,t,i;return t=new f1({}),{c(){e=g("div"),le(t.$$.fragment),m(e,"class","promptCont svelte-1rv5rt4")},m(s,o){P(s,e,o),ie(t,e,null),i=!0},p:oe,i(s){i||(M(t.$$.fragment,s),i=!0)},o(s){H(t.$$.fragment,s),i=!1},d(s){s&&A(e),se(t)}}}function na(n){let e,t,i;return{c(){e=g("iconify-icon"),Ae(e,"icon","uil:exclamation"),Ae(e,"id","unseen"),Ae(e,"class","svelte-1rv5rt4")},m(s,o){P(s,e,o),i=!0},i(s){i||(s&&we(()=>{i&&(t||(t=me(e,Ze,{duration:150},!0)),t.run(1))}),i=!0)},o(s){s&&(t||(t=me(e,Ze,{duration:150},!1)),t.run(0)),i=!1},d(s){s&&A(e),s&&t&&t.end()}}}function ia(n){let e;return{c(){e=g("div"),e.innerHTML='<iconify-icon icon="eos-icons:three-dots-loading" class="svelte-1rv5rt4"></iconify-icon>',m(e,"class","promptCont svelte-1rv5rt4")},m(t,i){P(t,e,i)},d(t){t&&A(e)}}}function N1(n){let e,t,i,s,o,r,l,a,c,u,d,f,h,p,b,v,w,k,y,I,D,W,S,q,z,Q,N,E,T,$,R,L,F,j,Y,fe,te,re,B,J,de,qe,ve,Ie,nt,st,Le,ue,pe,$e;we(n[29]);let Je=!n[6]&&Kl(),Nt=Oe(n[21]),V=[];for(let K=0;K<Nt.length;K+=1)V[K]=Yl(Vl(n,Nt,K));let Te=(n[12]||!n[6])&&Ql(),_e=n[5].screenshot.ongoing&&n[18][n[3]]<=1&&Xl(),U=n[5].screenshot.ongoing&&Jl(),Ne=Oe(n[21]),ze=[];for(let K=0;K<Ne.length;K+=1)ze[K]=Zl(Gl(n,Ne,K));let je=n[7]&&xl(n),Fe=n[5].screenshot.ongoing&&$l(n),Ue=n[4]&&ea(n);y=new jm({}),D=new Pg({}),z=new _m({}),N=new Im({}),T=new Bm({}),R=new Qm({});let Ve=n[5].screenshot.ongoing&&ta(n);const un=[T1,I1,S1,E1,C1,k1,w1,y1,v1,b1,g1,m1],Z=[];function Sn(K,ye){return K[5].item.ongoing?0:K[11]||K[5].share.ongoing?1:K[5].export.ongoing?2:K[5].save.ongoing?3:K[5].load.ongoing&&!K[8]?4:K[5].delete.ongoing?5:K[5].costs.ongoing?6:K[5].bonus.ongoing?7:K[5].randomize.ongoing?8:K[5].resources.ongoing?9:K[5].changelog.ongoing?10:K[5].policy.ongoing?11:-1}~(j=Sn(n))&&(Y=Z[j]=un[j](n));let ft=!n[13]&&na(),St=!n[6]&&ia();return{c(){Je&&Je.c(),e=pt();for(let K=0;K<V.length;K+=1)V[K].c();t=pt(),Te&&Te.c(),i=pt(),_e&&_e.c(),s=pt(),U&&U.c(),o=pt(),r=C(),l=g("div");for(let K=0;K<ze.length;K+=1)ze[K].c();a=C(),je&&je.c(),c=C(),u=g("span"),u.innerHTML=`<iconify-icon icon="ic:baseline-discord" class="svelte-1rv5rt4"></iconify-icon>
    xt.ss
    <span class="tooltip svelte-1rv5rt4" id="right">Contact me on Discord!</span>`,d=C(),f=g("span"),f.innerHTML=`<a href="https://ko-fi.com/xt8ss" target="_blank" class="svelte-1rv5rt4">Support me
        <img src="kofi-badge.png" alt="" class="svelte-1rv5rt4"/></a>`,h=C(),p=g("button"),p.innerHTML='<iconify-icon icon="charm:stack"></iconify-icon> <span class="tooltip" id="left">Resources</span>',b=C(),v=g("main"),Fe&&Fe.c(),w=C(),Ue&&Ue.c(),k=C(),le(y.$$.fragment),I=C(),le(D.$$.fragment),W=C(),S=g("div"),q=g("div"),le(z.$$.fragment),Q=C(),le(N.$$.fragment),E=C(),le(T.$$.fragment),$=C(),le(R.$$.fragment),L=C(),Ve&&Ve.c(),F=C(),Y&&Y.c(),fe=C(),te=g("button"),re=g("iconify-icon"),B=C(),J=g("span"),J.textContent="Changelog",de=C(),ft&&ft.c(),qe=C(),ve=g("button"),ve.innerHTML='<iconify-icon icon="material-symbols:policy-outline-rounded"></iconify-icon> <span class="tooltip" id="left">Policy</span>',Ie=C(),nt=g("span"),nt.textContent=`${no}`,st=C(),St&&St.c(),Le=pt(),m(l,"class","backgrounds"),m(u,"class","info svelte-1rv5rt4"),m(u,"id","credits"),m(f,"class","info svelte-1rv5rt4"),m(f,"id","donate"),m(p,"class","info svelte-1rv5rt4"),m(p,"id","resources"),m(q,"class","eqCont svelte-1rv5rt4"),m(S,"class","calcBox svelte-1rv5rt4"),m(S,"id","calc"),m(v,"class","svelte-1rv5rt4"),ne(v,"portrait",!n[2]),Ae(re,"icon","octicon:log-16"),m(J,"class","tooltip"),m(J,"id","right"),m(te,"class","info svelte-1rv5rt4"),m(te,"id","changelog"),m(ve,"class","info svelte-1rv5rt4"),m(ve,"id","policy"),m(nt,"class","info svelte-1rv5rt4"),m(nt,"id","version")},m(K,ye){Je&&Je.m(Bt.head,null),_(Bt.head,e);for(let It=0;It<V.length;It+=1)V[It]&&V[It].m(Bt.head,null);_(Bt.head,t),Te&&Te.m(Bt.head,null),_(Bt.head,i),_e&&_e.m(Bt.head,null),_(Bt.head,s),U&&U.m(Bt.head,null),_(Bt.head,o),P(K,r,ye),P(K,l,ye);for(let It=0;It<ze.length;It+=1)ze[It]&&ze[It].m(l,null);P(K,a,ye),je&&je.m(K,ye),P(K,c,ye),P(K,u,ye),P(K,d,ye),P(K,f,ye),P(K,h,ye),P(K,p,ye),P(K,b,ye),P(K,v,ye),Fe&&Fe.m(v,null),_(v,w),Ue&&Ue.m(v,null),_(v,k),ie(y,v,null),_(v,I),ie(D,v,null),_(v,W),_(v,S),_(S,q),ie(z,q,null),_(q,Q),ie(N,q,null),_(S,E),ie(T,S,null),_(v,$),ie(R,v,null),_(v,L),Ve&&Ve.m(v,null),_(v,F),~j&&Z[j].m(v,null),P(K,fe,ye),P(K,te,ye),_(te,re),_(te,B),_(te,J),_(te,de),ft&&ft.m(te,null),P(K,qe,ye),P(K,ve,ye),P(K,Ie,ye),P(K,nt,ye),P(K,st,ye),St&&St.m(K,ye),P(K,Le,ye),ue=!0,pe||($e=[O(hn,"beforeunload",n[25]),O(hn,"storage",n[26]),O(hn,"wheel",n[27],{passive:!1}),O(hn,"keydown",n[28]),O(hn,"resize",n[29]),O(p,"click",n[30]),O(te,"click",n[36]),O(ve,"click",n[37])],pe=!0)},p(K,ye){if(K[6]?Je&&(Je.d(1),Je=null):Je||(Je=Kl(),Je.c(),Je.m(e.parentNode,e)),ye[0]&2097152){Nt=Oe(K[21]);let Qe;for(Qe=0;Qe<Nt.length;Qe+=1){const Jn=Vl(K,Nt,Qe);V[Qe]?V[Qe].p(Jn,ye):(V[Qe]=Yl(Jn),V[Qe].c(),V[Qe].m(t.parentNode,t))}for(;Qe<V.length;Qe+=1)V[Qe].d(1);V.length=Nt.length}if(K[12]||!K[6]?Te||(Te=Ql(),Te.c(),Te.m(i.parentNode,i)):Te&&(Te.d(1),Te=null),K[5].screenshot.ongoing&&K[18][K[3]]<=1?_e||(_e=Xl(),_e.c(),_e.m(s.parentNode,s)):_e&&(_e.d(1),_e=null),K[5].screenshot.ongoing?U||(U=Jl(),U.c(),U.m(o.parentNode,o)):U&&(U.d(1),U=null),ye[0]&2097664){Ne=Oe(K[21]);let Qe;for(Qe=0;Qe<Ne.length;Qe+=1){const Jn=Gl(K,Ne,Qe);ze[Qe]?ze[Qe].p(Jn,ye):(ze[Qe]=Zl(Jn),ze[Qe].c(),ze[Qe].m(l,null))}for(;Qe<ze.length;Qe+=1)ze[Qe].d(1);ze.length=Ne.length}K[7]?je?(je.p(K,ye),ye[0]&128&&M(je,1)):(je=xl(K),je.c(),M(je,1),je.m(c.parentNode,c)):je&&(We(),H(je,1,1,()=>{je=null}),He()),K[5].screenshot.ongoing?Fe?(Fe.p(K,ye),ye[0]&32&&M(Fe,1)):(Fe=$l(K),Fe.c(),M(Fe,1),Fe.m(v,w)):Fe&&(We(),H(Fe,1,1,()=>{Fe=null}),He()),K[4]?Ue?(Ue.p(K,ye),ye[0]&16&&M(Ue,1)):(Ue=ea(K),Ue.c(),M(Ue,1),Ue.m(v,k)):Ue&&(We(),H(Ue,1,1,()=>{Ue=null}),He()),K[5].screenshot.ongoing?Ve?(Ve.p(K,ye),ye[0]&32&&M(Ve,1)):(Ve=ta(K),Ve.c(),M(Ve,1),Ve.m(v,F)):Ve&&(We(),H(Ve,1,1,()=>{Ve=null}),He());let It=j;j=Sn(K),j===It?~j&&Z[j].p(K,ye):(Y&&(We(),H(Z[It],1,1,()=>{Z[It]=null}),He()),~j?(Y=Z[j],Y?Y.p(K,ye):(Y=Z[j]=un[j](K),Y.c()),M(Y,1),Y.m(v,null)):Y=null),(!ue||ye[0]&4)&&ne(v,"portrait",!K[2]),K[13]?ft&&(We(),H(ft,1,1,()=>{ft=null}),He()):ft?ye[0]&8192&&M(ft,1):(ft=na(),ft.c(),M(ft,1),ft.m(te,null)),K[6]?St&&(St.d(1),St=null):St||(St=ia(),St.c(),St.m(Le.parentNode,Le))},i(K){ue||(M(je),M(Fe),M(Ue),M(y.$$.fragment,K),M(D.$$.fragment,K),M(z.$$.fragment,K),M(N.$$.fragment,K),M(T.$$.fragment,K),M(R.$$.fragment,K),M(Ve),M(Y),M(ft),ue=!0)},o(K){H(je),H(Fe),H(Ue),H(y.$$.fragment,K),H(D.$$.fragment,K),H(z.$$.fragment,K),H(N.$$.fragment,K),H(T.$$.fragment,K),H(R.$$.fragment,K),H(Ve),H(Y),H(ft),ue=!1},d(K){K&&(A(r),A(l),A(a),A(c),A(u),A(d),A(f),A(h),A(p),A(b),A(v),A(fe),A(te),A(qe),A(ve),A(Ie),A(nt),A(st),A(Le)),Je&&Je.d(K),A(e),ht(V,K),A(t),Te&&Te.d(K),A(i),_e&&_e.d(K),A(s),U&&U.d(K),A(o),ht(ze,K),je&&je.d(K),Fe&&Fe.d(),Ue&&Ue.d(),se(y),se(D),se(z),se(N),se(T),se(R),Ve&&Ve.d(),~j&&Z[j].d(),ft&&ft.d(),St&&St.d(K),pe=!1,be($e)}}}let no="v3.26.6";function O1(n,e,t){let i,s,o,r,l,a,c,u,d,f,h,p,b,v,w;X(n,wt,V=>t(4,s=V)),X(n,x,V=>t(5,o=V)),X(n,bn,V=>t(12,r=V)),X(n,ao,V=>t(24,l=V)),X(n,qn,V=>t(41,a=V)),X(n,jt,V=>t(42,c=V)),X(n,Bn,V=>t(43,u=V)),X(n,Lt,V=>t(44,d=V)),X(n,Pi,V=>t(13,f=V)),X(n,Jt,V=>t(14,h=V)),X(n,Ot,V=>t(15,p=V)),X(n,Mt,V=>t(45,b=V)),X(n,co,V=>t(16,v=V)),X(n,Tt,V=>t(17,w=V));let k=!1,y,I,D,W=7,S=[.2,.3,.45,.6,.75,.85,.95,1,1.1,1.25,1.5,1.75,2,2.5,3,4,5],q=!1,z,Q=new URLSearchParams(location.search).get("id");for(let V of M_){let Te=`https://raw.githubusercontent.com/XT8SS/fantastic-calculator/gh-pages/ff-data/${V}.json`;fetch(Te).then(async _e=>{if(_e.status!=200){console.error(`Failed to fetch "${V}" data!
Status: ${_e.status}`);return}G(Mt,b[V]=await _e.json(),b)}).catch(_e=>console.error(`Failed to initiate "${V}" data fetch!
${_e}`))}Nu(()=>{t(6,k=!0),Q&&N(),t(2,D=I>y),p[Object.keys(p)[0]]&&G(Jt,h=!0,h),localStorage.getItem("version")!=no&&(G(Pi,f=!1,f),localStorage.setItem("version",no)),localStorage.getItem("changelogSeen")||localStorage.setItem("changelogSeen",!1)});function N(){if(G(x,o.load.ongoing=!0,o),!Q.startsWith("-N"))G(x,o.load.status=-1,o),G(x,o.message="invalid_id",o);else{G(x,o.load.status=0,o);let V=eu(Hn(Gn,"builds"),$c()),Te=0;xc(V).then(_e=>{for(let U in _e.val()){if(U==Q){E(_e.val()[U],U);break}else Te==Object.keys(_e.val()).length-1&&(G(x,o.load.status=-1,o),G(x,o.message="invalid_id",o));Te++}}).catch(()=>{G(x,o.load.status=-1,o),G(x,o.message="firebase_fail",o)})}}function E(V,Te){for(let _e in V.eq){let U=d[_e]||vs;V.eq[_e]&&V.eq[_e]!=U.name?u[_e][V.eq[_e]].querySelector("button").click():!V.eq[_e]&&U.name&&u[_e][U.name].querySelector("button").click()}for(let _e of Cn){let U=c[_e]||ys;U.name&&a[_e][U.name].querySelector("button").click()}setTimeout(()=>{for(let _e of Cn)V.gear[_e]&&a[_e][V.gear[_e]].querySelector("button").click();G(x,o.load.ongoing=!1,o),G(x,o.load.status=null,o),Te&&(G(wt,s=V,s),G(wt,s.id=Te,s),t(8,Q=null))})}let T=[],$=[],R,L,F=9;for(let V=0;V<F;V++)T.push(`backgrounds/BG${V}.jpg`);function j(V){L=Math.floor(Math.random()*V.length)}j(T);function Y(){t(9,R=L),$.push(L)}Y(),function V(){setTimeout(()=>{if(j(T),!$.length)Y();else if($.length>3&&($=$.slice(1)),!$.includes(L))Y();else{let Te=[...Array(F).keys()].filter(_e=>!$.includes(_e));j(Te),Y()}document.hasFocus&&V()},45e3)}();function fe(){z=setTimeout(()=>{t(7,q=!1)},750)}function te(){clearTimeout(z),t(7,q=!0),fe()}function re(){G(x,o.export.status=null,o),G(x,o.export.ongoing=!1,o),G(x,o.save.status=null,o),G(x,o.save.ongoing=!1,o),G(x,o.load.status=null,o),G(x,o.load.ongoing=!1,o),G(x,o.delete.status=null,o),G(x,o.delete.ongoing=!1,o),G(x,o.share.ongoing=!1,o),G(x,o.message="",o)}let B=!1;const J=V=>{(v||r)&&V.preventDefault()},de=V=>{if(V.key=="builds")if(V.url.includes("ls=true")){G(Ot,p=JSON.parse(V.newValue),p),G(Jt,h=Object.keys(JSON.parse(V.newValue)).length>0,h),re();let Te=Object.keys(JSON.parse(V.oldValue)).filter(_e=>!Object.keys(JSON.parse(V.newValue)).includes(_e))[0];Te&&s&&Te==s.name&&G(wt,s=null,s)}else window.localStorage.setItem("builds",JSON.stringify(p))},qe=V=>{let Te=V.wheelDeltaY;if(V.ctrlKey){if(V.preventDefault(),S[W]==.2&&Te<0||S[W]==5&&Te>0)return;Te>0?t(3,W++,W):t(3,W--,W),te()}},ve=V=>{V.ctrlKey&&(V.key=="-"||V.key=="+"||V.code=="Equal"||V.key=="0")&&(V.preventDefault(),(V.key=="+"||V.code=="Equal")&&S[W]!=5?t(3,W++,W):V.key=="-"&&S[W]!=.2?t(3,W--,W):V.key=="0"&&S[W]!=1&&t(3,W=7),te()),r&&B_(V)};function Ie(){t(0,y=hn.outerHeight),t(1,I=hn.outerWidth)}const nt=V=>{nn(V),r||G(x,o.resources.ongoing=!0,o)},st=()=>{r||G(x,o.share.ongoing=!0,o)},Le=()=>t(10,B=!0),ue=()=>t(10,B=!1);function pe(V){Q=V,t(8,Q)}const $e=V=>E(V.detail.build,V.detail.id),Je=V=>{nn(V),!r&&(G(x,o.changelog.ongoing=!0,o),G(Pi,f=!0,f))},Nt=V=>{nn(V),r||G(x,o.policy.ongoing=!0,o)};return n.$$.update=()=>{if(n.$$.dirty[0]&16777231&&(I||y)&&(t(2,D=I>y),document.documentElement.style.setProperty("--u",`${(D?.75:window.outerWidth/window.outerHeight/2)*S[W]}${CSS.supports("height: 1lvh")?"l":""}vh`),l))for(let V of l)Go(V.node,V.itemName);n.$$.dirty[0]&32&&t(11,i=o.export.status||o.save.status||o.load.status||o.delete.status),n.$$.dirty[0]&32&&G(bn,r=o.item.ongoing||o.export.ongoing||o.save.ongoing||o.load.ongoing||o.delete.ongoing||o.share.ongoing||o.costs.ongoing||o.bonus.ongoing||o.randomize.ongoing||o.resources.ongoing||o.changelog.ongoing||o.policy.ongoing,r),n.$$.dirty[0]&16&&(document.title=(s?s.name+" - ":"")+"Fantastic Calculator")},[y,I,D,W,s,o,k,q,Q,R,B,i,r,f,h,p,v,w,S,N,E,T,te,re,l,J,de,qe,ve,Ie,nt,st,Le,ue,pe,$e,Je,Nt]}class D1 extends Re{constructor(e){super(),De(this,e,O1,N1,ge,{},null,[-1,-1])}}new D1({target:document.body});
