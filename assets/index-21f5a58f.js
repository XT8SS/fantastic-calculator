var Wc=Object.defineProperty;var Hc=(n,e,t)=>e in n?Wc(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var Wt=(n,e,t)=>(Hc(n,typeof e!="symbol"?e+"":e,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&i(r)}).observe(document,{childList:!0,subtree:!0});function t(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(s){if(s.ep)return;s.ep=!0;const o=t(s);fetch(s.href,o)}})();function se(){}const Yi=n=>n;function Uc(n,e){for(const t in e)n[t]=e[t];return n}function Fl(n){return n()}function Bo(){return Object.create(null)}function ge(n){n.forEach(Fl)}function Ln(n){return typeof n=="function"}function pe(n,e){return n!=n?e==e:n!==e||n&&typeof n=="object"||typeof n=="function"}let vi;function tt(n,e){return n===e?!0:(vi||(vi=document.createElement("a")),vi.href=e,n===vi.href)}function Gc(n){return Object.keys(n).length===0}function Vc(n,...e){if(n==null){for(const i of e)i(void 0);return se}const t=n.subscribe(...e);return t.unsubscribe?()=>t.unsubscribe():t}function J(n,e,t){n.$$.on_destroy.push(Vc(e,t))}function Yc(n,e,t,i){if(n){const s=Bl(n,e,t,i);return n[0](s)}}function Bl(n,e,t,i){return n[1]&&i?Uc(t.ctx.slice(),n[1](i(e))):t.ctx}function Kc(n,e,t,i){if(n[2]&&i){const s=n[2](i(t));if(e.dirty===void 0)return s;if(typeof s=="object"){const o=[],r=Math.max(e.dirty.length,s.length);for(let a=0;a<r;a+=1)o[a]=e.dirty[a]|s[a];return o}return e.dirty|s}return e.dirty}function Qc(n,e,t,i,s,o){if(s){const r=Bl(e,t,i,o);n.p(r,s)}}function Xc(n){if(n.ctx.length>32){const e=[],t=n.ctx.length/32;for(let i=0;i<t;i++)e[i]=-1;return e}return-1}function X(n,e,t){return n.set(t),e}function ql(n){return n&&Ln(n.destroy)?n.destroy:se}const jl=typeof window<"u";let Ys=jl?()=>window.performance.now():()=>Date.now(),Ks=jl?n=>requestAnimationFrame(n):se;const vn=new Set;function zl(n){vn.forEach(e=>{e.c(n)||(vn.delete(e),e.f())}),vn.size!==0&&Ks(zl)}function Qs(n){let e;return vn.size===0&&Ks(zl),{promise:new Promise(t=>{vn.add(e={c:n,f:t})}),abort(){vn.delete(e)}}}const Jc=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function p(n,e){n.appendChild(e)}function Wl(n){if(!n)return document;const e=n.getRootNode?n.getRootNode():n.ownerDocument;return e&&e.host?e:n.ownerDocument}function Zc(n){const e=b("style");return e.textContent="/* empty */",xc(Wl(n),e),e.sheet}function xc(n,e){return p(n.head||n,e),e.sheet}function B(n,e,t){n.insertBefore(e,t||null)}function M(n){n.parentNode&&n.parentNode.removeChild(n)}function _t(n,e){for(let t=0;t<n.length;t+=1)n[t]&&n[t].d(e)}function b(n){return document.createElement(n)}function $c(n){return document.createElementNS("http://www.w3.org/2000/svg",n)}function ie(n){return document.createTextNode(n)}function T(){return ie(" ")}function bt(){return ie("")}function D(n,e,t,i){return n.addEventListener(e,t,i),()=>n.removeEventListener(e,t,i)}function m(n,e,t){t==null?n.removeAttribute(e):n.getAttribute(e)!==t&&n.setAttribute(e,t)}function Xe(n,e,t){e in n?n[e]=typeof n[e]=="boolean"&&t===""?!0:t:m(n,e,t)}function Hl(n){return n===""?null:+n}function eu(n){return Array.from(n.childNodes)}function Ee(n,e){e=""+e,n.data!==e&&(n.data=e)}function Dt(n,e){n.value=e??""}function et(n,e,t,i){t==null?n.style.removeProperty(e):n.style.setProperty(e,t,i?"important":"")}let yi;function tu(){if(yi===void 0){yi=!1;try{typeof window<"u"&&window.parent&&window.parent.document}catch{yi=!0}}return yi}function Xt(n,e){getComputedStyle(n).position==="static"&&(n.style.position="relative");const i=b("iframe");i.setAttribute("style","display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;"),i.setAttribute("aria-hidden","true"),i.tabIndex=-1;const s=tu();let o;return s?(i.src="data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}<\/script>",o=D(window,"message",r=>{r.source===i.contentWindow&&e()})):(i.src="about:blank",i.onload=()=>{o=D(i.contentWindow,"resize",e),e()}),p(n,i),()=>{(s||o&&i.contentWindow)&&o(),M(i)}}function te(n,e,t){n.classList.toggle(e,!!t)}function Ul(n,e,{bubbles:t=!1,cancelable:i=!1}={}){return new CustomEvent(n,{detail:e,bubbles:t,cancelable:i})}class nu{constructor(e=!1){Wt(this,"is_svg",!1);Wt(this,"e");Wt(this,"n");Wt(this,"t");Wt(this,"a");this.is_svg=e,this.e=this.n=null}c(e){this.h(e)}m(e,t,i=null){this.e||(this.is_svg?this.e=$c(t.nodeName):this.e=b(t.nodeType===11?"TEMPLATE":t.nodeName),this.t=t.tagName!=="TEMPLATE"?t:t.content,this.c(e)),this.i(i)}h(e){this.e.innerHTML=e,this.n=Array.from(this.e.nodeName==="TEMPLATE"?this.e.content.childNodes:this.e.childNodes)}i(e){for(let t=0;t<this.n.length;t+=1)B(this.t,this.n[t],e)}p(e){this.d(),this.h(e),this.i(this.a)}d(){this.n.forEach(M)}}const Ei=new Map;let Si=0;function iu(n){let e=5381,t=n.length;for(;t--;)e=(e<<5)-e^n.charCodeAt(t);return e>>>0}function su(n,e){const t={stylesheet:Zc(e),rules:{}};return Ei.set(n,t),t}function Ii(n,e,t,i,s,o,r,a=0){const l=16.666/i;let c=`{
`;for(let v=0;v<=1;v+=l){const w=e+(t-e)*o(v);c+=v*100+`%{${r(w,1-w)}}
`}const u=c+`100% {${r(t,1-t)}}
}`,f=`__svelte_${iu(u)}_${a}`,d=Wl(n),{stylesheet:_,rules:h}=Ei.get(d)||su(d,n);h[f]||(h[f]=!0,_.insertRule(`@keyframes ${f} ${u}`,_.cssRules.length));const g=n.style.animation||"";return n.style.animation=`${g?`${g}, `:""}${f} ${i}ms linear ${s}ms 1 both`,Si+=1,f}function Ti(n,e){const t=(n.style.animation||"").split(", "),i=t.filter(e?o=>o.indexOf(e)<0:o=>o.indexOf("__svelte")===-1),s=t.length-i.length;s&&(n.style.animation=i.join(", "),Si-=s,Si||ou())}function ou(){Ks(()=>{Si||(Ei.forEach(n=>{const{ownerNode:e}=n.stylesheet;e&&M(e)}),Ei.clear())})}let xn;function Kn(n){xn=n}function Gl(){if(!xn)throw new Error("Function called outside component initialization");return xn}function ru(n){Gl().$$.on_mount.push(n)}function Mt(){const n=Gl();return(e,t,{cancelable:i=!1}={})=>{const s=n.$$.callbacks[e];if(s){const o=Ul(e,t,{cancelable:i});return s.slice().forEach(r=>{r.call(n,o)}),!o.defaultPrevented}return!0}}const gn=[],ne=[];let yn=[];const Es=[],lu=Promise.resolve();let Ss=!1;function au(){Ss||(Ss=!0,lu.then(Vl))}function ke(n){yn.push(n)}function Oe(n){Es.push(n)}const ds=new Set;let _n=0;function Vl(){if(_n!==0)return;const n=xn;do{try{for(;_n<gn.length;){const e=gn[_n];_n++,Kn(e),cu(e.$$)}}catch(e){throw gn.length=0,_n=0,e}for(Kn(null),gn.length=0,_n=0;ne.length;)ne.pop()();for(let e=0;e<yn.length;e+=1){const t=yn[e];ds.has(t)||(ds.add(t),t())}yn.length=0}while(gn.length);for(;Es.length;)Es.pop()();Ss=!1,ds.clear(),Kn(n)}function cu(n){if(n.fragment!==null){n.update(),ge(n.before_update);const e=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,e),n.after_update.forEach(ke)}}function uu(n){const e=[],t=[];yn.forEach(i=>n.indexOf(i)===-1?e.push(i):t.push(i)),t.forEach(i=>i()),yn=e}let Wn;function Xs(){return Wn||(Wn=Promise.resolve(),Wn.then(()=>{Wn=null})),Wn}function ln(n,e,t){n.dispatchEvent(Ul(`${e?"intro":"outro"}${t}`))}const ki=new Set;let Rt;function Pe(){Rt={r:0,c:[],p:Rt}}function Me(){Rt.r||ge(Rt.c),Rt=Rt.p}function L(n,e){n&&n.i&&(ki.delete(n),n.i(e))}function V(n,e,t,i){if(n&&n.o){if(ki.has(n))return;ki.add(n),Rt.c.push(()=>{ki.delete(n),i&&(t&&n.d(1),i())}),n.o(e)}else i&&i()}const Js={duration:0};function Yl(n,e,t){const i={direction:"in"};let s=e(n,t,i),o=!1,r,a,l=0;function c(){r&&Ti(n,r)}function u(){const{delay:d=0,duration:_=300,easing:h=Yi,tick:g=se,css:v}=s||Js;v&&(r=Ii(n,0,1,_,d,h,v,l++)),g(0,1);const w=Ys()+d,C=w+_;a&&a.abort(),o=!0,ke(()=>ln(n,!0,"start")),a=Qs(y=>{if(o){if(y>=C)return g(1,0),ln(n,!0,"end"),c(),o=!1;if(y>=w){const k=h((y-w)/_);g(k,1-k)}}return o})}let f=!1;return{start(){f||(f=!0,Ti(n),Ln(s)?(s=s(i),Xs().then(u)):u())},invalidate(){f=!1},end(){o&&(c(),o=!1)}}}function Kl(n,e,t){const i={direction:"out"};let s=e(n,t,i),o=!0,r;const a=Rt;a.r+=1;let l;function c(){const{delay:u=0,duration:f=300,easing:d=Yi,tick:_=se,css:h}=s||Js;h&&(r=Ii(n,1,0,f,u,d,h));const g=Ys()+u,v=g+f;ke(()=>ln(n,!1,"start")),"inert"in n&&(l=n.inert,n.inert=!0),Qs(w=>{if(o){if(w>=v)return _(0,1),ln(n,!1,"end"),--a.r||ge(a.c),!1;if(w>=g){const C=d((w-g)/f);_(1-C,C)}}return o})}return Ln(s)?Xs().then(()=>{s=s(i),c()}):c(),{end(u){u&&"inert"in n&&(n.inert=l),u&&s.tick&&s.tick(1,0),o&&(r&&Ti(n,r),o=!1)}}}function Ce(n,e,t,i){let o=e(n,t,{direction:"both"}),r=i?0:1,a=null,l=null,c=null,u;function f(){c&&Ti(n,c)}function d(h,g){const v=h.b-r;return g*=Math.abs(v),{a:r,b:h.b,d:v,duration:g,start:h.start,end:h.start+g,group:h.group}}function _(h){const{delay:g=0,duration:v=300,easing:w=Yi,tick:C=se,css:y}=o||Js,k={start:Ys()+g,b:h};h||(k.group=Rt,Rt.r+=1),"inert"in n&&(h?u!==void 0&&(n.inert=u):(u=n.inert,n.inert=!0)),a||l?l=k:(y&&(f(),c=Ii(n,r,h,v,g,w,y)),h&&C(0,1),a=d(k,v),ke(()=>ln(n,h,"start")),Qs(E=>{if(l&&E>l.start&&(a=d(l,v),l=null,ln(n,a.b,"start"),y&&(f(),c=Ii(n,r,a.b,a.duration,0,w,o.css))),a){if(E>=a.end)C(r=a.b,1-r),ln(n,a.b,"end"),l||(a.b?f():--a.group.r||ge(a.group.c)),a=null;else if(E>=a.start){const O=E-a.start;r=a.a+a.d*w(O/a.duration),C(r,1-r)}}return!!(a||l)}))}return{run(h){Ln(o)?Xs().then(()=>{o=o({direction:h?"in":"out"}),_(h)}):_(h)},end(){f(),a=l=null}}}function Ae(n){return(n==null?void 0:n.length)!==void 0?n:Array.from(n)}function De(n,e,t){const i=n.$$.props[e];i!==void 0&&(n.$$.bound[i]=t,t(n.$$.ctx[i]))}function le(n){n&&n.c()}function oe(n,e,t){const{fragment:i,after_update:s}=n.$$;i&&i.m(e,t),ke(()=>{const o=n.$$.on_mount.map(Fl).filter(Ln);n.$$.on_destroy?n.$$.on_destroy.push(...o):ge(o),n.$$.on_mount=[]}),s.forEach(ke)}function re(n,e){const t=n.$$;t.fragment!==null&&(uu(t.after_update),ge(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function du(n,e){n.$$.dirty[0]===-1&&(gn.push(n),au(),n.$$.dirty.fill(0)),n.$$.dirty[e/31|0]|=1<<e%31}function Te(n,e,t,i,s,o,r=null,a=[-1]){const l=xn;Kn(n);const c=n.$$={fragment:null,ctx:[],props:o,update:se,not_equal:s,bound:Bo(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(l?l.$$.context:[])),callbacks:Bo(),dirty:a,skip_bound:!1,root:e.target||l.$$.root};r&&r(c.root);let u=!1;if(c.ctx=t?t(n,e.props||{},(f,d,..._)=>{const h=_.length?_[0]:d;return c.ctx&&s(c.ctx[f],c.ctx[f]=h)&&(!c.skip_bound&&c.bound[f]&&c.bound[f](h),u&&du(n,f)),d}):[],c.update(),u=!0,ge(c.before_update),c.fragment=i?i(c.ctx):!1,e.target){if(e.hydrate){const f=eu(e.target);c.fragment&&c.fragment.l(f),f.forEach(M)}else c.fragment&&c.fragment.c();e.intro&&L(n.$$.fragment),oe(n,e.target,e.anchor),Vl()}Kn(l)}class Ne{constructor(){Wt(this,"$$");Wt(this,"$$set")}$destroy(){re(this,1),this.$destroy=se}$on(e,t){if(!Ln(t))return se;const i=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return i.push(t),()=>{const s=i.indexOf(t);s!==-1&&i.splice(s,1)}}$set(e){this.$$set&&!Gc(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const fu="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(fu);const pn=[];function ot(n,e=se){let t;const i=new Set;function s(a){if(pe(n,a)&&(n=a,t)){const l=!pn.length;for(const c of i)c[1](),pn.push(c,n);if(l){for(let c=0;c<pn.length;c+=2)pn[c][0](pn[c+1]);pn.length=0}}}function o(a){s(a(n))}function r(a,l=se){const c=[a,l];return i.add(c),i.size===1&&(t=e(s,o)||se),a(n),()=>{i.delete(c),i.size===0&&t&&(t(),t=null)}}return{set:s,update:o,subscribe:r}}let qo=localStorage.getItem("builds"),jo=0,Tt=ot({}),Nt=ot({}),ut=ot({armor:0,magicDmg:0,meleeDmg:0,rangedDmg:0,hpRegen:0,endurance:0,sightRange:0,walkSpeed:0,jumpPower:0,ammoReturn:0,height:0}),At=ot({}),Zs=ot([]),fs=ot({}),dt=ot(),xs=ot(!1),wt=ot(qo?JSON.parse(qo):{}),Ht=ot(!1),In=ot(!1),Tn=ot({}),Nn=ot({}),hu=ot({}),gt=ot({armor:{min:0,avg:0,max:0},gear:{min:0,avg:0,max:0},total:{min:0,avg:0,max:0}}),wn=ot({}),Hn=ot({parasol:!0,armor:!0,gear:!0,basic:!0}),$=ot({export:{ongoing:!1,status:null},save:{ongoing:!1,status:null},load:{ongoing:!1,status:null},delete:{ongoing:!1,status:null},share:{ongoing:!1},costs:{ongoing:!1},bonus:{ongoing:!1},screenshot:{ongoing:!1},randomize:{ongoing:!1},resources:{ongoing:!1},changelog:{ongoing:!1},message:""});wt.subscribe(n=>{jo++,setTimeout(()=>{window.localStorage.setItem("builds",JSON.stringify(n)),jo>1&&window.history.replaceState(null,null,location.origin+location.pathname)})});/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ql={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x=function(n,e){if(!n)throw Fn(e)},Fn=function(n){return new Error("Firebase Database ("+Ql.SDK_VERSION+") INTERNAL ASSERT FAILED: "+n)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xl=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let s=n.charCodeAt(i);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},_u=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const s=n[t++];if(s<128)e[i++]=String.fromCharCode(s);else if(s>191&&s<224){const o=n[t++];e[i++]=String.fromCharCode((s&31)<<6|o&63)}else if(s>239&&s<365){const o=n[t++],r=n[t++],a=n[t++],l=((s&7)<<18|(o&63)<<12|(r&63)<<6|a&63)-65536;e[i++]=String.fromCharCode(55296+(l>>10)),e[i++]=String.fromCharCode(56320+(l&1023))}else{const o=n[t++],r=n[t++];e[i++]=String.fromCharCode((s&15)<<12|(o&63)<<6|r&63)}}return e.join("")},$s={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let s=0;s<n.length;s+=3){const o=n[s],r=s+1<n.length,a=r?n[s+1]:0,l=s+2<n.length,c=l?n[s+2]:0,u=o>>2,f=(o&3)<<4|a>>4;let d=(a&15)<<2|c>>6,_=c&63;l||(_=64,r||(d=64)),i.push(t[u],t[f],t[d],t[_])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(Xl(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):_u(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let s=0;s<n.length;){const o=t[n.charAt(s++)],a=s<n.length?t[n.charAt(s)]:0;++s;const c=s<n.length?t[n.charAt(s)]:64;++s;const f=s<n.length?t[n.charAt(s)]:64;if(++s,o==null||a==null||c==null||f==null)throw new pu;const d=o<<2|a>>4;if(i.push(d),c!==64){const _=a<<4&240|c>>2;if(i.push(_),f!==64){const h=c<<6&192|f;i.push(h)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class pu extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Jl=function(n){const e=Xl(n);return $s.encodeByteArray(e,!0)},Ni=function(n){return Jl(n).replace(/\./g,"")},Is=function(n){try{return $s.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mu(n){return Zl(void 0,n)}function Zl(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!gu(t)||(n[t]=Zl(n[t],e[t]));return n}function gu(n){return n!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bu(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vu=()=>bu().__FIREBASE_DEFAULTS__,yu=()=>{if(typeof process>"u"||typeof process.env>"u")return;const n={}.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},wu=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Is(n[1]);return e&&JSON.parse(e)},xl=()=>{try{return vu()||yu()||wu()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Cu=n=>{var e,t;return(t=(e=xl())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},ku=n=>{const e=Cu(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},$l=()=>{var n;return(n=xl())===null||n===void 0?void 0:n.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ki{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Eu(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",s=n.iat||0,o=n.sub||n.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const r=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:s,exp:s+3600,auth_time:s,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},n),a="";return[Ni(JSON.stringify(t)),Ni(JSON.stringify(r)),a].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Su(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function ea(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Su())}function Iu(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function ta(){return Ql.NODE_ADMIN===!0}function Tu(){try{return typeof indexedDB=="object"}catch{return!1}}function Nu(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(i);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{var o;e(((o=s.error)===null||o===void 0?void 0:o.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ou="FirebaseError";class fi extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=Ou,Object.setPrototypeOf(this,fi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,na.prototype.create)}}class na{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},s=`${this.service}/${e}`,o=this.errors[e],r=o?Du(o,i):"Error",a=`${this.serviceName}: ${r} (${s}).`;return new fi(s,a,i)}}function Du(n,e){return n.replace(Ru,(t,i)=>{const s=e[i];return s!=null?String(s):`<${i}?>`})}const Ru=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $n(n){return JSON.parse(n)}function xe(n){return JSON.stringify(n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ia=function(n){let e={},t={},i={},s="";try{const o=n.split(".");e=$n(Is(o[0])||""),t=$n(Is(o[1])||""),s=o[2],i=t.d||{},delete t.d}catch{}return{header:e,claims:t,data:i,signature:s}},Au=function(n){const e=ia(n),t=e.claims;return!!t&&typeof t=="object"&&t.hasOwnProperty("iat")},Pu=function(n){const e=ia(n).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lt(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function On(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]}function zo(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Oi(n,e,t){const i={};for(const s in n)Object.prototype.hasOwnProperty.call(n,s)&&(i[s]=e.call(t,n[s],s,n));return i}function Ts(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const s of t){if(!i.includes(s))return!1;const o=n[s],r=e[s];if(Wo(o)&&Wo(r)){if(!Ts(o,r))return!1}else if(o!==r)return!1}for(const s of i)if(!t.includes(s))return!1;return!0}function Wo(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mu(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lu{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const i=this.W_;if(typeof e=="string")for(let f=0;f<16;f++)i[f]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let f=0;f<16;f++)i[f]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let f=16;f<80;f++){const d=i[f-3]^i[f-8]^i[f-14]^i[f-16];i[f]=(d<<1|d>>>31)&4294967295}let s=this.chain_[0],o=this.chain_[1],r=this.chain_[2],a=this.chain_[3],l=this.chain_[4],c,u;for(let f=0;f<80;f++){f<40?f<20?(c=a^o&(r^a),u=1518500249):(c=o^r^a,u=1859775393):f<60?(c=o&r|a&(o|r),u=2400959708):(c=o^r^a,u=3395469782);const d=(s<<5|s>>>27)+c+l+u+i[f]&4294967295;l=a,a=r,r=(o<<30|o>>>2)&4294967295,o=s,s=d}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+o&4294967295,this.chain_[2]=this.chain_[2]+r&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295}update(e,t){if(e==null)return;t===void 0&&(t=e.length);const i=t-this.blockSize;let s=0;const o=this.buf_;let r=this.inbuf_;for(;s<t;){if(r===0)for(;s<=i;)this.compress_(e,s),s+=this.blockSize;if(typeof e=="string"){for(;s<t;)if(o[r]=e.charCodeAt(s),++r,++s,r===this.blockSize){this.compress_(o),r=0;break}}else for(;s<t;)if(o[r]=e[s],++r,++s,r===this.blockSize){this.compress_(o),r=0;break}}this.inbuf_=r,this.total_+=t}digest(){const e=[];let t=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let s=this.blockSize-1;s>=56;s--)this.buf_[s]=t&255,t/=256;this.compress_(this.buf_);let i=0;for(let s=0;s<5;s++)for(let o=24;o>=0;o-=8)e[i]=this.chain_[s]>>o&255,++i;return e}}function eo(n,e){return`${n} failed: ${e} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fu=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let s=n.charCodeAt(i);if(s>=55296&&s<=56319){const o=s-55296;i++,x(i<n.length,"Surrogate pair missing trail surrogate.");const r=n.charCodeAt(i)-56320;s=65536+(o<<10)+r}s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):s<65536?(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},Qi=function(n){let e=0;for(let t=0;t<n.length;t++){const i=n.charCodeAt(t);i<128?e++:i<2048?e+=2:i>=55296&&i<=56319?(e+=4,t++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function en(n){return n&&n._delegate?n._delegate:n}class ei{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tn="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bu{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new Ki;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&i.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const i=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(o){if(s)return null;throw o}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(ju(e))try{this.getOrInitializeService({instanceIdentifier:tn})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const o=this.getOrInitializeService({instanceIdentifier:s});i.resolve(o)}catch{}}}}clearInstance(e=tn){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=tn){return this.instances.has(e)}getOptions(e=tn){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[o,r]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(o);i===a&&r.resolve(s)}return s}onInit(e,t){var i;const s=this.normalizeInstanceIdentifier(t),o=(i=this.onInitCallbacks.get(s))!==null&&i!==void 0?i:new Set;o.add(e),this.onInitCallbacks.set(s,o);const r=this.instances.get(s);return r&&e(r,s),()=>{o.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const s of i)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:qu(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=tn){return this.component?this.component.multipleInstances?e:tn:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function qu(n){return n===tn?void 0:n}function ju(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zu{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Bu(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Be;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Be||(Be={}));const Wu={debug:Be.DEBUG,verbose:Be.VERBOSE,info:Be.INFO,warn:Be.WARN,error:Be.ERROR,silent:Be.SILENT},Hu=Be.INFO,Uu={[Be.DEBUG]:"log",[Be.VERBOSE]:"log",[Be.INFO]:"info",[Be.WARN]:"warn",[Be.ERROR]:"error"},Gu=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),s=Uu[e];if(s)console[s](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class sa{constructor(e){this.name=e,this._logLevel=Hu,this._logHandler=Gu,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Be))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Wu[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Be.DEBUG,...e),this._logHandler(this,Be.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Be.VERBOSE,...e),this._logHandler(this,Be.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Be.INFO,...e),this._logHandler(this,Be.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Be.WARN,...e),this._logHandler(this,Be.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Be.ERROR,...e),this._logHandler(this,Be.ERROR,...e)}}const Vu=(n,e)=>e.some(t=>n instanceof t);let Ho,Uo;function Yu(){return Ho||(Ho=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Ku(){return Uo||(Uo=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const oa=new WeakMap,Ns=new WeakMap,ra=new WeakMap,hs=new WeakMap,to=new WeakMap;function Qu(n){const e=new Promise((t,i)=>{const s=()=>{n.removeEventListener("success",o),n.removeEventListener("error",r)},o=()=>{t(Ut(n.result)),s()},r=()=>{i(n.error),s()};n.addEventListener("success",o),n.addEventListener("error",r)});return e.then(t=>{t instanceof IDBCursor&&oa.set(t,n)}).catch(()=>{}),to.set(e,n),e}function Xu(n){if(Ns.has(n))return;const e=new Promise((t,i)=>{const s=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",r),n.removeEventListener("abort",r)},o=()=>{t(),s()},r=()=>{i(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",o),n.addEventListener("error",r),n.addEventListener("abort",r)});Ns.set(n,e)}let Os={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Ns.get(n);if(e==="objectStoreNames")return n.objectStoreNames||ra.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Ut(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function Ju(n){Os=n(Os)}function Zu(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(_s(this),e,...t);return ra.set(i,e.sort?e.sort():[e]),Ut(i)}:Ku().includes(n)?function(...e){return n.apply(_s(this),e),Ut(oa.get(this))}:function(...e){return Ut(n.apply(_s(this),e))}}function xu(n){return typeof n=="function"?Zu(n):(n instanceof IDBTransaction&&Xu(n),Vu(n,Yu())?new Proxy(n,Os):n)}function Ut(n){if(n instanceof IDBRequest)return Qu(n);if(hs.has(n))return hs.get(n);const e=xu(n);return e!==n&&(hs.set(n,e),to.set(e,n)),e}const _s=n=>to.get(n);function $u(n,e,{blocked:t,upgrade:i,blocking:s,terminated:o}={}){const r=indexedDB.open(n,e),a=Ut(r);return i&&r.addEventListener("upgradeneeded",l=>{i(Ut(r.result),l.oldVersion,l.newVersion,Ut(r.transaction),l)}),t&&r.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),a.then(l=>{o&&l.addEventListener("close",()=>o()),s&&l.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const ed=["get","getKey","getAll","getAllKeys","count"],td=["put","add","delete","clear"],ps=new Map;function Go(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(ps.get(e))return ps.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,s=td.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(s||ed.includes(t)))return;const o=async function(r,...a){const l=this.transaction(r,s?"readwrite":"readonly");let c=l.store;return i&&(c=c.index(a.shift())),(await Promise.all([c[t](...a),s&&l.done]))[0]};return ps.set(e,o),o}Ju(n=>({...n,get:(e,t,i)=>Go(e,t)||n.get(e,t,i),has:(e,t)=>!!Go(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nd{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(id(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function id(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Ds="@firebase/app",Vo="0.9.23";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cn=new sa("@firebase/app"),sd="@firebase/app-compat",od="@firebase/analytics-compat",rd="@firebase/analytics",ld="@firebase/app-check-compat",ad="@firebase/app-check",cd="@firebase/auth",ud="@firebase/auth-compat",dd="@firebase/database",fd="@firebase/database-compat",hd="@firebase/functions",_d="@firebase/functions-compat",pd="@firebase/installations",md="@firebase/installations-compat",gd="@firebase/messaging",bd="@firebase/messaging-compat",vd="@firebase/performance",yd="@firebase/performance-compat",wd="@firebase/remote-config",Cd="@firebase/remote-config-compat",kd="@firebase/storage",Ed="@firebase/storage-compat",Sd="@firebase/firestore",Id="@firebase/firestore-compat",Td="firebase",Nd="10.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rs="[DEFAULT]",Od={[Ds]:"fire-core",[sd]:"fire-core-compat",[rd]:"fire-analytics",[od]:"fire-analytics-compat",[ad]:"fire-app-check",[ld]:"fire-app-check-compat",[cd]:"fire-auth",[ud]:"fire-auth-compat",[dd]:"fire-rtdb",[fd]:"fire-rtdb-compat",[hd]:"fire-fn",[_d]:"fire-fn-compat",[pd]:"fire-iid",[md]:"fire-iid-compat",[gd]:"fire-fcm",[bd]:"fire-fcm-compat",[vd]:"fire-perf",[yd]:"fire-perf-compat",[wd]:"fire-rc",[Cd]:"fire-rc-compat",[kd]:"fire-gcs",[Ed]:"fire-gcs-compat",[Sd]:"fire-fst",[Id]:"fire-fst-compat","fire-js":"fire-js",[Td]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Di=new Map,As=new Map;function Dd(n,e){try{n.container.addComponent(e)}catch(t){cn.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Ri(n){const e=n.name;if(As.has(e))return cn.debug(`There were multiple attempts to register component ${e}.`),!1;As.set(e,n);for(const t of Di.values())Dd(t,n);return!0}function Rd(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ad={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},Gt=new na("app","Firebase",Ad);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pd{constructor(e,t,i){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new ei("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Gt.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Md=Nd;function la(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i=Object.assign({name:Rs,automaticDataCollectionEnabled:!1},e),s=i.name;if(typeof s!="string"||!s)throw Gt.create("bad-app-name",{appName:String(s)});if(t||(t=$l()),!t)throw Gt.create("no-options");const o=Di.get(s);if(o){if(Ts(t,o.options)&&Ts(i,o.config))return o;throw Gt.create("duplicate-app",{appName:s})}const r=new zu(s);for(const l of As.values())r.addComponent(l);const a=new Pd(t,i,r);return Di.set(s,a),a}function Ld(n=Rs){const e=Di.get(n);if(!e&&n===Rs&&$l())return la();if(!e)throw Gt.create("no-app",{appName:n});return e}function Cn(n,e,t){var i;let s=(i=Od[n])!==null&&i!==void 0?i:n;t&&(s+=`-${t}`);const o=s.match(/\s|\//),r=e.match(/\s|\//);if(o||r){const a=[`Unable to register library "${s}" with version "${e}":`];o&&a.push(`library name "${s}" contains illegal characters (whitespace or "/")`),o&&r&&a.push("and"),r&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),cn.warn(a.join(" "));return}Ri(new ei(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fd="firebase-heartbeat-database",Bd=1,ti="firebase-heartbeat-store";let ms=null;function aa(){return ms||(ms=$u(Fd,Bd,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(ti)}}}).catch(n=>{throw Gt.create("idb-open",{originalErrorMessage:n.message})})),ms}async function qd(n){try{return await(await aa()).transaction(ti).objectStore(ti).get(ca(n))}catch(e){if(e instanceof fi)cn.warn(e.message);else{const t=Gt.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});cn.warn(t.message)}}}async function Yo(n,e){try{const i=(await aa()).transaction(ti,"readwrite");await i.objectStore(ti).put(e,ca(n)),await i.done}catch(t){if(t instanceof fi)cn.warn(t.message);else{const i=Gt.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});cn.warn(i.message)}}}function ca(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jd=1024,zd=30*24*60*60*1e3;class Wd{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Ud(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var e;const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=Ko();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)))return this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const r=new Date(o.date).valueOf();return Date.now()-r<=zd}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var e;if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=Ko(),{heartbeatsToSend:i,unsentEntries:s}=Hd(this._heartbeatsCache.heartbeats),o=Ni(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=t,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}}function Ko(){return new Date().toISOString().substring(0,10)}function Hd(n,e=jd){const t=[];let i=n.slice();for(const s of n){const o=t.find(r=>r.agent===s.agent);if(o){if(o.dates.push(s.date),Qo(t)>e){o.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),Qo(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class Ud{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Tu()?Nu().then(()=>!0).catch(()=>!1):!1}async read(){return await this._canUseIndexedDBPromise?await qd(this.app)||{heartbeats:[]}:{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return Yo(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return Yo(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function Qo(n){return Ni(JSON.stringify({version:2,heartbeats:n})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gd(n){Ri(new ei("platform-logger",e=>new nd(e),"PRIVATE")),Ri(new ei("heartbeat",e=>new Wd(e),"PRIVATE")),Cn(Ds,Vo,n),Cn(Ds,Vo,"esm2017"),Cn("fire-js","")}Gd("");var Vd="firebase",Yd="10.6.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Cn(Vd,Yd,"app");const Xo="@firebase/database",Jo="1.0.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ua="";function Kd(n){ua=n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qd{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),xe(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:$n(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xd{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return Lt(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const da=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){const e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new Qd(e)}}catch{}return new Xd},on=da("localStorage"),Ps=da("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kn=new sa("@firebase/database"),Jd=function(){let n=1;return function(){return n++}}(),fa=function(n){const e=Fu(n),t=new Lu;t.update(e);const i=t.digest();return $s.encodeByteArray(i)},hi=function(...n){let e="";for(let t=0;t<n.length;t++){const i=n[t];Array.isArray(i)||i&&typeof i=="object"&&typeof i.length=="number"?e+=hi.apply(null,i):typeof i=="object"?e+=xe(i):e+=i,e+=" "}return e};let an=null,Zo=!0;const Zd=function(n,e){x(!e||n===!0||n===!1,"Can't turn on custom loggers persistently."),n===!0?(kn.logLevel=Be.VERBOSE,an=kn.log.bind(kn),e&&Ps.set("logging_enabled",!0)):typeof n=="function"?an=n:(an=null,Ps.remove("logging_enabled"))},lt=function(...n){if(Zo===!0&&(Zo=!1,an===null&&Ps.get("logging_enabled")===!0&&Zd(!0)),an){const e=hi.apply(null,n);an(e)}},_i=function(n){return function(...e){lt(n,...e)}},Ms=function(...n){const e="FIREBASE INTERNAL ERROR: "+hi(...n);kn.error(e)},qt=function(...n){const e=`FIREBASE FATAL ERROR: ${hi(...n)}`;throw kn.error(e),new Error(e)},ht=function(...n){const e="FIREBASE WARNING: "+hi(...n);kn.warn(e)},xd=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&ht("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},no=function(n){return typeof n=="number"&&(n!==n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},$d=function(n){if(document.readyState==="complete")n();else{let e=!1;const t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,n())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},un="[MIN_NAME]",Jt="[MAX_NAME]",Bn=function(n,e){if(n===e)return 0;if(n===un||e===Jt)return-1;if(e===un||n===Jt)return 1;{const t=xo(n),i=xo(e);return t!==null?i!==null?t-i===0?n.length-e.length:t-i:-1:i!==null?1:n<e?-1:1}},ef=function(n,e){return n===e?0:n<e?-1:1},Un=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+xe(e))},io=function(n){if(typeof n!="object"||n===null)return xe(n);const e=[];for(const i in n)e.push(i);e.sort();let t="{";for(let i=0;i<e.length;i++)i!==0&&(t+=","),t+=xe(e[i]),t+=":",t+=io(n[e[i]]);return t+="}",t},ha=function(n,e){const t=n.length;if(t<=e)return[n];const i=[];for(let s=0;s<t;s+=e)s+e>t?i.push(n.substring(s,t)):i.push(n.substring(s,s+e));return i};function pt(n,e){for(const t in n)n.hasOwnProperty(t)&&e(t,n[t])}const _a=function(n){x(!no(n),"Invalid JSON number");const e=11,t=52,i=(1<<e-1)-1;let s,o,r,a,l;n===0?(o=0,r=0,s=1/n===-1/0?1:0):(s=n<0,n=Math.abs(n),n>=Math.pow(2,1-i)?(a=Math.min(Math.floor(Math.log(n)/Math.LN2),i),o=a+i,r=Math.round(n*Math.pow(2,t-a)-Math.pow(2,t))):(o=0,r=Math.round(n/Math.pow(2,1-i-t))));const c=[];for(l=t;l;l-=1)c.push(r%2?1:0),r=Math.floor(r/2);for(l=e;l;l-=1)c.push(o%2?1:0),o=Math.floor(o/2);c.push(s?1:0),c.reverse();const u=c.join("");let f="";for(l=0;l<64;l+=8){let d=parseInt(u.substr(l,8),2).toString(16);d.length===1&&(d="0"+d),f=f+d}return f.toLowerCase()},tf=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},nf=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function sf(n,e){let t="Unknown Error";n==="too_big"?t="The data requested exceeds the maximum size that can be accessed with a single request.":n==="permission_denied"?t="Client doesn't have permission to access the desired data.":n==="unavailable"&&(t="The service is unavailable");const i=new Error(n+" at "+e._path.toString()+": "+t);return i.code=n.toUpperCase(),i}const of=new RegExp("^-?(0*)\\d{1,10}$"),rf=-2147483648,lf=2147483647,xo=function(n){if(of.test(n)){const e=Number(n);if(e>=rf&&e<=lf)return e}return null},qn=function(n){try{n()}catch(e){setTimeout(()=>{const t=e.stack||"";throw ht("Exception was thrown by user callback.",t),e},Math.floor(0))}},af=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Qn=function(n,e){const t=setTimeout(n,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cf{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=t==null?void 0:t.getImmediate({optional:!0}),this.appCheck||t==null||t.get().then(i=>this.appCheck=i)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,i)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,i):t(null)},0)})}addTokenChangeListener(e){var t;(t=this.appCheckProvider)===null||t===void 0||t.get().then(i=>i.addTokenListener(e))}notifyForInvalidToken(){ht(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uf{constructor(e,t,i){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=i,this.auth_=null,this.auth_=i.getImmediate({optional:!0}),this.auth_||i.onInit(s=>this.auth_=s)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(lt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,i)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,i):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',ht(e)}}class En{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}En.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const so="5",pa="v",ma="s",ga="r",ba="f",va=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,ya="ls",wa="p",Ls="ac",Ca="websocket",ka="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ea{constructor(e,t,i,s,o=!1,r="",a=!1,l=!1){this.secure=t,this.namespace=i,this.webSocketOnly=s,this.nodeAdmin=o,this.persistenceKey=r,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=l,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=on.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&on.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}}function df(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams}function Sa(n,e,t){x(typeof e=="string","typeof type must == string"),x(typeof t=="object","typeof params must == object");let i;if(e===Ca)i=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else if(e===ka)i=(n.secure?"https://":"http://")+n.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);df(n)&&(t.ns=n.namespace);const s=[];return pt(t,(o,r)=>{s.push(o+"="+r)}),i+s.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ff{constructor(){this.counters_={}}incrementCounter(e,t=1){Lt(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return mu(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gs={},bs={};function oo(n){const e=n.toString();return gs[e]||(gs[e]=new ff),gs[e]}function hf(n,e){const t=n.toString();return bs[t]||(bs[t]=e()),bs[t]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _f{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const i=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let s=0;s<i.length;++s)i[s]&&qn(()=>{this.onMessage_(i[s])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $o="start",pf="close",mf="pLPCommand",gf="pRTLPCB",Ia="id",Ta="pw",Na="ser",bf="cb",vf="seg",yf="ts",wf="d",Cf="dframe",Oa=1870,Da=30,kf=Oa-Da,Ef=25e3,Sf=3e4;class bn{constructor(e,t,i,s,o,r,a){this.connId=e,this.repoInfo=t,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.transportSessionId=r,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=_i(e),this.stats_=oo(t),this.urlFn=l=>(this.appCheckToken&&(l[Ls]=this.appCheckToken),Sa(t,ka,l))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new _f(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(Sf)),$d(()=>{if(this.isClosed_)return;this.scriptTagHolder=new ro((...o)=>{const[r,a,l,c,u]=o;if(this.incrementIncomingBytes_(o),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,r===$o)this.id=a,this.password=l;else if(r===pf)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+r)},(...o)=>{const[r,a]=o;this.incrementIncomingBytes_(o),this.myPacketOrderer.handleResponse(r,a)},()=>{this.onClosed_()},this.urlFn);const i={};i[$o]="t",i[Na]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(i[bf]=this.scriptTagHolder.uniqueCallbackIdentifier),i[pa]=so,this.transportSessionId&&(i[ma]=this.transportSessionId),this.lastSessionId&&(i[ya]=this.lastSessionId),this.applicationId&&(i[wa]=this.applicationId),this.appCheckToken&&(i[Ls]=this.appCheckToken),typeof location<"u"&&location.hostname&&va.test(location.hostname)&&(i[ga]=ba);const s=this.urlFn(i);this.log_("Connecting via long-poll to "+s),this.scriptTagHolder.addTag(s,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){bn.forceAllow_=!0}static forceDisallow(){bn.forceDisallow_=!0}static isAvailable(){return bn.forceAllow_?!0:!bn.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!tf()&&!nf()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=xe(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const i=Jl(t),s=ha(i,kf);for(let o=0;o<s.length;o++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,s.length,s[o]),this.curSegmentNum++}addDisconnectPingFrame(e,t){this.myDisconnFrame=document.createElement("iframe");const i={};i[Cf]="t",i[Ia]=e,i[Ta]=t,this.myDisconnFrame.src=this.urlFn(i),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=xe(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class ro{constructor(e,t,i,s){this.onDisconnect=i,this.urlFn=s,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=Jd(),window[mf+this.uniqueCallbackIdentifier]=e,window[gf+this.uniqueCallbackIdentifier]=t,this.myIFrame=ro.createIFrame_();let o="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(o='<script>document.domain="'+document.domain+'";<\/script>');const r="<html><body>"+o+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(r),this.myIFrame.doc.close()}catch(a){lt("frame writing exception"),a.stack&&lt(a.stack),lt(a)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||lt("No IE domain setting required")}catch{const i=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+i+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[Ia]=this.myID,e[Ta]=this.myPW,e[Na]=this.currentSerial;let t=this.urlFn(e),i="",s=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+Da+i.length<=Oa;){const r=this.pendingSegs.shift();i=i+"&"+vf+s+"="+r.seg+"&"+yf+s+"="+r.ts+"&"+wf+s+"="+r.d,s++}return t=t+i,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,i){this.pendingSegs.push({seg:e,ts:t,d:i}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const i=()=>{this.outstandingRequests.delete(t),this.newRequest_()},s=setTimeout(i,Math.floor(Ef)),o=()=>{clearTimeout(s),i()};this.addTag(e,o)}addTag(e,t){setTimeout(()=>{try{if(!this.sendNewPolls)return;const i=this.myIFrame.doc.createElement("script");i.type="text/javascript",i.async=!0,i.src=e,i.onload=i.onreadystatechange=function(){const s=i.readyState;(!s||s==="loaded"||s==="complete")&&(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),t())},i.onerror=()=>{lt("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(i)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const If=16384,Tf=45e3;let Ai=null;typeof MozWebSocket<"u"?Ai=MozWebSocket:typeof WebSocket<"u"&&(Ai=WebSocket);class kt{constructor(e,t,i,s,o,r,a){this.connId=e,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=_i(this.connId),this.stats_=oo(t),this.connURL=kt.connectionURL_(t,r,a,s,i),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,i,s,o){const r={};return r[pa]=so,typeof location<"u"&&location.hostname&&va.test(location.hostname)&&(r[ga]=ba),t&&(r[ma]=t),i&&(r[ya]=i),s&&(r[Ls]=s),o&&(r[wa]=o),Sa(e,Ca,r)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,on.set("previous_websocket_failure",!0);try{let i;ta(),this.mySock=new Ai(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");const s=i.message||i.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");const s=i.message||i.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){kt.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(t);i&&i.length>1&&parseFloat(i[1])<4.4&&(e=!0)}return!e&&Ai!==null&&!kt.forceDisallow_}static previouslyFailed(){return on.isInMemoryStorage||on.get("previous_websocket_failure")===!0}markConnectionHealthy(){on.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const t=this.frames.join("");this.frames=null;const i=$n(t);this.onMessage(i)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(x(this.frames===null,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(t);else{const i=this.extractFrameCount_(t);i!==null&&this.appendFrame_(i)}}send(e){this.resetKeepAlive();const t=xe(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const i=ha(t,If);i.length>1&&this.sendString_(String(i.length));for(let s=0;s<i.length;s++)this.sendString_(i[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(Tf))}sendString_(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}kt.responsesRequiredToBeHealthy=2;kt.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ni{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[bn,kt]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const t=kt&&kt.isAvailable();let i=t&&!kt.previouslyFailed();if(e.webSocketOnly&&(t||ht("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[kt];else{const s=this.transports_=[];for(const o of ni.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);ni.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}ni.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nf=6e4,Of=5e3,Df=10*1024,Rf=100*1024,vs="t",er="d",Af="s",tr="r",Pf="e",nr="o",ir="a",sr="n",or="p",Mf="h";class Lf{constructor(e,t,i,s,o,r,a,l,c,u){this.id=e,this.repoInfo_=t,this.applicationId_=i,this.appCheckToken_=s,this.authToken_=o,this.onMessage_=r,this.onReady_=a,this.onDisconnect_=l,this.onKill_=c,this.lastSessionId=u,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=_i("c:"+this.id+":"),this.transportManager_=new ni(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),i=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,i)},Math.floor(0));const s=e.healthyTimeout||0;s>0&&(this.healthyTimeout_=Qn(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>Rf?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>Df?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(s)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(vs in e){const t=e[vs];t===ir?this.upgradeIfSecondaryHealthy_():t===tr?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===nr&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=Un("t",e),i=Un("d",e);if(t==="c")this.onSecondaryControl_(i);else if(t==="d")this.pendingDataMessages.push(i);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:or,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:ir,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:sr,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=Un("t",e),i=Un("d",e);t==="c"?this.onControl_(i):t==="d"&&this.onDataMessage_(i)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=Un(vs,e);if(er in e){const i=e[er];if(t===Mf){const s=Object.assign({},i);this.repoInfo_.isUsingEmulator&&(s.h=this.repoInfo_.host),this.onHandshake_(s)}else if(t===sr){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let s=0;s<this.pendingDataMessages.length;++s)this.onDataMessage_(this.pendingDataMessages[s]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===Af?this.onConnectionShutdown_(i):t===tr?this.onReset_(i):t===Pf?Ms("Server Error: "+i):t===nr?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Ms("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,i=e.v,s=e.h;this.sessionId=e.s,this.repoInfo_.host=s,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),so!==i&&ht("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),i=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,i),Qn(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(Nf))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Qn(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(Of))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:or,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(on.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ra{put(e,t,i,s){}merge(e,t,i,s){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,i){}onDisconnectMerge(e,t,i){}onDisconnectCancel(e,t){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aa{constructor(e){this.allowedEvents_=e,this.listeners_={},x(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const i=[...this.listeners_[e]];for(let s=0;s<i.length;s++)i[s].callback.apply(i[s].context,t)}}on(e,t,i){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:i});const s=this.getInitialEvent(e);s&&t.apply(i,s)}off(e,t,i){this.validateEventType_(e);const s=this.listeners_[e]||[];for(let o=0;o<s.length;o++)if(s[o].callback===t&&(!i||i===s[o].context)){s.splice(o,1);return}}validateEventType_(e){x(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pi extends Aa{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!ea()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new Pi}getInitialEvent(e){return x(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rr=32,lr=768;class Le{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let i=0;for(let s=0;s<this.pieces_.length;s++)this.pieces_[s].length>0&&(this.pieces_[i]=this.pieces_[s],i++);this.pieces_.length=i,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}}function Ie(){return new Le("")}function we(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function Zt(n){return n.pieces_.length-n.pieceNum_}function qe(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new Le(n.pieces_,e)}function Pa(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function Ff(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)n.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}function Ma(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function La(n){if(n.pieceNum_>=n.pieces_.length)return null;const e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new Le(e,0)}function $e(n,e){const t=[];for(let i=n.pieceNum_;i<n.pieces_.length;i++)t.push(n.pieces_[i]);if(e instanceof Le)for(let i=e.pieceNum_;i<e.pieces_.length;i++)t.push(e.pieces_[i]);else{const i=e.split("/");for(let s=0;s<i.length;s++)i[s].length>0&&t.push(i[s])}return new Le(t,0)}function ye(n){return n.pieceNum_>=n.pieces_.length}function at(n,e){const t=we(n),i=we(e);if(t===null)return e;if(t===i)return at(qe(n),qe(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function Fa(n,e){if(Zt(n)!==Zt(e))return!1;for(let t=n.pieceNum_,i=e.pieceNum_;t<=n.pieces_.length;t++,i++)if(n.pieces_[t]!==e.pieces_[i])return!1;return!0}function Et(n,e){let t=n.pieceNum_,i=e.pieceNum_;if(Zt(n)>Zt(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[i])return!1;++t,++i}return!0}class Bf{constructor(e,t){this.errorPrefix_=t,this.parts_=Ma(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let i=0;i<this.parts_.length;i++)this.byteLength_+=Qi(this.parts_[i]);Ba(this)}}function qf(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=Qi(e),Ba(n)}function jf(n){const e=n.parts_.pop();n.byteLength_-=Qi(e),n.parts_.length>0&&(n.byteLength_-=1)}function Ba(n){if(n.byteLength_>lr)throw new Error(n.errorPrefix_+"has a key path longer than "+lr+" bytes ("+n.byteLength_+").");if(n.parts_.length>rr)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+rr+") or object contains a cycle "+nn(n))}function nn(n){return n.parts_.length===0?"":"in property '"+n.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lo extends Aa{constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const i=!document[e];i!==this.visible_&&(this.visible_=i,this.trigger("visible",i))},!1)}static getInstance(){return new lo}getInitialEvent(e){return x(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gn=1e3,zf=60*5*1e3,ar=30*1e3,Wf=1.3,Hf=3e4,Uf="server_kill",cr=3;class Bt extends Ra{constructor(e,t,i,s,o,r,a,l){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=i,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=r,this.appCheckTokenProvider_=a,this.authOverride_=l,this.id=Bt.nextPersistentConnectionId_++,this.log_=_i("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Gn,this.maxReconnectDelay_=zf,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l&&!ta())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");lo.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&Pi.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,i){const s=++this.requestNumber_,o={r:s,a:e,b:t};this.log_(xe(o)),x(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),i&&(this.requestCBHash_[s]=i)}get(e){this.initConnection_();const t=new Ki,s={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:r=>{const a=r.d;r.s==="ok"?t.resolve(a):t.reject(a)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;const o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),t.promise}listen(e,t,i,s){this.initConnection_();const o=e._queryIdentifier,r=e._path.toString();this.log_("Listen called for "+r+" "+o),this.listens.has(r)||this.listens.set(r,new Map),x(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),x(!this.listens.get(r).has(o),"listen() called twice for same path/queryId.");const a={onComplete:s,hashFn:t,query:e,tag:i};this.listens.get(r).set(o,a),this.connected_&&this.sendListen_(a)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,i=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(i)})}sendListen_(e){const t=e.query,i=t._path.toString(),s=t._queryIdentifier;this.log_("Listen on "+i+" for "+s);const o={p:i},r="q";e.tag&&(o.q=t._queryObject,o.t=e.tag),o.h=e.hashFn(),this.sendRequest(r,o,a=>{const l=a.d,c=a.s;Bt.warnOnListenWarnings_(l,t),(this.listens.get(i)&&this.listens.get(i).get(s))===e&&(this.log_("listen response",a),c!=="ok"&&this.removeListen_(i,s),e.onComplete&&e.onComplete(c,l))})}static warnOnListenWarnings_(e,t){if(e&&typeof e=="object"&&Lt(e,"w")){const i=On(e,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){const s='".indexOn": "'+t._queryParams.getIndex().toString()+'"',o=t._path.toString();ht(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||Pu(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=ar)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=Au(e)?"auth":"gauth",i={cred:e};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(t,i,s=>{const o=s.s,r=s.d||"error";this.authToken_===e&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,r))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const t=e.s,i=e.d||"error";t==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,i)})}unlisten(e,t){const i=e._path.toString(),s=e._queryIdentifier;this.log_("Unlisten called for "+i+" "+s),x(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,s)&&this.connected_&&this.sendUnlisten_(i,s,e._queryObject,t)}sendUnlisten_(e,t,i,s){this.log_("Unlisten on "+e+" for "+t);const o={p:e},r="n";s&&(o.q=i,o.t=s),this.sendRequest(r,o)}onDisconnectPut(e,t,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,i):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:i})}onDisconnectMerge(e,t,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,i):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:i})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,i,s){const o={p:t,d:i};this.log_("onDisconnect "+e,o),this.sendRequest(e,o,r=>{s&&setTimeout(()=>{s(r.s,r.d)},Math.floor(0))})}put(e,t,i,s){this.putInternal("p",e,t,i,s)}merge(e,t,i,s){this.putInternal("m",e,t,i,s)}putInternal(e,t,i,s,o){this.initConnection_();const r={p:t,d:i};o!==void 0&&(r.h=o),this.outstandingPuts_.push({action:e,request:r,onComplete:s}),this.outstandingPutCount_++;const a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,i=this.outstandingPuts_[e].request,s=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,i,o=>{this.log_(t+" response",o),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,i=>{if(i.s!=="ok"){const o=i.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+xe(e));const t=e.r,i=this.requestCBHash_[t];i&&(delete this.requestCBHash_[t],i(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),e==="d"?this.onDataUpdate_(t.p,t.d,!1,t.t):e==="m"?this.onDataUpdate_(t.p,t.d,!0,t.t):e==="c"?this.onListenRevoked_(t.p,t.q):e==="ac"?this.onAuthRevoked_(t.s,t.d):e==="apc"?this.onAppCheckRevoked_(t.s,t.d):e==="sd"?this.onSecurityDebugPacket_(t):Ms("Unrecognized action received from server: "+xe(e)+`
Are you using the latest client?`)}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){x(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Gn,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=Gn,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>Hf&&(this.reconnectDelay_=Gn),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=new Date().getTime()-this.lastConnectionAttemptTime_;let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*Wf)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+Bt.nextConnectionId_++,o=this.lastSessionId;let r=!1,a=null;const l=function(){a?a.close():(r=!0,i())},c=function(f){x(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(f)};this.realtime_={close:l,sendRequest:c};const u=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[f,d]=await Promise.all([this.authTokenProvider_.getToken(u),this.appCheckTokenProvider_.getToken(u)]);r?lt("getToken() completed but was canceled"):(lt("getToken() completed. Creating connection."),this.authToken_=f&&f.accessToken,this.appCheckToken_=d&&d.token,a=new Lf(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,i,_=>{ht(_+" ("+this.repoInfo_.toString()+")"),this.interrupt(Uf)},o))}catch(f){this.log_("Failed to get token: "+f),r||(this.repoInfo_.nodeAdmin&&ht(f),l())}}}interrupt(e){lt("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){lt("Resuming connection for reason: "+e),delete this.interruptReasons_[e],zo(this.interruptReasons_)&&(this.reconnectDelay_=Gn,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let i;t?i=t.map(o=>io(o)).join("$"):i="default";const s=this.removeListen_(e,i);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(e,t){const i=new Le(e).toString();let s;if(this.listens.has(i)){const o=this.listens.get(i);s=o.get(t),o.delete(t),o.size===0&&this.listens.delete(i)}else s=void 0;return s}onAuthRevoked_(e,t){lt("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=cr&&(this.reconnectDelay_=ar,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){lt("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=cr&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let t="js";e["sdk."+t+"."+ua.replace(/\./g,"-")]=1,ea()?e["framework.cordova"]=1:Iu()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=Pi.getInstance().currentlyOnline();return zo(this.interruptReasons_)&&e}}Bt.nextPersistentConnectionId_=0;Bt.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class be{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new be(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xi{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const i=new be(un,e),s=new be(un,t);return this.compare(i,s)!==0}minPost(){return be.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wi;class qa extends Xi{static get __EMPTY_NODE(){return wi}static set __EMPTY_NODE(e){wi=e}compare(e,t){return Bn(e.name,t.name)}isDefinedOn(e){throw Fn("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return be.MIN}maxPost(){return new be(Jt,wi)}makePost(e,t){return x(typeof e=="string","KeyIndex indexValue must always be a string."),new be(e,wi)}toString(){return".key"}}const Vt=new qa;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ci{constructor(e,t,i,s,o=null){this.isReverse_=s,this.resultGenerator_=o,this.nodeStack_=[];let r=1;for(;!e.isEmpty();)if(e=e,r=t?i(e.key,t):1,s&&(r*=-1),r<0)this.isReverse_?e=e.left:e=e.right;else if(r===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class it{constructor(e,t,i,s,o){this.key=e,this.value=t,this.color=i??it.RED,this.left=s??ft.EMPTY_NODE,this.right=o??ft.EMPTY_NODE}copy(e,t,i,s,o){return new it(e??this.key,t??this.value,i??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let s=this;const o=i(e,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(e,t,i),null):o===0?s=s.copy(null,t,null,null,null):s=s.copy(null,null,null,null,s.right.insert(e,t,i)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return ft.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let i,s;if(i=this,t(e,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),t(e,i.key)===0){if(i.right.isEmpty())return ft.EMPTY_NODE;s=i.right.min_(),i=i.copy(s.key,s.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,it.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,it.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}it.RED=!0;it.BLACK=!1;class Gf{copy(e,t,i,s,o){return this}insert(e,t,i){return new it(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class ft{constructor(e,t=ft.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new ft(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,it.BLACK,null,null))}remove(e){return new ft(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,it.BLACK,null,null))}get(e){let t,i=this.root_;for(;!i.isEmpty();){if(t=this.comparator_(e,i.key),t===0)return i.value;t<0?i=i.left:t>0&&(i=i.right)}return null}getPredecessorKey(e){let t,i=this.root_,s=null;for(;!i.isEmpty();)if(t=this.comparator_(e,i.key),t===0){if(i.left.isEmpty())return s?s.key:null;for(i=i.left;!i.right.isEmpty();)i=i.right;return i.key}else t<0?i=i.left:t>0&&(s=i,i=i.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Ci(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Ci(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Ci(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Ci(this.root_,null,this.comparator_,!0,e)}}ft.EMPTY_NODE=new Gf;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vf(n,e){return Bn(n.name,e.name)}function ao(n,e){return Bn(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Fs;function Yf(n){Fs=n}const ja=function(n){return typeof n=="number"?"number:"+_a(n):"string:"+n},za=function(n){if(n.isLeafNode()){const e=n.val();x(typeof e=="string"||typeof e=="number"||typeof e=="object"&&Lt(e,".sv"),"Priority must be a string or number.")}else x(n===Fs||n.isEmpty(),"priority of unexpected type.");x(n===Fs||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ur;class nt{constructor(e,t=nt.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,x(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),za(this.priorityNode_)}static set __childrenNodeConstructor(e){ur=e}static get __childrenNodeConstructor(){return ur}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new nt(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:nt.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return ye(e)?this:we(e)===".priority"?this.priorityNode_:nt.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return e===".priority"?this.updatePriority(t):t.isEmpty()&&e!==".priority"?this:nt.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const i=we(e);return i===null?t:t.isEmpty()&&i!==".priority"?this:(x(i!==".priority"||Zt(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,nt.__childrenNodeConstructor.EMPTY_NODE.updateChild(qe(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+ja(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",t==="number"?e+=_a(this.value_):e+=this.value_,this.lazyHash_=fa(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===nt.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof nt.__childrenNodeConstructor?-1:(x(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,i=typeof this.value_,s=nt.VALUE_TYPE_ORDER.indexOf(t),o=nt.VALUE_TYPE_ORDER.indexOf(i);return x(s>=0,"Unknown leaf type: "+t),x(o>=0,"Unknown leaf type: "+i),s===o?i==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}else return!1}}nt.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Wa,Ha;function Kf(n){Wa=n}function Qf(n){Ha=n}class Xf extends Xi{compare(e,t){const i=e.node.getPriority(),s=t.node.getPriority(),o=i.compareTo(s);return o===0?Bn(e.name,t.name):o}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return be.MIN}maxPost(){return new be(Jt,new nt("[PRIORITY-POST]",Ha))}makePost(e,t){const i=Wa(e);return new be(t,new nt("[PRIORITY-POST]",i))}toString(){return".priority"}}const Ve=new Xf;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jf=Math.log(2);class Zf{constructor(e){const t=o=>parseInt(Math.log(o)/Jf,10),i=o=>parseInt(Array(o+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;const s=i(this.count);this.bits_=e+1&s}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const Mi=function(n,e,t,i){n.sort(e);const s=function(l,c){const u=c-l;let f,d;if(u===0)return null;if(u===1)return f=n[l],d=t?t(f):f,new it(d,f.node,it.BLACK,null,null);{const _=parseInt(u/2,10)+l,h=s(l,_),g=s(_+1,c);return f=n[_],d=t?t(f):f,new it(d,f.node,it.BLACK,h,g)}},o=function(l){let c=null,u=null,f=n.length;const d=function(h,g){const v=f-h,w=f;f-=h;const C=s(v+1,w),y=n[v],k=t?t(y):y;_(new it(k,y.node,g,null,C))},_=function(h){c?(c.left=h,c=h):(u=h,c=h)};for(let h=0;h<l.count;++h){const g=l.nextBitIsOne(),v=Math.pow(2,l.count-(h+1));g?d(v,it.BLACK):(d(v,it.BLACK),d(v,it.RED))}return u},r=new Zf(n.length),a=o(r);return new ft(i||e,a)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ys;const mn={};class Ft{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return x(mn&&Ve,"ChildrenNode.ts has not been loaded"),ys=ys||new Ft({".priority":mn},{".priority":Ve}),ys}get(e){const t=On(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof ft?t:null}hasIndex(e){return Lt(this.indexSet_,e.toString())}addIndex(e,t){x(e!==Vt,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const i=[];let s=!1;const o=t.getIterator(be.Wrap);let r=o.getNext();for(;r;)s=s||e.isDefinedOn(r.node),i.push(r),r=o.getNext();let a;s?a=Mi(i,e.getCompare()):a=mn;const l=e.toString(),c=Object.assign({},this.indexSet_);c[l]=e;const u=Object.assign({},this.indexes_);return u[l]=a,new Ft(u,c)}addToIndexes(e,t){const i=Oi(this.indexes_,(s,o)=>{const r=On(this.indexSet_,o);if(x(r,"Missing index implementation for "+o),s===mn)if(r.isDefinedOn(e.node)){const a=[],l=t.getIterator(be.Wrap);let c=l.getNext();for(;c;)c.name!==e.name&&a.push(c),c=l.getNext();return a.push(e),Mi(a,r.getCompare())}else return mn;else{const a=t.get(e.name);let l=s;return a&&(l=l.remove(new be(e.name,a))),l.insert(e,e.node)}});return new Ft(i,this.indexSet_)}removeFromIndexes(e,t){const i=Oi(this.indexes_,s=>{if(s===mn)return s;{const o=t.get(e.name);return o?s.remove(new be(e.name,o)):s}});return new Ft(i,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Vn;class ue{constructor(e,t,i){this.children_=e,this.priorityNode_=t,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&za(this.priorityNode_),this.children_.isEmpty()&&x(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Vn||(Vn=new ue(new ft(ao),null,Ft.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Vn}updatePriority(e){return this.children_.isEmpty()?this:new ue(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const t=this.children_.get(e);return t===null?Vn:t}}getChild(e){const t=we(e);return t===null?this:this.getImmediateChild(t).getChild(qe(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,t){if(x(t,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(t);{const i=new be(e,t);let s,o;t.isEmpty()?(s=this.children_.remove(e),o=this.indexMap_.removeFromIndexes(i,this.children_)):(s=this.children_.insert(e,t),o=this.indexMap_.addToIndexes(i,this.children_));const r=s.isEmpty()?Vn:this.priorityNode_;return new ue(s,r,o)}}updateChild(e,t){const i=we(e);if(i===null)return t;{x(we(e)!==".priority"||Zt(e)===1,".priority must be the last token in a path");const s=this.getImmediateChild(i).updateChild(qe(e),t);return this.updateImmediateChild(i,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let i=0,s=0,o=!0;if(this.forEachChild(Ve,(r,a)=>{t[r]=a.val(e),i++,o&&ue.INTEGER_REGEXP_.test(r)?s=Math.max(s,Number(r)):o=!1}),!e&&o&&s<2*i){const r=[];for(const a in t)r[a]=t[a];return r}else return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+ja(this.getPriority().val())+":"),this.forEachChild(Ve,(t,i)=>{const s=i.hash();s!==""&&(e+=":"+t+":"+s)}),this.lazyHash_=e===""?"":fa(e)}return this.lazyHash_}getPredecessorChildName(e,t,i){const s=this.resolveIndex_(i);if(s){const o=s.getPredecessorKey(new be(e,t));return o?o.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const i=t.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new be(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const i=t.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new be(t,this.children_.get(t)):null}forEachChild(e,t){const i=this.resolveIndex_(e);return i?i.inorderTraversal(s=>t(s.name,s.node)):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const i=this.resolveIndex_(t);if(i)return i.getIteratorFrom(e,s=>s);{const s=this.children_.getIteratorFrom(e.name,be.Wrap);let o=s.peek();for(;o!=null&&t.compare(o,e)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const i=this.resolveIndex_(t);if(i)return i.getReverseIteratorFrom(e,s=>s);{const s=this.children_.getReverseIteratorFrom(e.name,be.Wrap);let o=s.peek();for(;o!=null&&t.compare(o,e)>0;)s.getNext(),o=s.peek();return s}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===pi?-1:0}withIndex(e){if(e===Vt||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new ue(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===Vt||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority()))if(this.children_.count()===t.children_.count()){const i=this.getIterator(Ve),s=t.getIterator(Ve);let o=i.getNext(),r=s.getNext();for(;o&&r;){if(o.name!==r.name||!o.node.equals(r.node))return!1;o=i.getNext(),r=s.getNext()}return o===null&&r===null}else return!1;else return!1}}resolveIndex_(e){return e===Vt?null:this.indexMap_.get(e.toString())}}ue.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class xf extends ue{constructor(){super(new ft(ao),ue.EMPTY_NODE,Ft.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return ue.EMPTY_NODE}isEmpty(){return!1}}const pi=new xf;Object.defineProperties(be,{MIN:{value:new be(un,ue.EMPTY_NODE)},MAX:{value:new be(Jt,pi)}});qa.__EMPTY_NODE=ue.EMPTY_NODE;nt.__childrenNodeConstructor=ue;Yf(pi);Qf(pi);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $f=!0;function st(n,e=null){if(n===null)return ue.EMPTY_NODE;if(typeof n=="object"&&".priority"in n&&(e=n[".priority"]),x(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof n=="object"&&".value"in n&&n[".value"]!==null&&(n=n[".value"]),typeof n!="object"||".sv"in n){const t=n;return new nt(t,st(e))}if(!(n instanceof Array)&&$f){const t=[];let i=!1;if(pt(n,(r,a)=>{if(r.substring(0,1)!=="."){const l=st(a);l.isEmpty()||(i=i||!l.getPriority().isEmpty(),t.push(new be(r,l)))}}),t.length===0)return ue.EMPTY_NODE;const o=Mi(t,Vf,r=>r.name,ao);if(i){const r=Mi(t,Ve.getCompare());return new ue(o,st(e),new Ft({".priority":r},{".priority":Ve}))}else return new ue(o,st(e),Ft.Default)}else{let t=ue.EMPTY_NODE;return pt(n,(i,s)=>{if(Lt(n,i)&&i.substring(0,1)!=="."){const o=st(s);(o.isLeafNode()||!o.isEmpty())&&(t=t.updateImmediateChild(i,o))}}),t.updatePriority(st(e))}}Kf(st);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ua extends Xi{constructor(e){super(),this.indexPath_=e,x(!ye(e)&&we(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const i=this.extractChild(e.node),s=this.extractChild(t.node),o=i.compareTo(s);return o===0?Bn(e.name,t.name):o}makePost(e,t){const i=st(e),s=ue.EMPTY_NODE.updateChild(this.indexPath_,i);return new be(t,s)}maxPost(){const e=ue.EMPTY_NODE.updateChild(this.indexPath_,pi);return new be(Jt,e)}toString(){return Ma(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eh extends Xi{compare(e,t){const i=e.node.compareTo(t.node);return i===0?Bn(e.name,t.name):i}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return be.MIN}maxPost(){return be.MAX}makePost(e,t){const i=st(e);return new be(t,i)}toString(){return".value"}}const Ga=new eh;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Va(n){return{type:"value",snapshotNode:n}}function Dn(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function ii(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function si(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}function th(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class co{constructor(e){this.index_=e}updateChild(e,t,i,s,o,r){x(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const a=e.getImmediateChild(t);return a.getChild(s).equals(i.getChild(s))&&a.isEmpty()===i.isEmpty()||(r!=null&&(i.isEmpty()?e.hasChild(t)?r.trackChildChange(ii(t,a)):x(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?r.trackChildChange(Dn(t,i)):r.trackChildChange(si(t,i,a))),e.isLeafNode()&&i.isEmpty())?e:e.updateImmediateChild(t,i).withIndex(this.index_)}updateFullNode(e,t,i){return i!=null&&(e.isLeafNode()||e.forEachChild(Ve,(s,o)=>{t.hasChild(s)||i.trackChildChange(ii(s,o))}),t.isLeafNode()||t.forEachChild(Ve,(s,o)=>{if(e.hasChild(s)){const r=e.getImmediateChild(s);r.equals(o)||i.trackChildChange(si(s,o,r))}else i.trackChildChange(Dn(s,o))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?ue.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oi{constructor(e){this.indexedFilter_=new co(e.getIndex()),this.index_=e.getIndex(),this.startPost_=oi.getStartPost_(e),this.endPost_=oi.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,i=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&i}updateChild(e,t,i,s,o,r){return this.matches(new be(t,i))||(i=ue.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,i,s,o,r)}updateFullNode(e,t,i){t.isLeafNode()&&(t=ue.EMPTY_NODE);let s=t.withIndex(this.index_);s=s.updatePriority(ue.EMPTY_NODE);const o=this;return t.forEachChild(Ve,(r,a)=>{o.matches(new be(r,a))||(s=s.updateImmediateChild(r,ue.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,s,i)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nh{constructor(e){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{const i=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?i<=0:i<0},this.withinEndPost=t=>{const i=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?i<=0:i<0},this.rangedFilter_=new oi(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,i,s,o,r){return this.rangedFilter_.matches(new be(t,i))||(i=ue.EMPTY_NODE),e.getImmediateChild(t).equals(i)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,i,s,o,r):this.fullLimitUpdateChild_(e,t,i,o,r)}updateFullNode(e,t,i){let s;if(t.isLeafNode()||t.isEmpty())s=ue.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<t.numChildren()&&t.isIndexed(this.index_)){s=ue.EMPTY_NODE.withIndex(this.index_);let o;this.reverse_?o=t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):o=t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let r=0;for(;o.hasNext()&&r<this.limit_;){const a=o.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))s=s.updateImmediateChild(a.name,a.node),r++;else break;else continue}}else{s=t.withIndex(this.index_),s=s.updatePriority(ue.EMPTY_NODE);let o;this.reverse_?o=s.getReverseIterator(this.index_):o=s.getIterator(this.index_);let r=0;for(;o.hasNext();){const a=o.getNext();r<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?r++:s=s.updateImmediateChild(a.name,ue.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,s,i)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,i,s,o){let r;if(this.reverse_){const f=this.index_.getCompare();r=(d,_)=>f(_,d)}else r=this.index_.getCompare();const a=e;x(a.numChildren()===this.limit_,"");const l=new be(t,i),c=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),u=this.rangedFilter_.matches(l);if(a.hasChild(t)){const f=a.getImmediateChild(t);let d=s.getChildAfterChild(this.index_,c,this.reverse_);for(;d!=null&&(d.name===t||a.hasChild(d.name));)d=s.getChildAfterChild(this.index_,d,this.reverse_);const _=d==null?1:r(d,l);if(u&&!i.isEmpty()&&_>=0)return o!=null&&o.trackChildChange(si(t,i,f)),a.updateImmediateChild(t,i);{o!=null&&o.trackChildChange(ii(t,f));const g=a.updateImmediateChild(t,ue.EMPTY_NODE);return d!=null&&this.rangedFilter_.matches(d)?(o!=null&&o.trackChildChange(Dn(d.name,d.node)),g.updateImmediateChild(d.name,d.node)):g}}else return i.isEmpty()?e:u&&r(c,l)>=0?(o!=null&&(o.trackChildChange(ii(c.name,c.node)),o.trackChildChange(Dn(t,i))),a.updateImmediateChild(t,i).updateImmediateChild(c.name,ue.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uo{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Ve}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return x(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return x(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:un}hasEnd(){return this.endSet_}getIndexEndValue(){return x(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return x(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Jt}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return x(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Ve}copy(){const e=new uo;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function ih(n){return n.loadsAllData()?new co(n.getIndex()):n.hasLimit()?new nh(n):new oi(n)}function sh(n,e){const t=n.copy();return t.index_=e,t}function dr(n){const e={};if(n.isDefault())return e;let t;if(n.index_===Ve?t="$priority":n.index_===Ga?t="$value":n.index_===Vt?t="$key":(x(n.index_ instanceof Ua,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=xe(t),n.startSet_){const i=n.startAfterSet_?"startAfter":"startAt";e[i]=xe(n.indexStartValue_),n.startNameSet_&&(e[i]+=","+xe(n.indexStartName_))}if(n.endSet_){const i=n.endBeforeSet_?"endBefore":"endAt";e[i]=xe(n.indexEndValue_),n.endNameSet_&&(e[i]+=","+xe(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function fr(n){const e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;t===""&&(n.isViewFromLeft()?t="l":t="r"),e.vf=t}return n.index_!==Ve&&(e.i=n.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Li extends Ra{constructor(e,t,i,s){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=i,this.appCheckTokenProvider_=s,this.log_=_i("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:(x(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,i,s){const o=e._path.toString();this.log_("Listen called for "+o+" "+e._queryIdentifier);const r=Li.getListenId_(e,i),a={};this.listens_[r]=a;const l=dr(e._queryParams);this.restRequest_(o+".json",l,(c,u)=>{let f=u;if(c===404&&(f=null,c=null),c===null&&this.onDataUpdate_(o,f,!1,i),On(this.listens_,r)===a){let d;c?c===401?d="permission_denied":d="rest_error:"+c:d="ok",s(d,null)}})}unlisten(e,t){const i=Li.getListenId_(e,t);delete this.listens_[i]}get(e){const t=dr(e._queryParams),i=e._path.toString(),s=new Ki;return this.restRequest_(i+".json",t,(o,r)=>{let a=r;o===404&&(a=null,o=null),o===null?(this.onDataUpdate_(i,a,!1,null),s.resolve(a)):s.reject(new Error(a))}),s.promise}refreshAuthToken(e){}restRequest_(e,t={},i){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([s,o])=>{s&&s.accessToken&&(t.auth=s.accessToken),o&&o.token&&(t.ac=o.token);const r=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+Mu(t);this.log_("Sending REST request for "+r);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(i&&a.readyState===4){this.log_("REST Response for "+r+" received. status:",a.status,"response:",a.responseText);let l=null;if(a.status>=200&&a.status<300){try{l=$n(a.responseText)}catch{ht("Failed to parse JSON response for "+r+": "+a.responseText)}i(null,l)}else a.status!==401&&a.status!==404&&ht("Got unsuccessful REST response for "+r+" Status: "+a.status),i(a.status);i=null}},a.open("GET",r,!0),a.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oh{constructor(){this.rootNode_=ue.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fi(){return{value:null,children:new Map}}function Ya(n,e,t){if(ye(e))n.value=t,n.children.clear();else if(n.value!==null)n.value=n.value.updateChild(e,t);else{const i=we(e);n.children.has(i)||n.children.set(i,Fi());const s=n.children.get(i);e=qe(e),Ya(s,e,t)}}function Bs(n,e,t){n.value!==null?t(e,n.value):rh(n,(i,s)=>{const o=new Le(e.toString()+"/"+i);Bs(s,o,t)})}function rh(n,e){n.children.forEach((t,i)=>{e(i,t)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lh{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&pt(this.last_,(i,s)=>{t[i]=t[i]-s}),this.last_=e,t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hr=10*1e3,ah=30*1e3,ch=5*60*1e3;class uh{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new lh(e);const i=hr+(ah-hr)*Math.random();Qn(this.reportStats_.bind(this),Math.floor(i))}reportStats_(){const e=this.statsListener_.get(),t={};let i=!1;pt(e,(s,o)=>{o>0&&Lt(this.statsToReport_,s)&&(t[s]=o,i=!0)}),i&&this.server_.reportStats(t),Qn(this.reportStats_.bind(this),Math.floor(Math.random()*2*ch))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var St;(function(n){n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(St||(St={}));function Ka(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function fo(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function ho(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bi{constructor(e,t,i){this.path=e,this.affectedTree=t,this.revert=i,this.type=St.ACK_USER_WRITE,this.source=Ka()}operationForChild(e){if(ye(this.path)){if(this.affectedTree.value!=null)return x(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new Le(e));return new Bi(Ie(),t,this.revert)}}else return x(we(this.path)===e,"operationForChild called for unrelated child."),new Bi(qe(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ri{constructor(e,t){this.source=e,this.path=t,this.type=St.LISTEN_COMPLETE}operationForChild(e){return ye(this.path)?new ri(this.source,Ie()):new ri(this.source,qe(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dn{constructor(e,t,i){this.source=e,this.path=t,this.snap=i,this.type=St.OVERWRITE}operationForChild(e){return ye(this.path)?new dn(this.source,Ie(),this.snap.getImmediateChild(e)):new dn(this.source,qe(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class li{constructor(e,t,i){this.source=e,this.path=t,this.children=i,this.type=St.MERGE}operationForChild(e){if(ye(this.path)){const t=this.children.subtree(new Le(e));return t.isEmpty()?null:t.value?new dn(this.source,Ie(),t.value):new li(this.source,Ie(),t)}else return x(we(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new li(this.source,qe(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xt{constructor(e,t,i){this.node_=e,this.fullyInitialized_=t,this.filtered_=i}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(ye(e))return this.isFullyInitialized()&&!this.filtered_;const t=we(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dh{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function fh(n,e,t,i){const s=[],o=[];return e.forEach(r=>{r.type==="child_changed"&&n.index_.indexedValueChanged(r.oldSnap,r.snapshotNode)&&o.push(th(r.childName,r.snapshotNode))}),Yn(n,s,"child_removed",e,i,t),Yn(n,s,"child_added",e,i,t),Yn(n,s,"child_moved",o,i,t),Yn(n,s,"child_changed",e,i,t),Yn(n,s,"value",e,i,t),s}function Yn(n,e,t,i,s,o){const r=i.filter(a=>a.type===t);r.sort((a,l)=>_h(n,a,l)),r.forEach(a=>{const l=hh(n,a,o);s.forEach(c=>{c.respondsTo(a.type)&&e.push(c.createEvent(l,n.query_))})})}function hh(n,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}function _h(n,e,t){if(e.childName==null||t.childName==null)throw Fn("Should only compare child_ events.");const i=new be(e.childName,e.snapshotNode),s=new be(t.childName,t.snapshotNode);return n.index_.compare(i,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ji(n,e){return{eventCache:n,serverCache:e}}function Xn(n,e,t,i){return Ji(new xt(e,t,i),n.serverCache)}function Qa(n,e,t,i){return Ji(n.eventCache,new xt(e,t,i))}function qi(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function fn(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ws;const ph=()=>(ws||(ws=new ft(ef)),ws);class He{constructor(e,t=ph()){this.value=e,this.children=t}static fromObject(e){let t=new He(null);return pt(e,(i,s)=>{t=t.set(new Le(i),s)}),t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:Ie(),value:this.value};if(ye(e))return null;{const i=we(e),s=this.children.get(i);if(s!==null){const o=s.findRootMostMatchingPathAndValue(qe(e),t);return o!=null?{path:$e(new Le(i),o.path),value:o.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(ye(e))return this;{const t=we(e),i=this.children.get(t);return i!==null?i.subtree(qe(e)):new He(null)}}set(e,t){if(ye(e))return new He(t,this.children);{const i=we(e),o=(this.children.get(i)||new He(null)).set(qe(e),t),r=this.children.insert(i,o);return new He(this.value,r)}}remove(e){if(ye(e))return this.children.isEmpty()?new He(null):new He(null,this.children);{const t=we(e),i=this.children.get(t);if(i){const s=i.remove(qe(e));let o;return s.isEmpty()?o=this.children.remove(t):o=this.children.insert(t,s),this.value===null&&o.isEmpty()?new He(null):new He(this.value,o)}else return this}}get(e){if(ye(e))return this.value;{const t=we(e),i=this.children.get(t);return i?i.get(qe(e)):null}}setTree(e,t){if(ye(e))return t;{const i=we(e),o=(this.children.get(i)||new He(null)).setTree(qe(e),t);let r;return o.isEmpty()?r=this.children.remove(i):r=this.children.insert(i,o),new He(this.value,r)}}fold(e){return this.fold_(Ie(),e)}fold_(e,t){const i={};return this.children.inorderTraversal((s,o)=>{i[s]=o.fold_($e(e,s),t)}),t(e,this.value,i)}findOnPath(e,t){return this.findOnPath_(e,Ie(),t)}findOnPath_(e,t,i){const s=this.value?i(t,this.value):!1;if(s)return s;if(ye(e))return null;{const o=we(e),r=this.children.get(o);return r?r.findOnPath_(qe(e),$e(t,o),i):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,Ie(),t)}foreachOnPath_(e,t,i){if(ye(e))return this;{this.value&&i(t,this.value);const s=we(e),o=this.children.get(s);return o?o.foreachOnPath_(qe(e),$e(t,s),i):new He(null)}}foreach(e){this.foreach_(Ie(),e)}foreach_(e,t){this.children.inorderTraversal((i,s)=>{s.foreach_($e(e,i),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,i)=>{i.value&&e(t,i.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class It{constructor(e){this.writeTree_=e}static empty(){return new It(new He(null))}}function Jn(n,e,t){if(ye(e))return new It(new He(t));{const i=n.writeTree_.findRootMostValueAndPath(e);if(i!=null){const s=i.path;let o=i.value;const r=at(s,e);return o=o.updateChild(r,t),new It(n.writeTree_.set(s,o))}else{const s=new He(t),o=n.writeTree_.setTree(e,s);return new It(o)}}}function _r(n,e,t){let i=n;return pt(t,(s,o)=>{i=Jn(i,$e(e,s),o)}),i}function pr(n,e){if(ye(e))return It.empty();{const t=n.writeTree_.setTree(e,new He(null));return new It(t)}}function qs(n,e){return hn(n,e)!=null}function hn(n,e){const t=n.writeTree_.findRootMostValueAndPath(e);return t!=null?n.writeTree_.get(t.path).getChild(at(t.path,e)):null}function mr(n){const e=[],t=n.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(Ve,(i,s)=>{e.push(new be(i,s))}):n.writeTree_.children.inorderTraversal((i,s)=>{s.value!=null&&e.push(new be(i,s.value))}),e}function Yt(n,e){if(ye(e))return n;{const t=hn(n,e);return t!=null?new It(new He(t)):new It(n.writeTree_.subtree(e))}}function js(n){return n.writeTree_.isEmpty()}function Rn(n,e){return Xa(Ie(),n.writeTree_,e)}function Xa(n,e,t){if(e.value!=null)return t.updateChild(n,e.value);{let i=null;return e.children.inorderTraversal((s,o)=>{s===".priority"?(x(o.value!==null,"Priority writes must always be leaf nodes"),i=o.value):t=Xa($e(n,s),o,t)}),!t.getChild(n).isEmpty()&&i!==null&&(t=t.updateChild($e(n,".priority"),i)),t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zi(n,e){return $a(e,n)}function mh(n,e,t,i,s){x(i>n.lastWriteId,"Stacking an older write on top of newer ones"),s===void 0&&(s=!0),n.allWrites.push({path:e,snap:t,writeId:i,visible:s}),s&&(n.visibleWrites=Jn(n.visibleWrites,e,t)),n.lastWriteId=i}function gh(n,e){for(let t=0;t<n.allWrites.length;t++){const i=n.allWrites[t];if(i.writeId===e)return i}return null}function bh(n,e){const t=n.allWrites.findIndex(a=>a.writeId===e);x(t>=0,"removeWrite called with nonexistent writeId.");const i=n.allWrites[t];n.allWrites.splice(t,1);let s=i.visible,o=!1,r=n.allWrites.length-1;for(;s&&r>=0;){const a=n.allWrites[r];a.visible&&(r>=t&&vh(a,i.path)?s=!1:Et(i.path,a.path)&&(o=!0)),r--}if(s){if(o)return yh(n),!0;if(i.snap)n.visibleWrites=pr(n.visibleWrites,i.path);else{const a=i.children;pt(a,l=>{n.visibleWrites=pr(n.visibleWrites,$e(i.path,l))})}return!0}else return!1}function vh(n,e){if(n.snap)return Et(n.path,e);for(const t in n.children)if(n.children.hasOwnProperty(t)&&Et($e(n.path,t),e))return!0;return!1}function yh(n){n.visibleWrites=Ja(n.allWrites,wh,Ie()),n.allWrites.length>0?n.lastWriteId=n.allWrites[n.allWrites.length-1].writeId:n.lastWriteId=-1}function wh(n){return n.visible}function Ja(n,e,t){let i=It.empty();for(let s=0;s<n.length;++s){const o=n[s];if(e(o)){const r=o.path;let a;if(o.snap)Et(t,r)?(a=at(t,r),i=Jn(i,a,o.snap)):Et(r,t)&&(a=at(r,t),i=Jn(i,Ie(),o.snap.getChild(a)));else if(o.children){if(Et(t,r))a=at(t,r),i=_r(i,a,o.children);else if(Et(r,t))if(a=at(r,t),ye(a))i=_r(i,Ie(),o.children);else{const l=On(o.children,we(a));if(l){const c=l.getChild(qe(a));i=Jn(i,Ie(),c)}}}else throw Fn("WriteRecord should have .snap or .children")}}return i}function Za(n,e,t,i,s){if(!i&&!s){const o=hn(n.visibleWrites,e);if(o!=null)return o;{const r=Yt(n.visibleWrites,e);if(js(r))return t;if(t==null&&!qs(r,Ie()))return null;{const a=t||ue.EMPTY_NODE;return Rn(r,a)}}}else{const o=Yt(n.visibleWrites,e);if(!s&&js(o))return t;if(!s&&t==null&&!qs(o,Ie()))return null;{const r=function(c){return(c.visible||s)&&(!i||!~i.indexOf(c.writeId))&&(Et(c.path,e)||Et(e,c.path))},a=Ja(n.allWrites,r,e),l=t||ue.EMPTY_NODE;return Rn(a,l)}}}function Ch(n,e,t){let i=ue.EMPTY_NODE;const s=hn(n.visibleWrites,e);if(s)return s.isLeafNode()||s.forEachChild(Ve,(o,r)=>{i=i.updateImmediateChild(o,r)}),i;if(t){const o=Yt(n.visibleWrites,e);return t.forEachChild(Ve,(r,a)=>{const l=Rn(Yt(o,new Le(r)),a);i=i.updateImmediateChild(r,l)}),mr(o).forEach(r=>{i=i.updateImmediateChild(r.name,r.node)}),i}else{const o=Yt(n.visibleWrites,e);return mr(o).forEach(r=>{i=i.updateImmediateChild(r.name,r.node)}),i}}function kh(n,e,t,i,s){x(i||s,"Either existingEventSnap or existingServerSnap must exist");const o=$e(e,t);if(qs(n.visibleWrites,o))return null;{const r=Yt(n.visibleWrites,o);return js(r)?s.getChild(t):Rn(r,s.getChild(t))}}function Eh(n,e,t,i){const s=$e(e,t),o=hn(n.visibleWrites,s);if(o!=null)return o;if(i.isCompleteForChild(t)){const r=Yt(n.visibleWrites,s);return Rn(r,i.getNode().getImmediateChild(t))}else return null}function Sh(n,e){return hn(n.visibleWrites,e)}function Ih(n,e,t,i,s,o,r){let a;const l=Yt(n.visibleWrites,e),c=hn(l,Ie());if(c!=null)a=c;else if(t!=null)a=Rn(l,t);else return[];if(a=a.withIndex(r),!a.isEmpty()&&!a.isLeafNode()){const u=[],f=r.getCompare(),d=o?a.getReverseIteratorFrom(i,r):a.getIteratorFrom(i,r);let _=d.getNext();for(;_&&u.length<s;)f(_,i)!==0&&u.push(_),_=d.getNext();return u}else return[]}function Th(){return{visibleWrites:It.empty(),allWrites:[],lastWriteId:-1}}function ji(n,e,t,i){return Za(n.writeTree,n.treePath,e,t,i)}function _o(n,e){return Ch(n.writeTree,n.treePath,e)}function gr(n,e,t,i){return kh(n.writeTree,n.treePath,e,t,i)}function zi(n,e){return Sh(n.writeTree,$e(n.treePath,e))}function Nh(n,e,t,i,s,o){return Ih(n.writeTree,n.treePath,e,t,i,s,o)}function po(n,e,t){return Eh(n.writeTree,n.treePath,e,t)}function xa(n,e){return $a($e(n.treePath,e),n.writeTree)}function $a(n,e){return{treePath:n,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oh{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,i=e.childName;x(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),x(i!==".priority","Only non-priority child changes can be tracked.");const s=this.changeMap.get(i);if(s){const o=s.type;if(t==="child_added"&&o==="child_removed")this.changeMap.set(i,si(i,e.snapshotNode,s.snapshotNode));else if(t==="child_removed"&&o==="child_added")this.changeMap.delete(i);else if(t==="child_removed"&&o==="child_changed")this.changeMap.set(i,ii(i,s.oldSnap));else if(t==="child_changed"&&o==="child_added")this.changeMap.set(i,Dn(i,e.snapshotNode));else if(t==="child_changed"&&o==="child_changed")this.changeMap.set(i,si(i,e.snapshotNode,s.oldSnap));else throw Fn("Illegal combination of changes: "+e+" occurred after "+s)}else this.changeMap.set(i,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dh{getCompleteChild(e){return null}getChildAfterChild(e,t,i){return null}}const ec=new Dh;class mo{constructor(e,t,i=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=i}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const i=this.optCompleteServerCache_!=null?new xt(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return po(this.writes_,e,i)}}getChildAfterChild(e,t,i){const s=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:fn(this.viewCache_),o=Nh(this.writes_,s,t,1,i,e);return o.length===0?null:o[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rh(n){return{filter:n}}function Ah(n,e){x(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),x(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}function Ph(n,e,t,i,s){const o=new Oh;let r,a;if(t.type===St.OVERWRITE){const c=t;c.source.fromUser?r=zs(n,e,c.path,c.snap,i,s,o):(x(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered()&&!ye(c.path),r=Wi(n,e,c.path,c.snap,i,s,a,o))}else if(t.type===St.MERGE){const c=t;c.source.fromUser?r=Lh(n,e,c.path,c.children,i,s,o):(x(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered(),r=Ws(n,e,c.path,c.children,i,s,a,o))}else if(t.type===St.ACK_USER_WRITE){const c=t;c.revert?r=qh(n,e,c.path,i,s,o):r=Fh(n,e,c.path,c.affectedTree,i,s,o)}else if(t.type===St.LISTEN_COMPLETE)r=Bh(n,e,t.path,i,o);else throw Fn("Unknown operation type: "+t.type);const l=o.getChanges();return Mh(e,r,l),{viewCache:r,changes:l}}function Mh(n,e,t){const i=e.eventCache;if(i.isFullyInitialized()){const s=i.getNode().isLeafNode()||i.getNode().isEmpty(),o=qi(n);(t.length>0||!n.eventCache.isFullyInitialized()||s&&!i.getNode().equals(o)||!i.getNode().getPriority().equals(o.getPriority()))&&t.push(Va(qi(e)))}}function tc(n,e,t,i,s,o){const r=e.eventCache;if(zi(i,t)!=null)return e;{let a,l;if(ye(t))if(x(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const c=fn(e),u=c instanceof ue?c:ue.EMPTY_NODE,f=_o(i,u);a=n.filter.updateFullNode(e.eventCache.getNode(),f,o)}else{const c=ji(i,fn(e));a=n.filter.updateFullNode(e.eventCache.getNode(),c,o)}else{const c=we(t);if(c===".priority"){x(Zt(t)===1,"Can't have a priority with additional path components");const u=r.getNode();l=e.serverCache.getNode();const f=gr(i,t,u,l);f!=null?a=n.filter.updatePriority(u,f):a=r.getNode()}else{const u=qe(t);let f;if(r.isCompleteForChild(c)){l=e.serverCache.getNode();const d=gr(i,t,r.getNode(),l);d!=null?f=r.getNode().getImmediateChild(c).updateChild(u,d):f=r.getNode().getImmediateChild(c)}else f=po(i,c,e.serverCache);f!=null?a=n.filter.updateChild(r.getNode(),c,f,u,s,o):a=r.getNode()}}return Xn(e,a,r.isFullyInitialized()||ye(t),n.filter.filtersNodes())}}function Wi(n,e,t,i,s,o,r,a){const l=e.serverCache;let c;const u=r?n.filter:n.filter.getIndexedFilter();if(ye(t))c=u.updateFullNode(l.getNode(),i,null);else if(u.filtersNodes()&&!l.isFiltered()){const _=l.getNode().updateChild(t,i);c=u.updateFullNode(l.getNode(),_,null)}else{const _=we(t);if(!l.isCompleteForPath(t)&&Zt(t)>1)return e;const h=qe(t),v=l.getNode().getImmediateChild(_).updateChild(h,i);_===".priority"?c=u.updatePriority(l.getNode(),v):c=u.updateChild(l.getNode(),_,v,h,ec,null)}const f=Qa(e,c,l.isFullyInitialized()||ye(t),u.filtersNodes()),d=new mo(s,f,o);return tc(n,f,t,s,d,a)}function zs(n,e,t,i,s,o,r){const a=e.eventCache;let l,c;const u=new mo(s,e,o);if(ye(t))c=n.filter.updateFullNode(e.eventCache.getNode(),i,r),l=Xn(e,c,!0,n.filter.filtersNodes());else{const f=we(t);if(f===".priority")c=n.filter.updatePriority(e.eventCache.getNode(),i),l=Xn(e,c,a.isFullyInitialized(),a.isFiltered());else{const d=qe(t),_=a.getNode().getImmediateChild(f);let h;if(ye(d))h=i;else{const g=u.getCompleteChild(f);g!=null?Pa(d)===".priority"&&g.getChild(La(d)).isEmpty()?h=g:h=g.updateChild(d,i):h=ue.EMPTY_NODE}if(_.equals(h))l=e;else{const g=n.filter.updateChild(a.getNode(),f,h,d,u,r);l=Xn(e,g,a.isFullyInitialized(),n.filter.filtersNodes())}}}return l}function br(n,e){return n.eventCache.isCompleteForChild(e)}function Lh(n,e,t,i,s,o,r){let a=e;return i.foreach((l,c)=>{const u=$e(t,l);br(e,we(u))&&(a=zs(n,a,u,c,s,o,r))}),i.foreach((l,c)=>{const u=$e(t,l);br(e,we(u))||(a=zs(n,a,u,c,s,o,r))}),a}function vr(n,e,t){return t.foreach((i,s)=>{e=e.updateChild(i,s)}),e}function Ws(n,e,t,i,s,o,r,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let l=e,c;ye(t)?c=i:c=new He(null).setTree(t,i);const u=e.serverCache.getNode();return c.children.inorderTraversal((f,d)=>{if(u.hasChild(f)){const _=e.serverCache.getNode().getImmediateChild(f),h=vr(n,_,d);l=Wi(n,l,new Le(f),h,s,o,r,a)}}),c.children.inorderTraversal((f,d)=>{const _=!e.serverCache.isCompleteForChild(f)&&d.value===null;if(!u.hasChild(f)&&!_){const h=e.serverCache.getNode().getImmediateChild(f),g=vr(n,h,d);l=Wi(n,l,new Le(f),g,s,o,r,a)}}),l}function Fh(n,e,t,i,s,o,r){if(zi(s,t)!=null)return e;const a=e.serverCache.isFiltered(),l=e.serverCache;if(i.value!=null){if(ye(t)&&l.isFullyInitialized()||l.isCompleteForPath(t))return Wi(n,e,t,l.getNode().getChild(t),s,o,a,r);if(ye(t)){let c=new He(null);return l.getNode().forEachChild(Vt,(u,f)=>{c=c.set(new Le(u),f)}),Ws(n,e,t,c,s,o,a,r)}else return e}else{let c=new He(null);return i.foreach((u,f)=>{const d=$e(t,u);l.isCompleteForPath(d)&&(c=c.set(u,l.getNode().getChild(d)))}),Ws(n,e,t,c,s,o,a,r)}}function Bh(n,e,t,i,s){const o=e.serverCache,r=Qa(e,o.getNode(),o.isFullyInitialized()||ye(t),o.isFiltered());return tc(n,r,t,i,ec,s)}function qh(n,e,t,i,s,o){let r;if(zi(i,t)!=null)return e;{const a=new mo(i,e,s),l=e.eventCache.getNode();let c;if(ye(t)||we(t)===".priority"){let u;if(e.serverCache.isFullyInitialized())u=ji(i,fn(e));else{const f=e.serverCache.getNode();x(f instanceof ue,"serverChildren would be complete if leaf node"),u=_o(i,f)}u=u,c=n.filter.updateFullNode(l,u,o)}else{const u=we(t);let f=po(i,u,e.serverCache);f==null&&e.serverCache.isCompleteForChild(u)&&(f=l.getImmediateChild(u)),f!=null?c=n.filter.updateChild(l,u,f,qe(t),a,o):e.eventCache.getNode().hasChild(u)?c=n.filter.updateChild(l,u,ue.EMPTY_NODE,qe(t),a,o):c=l,c.isEmpty()&&e.serverCache.isFullyInitialized()&&(r=ji(i,fn(e)),r.isLeafNode()&&(c=n.filter.updateFullNode(c,r,o)))}return r=e.serverCache.isFullyInitialized()||zi(i,Ie())!=null,Xn(e,c,r,n.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jh{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const i=this.query_._queryParams,s=new co(i.getIndex()),o=ih(i);this.processor_=Rh(o);const r=t.serverCache,a=t.eventCache,l=s.updateFullNode(ue.EMPTY_NODE,r.getNode(),null),c=o.updateFullNode(ue.EMPTY_NODE,a.getNode(),null),u=new xt(l,r.isFullyInitialized(),s.filtersNodes()),f=new xt(c,a.isFullyInitialized(),o.filtersNodes());this.viewCache_=Ji(f,u),this.eventGenerator_=new dh(this.query_)}get query(){return this.query_}}function zh(n){return n.viewCache_.serverCache.getNode()}function Wh(n){return qi(n.viewCache_)}function Hh(n,e){const t=fn(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!ye(e)&&!t.getImmediateChild(we(e)).isEmpty())?t.getChild(e):null}function yr(n){return n.eventRegistrations_.length===0}function Uh(n,e){n.eventRegistrations_.push(e)}function wr(n,e,t){const i=[];if(t){x(e==null,"A cancel should cancel all event registrations.");const s=n.query._path;n.eventRegistrations_.forEach(o=>{const r=o.createCancelEvent(t,s);r&&i.push(r)})}if(e){let s=[];for(let o=0;o<n.eventRegistrations_.length;++o){const r=n.eventRegistrations_[o];if(!r.matches(e))s.push(r);else if(e.hasAnyCallback()){s=s.concat(n.eventRegistrations_.slice(o+1));break}}n.eventRegistrations_=s}else n.eventRegistrations_=[];return i}function Cr(n,e,t,i){e.type===St.MERGE&&e.source.queryId!==null&&(x(fn(n.viewCache_),"We should always have a full cache before handling merges"),x(qi(n.viewCache_),"Missing event cache, even though we have a server cache"));const s=n.viewCache_,o=Ph(n.processor_,s,e,t,i);return Ah(n.processor_,o.viewCache),x(o.viewCache.serverCache.isFullyInitialized()||!s.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=o.viewCache,nc(n,o.changes,o.viewCache.eventCache.getNode(),null)}function Gh(n,e){const t=n.viewCache_.eventCache,i=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(Ve,(o,r)=>{i.push(Dn(o,r))}),t.isFullyInitialized()&&i.push(Va(t.getNode())),nc(n,i,t.getNode(),e)}function nc(n,e,t,i){const s=i?[i]:n.eventRegistrations_;return fh(n.eventGenerator_,e,t,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Hi;class ic{constructor(){this.views=new Map}}function Vh(n){x(!Hi,"__referenceConstructor has already been defined"),Hi=n}function Yh(){return x(Hi,"Reference.ts has not been loaded"),Hi}function Kh(n){return n.views.size===0}function go(n,e,t,i){const s=e.source.queryId;if(s!==null){const o=n.views.get(s);return x(o!=null,"SyncTree gave us an op for an invalid query."),Cr(o,e,t,i)}else{let o=[];for(const r of n.views.values())o=o.concat(Cr(r,e,t,i));return o}}function sc(n,e,t,i,s){const o=e._queryIdentifier,r=n.views.get(o);if(!r){let a=ji(t,s?i:null),l=!1;a?l=!0:i instanceof ue?(a=_o(t,i),l=!1):(a=ue.EMPTY_NODE,l=!1);const c=Ji(new xt(a,l,!1),new xt(i,s,!1));return new jh(e,c)}return r}function Qh(n,e,t,i,s,o){const r=sc(n,e,i,s,o);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,r),Uh(r,t),Gh(r,t)}function Xh(n,e,t,i){const s=e._queryIdentifier,o=[];let r=[];const a=$t(n);if(s==="default")for(const[l,c]of n.views.entries())r=r.concat(wr(c,t,i)),yr(c)&&(n.views.delete(l),c.query._queryParams.loadsAllData()||o.push(c.query));else{const l=n.views.get(s);l&&(r=r.concat(wr(l,t,i)),yr(l)&&(n.views.delete(s),l.query._queryParams.loadsAllData()||o.push(l.query)))}return a&&!$t(n)&&o.push(new(Yh())(e._repo,e._path)),{removed:o,events:r}}function oc(n){const e=[];for(const t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function Kt(n,e){let t=null;for(const i of n.views.values())t=t||Hh(i,e);return t}function rc(n,e){if(e._queryParams.loadsAllData())return xi(n);{const i=e._queryIdentifier;return n.views.get(i)}}function lc(n,e){return rc(n,e)!=null}function $t(n){return xi(n)!=null}function xi(n){for(const e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ui;function Jh(n){x(!Ui,"__referenceConstructor has already been defined"),Ui=n}function Zh(){return x(Ui,"Reference.ts has not been loaded"),Ui}let xh=1;class kr{constructor(e){this.listenProvider_=e,this.syncPointTree_=new He(null),this.pendingWriteTree_=Th(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function ac(n,e,t,i,s){return mh(n.pendingWriteTree_,e,t,i,s),s?gi(n,new dn(Ka(),e,t)):[]}function rn(n,e,t=!1){const i=gh(n.pendingWriteTree_,e);if(bh(n.pendingWriteTree_,e)){let o=new He(null);return i.snap!=null?o=o.set(Ie(),!0):pt(i.children,r=>{o=o.set(new Le(r),!0)}),gi(n,new Bi(i.path,o,t))}else return[]}function mi(n,e,t){return gi(n,new dn(fo(),e,t))}function $h(n,e,t){const i=He.fromObject(t);return gi(n,new li(fo(),e,i))}function e_(n,e){return gi(n,new ri(fo(),e))}function t_(n,e,t){const i=vo(n,t);if(i){const s=yo(i),o=s.path,r=s.queryId,a=at(o,e),l=new ri(ho(r),a);return wo(n,o,l)}else return[]}function cc(n,e,t,i,s=!1){const o=e._path,r=n.syncPointTree_.get(o);let a=[];if(r&&(e._queryIdentifier==="default"||lc(r,e))){const l=Xh(r,e,t,i);Kh(r)&&(n.syncPointTree_=n.syncPointTree_.remove(o));const c=l.removed;if(a=l.events,!s){const u=c.findIndex(d=>d._queryParams.loadsAllData())!==-1,f=n.syncPointTree_.findOnPath(o,(d,_)=>$t(_));if(u&&!f){const d=n.syncPointTree_.subtree(o);if(!d.isEmpty()){const _=o_(d);for(let h=0;h<_.length;++h){const g=_[h],v=g.query,w=hc(n,g);n.listenProvider_.startListening(Zn(v),ai(n,v),w.hashFn,w.onComplete)}}}!f&&c.length>0&&!i&&(u?n.listenProvider_.stopListening(Zn(e),null):c.forEach(d=>{const _=n.queryToTagMap.get($i(d));n.listenProvider_.stopListening(Zn(d),_)}))}r_(n,c)}return a}function uc(n,e,t,i){const s=vo(n,i);if(s!=null){const o=yo(s),r=o.path,a=o.queryId,l=at(r,e),c=new dn(ho(a),l,t);return wo(n,r,c)}else return[]}function n_(n,e,t,i){const s=vo(n,i);if(s){const o=yo(s),r=o.path,a=o.queryId,l=at(r,e),c=He.fromObject(t),u=new li(ho(a),l,c);return wo(n,r,u)}else return[]}function i_(n,e,t,i=!1){const s=e._path;let o=null,r=!1;n.syncPointTree_.foreachOnPath(s,(d,_)=>{const h=at(d,s);o=o||Kt(_,h),r=r||$t(_)});let a=n.syncPointTree_.get(s);a?(r=r||$t(a),o=o||Kt(a,Ie())):(a=new ic,n.syncPointTree_=n.syncPointTree_.set(s,a));let l;o!=null?l=!0:(l=!1,o=ue.EMPTY_NODE,n.syncPointTree_.subtree(s).foreachChild((_,h)=>{const g=Kt(h,Ie());g&&(o=o.updateImmediateChild(_,g))}));const c=lc(a,e);if(!c&&!e._queryParams.loadsAllData()){const d=$i(e);x(!n.queryToTagMap.has(d),"View does not exist, but we have a tag");const _=l_();n.queryToTagMap.set(d,_),n.tagToQueryMap.set(_,d)}const u=Zi(n.pendingWriteTree_,s);let f=Qh(a,e,t,u,o,l);if(!c&&!r&&!i){const d=rc(a,e);f=f.concat(a_(n,e,d))}return f}function bo(n,e,t){const s=n.pendingWriteTree_,o=n.syncPointTree_.findOnPath(e,(r,a)=>{const l=at(r,e),c=Kt(a,l);if(c)return c});return Za(s,e,o,t,!0)}function s_(n,e){const t=e._path;let i=null;n.syncPointTree_.foreachOnPath(t,(c,u)=>{const f=at(c,t);i=i||Kt(u,f)});let s=n.syncPointTree_.get(t);s?i=i||Kt(s,Ie()):(s=new ic,n.syncPointTree_=n.syncPointTree_.set(t,s));const o=i!=null,r=o?new xt(i,!0,!1):null,a=Zi(n.pendingWriteTree_,e._path),l=sc(s,e,a,o?r.getNode():ue.EMPTY_NODE,o);return Wh(l)}function gi(n,e){return dc(e,n.syncPointTree_,null,Zi(n.pendingWriteTree_,Ie()))}function dc(n,e,t,i){if(ye(n.path))return fc(n,e,t,i);{const s=e.get(Ie());t==null&&s!=null&&(t=Kt(s,Ie()));let o=[];const r=we(n.path),a=n.operationForChild(r),l=e.children.get(r);if(l&&a){const c=t?t.getImmediateChild(r):null,u=xa(i,r);o=o.concat(dc(a,l,c,u))}return s&&(o=o.concat(go(s,n,i,t))),o}}function fc(n,e,t,i){const s=e.get(Ie());t==null&&s!=null&&(t=Kt(s,Ie()));let o=[];return e.children.inorderTraversal((r,a)=>{const l=t?t.getImmediateChild(r):null,c=xa(i,r),u=n.operationForChild(r);u&&(o=o.concat(fc(u,a,l,c)))}),s&&(o=o.concat(go(s,n,i,t))),o}function hc(n,e){const t=e.query,i=ai(n,t);return{hashFn:()=>(zh(e)||ue.EMPTY_NODE).hash(),onComplete:s=>{if(s==="ok")return i?t_(n,t._path,i):e_(n,t._path);{const o=sf(s,t);return cc(n,t,null,o)}}}}function ai(n,e){const t=$i(e);return n.queryToTagMap.get(t)}function $i(n){return n._path.toString()+"$"+n._queryIdentifier}function vo(n,e){return n.tagToQueryMap.get(e)}function yo(n){const e=n.indexOf("$");return x(e!==-1&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new Le(n.substr(0,e))}}function wo(n,e,t){const i=n.syncPointTree_.get(e);x(i,"Missing sync point for query tag that we're tracking");const s=Zi(n.pendingWriteTree_,e);return go(i,t,s,null)}function o_(n){return n.fold((e,t,i)=>{if(t&&$t(t))return[xi(t)];{let s=[];return t&&(s=oc(t)),pt(i,(o,r)=>{s=s.concat(r)}),s}})}function Zn(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(Zh())(n._repo,n._path):n}function r_(n,e){for(let t=0;t<e.length;++t){const i=e[t];if(!i._queryParams.loadsAllData()){const s=$i(i),o=n.queryToTagMap.get(s);n.queryToTagMap.delete(s),n.tagToQueryMap.delete(o)}}}function l_(){return xh++}function a_(n,e,t){const i=e._path,s=ai(n,e),o=hc(n,t),r=n.listenProvider_.startListening(Zn(e),s,o.hashFn,o.onComplete),a=n.syncPointTree_.subtree(i);if(s)x(!$t(a.value),"If we're adding a query, it shouldn't be shadowed");else{const l=a.fold((c,u,f)=>{if(!ye(c)&&u&&$t(u))return[xi(u).query];{let d=[];return u&&(d=d.concat(oc(u).map(_=>_.query))),pt(f,(_,h)=>{d=d.concat(h)}),d}});for(let c=0;c<l.length;++c){const u=l[c];n.listenProvider_.stopListening(Zn(u),ai(n,u))}}return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Co{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new Co(t)}node(){return this.node_}}class ko{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=$e(this.path_,e);return new ko(this.syncTree_,t)}node(){return bo(this.syncTree_,this.path_)}}const c_=function(n){return n=n||{},n.timestamp=n.timestamp||new Date().getTime(),n},Er=function(n,e,t){if(!n||typeof n!="object")return n;if(x(".sv"in n,"Unexpected leaf node or priority contents"),typeof n[".sv"]=="string")return u_(n[".sv"],e,t);if(typeof n[".sv"]=="object")return d_(n[".sv"],e);x(!1,"Unexpected server value: "+JSON.stringify(n,null,2))},u_=function(n,e,t){switch(n){case"timestamp":return t.timestamp;default:x(!1,"Unexpected server value: "+n)}},d_=function(n,e,t){n.hasOwnProperty("increment")||x(!1,"Unexpected server value: "+JSON.stringify(n,null,2));const i=n.increment;typeof i!="number"&&x(!1,"Unexpected increment value: "+i);const s=e.node();if(x(s!==null&&typeof s<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!s.isLeafNode())return i;const r=s.getValue();return typeof r!="number"?i:r+i},f_=function(n,e,t,i){return Eo(e,new ko(t,n),i)},_c=function(n,e,t){return Eo(n,new Co(e),t)};function Eo(n,e,t){const i=n.getPriority().val(),s=Er(i,e.getImmediateChild(".priority"),t);let o;if(n.isLeafNode()){const r=n,a=Er(r.getValue(),e,t);return a!==r.getValue()||s!==r.getPriority().val()?new nt(a,st(s)):n}else{const r=n;return o=r,s!==r.getPriority().val()&&(o=o.updatePriority(new nt(s))),r.forEachChild(Ve,(a,l)=>{const c=Eo(l,e.getImmediateChild(a),t);c!==l&&(o=o.updateImmediateChild(a,c))}),o}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class So{constructor(e="",t=null,i={children:{},childCount:0}){this.name=e,this.parent=t,this.node=i}}function Io(n,e){let t=e instanceof Le?e:new Le(e),i=n,s=we(t);for(;s!==null;){const o=On(i.node.children,s)||{children:{},childCount:0};i=new So(s,i,o),t=qe(t),s=we(t)}return i}function jn(n){return n.node.value}function pc(n,e){n.node.value=e,Hs(n)}function mc(n){return n.node.childCount>0}function h_(n){return jn(n)===void 0&&!mc(n)}function es(n,e){pt(n.node.children,(t,i)=>{e(new So(t,n,i))})}function gc(n,e,t,i){t&&!i&&e(n),es(n,s=>{gc(s,e,!0,i)}),t&&i&&e(n)}function __(n,e,t){let i=t?n:n.parent;for(;i!==null;){if(e(i))return!0;i=i.parent}return!1}function bi(n){return new Le(n.parent===null?n.name:bi(n.parent)+"/"+n.name)}function Hs(n){n.parent!==null&&p_(n.parent,n.name,n)}function p_(n,e,t){const i=h_(t),s=Lt(n.node.children,e);i&&s?(delete n.node.children[e],n.node.childCount--,Hs(n)):!i&&!s&&(n.node.children[e]=t.node,n.node.childCount++,Hs(n))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m_=/[\[\].#$\/\u0000-\u001F\u007F]/,g_=/[\[\].#$\u0000-\u001F\u007F]/,Cs=10*1024*1024,bc=function(n){return typeof n=="string"&&n.length!==0&&!m_.test(n)},vc=function(n){return typeof n=="string"&&n.length!==0&&!g_.test(n)},b_=function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),vc(n)},Sr=function(n){return n===null||typeof n=="string"||typeof n=="number"&&!no(n)||n&&typeof n=="object"&&Lt(n,".sv")},yc=function(n,e,t,i){i&&e===void 0||To(eo(n,"value"),e,t)},To=function(n,e,t){const i=t instanceof Le?new Bf(t,n):t;if(e===void 0)throw new Error(n+"contains undefined "+nn(i));if(typeof e=="function")throw new Error(n+"contains a function "+nn(i)+" with contents = "+e.toString());if(no(e))throw new Error(n+"contains "+e.toString()+" "+nn(i));if(typeof e=="string"&&e.length>Cs/3&&Qi(e)>Cs)throw new Error(n+"contains a string greater than "+Cs+" utf8 bytes "+nn(i)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let s=!1,o=!1;if(pt(e,(r,a)=>{if(r===".value")s=!0;else if(r!==".priority"&&r!==".sv"&&(o=!0,!bc(r)))throw new Error(n+" contains an invalid key ("+r+") "+nn(i)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);qf(i,r),To(n,a,i),jf(i)}),s&&o)throw new Error(n+' contains ".value" child '+nn(i)+" in addition to actual children.")}},wc=function(n,e,t,i){if(!(i&&t===void 0)&&!vc(t))throw new Error(eo(n,e)+'was an invalid path = "'+t+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},v_=function(n,e,t,i){t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),wc(n,e,t,i)},No=function(n,e){if(we(e)===".info")throw new Error(n+" failed = Can't modify data under /.info/")},y_=function(n,e){const t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!bc(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!b_(t))throw new Error(eo(n,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w_{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function Cc(n,e){let t=null;for(let i=0;i<e.length;i++){const s=e[i],o=s.getPath();t!==null&&!Fa(o,t.path)&&(n.eventLists_.push(t),t=null),t===null&&(t={events:[],path:o}),t.events.push(s)}t&&n.eventLists_.push(t)}function Pt(n,e,t){Cc(n,t),C_(n,i=>Et(i,e)||Et(e,i))}function C_(n,e){n.recursionDepth_++;let t=!0;for(let i=0;i<n.eventLists_.length;i++){const s=n.eventLists_[i];if(s){const o=s.path;e(o)?(k_(n.eventLists_[i]),n.eventLists_[i]=null):t=!1}}t&&(n.eventLists_=[]),n.recursionDepth_--}function k_(n){for(let e=0;e<n.events.length;e++){const t=n.events[e];if(t!==null){n.events[e]=null;const i=t.getEventRunner();an&&lt("event: "+t.toString()),qn(i)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E_="repo_interrupt",S_=25;class I_{constructor(e,t,i,s){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=i,this.appCheckProvider_=s,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new w_,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Fi(),this.transactionQueueTree_=new So,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function T_(n,e,t){if(n.stats_=oo(n.repoInfo_),n.forceRestClient_||af())n.server_=new Li(n.repoInfo_,(i,s,o,r)=>{Ir(n,i,s,o,r)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>Tr(n,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{xe(t)}catch(i){throw new Error("Invalid authOverride provided: "+i)}}n.persistentConnection_=new Bt(n.repoInfo_,e,(i,s,o,r)=>{Ir(n,i,s,o,r)},i=>{Tr(n,i)},i=>{N_(n,i)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(i=>{n.server_.refreshAuthToken(i)}),n.appCheckProvider_.addTokenChangeListener(i=>{n.server_.refreshAppCheckToken(i.token)}),n.statsReporter_=hf(n.repoInfo_,()=>new uh(n.stats_,n.server_)),n.infoData_=new oh,n.infoSyncTree_=new kr({startListening:(i,s,o,r)=>{let a=[];const l=n.infoData_.getNode(i._path);return l.isEmpty()||(a=mi(n.infoSyncTree_,i._path,l),setTimeout(()=>{r("ok")},0)),a},stopListening:()=>{}}),Do(n,"connected",!1),n.serverSyncTree_=new kr({startListening:(i,s,o,r)=>(n.server_.listen(i,o,s,(a,l)=>{const c=r(a,l);Pt(n.eventQueue_,i._path,c)}),[]),stopListening:(i,s)=>{n.server_.unlisten(i,s)}})}function kc(n){const t=n.infoData_.getNode(new Le(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function Oo(n){return c_({timestamp:kc(n)})}function Ir(n,e,t,i,s){n.dataUpdateCount++;const o=new Le(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let r=[];if(s)if(i){const l=Oi(t,c=>st(c));r=n_(n.serverSyncTree_,o,l,s)}else{const l=st(t);r=uc(n.serverSyncTree_,o,l,s)}else if(i){const l=Oi(t,c=>st(c));r=$h(n.serverSyncTree_,o,l)}else{const l=st(t);r=mi(n.serverSyncTree_,o,l)}let a=o;r.length>0&&(a=ns(n,o)),Pt(n.eventQueue_,a,r)}function Tr(n,e){Do(n,"connected",e),e===!1&&R_(n)}function N_(n,e){pt(e,(t,i)=>{Do(n,t,i)})}function Do(n,e,t){const i=new Le("/.info/"+e),s=st(t);n.infoData_.updateSnapshot(i,s);const o=mi(n.infoSyncTree_,i,s);Pt(n.eventQueue_,i,o)}function Ec(n){return n.nextWriteId_++}function O_(n,e,t){const i=s_(n.serverSyncTree_,e);return i!=null?Promise.resolve(i):n.server_.get(e).then(s=>{const o=st(s).withIndex(e._queryParams.getIndex());i_(n.serverSyncTree_,e,t,!0);let r;if(e._queryParams.loadsAllData())r=mi(n.serverSyncTree_,e._path,o);else{const a=ai(n.serverSyncTree_,e);r=uc(n.serverSyncTree_,e._path,o,a)}return Pt(n.eventQueue_,e._path,r),cc(n.serverSyncTree_,e,t,null,!0),o},s=>(ts(n,"get for query "+xe(e)+" failed: "+s),Promise.reject(new Error(s))))}function D_(n,e,t,i,s){ts(n,"set",{path:e.toString(),value:t,priority:i});const o=Oo(n),r=st(t,i),a=bo(n.serverSyncTree_,e),l=_c(r,a,o),c=Ec(n),u=ac(n.serverSyncTree_,e,l,c,!0);Cc(n.eventQueue_,u),n.server_.put(e.toString(),r.val(!0),(d,_)=>{const h=d==="ok";h||ht("set at "+e+" failed: "+d);const g=rn(n.serverSyncTree_,c,!h);Pt(n.eventQueue_,e,g),P_(n,s,d,_)});const f=Oc(n,e);ns(n,f),Pt(n.eventQueue_,f,[])}function R_(n){ts(n,"onDisconnectEvents");const e=Oo(n),t=Fi();Bs(n.onDisconnect_,Ie(),(s,o)=>{const r=f_(s,o,n.serverSyncTree_,e);Ya(t,s,r)});let i=[];Bs(t,Ie(),(s,o)=>{i=i.concat(mi(n.serverSyncTree_,s,o));const r=Oc(n,s);ns(n,r)}),n.onDisconnect_=Fi(),Pt(n.eventQueue_,Ie(),i)}function A_(n){n.persistentConnection_&&n.persistentConnection_.interrupt(E_)}function ts(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),lt(t,...e)}function P_(n,e,t,i){e&&qn(()=>{if(t==="ok")e(null);else{const s=(t||"error").toUpperCase();let o=s;i&&(o+=": "+i);const r=new Error(o);r.code=s,e(r)}})}function Sc(n,e,t){return bo(n.serverSyncTree_,e,t)||ue.EMPTY_NODE}function Ro(n,e=n.transactionQueueTree_){if(e||is(n,e),jn(e)){const t=Tc(n,e);x(t.length>0,"Sending zero length transaction queue"),t.every(s=>s.status===0)&&M_(n,bi(e),t)}else mc(e)&&es(e,t=>{Ro(n,t)})}function M_(n,e,t){const i=t.map(c=>c.currentWriteId),s=Sc(n,e,i);let o=s;const r=s.hash();for(let c=0;c<t.length;c++){const u=t[c];x(u.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=1,u.retryCount++;const f=at(e,u.path);o=o.updateChild(f,u.currentOutputSnapshotRaw)}const a=o.val(!0),l=e;n.server_.put(l.toString(),a,c=>{ts(n,"transaction put response",{path:l.toString(),status:c});let u=[];if(c==="ok"){const f=[];for(let d=0;d<t.length;d++)t[d].status=2,u=u.concat(rn(n.serverSyncTree_,t[d].currentWriteId)),t[d].onComplete&&f.push(()=>t[d].onComplete(null,!0,t[d].currentOutputSnapshotResolved)),t[d].unwatcher();is(n,Io(n.transactionQueueTree_,e)),Ro(n,n.transactionQueueTree_),Pt(n.eventQueue_,e,u);for(let d=0;d<f.length;d++)qn(f[d])}else{if(c==="datastale")for(let f=0;f<t.length;f++)t[f].status===3?t[f].status=4:t[f].status=0;else{ht("transaction at "+l.toString()+" failed: "+c);for(let f=0;f<t.length;f++)t[f].status=4,t[f].abortReason=c}ns(n,e)}},r)}function ns(n,e){const t=Ic(n,e),i=bi(t),s=Tc(n,t);return L_(n,s,i),i}function L_(n,e,t){if(e.length===0)return;const i=[];let s=[];const r=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){const l=e[a],c=at(t,l.path);let u=!1,f;if(x(c!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),l.status===4)u=!0,f=l.abortReason,s=s.concat(rn(n.serverSyncTree_,l.currentWriteId,!0));else if(l.status===0)if(l.retryCount>=S_)u=!0,f="maxretry",s=s.concat(rn(n.serverSyncTree_,l.currentWriteId,!0));else{const d=Sc(n,l.path,r);l.currentInputSnapshot=d;const _=e[a].update(d.val());if(_!==void 0){To("transaction failed: Data returned ",_,l.path);let h=st(_);typeof _=="object"&&_!=null&&Lt(_,".priority")||(h=h.updatePriority(d.getPriority()));const v=l.currentWriteId,w=Oo(n),C=_c(h,d,w);l.currentOutputSnapshotRaw=h,l.currentOutputSnapshotResolved=C,l.currentWriteId=Ec(n),r.splice(r.indexOf(v),1),s=s.concat(ac(n.serverSyncTree_,l.path,C,l.currentWriteId,l.applyLocally)),s=s.concat(rn(n.serverSyncTree_,v,!0))}else u=!0,f="nodata",s=s.concat(rn(n.serverSyncTree_,l.currentWriteId,!0))}Pt(n.eventQueue_,t,s),s=[],u&&(e[a].status=2,function(d){setTimeout(d,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(f==="nodata"?i.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):i.push(()=>e[a].onComplete(new Error(f),!1,null))))}is(n,n.transactionQueueTree_);for(let a=0;a<i.length;a++)qn(i[a]);Ro(n,n.transactionQueueTree_)}function Ic(n,e){let t,i=n.transactionQueueTree_;for(t=we(e);t!==null&&jn(i)===void 0;)i=Io(i,t),e=qe(e),t=we(e);return i}function Tc(n,e){const t=[];return Nc(n,e,t),t.sort((i,s)=>i.order-s.order),t}function Nc(n,e,t){const i=jn(e);if(i)for(let s=0;s<i.length;s++)t.push(i[s]);es(e,s=>{Nc(n,s,t)})}function is(n,e){const t=jn(e);if(t){let i=0;for(let s=0;s<t.length;s++)t[s].status!==2&&(t[i]=t[s],i++);t.length=i,pc(e,t.length>0?t:void 0)}es(e,i=>{is(n,i)})}function Oc(n,e){const t=bi(Ic(n,e)),i=Io(n.transactionQueueTree_,e);return __(i,s=>{ks(n,s)}),ks(n,i),gc(i,s=>{ks(n,s)}),t}function ks(n,e){const t=jn(e);if(t){const i=[];let s=[],o=-1;for(let r=0;r<t.length;r++)t[r].status===3||(t[r].status===1?(x(o===r-1,"All SENT items should be at beginning of queue."),o=r,t[r].status=3,t[r].abortReason="set"):(x(t[r].status===0,"Unexpected transaction status in abort"),t[r].unwatcher(),s=s.concat(rn(n.serverSyncTree_,t[r].currentWriteId,!0)),t[r].onComplete&&i.push(t[r].onComplete.bind(null,new Error("set"),!1,null))));o===-1?pc(e,void 0):t.length=o+1,Pt(n.eventQueue_,bi(e),s);for(let r=0;r<i.length;r++)qn(i[r])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F_(n){let e="";const t=n.split("/");for(let i=0;i<t.length;i++)if(t[i].length>0){let s=t[i];try{s=decodeURIComponent(s.replace(/\+/g," "))}catch{}e+="/"+s}return e}function B_(n){const e={};n.charAt(0)==="?"&&(n=n.substring(1));for(const t of n.split("&")){if(t.length===0)continue;const i=t.split("=");i.length===2?e[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):ht(`Invalid query segment '${t}' in query '${n}'`)}return e}const Nr=function(n,e){const t=q_(n),i=t.namespace;t.domain==="firebase.com"&&qt(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!i||i==="undefined")&&t.domain!=="localhost"&&qt("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||xd();const s=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new Ea(t.host,t.secure,i,s,e,"",i!==t.subdomain),path:new Le(t.pathString)}},q_=function(n){let e="",t="",i="",s="",o="",r=!0,a="https",l=443;if(typeof n=="string"){let c=n.indexOf("//");c>=0&&(a=n.substring(0,c-1),n=n.substring(c+2));let u=n.indexOf("/");u===-1&&(u=n.length);let f=n.indexOf("?");f===-1&&(f=n.length),e=n.substring(0,Math.min(u,f)),u<f&&(s=F_(n.substring(u,f)));const d=B_(n.substring(Math.min(n.length,f)));c=e.indexOf(":"),c>=0?(r=a==="https"||a==="wss",l=parseInt(e.substring(c+1),10)):c=e.length;const _=e.slice(0,c);if(_.toLowerCase()==="localhost")t="localhost";else if(_.split(".").length<=2)t=_;else{const h=e.indexOf(".");i=e.substring(0,h).toLowerCase(),t=e.substring(h+1),o=i}"ns"in d&&(o=d.ns)}return{host:e,port:l,domain:t,subdomain:i,secure:r,scheme:a,pathString:s,namespace:o}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Or="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",j_=function(){let n=0;const e=[];return function(t){const i=t===n;n=t;let s;const o=new Array(8);for(s=7;s>=0;s--)o[s]=Or.charAt(t%64),t=Math.floor(t/64);x(t===0,"Cannot push at time == 0");let r=o.join("");if(i){for(s=11;s>=0&&e[s]===63;s--)e[s]=0;e[s]++}else for(s=0;s<12;s++)e[s]=Math.floor(Math.random()*64);for(s=0;s<12;s++)r+=Or.charAt(e[s]);return x(r.length===20,"nextPushId: Length should be 20."),r}}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z_{constructor(e,t,i,s){this.eventType=e,this.eventRegistration=t,this.snapshot=i,this.prevName=s}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+xe(this.snapshot.exportVal())}}class W_{constructor(e,t,i){this.eventRegistration=e,this.error=t,this.path=i}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H_{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return x(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ss{constructor(e,t,i,s){this._repo=e,this._path=t,this._queryParams=i,this._orderByCalled=s}get key(){return ye(this._path)?null:Pa(this._path)}get ref(){return new zt(this._repo,this._path)}get _queryIdentifier(){const e=fr(this._queryParams),t=io(e);return t==="{}"?"default":t}get _queryObject(){return fr(this._queryParams)}isEqual(e){if(e=en(e),!(e instanceof ss))return!1;const t=this._repo===e._repo,i=Fa(this._path,e._path),s=this._queryIdentifier===e._queryIdentifier;return t&&i&&s}toJSON(){return this.toString()}toString(){return this._repo.toString()+Ff(this._path)}}function U_(n,e){if(n._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function G_(n){let e=null,t=null;if(n.hasStart()&&(e=n.getIndexStartValue()),n.hasEnd()&&(t=n.getIndexEndValue()),n.getIndex()===Vt){const i="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",s="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(n.hasStart()){if(n.getIndexStartName()!==un)throw new Error(i);if(typeof e!="string")throw new Error(s)}if(n.hasEnd()){if(n.getIndexEndName()!==Jt)throw new Error(i);if(typeof t!="string")throw new Error(s)}}else if(n.getIndex()===Ve){if(e!=null&&!Sr(e)||t!=null&&!Sr(t))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(x(n.getIndex()instanceof Ua||n.getIndex()===Ga,"unknown index type."),e!=null&&typeof e=="object"||t!=null&&typeof t=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}class zt extends ss{constructor(e,t){super(e,t,new uo,!1)}get parent(){const e=La(this._path);return e===null?null:new zt(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}class ci{constructor(e,t,i){this._node=e,this.ref=t,this._index=i}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new Le(e),i=jt(this.ref,e);return new ci(this._node.getChild(t),i,Ve)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(i,s)=>e(new ci(s,jt(this.ref,i),Ve)))}hasChild(e){const t=new Le(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function An(n,e){return n=en(n),n._checkNotDeleted("ref"),e!==void 0?jt(n._root,e):n._root}function jt(n,e){return n=en(n),we(n._path)===null?v_("child","path",e,!1):wc("child","path",e,!1),new zt(n._repo,$e(n._path,e))}function V_(n,e){n=en(n),No("push",n._path),yc("push",e,n._path,!0);const t=kc(n._repo),i=j_(t),s=jt(n,i),o=jt(n,i);let r;return e!=null?r=os(o,e).then(()=>o):r=Promise.resolve(o),s.then=r.then.bind(r),s.catch=r.then.bind(r,void 0),s}function Y_(n){return No("remove",n._path),os(n,null)}function os(n,e){n=en(n),No("set",n._path),yc("set",e,n._path,!1);const t=new Ki;return D_(n._repo,n._path,e,null,t.wrapCallback(()=>{})),t.promise}function Dc(n){n=en(n);const e=new H_(()=>{}),t=new Ao(e);return O_(n._repo,n,t).then(i=>new ci(i,new zt(n._repo,n._path),n._queryParams.getIndex()))}class Ao{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,t){const i=t._queryParams.getIndex();return new z_("value",this,new ci(e.snapshotNode,new zt(t._repo,t._path),i))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new W_(this,e,t):null}matches(e){return e instanceof Ao?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}class K_{}class Q_ extends K_{_apply(e){U_(e,"orderByKey");const t=sh(e._queryParams,Vt);return G_(t),new ss(e._repo,e._path,t,!0)}}function Rc(){return new Q_}function Ac(n,...e){let t=en(n);for(const i of e)t=i._apply(t);return t}Vh(zt);Jh(zt);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X_="FIREBASE_DATABASE_EMULATOR_HOST",Us={};let J_=!1;function Z_(n,e,t,i){n.repoInfo_=new Ea(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0),i&&(n.authTokenProvider_=i)}function x_(n,e,t,i,s){let o=i||n.options.databaseURL;o===void 0&&(n.options.projectId||qt("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),lt("Using default host for project ",n.options.projectId),o=`${n.options.projectId}-default-rtdb.firebaseio.com`);let r=Nr(o,s),a=r.repoInfo,l,c;typeof process<"u"&&process.env&&(c=process.env[X_]),c?(l=!0,o=`http://${c}?ns=${a.namespace}`,r=Nr(o,s),a=r.repoInfo):l=!r.repoInfo.secure;const u=s&&l?new En(En.OWNER):new uf(n.name,n.options,e);y_("Invalid Firebase Database URL",r),ye(r.path)||qt("Database URL must point to the root of a Firebase Database (not including a child path).");const f=ep(a,n,u,new cf(n.name,t));return new tp(f,n)}function $_(n,e){const t=Us[e];(!t||t[n.key]!==n)&&qt(`Database ${e}(${n.repoInfo_}) has already been deleted.`),A_(n),delete t[n.key]}function ep(n,e,t,i){let s=Us[e.name];s||(s={},Us[e.name]=s);let o=s[n.toURLString()];return o&&qt("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),o=new I_(n,J_,t,i),s[n.toURLString()]=o,o}class tp{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(T_(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new zt(this._repo,Ie())),this._rootInternal}_delete(){return this._rootInternal!==null&&($_(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&qt("Cannot call "+e+" on a deleted database.")}}function np(n=Ld(),e){const t=Rd(n,"database").getImmediate({identifier:e});if(!t._instanceStarted){const i=ku("database");i&&ip(t,...i)}return t}function ip(n,e,t,i={}){n=en(n),n._checkNotDeleted("useEmulator"),n._instanceStarted&&qt("Cannot call useEmulator() after instance has already been initialized.");const s=n._repoInternal;let o;if(s.repoInfo_.nodeAdmin)i.mockUserToken&&qt('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),o=new En(En.OWNER);else if(i.mockUserToken){const r=typeof i.mockUserToken=="string"?i.mockUserToken:Eu(i.mockUserToken,n.app.options.projectId);o=new En(r)}Z_(s,e,t,o)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sp(n){Kd(Md),Ri(new ei("database",(e,{instanceIdentifier:t})=>{const i=e.getProvider("app").getImmediate(),s=e.getProvider("auth-internal"),o=e.getProvider("app-check-internal");return x_(i,s,o,t)},"PUBLIC").setMultipleInstances(!0)),Cn(Xo,Jo,n),Cn(Xo,Jo,"esm2017")}Bt.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)};Bt.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)};sp();var Gs={},Pc={},rs={};Object.defineProperty(rs,"__esModule",{value:!0});rs.rotx=void 0;function op(n,e){return n.replace(/[a-zA-Z]/g,function(t){return String.fromCharCode((t<="Z"?90:122)>=(t=t.charCodeAt(0)+e)?t:t-26)})}rs.rotx=op;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.rotx=void 0;var e=rs;Object.defineProperty(n,"rotx",{enumerable:!0,get:function(){return e.rotx}})})(Pc);var Mc={},ls={};Object.defineProperty(ls,"__esModule",{value:!0});ls.base64=void 0;class rp{encode(e){return typeof btoa>"u"?Buffer.from(e,"binary").toString("base64"):btoa(e)}decode(e){return typeof atob>"u"?Buffer.from(e,"base64").toString("binary"):atob(e)}}const lp=new rp;ls.base64=lp;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.base64=void 0;var e=ls;Object.defineProperty(n,"base64",{enumerable:!0,get:function(){return e.base64}})})(Mc);var Lc={},as={};Object.defineProperty(as,"__esModule",{value:!0});as.hex=void 0;class ap{encode(e){let t="",i="";for(let s=0;s<e.length;s++)t=e.charCodeAt(s).toString(16),i+=("000"+t).slice(-4);return i}decode(e){let t=e.match(/.{1,4}/g)||[],i="";for(let s=0;s<t.length;s++)i+=String.fromCharCode(parseInt(t[s],16));return i}}const cp=new ap;as.hex=cp;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.hex=void 0;var e=as;Object.defineProperty(n,"hex",{enumerable:!0,get:function(){return e.hex}})})(Lc);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.hex=n.base64=n.rotx=void 0;var e=Pc;Object.defineProperty(n,"rotx",{enumerable:!0,get:function(){return e.rotx}});var t=Mc;Object.defineProperty(n,"base64",{enumerable:!0,get:function(){return t.base64}});var i=Lc;Object.defineProperty(n,"hex",{enumerable:!0,get:function(){return i.hex}})})(Gs);let up={ixqSmg:"IQhiAgIPDNBgKzMmPcWG9XWqEsxI2uQ70F5X1rY",icbpLwuiqv:"nk-d3-8j3n9.nqzmjiamixx.kwu",libijiamCZT:"pbbxa://nk-d3-8j3n9-lmnictb-zblj.mczwxm-emab1.nqzmjiamlibijiam.ixx",xzwrmkbQl:"nk-d3-8j3n9",abwziomJcksmb:"nk-d3-8j3n9.ixxaxwb.kwu",umaaioqvoAmvlmzQl:"31377888705",ixxQl:"1:31377888705:emj:3018l8nk0i07m867mk0j40"},Fc={};for(let[n,e]of Object.entries(up))Fc[Gs.rotx(n,18)]=Gs.rotx(e,18);let Pn={armor:"Armor",magicDmg:"Magic",meleeDmg:"Melee",rangedDmg:"Ranged",hpRegen:"HP Regen",endurance:"Endurance",sightRange:"Sight Range",walkSpeed:"Walk Speed",jumpPower:"Jump Power",ammoReturn:"Ammo Return",height:"Height"},ui=["head","body","legs","feet","neck","back","ring","misc"],cs={name:"",stats:{armor:0,magicDmg:0,meleeDmg:0,rangedDmg:0,hpRegen:0,endurance:0,sightRange:0,walkSpeed:0,jumpPower:0,ammoReturn:0,height:0},cost:{min:0,max:0},image:"",link:""},us={name:"",info:{type:"",special:""},moves:[],cost:{min:0,max:0},image:"",link:""},dp={armor:{min:0,avg:0,max:0},gear:{min:0,avg:0,max:0},total:{min:0,avg:0,max:0}},Qt=[...Array(5).keys()].map(n=>++n),Mn=np(la(Fc)),fp=["head","body","legs","feet","neck","back","ring","misc","gear","sets","bonuses"],Bc={0:"th",1:"st",2:"nd",3:"rd",4:"th",5:"th",6:"th",7:"th",8:"th",9:"th"};function qc(n,e){let t=!1;for(let i of[n,e])for(let s in i)if(i[s].name){t=!0;break}xs.set(t),dt.set(null),window.history.replaceState(null,null,location.origin+location.pathname)}function Po(n,e){let t=2.8,i=e.split(" ").length,s=n.querySelector("span");if(s.style.removeProperty("font-size"),i>2&&e.length/i>=5){for(;s.offsetHeight>n.offsetHeight*.75;)t-=.05,s.style.fontSize=`calc(var(--u) * ${t})`;return t<2.8}return null}function hp(n,e){let t=2.8,i=n.querySelector("span");for(i.style.removeProperty("font-size");i.offsetWidth>n.offsetWidth;)t-=.05,i.style.fontSize=`calc(var(--u) * ${t})`;for(;i.offsetHeight>n.offsetHeight*.75&&e;)t-=.05,i.style.fontSize=`calc(var(--u) * ${t})`;return t<2.8?t:null}function _p(n){let e=2.35,t=n.querySelector(".tooltip");for(t.style.removeProperty("font-size");t.offsetHeight>n.offsetHeight*1.125;)e-=.02,t.style.fontSize=`calc(var(--u) * ${e})`}function pp(n){document.activeElement==document.body&&n.key=="Tab"&&(n.preventDefault(),document.querySelector(`.promptCont [id*='${n.shiftKey?"last":"first"}Focusable']`).focus())}function jc(n,e){let t=n.toLowerCase();for(let i in e)i.toLowerCase().includes(t)&&!e[i].classList.contains("filtered")?e[i].classList.remove("hidden"):e[i].classList.add("hidden")}function Gi(n,e){e&&setTimeout(()=>{n.focus(),n.click(),n.select()})}function vt(n){n.shiftKey&&n.key=="Tab"&&n.preventDefault()}function yt(n){n.key=="Tab"&&!n.shiftKey&&n.preventDefault()}function Vi(n,e){let t=/[^a-zA-Z0-9~!#$%^&*()\-_+[\]{}\\|;:'",.<>/? ]/g;return n.replace(t,"").replaceAll(`
`,"").replace(/^ /,"").slice(0,e)}function Vs(n,e,t){(!n.maxLength||n.maxLength!=t)&&e.length>=t&&(n.maxLength=t)}function zc(n,e){n={...n},e={...e};for(let t of ui)n[t]?n[t]=n[t].name:n[t]="";for(let t of Qt)e[t]?e[t]=e[t].name:e[t]="";return{eq:n,gear:e}}function Mo(){window.history.replaceState(null,null,location.origin+location.pathname+"?ls=true")}function Sn(n){n.target.closest("button").blur()}function mp(n){let e,t,i,s,o,r,a,l,c,u;return{c(){e=b("li"),t=b("button"),i=b("img"),o=T(),r=b("span"),r.textContent=`${n[4]}`,a=T(),l=b("iconify-icon"),tt(i.src,s=n[0].image)||m(i,"src",s),m(i,"alt",""),Xe(l,"icon","maki:cross"),te(e,"selectedItem",n[2])},m(f,d){B(f,e,d),p(e,t),p(t,i),p(t,o),p(t,r),p(t,a),p(t,l),n[13](e),c||(u=[ql(n[5].call(null,r)),D(t,"click",n[6]),D(t,"mouseenter",n[9]),D(t,"focusin",n[10]),D(t,"mouseleave",n[11]),D(t,"focusout",n[12])],c=!0)},p(f,[d]){d&1&&!tt(i.src,s=f[0].image)&&m(i,"src",s),d&4&&te(e,"selectedItem",f[2])},i:se,o:se,d(f){f&&M(e),n[13](null),c=!1,ge(u)}}}function gp(n,e,t){let i,s,o,r,a,l;J(n,ut,A=>t(14,i=A)),J(n,wn,A=>t(15,s=A)),J(n,Tt,A=>t(16,o=A)),J(n,Nt,A=>t(17,r=A)),J(n,At,A=>t(18,a=A)),J(n,Zs,A=>t(19,l=A));let{itemData:c,slotOpen:u,eqSlotName:f}=e;const d=Mt();let _,h=!1,g=c.name,v;function w(A){setTimeout(()=>{Po(_,g)&&l.push({node:_,itemName:g})})}function C(A){if(u||!u&&A.isTrusted==!1){d("itemSelect",{element:_,trusted:A.isTrusted}),_.classList.contains("selectedItem")||t(2,h=!1),t(2,h=!h),t(7,u=!1),X(Nt,r[f]=h?c:cs,r),qc(r,a);for(let G of Object.keys(Pn)){X(ut,i[G]=0,i);for(let W in r)r[W].noStats||(X(ut,i[G]+=r[W].stats[G],i),X(ut,i[G]=Math.round(i[G]*10)/10,i))}for(let G of o.bonuses)if(s[G.name])for(let W in i)X(ut,i[W]+=G.stats[W],i),X(ut,i[W]=Math.round(i[W]*10)/10,i)}}const y=()=>t(3,v=!0),k=()=>t(3,v=!0),E=()=>t(3,v=!1),O=()=>t(3,v=!1);function I(A){ne[A?"unshift":"push"](()=>{_=A,t(1,_)})}return n.$$set=A=>{"itemData"in A&&t(0,c=A.itemData),"slotOpen"in A&&t(7,u=A.slotOpen),"eqSlotName"in A&&t(8,f=A.eqSlotName)},[c,_,h,v,g,w,C,u,f,y,k,E,O,I]}class bp extends Ne{constructor(e){super(),Te(this,e,gp,mp,pe,{itemData:0,slotOpen:7,eqSlotName:8})}}function vp(n){let e,t,i,s,o,r,a,l,c,u,f,d;return{c(){e=b("li"),t=b("button"),i=b("img"),o=T(),r=b("span"),r.textContent=`${n[5]}`,a=T(),l=b("iconify-icon"),tt(i.src,s=n[0].image)||m(i,"src",s),m(i,"alt",""),Xe(l,"icon",c=n[4]?"heroicons-solid:switch-vertical":"maki:cross"),t.disabled=u=!n[3]&&!n[4],te(e,"selectedItem",n[1]),te(e,"non-eligible",!n[3]&&!n[4]),te(e,"switchable",n[4])},m(_,h){B(_,e,h),p(e,t),p(t,i),p(t,o),p(t,r),p(t,a),p(t,l),n[13](e),f||(d=[ql(n[6].call(null,r)),D(t,"click",n[7])],f=!0)},p(_,[h]){h&1&&!tt(i.src,s=_[0].image)&&m(i,"src",s),h&16&&c!==(c=_[4]?"heroicons-solid:switch-vertical":"maki:cross")&&Xe(l,"icon",c),h&24&&u!==(u=!_[3]&&!_[4])&&(t.disabled=u),h&2&&te(e,"selectedItem",_[1]),h&24&&te(e,"non-eligible",!_[3]&&!_[4]),h&16&&te(e,"switchable",_[4])},i:se,o:se,d(_){_&&M(e),n[13](null),f=!1,ge(d)}}}function yp(n,e,t){let i,s,o,r,a;J(n,At,O=>t(11,i=O)),J(n,$,O=>t(12,s=O)),J(n,Nt,O=>t(14,o=O)),J(n,Nn,O=>t(15,r=O)),J(n,Zs,O=>t(16,a=O));let{itemData:l,slotOpen:c,index:u,weaponExpand:f}=e;const d=Mt();let _,h=!1,g=!0,v=!1,w=l.name,C={"Orange Salamander":["Green Salamander","Purple Salamander"],"Green Salamander":["Orange Salamander","Purple Salamander"],"Purple Salamander":["Orange Salamander","Green Salamander"],"White Salamander":["Black Salamander","Gold Salamander"],"Black Salamander":["White Salamander","Gold Salamander"],"Gold Salamander":["White Salamander","Black Salamander"]};function y(O){setTimeout(()=>{Po(_,w)&&a.push({node:_,itemName:w})})}function k(O){g&&(c||!c&&O.isTrusted==!1)&&(l.tool&&f&&d("toolSelect"),d("itemSelect",{element:_,trusted:O.isTrusted}),_.classList.contains("selectedItem")||t(1,h=!1),t(8,c=!1),v?setTimeout(()=>{r[u][w].querySelector("button").click(),r[Object.keys(i).find(I=>i[I].name==w)][i[u]&&i[u].name?i[u].name:w].querySelector("button").click(),t(3,g=!0),t(4,v=!1)},5):(t(1,h=!h),X(At,i[u]=h?l:us,i)),qc(o,i))}function E(O){ne[O?"unshift":"push"](()=>{_=O,t(2,_)})}return n.$$set=O=>{"itemData"in O&&t(0,l=O.itemData),"slotOpen"in O&&t(8,c=O.slotOpen),"index"in O&&t(9,u=O.index),"weaponExpand"in O&&t(10,f=O.weaponExpand)},n.$$.update=()=>{if(n.$$.dirty&3586&&i)for(let O in i){if(!f&&O!=u&&i[O].name==w){t(4,v=!0);break}if(O!=u&&C[i[O].name]&&C[i[O].name].includes(w)){t(3,g=!1);break}else h||t(3,g=!0)}if(n.$$.dirty&6656)if(s.randomize.ongoing)t(4,v=!1);else for(let O in i)if(O!=u&&i[O].name==w){t(4,v=!0);break}else t(4,v=!1)},[l,h,_,g,v,w,y,k,c,u,f,i,s,E]}class wp extends Ne{constructor(e){super(),Te(this,e,yp,vp,pe,{itemData:0,slotOpen:8,index:9,weaponExpand:10})}}function Cp(n){const e=n-1;return e*e*e+1}function Je(n,{delay:e=0,duration:t=400,easing:i=Yi}={}){const s=+getComputedStyle(n).opacity;return{delay:e,duration:t,easing:i,css:o=>`opacity: ${o*s}`}}function Ze(n,{delay:e=0,duration:t=400,easing:i=Cp,start:s=0,opacity:o=0}={}){const r=getComputedStyle(n),a=+r.opacity,l=r.transform==="none"?"":r.transform,c=1-s,u=a*(1-o);return{delay:e,duration:t,easing:i,css:(f,d)=>`
			transform: ${l} scale(${1-c*d});
			opacity: ${a-u*d}
		`}}function Dr(n){let e,t,i,s;return{c(){e=b("img"),tt(e.src,t=n[5][n[3]])||m(e,"src",t),m(e,"alt","")},m(o,r){B(o,e,r),s=!0},p(o,r){(!s||r&8&&!tt(e.src,t=o[5][o[3]]))&&m(e,"src",t)},i(o){s||(o&&ke(()=>{s&&(i||(i=Ce(e,Je,{duration:150},!0)),i.run(1))}),s=!0)},o(o){o&&(i||(i=Ce(e,Je,{duration:150},!1)),i.run(0)),s=!1},d(o){o&&M(e),o&&i&&i.end()}}}function kp(n){let e,t,i=n[5][n[3]],s,o,r=n[0].name+"",a,l,c,u=Dr(n);return{c(){e=b("li"),t=b("button"),u.c(),s=T(),o=b("span"),a=ie(r),te(e,"selectedItem",n[4])},m(f,d){B(f,e,d),p(e,t),u.m(t,null),p(t,s),p(t,o),p(o,a),n[8](e),l||(c=[D(t,"click",n[6]),D(e,"mouseenter",n[9]),D(e,"focusin",n[10]),D(e,"mouseleave",n[11]),D(e,"focusout",n[12])],l=!0)},p(f,[d]){d&8&&pe(i,i=f[5][f[3]])?(Pe(),V(u,1,1,se),Me(),u=Dr(f),u.c(),L(u,1),u.m(t,s)):u.p(f,d),d&1&&r!==(r=f[0].name+"")&&Ee(a,r)},i(f){L(u)},o(f){V(u)},d(f){f&&M(e),u.d(f),n[8](null),l=!1,ge(c)}}}function Ep(n,e,t){let i,s,o;J(n,Tn,A=>t(15,i=A)),J(n,Nt,A=>t(16,s=A)),J(n,Tt,A=>t(17,o=A));let{itemData:r,ddOpen:a=!1}=e;const l=Mt();let c,u=!1,f=!1,d,_=0,h=r.pieces.length,g=["head","body","legs","feet"];g=h==2?g.slice(1,3):h==3?g.slice(0,3):g;let v=[];for(let A=0;A<h;A++)v.push(o[g[A]].find(G=>G.name==r.pieces[A]).image);function w(){f?d=setInterval(()=>{t(3,_++,_),_==h&&t(3,_=0)},750):(clearInterval(d),t(3,_=0))}function C(){l("setSelect");let A=0;for(let G=0;G<h;G++)!s[g[G]]||s[g[G]].name!=r.pieces[G]?i[g[G]][r.pieces[G]].querySelector("button").click():A++;A!=h&&t(7,a=!1)}function y(A){ne[A?"unshift":"push"](()=>{c=A,t(2,c)})}const k=()=>t(1,f=!0),E=()=>t(1,f=!0),O=()=>t(1,f=!1),I=()=>t(1,f=!1);return n.$$set=A=>{"itemData"in A&&t(0,r=A.itemData),"ddOpen"in A&&t(7,a=A.ddOpen)},n.$$.update=()=>{n.$$.dirty&2&&(f||!f)&&w()},[r,f,c,_,u,v,C,a,y,k,E,O,I]}class Sp extends Ne{constructor(e){super(),Te(this,e,Ep,kp,pe,{itemData:0,ddOpen:7})}}const Ip=n=>({}),Rr=n=>({});function Tp(n){let e,t,i,s,o,r,a,l,c;const u=n[8].tooltip,f=Yc(u,n,n[7],Rr);return{c(){e=b("div"),t=b("span"),i=T(),s=b("input"),r=T(),f&&f.c(),m(s,"id",o=n[2]?"firstFocusable":n[3]?"lastFocusable":""),s.disabled=n[4],m(s,"type","checkbox"),s.checked=n[1],m(s,"class","svelte-1oscat4"),m(e,"class","toggleCont svelte-1oscat4"),te(e,"unavailable",n[4])},m(d,_){B(d,e,_),p(e,t),t.innerHTML=n[0],p(e,i),p(e,s),p(e,r),f&&f.m(e,null),a=!0,l||(c=[D(s,"change",n[9]),D(s,"keydown",n[10])],l=!0)},p(d,[_]){(!a||_&1)&&(t.innerHTML=d[0]),(!a||_&12&&o!==(o=d[2]?"firstFocusable":d[3]?"lastFocusable":""))&&m(s,"id",o),(!a||_&16)&&(s.disabled=d[4]),(!a||_&2)&&(s.checked=d[1]),f&&f.p&&(!a||_&128)&&Qc(f,u,d,d[7],a?Kc(u,d[7],_,Ip):Xc(d[7]),Rr),(!a||_&16)&&te(e,"unavailable",d[4])},i(d){a||(L(f,d),a=!0)},o(d){V(f,d),a=!1},d(d){d&&M(e),f&&f.d(d),l=!1,ge(c)}}}function Np(n,e,t){let{$$slots:i={},$$scope:s}=e,{text:o,checked:r=!1,first:a=!1,last:l=!1,disabled:c=!1,forced:u=!1}=e;const f=Mt(),d=h=>{h.target.blur(),u?h.target.checked=!0:f("toggle",h.target.checked)},_=h=>{a&&vt(h),l&&yt(h),h.key=="Enter"&&!u?(h.target.checked=!h.target.checked,f("toggle",h.target.checked)):u&&(h.target.checked=!0)};return n.$$set=h=>{"text"in h&&t(0,o=h.text),"checked"in h&&t(1,r=h.checked),"first"in h&&t(2,a=h.first),"last"in h&&t(3,l=h.last),"disabled"in h&&t(4,c=h.disabled),"forced"in h&&t(5,u=h.forced),"$$scope"in h&&t(7,s=h.$$scope)},[o,r,a,l,c,u,f,s,i,d,_]}class ct extends Ne{constructor(e){super(),Te(this,e,Np,Tp,pe,{text:0,checked:1,first:2,last:3,disabled:4,forced:5})}}function Ar(n,e,t){const i=n.slice();return i[26]=e[t][0],i[27]=e[t][1],i}function Pr(n,e,t){const i=n.slice();return i[26]=e[t][0],i[27]=e[t][1],i}function Mr(n){let e,t;function i(...s){return n[17](n[26],...s)}return e=new ct({props:{text:n[27],checked:n[5][n[26]]}}),e.$on("toggle",i),{c(){le(e.$$.fragment)},m(s,o){oe(e,s,o),t=!0},p(s,o){n=s;const r={};o[0]&32&&(r.checked=n[5][n[26]]),e.$set(r)},i(s){t||(L(e.$$.fragment,s),t=!0)},o(s){V(e.$$.fragment,s),t=!1},d(s){re(e,s)}}}function Op(n){let e,t,i,s,o,r,a,l,c,u,f;r=new ct({props:{text:"Descension",checked:n[3],forced:n[3]}}),r.$on("toggle",n[18]),l=new ct({props:{text:"Ascension",checked:n[4],forced:n[4]}}),l.$on("toggle",n[19]);let d=Ae(Object.entries(n[8])),_=[];for(let g=0;g<d.length;g+=1)_[g]=Lr(Ar(n,d,g));const h=g=>V(_[g],1,1,()=>{_[g]=null});return{c(){e=b("p"),e.textContent="Sort",t=T(),i=b("div"),s=b("span"),s.textContent="By:",o=T(),le(r.$$.fragment),a=T(),le(l.$$.fragment),c=T(),u=b("div");for(let g=0;g<_.length;g+=1)_[g].c();m(e,"id","title"),m(e,"class","svelte-15nzxbp"),m(s,"class","svelte-15nzxbp"),m(i,"class","radio ttFocus svelte-15nzxbp"),m(i,"id","sort"),m(u,"class","options svelte-15nzxbp")},m(g,v){B(g,e,v),B(g,t,v),B(g,i,v),p(i,s),p(i,o),oe(r,i,null),p(i,a),oe(l,i,null),B(g,c,v),B(g,u,v);for(let w=0;w<_.length;w+=1)_[w]&&_[w].m(u,null);f=!0},p(g,v){const w={};v[0]&8&&(w.checked=g[3]),v[0]&8&&(w.forced=g[3]),r.$set(w);const C={};if(v[0]&16&&(C.checked=g[4]),v[0]&16&&(C.forced=g[4]),l.$set(C),v[0]&832){d=Ae(Object.entries(g[8]));let y;for(y=0;y<d.length;y+=1){const k=Ar(g,d,y);_[y]?(_[y].p(k,v),L(_[y],1)):(_[y]=Lr(k),_[y].c(),L(_[y],1),_[y].m(u,null))}for(Pe(),y=d.length;y<_.length;y+=1)h(y);Me()}},i(g){if(!f){L(r.$$.fragment,g),L(l.$$.fragment,g);for(let v=0;v<d.length;v+=1)L(_[v]);f=!0}},o(g){V(r.$$.fragment,g),V(l.$$.fragment,g),_=_.filter(Boolean);for(let v=0;v<_.length;v+=1)V(_[v]);f=!1},d(g){g&&(M(e),M(t),M(i),M(c),M(u)),re(r),re(l),_t(_,g)}}}function Lr(n){let e,t;function i(...s){return n[20](n[26],...s)}return e=new ct({props:{text:n[27],checked:n[6][n[26]],last:n[26]=="none"||n[26]=="tool"}}),e.$on("toggle",i),{c(){le(e.$$.fragment)},m(s,o){oe(e,s,o),t=!0},p(s,o){n=s;const r={};o[0]&64&&(r.checked=n[6][n[26]]),e.$set(r)},i(s){t||(L(e.$$.fragment,s),t=!0)},o(s){V(e.$$.fragment,s),t=!1},d(s){re(e,s)}}}function Dp(n){let e,t,i,s,o,r,a,l,c,u,f,d,_,h,g,v,w,C,y,k,E,O,I,A,G;l=new ct({props:{text:"Inclusive",checked:n[1],forced:n[1]}}),l.$on("toggle",n[13]),u=new ct({props:{text:"Exclusive",checked:n[2],forced:n[2]}}),u.$on("toggle",n[14]);let W=Ae(Object.entries(n[8])),S=[];for(let q=0;q<W.length;q+=1)S[q]=Mr(Pr(n,W,q));const H=q=>V(S[q],1,1,()=>{S[q]=null});let N=!n[7]&&Op(n);return{c(){e=b("div"),t=b("div"),i=b("p"),i.textContent="Filter",s=T(),o=b("div"),r=b("span"),r.textContent="Type:",a=T(),le(l.$$.fragment),c=T(),le(u.$$.fragment),f=T(),d=b("span"),d.textContent=`Whether to look for equipment that contains or doesn't contain\r
                the selected search types.`,_=T(),h=b("div"),g=b("div"),v=b("button"),v.textContent="Select all",w=T(),C=b("div"),y=b("button"),y.textContent="Clear all",k=T(),E=b("div");for(let q=0;q<S.length;q+=1)S[q].c();O=T(),N&&N.c(),m(i,"id","title"),m(i,"class","svelte-15nzxbp"),m(r,"class","svelte-15nzxbp"),m(d,"class","tooltip svelte-15nzxbp"),m(d,"id","bottom"),m(o,"class","radio ttFocus svelte-15nzxbp"),m(o,"id","filter"),m(v,"class","svelte-15nzxbp"),m(g,"class","svelte-15nzxbp"),m(y,"class","svelte-15nzxbp"),m(C,"class","svelte-15nzxbp"),m(h,"class","optionsAll svelte-15nzxbp"),m(E,"class","options svelte-15nzxbp"),m(t,"class","searchOptions svelte-15nzxbp"),m(e,"class","searchOptionsCont svelte-15nzxbp"),te(e,"optionsOpen",n[0])},m(q,R){B(q,e,R),p(e,t),p(t,i),p(t,s),p(t,o),p(o,r),p(o,a),oe(l,o,null),p(o,c),oe(u,o,null),p(o,f),p(o,d),p(t,_),p(t,h),p(h,g),p(g,v),p(h,w),p(h,C),p(C,y),p(t,k),p(t,E);for(let U=0;U<S.length;U+=1)S[U]&&S[U].m(E,null);p(t,O),N&&N.m(t,null),I=!0,A||(G=[D(v,"click",n[15]),D(y,"click",n[16])],A=!0)},p(q,R){const U={};R[0]&2&&(U.checked=q[1]),R[0]&2&&(U.forced=q[1]),l.$set(U);const F={};if(R[0]&4&&(F.checked=q[2]),R[0]&4&&(F.forced=q[2]),u.$set(F),R[0]&800){W=Ae(Object.entries(q[8]));let P;for(P=0;P<W.length;P+=1){const ee=Pr(q,W,P);S[P]?(S[P].p(ee,R),L(S[P],1)):(S[P]=Mr(ee),S[P].c(),L(S[P],1),S[P].m(E,null))}for(Pe(),P=W.length;P<S.length;P+=1)H(P);Me()}q[7]||N.p(q,R),(!I||R[0]&1)&&te(e,"optionsOpen",q[0])},i(q){if(!I){L(l.$$.fragment,q),L(u.$$.fragment,q);for(let R=0;R<W.length;R+=1)L(S[R]);L(N),I=!0}},o(q){V(l.$$.fragment,q),V(u.$$.fragment,q),S=S.filter(Boolean);for(let R=0;R<S.length;R+=1)V(S[R]);V(N),I=!1},d(q){q&&M(e),re(l),re(u),_t(S,q),N&&N.d(),A=!1,ge(G)}}}function Rp(n,e,t){let i;J(n,Tt,N=>t(22,i=N));let{optionsOpen:s,slotName:o,elementData:r,list:a}=e;const l=Mt();let c=o=="gear",u=!0,f=!1,d=!0,_=!1,h={},g={},v=c?{armor:"Armor",magicDmg:"Magic",meleeDmg:"Melee",rangedDmg:"Ranged",unique:"Unique",tool:"Tool"}:{...Pn,none:"No Stats"};for(let N of Object.keys(v))h[N]=!0;for(let N of Object.keys(v))g[N]=!1;let w=["Void Spike Ultradagger","Pureblood Dagger","Gnome Rocket Launcher"],C=[];function y(N){setTimeout(()=>{for(let q in r){let R=i[o].find(he=>he.name==q),U={...Pn},F={armor:!1,magicDmg:!1,meleeDmg:!1,rangedDmg:!1,unique:!1,tool:!1},P=c?F:U,ee=!1;if(c)if(!R.tool&&!w.includes(R.name)){for(let he in h)for(let de of R.moves)if(F[he]=de.type.includes(he),F[he])break}else F.tool=!!R.tool,F.tool||(F.unique=R.info.type=="Unique",R.name=="Void Spike Ultradagger"&&(F.armor=!0,F.meleeDmg=!0));else{for(let he in h)U[he]=R.stats[he]!=0;U.none=!!R.noStats}if(u)for(let he in P)if(h[he]&&P[he]){ee=!1;break}else ee=!0;else if(f)for(let he in P)if(h[he]&&P[he]){ee=!0;break}else ee=!1;ee?r[q].classList.add("hidden","filtered"):r[q].classList.remove("hidden","filtered")}if(N=="sort"){let q=Object.keys(g).find(U=>g[U]),R=0;for(q&&!(q=="none"||q=="tool")?(C.sort((U,F)=>{let P=k(U,F,!0).stats[q]-k(U,F,!1).stats[q];return R||(R=P),P}),R||(C=Object.values(r))):!q&&_&&(C=Object.values(r).toReversed()),q=="none"&&(C=[...Object.entries(r).filter(U=>i[o].find(F=>F.name==U[0]).noStats),...Object.entries(r).filter(U=>!i[o].find(F=>F.name==U[0]).noStats)],C=C.map(U=>U[1]),_&&C.reverse());a.lastElementChild;)a.removeChild(a.lastElementChild);if(q||!q&&_)for(let U of C)a.appendChild(U);else for(let U in r)a.appendChild(r[U])}l("listUpdate")})}function k(N,q,R){return i[o].find(U=>U.name==Object.keys(r).find(F=>r[F]===(d?R?q:N:R?N:q)))}const E=N=>{t(1,u=N.detail),N.detail&&t(2,f=!1),y("filter")},O=N=>{t(2,f=N.detail),N.detail&&t(1,u=!1),y("filter")},I=N=>{N.target.blur();for(let q in h)t(5,h[q]=!0,h);y("filter")},A=N=>{N.target.blur();for(let q in h)t(5,h[q]=!1,h);y("filter")},G=(N,q)=>{t(5,h[N]=q.detail,h),y("filter")},W=N=>{t(3,d=N.detail),N.detail&&t(4,_=!1),y("sort")},S=N=>{t(4,_=N.detail),N.detail&&t(3,d=!1),y("sort")},H=(N,q)=>{if(t(6,g[N]=q.detail,g),q.detail)for(let R in g)R!=N&&t(6,g[R]=!1,g);y("sort")};return n.$$set=N=>{"optionsOpen"in N&&t(0,s=N.optionsOpen),"slotName"in N&&t(10,o=N.slotName),"elementData"in N&&t(11,r=N.elementData),"list"in N&&t(12,a=N.list)},n.$$.update=()=>{n.$$.dirty[0]&4096&&a&&(C=[...a.children])},[s,u,f,d,_,h,g,c,v,y,o,r,a,E,O,I,A,G,W,S,H]}class Ap extends Ne{constructor(e){super(),Te(this,e,Rp,Dp,pe,{optionsOpen:0,slotName:10,elementData:11,list:12},null,[-1,-1])}}function Fr(n,e,t){const i=n.slice();return i[47]=e[t],i}function Pp(n){let e;return{c(){e=b("span"),e.textContent="Loading items...",m(e,"class","svelte-suojz2")},m(t,i){B(t,e,i)},p:se,i:se,o:se,d(t){t&&M(e)}}}function Mp(n){let e,t,i,s,o,r,a,l=n[3]!="sets"&&Br(n),c=Ae(n[6]),u=[];for(let d=0;d<c.length;d+=1)u[d]=qr(Fr(n,c,d));const f=d=>V(u[d],1,1,()=>{u[d]=null});return{c(){e=b("input"),t=T(),l&&l.c(),i=T(),s=b("ul");for(let d=0;d<u.length;d+=1)u[d].c();m(e,"type","text"),m(e,"class","searchBarInput"),m(e,"placeholder","Search..."),m(s,"class","svelte-suojz2"),te(s,"no-scrollbar",n[12].length<=4)},m(d,_){B(d,e,_),n[23](e),B(d,t,_),l&&l.m(d,_),B(d,i,_),B(d,s,_);for(let h=0;h<u.length;h+=1)u[h]&&u[h].m(s,null);n[32](s),o=!0,r||(a=[D(e,"keydown",n[15]),D(e,"input",n[16])],r=!0)},p(d,_){if(d[3]!="sets"?l?l.p(d,_):(l=Br(d),l.c(),l.m(i.parentNode,i)):l&&(l.d(1),l=null),_[0]&149595){c=Ae(d[6]);let h;for(h=0;h<c.length;h+=1){const g=Fr(d,c,h);u[h]?(u[h].p(g,_),L(u[h],1)):(u[h]=qr(g),u[h].c(),L(u[h],1),u[h].m(s,null))}for(Pe(),h=c.length;h<u.length;h+=1)f(h);Me()}(!o||_[0]&4096)&&te(s,"no-scrollbar",d[12].length<=4)},i(d){if(!o){for(let _=0;_<c.length;_+=1)L(u[_]);o=!0}},o(d){u=u.filter(Boolean);for(let _=0;_<u.length;_+=1)V(u[_]);o=!1},d(d){d&&(M(e),M(t),M(i),M(s)),n[23](null),l&&l.d(d),_t(u,d),n[32](null),r=!1,ge(a)}}}function Br(n){let e,t,i;return{c(){e=b("button"),e.innerHTML='<iconify-icon icon="mi:filter"></iconify-icon>',m(e,"class","optionsButton svelte-suojz2")},m(s,o){B(s,e,o),n[24](e),t||(i=D(e,"click",n[25]),t=!0)},p:se,d(s){s&&M(e),n[24](null),t=!1,i()}}}function Lp(n){let e,t,i;function s(r){n[31](r)}let o={itemData:n[47],eqSlotName:n[3]};return n[0]!==void 0&&(o.slotOpen=n[0]),e=new bp({props:o}),ne.push(()=>De(e,"slotOpen",s)),e.$on("itemSelect",n[17]),{c(){le(e.$$.fragment)},m(r,a){oe(e,r,a),i=!0},p(r,a){const l={};a[0]&64&&(l.itemData=r[47]),a[0]&8&&(l.eqSlotName=r[3]),!t&&a[0]&1&&(t=!0,l.slotOpen=r[0],Oe(()=>t=!1)),e.$set(l)},i(r){i||(L(e.$$.fragment,r),i=!0)},o(r){V(e.$$.fragment,r),i=!1},d(r){re(e,r)}}}function Fp(n){let e,t,i;function s(r){n[29](r)}let o={itemData:n[47]};return n[0]!==void 0&&(o.ddOpen=n[0]),e=new Sp({props:o}),ne.push(()=>De(e,"ddOpen",s)),e.$on("setSelect",n[30]),{c(){le(e.$$.fragment)},m(r,a){oe(e,r,a),i=!0},p(r,a){const l={};a[0]&64&&(l.itemData=r[47]),!t&&a[0]&1&&(t=!0,l.ddOpen=r[0],Oe(()=>t=!1)),e.$set(l)},i(r){i||(L(e.$$.fragment,r),i=!0)},o(r){V(e.$$.fragment,r),i=!1},d(r){re(e,r)}}}function Bp(n){let e,t,i,s;function o(l){n[26](l)}function r(l){n[27](l)}let a={itemData:n[47],index:n[4]};return n[0]!==void 0&&(a.slotOpen=n[0]),n[1]!==void 0&&(a.weaponExpand=n[1]),e=new wp({props:a}),ne.push(()=>De(e,"slotOpen",o)),ne.push(()=>De(e,"weaponExpand",r)),e.$on("itemSelect",n[17]),e.$on("toolSelect",n[28]),{c(){le(e.$$.fragment)},m(l,c){oe(e,l,c),s=!0},p(l,c){const u={};c[0]&64&&(u.itemData=l[47]),c[0]&16&&(u.index=l[4]),!t&&c[0]&1&&(t=!0,u.slotOpen=l[0],Oe(()=>t=!1)),!i&&c[0]&2&&(i=!0,u.weaponExpand=l[1],Oe(()=>i=!1)),e.$set(u)},i(l){s||(L(e.$$.fragment,l),s=!0)},o(l){V(e.$$.fragment,l),s=!1},d(l){re(e,l)}}}function qr(n){let e,t,i,s;const o=[Bp,Fp,Lp],r=[];function a(l,c){return l[4]?0:l[3]=="sets"?1:2}return e=a(n),t=r[e]=o[e](n),{c(){t.c(),i=bt()},m(l,c){r[e].m(l,c),B(l,i,c),s=!0},p(l,c){let u=e;e=a(l),e===u?r[e].p(l,c):(Pe(),V(r[u],1,1,()=>{r[u]=null}),Me(),t=r[e],t?t.p(l,c):(t=r[e]=o[e](l),t.c()),L(t,1),t.m(i.parentNode,i))},i(l){s||(L(t),s=!0)},o(l){V(t),s=!1},d(l){l&&M(i),r[e].d(l)}}}function jr(n){let e,t,i,s;function o(l){n[33](l)}function r(l){n[34](l)}let a={slotName:n[3],elementData:n[13]};return n[2]!==void 0&&(a.optionsOpen=n[2]),n[5]!==void 0&&(a.list=n[5]),e=new Ap({props:a}),ne.push(()=>De(e,"optionsOpen",o)),ne.push(()=>De(e,"list",r)),e.$on("listUpdate",n[16]),{c(){le(e.$$.fragment)},m(l,c){oe(e,l,c),s=!0},p(l,c){const u={};c[0]&8&&(u.slotName=l[3]),c[0]&8192&&(u.elementData=l[13]),!t&&c[0]&4&&(t=!0,u.optionsOpen=l[2],Oe(()=>t=!1)),!i&&c[0]&32&&(i=!0,u.list=l[5],Oe(()=>i=!1)),e.$set(u)},i(l){s||(L(e.$$.fragment,l),s=!0)},o(l){V(e.$$.fragment,l),s=!1},d(l){re(e,l)}}}function qp(n){let e,t,i,s,o,r,a;const l=[Mp,Pp],c=[];function u(d,_){return d[6]?0:1}t=u(n),i=c[t]=l[t](n);let f=n[3]!="sets"&&jr(n);return{c(){e=b("div"),i.c(),s=T(),f&&f.c(),m(e,"class","dropdown svelte-suojz2")},m(d,_){B(d,e,_),c[t].m(e,null),p(e,s),f&&f.m(e,null),n[35](e),o=!0,r||(a=[D(e,"transitionend",n[36]),D(e,"transitioncancel",n[37])],r=!0)},p(d,_){let h=t;t=u(d),t===h?c[t].p(d,_):(Pe(),V(c[h],1,1,()=>{c[h]=null}),Me(),i=c[t],i?i.p(d,_):(i=c[t]=l[t](d),i.c()),L(i,1),i.m(e,s)),d[3]!="sets"?f?(f.p(d,_),_[0]&8&&L(f,1)):(f=jr(d),f.c(),L(f,1),f.m(e,null)):f&&(Pe(),V(f,1,1,()=>{f=null}),Me())},i(d){o||(L(i),L(f),o=!0)},o(d){V(i),V(f),o=!1},d(d){d&&M(e),c[t].d(),f&&f.d(),n[35](null),r=!1,ge(a)}}}function jp(n,e,t){let i,s,o,r,a,l,c,u,f;J(n,Tt,K=>t(19,o=K)),J(n,Tn,K=>t(20,r=K)),J(n,hu,K=>t(21,a=K)),J(n,Nn,K=>t(22,l=K)),J(n,gt,K=>t(40,c=K)),J(n,At,K=>t(41,u=K)),J(n,Nt,K=>t(42,f=K));let{slotName:d,index:_=0,slotOpen:h,weaponExpand:g=null,optionsOpen:v=!1}=e;const w=Mt();_?X(Nn,l[_]={},l):X(Tn,r[d]={},r);let C,y,k,E,O,I=null,A=!1,G=!1,W=[];function S(){O&&O.classList.remove("lastElement"),t(12,W=k.querySelectorAll("li:not(.hidden)")),O=W[W.length-1],O&&O.classList.add("lastElement"),(!O||O.classList.contains("non-eligible"))&&(O=E)}function H(K){!K.shiftKey&&K.key=="Tab"&&!v&&(K.preventDefault(),setTimeout(()=>y.focus()))}function N(){O&&O.removeEventListener("keydown",H),S(),O&&O.addEventListener("keydown",H)}function q(K){K.shiftKey&&K.key=="Tab"&&(K.preventDefault(),setTimeout(()=>(O.querySelector("button")||O).focus()))}function R(){jc(y.value,i),N()}function U(K){w("itemSelect",K.detail.element),t(10,I=K.detail.element),A=K.detail.trusted;let Y=k.querySelector(".selectedItem");Y&&Y!=K.detail.element&&Y.classList.remove("selectedItem"),t(11,G=!0),A||(P(),k.scrollTo(0,I.offsetTop)),setTimeout(F)}function F(){X(gt,c=structuredClone(dp),c);for(let K in f)f[K].cost.min!=null&&(X(gt,c.armor.min+=f[K].cost.min,c),X(gt,c.armor.max+=f[K].cost.max,c));X(gt,c.armor.avg=Math.ceil((c.armor.min+c.armor.max)/2),c);for(let K in u)u[K].cost.min!=null&&(X(gt,c.gear.min+=u[K].cost.min,c),X(gt,c.gear.max+=u[K].cost.max,c));X(gt,c.gear.avg=Math.ceil((c.gear.min+c.gear.max)/2),c),X(gt,c.total.min=c.armor.min+c.gear.min,c),X(gt,c.total.max=c.armor.max+c.gear.max,c),X(gt,c.total.avg=Math.ceil((c.total.min+c.total.max)/2),c)}function P(){t(11,G=!1),t(8,y.value="",y),R()}function ee(K){ne[K?"unshift":"push"](()=>{y=K,t(8,y)})}function he(K){ne[K?"unshift":"push"](()=>{E=K,t(9,E)})}const de=()=>t(2,v=!v);function _e(K){h=K,t(0,h)}function j(K){g=K,t(1,g)}const Z=()=>w("toolSelect");function ae(K){h=K,t(0,h)}const je=()=>t(11,G=!0);function Se(K){h=K,t(0,h)}function Fe(K){ne[K?"unshift":"push"](()=>{k=K,t(5,k)})}function Ge(K){v=K,t(2,v)}function Ke(K){k=K,t(5,k)}function Qe(K){ne[K?"unshift":"push"](()=>{C=K,t(7,C)})}const Ue=K=>{K.propertyName=="visibility"&&K.target==C&&(G&&P(),!h&&I&&setTimeout(()=>k.scrollTo(0,I.offsetTop)),Gi(y,h))},fe=K=>{K.propertyName=="visibility"&&K.target==C&&(t(11,G=!1),Gi(y,h))};return n.$$set=K=>{"slotName"in K&&t(3,d=K.slotName),"index"in K&&t(4,_=K.index),"slotOpen"in K&&t(0,h=K.slotOpen),"weaponExpand"in K&&t(1,g=K.weaponExpand),"optionsOpen"in K&&t(2,v=K.optionsOpen)},n.$$.update=()=>{if(n.$$.dirty[0]&7340056&&t(13,i=_?l[_]:d=="sets"?a:r[d]),n.$$.dirty[0]&524296&&t(6,s=o[d]),n.$$.dirty[0]&96&&k){t(12,W=k.querySelectorAll("li:not(.hidden)"));for(let K=0;K<k.childElementCount;K++)t(13,i[s[K].name]=k.children[K],i);S(),N()}},[h,g,v,d,_,k,s,C,y,E,I,G,W,i,w,q,R,U,P,o,r,a,l,ee,he,de,_e,j,Z,ae,je,Se,Fe,Ge,Ke,Qe,Ue,fe]}class Lo extends Ne{constructor(e){super(),Te(this,e,jp,qp,pe,{slotName:3,index:4,slotOpen:0,weaponExpand:1,optionsOpen:2},null,[-1,-1])}}function zr(n){let e,t,i,s,o,r,a=n[1].name+"",l,c,u,f,d,_;return{c(){e=b("a"),t=b("img"),o=T(),r=b("span"),l=ie(a),tt(t.src,i=n[1].image)||m(t,"src",i),m(t,"alt",s=n[1].name),m(t,"draggable","false"),m(t,"class","svelte-1ph7qia"),m(r,"class","tooltip"),m(r,"id","left"),m(e,"href",c=n[1].link),m(e,"target","_blank"),m(e,"class","svelte-1ph7qia"),et(e,"display",n[1].link?"":"none")},m(h,g){B(h,e,g),p(e,t),p(e,o),p(e,r),p(r,l),f=!0,d||(_=[D(e,"focusin",n[12]),D(e,"outroend",n[13])],d=!0)},p(h,g){(!f||g&2&&!tt(t.src,i=h[1].image))&&m(t,"src",i),(!f||g&2&&s!==(s=h[1].name))&&m(t,"alt",s),(!f||g&2)&&a!==(a=h[1].name+"")&&Ee(l,a),(!f||g&2&&c!==(c=h[1].link))&&m(e,"href",c),g&2&&et(e,"display",h[1].link?"":"none")},i(h){f||(h&&ke(()=>{f&&(u||(u=Ce(e,Je,{duration:150},!0)),u.run(1))}),f=!0)},o(h){h&&(u||(u=Ce(e,Je,{duration:150},!1)),u.run(0)),f=!1},d(h){h&&M(e),h&&u&&u.end(),d=!1,ge(_)}}}function zp(n){let e,t,i=n[1],s,o,r=n[0].charAt(0).toUpperCase()+n[0].slice(1)+"",a,l,c,u,f,d,_,h,g,v,w,C,y=zr(n);function k(I){n[17](I)}function E(I){n[18](I)}let O={slotName:n[0]};return n[4]!==void 0&&(O.slotOpen=n[4]),n[6]!==void 0&&(O.optionsOpen=n[6]),_=new Lo({props:O}),ne.push(()=>De(_,"slotOpen",k)),ne.push(()=>De(_,"optionsOpen",E)),_.$on("itemSelect",n[19]),{c(){e=b("div"),t=b("div"),y.c(),s=T(),o=b("button"),a=ie(r),l=T(),c=b("iconify-icon"),u=T(),f=b("button"),f.innerHTML='<iconify-icon icon="maki:cross" class="svelte-1ph7qia"></iconify-icon> <span class="tooltip" id="top">Clear selection</span>',d=T(),le(_.$$.fragment),m(t,"class","eqSlotIcon ff-border svelte-1ph7qia"),Xe(c,"icon","iconamoon:arrow-down-2-fill"),Xe(c,"class","svelte-1ph7qia"),m(o,"class","ddButton svelte-1ph7qia"),m(f,"class","clearButton svelte-1ph7qia"),m(e,"class","eqSlotCont svelte-1ph7qia"),te(e,"slotOpen",n[4]),te(e,"clearAllowed",n[5]&&n[7])},m(I,A){B(I,e,A),p(e,t),y.m(t,null),n[14](t),p(e,s),p(e,o),p(o,a),p(o,l),p(o,c),p(e,u),p(e,f),p(e,d),oe(_,e,null),n[20](e),v=!0,w||(C=[D(window,"mousedown",n[10]),D(window,"keydown",n[11]),D(o,"click",n[15]),D(f,"click",n[16]),D(e,"mouseenter",n[21]),D(e,"mouseleave",n[22])],w=!0)},p(I,[A]){A&2&&pe(i,i=I[1])?(Pe(),V(y,1,1,se),Me(),y=zr(I),y.c(),L(y,1),y.m(t,null)):y.p(I,A),(!v||A&1)&&r!==(r=I[0].charAt(0).toUpperCase()+I[0].slice(1)+"")&&Ee(a,r);const G={};A&1&&(G.slotName=I[0]),!h&&A&16&&(h=!0,G.slotOpen=I[4],Oe(()=>h=!1)),!g&&A&64&&(g=!0,G.optionsOpen=I[6],Oe(()=>g=!1)),_.$set(G),(!v||A&16)&&te(e,"slotOpen",I[4]),(!v||A&160)&&te(e,"clearAllowed",I[5]&&I[7])},i(I){v||(L(y),L(_.$$.fragment,I),v=!0)},o(I){V(y),V(_.$$.fragment,I),v=!1},d(I){I&&M(e),y.d(I),n[14](null),re(_),n[20](null),w=!1,ge(C)}}}function Wp(n,e,t){let i,s;J(n,Nt,W=>t(9,i=W)),J(n,$,W=>t(8,s=W));let{eqSlotName:o}=e,r,a,l=cs,c,u,f,d;const _=W=>{(!r.contains(W.target)||W.target==r||W.target==a)&&(t(4,c=!1),t(6,f=!1),W.target!=r&&W.target!=a&&t(5,u=!1))},h=W=>{W.key=="Tab"?setTimeout(()=>{t(5,u=r.contains(document.activeElement))}):W.key=="Escape"&&(t(4,c=!1),t(6,f=!1))},g=W=>{W.relatedTarget==null&&t(5,u=!0)},v=()=>{setTimeout(()=>{_p(a)})};function w(W){ne[W?"unshift":"push"](()=>{a=W,t(3,a)})}const C=()=>{s.screenshot.ongoing||t(4,c=!c)},y=()=>{t(5,u=!1),r.classList.contains("clearAllowed")&&d.querySelector("button").click()};function k(W){c=W,t(4,c)}function E(W){f=W,t(6,f)}const O=W=>{setTimeout(()=>{t(7,d=W.detail.classList.contains("selectedItem")?W.detail:null),t(6,f=!1)})};function I(W){ne[W?"unshift":"push"](()=>{r=W,t(2,r)})}const A=()=>t(5,u=!0),G=()=>{r.contains(document.activeElement)||t(5,u=!1)};return n.$$set=W=>{"eqSlotName"in W&&t(0,o=W.eqSlotName)},n.$$.update=()=>{n.$$.dirty&515&&i[o]&&i[o].name!=l.name&&t(1,l=i[o])},[o,l,r,a,c,u,f,d,s,i,_,h,g,v,w,C,y,k,E,O,I,A,G]}class Hp extends Ne{constructor(e){super(),Te(this,e,Wp,zp,pe,{eqSlotName:0})}}function Wr(n,e,t){const i=n.slice();return i[1]=e[t],i[2]=e,i[3]=t,i}function Hr(n){let e,t,i;function s(r){n[0](r,n[1],n[2],n[3])}let o={};return n[1]!==void 0&&(o.eqSlotName=n[1]),e=new Hp({props:o}),ne.push(()=>De(e,"eqSlotName",s)),{c(){le(e.$$.fragment)},m(r,a){oe(e,r,a),i=!0},p(r,a){n=r;const l={};!t&&a&0&&(t=!0,l.eqSlotName=n[1],Oe(()=>t=!1)),e.$set(l)},i(r){i||(L(e.$$.fragment,r),i=!0)},o(r){V(e.$$.fragment,r),i=!1},d(r){re(e,r)}}}function Up(n){let e,t,i=Ae(Array(...ui)),s=[];for(let r=0;r<i.length;r+=1)s[r]=Hr(Wr(n,i,r));const o=r=>V(s[r],1,1,()=>{s[r]=null});return{c(){e=b("div");for(let r=0;r<s.length;r+=1)s[r].c();m(e,"class","armorBox svelte-35g1a3")},m(r,a){B(r,e,a);for(let l=0;l<s.length;l+=1)s[l]&&s[l].m(e,null);t=!0},p(r,[a]){if(a&0){i=Ae(Array(...ui));let l;for(l=0;l<i.length;l+=1){const c=Wr(r,i,l);s[l]?(s[l].p(c,a),L(s[l],1)):(s[l]=Hr(c),s[l].c(),L(s[l],1),s[l].m(e,null))}for(Pe(),l=i.length;l<s.length;l+=1)o(l);Me()}},i(r){if(!t){for(let a=0;a<i.length;a+=1)L(s[a]);t=!0}},o(r){s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)V(s[a]);t=!1},d(r){r&&M(e),_t(s,r)}}}function Gp(n,e,t){function i(s,o,r,a){r[a]=s}return[i]}class Vp extends Ne{constructor(e){super(),Te(this,e,Gp,Up,pe,{})}}function Yp(n){let e,t=(n[3]?`${Math.floor(n[5]*.675+19.8)}% Reduction`:n[5])+"",i,s,o;return{c(){e=b("span"),i=ie(t),m(e,"class","statValue svelte-gx367h"),m(e,"tabindex","0"),te(e,"hidden",n[2]),te(e,"negative",n[5]<0),te(e,"zero",n[5]==0),te(e,"reduction",n[3])},m(r,a){B(r,e,a),p(e,i),s||(o=[D(e,"mouseenter",n[11]),D(e,"mouseleave",n[12]),D(e,"focusin",n[13]),D(e,"focusout",n[14])],s=!0)},p(r,a){a&40&&t!==(t=(r[3]?`${Math.floor(r[5]*.675+19.8)}% Reduction`:r[5])+"")&&Ee(i,t),a&4&&te(e,"hidden",r[2]),a&32&&te(e,"negative",r[5]<0),a&32&&te(e,"zero",r[5]==0),a&8&&te(e,"reduction",r[3])},d(r){r&&M(e),s=!1,ge(o)}}}function Kp(n){let e,t=(n[0]!="endurance"?n[5]:n[5].toFixed(2))+"",i;return{c(){e=b("span"),i=ie(t),m(e,"class","statValue svelte-gx367h"),te(e,"hidden",n[2]),te(e,"negative",n[5]<0),te(e,"zero",n[5]==0)},m(s,o){B(s,e,o),p(e,i)},p(s,o){o&33&&t!==(t=(s[0]!="endurance"?s[5]:s[5].toFixed(2))+"")&&Ee(i,t),o&4&&te(e,"hidden",s[2]),o&32&&te(e,"negative",s[5]<0),o&32&&te(e,"zero",s[5]==0)},d(s){s&&M(e)}}}function Qp(n){let e;return{c(){e=b("iconify-icon"),Xe(e,"icon","codicon:sparkle-filled"),Xe(e,"class","svelte-gx367h")},m(t,i){B(t,e,i)},p:se,d(t){t&&M(e)}}}function Xp(n){let e,t=`${n[1]} Bonus`,i;return{c(){e=b("span"),i=ie(t),m(e,"class","statName svelte-gx367h")},m(s,o){B(s,e,o),p(e,i)},p(s,o){o&2&&t!==(t=`${s[1]} Bonus`)&&Ee(i,t)},d(s){s&&M(e)}}}function Jp(n){let e,t,i,s,o,r,a;function l(h,g){return h[0]!="armor"?Kp:Yp}let c=l(n),u=c(n);function f(h,g){if(h[2])return Xp;if(h[4])return Qp}let d=f(n),_=d&&d(n);return{c(){e=b("div"),t=b("img"),s=T(),u.c(),o=T(),_&&_.c(),tt(t.src,i="stats/"+n[0]+".svg")||m(t,"src",i),m(t,"alt",n[1]),m(t,"class","svelte-gx367h"),m(e,"id",n[0]),m(e,"class","svelte-gx367h"),te(e,"hidden",n[5]==0)},m(h,g){B(h,e,g),p(e,t),p(e,s),u.m(e,null),p(e,o),_&&_.m(e,null),r||(a=[D(t,"mouseenter",n[9]),D(t,"mouseleave",n[10])],r=!0)},p(h,[g]){g&1&&!tt(t.src,i="stats/"+h[0]+".svg")&&m(t,"src",i),g&2&&m(t,"alt",h[1]),c===(c=l(h))&&u?u.p(h,g):(u.d(1),u=c(h),u&&(u.c(),u.m(e,o))),d===(d=f(h))&&_?_.p(h,g):(_&&_.d(1),_=d&&d(h),_&&(_.c(),_.m(e,null))),g&1&&m(e,"id",h[0]),g&32&&te(e,"hidden",h[5]==0)},i:se,o:se,d(h){h&&M(e),u.d(),_&&_.d(),r=!1,ge(a)}}}function Zp(n,e,t){let i,s,o,r;J(n,Tt,C=>t(6,s=C)),J(n,wn,C=>t(7,o=C)),J(n,ut,C=>t(8,r=C));let{codeName:a,formalName:l}=e,c,u,f=!1;const d=()=>t(2,c=!0),_=()=>t(2,c=!1),h=()=>t(3,u=!0),g=()=>t(3,u=!1),v=()=>t(3,u=!0),w=()=>t(3,u=!1);return n.$$set=C=>{"codeName"in C&&t(0,a=C.codeName),"formalName"in C&&t(1,l=C.formalName)},n.$$.update=()=>{if(n.$$.dirty&257&&t(5,i=r[a]),n.$$.dirty&193)for(let C in o)if(o[C]&&s.bonuses.find(y=>y.name==C).stats[a]!=0){t(4,f=!0);break}else t(4,f=!1)},[a,l,c,u,f,i,s,o,r,d,_,h,g,v,w]}class xp extends Ne{constructor(e){super(),Te(this,e,Zp,Jp,pe,{codeName:0,formalName:1})}}function Ur(n,e,t){const i=n.slice();return i[4]=e[t][0],i[5]=e[t][1],i[6]=e,i[7]=t,i}function Gr(n){let e,t,i,s;function o(l){n[1](l,n[4],n[6],n[7])}function r(l){n[2](l,n[5],n[6],n[7])}let a={};return n[4]!==void 0&&(a.codeName=n[4]),n[5]!==void 0&&(a.formalName=n[5]),e=new xp({props:a}),ne.push(()=>De(e,"codeName",o)),ne.push(()=>De(e,"formalName",r)),{c(){le(e.$$.fragment)},m(l,c){oe(e,l,c),s=!0},p(l,c){n=l;const u={};!t&&c&0&&(t=!0,u.codeName=n[4],Oe(()=>t=!1)),!i&&c&0&&(i=!0,u.formalName=n[5],Oe(()=>i=!1)),e.$set(u)},i(l){s||(L(e.$$.fragment,l),s=!0)},o(l){V(e.$$.fragment,l),s=!1},d(l){re(e,l)}}}function $p(n){let e,t,i,s,o=Ae(Object.entries(Pn)),r=[];for(let l=0;l<o.length;l+=1)r[l]=Gr(Ur(n,o,l));const a=l=>V(r[l],1,1,()=>{r[l]=null});return i=new ct({props:{text:"Show all stats"}}),i.$on("toggle",n[3]),{c(){e=b("div");for(let l=0;l<r.length;l+=1)r[l].c();t=T(),le(i.$$.fragment),m(e,"class","statBox svelte-lu37w6"),te(e,"showAll",n[0])},m(l,c){B(l,e,c);for(let u=0;u<r.length;u+=1)r[u]&&r[u].m(e,null);p(e,t),oe(i,e,null),s=!0},p(l,[c]){if(c&0){o=Ae(Object.entries(Pn));let u;for(u=0;u<o.length;u+=1){const f=Ur(l,o,u);r[u]?(r[u].p(f,c),L(r[u],1)):(r[u]=Gr(f),r[u].c(),L(r[u],1),r[u].m(e,t))}for(Pe(),u=o.length;u<r.length;u+=1)a(u);Me()}(!s||c&1)&&te(e,"showAll",l[0])},i(l){if(!s){for(let c=0;c<o.length;c+=1)L(r[c]);L(i.$$.fragment,l),s=!0}},o(l){r=r.filter(Boolean);for(let c=0;c<r.length;c+=1)V(r[c]);V(i.$$.fragment,l),s=!1},d(l){l&&M(e),_t(r,l),re(i)}}}function em(n,e,t){let i=!1;function s(a,l,c,u){c[u][0]=a}function o(a,l,c,u){c[u][1]=a}return[i,s,o,a=>t(0,i=a.detail)]}class tm extends Ne{constructor(e){super(),Te(this,e,em,$p,pe,{})}}function nm(n){let e,t,i,s,o,r,a,l,c,u;return{c(){e=b("div"),t=b("button"),t.textContent="-",i=T(),s=b("input"),o=T(),r=b("b"),r.textContent="%",a=T(),l=b("button"),l.textContent="+",m(t,"id","decrease"),m(t,"class","svelte-1d7zneu"),m(s,"type","number"),m(s,"placeholder","0"),m(s,"class","svelte-1d7zneu"),m(r,"class","svelte-1d7zneu"),m(l,"id","increase"),m(l,"class","svelte-1d7zneu"),m(e,"class","svelte-1d7zneu"),te(e,"non-percent",!n[1])},m(f,d){B(f,e,d),p(e,t),p(e,i),p(e,s),Dt(s,n[0]),p(e,o),p(e,r),p(e,a),p(e,l),c||(u=[D(t,"click",n[4]),D(s,"input",n[5]),D(s,"input",n[2]),D(l,"click",n[6])],c=!0)},p(f,[d]){d&1&&Hl(s.value)!==f[0]&&Dt(s,f[0])},i:se,o:se,d(f){f&&M(e),c=!1,ge(u)}}}function im(n,e,t){let{weaponName:i,value:s}=e,o=i!="Nature's Wrath Spellbook",r;o?(s=100,r=100):(s=4,r=4);function a(){s<0?t(0,s=0):s>r&&t(0,s=r),s%1!=0&&t(0,s=Math.floor(s))}const l=()=>{t(0,s--,s),a()};function c(){s=Hl(this.value),t(0,s)}const u=()=>{t(0,s++,s),a()};return n.$$set=f=>{"weaponName"in f&&t(3,i=f.weaponName),"value"in f&&t(0,s=f.value)},[s,o,a,i,l,c,u]}class sm extends Ne{constructor(e){super(),Te(this,e,im,nm,pe,{weaponName:3,value:0})}}function Vr(n,e,t){const i=n.slice();i[51]=e[t];const s=i[51].name.includes("Fantastic Beamstorm")?"~":"";i[22]=s;const o=i[51].name.includes("Charged");return i[52]=o,i}function om(n){let e,t,i=n[2].description+"",s,o;return{c(){e=b("span"),t=ie('"'),s=ie(i),o=ie('"'),m(e,"id","toolDesc"),m(e,"class","svelte-10wbsa")},m(r,a){B(r,e,a),p(e,t),p(e,s),p(e,o)},p(r,a){a[0]&4&&i!==(i=r[2].description+"")&&Ee(s,i)},d(r){r&&M(e)}}}function rm(n){let e,t,i,s=`${n[5]?"Type":n[3].name}:`,o,r,a=n[20],l,c,u,f,d,_=n[5]?"Return":"Expand",h,g,v,w,C=Kr(n),y=n[4]&&Qr(n);return{c(){e=b("button"),t=b("div"),i=b("span"),o=ie(s),r=T(),C.c(),c=T(),y&&y.c(),u=T(),f=b("span"),d=ie("("),h=ie(_),g=ie(")"),m(i,"class","svelte-10wbsa"),et(i,"font-size",Object.keys(n[21]).includes(n[3].name)?`calc(var(--u) * ${n[21][n[3].name]})`:""),m(t,"id",l=n[5]?"":"basic"),m(t,"class","svelte-10wbsa"),m(f,"class","tooltip svelte-10wbsa"),m(f,"id","top"),m(e,"class","gearPreview svelte-10wbsa"),et(e,"line-height",`${n[10]/6.5}px`)},m(k,E){B(k,e,E),p(e,t),p(t,i),p(i,o),p(t,r),C.m(t,null),p(e,c),y&&y.m(e,null),p(e,u),p(e,f),p(f,d),p(f,h),p(f,g),n[34](e),v||(w=D(e,"click",n[35]),v=!0)},p(k,E){E[0]&40&&s!==(s=`${k[5]?"Type":k[3].name}:`)&&Ee(o,s),E[0]&2097160&&et(i,"font-size",Object.keys(k[21]).includes(k[3].name)?`calc(var(--u) * ${k[21][k[3].name]})`:""),E[0]&1048576&&pe(a,a=k[20])?(C.d(1),C=Kr(k),C.c(),C.m(t,null)):C.p(k,E),E[0]&32&&l!==(l=k[5]?"":"basic")&&m(t,"id",l),k[4]?y?y.p(k,E):(y=Qr(k),y.c(),y.m(e,u)):y&&(y.d(1),y=null),E[0]&32&&_!==(_=k[5]?"Return":"Expand")&&Ee(h,_),E[0]&1024&&et(e,"line-height",`${k[10]/6.5}px`)},d(k){k&&M(e),C.d(k),y&&y.d(),n[34](null),v=!1,w()}}}function Yr(n){let e;return{c(){e=b("iconify-icon"),Xe(e,"icon","codicon:sparkle-filled"),Xe(e,"class","svelte-10wbsa")},m(t,i){B(t,e,i)},d(t){t&&M(e)}}}function Kr(n){let e,t,i=(n[5]?n[2].info.type.replace("/","<b>,</b><br/>"):n[24](n[3]))+"",s,o=!n[5]&&n[6].basic&&Yr();return{c(){e=b("span"),t=new nu(!1),s=T(),o&&o.c(),t.a=s,m(e,"class","svelte-10wbsa")},m(r,a){B(r,e,a),t.m(i,e),p(e,s),o&&o.m(e,null)},p(r,a){a[0]&44&&i!==(i=(r[5]?r[2].info.type.replace("/","<b>,</b><br/>"):r[24](r[3]))+"")&&t.p(i),!r[5]&&r[6].basic?o||(o=Yr(),o.c(),o.m(e,null)):o&&(o.d(1),o=null)},d(r){r&&M(e),o&&o.d()}}}function Qr(n){let e,t,i=`${n[5]?"Special":n[4].name.split(" (")[0]}:`,s,o,r=n[20],a,l=Zr(n);return{c(){e=b("div"),t=b("span"),s=ie(i),o=T(),l.c(),m(t,"class","svelte-10wbsa"),et(t,"font-size",Object.keys(n[21]).includes(n[4].name)?`calc(var(--u) * ${n[21][n[4].name]})`:""),m(e,"id",a=n[5]?"":"special"),m(e,"class","svelte-10wbsa")},m(c,u){B(c,e,u),p(e,t),p(t,s),p(e,o),l.m(e,null)},p(c,u){u[0]&48&&i!==(i=`${c[5]?"Special":c[4].name.split(" (")[0]}:`)&&Ee(s,i),u[0]&2097168&&et(t,"font-size",Object.keys(c[21]).includes(c[4].name)?`calc(var(--u) * ${c[21][c[4].name]})`:""),u[0]&1048576&&pe(r,r=c[20])?(l.d(1),l=Zr(c),l.c(),l.m(e,null)):l.p(c,u),u[0]&32&&a!==(a=c[5]?"":"special")&&m(e,"id",a)},d(c){c&&M(e),l.d(c)}}}function Xr(n){let e,t;return{c(){e=b("span"),t=ie(n[22]),m(e,"id","prefix"),m(e,"class","svelte-10wbsa")},m(i,s){B(i,e,s),p(e,t)},p(i,s){s[0]&4194304&&Ee(t,i[22])},d(i){i&&M(e)}}}function Jr(n){let e;return{c(){e=b("iconify-icon"),Xe(e,"icon","codicon:sparkle-filled"),Xe(e,"class","svelte-10wbsa")},m(t,i){B(t,e,i)},d(t){t&&M(e)}}}function Zr(n){let e,t,i=(n[5]?n[2].info.special:n[24](n[4]))+"",s,o,r=n[22]&&!n[5]&&Xr(n),a=!n[5]&&n[6].special&&Jr();return{c(){e=b("span"),r&&r.c(),t=T(),s=ie(i),o=T(),a&&a.c(),m(e,"class","svelte-10wbsa")},m(l,c){B(l,e,c),r&&r.m(e,null),p(e,t),p(e,s),p(e,o),a&&a.m(e,null)},p(l,c){l[22]&&!l[5]?r?r.p(l,c):(r=Xr(l),r.c(),r.m(e,t)):r&&(r.d(1),r=null),c[0]&52&&i!==(i=(l[5]?l[2].info.special:l[24](l[4]))+"")&&Ee(s,i),!l[5]&&l[6].special?a||(a=Jr(),a.c(),a.m(e,null)):a&&(a.d(1),a=null)},d(l){l&&M(e),r&&r.d(),a&&a.d()}}}function xr(n){let e,t,i,s,o,r,a=n[2].name+"",l,c,u,f,d;return{c(){e=b("a"),t=b("img"),o=T(),r=b("span"),l=ie(a),tt(t.src,i=n[2].image)||m(t,"src",i),m(t,"alt",s=n[2].name),m(t,"draggable","false"),m(t,"class","svelte-10wbsa"),m(r,"class","tooltip svelte-10wbsa"),m(r,"id",c=n[19].screenshot.ongoing?"right":"top"),m(e,"href",u=n[2].link),m(e,"target","_blank"),m(e,"class","svelte-10wbsa"),et(e,"display",n[2].link?"":"none"),et(e,"border-radius",n[2].tool?"calc(var(--u))":"")},m(_,h){B(_,e,h),p(e,t),p(e,o),p(e,r),p(r,l),d=!0},p(_,h){(!d||h[0]&4&&!tt(t.src,i=_[2].image))&&m(t,"src",i),(!d||h[0]&4&&s!==(s=_[2].name))&&m(t,"alt",s),(!d||h[0]&4)&&a!==(a=_[2].name+"")&&Ee(l,a),(!d||h[0]&524288&&c!==(c=_[19].screenshot.ongoing?"right":"top"))&&m(r,"id",c),(!d||h[0]&4&&u!==(u=_[2].link))&&m(e,"href",u),h[0]&4&&et(e,"display",_[2].link?"":"none"),h[0]&4&&et(e,"border-radius",_[2].tool?"calc(var(--u))":"")},i(_){d||(_&&ke(()=>{d&&(f||(f=Ce(e,Je,{duration:150},!0)),f.run(1))}),d=!0)},o(_){_&&(f||(f=Ce(e,Je,{duration:150},!1)),f.run(0)),d=!1},d(_){_&&M(e),_&&f&&f.end()}}}function $r(n){let e,t,i,s,o,r,a,l,c,u;i=new ct({props:{text:"Toggle base values",checked:n[16]}}),i.$on("toggle",n[44]),o=new ct({props:{text:"Eyeball of Reckoning buff",checked:n[17]}}),o.$on("toggle",n[45]);let f=Ae(n[2].moves),d=[];for(let h=0;h<f.length;h+=1)d[h]=il(Vr(n,f,h));const _=h=>V(d[h],1,1,()=>{d[h]=null});return{c(){e=b("div"),t=b("div"),le(i.$$.fragment),s=T(),le(o.$$.fragment),r=T(),a=b("div");for(let h=0;h<d.length;h+=1)d[h].c();m(t,"class","weaponToggles svelte-10wbsa"),m(a,"class","weaponMoves svelte-10wbsa"),m(e,"class","fullWeaponView svelte-10wbsa")},m(h,g){B(h,e,g),p(e,t),oe(i,t,null),p(t,s),oe(o,t,null),p(e,r),p(e,a);for(let v=0;v<d.length;v+=1)d[v]&&d[v].m(a,null);u=!0},p(h,g){const v={};g[0]&65536&&(v.checked=h[16]),i.$set(v);const w={};if(g[0]&131072&&(w.checked=h[17]),o.$set(w),g[0]&51839108){f=Ae(h[2].moves);let C;for(C=0;C<f.length;C+=1){const y=Vr(h,f,C);d[C]?(d[C].p(y,g),L(d[C],1)):(d[C]=il(y),d[C].c(),L(d[C],1),d[C].m(a,null))}for(Pe(),C=f.length;C<d.length;C+=1)_(C);Me()}},i(h){if(!u){L(i.$$.fragment,h),L(o.$$.fragment,h);for(let g=0;g<f.length;g+=1)L(d[g]);h&&ke(()=>{u&&(c&&c.end(1),l=Yl(e,Je,{duration:150,delay:300}),l.start())}),u=!0}},o(h){V(i.$$.fragment,h),V(o.$$.fragment,h),d=d.filter(Boolean);for(let g=0;g<d.length;g+=1)V(d[g]);l&&l.invalidate(),h&&(c=Kl(e,Je,{duration:150})),u=!1},d(h){h&&M(e),re(i),re(o),_t(d,h),h&&c&&c.end()}}}function el(n){let e,t,i,s;function o(l){n[46](l)}function r(l){n[47](l)}let a={};return n[7]!==void 0&&(a.value=n[7]),n[2].name!==void 0&&(a.weaponName=n[2].name),e=new sm({props:a}),ne.push(()=>De(e,"value",o)),ne.push(()=>De(e,"weaponName",r)),{c(){le(e.$$.fragment)},m(l,c){oe(e,l,c),s=!0},p(l,c){const u={};!t&&c[0]&128&&(t=!0,u.value=l[7],Oe(()=>t=!1)),!i&&c[0]&4&&(i=!0,u.weaponName=l[2].name,Oe(()=>i=!1)),e.$set(u)},i(l){s||(L(e.$$.fragment,l),s=!0)},o(l){V(e.$$.fragment,l),s=!1},d(l){re(e,l)}}}function tl(n){let e;return{c(){e=b("iconify-icon"),Xe(e,"icon","codicon:sparkle-filled"),Xe(e,"class","svelte-10wbsa")},m(t,i){B(t,e,i)},d(t){t&&M(e)}}}function nl(n){let e,t=n[22]+(n[16]&&!n[52]?n[51].base:n[52]?n[25](n[51]):n[24](n[51]))+"",i,s,o=n[18][n[51].name]&&!n[16]&&tl();return{c(){e=b("span"),i=ie(t),s=T(),o&&o.c(),m(e,"class","svelte-10wbsa")},m(r,a){B(r,e,a),p(e,i),p(e,s),o&&o.m(e,null)},p(r,a){a[0]&65540&&t!==(t=r[22]+(r[16]&&!r[52]?r[51].base:r[52]?r[25](r[51]):r[24](r[51]))+"")&&Ee(i,t),r[18][r[51].name]&&!r[16]?o||(o=tl(),o.c(),o.m(e,null)):o&&(o.d(1),o=null)},d(r){r&&M(e),o&&o.d()}}}function il(n){let e,t,i,s,o=(n[52]&&n[2].name=="Nature's Wrath Spellbook"?n[51].name.replace("Charged","Charge(s)"):n[51].name)+":",r,a,l=n[52]?[n[20],n[7],n[17]]:[n[20],n[17]],c,u,f=n[52]&&el(n),d=nl(n);return{c(){e=b("div"),t=b("div"),i=b("span"),f&&f.c(),s=T(),r=ie(o),a=T(),d.c(),c=T(),m(i,"class","svelte-10wbsa"),m(t,"class","ff-border svelte-10wbsa"),m(e,"class","svelte-10wbsa")},m(_,h){B(_,e,h),p(e,t),p(t,i),f&&f.m(i,null),p(i,s),p(i,r),p(t,a),d.m(t,null),p(e,c),u=!0},p(_,h){_[52]?f?(f.p(_,h),h[0]&4&&L(f,1)):(f=el(_),f.c(),L(f,1),f.m(i,s)):f&&(Pe(),V(f,1,1,()=>{f=null}),Me()),(!u||h[0]&4)&&o!==(o=(_[52]&&_[2].name=="Nature's Wrath Spellbook"?_[51].name.replace("Charged","Charge(s)"):_[51].name)+":")&&Ee(r,o),h[0]&1179780&&pe(l,l=_[52]?[_[20],_[7],_[17]]:[_[20],_[17]])?(d.d(1),d=nl(_),d.c(),d.m(t,null)):d.p(_,h)},i(_){u||(L(f),u=!0)},o(_){V(f),u=!1},d(_){_&&M(e),f&&f.d(),d.d(_)}}}function lm(n){let e,t,i,s,o="Gear"+(n[19].screenshot.ongoing?":":""),r,a,l,c,u,f=n[2],d,_,h,g,v,w,C,y,k,E,O,I;function A(F,P){if(F[2].name&&!F[2].tool)return rm;if(F[2].tool)return om}let G=A(n),W=G&&G(n),S=xr(n);function H(F){n[39](F)}function N(F){n[40](F)}function q(F){n[41](F)}let R={slotName:n[0],index:n[1]};n[14]!==void 0&&(R.slotOpen=n[14]),n[5]!==void 0&&(R.weaponExpand=n[5]),n[15]!==void 0&&(R.optionsOpen=n[15]),g=new Lo({props:R}),ne.push(()=>De(g,"slotOpen",H)),ne.push(()=>De(g,"weaponExpand",N)),ne.push(()=>De(g,"optionsOpen",q)),g.$on("itemSelect",n[42]),g.$on("toolSelect",n[26]);let U=n[5]&&$r(n);return{c(){e=b("div"),t=b("button"),i=b("iconify-icon"),s=T(),r=ie(o),a=T(),l=b("div"),W&&W.c(),c=T(),u=b("div"),S.c(),h=T(),le(g.$$.fragment),y=T(),U&&U.c(),k=bt(),Xe(i,"icon","iconamoon:arrow-down-2-fill"),Xe(i,"class","svelte-10wbsa"),m(t,"class","ddButton svelte-10wbsa"),m(u,"class","gearSlotIcon svelte-10wbsa"),ke(()=>n[36].call(u)),et(u,"min-width",`${n[11]}px`),m(l,"class","gearInfoCont ff-border svelte-10wbsa"),ke(()=>n[38].call(l)),et(l,"justify-content",n[2].name?"":"flex-end"),m(e,"class","gearSlot svelte-10wbsa"),te(e,"slotOpen",n[14]),te(e,"weapon-expand",n[5])},m(F,P){B(F,e,P),p(e,t),p(t,i),p(t,s),p(t,r),n[32](t),p(e,a),p(e,l),W&&W.m(l,null),p(l,c),p(l,u),S.m(u,null),d=Xt(u,n[36].bind(u)),n[37](l),_=Xt(l,n[38].bind(l)),p(e,h),oe(g,e,null),n[43](e),B(F,y,P),U&&U.m(F,P),B(F,k,P),E=!0,O||(I=[D(window,"mousedown",n[30]),D(window,"keydown",n[31]),D(t,"click",n[33])],O=!0)},p(F,P){(!E||P[0]&524288)&&o!==(o="Gear"+(F[19].screenshot.ongoing?":":""))&&Ee(r,o),G===(G=A(F))&&W?W.p(F,P):(W&&W.d(1),W=G&&G(F),W&&(W.c(),W.m(l,c))),P[0]&4&&pe(f,f=F[2])?(Pe(),V(S,1,1,se),Me(),S=xr(F),S.c(),L(S,1),S.m(u,null)):S.p(F,P),P[0]&2048&&et(u,"min-width",`${F[11]}px`),P[0]&4&&et(l,"justify-content",F[2].name?"":"flex-end");const ee={};P[0]&1&&(ee.slotName=F[0]),P[0]&2&&(ee.index=F[1]),!v&&P[0]&16384&&(v=!0,ee.slotOpen=F[14],Oe(()=>v=!1)),!w&&P[0]&32&&(w=!0,ee.weaponExpand=F[5],Oe(()=>w=!1)),!C&&P[0]&32768&&(C=!0,ee.optionsOpen=F[15],Oe(()=>C=!1)),g.$set(ee),(!E||P[0]&16384)&&te(e,"slotOpen",F[14]),(!E||P[0]&32)&&te(e,"weapon-expand",F[5]),F[5]?U?(U.p(F,P),P[0]&32&&L(U,1)):(U=$r(F),U.c(),L(U,1),U.m(k.parentNode,k)):U&&(Pe(),V(U,1,1,()=>{U=null}),Me())},i(F){E||(L(S),L(g.$$.fragment,F),L(U),E=!0)},o(F){V(S),V(g.$$.fragment,F),V(U),E=!1},d(F){F&&(M(e),M(y),M(k)),n[32](null),W&&W.d(),S.d(F),d(),n[37](null),_(),re(g),n[43](null),U&&U.d(F),O=!1,ge(I)}}}function am(n,e,t){let i,s,o,r,a,l,c;J(n,wn,z=>t(28,i=z)),J(n,At,z=>t(29,s=z)),J(n,Tt,z=>t(48,o=z)),J(n,$,z=>t(19,r=z)),J(n,ut,z=>t(20,a=z)),J(n,fs,z=>t(21,l=z)),J(n,In,z=>t(49,c=z));let{gearBox:u,slotName:f,index:d}=e,_,h,g,v,w,C,y,k=us,E,O,I,A,G,W=!1,S=!1,H="",N={basic:!1,special:!1},q={};function R(){if(y)for(let z of y.querySelectorAll(".gearPreview > div")){if(Object.keys(l).includes(z.id=="basic"?E.name:O?O.name:null))return;let Re=hp(z,c);Re&&(z.id=="basic"?X(fs,l[E.name]=Re,l):X(fs,l[O.name]=Re,l))}}function U(z){let Re;if(z.name=="Void Needle")Re=z.base+a[z.type]-a.armor*5.625;else if(k.name=="Pureblood Dagger"){let Ye,mt={magicDmg:a.magicDmg,meleeDmg:a.meleeDmg,rangedDmg:a.rangedDmg},ze=Object.keys(mt).reduce((me,rt)=>mt[me]>mt[rt]?me:rt),Q=0;for(let me in mt)me!=ze&&(Q+=mt[me]);Ye=a[ze]*2-Q,Re=z.base+(z.name.includes("HP")?Ye/2:Ye)}else if(z.type.includes("/")){let Ye=z.type.split("/"),mt=0;for(let ze of Ye)mt+=a[ze]*z[`${ze}Mult`];Re=z.base+mt}else Re=z.base+a[z.type]*z.mult;return S&&(!z.name.includes("HP")||z.name.includes("HP")&&k.name=="Pureblood Dagger")&&(Re+=Re*.08775),G?Math.floor(Re*10)/10:Math.floor(Re)}function F(z){let Re,Ye=W?0:a[z.type];return k.name=="Celestial Powers Spellbook"?Re=(80+Ye*1.1)*(.8+2.2*_/100):k.name=="Staff of Dreams"?Re=160+160*_/100+Ye*(.4+1.3*_/100):k.name=="Nature's Wrath Spellbook"&&(Re=260+400*_/4+Ye*(1+1.5*_/4)),S&&(Re+=Re*.08775),Math.floor(Re*10)/10}function P(){r.screenshot.ongoing||(t(16,W=!1),t(17,S=!1),G?(t(5,G=!1),u.classList.remove("weapon-expand"),setTimeout(R)):(u.classList.add("weapon-expand"),t(5,G=!0)))}function ee(z,Re){e:for(let Ye in i){let mt=o.bonuses.find(Q=>Q.name==Ye).stats,ze=z?z.type:null;for(let Q in Pn){if(ze===null)break e;if(k.name=="Void Spike Ultradagger"&&Re=="special"||z.name=="Void Needle"?ze="armor/meleeDmg":k.name=="Pureblood Dagger"?ze=Ye=="Fish of Rage"?"":"magicDmg/meleeDmg/rangedDmg":k.name=="Gnome Rocket Launcher"&&(ze=""),i[Ye]&&mt[Q]!=0&&ze.includes(Q)){t(18,q[z.name]=!0,q),Re&&t(6,N[Re]=!0,N);break e}else t(18,q[z.name]=!1,q),Re&&t(6,N[Re]=!1,N)}}}const he=z=>{(!h.contains(z.target)||h.contains(z.target)&&g.contains(z.target))&&(t(14,I=!1),t(15,A=!1))},de=z=>{z.key=="Escape"&&(t(14,I=!1),t(15,A=!1))};function _e(z){ne[z?"unshift":"push"](()=>{C=z,t(12,C)})}const j=()=>{r.screenshot.ongoing||t(14,I=!I)};function Z(z){ne[z?"unshift":"push"](()=>{y=z,t(13,y)})}const ae=z=>{Sn(z),P()};function je(){w=this.offsetHeight,t(11,w)}function Se(z){ne[z?"unshift":"push"](()=>{g=z,t(9,g)})}function Fe(){v=this.offsetHeight,t(10,v)}function Ge(z){I=z,t(14,I)}function Ke(z){G=z,t(5,G)}function Qe(z){A=z,t(15,A)}const Ue=()=>{setTimeout(()=>{R(),(!k.name||k.tool)&&G&&P(),t(15,A=!1)})};function fe(z){ne[z?"unshift":"push"](()=>{h=z,t(8,h)})}const K=z=>{t(16,W=z.detail),z.detail&&t(17,S=!1)},Y=z=>{t(17,S=z.detail),z.detail&&t(16,W=!1)};function ve(z){_=z,t(7,_)}function ce(z){n.$$.not_equal(k.name,z)&&(k.name=z,t(2,k),t(29,s),t(1,d),t(4,O))}return n.$$set=z=>{"gearBox"in z&&t(27,u=z.gearBox),"slotName"in z&&t(0,f=z.slotName),"index"in z&&t(1,d=z.index)},n.$$.update=()=>{if(n.$$.dirty[0]&536870934&&s[d]&&s[d].name!=k.name&&(t(2,k=s[d]),!k.tool&&k.name)){t(3,E=k.moves.filter(z=>z.basic)[0]),t(4,O=k.moves.filter(z=>z.special)[0]),t(18,q={});for(let z of k.moves)t(18,q[z.name]=!1,q),ee(z);O&&O.name.includes("Fantastic Beamstorm")?t(22,H="~"):t(22,H="")}if(n.$$.dirty[0]&268435580&&(i||G)&&!k.tool&&k.name){for(let z in N)ee(z=="basic"?E:O||null,z);for(let z of k.moves)ee(z)}},[f,d,k,E,O,G,N,_,h,g,v,w,C,y,I,A,W,S,q,r,a,l,H,R,U,F,P,u,i,s,he,de,_e,j,Z,ae,je,Se,Fe,Ge,Ke,Qe,Ue,fe,K,Y,ve,ce]}class cm extends Ne{constructor(e){super(),Te(this,e,am,lm,pe,{gearBox:27,slotName:0,index:1},null,[-1,-1])}}function sl(n,e,t){const i=n.slice();return i[3]=e[t],i}function ol(n){let e,t,i;function s(r){n[1](r)}let o={slotName:"gear",index:n[3]};return n[0]!==void 0&&(o.gearBox=n[0]),e=new cm({props:o}),ne.push(()=>De(e,"gearBox",s)),{c(){le(e.$$.fragment)},m(r,a){oe(e,r,a),i=!0},p(r,a){const l={};!t&&a&1&&(t=!0,l.gearBox=r[0],Oe(()=>t=!1)),e.$set(l)},i(r){i||(L(e.$$.fragment,r),i=!0)},o(r){V(e.$$.fragment,r),i=!1},d(r){re(e,r)}}}function um(n){let e,t,i=Ae(Qt),s=[];for(let r=0;r<i.length;r+=1)s[r]=ol(sl(n,i,r));const o=r=>V(s[r],1,1,()=>{s[r]=null});return{c(){e=b("div");for(let r=0;r<s.length;r+=1)s[r].c();m(e,"class","gearBox svelte-1lv6xba")},m(r,a){B(r,e,a);for(let l=0;l<s.length;l+=1)s[l]&&s[l].m(e,null);n[2](e),t=!0},p(r,[a]){if(a&1){i=Ae(Qt);let l;for(l=0;l<i.length;l+=1){const c=sl(r,i,l);s[l]?(s[l].p(c,a),L(s[l],1)):(s[l]=ol(c),s[l].c(),L(s[l],1),s[l].m(e,null))}for(Pe(),l=i.length;l<s.length;l+=1)o(l);Me()}},i(r){if(!t){for(let a=0;a<i.length;a+=1)L(s[a]);t=!0}},o(r){s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)V(s[a]);t=!1},d(r){r&&M(e),_t(s,r),n[2](null)}}}function dm(n,e,t){let i;function s(r){i=r,t(0,i)}function o(r){ne[r?"unshift":"push"](()=>{i=r,t(0,i)})}return[i,s,o]}class fm extends Ne{constructor(e){super(),Te(this,e,dm,um,pe,{})}}function hm(n){let e,t,i,s,o,r,a,l;return{c(){e=b("div"),t=b("div"),i=b("button"),i.textContent="Clear armor",s=T(),o=b("div"),r=b("button"),r.textContent="Clear gear",m(i,"class","svelte-e94uvj"),m(t,"class","buttonCont svelte-e94uvj"),m(r,"class","svelte-e94uvj"),m(o,"class","buttonCont svelte-e94uvj"),m(e,"class","mainFeatures svelte-e94uvj"),m(e,"id","box")},m(c,u){B(c,e,u),p(e,t),p(t,i),p(e,s),p(e,o),p(o,r),a||(l=[D(i,"click",n[3]),D(r,"click",n[4])],a=!0)},p:se,i:se,o:se,d(c){c&&M(e),a=!1,ge(l)}}}function _m(n,e,t){let i,s,o,r,a;J(n,At,d=>t(5,i=d)),J(n,Nn,d=>t(6,s=d)),J(n,Nt,d=>t(7,o=d)),J(n,Tn,d=>t(8,r=d)),J(n,In,d=>t(0,a=d));function l(){for(let d in o)o[d].name&&r[d][o[d].name].querySelector("button").click()}function c(){for(let d in i)i[d].name&&s[d][i[d].name].querySelector("button").click()}return[a,l,c,d=>{d.target.blur(),a||l()},d=>{d.target.blur(),a||c()}]}class pm extends Ne{constructor(e){super(),Te(this,e,_m,hm,pe,{})}}function rl(n){let e,t,i;function s(r){n[3](r)}let o={slotName:"sets"};return n[0]!==void 0&&(o.slotOpen=n[0]),e=new Lo({props:o}),ne.push(()=>De(e,"slotOpen",s)),{c(){le(e.$$.fragment)},m(r,a){oe(e,r,a),i=!0},p(r,a){const l={};!t&&a&1&&(t=!0,l.slotOpen=r[0],Oe(()=>t=!1)),e.$set(l)},i(r){i||(L(e.$$.fragment,r),i=!0)},o(r){V(e.$$.fragment,r),i=!1},d(r){re(e,r)}}}function mm(n){let e,t,i,s,o,r,a=n[1].head&&n[1].body&&n[1].legs&&n[1].feet&&rl(n);return{c(){e=b("button"),e.innerHTML=`Load armor set
    <iconify-icon icon="iconamoon:arrow-down-2-fill" rotate="180deg" class="svelte-l9dczq"></iconify-icon>`,t=T(),a&&a.c(),i=bt(),m(e,"class","svelte-l9dczq"),te(e,"ddOpen",n[0])},m(l,c){B(l,e,c),B(l,t,c),a&&a.m(l,c),B(l,i,c),s=!0,o||(r=D(e,"click",n[2]),o=!0)},p(l,[c]){(!s||c&1)&&te(e,"ddOpen",l[0]),l[1].head&&l[1].body&&l[1].legs&&l[1].feet?a?(a.p(l,c),c&2&&L(a,1)):(a=rl(l),a.c(),L(a,1),a.m(i.parentNode,i)):a&&(Pe(),V(a,1,1,()=>{a=null}),Me())},i(l){s||(L(a),s=!0)},o(l){V(a),s=!1},d(l){l&&(M(e),M(t),M(i)),a&&a.d(l),o=!1,r()}}}function gm(n,e,t){let i;J(n,Tt,a=>t(1,i=a));let{ddOpen:s=!1}=e;const o=()=>t(0,s=!s);function r(a){s=a,t(0,s)}return n.$$set=a=>{"ddOpen"in a&&t(0,s=a.ddOpen)},[s,i,o,r]}class bm extends Ne{constructor(e){super(),Te(this,e,gm,mm,pe,{ddOpen:0})}}function vm(n){let e;return{c(){e=b("span"),e.textContent="Create some builds to get started!",m(e,"class","tooltip svelte-lhwdnk"),m(e,"id","top"),et(e,"left","70.5%")},m(t,i){B(t,e,i)},p:se,d(t){t&&M(e)}}}function ym(n){let e;return{c(){e=b("span"),e.textContent="Select some gear or armor to get started!",m(e,"class","tooltip svelte-lhwdnk"),m(e,"id","top"),et(e,"left",n[3]?"38%":"")},m(t,i){B(t,e,i)},p(t,i){i&8&&et(e,"left",t[3]?"38%":"")},d(t){t&&M(e)}}}function wm(n){let e,t,i,s,o,r,a,l,c,u,f,d,_,h,g,v,w,C,y,k,E,O,I,A,G,W,S,H;function N(P,ee){if(!P[4])return ym;if(!P[3])return vm}let q=N(n),R=q&&q(n);function U(P){n[18](P)}let F={};return n[1]!==void 0&&(F.ddOpen=n[1]),A=new bm({props:F}),ne.push(()=>De(A,"ddOpen",U)),{c(){e=b("div"),t=b("div"),i=b("div"),s=b("button"),o=ie("Export new build"),a=T(),l=b("div"),c=b("button"),u=ie("Save to build"),d=T(),_=b("div"),h=b("button"),g=ie("Delete build"),w=T(),R&&R.c(),C=T(),y=b("div"),k=b("div"),E=b("button"),E.textContent="Load build",O=T(),I=b("div"),le(A.$$.fragment),s.disabled=r=!n[4],m(s,"class","svelte-lhwdnk"),m(i,"class","buttonCont svelte-lhwdnk"),c.disabled=f=!n[4]||!n[3],m(c,"class","svelte-lhwdnk"),m(l,"class","buttonCont svelte-lhwdnk"),m(l,"id","middle"),h.disabled=v=!n[3],m(h,"class","svelte-lhwdnk"),m(_,"class","buttonCont svelte-lhwdnk"),m(t,"id","modify"),m(t,"class","svelte-lhwdnk"),te(t,"no-tooltip",n[2]),m(E,"class","svelte-lhwdnk"),m(k,"class","buttonCont svelte-lhwdnk"),m(I,"class","buttonCont svelte-lhwdnk"),m(y,"id","load"),m(y,"class","svelte-lhwdnk"),m(e,"class","mainFeatures svelte-lhwdnk"),m(e,"id","build")},m(P,ee){B(P,e,ee),p(e,t),p(t,i),p(i,s),p(s,o),p(t,a),p(t,l),p(l,c),p(c,u),p(t,d),p(t,_),p(_,h),p(h,g),p(t,w),R&&R.m(t,null),p(e,C),p(e,y),p(y,k),p(k,E),p(y,O),p(y,I),oe(A,I,null),n[19](I),W=!0,S||(H=[D(window,"mousedown",n[8]),D(window,"keydown",n[9]),D(s,"click",n[10]),D(s,"mouseenter",n[11]),D(s,"mouseleave",n[12]),D(c,"click",n[13]),D(h,"click",n[14]),D(h,"mouseenter",n[15]),D(h,"mouseleave",n[16]),D(E,"click",n[17])],S=!0)},p(P,[ee]){(!W||ee&16&&r!==(r=!P[4]))&&(s.disabled=r),(!W||ee&24&&f!==(f=!P[4]||!P[3]))&&(c.disabled=f),(!W||ee&8&&v!==(v=!P[3]))&&(h.disabled=v),q===(q=N(P))&&R?R.p(P,ee):(R&&R.d(1),R=q&&q(P),R&&(R.c(),R.m(t,null))),(!W||ee&4)&&te(t,"no-tooltip",P[2]);const he={};!G&&ee&2&&(G=!0,he.ddOpen=P[1],Oe(()=>G=!1)),A.$set(he)},i(P){W||(L(A.$$.fragment,P),W=!0)},o(P){V(A.$$.fragment,P),W=!1},d(P){P&&M(e),R&&R.d(),re(A),n[19](null),S=!1,ge(H)}}}function Cm(n,e,t){let i,s,o,r,a;J(n,wt,I=>t(7,i=I)),J(n,Ht,I=>t(3,s=I)),J(n,xs,I=>t(4,o=I)),J(n,In,I=>t(5,r=I)),J(n,$,I=>t(6,a=I));let l,c=!1,u=!1;const f=I=>{l.contains(I.target)||t(1,c=!1)},d=I=>{I.key=="Escape"&&t(1,c=!1)},_=()=>{o&&!r&&X($,a.export.ongoing=!0,a)},h=()=>t(2,u=!0),g=()=>t(2,u=!1),v=()=>{o&&s&&!r&&X($,a.save.ongoing=!0,a)},w=()=>{s&&!r&&X($,a.delete.ongoing=!0,a)},C=()=>t(2,u=!0),y=()=>t(2,u=!1),k=()=>{r||X($,a.load.ongoing=!0,a)};function E(I){c=I,t(1,c)}function O(I){ne[I?"unshift":"push"](()=>{l=I,t(0,l)})}return n.$$.update=()=>{n.$$.dirty&128&&X(Ht,s=Object.keys(i).length>0,s)},[l,c,u,s,o,r,a,i,f,d,_,h,g,v,w,C,y,k,E,O]}class km extends Ne{constructor(e){super(),Te(this,e,Cm,wm,pe,{})}}function ll(n){let e;return{c(){e=b("span"),e.textContent="New changes! Exiting will erase them.",m(e,"id","alert")},m(t,i){B(t,e,i)},d(t){t&&M(e)}}}function Em(n){let e,t,i,s,o,r,a,l=25-n[3].length+"",c,u,f,d,_,h,g,v,w,C,y,k=275-n[4].length+"",E,O,I,A,G,W,S,H,N,q,R,U,F,P,ee,he,de=(n[3]||n[4])&&ll();return{c(){e=b("div"),t=b("div"),i=ie(`Name:\r
        `),s=b("input"),r=T(),a=b("span"),c=ie(l),u=T(),f=b("div"),d=b("div"),_=b("span"),_.textContent="Description / Notes:",h=T(),de&&de.c(),g=T(),v=b("textarea"),C=T(),y=b("span"),E=ie(k),O=T(),I=b("div"),A=b("div"),G=b("button"),W=ie("CANCEL"),H=T(),N=b("div"),q=b("button"),R=ie("EXPORT"),m(s,"class","buildNameInput"),m(s,"id","firstFocusable"),s.disabled=o=n[5].export.status==0,m(s,"type","text"),m(s,"placeholder",n[6]),m(s,"maxlength","25"),m(a,"class","charCounter svelte-1vypdkl"),m(a,"id","buildName"),m(t,"class","buildNameCont svelte-1vypdkl"),m(v,"class","buildDescInput"),v.disabled=w=n[5].export.status==0,m(v,"placeholder","[Empty]"),m(v,"maxlength","275"),m(v,"autocomplete","off"),m(y,"class","charCounter"),m(y,"id","buildDesc"),m(f,"class","buildDescCont"),G.disabled=S=n[5].export.status==0,m(q,"id","lastFocusable"),q.disabled=U=n[5].export.status==0,m(I,"class","promptOptions"),m(e,"class","buildExporter svelte-1vypdkl")},m(_e,j){B(_e,e,j),p(e,t),p(t,i),p(t,s),n[8](s),Dt(s,n[3]),p(t,r),p(t,a),p(a,c),p(e,u),p(e,f),p(f,d),p(d,_),p(d,h),de&&de.m(d,null),p(f,g),p(f,v),Dt(v,n[4]),n[13](v),p(f,C),p(f,y),p(y,E),p(e,O),p(e,I),p(I,A),p(A,G),p(G,W),n[16](G),p(I,H),p(I,N),p(N,q),p(q,R),P=!0,ee||(he=[D(s,"input",n[9]),D(s,"input",n[10]),D(s,"keydown",n[11]),D(v,"input",n[12]),D(v,"input",n[14]),D(v,"keydown",n[15]),D(G,"click",n[17]),D(q,"click",n[18]),D(q,"keydown",yt),D(e,"introstart",n[19])],ee=!0)},p(_e,[j]){(!P||j&32&&o!==(o=_e[5].export.status==0))&&(s.disabled=o),j&8&&s.value!==_e[3]&&Dt(s,_e[3]),(!P||j&8)&&l!==(l=25-_e[3].length+"")&&Ee(c,l),_e[3]||_e[4]?de||(de=ll(),de.c(),de.m(d,null)):de&&(de.d(1),de=null),(!P||j&32&&w!==(w=_e[5].export.status==0))&&(v.disabled=w),j&16&&Dt(v,_e[4]),(!P||j&16)&&k!==(k=275-_e[4].length+"")&&Ee(E,k),(!P||j&32&&S!==(S=_e[5].export.status==0))&&(G.disabled=S),(!P||j&32&&U!==(U=_e[5].export.status==0))&&(q.disabled=U)},i(_e){P||(_e&&ke(()=>{P&&(F||(F=Ce(e,Ze,{duration:250},!0)),F.run(1))}),P=!0)},o(_e){_e&&(F||(F=Ce(e,Ze,{duration:250},!1)),F.run(0)),P=!1},d(_e){_e&&M(e),n[8](null),de&&de.d(),n[13](null),n[16](null),_e&&F&&F.end(),ee=!1,ge(he)}}}function Sm(n,e,t){let i,s,o,r,a,l;J(n,$,N=>t(5,i=N)),J(n,dt,N=>t(20,s=N)),J(n,Ht,N=>t(21,o=N)),J(n,At,N=>t(22,r=N)),J(n,Nt,N=>t(23,a=N)),J(n,wt,N=>t(24,l=N));let c=Object.keys(l).length,u,f,d,_="",h="",g=`My ${c+1+Bc[(c+1)%10]} build`;function v(){if(X($,i.export.status=0,i),_.endsWith(" ")&&t(3,_=_.replace(/  +/g," ").replace(/ $/,"")),h.endsWith(" ")&&t(4,h=h.replace(/  +/g," ").replace(/ $/,"")),Object.keys(l).includes(_)){X($,i.export.status=-1,i),X($,i.message="duplicate_name",i);return}let N=V_(jt(An(Mn),"builds")).key,q=zc(a,r);q.name=_||g,q.desc=h||"[Empty]",os(jt(An(Mn),`builds/${N}`),q).then(()=>{X($,i.export.status=1,i),X(Ht,o=!0,o),Mo(),wt.update(R=>({...R,[q.name]:{id:N,desc:q.desc}})),X(dt,s=q,s),X(dt,s.id=N,s),navigator.clipboard.writeText(`${location.origin+location.pathname}?id=${N}`)}).catch(()=>{X($,i.export.status=-1,i),X($,i.message="firebase_fail",i)})}function w(N){ne[N?"unshift":"push"](()=>{u=N,t(0,u)})}function C(){_=this.value,t(3,_)}const y=N=>{t(3,_=Vi(N.target.value,25))},k=N=>{i.export.status==0&&N.preventDefault(),vt(N),Vs(u,N.target.value,25)};function E(){h=this.value,t(4,h)}function O(N){ne[N?"unshift":"push"](()=>{f=N,t(1,f)})}const I=N=>{t(4,h=Vi(N.target.value,275))},A=N=>{i.export.status==0&&N.preventDefault(),Vs(f,N.target.value,275)};function G(N){ne[N?"unshift":"push"](()=>{d=N,t(2,d)})}return[u,f,d,_,h,i,g,v,w,C,y,k,E,O,I,A,G,()=>{i.export.status!=0&&X($,i.export.ongoing=!1,i)},()=>{i.export.status!=0&&v()},()=>d.focus()]}class Im extends Ne{constructor(e){super(),Te(this,e,Sm,Em,pe,{})}}function Tm(n){let e,t,i,s,o=n[2]?"Copied!":"Copy link",r,a,l;return{c(){e=b("button"),t=b("b"),t.textContent="Build link",i=T(),s=b("span"),r=ie(o),m(s,"class","tooltip"),m(s,"id","top"),m(e,"class","copyButton svelte-1e8zrsj"),m(e,"id","firstFocusable")},m(c,u){B(c,e,u),p(e,t),p(e,i),p(e,s),p(s,r),a||(l=[D(e,"click",n[7]),D(e,"keydown",vt)],a=!0)},p(c,u){u&4&&o!==(o=c[2]?"Copied!":"Copy link")&&Ee(r,o)},d(c){c&&M(e),a=!1,ge(l)}}}function Nm(n){let e,t,i,s,o,r,a=n[2]?"Copied!":"Copy ID",l,c,u,f;return{c(){e=b("button"),t=b("b"),t.textContent="ID:",i=T(),s=ie(n[4]),o=T(),r=b("span"),l=ie(a),m(r,"class","tooltip"),m(r,"id","top"),m(e,"class","copyButton svelte-1e8zrsj"),m(e,"id",c=n[1]!="save"?"firstFocusable":"")},m(d,_){B(d,e,_),p(e,t),p(e,i),p(e,s),p(e,o),p(e,r),p(r,l),u||(f=[D(e,"click",n[5]),D(e,"keydown",n[6])],u=!0)},p(d,_){_&4&&a!==(a=d[2]?"Copied!":"Copy ID")&&Ee(l,a),_&2&&c!==(c=d[1]!="save"?"firstFocusable":"")&&m(e,"id",c)},d(d){d&&M(e),u=!1,ge(f)}}}function Om(n){let e;function t(o,r){if(o[0]=="id")return Nm;if(o[0]=="link")return Tm}let i=t(n),s=i&&i(n);return{c(){s&&s.c(),e=bt()},m(o,r){s&&s.m(o,r),B(o,e,r)},p(o,[r]){i===(i=t(o))&&s?s.p(o,r):(s&&s.d(1),s=i&&i(o),s&&(s.c(),s.m(e.parentNode,e)))},i:se,o:se,d(o){o&&M(e),s&&s.d(o)}}}function Dm(n,e,t){let i;J(n,dt,d=>t(8,i=d));let{type:s,source:o}=e,r=!1;function a(d){r||(navigator.clipboard.writeText(d),t(2,r=!0),setTimeout(()=>{t(2,r=!1)},1e3))}let l=i?i.id:null;const c=()=>a(l),u=()=>{o!="save"&&vt()},f=()=>a(`${location.origin+location.pathname}?id=${l}`);return n.$$set=d=>{"type"in d&&t(0,s=d.type),"source"in d&&t(1,o=d.source)},[s,o,r,a,l,c,u,f]}class di extends Ne{constructor(e){super(),Te(this,e,Dm,Om,pe,{type:0,source:1})}}function Rm(n){let e,t,i,s;return e=new di({props:{type:"link",source:"share"}}),i=new di({props:{type:"id",source:"share"}}),{c(){le(e.$$.fragment),t=T(),le(i.$$.fragment)},m(o,r){oe(e,o,r),B(o,t,r),oe(i,o,r),s=!0},p:se,i(o){s||(L(e.$$.fragment,o),L(i.$$.fragment,o),s=!0)},o(o){V(e.$$.fragment,o),V(i.$$.fragment,o),s=!1},d(o){o&&M(t),re(e,o),re(i,o)}}}function Am(n){let e;return{c(){e=b("span"),e.textContent="Your build has been erased from your local saves and the database."},m(t,i){B(t,e,i)},p:se,i:se,o:se,d(t){t&&M(e)}}}function Pm(n){let e;function t(o,r){if(o[2].message=="not_found")return qm;if(o[2].message=="invalid_id")return Bm}let i=t(n),s=i&&i(n);return{c(){s&&s.c(),e=bt()},m(o,r){s&&s.m(o,r),B(o,e,r)},p(o,r){i!==(i=t(o))&&(s&&s.d(1),s=i&&i(o),s&&(s.c(),s.m(e.parentNode,e)))},i:se,o:se,d(o){o&&M(e),s&&s.d(o)}}}function Mm(n){let e,t,i,s,o,r;return i=new di({props:{type:"link",source:"save"}}),o=new di({props:{type:"id",source:"save"}}),{c(){e=b("span"),e.textContent="Your build has been overwritten.",t=T(),le(i.$$.fragment),s=T(),le(o.$$.fragment)},m(a,l){B(a,e,l),B(a,t,l),oe(i,a,l),B(a,s,l),oe(o,a,l),r=!0},p:se,i(a){r||(L(i.$$.fragment,a),L(o.$$.fragment,a),r=!0)},o(a){V(i.$$.fragment,a),V(o.$$.fragment,a),r=!1},d(a){a&&(M(e),M(t),M(s)),re(i,a),re(o,a)}}}function Lm(n){let e,t,i,s;const o=[zm,jm],r=[];function a(l,c){return l[2].export.status==1?0:l[2].export.status==-1&&l[2].message=="duplicate_name"?1:-1}return~(e=a(n))&&(t=r[e]=o[e](n)),{c(){t&&t.c(),i=bt()},m(l,c){~e&&r[e].m(l,c),B(l,i,c),s=!0},p(l,c){let u=e;e=a(l),e!==u&&(t&&(Pe(),V(r[u],1,1,()=>{r[u]=null}),Me()),~e?(t=r[e],t||(t=r[e]=o[e](l),t.c()),L(t,1),t.m(i.parentNode,i)):t=null)},i(l){s||(L(t),s=!0)},o(l){V(t),s=!1},d(l){l&&M(i),~e&&r[e].d(l)}}}function Fm(n){let e,t,i=n[2].export.status?"exporting":n[2].save.status?"saving":n[2].load.status?"loading":"deleting",s,o,r,a,l,c,u,f;return{c(){e=b("span"),t=ie("A problem occurred while "),s=ie(i),o=ie(` your build.\r
            `),r=b("br"),a=ie(`\r
            If needed`),l=b("b"),l.textContent=",",c=ie(" you may contact "),u=b("hl"),u.textContent="xt.ss",f=ie(` on Discord for more\r
            details.`)},m(d,_){B(d,e,_),p(e,t),p(e,s),p(e,o),p(e,r),p(e,a),p(e,l),p(e,c),p(e,u),p(e,f)},p(d,_){_&4&&i!==(i=d[2].export.status?"exporting":d[2].save.status?"saving":d[2].load.status?"loading":"deleting")&&Ee(s,i)},i:se,o:se,d(d){d&&M(e)}}}function Bm(n){let e;return{c(){e=b("span"),e.textContent="The ID you have entered is invalid. Please check it again."},m(t,i){B(t,e,i)},d(t){t&&M(e)}}}function qm(n){let e;return{c(){e=b("span"),e.innerHTML=`Your build could not be found within the database.
                <br/>
                If needed<b>,</b> you may contact <hl>xt.ss</hl> on Discord for more
                details.`},m(t,i){B(t,e,i)},d(t){t&&M(e)}}}function jm(n){let e;return{c(){e=b("span"),e.innerHTML=`Another build of yours with the same name already exists.
                <br/>
                Please use a different one.`},m(t,i){B(t,e,i)},i:se,o:se,d(t){t&&M(e)}}}function zm(n){let e,t,i,s;return i=new di({props:{type:"id",source:"export"}}),{c(){e=b("span"),e.textContent="Your build's link has been copied to your clipboard.",t=T(),le(i.$$.fragment)},m(o,r){B(o,e,r),B(o,t,r),oe(i,o,r),s=!0},i(o){s||(L(i.$$.fragment,o),s=!0)},o(o){V(i.$$.fragment,o),s=!1},d(o){o&&(M(e),M(t)),re(i,o)}}}function Wm(n){let e,t,i,s,o,r,a,l,c,u,f,d,_,h,g,v,w;const C=[Fm,Lm,Mm,Pm,Am,Rm],y=[];function k(E,O){return E[1]==-1&&E[2].message=="firebase_fail"?0:E[2].export.status?1:E[2].save.status==1?2:E[2].load.status==-1?3:E[2].delete.status==1?4:E[2].share.ongoing?5:-1}return~(o=k(n))&&(r=y[o]=C[o](n)),{c(){e=b("div"),t=b("span"),i=ie(n[4]),s=T(),r&&r.c(),a=T(),l=b("div"),c=b("div"),u=b("button"),f=ie("OK"),m(t,"id","messageTitle"),m(t,"class","svelte-nfbx2w"),m(u,"id",d=(n[1]==-1?"firstFocusable ":"")+"lastFocusable"),m(l,"class","promptOptions svelte-nfbx2w"),m(e,"class","promptMessage svelte-nfbx2w")},m(E,O){B(E,e,O),p(e,t),p(t,i),p(e,s),~o&&y[o].m(e,null),p(e,a),p(e,l),p(l,c),p(c,u),p(u,f),n[6](u),g=!0,v||(w=[D(u,"click",n[7]),D(u,"keydown",n[8]),D(e,"introstart",n[9])],v=!0)},p(E,[O]){(!g||O&16)&&Ee(i,E[4]);let I=o;o=k(E),o===I?~o&&y[o].p(E,O):(r&&(Pe(),V(y[I],1,1,()=>{y[I]=null}),Me()),~o?(r=y[o],r?r.p(E,O):(r=y[o]=C[o](E),r.c()),L(r,1),r.m(e,a)):r=null),(!g||O&2&&d!==(d=(E[1]==-1?"firstFocusable ":"")+"lastFocusable"))&&m(u,"id",d)},i(E){g||(L(r),E&&ke(()=>{g&&(h&&h.end(1),_=Yl(e,Ze,{duration:200,delay:75}),_.start())}),g=!0)},o(E){V(r),_&&_.invalidate(),E&&(h=Kl(e,Ze,{duration:200})),g=!1},d(E){E&&M(e),~o&&y[o].d(),n[6](null),E&&h&&h.end(),v=!1,ge(w)}}}function Hm(n,e,t){let i,s,o;J(n,$,_=>t(2,o=_));let{loadID:r}=e;const a=Mt();let l;function c(_){ne[_?"unshift":"push"](()=>{l=_,t(3,l)})}const u=()=>{t(0,r=null),a("resetActions")},f=_=>{s==-1&&vt(_),yt(_)},d=()=>l.focus();return n.$$set=_=>{"loadID"in _&&t(0,r=_.loadID)},n.$$.update=()=>{n.$$.dirty&4&&t(1,s=o.export.status||o.save.status||o.load.status||o.delete.status),n.$$.dirty&6&&t(4,i=o.share.ongoing?"Share this build":`${o.export.status?"Export":o.save.status?"Save":o.load.status?"Load":"Delete"} ${s==1?"Success":"Failure"}!`)},[r,s,o,l,i,a,c,u,f,d]}class Um extends Ne{constructor(e){super(),Te(this,e,Hm,Wm,pe,{loadID:0})}}function Gm(n){let e,t,i,s,o,r;return{c(){e=b("li"),t=b("button"),i=b("span"),s=ie(n[0]),m(i,"class","svelte-1opo0ke"),m(e,"class","svelte-1opo0ke"),te(e,"selectedItem",n[2])},m(a,l){B(a,e,l),p(e,t),p(t,i),p(i,s),n[7](e),o||(r=D(t,"click",n[3]),o=!0)},p(a,[l]){l&1&&Ee(s,a[0]),l&4&&te(e,"selectedItem",a[2])},i:se,o:se,d(a){a&&M(e),n[7](null),o=!1,r()}}}function Vm(n,e,t){let{chosenBuild:i,buildData:s,buildName:o,ddOpen:r}=e;const a=Mt();let l,c=i[0]==o;function u(){if(r){if(l.classList.contains("selectedItem")||t(2,c=!1),c)return;a("buildSelect",l),t(2,c=!0),t(5,r=!1),t(4,i=[o,s])}}function f(d){ne[d?"unshift":"push"](()=>{l=d,t(1,l)})}return n.$$set=d=>{"chosenBuild"in d&&t(4,i=d.chosenBuild),"buildData"in d&&t(6,s=d.buildData),"buildName"in d&&t(0,o=d.buildName),"ddOpen"in d&&t(5,r=d.ddOpen)},[o,l,c,u,i,r,s,f]}class Ym extends Ne{constructor(e){super(),Te(this,e,Vm,Gm,pe,{chosenBuild:4,buildData:6,buildName:0,ddOpen:5})}}function al(n,e,t){const i=n.slice();return i[25]=e[t][0],i[26]=e[t][1],i}function cl(n){let e,t,i,s;function o(l){n[13](l)}function r(l){n[14](l)}let a={buildData:n[26],buildName:n[25]};return n[0]!==void 0&&(a.chosenBuild=n[0]),n[1]!==void 0&&(a.ddOpen=n[1]),e=new Ym({props:a}),ne.push(()=>De(e,"chosenBuild",o)),ne.push(()=>De(e,"ddOpen",r)),e.$on("buildSelect",n[11]),{c(){le(e.$$.fragment)},m(l,c){oe(e,l,c),s=!0},p(l,c){const u={};c&16&&(u.buildData=l[26]),c&16&&(u.buildName=l[25]),!t&&c&1&&(t=!0,u.chosenBuild=l[0],Oe(()=>t=!1)),!i&&c&2&&(i=!0,u.ddOpen=l[1],Oe(()=>i=!1)),e.$set(u)},i(l){s||(L(e.$$.fragment,l),s=!0)},o(l){V(e.$$.fragment,l),s=!1},d(l){re(e,l)}}}function Km(n){let e,t,i,s,o,r,a,l=Ae(Object.entries(n[4])),c=[];for(let f=0;f<l.length;f+=1)c[f]=cl(al(n,l,f));const u=f=>V(c[f],1,1,()=>{c[f]=null});return{c(){e=b("div"),t=b("input"),i=T(),s=b("ul");for(let f=0;f<c.length;f+=1)c[f].c();m(t,"type","text"),m(t,"class","searchBarInput svelte-p20blu"),m(t,"placeholder","Search..."),m(s,"class","svelte-p20blu"),te(s,"no-scrollbar",n[8].length<=4),m(e,"class","dropdown svelte-p20blu"),te(e,"ddOpen",n[1])},m(f,d){B(f,e,d),p(e,t),n[12](t),p(e,i),p(e,s);for(let _=0;_<c.length;_+=1)c[_]&&c[_].m(s,null);n[15](s),n[16](e),o=!0,r||(a=[D(t,"input",n[10]),D(t,"keydown",n[9]),D(e,"transitionend",n[17]),D(e,"transitioncancel",n[18])],r=!0)},p(f,[d]){if(d&2067){l=Ae(Object.entries(f[4]));let _;for(_=0;_<l.length;_+=1){const h=al(f,l,_);c[_]?(c[_].p(h,d),L(c[_],1)):(c[_]=cl(h),c[_].c(),L(c[_],1),c[_].m(s,null))}for(Pe(),_=l.length;_<c.length;_+=1)u(_);Me()}(!o||d&256)&&te(s,"no-scrollbar",f[8].length<=4),(!o||d&2)&&te(e,"ddOpen",f[1])},i(f){if(!o){for(let d=0;d<l.length;d+=1)L(c[d]);o=!0}},o(f){c=c.filter(Boolean);for(let d=0;d<c.length;d+=1)V(c[d]);o=!1},d(f){f&&M(e),n[12](null),_t(c,f),n[15](null),n[16](null),r=!1,ge(a)}}}function Qm(n,e,t){let i;J(n,wt,H=>t(4,i=H));let{chosenBuild:s,ddOpen:o=!1,dropdown:r}=e;const a=Mt();let l,c,u,f,d={},_=!1,h=[];function g(H){!H.shiftKey&&H.key=="Tab"&&(H.preventDefault(),setTimeout(()=>l.focus()))}function v(){c&&c.removeEventListener("keydown",g),y(),c&&c.addEventListener("keydown",g)}function w(H){H.shiftKey&&H.key=="Tab"&&(H.preventDefault(),setTimeout(()=>(c.querySelector("button")||c).focus()))}function C(){jc(l.value,d),v()}function y(){c&&c.classList.remove("lastElement"),t(8,h=u.querySelectorAll("li:not(.hidden)")),c=h[h.length-1],c?c.classList.add("lastElement"):c=l}function k(H){a("buildSelect"),t(6,f=H.detail);let N=u.querySelector(".selectedItem");N&&N!=H.detail&&N.classList.remove("selectedItem"),t(7,_=!0)}function E(H){ne[H?"unshift":"push"](()=>{l=H,t(5,l)})}function O(H){s=H,t(0,s)}function I(H){o=H,t(1,o)}function A(H){ne[H?"unshift":"push"](()=>{u=H,t(3,u)})}function G(H){ne[H?"unshift":"push"](()=>{r=H,t(2,r)})}const W=H=>{H.propertyName=="visibility"&&(_&&(t(7,_=!1),t(5,l.value="",l),C()),!o&&f&&u.scrollTo(0,f.offsetTop),Gi(l,o))},S=H=>{H.propertyName=="visibility"&&(t(7,_=!1),Gi(l,o))};return n.$$set=H=>{"chosenBuild"in H&&t(0,s=H.chosenBuild),"ddOpen"in H&&t(1,o=H.ddOpen),"dropdown"in H&&t(2,r=H.dropdown)},n.$$.update=()=>{if(n.$$.dirty&24&&u){t(8,h=u.querySelectorAll("li:not(.hidden)"));for(let H=0;H<u.childElementCount;H++)d[Object.keys(i)[H]]=u.children[H];y(),v()}},[s,o,r,u,i,l,f,_,h,w,C,k,E,O,I,A,G,W,S]}class Fo extends Ne{constructor(e){super(),Te(this,e,Qm,Km,pe,{chosenBuild:0,ddOpen:1,dropdown:2})}}function ul(n){let e,t=(n[6]>n[5]*.8?n[11].slice(0,20)+"<b>...</b>":n[11])+"",i;return{c(){e=b("span"),ke(()=>n[15].call(e))},m(s,o){B(s,e,o),e.innerHTML=t,i=Xt(e,n[15].bind(e))},p(s,o){o[0]&2144&&t!==(t=(s[6]>s[5]*.8?s[11].slice(0,20)+"<b>...</b>":s[11])+"")&&(e.innerHTML=t)},d(s){s&&M(e),i()}}}function dl(n){let e;return{c(){e=b("span"),e.textContent="New changes! Exiting will erase them.",m(e,"id","alert")},m(t,i){B(t,e,i)},d(t){t&&M(e)}}}function Xm(n){let e,t,i,s,o,r=n[11],a,l,c,u,f,d,_,h,g,v,w,C,y,k,E=275-n[2].length+"",O,I,A,G,W,S,H,N,q,R,U,F,P,ee,he,de,_e,j,Z,ae,je,Se=ul(n),Fe=n[1]!=null&&n[1]!=n[2]&&dl();function Ge(fe){n[26](fe)}function Ke(fe){n[27](fe)}function Qe(fe){n[28](fe)}let Ue={};return n[0]!==void 0&&(Ue.chosenBuild=n[0]),n[3]!==void 0&&(Ue.ddOpen=n[3]),n[9]!==void 0&&(Ue.dropdown=n[9]),ee=new Fo({props:Ue}),ne.push(()=>De(ee,"chosenBuild",Ge)),ne.push(()=>De(ee,"ddOpen",Ke)),ne.push(()=>De(ee,"dropdown",Qe)),ee.$on("buildSelect",n[29]),{c(){e=b("div"),t=b("div"),i=b("span"),i.textContent="Save to:",s=T(),o=b("button"),Se.c(),a=T(),l=b("iconify-icon"),f=T(),d=b("div"),_=b("div"),h=b("span"),h.textContent="Description / Notes:",g=T(),Fe&&Fe.c(),v=T(),w=b("textarea"),y=T(),k=b("span"),O=ie(E),I=T(),A=b("div"),G=b("div"),W=b("button"),S=ie("CANCEL"),N=T(),q=b("div"),R=b("button"),U=ie("SAVE"),P=T(),le(ee.$$.fragment),Xe(l,"icon","iconamoon:arrow-down-2-fill"),m(o,"id","firstFocusable"),o.disabled=c=n[12].save.status==0,m(o,"class","promptDDButton svelte-106wt5q"),ke(()=>n[17].call(o)),te(o,"ddOpen",n[3]),m(t,"class","chosenBuildCont"),m(w,"class","buildDescInput"),w.disabled=C=n[12].save.status==0,m(w,"placeholder","[Empty]"),m(w,"maxlength","275"),m(w,"autocomplete","off"),m(k,"class","charCounter"),m(k,"id","buildDesc"),m(d,"class","buildDescCont"),W.disabled=H=n[12].save.status==0,m(R,"id","lastFocusable"),R.disabled=F=n[12].save.status==0,m(A,"class","promptOptions"),m(e,"class","buildSaver")},m(fe,K){B(fe,e,K),p(e,t),p(t,i),p(t,s),p(t,o),Se.m(o,null),p(o,a),p(o,l),n[16](o),u=Xt(o,n[17].bind(o)),p(e,f),p(e,d),p(d,_),p(_,h),p(_,g),Fe&&Fe.m(_,null),p(d,v),p(d,w),n[19](w),Dt(w,n[10]),p(d,y),p(d,k),p(k,O),p(e,I),p(e,A),p(A,G),p(G,W),p(W,S),n[23](W),p(A,N),p(A,q),p(q,R),p(R,U),p(e,P),oe(ee,e,null),Z=!0,ae||(je=[D(window,"mousedown",n[14]),D(o,"click",n[18]),D(o,"keydown",vt),D(w,"input",n[20]),D(w,"input",n[21]),D(w,"keydown",n[22]),D(W,"click",n[24]),D(R,"click",n[25]),D(R,"keydown",yt),D(e,"introstart",n[30]),D(e,"keydown",n[31])],ae=!0)},p(fe,K){K[0]&2048&&pe(r,r=fe[11])?(Se.d(1),Se=ul(fe),Se.c(),Se.m(o,a)):Se.p(fe,K),(!Z||K[0]&4096&&c!==(c=fe[12].save.status==0))&&(o.disabled=c),(!Z||K[0]&8)&&te(o,"ddOpen",fe[3]),fe[1]!=null&&fe[1]!=fe[2]?Fe||(Fe=dl(),Fe.c(),Fe.m(_,null)):Fe&&(Fe.d(1),Fe=null),(!Z||K[0]&4096&&C!==(C=fe[12].save.status==0))&&(w.disabled=C),K[0]&1024&&Dt(w,fe[10]),(!Z||K[0]&4)&&E!==(E=275-fe[2].length+"")&&Ee(O,E),(!Z||K[0]&4096&&H!==(H=fe[12].save.status==0))&&(W.disabled=H),(!Z||K[0]&4096&&F!==(F=fe[12].save.status==0))&&(R.disabled=F);const Y={};!he&&K[0]&1&&(he=!0,Y.chosenBuild=fe[0],Oe(()=>he=!1)),!de&&K[0]&8&&(de=!0,Y.ddOpen=fe[3],Oe(()=>de=!1)),!_e&&K[0]&512&&(_e=!0,Y.dropdown=fe[9],Oe(()=>_e=!1)),ee.$set(Y)},i(fe){Z||(L(ee.$$.fragment,fe),fe&&ke(()=>{Z&&(j||(j=Ce(e,Ze,{duration:250},!0)),j.run(1))}),Z=!0)},o(fe){V(ee.$$.fragment,fe),fe&&(j||(j=Ce(e,Ze,{duration:250},!1)),j.run(0)),Z=!1},d(fe){fe&&M(e),Se.d(fe),n[16](null),u(),Fe&&Fe.d(),n[19](null),n[23](null),re(ee),fe&&j&&j.end(),ae=!1,ge(je)}}}function Jm(n,e,t){let i,s,o,r,a,l,c,u;J(n,$,j=>t(12,r=j)),J(n,dt,j=>t(32,a=j)),J(n,wt,j=>t(33,l=j)),J(n,At,j=>t(34,c=j)),J(n,Nt,j=>t(35,u=j));let f=!1,d,_,h,g,v,w,C=Object.entries(l)[0],y=null;function k(){X($,r.save.status=0,r);let j=zc(u,c),Z=y==null?s:y==""?"[Empty]":y,ae=C[1].id;j.name=i,j.desc=Z,os(jt(An(Mn),`builds/${ae}`),j).then(()=>{X($,r.save.status=1,r);let je={...l};je[i].desc=Z,Mo(),wt.update(()=>je),X(dt,a=j,a),X(dt,a.id=ae,a)}).catch(()=>{X($,r.save.status=-1,r),X($,r.message="firebase_fail",r)})}const E=j=>{!d.contains(j.target)&&!w.contains(j.target)&&t(3,f=!1)};function O(){h=this.offsetWidth,t(6,h)}function I(j){ne[j?"unshift":"push"](()=>{d=j,t(4,d)})}function A(){_=this.offsetWidth,t(5,_)}const G=()=>{r.save.status!=0&&t(3,f=!f)};function W(j){ne[j?"unshift":"push"](()=>{g=j,t(7,g)})}function S(){o=this.value,t(10,o),t(1,y),t(2,s),t(0,C)}const H=j=>{t(1,y=Vi(j.target.value,275))},N=j=>{r.save.status==0&&j.preventDefault(),Vs(g,j.target.value,275)};function q(j){ne[j?"unshift":"push"](()=>{v=j,t(8,v)})}const R=()=>{r.save.status!=0&&X($,r.save.ongoing=!1,r)},U=()=>{r.save.status!=0&&k()};function F(j){C=j,t(0,C)}function P(j){f=j,t(3,f)}function ee(j){w=j,t(9,w)}const he=()=>t(1,y=null),de=()=>v.focus(),_e=j=>{j.key=="Escape"&&(t(3,f=!1),d.focus())};return n.$$.update=()=>{n.$$.dirty[0]&1&&t(11,i=C[0]),n.$$.dirty[0]&1&&t(2,s=C[1].desc),n.$$.dirty[0]&6&&t(10,o=y??s)},[C,y,s,f,d,_,h,g,v,w,o,i,r,k,E,O,I,A,G,W,S,H,N,q,R,U,F,P,ee,he,de,_e]}class Zm extends Ne{constructor(e){super(),Te(this,e,Jm,Xm,pe,{},null,[-1,-1])}}function xm(n){let e,t,i,s,o,r,a,l,c;return{c(){e=b("div"),t=b("span"),t.textContent="ID:",i=T(),s=b("input"),m(s,"class","buildIDInput svelte-w8elgk"),s.disabled=o=n[11].load.status==0,m(s,"type","text"),m(s,"placeholder","Example ID: -NDqeA1Scn0EAJcYWN3b"),m(s,"maxlength","25"),m(e,"class","buildIDCont svelte-w8elgk")},m(u,f){B(u,e,f),p(e,t),p(e,i),p(e,s),n[23](s),Dt(s,n[10]),a=!0,l||(c=[D(s,"input",n[24]),D(s,"input",n[25]),D(s,"keydown",n[26])],l=!0)},p(u,f){(!a||f[0]&2048&&o!==(o=u[11].load.status==0))&&(s.disabled=o),f[0]&1024&&s.value!==u[10]&&Dt(s,u[10])},i(u){a||(u&&ke(()=>{a&&(r||(r=Ce(e,Je,{duration:150},!0)),r.run(1))}),a=!0)},o(u){u&&(r||(r=Ce(e,Je,{duration:150},!1)),r.run(0)),a=!1},d(u){u&&M(e),n[23](null),u&&r&&r.end(),l=!1,ge(c)}}}function $m(n){let e,t,i,s,o=n[9],r,a,l,c,u,f,d,_,h=fl(n);return{c(){e=b("div"),t=b("span"),t.textContent="Load:",i=T(),s=b("button"),h.c(),r=T(),a=b("iconify-icon"),Xe(a,"icon","iconamoon:arrow-down-2-fill"),s.disabled=l=n[11].load.status==0,m(s,"class","promptDDButton svelte-w8elgk"),ke(()=>n[21].call(s)),te(s,"ddOpen",n[8]),m(e,"class","chosenBuildCont svelte-w8elgk")},m(g,v){B(g,e,v),p(e,t),p(e,i),p(e,s),h.m(s,null),p(s,r),p(s,a),n[20](s),c=Xt(s,n[21].bind(s)),f=!0,d||(_=D(s,"click",n[22]),d=!0)},p(g,v){v[0]&512&&pe(o,o=g[9])?(h.d(1),h=fl(g),h.c(),h.m(s,r)):h.p(g,v),(!f||v[0]&2048&&l!==(l=g[11].load.status==0))&&(s.disabled=l),(!f||v[0]&256)&&te(s,"ddOpen",g[8])},i(g){f||(g&&ke(()=>{f&&(u||(u=Ce(e,Je,{duration:150},!0)),u.run(1))}),f=!0)},o(g){g&&(u||(u=Ce(e,Je,{duration:150},!1)),u.run(0)),f=!1},d(g){g&&M(e),h.d(g),n[20](null),c(),g&&u&&u.end(),d=!1,_()}}}function fl(n){let e,t=(n[6]>n[5]*.7?n[9].slice(0,20)+"<b>...</b>":n[9])+"",i;return{c(){e=b("span"),ke(()=>n[19].call(e))},m(s,o){B(s,e,o),e.innerHTML=t,i=Xt(e,n[19].bind(e))},p(s,o){o[0]&608&&t!==(t=(s[6]>s[5]*.7?s[9].slice(0,20)+"<b>...</b>":s[9])+"")&&(e.innerHTML=t)},d(s){s&&M(e),i()}}}function hl(n){let e,t,i,s,o;function r(u){n[29](u)}function a(u){n[30](u)}function l(u){n[31](u)}let c={};return n[3]!==void 0&&(c.chosenBuild=n[3]),n[8]!==void 0&&(c.ddOpen=n[8]),n[7]!==void 0&&(c.dropdown=n[7]),e=new Fo({props:c}),ne.push(()=>De(e,"chosenBuild",r)),ne.push(()=>De(e,"ddOpen",a)),ne.push(()=>De(e,"dropdown",l)),{c(){le(e.$$.fragment)},m(u,f){oe(e,u,f),o=!0},p(u,f){const d={};!t&&f[0]&8&&(t=!0,d.chosenBuild=u[3],Oe(()=>t=!1)),!i&&f[0]&256&&(i=!0,d.ddOpen=u[8],Oe(()=>i=!1)),!s&&f[0]&128&&(s=!0,d.dropdown=u[7],Oe(()=>s=!1)),e.$set(d)},i(u){o||(L(e.$$.fragment,u),o=!0)},o(u){V(e.$$.fragment,u),o=!1},d(u){re(e,u)}}}function eg(n){let e,t,i,s,o,r,a,l,c,u,f,d,_,h,g,v,w,C,y,k,E,O,I,A,G,W,S,H,N,q,R,U,F,P,ee;const he=[$m,xm],de=[];function _e(Z,ae){return Z[2]?0:1}C=_e(n),y=de[C]=he[C](n);let j=n[2]&&hl(n);return{c(){e=b("div"),t=b("span"),t.textContent="Load build via:",i=T(),s=b("div"),o=b("div"),r=b("button"),a=ie("Local saves"),u=T(),f=b("div"),d=b("button"),_=ie("Exported ID"),v=T(),w=b("div"),y.c(),k=T(),E=b("div"),O=b("div"),I=b("button"),A=ie("CANCEL"),W=T(),S=b("div"),H=b("button"),N=ie("LOAD"),R=T(),j&&j.c(),m(t,"class","svelte-w8elgk"),m(r,"id",l=n[2]?"firstFocusable":""),r.disabled=c=n[11].load.status==0||!n[12],m(r,"class","svelte-w8elgk"),te(r,"chosen",n[2]),te(r,"unavailable",!n[12]),m(o,"class","svelte-w8elgk"),m(d,"id",h=n[2]?"":"firstFocusable"),d.disabled=g=n[11].load.status==0,m(d,"class","svelte-w8elgk"),te(d,"chosen",!n[2]),m(f,"class","svelte-w8elgk"),m(s,"class","loadMethodRadio svelte-w8elgk"),m(w,"class","loadMethodCont svelte-w8elgk"),I.disabled=G=n[11].load.status==0,m(H,"id","lastFocusable"),H.disabled=q=n[11].load.status==0,m(E,"class","promptOptions svelte-w8elgk"),m(e,"class","buildLoader svelte-w8elgk")},m(Z,ae){B(Z,e,ae),p(e,t),p(e,i),p(e,s),p(s,o),p(o,r),p(r,a),p(s,u),p(s,f),p(f,d),p(d,_),p(e,v),p(e,w),de[C].m(w,null),p(e,k),p(e,E),p(E,O),p(O,I),p(I,A),n[27](I),p(E,W),p(E,S),p(S,H),p(H,N),p(e,R),j&&j.m(e,null),F=!0,P||(ee=[D(window,"mousedown",n[14]),D(r,"click",n[15]),D(r,"keydown",n[16]),D(d,"click",n[17]),D(d,"keydown",n[18]),D(I,"click",n[28]),D(H,"keydown",yt),D(H,"click",n[13]),D(e,"introstart",n[32]),D(e,"keydown",n[33])],P=!0)},p(Z,ae){(!F||ae[0]&4&&l!==(l=Z[2]?"firstFocusable":""))&&m(r,"id",l),(!F||ae[0]&6144&&c!==(c=Z[11].load.status==0||!Z[12]))&&(r.disabled=c),(!F||ae[0]&4)&&te(r,"chosen",Z[2]),(!F||ae[0]&4096)&&te(r,"unavailable",!Z[12]),(!F||ae[0]&4&&h!==(h=Z[2]?"":"firstFocusable"))&&m(d,"id",h),(!F||ae[0]&2048&&g!==(g=Z[11].load.status==0))&&(d.disabled=g),(!F||ae[0]&4)&&te(d,"chosen",!Z[2]);let je=C;C=_e(Z),C===je?de[C].p(Z,ae):(Pe(),V(de[je],1,1,()=>{de[je]=null}),Me(),y=de[C],y?y.p(Z,ae):(y=de[C]=he[C](Z),y.c()),L(y,1),y.m(w,null)),(!F||ae[0]&2048&&G!==(G=Z[11].load.status==0))&&(I.disabled=G),(!F||ae[0]&2048&&q!==(q=Z[11].load.status==0))&&(H.disabled=q),Z[2]?j?(j.p(Z,ae),ae[0]&4&&L(j,1)):(j=hl(Z),j.c(),L(j,1),j.m(e,null)):j&&(Pe(),V(j,1,1,()=>{j=null}),Me())},i(Z){F||(L(y),L(j),Z&&ke(()=>{F&&(U||(U=Ce(e,Ze,{duration:250},!0)),U.run(1))}),F=!0)},o(Z){V(y),V(j),Z&&(U||(U=Ce(e,Ze,{duration:250},!1)),U.run(0)),F=!1},d(Z){Z&&M(e),de[C].d(),n[27](null),j&&j.d(),Z&&U&&U.end(),P=!1,ge(ee)}}}function tg(n,e,t){let i,s,o;J(n,$,j=>t(11,i=j)),J(n,wt,j=>t(34,s=j)),J(n,Ht,j=>t(12,o=j));const r=Mt();let a,l,c,u,f,d,_=o,h=!1,g=o?Object.entries(s)[0]:null,v,w="";function C(){if(!_&&!w.startsWith("-N")){X($,i.load.status=-1,i),X($,i.message="invalid_id",i);return}let j=Ac(An(Mn,"builds"),Rc()),Z=0;X($,i.load.status=0,i),Dc(j).then(ae=>{let je=_?g[1].id:w;for(let Se in ae.val()){if(Se==je){r("buildLoad",{build:ae.val()[Se],id:Se});break}else Z==Object.keys(ae.val()).length-1&&(X($,i.load.status=-1,i),X($,i.message=_?"not_found":"invalid_id",i));Z++}}).catch(()=>{X($,i.load.status=-1,i),X($,i.message="firebase_fail",i)})}const y=j=>{a&&!a.contains(j.target)&&!d.contains(j.target)&&t(8,h=!1)},k=()=>{i.load.status!=0&&o&&t(2,_=!0)},E=j=>{_&&vt(j)},O=()=>{i.load.status!=0&&t(2,_=!1)},I=j=>{_||vt(j)};function A(){f=this.offsetWidth,t(6,f)}function G(j){ne[j?"unshift":"push"](()=>{a=j,t(0,a)})}function W(){u=this.offsetWidth,t(5,u)}const S=()=>{i.load.status!=0&&t(8,h=!h)};function H(j){ne[j?"unshift":"push"](()=>{c=j,t(1,c)})}function N(){w=this.value,t(10,w)}const q=j=>{t(10,w=Vi(j.target.value,25))},R=j=>{i.load.status==0&&j.preventDefault()};function U(j){ne[j?"unshift":"push"](()=>{l=j,t(4,l)})}const F=()=>{i.load.status!=0&&X($,i.load.ongoing=!1,i)};function P(j){g=j,t(3,g)}function ee(j){h=j,t(8,h)}function he(j){d=j,t(7,d)}const de=()=>l.focus(),_e=j=>{j.key=="Escape"&&(t(8,h=!1),a.focus())};return n.$$.update=()=>{n.$$.dirty[0]&8&&t(9,v=g!=null?g[0]:null),n.$$.dirty[0]&7&&setTimeout(_?()=>a.focus():()=>c.focus())},[a,c,_,g,l,u,f,d,h,v,w,i,o,C,y,k,E,O,I,A,G,W,S,H,N,q,R,U,F,P,ee,he,de,_e]}class ng extends Ne{constructor(e){super(),Te(this,e,tg,eg,pe,{},null,[-1,-1])}}function _l(n){let e,t=(n[3]>n[4]*.8?n[8].slice(0,20)+"<b>...</b>":n[8])+"",i;return{c(){e=b("span"),ke(()=>n[12].call(e))},m(s,o){B(s,e,o),e.innerHTML=t,i=Xt(e,n[12].bind(e))},p(s,o){o&280&&t!==(t=(s[3]>s[4]*.8?s[8].slice(0,20)+"<b>...</b>":s[8])+"")&&(e.innerHTML=t)},d(s){s&&M(e),i()}}}function ig(n){let e,t,i,s,o,r=n[8],a,l,c,u,f,d,_,h,g,v,w,C,y,k,E,O,I,A,G,W,S,H,N,q,R,U,F,P,ee=_l(n);d=new ct({props:{text:"I'm aware that this action is irreversible and want to erase this build from the database."}}),d.$on("toggle",n[16]);function he(Z){n[21](Z)}function de(Z){n[22](Z)}function _e(Z){n[23](Z)}let j={};return n[0]!==void 0&&(j.chosenBuild=n[0]),n[6]!==void 0&&(j.ddOpen=n[6]),n[5]!==void 0&&(j.dropdown=n[5]),S=new Fo({props:j}),ne.push(()=>De(S,"chosenBuild",he)),ne.push(()=>De(S,"ddOpen",de)),ne.push(()=>De(S,"dropdown",_e)),{c(){e=b("div"),t=b("div"),i=b("span"),i.textContent="Delete:",s=T(),o=b("button"),ee.c(),a=T(),l=b("iconify-icon"),f=T(),le(d.$$.fragment),_=T(),h=b("div"),g=b("div"),v=b("button"),w=ie("CANCEL"),k=T(),E=b("div"),O=b("button"),I=ie("DELETE"),W=T(),le(S.$$.fragment),Xe(l,"icon","iconamoon:arrow-down-2-fill"),m(o,"class","promptDDButton svelte-1t9ajmz"),m(o,"id","firstFocusable"),o.disabled=c=n[9].delete.status==0,ke(()=>n[14].call(o)),te(o,"ddOpen",n[6]),m(t,"class","chosenBuildCont"),m(v,"id",C=n[7]?"":"lastFocusable"),v.disabled=y=n[9].delete.status==0,O.disabled=A=!n[7]||n[9].delete.status==0,m(O,"id",G=n[7]?"lastFocusable":""),te(O,"unavailable",!n[7]),m(h,"class","promptOptions svelte-1t9ajmz"),m(e,"class","buildDeleter svelte-1t9ajmz")},m(Z,ae){B(Z,e,ae),p(e,t),p(t,i),p(t,s),p(t,o),ee.m(o,null),p(o,a),p(o,l),n[13](o),u=Xt(o,n[14].bind(o)),p(e,f),oe(d,e,null),p(e,_),p(e,h),p(h,g),p(g,v),p(v,w),n[17](v),p(h,k),p(h,E),p(E,O),p(O,I),p(e,W),oe(S,e,null),U=!0,F||(P=[D(window,"mousedown",n[11]),D(o,"click",n[15]),D(o,"keydown",vt),D(v,"click",n[18]),D(v,"keydown",n[19]),D(O,"click",n[20]),D(O,"keydown",yt),D(e,"introstart",n[24]),D(e,"keydown",n[25])],F=!0)},p(Z,[ae]){ae&256&&pe(r,r=Z[8])?(ee.d(1),ee=_l(Z),ee.c(),ee.m(o,a)):ee.p(Z,ae),(!U||ae&512&&c!==(c=Z[9].delete.status==0))&&(o.disabled=c),(!U||ae&64)&&te(o,"ddOpen",Z[6]),(!U||ae&128&&C!==(C=Z[7]?"":"lastFocusable"))&&m(v,"id",C),(!U||ae&512&&y!==(y=Z[9].delete.status==0))&&(v.disabled=y),(!U||ae&640&&A!==(A=!Z[7]||Z[9].delete.status==0))&&(O.disabled=A),(!U||ae&128&&G!==(G=Z[7]?"lastFocusable":""))&&m(O,"id",G),(!U||ae&128)&&te(O,"unavailable",!Z[7]);const je={};!H&&ae&1&&(H=!0,je.chosenBuild=Z[0],Oe(()=>H=!1)),!N&&ae&64&&(N=!0,je.ddOpen=Z[6],Oe(()=>N=!1)),!q&&ae&32&&(q=!0,je.dropdown=Z[5],Oe(()=>q=!1)),S.$set(je)},i(Z){U||(L(d.$$.fragment,Z),L(S.$$.fragment,Z),Z&&ke(()=>{U&&(R||(R=Ce(e,Ze,{duration:250},!0)),R.run(1))}),U=!0)},o(Z){V(d.$$.fragment,Z),V(S.$$.fragment,Z),Z&&(R||(R=Ce(e,Ze,{duration:250},!1)),R.run(0)),U=!1},d(Z){Z&&M(e),ee.d(Z),n[13](null),u(),re(d),n[17](null),re(S),Z&&R&&R.end(),F=!1,ge(P)}}}function sg(n,e,t){let i,s,o,r;J(n,$,R=>t(9,s=R)),J(n,wt,R=>t(26,o=R)),J(n,dt,R=>t(27,r=R));let a,l,c,u,f,d=!1,_=Object.entries(o)[0],h=!1;function g(){X($,s.delete.status=0,s);let R=_[1].id;Y_(jt(An(Mn),`builds/${R}`)).then(()=>{X($,s.delete.status=1,s),r&&R==r.id&&X(dt,r=null,r);let U={...o};delete U[i],Mo(),wt.update(()=>U)}).catch(U=>{X($,s.delete.status=-1,s),X($,s.message="firebase_fail",s)})}const v=R=>{!l.contains(R.target)&&!f.contains(R.target)&&t(6,d=!1)};function w(){c=this.offsetWidth,t(3,c)}function C(R){ne[R?"unshift":"push"](()=>{l=R,t(2,l)})}function y(){u=this.offsetWidth,t(4,u)}const k=()=>{s.delete.status!=0&&t(6,d=!d)},E=R=>t(7,h=R.detail);function O(R){ne[R?"unshift":"push"](()=>{a=R,t(1,a)})}const I=()=>{s.delete.status!=0&&X($,s.delete.ongoing=!1,s)},A=R=>{h||yt(R)},G=()=>{h&&s.delete.status!=0&&g()};function W(R){_=R,t(0,_)}function S(R){d=R,t(6,d)}function H(R){f=R,t(5,f)}const N=()=>a.focus(),q=R=>{R.key=="Escape"&&(t(6,d=!1),l.focus())};return n.$$.update=()=>{n.$$.dirty&1&&t(8,i=_[0])},[_,a,l,c,u,f,d,h,i,s,g,v,w,C,y,k,E,O,I,A,G,W,S,H,N,q]}class og extends Ne{constructor(e){super(),Te(this,e,sg,ig,pe,{})}}function rg(n){let e,t,i,s,o,r,a,l,c,u,f,d,_,h;return{c(){e=b("div"),t=b("div"),i=b("button"),i.innerHTML='<iconify-icon icon="tabler:coins" class="svelte-czj12i"></iconify-icon> <span class="tooltip" id="right">Build costs</span>',s=T(),o=b("div"),r=b("button"),r.innerHTML='<iconify-icon icon="codicon:sparkle-filled" class="svelte-czj12i"></iconify-icon> <span class="tooltip" id="right">Add bonuses</span>',a=T(),l=b("div"),c=b("button"),c.innerHTML='<iconify-icon icon="fa-solid:random" class="svelte-czj12i"></iconify-icon> <span class="tooltip" id="right">Randomize build</span>',u=T(),f=b("div"),d=b("button"),d.innerHTML='<iconify-icon icon="fe:picture" class="svelte-czj12i"></iconify-icon> <span class="tooltip" id="right">Screenshot mode</span>',m(i,"class","svelte-czj12i"),m(t,"class","svelte-czj12i"),m(r,"class","svelte-czj12i"),m(o,"class","svelte-czj12i"),m(c,"class","svelte-czj12i"),m(l,"id","randomize"),m(l,"class","svelte-czj12i"),m(d,"class","svelte-czj12i"),m(f,"id","screenshot"),m(f,"class","svelte-czj12i"),m(e,"class","sideFeatures svelte-czj12i")},m(g,v){B(g,e,v),p(e,t),p(t,i),p(e,s),p(e,o),p(o,r),p(e,a),p(e,l),p(l,c),p(e,u),p(e,f),p(f,d),_||(h=[D(i,"click",n[2]),D(r,"click",n[3]),D(c,"click",n[4]),D(d,"click",n[5])],_=!0)},p:se,i:se,o:se,d(g){g&&M(e),_=!1,ge(h)}}}function lg(n,e,t){let i,s;return J(n,In,c=>t(0,i=c)),J(n,$,c=>t(1,s=c)),[i,s,c=>{Sn(c),i||X($,s.costs.ongoing=!0,s)},c=>{Sn(c),i||X($,s.bonus.ongoing=!0,s)},c=>{Sn(c),i||X($,s.randomize.ongoing=!0,s)},()=>{i||(X($,s.screenshot.ongoing=!0,s),setTimeout(()=>X($,s.screenshot.ongoing=!1,s),3500))}]}class ag extends Ne{constructor(e){super(),Te(this,e,lg,rg,pe,{})}}function pl(n,e,t){const i=n.slice();i[11]=e[t];const s=i[1].bonuses[0].name==i[11].name;return i[12]=s,i}function ml(n){let e,t,i,s,o,r,a,l,c,u,f,d;function _(...g){return n[5](n[12],...g)}function h(...g){return n[6](n[11],...g)}return l=new ct({props:{text:n[11].name,checked:n[2][n[11].name]}}),l.$on("toggle",h),{c(){e=b("div"),t=b("a"),i=b("img"),a=T(),le(l.$$.fragment),c=T(),tt(i.src,s=n[11].image)||m(i,"src",s),m(i,"alt",""),m(i,"class","svelte-1xnyxhr"),m(t,"id",o=n[12]?"firstFocusable":""),m(t,"href",r=n[11].link),m(t,"target","_blank"),m(t,"class","svelte-1xnyxhr"),m(e,"class","svelte-1xnyxhr")},m(g,v){B(g,e,v),p(e,t),p(t,i),p(e,a),oe(l,e,null),p(e,c),u=!0,f||(d=D(t,"keydown",_),f=!0)},p(g,v){n=g,(!u||v&2&&!tt(i.src,s=n[11].image))&&m(i,"src",s),(!u||v&2&&o!==(o=n[12]?"firstFocusable":""))&&m(t,"id",o),(!u||v&2&&r!==(r=n[11].link))&&m(t,"href",r);const w={};v&2&&(w.text=n[11].name),v&6&&(w.checked=n[2][n[11].name]),l.$set(w)},i(g){u||(L(l.$$.fragment,g),u=!0)},o(g){V(l.$$.fragment,g),u=!1},d(g){g&&M(e),re(l),f=!1,d()}}}function cg(n){let e,t,i,s,o,r,a,l,c,u,f,d,_,h=Ae(n[1].bonuses),g=[];for(let w=0;w<h.length;w+=1)g[w]=ml(pl(n,h,w));const v=w=>V(g[w],1,1,()=>{g[w]=null});return{c(){e=b("div"),t=b("div");for(let w=0;w<g.length;w+=1)g[w].c();i=T(),s=b("div"),o=b("div"),r=b("button"),r.textContent="CLEAR",a=T(),l=b("div"),c=b("button"),c.textContent="OK",m(t,"class","bonusesCont svelte-1xnyxhr"),m(c,"id","lastFocusable"),m(s,"class","promptOptions svelte-1xnyxhr"),m(e,"class","bonusChooser svelte-1xnyxhr")},m(w,C){B(w,e,C),p(e,t);for(let y=0;y<g.length;y+=1)g[y]&&g[y].m(t,null);p(e,i),p(e,s),p(s,o),p(o,r),p(s,a),p(s,l),p(l,c),n[8](c),f=!0,d||(_=[D(r,"click",n[7]),D(c,"click",n[9]),D(c,"keydown",yt),D(e,"introstart",n[10])],d=!0)},p(w,[C]){if(C&14){h=Ae(w[1].bonuses);let y;for(y=0;y<h.length;y+=1){const k=pl(w,h,y);g[y]?(g[y].p(k,C),L(g[y],1)):(g[y]=ml(k),g[y].c(),L(g[y],1),g[y].m(t,null))}for(Pe(),y=h.length;y<g.length;y+=1)v(y);Me()}},i(w){if(!f){for(let C=0;C<h.length;C+=1)L(g[C]);w&&ke(()=>{f&&(u||(u=Ce(e,Ze,{duration:250},!0)),u.run(1))}),f=!0}},o(w){g=g.filter(Boolean);for(let C=0;C<g.length;C+=1)V(g[C]);w&&(u||(u=Ce(e,Ze,{duration:250},!1)),u.run(0)),f=!1},d(w){w&&M(e),_t(g,w),n[8](null),w&&u&&u.end(),d=!1,ge(_)}}}function ug(n,e,t){let i,s,o,r;J(n,Tt,h=>t(1,i=h)),J(n,wn,h=>t(2,s=h)),J(n,ut,h=>t(3,o=h)),J(n,$,h=>t(4,r=h));let a;const l=(h,g)=>{h&&vt(g)},c=(h,g)=>{X(wn,s[h.name]=g.detail,s);for(let v in o)g.detail?X(ut,o[v]+=h.stats[v],o):X(ut,o[v]-=h.stats[v],o),X(ut,o[v]=Math.round(o[v]*10)/10,o)},u=()=>{for(let h in s){if(!s[h])continue;let g=i.bonuses.find(v=>v.name==h);X(wn,s[h]=!1,s);for(let v in o)X(ut,o[v]-=g.stats[v],o),X(ut,o[v]=Math.round(o[v]*10)/10,o)}};function f(h){ne[h?"unshift":"push"](()=>{a=h,t(0,a)})}return[a,i,s,o,r,l,c,u,f,()=>X($,r.bonus.ongoing=!1,r),()=>a.focus()]}class dg extends Ne{constructor(e){super(),Te(this,e,ug,cg,pe,{})}}function fg(n){let e;return{c(){e=b("span"),e.textContent=`Includes equipment such as ore-based armor and their variants,\r
            ore-based weapons, and shoes with no special stats`,m(e,"slot","tooltip"),m(e,"class","tooltip svelte-19uqsbs"),m(e,"id","right")},m(t,i){B(t,e,i)},p:se,d(t){t&&M(e)}}}function hg(n){let e,t,i,s,o,r,a,l,c,u,f,d,_,h,g,v,w,C,y,k,E,O,I,A,G,W;return s=new ct({props:{text:"Force Mushroom Parasol",checked:n[0].parasol,first:!0}}),s.$on("toggle",n[5]),r=new ct({props:{text:"Randomize armor",checked:n[0].armor}}),r.$on("toggle",n[6]),l=new ct({props:{text:"Randomize gear",checked:n[0].gear}}),l.$on("toggle",n[7]),u=new ct({props:{text:"Allow 'basic' equipment",checked:n[0].basic,$$slots:{tooltip:[fg]},$$scope:{ctx:n}}}),u.$on("toggle",n[8]),{c(){e=b("div"),t=b("span"),t.textContent="Randomize your build",i=T(),le(s.$$.fragment),o=T(),le(r.$$.fragment),a=T(),le(l.$$.fragment),c=T(),le(u.$$.fragment),f=T(),d=b("div"),_=b("div"),h=b("button"),g=ie("CANCEL"),w=T(),C=b("div"),y=b("button"),k=ie("ROLL THE DICE"),m(t,"class","svelte-19uqsbs"),m(h,"id",v=n[2]?"":"lastFocusable"),m(y,"id",E=n[2]?"lastFocusable":""),y.disabled=O=!n[2],m(d,"class","promptOptions"),m(e,"class","buildRandomizer svelte-19uqsbs")},m(S,H){B(S,e,H),p(e,t),p(e,i),oe(s,e,null),p(e,o),oe(r,e,null),p(e,a),oe(l,e,null),p(e,c),oe(u,e,null),p(e,f),p(e,d),p(d,_),p(_,h),p(h,g),n[9](h),p(d,w),p(d,C),p(C,y),p(y,k),A=!0,G||(W=[D(h,"click",n[10]),D(h,"keydown",n[11]),D(y,"click",n[12]),D(y,"keydown",n[13]),D(e,"introstart",n[14])],G=!0)},p(S,[H]){const N={};H&1&&(N.checked=S[0].parasol),s.$set(N);const q={};H&1&&(q.checked=S[0].armor),r.$set(q);const R={};H&1&&(R.checked=S[0].gear),l.$set(R);const U={};H&1&&(U.checked=S[0].basic),H&16777216&&(U.$$scope={dirty:H,ctx:S}),u.$set(U),(!A||H&4&&v!==(v=S[2]?"":"lastFocusable"))&&m(h,"id",v),(!A||H&4&&E!==(E=S[2]?"lastFocusable":""))&&m(y,"id",E),(!A||H&4&&O!==(O=!S[2]))&&(y.disabled=O)},i(S){A||(L(s.$$.fragment,S),L(r.$$.fragment,S),L(l.$$.fragment,S),L(u.$$.fragment,S),S&&ke(()=>{A&&(I||(I=Ce(e,Ze,{duration:250},!0)),I.run(1))}),A=!0)},o(S){V(s.$$.fragment,S),V(r.$$.fragment,S),V(l.$$.fragment,S),V(u.$$.fragment,S),S&&(I||(I=Ce(e,Ze,{duration:250},!1)),I.run(0)),A=!1},d(S){S&&M(e),re(s),re(r),re(l),re(u),n[9](null),S&&I&&I.end(),G=!1,ge(W)}}}function _g(n,e,t){let i,s,o,r,a,l,c,u;J(n,Hn,S=>t(0,s=S)),J(n,$,S=>t(3,o=S)),J(n,Tt,S=>t(15,r=S)),J(n,Nn,S=>t(16,a=S)),J(n,At,S=>t(17,l=S)),J(n,Tn,S=>t(18,c=S)),J(n,Nt,S=>t(19,u=S));let f,d=["Bronze","Iron","Cobalt","Titanium","Gold","Onyx"],_=["Hardened","Royal"],h=["Black","Brown","Green","Red","White","Dark","Golden","Grey","Phantom"];function g(){if(s.armor){for(let S of ui){let H=u[S]||cs;H.name&&c[S][H.name].querySelector("button").click()}setTimeout(()=>{for(let S of ui)(function H(){let N=Math.floor(Math.random()*r[S].length);s.basic||!s.basic&&!v(r[S][N].name)?c[S][r[S][N].name].querySelector("button").click():H()})()})}if(s.gear){for(let S of Qt){let H=l[S]||us;H.name&&a[S][H.name].querySelector("button").click()}setTimeout(()=>{let S=!1,H=Qt.length,N=Qt.length;(function q(){setTimeout(()=>{let R=Math.floor(Math.random()*H);(function U(){let F=Math.floor(Math.random()*r.gear.length);!a[N][r.gear[F].name].querySelector("button").disabled&&!a[N][r.gear[F].name].classList.contains("switchable")&&(s.basic||!s.basic&&!v(r.gear[F].name))?(a[N][r.gear[!S&&s.parasol&&!R?0:F].name].querySelector("button").click(),!S&&!R?S=!0:S||H--):U()})(),--N&&q()},10)})()})}X($,o.randomize.ongoing=!1,o)}function v(S){let H=!1,N=S.split(" ");return H=d.includes(N[0])||_.includes(N[0])||S=="Mining Helmet"||h.includes(N[0]),H}const w=S=>X(Hn,s.parasol=S.detail,s),C=S=>X(Hn,s.armor=S.detail,s),y=S=>X(Hn,s.gear=S.detail,s),k=S=>X(Hn,s.basic=S.detail,s);function E(S){ne[S?"unshift":"push"](()=>{f=S,t(1,f)})}const O=()=>X($,o.randomize.ongoing=!1,o),I=S=>{i||yt(S)},A=()=>{i&&g()},G=S=>{i&&yt(S)},W=()=>f.focus();return n.$$.update=()=>{n.$$.dirty&1&&t(2,i=s.armor||s.gear)},[s,f,i,o,g,w,C,y,k,E,O,I,A,G,W]}class pg extends Ne{constructor(e){super(),Te(this,e,_g,hg,pe,{})}}function gl(n,e,t){const i=n.slice();return i[5]=e[t],i}function mg(n){let e,t=Ae(n[1]),i=[];for(let s=0;s<t.length;s+=1)i[s]=bl(gl(n,t,s));return{c(){for(let s=0;s<i.length;s+=1)i[s].c();e=bt()},m(s,o){for(let r=0;r<i.length;r+=1)i[r]&&i[r].m(s,o);B(s,e,o)},p(s,o){if(o&2){t=Ae(s[1]);let r;for(r=0;r<t.length;r+=1){const a=gl(s,t,r);i[r]?i[r].p(a,o):(i[r]=bl(a),i[r].c(),i[r].m(e.parentNode,e))}for(;r<i.length;r+=1)i[r].d(1);i.length=t.length}},d(s){s&&M(e),_t(i,s)}}}function gg(n){let e,t,i;return{c(){e=b("span"),t=ie(" "),i=ie(n[1]),m(e,"id","info"),m(e,"class","svelte-1t3cage")},m(s,o){B(s,e,o),p(e,t),p(e,i)},p(s,o){o&2&&Ee(i,s[1])},d(s){s&&M(e)}}}function bl(n){let e,t,i=n[5]+"",s;return{c(){e=b("span"),t=ie(" "),s=ie(i),m(e,"id","info"),m(e,"class","svelte-1t3cage")},m(o,r){B(o,e,r),p(e,t),p(e,s)},p(o,r){r&2&&i!==(i=o[5]+"")&&Ee(s,i)},d(o){o&&M(e)}}}function bg(n){let e,t,i,s,o,r,a;function l(f,d){return typeof f[1]=="string"?gg:mg}let c=l(n),u=c(n);return{c(){e=b("li"),t=b("span"),i=ie("v"),s=ie(n[0]),o=T(),r=b("i"),r.textContent=`${n[3][n[2][1]-1]+" "+n[2][0]+(Math.floor(n[2][0]/10)===1?"th":Bc[n[2][0]%10])+", 20"+n[2][2]}`,a=T(),u.c(),m(t,"id","version"),m(t,"class","svelte-1t3cage"),m(r,"id","date"),m(r,"class","svelte-1t3cage"),m(e,"class","svelte-1t3cage")},m(f,d){B(f,e,d),p(e,t),p(t,i),p(t,s),p(e,o),p(e,r),p(e,a),u.m(e,null)},p(f,[d]){d&1&&Ee(s,f[0]),c===(c=l(f))&&u?u.p(f,d):(u.d(1),u=c(f),u&&(u.c(),u.m(e,null)))},i:se,o:se,d(f){f&&M(e),u.d()}}}function vg(n,e,t){let{version:i,date:s,text:o}=e,r=s.split("/"),a=["January","February","March","April","May","June","July","August","Semptember","October","November","December"];return n.$$set=l=>{"version"in l&&t(0,i=l.version),"date"in l&&t(4,s=l.date),"text"in l&&t(1,o=l.text)},[i,o,r,a,s]}class Ct extends Ne{constructor(e){super(),Te(this,e,vg,bg,pe,{version:0,date:4,text:1})}}function yg(n){let e,t,i,s,o,r,a,l,c,u,f,d,_,h,g,v,w,C,y,k,E,O,I,A,G,W,S,H,N,q,R,U,F;return o=new Ct({props:{version:"3.25.9",date:"14/1/24",text:"Added build costs visibility while 'screenshot mode' is active"}}),a=new Ct({props:{version:"3.25.8",date:"11/1/24",text:"Fixed mutually exclusive gear staying disabled when deselecting the selected item"}}),c=new Ct({props:{version:"3.25.7",date:"9/1/24",text:["Enabled 'unsaved changes' prompt to appear before leaving site when certain conditions are met","Fixed dropdowns blocking interactions behind them for a short period after being closed","Fixed dropdown sort incorrectly defaulting to the last sorted list in some cases"]}}),f=new Ct({props:{version:"3.25.6",date:"7/1/24",text:"Fixed armor filter not working properly when 'Exclusive' filter type and 'No Stats' option were selected"}}),_=new Ct({props:{version:"3.25.5",date:"6/1/24",text:["Fixed issue with switching gear slots while full weapon view was on","Tools are now selectable even if full weapon view is on"]}}),g=new Ct({props:{version:"3.25.4",date:"5/1/24",text:'Fixed crash caused by using the build randomizer while "Force Mushroom Parasol" option was on'}}),w=new Ct({props:{version:"3.25.3",date:"5/1/24",text:["Added feature to swap gear slots when clicking on an already selected gear item","Added visual cues to both deselecting and swapping options for dropdown items"]}}),y=new Ct({props:{version:"3.25.2",date:"3/1/24",text:["Replaced 'Strict' filter type with 'Exclusive' filter type in search options of dropdowns","Added icons to resource links and credits"]}}),E=new Ct({props:{version:"3.25.1",date:"2/1/24",text:`"Allow 'basic' equipment" option is no longer restricted when "Randomize gear" option isn't selected in the build randomizer`}}),I=new Ct({props:{version:"3.25.0",date:"2/1/24",text:["Added 'Build Costs' feature","Removed spectacles from 'basic' equipment pool in the build randomizer"]}}),G=new Ct({props:{version:"3.24.5",date:"31/12/23",text:"v3 Release"}}),{c(){e=b("div"),t=b("span"),t.textContent="Changelog",i=T(),s=b("ul"),le(o.$$.fragment),r=T(),le(a.$$.fragment),l=T(),le(c.$$.fragment),u=T(),le(f.$$.fragment),d=T(),le(_.$$.fragment),h=T(),le(g.$$.fragment),v=T(),le(w.$$.fragment),C=T(),le(y.$$.fragment),k=T(),le(E.$$.fragment),O=T(),le(I.$$.fragment),A=T(),le(G.$$.fragment),W=T(),S=b("div"),H=b("div"),N=b("button"),N.textContent="OK",m(t,"id","title"),m(s,"id","contents"),m(s,"class","svelte-1k91i9r"),m(N,"id","firstFocusable lastFocusable"),m(S,"class","promptOptions svelte-1k91i9r"),m(e,"class","infoPrompt svelte-1k91i9r")},m(P,ee){B(P,e,ee),p(e,t),p(e,i),p(e,s),oe(o,s,null),p(s,r),oe(a,s,null),p(s,l),oe(c,s,null),p(s,u),oe(f,s,null),p(s,d),oe(_,s,null),p(s,h),oe(g,s,null),p(s,v),oe(w,s,null),p(s,C),oe(y,s,null),p(s,k),oe(E,s,null),p(s,O),oe(I,s,null),p(s,A),oe(G,s,null),p(e,W),p(e,S),p(S,H),p(H,N),n[2](N),R=!0,U||(F=[D(N,"click",n[3]),D(N,"keydown",n[4]),D(e,"introstart",n[5])],U=!0)},p:se,i(P){R||(L(o.$$.fragment,P),L(a.$$.fragment,P),L(c.$$.fragment,P),L(f.$$.fragment,P),L(_.$$.fragment,P),L(g.$$.fragment,P),L(w.$$.fragment,P),L(y.$$.fragment,P),L(E.$$.fragment,P),L(I.$$.fragment,P),L(G.$$.fragment,P),P&&ke(()=>{R&&(q||(q=Ce(e,Ze,{duration:250},!0)),q.run(1))}),R=!0)},o(P){V(o.$$.fragment,P),V(a.$$.fragment,P),V(c.$$.fragment,P),V(f.$$.fragment,P),V(_.$$.fragment,P),V(g.$$.fragment,P),V(w.$$.fragment,P),V(y.$$.fragment,P),V(E.$$.fragment,P),V(I.$$.fragment,P),V(G.$$.fragment,P),P&&(q||(q=Ce(e,Ze,{duration:250},!1)),q.run(0)),R=!1},d(P){P&&M(e),re(o),re(a),re(c),re(f),re(_),re(g),re(w),re(y),re(E),re(I),re(G),n[2](null),P&&q&&q.end(),U=!1,ge(F)}}}function wg(n,e,t){let i;J(n,$,c=>t(1,i=c));let s;function o(c){ne[c?"unshift":"push"](()=>{s=c,t(0,s)})}return[s,i,o,()=>X($,i.changelog.ongoing=!1,i),c=>{vt(c),yt(c)},()=>s.focus()]}class Cg extends Ne{constructor(e){super(),Te(this,e,wg,yg,pe,{})}}function kg(n){let e,t,i,s,o,r,a,l,c,u,f,d,_,h,g,v,w,C,y,k,E,O;return{c(){e=b("div"),t=b("span"),t.textContent="Helpful Resources",i=T(),s=b("ul"),o=b("li"),r=b("iconify-icon"),a=T(),l=b("a"),l.textContent="Fantastic Frontier Wikia",c=T(),u=b("li"),u.innerHTML='<iconify-icon icon="ic:baseline-discord" class="svelte-18cf37p"></iconify-icon> <a href="https://discord.gg/ff" target="_blank" class="svelte-18cf37p">Fantastic Frontier Discord Server</a>',f=T(),d=b("li"),d.innerHTML='<iconify-icon icon="simple-icons:googledocs" class="svelte-18cf37p"></iconify-icon> <a href="https://docs.google.com/document/d/1H9HXoExCDVfXx15LQ4Te-2tTjrLFB-XCbMmx44Ynld4/edit" target="_blank" class="svelte-18cf37p">Fantastic Frontier Build List</a>',_=T(),h=b("li"),h.innerHTML='<iconify-icon icon="simple-icons:googledocs" class="svelte-18cf37p"></iconify-icon> <a href="https://docs.google.com/document/d/15vwSRojTqZ8LI09Wq4dvGF1kSTPmH2_gECQvwlSFki8/edit" target="_blank" class="svelte-18cf37p">Fantastic Frontier Max Stat List</a>',g=T(),v=b("div"),w=b("div"),C=b("button"),C.textContent="OK",m(t,"id","title"),Xe(r,"icon","simple-icons:fandom"),Xe(r,"class","svelte-18cf37p"),m(l,"id","firstFocusable"),m(l,"href","https://fantastic-frontier-roblox.fandom.com/wiki/Fantastic_Frontier_-_Roblox_Wiki"),m(l,"target","_blank"),m(l,"class","svelte-18cf37p"),m(o,"class","svelte-18cf37p"),m(u,"class","svelte-18cf37p"),m(d,"class","svelte-18cf37p"),m(h,"class","svelte-18cf37p"),m(s,"class","svelte-18cf37p"),m(C,"id","lastFocusable"),m(v,"class","promptOptions"),m(e,"class","infoPrompt")},m(I,A){B(I,e,A),p(e,t),p(e,i),p(e,s),p(s,o),p(o,r),p(o,a),p(o,l),p(s,c),p(s,u),p(s,f),p(s,d),p(s,_),p(s,h),p(e,g),p(e,v),p(v,w),p(w,C),n[2](C),k=!0,E||(O=[D(l,"keydown",vt),D(C,"click",n[3]),D(C,"keydown",yt),D(e,"introstart",n[4])],E=!0)},p:se,i(I){k||(I&&ke(()=>{k&&(y||(y=Ce(e,Ze,{duration:250},!0)),y.run(1))}),k=!0)},o(I){I&&(y||(y=Ce(e,Ze,{duration:250},!1)),y.run(0)),k=!1},d(I){I&&M(e),n[2](null),I&&y&&y.end(),E=!1,ge(O)}}}function Eg(n,e,t){let i;J(n,$,l=>t(1,i=l));let s;function o(l){ne[l?"unshift":"push"](()=>{s=l,t(0,s)})}return[s,i,o,()=>X($,i.resources.ongoing=!1,i),()=>s.focus()]}class Sg extends Ne{constructor(e){super(),Te(this,e,Eg,kg,pe,{})}}function vl(n,e,t){const i=n.slice();return i[7]=e[t],i}function yl(n,e,t){const i=n.slice();return i[10]=e[t],i}function wl(n){let e,t,i,s,o,r,a,l=n[1][n[7]][n[10]].toLocaleString()+" Gold",c,u;return{c(){e=b("div"),t=b("span"),t.textContent=`${n[10].charAt(0).toUpperCase()+n[10].slice(1)+":"}`,i=T(),s=b("img"),r=T(),a=b("span"),c=ie(l),u=T(),m(t,"id","costTypeName"),m(t,"class","svelte-sk567b"),tt(s.src,o="https://static.wikia.nocookie.net/fantastic-frontier-roblox/images/b/ba/GoldCoins.png")||m(s,"src",o),m(s,"alt",""),m(s,"class","svelte-sk567b"),m(e,"class","svelte-sk567b")},m(f,d){B(f,e,d),p(e,t),p(e,i),p(e,s),p(e,r),p(e,a),p(a,c),p(e,u)},p(f,d){d&2&&l!==(l=f[1][f[7]][f[10]].toLocaleString()+" Gold")&&Ee(c,l)},d(f){f&&M(e)}}}function Cl(n){let e,t,i,s,o,r=Ae(["min","avg","max"]),a=[];for(let l=0;l<3;l+=1)a[l]=wl(yl(n,r,l));return{c(){e=b("div"),t=b("span"),t.textContent=`${n[7].charAt(0).toUpperCase()+n[7].slice(1)+" Costs"}`,i=T(),s=b("div");for(let l=0;l<3;l+=1)a[l].c();o=T(),m(t,"id","subtitle"),m(t,"class","svelte-sk567b"),m(s,"class","costTypes svelte-sk567b"),m(e,"class","costs svelte-sk567b"),m(e,"id",n[7])},m(l,c){B(l,e,c),p(e,t),p(e,i),p(e,s);for(let u=0;u<3;u+=1)a[u]&&a[u].m(s,null);p(e,o)},p(l,c){if(c&2){r=Ae(["min","avg","max"]);let u;for(u=0;u<3;u+=1){const f=yl(l,r,u);a[u]?a[u].p(f,c):(a[u]=wl(f),a[u].c(),a[u].m(s,null))}for(;u<3;u+=1)a[u].d(1)}},d(l){l&&M(e),_t(a,l)}}}function Ig(n){let e,t,i,s,o,r,a,l,c,u,f=Ae(["armor","gear","total"]),d=[];for(let _=0;_<3;_+=1)d[_]=Cl(vl(n,f,_));return{c(){e=b("div"),t=b("div");for(let _=0;_<3;_+=1)d[_].c();i=T(),s=b("div"),o=b("div"),r=b("button"),r.textContent="OK",m(t,"class","costsInfo svelte-sk567b"),m(r,"id","firstFocusable lastFocusable"),m(s,"class","promptOptions svelte-sk567b"),m(e,"class","buildCosts svelte-sk567b")},m(_,h){B(_,e,h),p(e,t);for(let g=0;g<3;g+=1)d[g]&&d[g].m(t,null);p(e,i),p(e,s),p(s,o),p(o,r),n[3](r),l=!0,c||(u=[D(r,"click",n[4]),D(r,"keydown",n[5]),D(e,"introstart",n[6])],c=!0)},p(_,[h]){if(h&2){f=Ae(["armor","gear","total"]);let g;for(g=0;g<3;g+=1){const v=vl(_,f,g);d[g]?d[g].p(v,h):(d[g]=Cl(v),d[g].c(),d[g].m(t,null))}for(;g<3;g+=1)d[g].d(1)}},i(_){l||(_&&ke(()=>{l&&(a||(a=Ce(e,Ze,{duration:250},!0)),a.run(1))}),l=!0)},o(_){_&&(a||(a=Ce(e,Ze,{duration:250},!1)),a.run(0)),l=!1},d(_){_&&M(e),_t(d,_),n[3](null),_&&a&&a.end(),c=!1,ge(u)}}}function Tg(n,e,t){let i,s;J(n,gt,u=>t(1,i=u)),J(n,$,u=>t(2,s=u));let o;function r(u){ne[u?"unshift":"push"](()=>{o=u,t(0,o)})}return[o,i,s,r,()=>X($,s.costs.ongoing=!1,s),u=>{vt(u),yt(u)},()=>o.focus()]}class Ng extends Ne{constructor(e){super(),Te(this,e,Tg,Ig,pe,{})}}const{document:Ot,window:sn}=Jc;function kl(n,e,t){const i=n.slice();return i[48]=e[t],i}function El(n,e,t){const i=n.slice();return i[48]=e[t],i}function Sl(n){let e;return{c(){e=b("style"),e.textContent=`* {\r
                pointer-events: none;\r
            }\r
        `},m(t,i){B(t,e,i)},d(t){t&&M(e)}}}function Il(n){let e;return{c(){e=b("link"),m(e,"rel","preload"),m(e,"as","image"),m(e,"href",n[48])},m(t,i){B(t,e,i)},p:se,d(t){t&&M(e)}}}function Tl(n){let e;return{c(){e=b("style"),e.textContent=`body > div:not(.backgrounds),\r
            main > :not(.promptCont),\r
            .backgrounds > img,\r
            .info#resources,\r
            .info#changelog {\r
                filter: blur(calc(var(--u) * 0.5));\r
                pointer-events: none;\r
            }\r
            .sideFeatures {\r
                z-index: 3;\r
            }\r
            .sideFeatures button:hover,\r
            .sideFeatures button:focus,\r
            .info:hover,\r
            .info:focus {\r
                background-color: var(--transparent);\r
            }\r
            .sideFeatures button > .tooltip,\r
            .info:not(#credits) > .tooltip {\r
                opacity: 0 !important;\r
                visibility: hidden !important;\r
            }\r
        `},m(t,i){B(t,e,i)},d(t){t&&M(e)}}}function Nl(n){let e;return{c(){e=b("style"),e.textContent=`body {\r
                overflow: hidden;\r
            }\r
        `},m(t,i){B(t,e,i)},d(t){t&&M(e)}}}function Ol(n){let e;return{c(){e=b("style"),e.textContent=`body {\r
                pointer-events: none;\r
            }\r
            #resources,\r
            #changelog,\r
            .mainFeatures,\r
            .sideFeatures,\r
            .statBox > .toggleCont,\r
            .ddButton > iconify-icon {\r
                opacity: 0;\r
                visibility: hidden;\r
            }\r
            .gearBox .ddButton > iconify-icon {\r
                width: 15% !important;\r
            }\r
            a > .tooltip {\r
                opacity: 1;\r
                visibility: visible;\r
            }\r
            .calcBox {\r
                translate: -3%;\r
            }\r
            .currentBuild {\r
                left: 50% !important;\r
                padding: calc(var(--u) * 2) !important;\r
            }\r
            .currentBuild > button {\r
                min-width: 0 !important;\r
                width: 0;\r
                opacity: 0;\r
                visibility: hidden;\r
            }`},m(t,i){B(t,e,i)},d(t){t&&M(e)}}}function Dl(n){let e,t;return{c(){e=b("img"),m(e,"class","background svelte-wiqhja"),tt(e.src,t=n[48])||m(e,"src",t),m(e,"alt",""),te(e,"active",n[20].indexOf(n[48])==n[9])},m(i,s){B(i,e,s)},p(i,s){s[0]&1049088&&te(e,"active",i[20].indexOf(i[48])==i[9])},d(i){i&&M(e)}}}function Rl(n){let e,t,i=Math.floor(n[17][n[3]]*100)+"",s,o,r,a;return{c(){e=b("span"),t=ie("Zoom: "),s=ie(i),o=b("b"),o.textContent="%",m(e,"class","info svelte-wiqhja"),m(e,"id","zoomLevel")},m(l,c){B(l,e,c),p(e,t),p(e,s),p(e,o),a=!0},p(l,c){(!a||c[0]&8)&&i!==(i=Math.floor(l[17][l[3]]*100)+"")&&Ee(s,i)},i(l){a||(l&&ke(()=>{a&&(r||(r=Ce(e,Je,{duration:150},!0)),r.run(1))}),a=!0)},o(l){l&&(r||(r=Ce(e,Je,{duration:150},!1)),r.run(0)),a=!1},d(l){l&&M(e),l&&r&&r.end()}}}function Al(n){let e,t,i,s,o,r,a,l,c=n[16].armor.avg.toLocaleString()+" Gold",u,f,d,_,h,g,v,w,C,y=n[16].gear.avg.toLocaleString()+" Gold",k,E,O;return{c(){e=b("div"),t=b("div"),i=b("span"),i.textContent="Avg. armor cost:",s=T(),o=b("img"),a=T(),l=b("span"),u=ie(c),f=T(),d=b("div"),_=b("span"),_.textContent="Avg. gear cost:",h=T(),g=b("img"),w=T(),C=b("span"),k=ie(y),tt(o.src,r="https://static.wikia.nocookie.net/fantastic-frontier-roblox/images/b/ba/GoldCoins.png")||m(o,"src",r),m(o,"alt",""),m(o,"class","svelte-wiqhja"),m(t,"class","svelte-wiqhja"),tt(g.src,v="https://static.wikia.nocookie.net/fantastic-frontier-roblox/images/b/ba/GoldCoins.png")||m(g,"src",v),m(g,"alt",""),m(g,"class","svelte-wiqhja"),m(d,"class","svelte-wiqhja"),m(e,"class","costPreview svelte-wiqhja"),m(e,"id","specific")},m(I,A){B(I,e,A),p(e,t),p(t,i),p(t,s),p(t,o),p(t,a),p(t,l),p(l,u),p(e,f),p(e,d),p(d,_),p(d,h),p(d,g),p(d,w),p(d,C),p(C,k),O=!0},p(I,A){(!O||A[0]&65536)&&c!==(c=I[16].armor.avg.toLocaleString()+" Gold")&&Ee(u,c),(!O||A[0]&65536)&&y!==(y=I[16].gear.avg.toLocaleString()+" Gold")&&Ee(k,y)},i(I){O||(I&&ke(()=>{O&&(E||(E=Ce(e,Je,{duration:150},!0)),E.run(1))}),O=!0)},o(I){I&&(E||(E=Ce(e,Je,{duration:150},!1)),E.run(0)),O=!1},d(I){I&&M(e),I&&E&&E.end()}}}function Pl(n){let e,t,i=n[4].name+"",s,o,r,a,l,c,u,f,d,_,h=n[4].desc+"",g,v,w,C,y;return{c(){e=b("div"),t=b("span"),s=ie(i),o=T(),r=b("button"),r.innerHTML='<iconify-icon icon="ri:share-fill"></iconify-icon> <span class="tooltip" id="right">Share build</span>',a=T(),l=b("span"),c=ie(`Description / Notes:\r
                `),u=b("br"),f=T(),d=b("br"),_=T(),g=ie(h),m(t,"id","buildName"),m(t,"class","svelte-wiqhja"),m(r,"class","svelte-wiqhja"),m(l,"class","tooltip"),m(l,"id","bottom"),m(e,"class","currentBuild svelte-wiqhja"),te(e,"no-tooltip",n[10])},m(k,E){B(k,e,E),p(e,t),p(t,s),p(e,o),p(e,r),p(e,a),p(e,l),p(l,c),p(l,u),p(l,f),p(l,d),p(l,_),p(l,g),w=!0,C||(y=[D(r,"click",n[30]),D(r,"mouseenter",n[31]),D(r,"mouseleave",n[32])],C=!0)},p(k,E){(!w||E[0]&16)&&i!==(i=k[4].name+"")&&Ee(s,i),(!w||E[0]&16)&&h!==(h=k[4].desc+"")&&Ee(g,h),(!w||E[0]&1024)&&te(e,"no-tooltip",k[10])},i(k){w||(k&&ke(()=>{w&&(v||(v=Ce(e,Je,{duration:100},!0)),v.run(1))}),w=!0)},o(k){k&&(v||(v=Ce(e,Je,{duration:100},!1)),v.run(0)),w=!1},d(k){k&&M(e),k&&v&&v.end(),C=!1,ge(y)}}}function Ml(n){let e,t,i,s,o,r,a,l,c=n[16].total.avg.toLocaleString()+" Gold",u,f,d;return{c(){e=b("div"),t=b("div"),i=b("span"),i.textContent="Avg. total cost:",s=T(),o=b("img"),a=T(),l=b("span"),u=ie(c),tt(o.src,r="https://static.wikia.nocookie.net/fantastic-frontier-roblox/images/b/ba/GoldCoins.png")||m(o,"src",r),m(o,"alt",""),m(o,"class","svelte-wiqhja"),m(t,"class","svelte-wiqhja"),m(e,"class","costPreview svelte-wiqhja"),m(e,"id","total")},m(_,h){B(_,e,h),p(e,t),p(t,i),p(t,s),p(t,o),p(t,a),p(t,l),p(l,u),d=!0},p(_,h){(!d||h[0]&65536)&&c!==(c=_[16].total.avg.toLocaleString()+" Gold")&&Ee(u,c)},i(_){d||(_&&ke(()=>{d&&(f||(f=Ce(e,Je,{duration:150},!0)),f.run(1))}),d=!0)},o(_){_&&(f||(f=Ce(e,Je,{duration:150},!1)),f.run(0)),d=!1},d(_){_&&M(e),_&&f&&f.end()}}}function Og(n){let e,t,i;return t=new Cg({}),{c(){e=b("div"),le(t.$$.fragment),m(e,"class","promptCont svelte-wiqhja")},m(s,o){B(s,e,o),oe(t,e,null),i=!0},p:se,i(s){i||(L(t.$$.fragment,s),i=!0)},o(s){V(t.$$.fragment,s),i=!1},d(s){s&&M(e),re(t)}}}function Dg(n){let e,t,i;return t=new Sg({}),t.$on("loadPending",n[18]),{c(){e=b("div"),le(t.$$.fragment),m(e,"class","promptCont svelte-wiqhja")},m(s,o){B(s,e,o),oe(t,e,null),i=!0},p:se,i(s){i||(L(t.$$.fragment,s),i=!0)},o(s){V(t.$$.fragment,s),i=!1},d(s){s&&M(e),re(t)}}}function Rg(n){let e,t,i;return t=new pg({}),{c(){e=b("div"),le(t.$$.fragment),m(e,"class","promptCont svelte-wiqhja")},m(s,o){B(s,e,o),oe(t,e,null),i=!0},p:se,i(s){i||(L(t.$$.fragment,s),i=!0)},o(s){V(t.$$.fragment,s),i=!1},d(s){s&&M(e),re(t)}}}function Ag(n){let e,t,i;return t=new dg({}),{c(){e=b("div"),le(t.$$.fragment),m(e,"class","promptCont svelte-wiqhja")},m(s,o){B(s,e,o),oe(t,e,null),i=!0},p:se,i(s){i||(L(t.$$.fragment,s),i=!0)},o(s){V(t.$$.fragment,s),i=!1},d(s){s&&M(e),re(t)}}}function Pg(n){let e,t,i;return t=new Ng({}),{c(){e=b("div"),le(t.$$.fragment),m(e,"class","promptCont svelte-wiqhja")},m(s,o){B(s,e,o),oe(t,e,null),i=!0},p:se,i(s){i||(L(t.$$.fragment,s),i=!0)},o(s){V(t.$$.fragment,s),i=!1},d(s){s&&M(e),re(t)}}}function Mg(n){let e,t,i;return t=new og({}),{c(){e=b("div"),le(t.$$.fragment),m(e,"class","promptCont svelte-wiqhja")},m(s,o){B(s,e,o),oe(t,e,null),i=!0},p:se,i(s){i||(L(t.$$.fragment,s),i=!0)},o(s){V(t.$$.fragment,s),i=!1},d(s){s&&M(e),re(t)}}}function Lg(n){let e,t,i;return t=new ng({}),t.$on("buildLoad",n[34]),{c(){e=b("div"),le(t.$$.fragment),m(e,"class","promptCont svelte-wiqhja")},m(s,o){B(s,e,o),oe(t,e,null),i=!0},p:se,i(s){i||(L(t.$$.fragment,s),i=!0)},o(s){V(t.$$.fragment,s),i=!1},d(s){s&&M(e),re(t)}}}function Fg(n){let e,t,i;return t=new Zm({}),{c(){e=b("div"),le(t.$$.fragment),m(e,"class","promptCont svelte-wiqhja")},m(s,o){B(s,e,o),oe(t,e,null),i=!0},p:se,i(s){i||(L(t.$$.fragment,s),i=!0)},o(s){V(t.$$.fragment,s),i=!1},d(s){s&&M(e),re(t)}}}function Bg(n){let e,t,i;return t=new Im({}),{c(){e=b("div"),le(t.$$.fragment),m(e,"class","promptCont svelte-wiqhja")},m(s,o){B(s,e,o),oe(t,e,null),i=!0},p:se,i(s){i||(L(t.$$.fragment,s),i=!0)},o(s){V(t.$$.fragment,s),i=!1},d(s){s&&M(e),re(t)}}}function qg(n){let e,t,i,s;function o(a){n[33](a)}let r={};return n[8]!==void 0&&(r.loadID=n[8]),t=new Um({props:r}),ne.push(()=>De(t,"loadID",o)),t.$on("resetActions",n[22]),{c(){e=b("div"),le(t.$$.fragment),m(e,"class","promptCont svelte-wiqhja")},m(a,l){B(a,e,l),oe(t,e,null),s=!0},p(a,l){const c={};!i&&l[0]&256&&(i=!0,c.loadID=a[8],Oe(()=>i=!1)),t.$set(c)},i(a){s||(L(t.$$.fragment,a),s=!0)},o(a){V(t.$$.fragment,a),s=!1},d(a){a&&M(e),re(t)}}}function Ll(n){let e;return{c(){e=b("div"),e.innerHTML='<iconify-icon icon="eos-icons:three-dots-loading" class="svelte-wiqhja"></iconify-icon>',m(e,"class","promptCont svelte-wiqhja")},m(t,i){B(t,e,i)},d(t){t&&M(e)}}}function jg(n){let e,t,i,s,o,r,a,l,c,u,f,d,_,h,g,v,w,C,y,k,E,O,I,A,G,W,S,H,N,q,R,U,F,P,ee,he,de,_e,j,Z,ae,je;ke(n[28]);let Se=!n[6]&&Sl(),Fe=Ae(n[20]),Ge=[];for(let Q=0;Q<Fe.length;Q+=1)Ge[Q]=Il(El(n,Fe,Q));let Ke=(n[12]||!n[6])&&Tl(),Qe=n[5].screenshot.ongoing&&n[17][n[3]]<=1&&Nl(),Ue=n[5].screenshot.ongoing&&Ol(),fe=Ae(n[20]),K=[];for(let Q=0;Q<fe.length;Q+=1)K[Q]=Dl(kl(n,fe,Q));let Y=n[7]&&Rl(n),ve=n[5].screenshot.ongoing&&Al(n),ce=n[4]&&Pl(n);w=new pm({}),y=new ag({}),I=new Vp({}),G=new tm({}),S=new fm({}),N=new km({});let z=n[5].screenshot.ongoing&&Ml(n);const Re=[qg,Bg,Fg,Lg,Mg,Pg,Ag,Rg,Dg,Og],Ye=[];function mt(Q,me){return Q[11]||Q[5].share.ongoing?0:Q[5].export.ongoing?1:Q[5].save.ongoing?2:Q[5].load.ongoing&&!Q[8]?3:Q[5].delete.ongoing?4:Q[5].costs.ongoing?5:Q[5].bonus.ongoing?6:Q[5].randomize.ongoing?7:Q[5].resources.ongoing?8:Q[5].changelog.ongoing?9:-1}~(U=mt(n))&&(F=Ye[U]=Re[U](n));let ze=!n[6]&&Ll();return{c(){Se&&Se.c(),e=bt();for(let Q=0;Q<Ge.length;Q+=1)Ge[Q].c();t=bt(),Ke&&Ke.c(),i=bt(),Qe&&Qe.c(),s=bt(),Ue&&Ue.c(),o=bt(),r=T(),a=b("div");for(let Q=0;Q<K.length;Q+=1)K[Q].c();l=T(),Y&&Y.c(),c=T(),u=b("span"),u.innerHTML=`<iconify-icon icon="ic:baseline-discord" class="svelte-wiqhja"></iconify-icon>
    xt.ss
    <span class="tooltip svelte-wiqhja" id="right">Contact me on Discord!</span>`,f=T(),d=b("button"),d.innerHTML='<iconify-icon icon="charm:stack"></iconify-icon> <span class="tooltip" id="left">Resources</span>',_=T(),h=b("main"),ve&&ve.c(),g=T(),ce&&ce.c(),v=T(),le(w.$$.fragment),C=T(),le(y.$$.fragment),k=T(),E=b("div"),O=b("div"),le(I.$$.fragment),A=T(),le(G.$$.fragment),W=T(),le(S.$$.fragment),H=T(),le(N.$$.fragment),q=T(),z&&z.c(),R=T(),F&&F.c(),P=T(),ee=b("button"),ee.innerHTML='<iconify-icon icon="octicon:log-16"></iconify-icon> <span class="tooltip" id="right">Changelog</span>',he=T(),de=b("span"),de.textContent=`${zg}`,_e=T(),ze&&ze.c(),j=bt(),m(a,"class","backgrounds"),m(u,"class","info svelte-wiqhja"),m(u,"id","credits"),m(d,"class","info svelte-wiqhja"),m(d,"id","resources"),m(O,"class","eqCont svelte-wiqhja"),m(E,"class","calcBox svelte-wiqhja"),m(E,"id","calc"),m(h,"class","svelte-wiqhja"),te(h,"portrait",!n[2]),m(ee,"class","info svelte-wiqhja"),m(ee,"id","changelog"),m(de,"class","info svelte-wiqhja"),m(de,"id","version")},m(Q,me){Se&&Se.m(Ot.head,null),p(Ot.head,e);for(let rt=0;rt<Ge.length;rt+=1)Ge[rt]&&Ge[rt].m(Ot.head,null);p(Ot.head,t),Ke&&Ke.m(Ot.head,null),p(Ot.head,i),Qe&&Qe.m(Ot.head,null),p(Ot.head,s),Ue&&Ue.m(Ot.head,null),p(Ot.head,o),B(Q,r,me),B(Q,a,me);for(let rt=0;rt<K.length;rt+=1)K[rt]&&K[rt].m(a,null);B(Q,l,me),Y&&Y.m(Q,me),B(Q,c,me),B(Q,u,me),B(Q,f,me),B(Q,d,me),B(Q,_,me),B(Q,h,me),ve&&ve.m(h,null),p(h,g),ce&&ce.m(h,null),p(h,v),oe(w,h,null),p(h,C),oe(y,h,null),p(h,k),p(h,E),p(E,O),oe(I,O,null),p(O,A),oe(G,O,null),p(E,W),oe(S,E,null),p(h,H),oe(N,h,null),p(h,q),z&&z.m(h,null),p(h,R),~U&&Ye[U].m(h,null),B(Q,P,me),B(Q,ee,me),B(Q,he,me),B(Q,de,me),B(Q,_e,me),ze&&ze.m(Q,me),B(Q,j,me),Z=!0,ae||(je=[D(sn,"beforeunload",n[24]),D(sn,"storage",n[25]),D(sn,"wheel",n[26],{passive:!1}),D(sn,"keydown",n[27]),D(sn,"resize",n[28]),D(d,"click",n[29]),D(ee,"click",n[35])],ae=!0)},p(Q,me){if(Q[6]?Se&&(Se.d(1),Se=null):Se||(Se=Sl(),Se.c(),Se.m(e.parentNode,e)),me[0]&1048576){Fe=Ae(Q[20]);let We;for(We=0;We<Fe.length;We+=1){const zn=El(Q,Fe,We);Ge[We]?Ge[We].p(zn,me):(Ge[We]=Il(zn),Ge[We].c(),Ge[We].m(t.parentNode,t))}for(;We<Ge.length;We+=1)Ge[We].d(1);Ge.length=Fe.length}if(Q[12]||!Q[6]?Ke||(Ke=Tl(),Ke.c(),Ke.m(i.parentNode,i)):Ke&&(Ke.d(1),Ke=null),Q[5].screenshot.ongoing&&Q[17][Q[3]]<=1?Qe||(Qe=Nl(),Qe.c(),Qe.m(s.parentNode,s)):Qe&&(Qe.d(1),Qe=null),Q[5].screenshot.ongoing?Ue||(Ue=Ol(),Ue.c(),Ue.m(o.parentNode,o)):Ue&&(Ue.d(1),Ue=null),me[0]&1049088){fe=Ae(Q[20]);let We;for(We=0;We<fe.length;We+=1){const zn=kl(Q,fe,We);K[We]?K[We].p(zn,me):(K[We]=Dl(zn),K[We].c(),K[We].m(a,null))}for(;We<K.length;We+=1)K[We].d(1);K.length=fe.length}Q[7]?Y?(Y.p(Q,me),me[0]&128&&L(Y,1)):(Y=Rl(Q),Y.c(),L(Y,1),Y.m(c.parentNode,c)):Y&&(Pe(),V(Y,1,1,()=>{Y=null}),Me()),Q[5].screenshot.ongoing?ve?(ve.p(Q,me),me[0]&32&&L(ve,1)):(ve=Al(Q),ve.c(),L(ve,1),ve.m(h,g)):ve&&(Pe(),V(ve,1,1,()=>{ve=null}),Me()),Q[4]?ce?(ce.p(Q,me),me[0]&16&&L(ce,1)):(ce=Pl(Q),ce.c(),L(ce,1),ce.m(h,v)):ce&&(Pe(),V(ce,1,1,()=>{ce=null}),Me()),Q[5].screenshot.ongoing?z?(z.p(Q,me),me[0]&32&&L(z,1)):(z=Ml(Q),z.c(),L(z,1),z.m(h,R)):z&&(Pe(),V(z,1,1,()=>{z=null}),Me());let rt=U;U=mt(Q),U===rt?~U&&Ye[U].p(Q,me):(F&&(Pe(),V(Ye[rt],1,1,()=>{Ye[rt]=null}),Me()),~U?(F=Ye[U],F?F.p(Q,me):(F=Ye[U]=Re[U](Q),F.c()),L(F,1),F.m(h,null)):F=null),(!Z||me[0]&4)&&te(h,"portrait",!Q[2]),Q[6]?ze&&(ze.d(1),ze=null):ze||(ze=Ll(),ze.c(),ze.m(j.parentNode,j))},i(Q){Z||(L(Y),L(ve),L(ce),L(w.$$.fragment,Q),L(y.$$.fragment,Q),L(I.$$.fragment,Q),L(G.$$.fragment,Q),L(S.$$.fragment,Q),L(N.$$.fragment,Q),L(z),L(F),Z=!0)},o(Q){V(Y),V(ve),V(ce),V(w.$$.fragment,Q),V(y.$$.fragment,Q),V(I.$$.fragment,Q),V(G.$$.fragment,Q),V(S.$$.fragment,Q),V(N.$$.fragment,Q),V(z),V(F),Z=!1},d(Q){Q&&(M(r),M(a),M(l),M(c),M(u),M(f),M(d),M(_),M(h),M(P),M(ee),M(he),M(de),M(_e),M(j)),Se&&Se.d(Q),M(e),_t(Ge,Q),M(t),Ke&&Ke.d(Q),M(i),Qe&&Qe.d(Q),M(s),Ue&&Ue.d(Q),M(o),_t(K,Q),Y&&Y.d(Q),ve&&ve.d(),ce&&ce.d(),re(w),re(y),re(I),re(G),re(S),re(N),z&&z.d(),~U&&Ye[U].d(),ze&&ze.d(Q),ae=!1,ge(je)}}}let zg="v3.25.9";function Wg(n,e,t){let i,s,o,r,a,l,c,u,f,d,_,h,g,v;J(n,dt,Y=>t(4,s=Y)),J(n,$,Y=>t(5,o=Y)),J(n,In,Y=>t(12,r=Y)),J(n,Zs,Y=>t(23,a=Y)),J(n,Nn,Y=>t(39,l=Y)),J(n,At,Y=>t(40,c=Y)),J(n,Tn,Y=>t(41,u=Y)),J(n,Nt,Y=>t(42,f=Y)),J(n,Ht,Y=>t(13,d=Y)),J(n,wt,Y=>t(14,_=Y)),J(n,Tt,Y=>t(43,h=Y)),J(n,xs,Y=>t(15,g=Y)),J(n,gt,Y=>t(16,v=Y));let w=!1,C,y,k,E=7,O=[.2,.3,.45,.6,.75,.85,.95,1,1.1,1.25,1.5,1.75,2,2.5,3,4,5],I=!1,A,G=new URLSearchParams(location.search).get("id");for(let Y of fp){let ve=`https://raw.githubusercontent.com/XT8SS/fantastic-calculator/gh-pages/ff-data/${Y}.json`;fetch(ve).then(async ce=>{if(ce.status!=200){console.error(`Failed to fetch "${Y}" data!
Status: ${ce.status}`);return}X(Tt,h[Y]=await ce.json(),h)}).catch(ce=>console.error(`Failed to initiate "${Y}" data fetch!
${ce}`))}ru(()=>{t(6,w=!0),G&&W(),t(2,k=y>C),_[Object.keys(_)[0]]&&X(Ht,d=!0,d)});function W(){if(X($,o.load.ongoing=!0,o),!G.startsWith("-N"))X($,o.load.status=-1,o),X($,o.message="invalid_id",o);else{X($,o.load.status=0,o);let Y=Ac(An(Mn,"builds"),Rc()),ve=0;Dc(Y).then(ce=>{for(let z in ce.val()){if(z==G){S(ce.val()[z],z);break}else ve==Object.keys(ce.val()).length-1&&(X($,o.load.status=-1,o),X($,o.message="invalid_id",o));ve++}}).catch(()=>{X($,o.load.status=-1,o),X($,o.message="firebase_fail",o)})}}function S(Y,ve){for(let ce in Y.eq){let z=f[ce]||cs;Y.eq[ce]&&Y.eq[ce]!=z.name?u[ce][Y.eq[ce]].querySelector("button").click():!Y.eq[ce]&&z.name&&u[ce][z.name].querySelector("button").click()}for(let ce of Qt){let z=c[ce]||us;z.name&&l[ce][z.name].querySelector("button").click()}setTimeout(()=>{for(let ce of Qt)Y.gear[ce]&&l[ce][Y.gear[ce]].querySelector("button").click();X($,o.load.ongoing=!1,o),X($,o.load.status=null,o),ve&&(X(dt,s=Y,s),X(dt,s.id=ve,s),t(8,G=null))})}let H=[],N=[],q,R,U=9;for(let Y=0;Y<U;Y++)H.push(`backgrounds/BG${Y}.jpg`);function F(Y){R=Math.floor(Math.random()*Y.length)}F(H);function P(){t(9,q=R),N.push(R)}P(),function Y(){setTimeout(()=>{if(F(H),!N.length)P();else if(N.length>3&&(N=N.slice(1)),!N.includes(R))P();else{let ve=[...Array(U).keys()].filter(ce=>!N.includes(ce));F(ve),P()}document.hasFocus&&Y()},45e3)}();function ee(){A=setTimeout(()=>{t(7,I=!1)},750)}function he(){clearTimeout(A),t(7,I=!0),ee()}function de(){X($,o.export.status=null,o),X($,o.export.ongoing=!1,o),X($,o.save.status=null,o),X($,o.save.ongoing=!1,o),X($,o.load.status=null,o),X($,o.load.ongoing=!1,o),X($,o.delete.status=null,o),X($,o.delete.ongoing=!1,o),X($,o.share.ongoing=!1,o),X($,o.message="",o)}let _e=!1;const j=Y=>{(g||r)&&Y.preventDefault()},Z=Y=>{if(Y.key=="builds")if(Y.url.includes("ls=true")){X(wt,_=JSON.parse(Y.newValue),_),X(Ht,d=Object.keys(JSON.parse(Y.newValue)).length>0,d),de();let ve=Object.keys(JSON.parse(Y.oldValue)).filter(ce=>!Object.keys(JSON.parse(Y.newValue)).includes(ce))[0];ve&&s&&ve==s.name&&X(dt,s=null,s)}else window.localStorage.setItem("builds",JSON.stringify(_))},ae=Y=>{let ve=Y.wheelDeltaY;if(Y.ctrlKey){if(Y.preventDefault(),O[E]==.2&&ve<0||O[E]==5&&ve>0)return;ve>0?t(3,E++,E):t(3,E--,E),he()}},je=Y=>{Y.ctrlKey&&(Y.key=="-"||Y.key=="+"||Y.code=="Equal"||Y.key=="0")&&(Y.preventDefault(),(Y.key=="+"||Y.code=="Equal")&&O[E]!=5?t(3,E++,E):Y.key=="-"&&O[E]!=.2?t(3,E--,E):Y.key=="0"&&O[E]!=1&&t(3,E=7),he()),r&&pp(Y)};function Se(){t(0,C=sn.outerHeight),t(1,y=sn.outerWidth)}const Fe=Y=>{Sn(Y),r||X($,o.resources.ongoing=!0,o)},Ge=()=>{r||X($,o.share.ongoing=!0,o)},Ke=()=>t(10,_e=!0),Qe=()=>t(10,_e=!1);function Ue(Y){G=Y,t(8,G)}const fe=Y=>S(Y.detail.build,Y.detail.id),K=Y=>{Sn(Y),r||X($,o.changelog.ongoing=!0,o)};return n.$$.update=()=>{if(n.$$.dirty[0]&8388623&&(y||C)&&(t(2,k=y>C),document.documentElement.style.setProperty("--u",`${(k?.75:window.outerWidth/window.outerHeight/2)*O[E]}${CSS.supports("height: 1lvh")?"l":""}vh`),a))for(let Y of a)Po(Y.node,Y.itemName);n.$$.dirty[0]&32&&t(11,i=o.export.status||o.save.status||o.load.status||o.delete.status),n.$$.dirty[0]&32&&X(In,r=o.export.ongoing||o.save.ongoing||o.load.ongoing||o.delete.ongoing||o.share.ongoing||o.costs.ongoing||o.bonus.ongoing||o.randomize.ongoing||o.resources.ongoing||o.changelog.ongoing,r),n.$$.dirty[0]&16&&(document.title=(s?s.name+" - ":"")+"Fantastic Calculator")},[C,y,k,E,s,o,w,I,G,q,_e,i,r,d,_,g,v,O,W,S,H,he,de,a,j,Z,ae,je,Se,Fe,Ge,Ke,Qe,Ue,fe,K]}class Hg extends Ne{constructor(e){super(),Te(this,e,Wg,jg,pe,{},null,[-1,-1])}}new Hg({target:document.body});
